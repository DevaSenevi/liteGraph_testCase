{"version":3,"sources":["node_modules/process/browser.js","litegraph.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["process","module","exports","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","setTimeout","e","clearTimeout","runTimeout","fun","call","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","nextTick","args","Array","arguments","i","push","Item","array","prototype","apply","title","env","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","global","LiteGraph","VERSION","CANVAS_GRID_SIZE","NODE_TITLE_HEIGHT","NODE_TITLE_TEXT_Y","NODE_SLOT_HEIGHT","NODE_WIDGET_HEIGHT","NODE_WIDTH","NODE_MIN_WIDTH","NODE_COLLAPSED_RADIUS","NODE_COLLAPSED_WIDTH","NODE_TITLE_COLOR","NODE_SELECTED_TITLE_COLOR","NODE_TEXT_SIZE","NODE_TEXT_COLOR","NODE_SUBTEXT_SIZE","NODE_DEFAULT_COLOR","NODE_DEFAULT_BGCOLOR","NODE_DEFAULT_BOXCOLOR","NODE_DEFAULT_SHAPE","NODE_BOX_OUTLINE_COLOR","DEFAULT_SHADOW_COLOR","DEFAULT_GROUP_FONT","WIDGET_BGCOLOR","WIDGET_OUTLINE_COLOR","WIDGET_TEXT_COLOR","WIDGET_SECONDARY_TEXT_COLOR","LINK_COLOR","EVENT_LINK_COLOR","CONNECTING_LINK_COLOR","MAX_NUMBER_OF_NODES","DEFAULT_POSITION","VALID_SHAPES","BOX_SHAPE","ROUND_SHAPE","CIRCLE_SHAPE","CARD_SHAPE","ARROW_SHAPE","GRID_SHAPE","INPUT","OUTPUT","EVENT","ACTION","NODE_MODES","NODE_MODES_COLORS","ALWAYS","ON_EVENT","NEVER","ON_TRIGGER","UP","DOWN","LEFT","RIGHT","CENTER","LINK_RENDER_MODES","STRAIGHT_LINK","LINEAR_LINK","SPLINE_LINK","NORMAL_TITLE","NO_TITLE","TRANSPARENT_TITLE","AUTOHIDE_TITLE","VERTICAL_LAYOUT","proxy","node_images_path","debug","catch_exceptions","throw_errors","allow_scripts","registered_node_types","node_types_by_file_extension","Nodes","Globals","searchbox_extras","auto_sort_node_types","node_box_coloured_when_on","node_box_coloured_by_mode","dialog_close_on_mouse_leave","dialog_close_on_mouse_leave_delay","shift_click_do_break_link_from","click_do_break_link_to","search_hide_on_mouse_leave","search_filter_enabled","search_show_all_on_open","auto_load_slot_types","registered_slot_in_types","registered_slot_out_types","slot_types_in","slot_types_out","slot_types_default_in","slot_types_default_out","alt_drag_do_clone_nodes","do_add_triggers_slots","allow_multi_output_for_events","middle_click_slot_add_default_node","release_link_on_empty_shows_menu","pointerevents_method","registerNodeType","type","base_class","console","log","categories","split","classname","pos","lastIndexOf","category","substr","LGraphNode","prev","Object","hasOwnProperty","defineProperty","set","v","_shape","get","enumerable","configurable","onPropertyChange","warn","supported_extensions","ext","constructor","String","toLowerCase","onNodeTypeRegistered","onNodeTypeReplaced","nodeTmp","unregisterNodeType","registerNodeAndSlotType","slot_type","out","sCN","aTypes","sT","registerTo","nodes","includes","sort","wrapFunctionAsNode","func","param_types","return_type","properties","params","code","names","getParameterNames","JSON","stringify","classobj","Function","pop","desc","onExecute","getInputData","r","setOutputData","clearRegisteredTypes","addNodeMethod","createNode","options","node","err","error","properties_info","flags","size","computeSize","mode","onNodeCreated","getNodeType","getNodeTypesInCategory","filter","a","b","localeCompare","getNodeTypesCategories","skip_list","result","reloadNodes","folder_wildcard","tmp","document","getElementsByTagName","script_files","docHeadObj","location","href","src","dynamicScript","createElement","appendChild","removeChild","cloneObject","obj","target","parse","isValidConnection","type_a","type_b","indexOf","supported_types_a","supported_types_b","j","registerSearchboxExtra","node_type","description","data","fetchFile","url","on_complete","on_error","that","fetch","then","response","ok","arrayBuffer","text","json","blob","catch","File","Blob","reader","FileReader","onload","readAsArrayBuffer","readAsText","readAsBinaryString","performance","getTime","now","bind","Date","t","hrtime","LGraph","o","list_of_graphcanvas","clear","configure","supported_types","getSupportedTypes","STATUS_STOPPED","STATUS_RUNNING","stop","status","last_node_id","last_link_id","_version","_nodes","onRemoved","_nodes_by_id","_nodes_in_order","_nodes_executable","_groups","links","iteration","config","vars","extra","globaltime","runningtime","fixedtime","fixedtime_lapse","elapsed_time","last_update_time","starttime","catch_errors","nodes_executing","nodes_actioning","nodes_executedAction","inputs","outputs","change","sendActionToCanvas","attachCanvas","graphcanvas","LGraphCanvas","graph","detachCanvas","splice","start","interval","onPlayEvent","sendEventToAllNodes","window","requestAnimationFrame","on_frame","execution_timer_id","onBeforeStep","runStep","onAfterStep","setInterval","onStopEvent","clearInterval","num","do_not_catch_errors","limit","doExecute","onExecuteStep","onAfterExecute","errors_in_execution","elapsed","execution_time","updateExecutionOrder","computeExecutionOrder","only_onExecute","set_level","L","S","M","visited_links","remaining_links","l","id","l2","link","_level","shift","output","link_id","target_node","getNodeById","target_id","order","A","B","Ap","priority","Bp","getAncestors","ancestors","pending","visited","current","input","getInputNode","arrange","margin","layout","columns","col","x","column","max_size","y","max_size_index","node_size_index","setDirtyCanvas","getFixedTime","getElapsedTime","eventname","Subgraph","undefined","action","c","add","skip_compute_order","LGraphGroup","onAdded","align_to_grid","alignToGrid","onNodeAdded","remove","index","ignore_remove","beforeChange","slot","disconnectInput","disconnectOutput","canvas","selected_nodes","node_dragged","onNodeRemoved","afterChange","findNodesByClass","classObject","findNodesByType","findNodeByTitle","findNodesByTitle","getNodeOnPos","nodes_list","nRet","n","isPointInside","getGroupOnPos","g","checkNodeTypes","changes","ctor","newnode","serialize","onAction","param","_input_nodes","GraphInput","actionDo","trigger","onTrigger","addInput","value","onInputAdded","onInputsOutputsChange","setInputData","renameInput","old_name","onInputRenamed","changeInputType","onInputTypeChanged","removeInput","onInputRemoved","addOutput","onOutputAdded","getOutputData","renameOutput","onOutputRenamed","changeOutputType","onOutputTypeChanged","removeOutput","onOutputRemoved","triggerInput","setCallback","setTrigger","info","onBeforeChange","onAfterChange","connectionChange","link_info","onConnectionChange","isLive","live_mode","clearTriggeredSlots","_last_time","on_change","fg","bg","removeLink","target_slot","nodes_info","link2","LLink","groups_info","groups","onSerialize","keep_old","link_data","n_info","last_serialization","has_errors","group","onConfigure","load","callback","addEventListener","event","req","XMLHttpRequest","open","send","oEvent","onerror","onNodeTrace","msg","color","origin_id","origin_slot","_data","_pos","Float32Array","_ctor","connections","k","onPropertyChanged","onConnectionsChange","widgets","w","property","widgets_values","serialize_widgets","bgcolor","boxcolor","shape","clone","toString","getTitle","setProperty","prev_value","output_info","setOutputDataType","force_update","updateOutputData","getInputDataType","getInputDataByName","slot_name","findInputSlot","isInputConnected","getInputInfo","getInputLink","slot_info","getInputOrProperty","input_info","getOutputInfo","isOutputConnected","isAnyOutputConnected","getOutputNodes","addOnTriggerInput","trigS","optional","nameLocked","addOnExecutedOutput","findOutputSlot","onAfterExecuteNode","triggerSlot","changeMode","modeTo","ON_REQUEST","action_call","Math","floor","random","exec_version","execute_triggered","action_triggered","_last_trigger_time","target_connection","clearTriggeredSlot","setSize","onResize","addProperty","default_value","extra_info","addOutputs","addInputs","addConnection","direction","rows","max","font_size","title_width","compute_text_size","input_width","output_width","label","text_width","slot_start_y","widgets_height","widgets_up","widgets_start_y","min_height","getPropertyInfo","widgets_info","onGetPropertyInfo","widget","addWidget","values","addCustomWidget","custom_widget","getBounding","collapsed","onBounding","skip_title","margin_top","isInsideRectangle","_collapsed_width","getSlotInPosition","link_pos","getConnectionPos","returnObj","findInputSlotFree","optsIn","optsDef","typesNotAccepted","opts","assign","findOutputSlotFree","findInputSlotByType","preferFreeSlot","doNotUseOccupied","findSlotByType","findOutputSlotByType","aSlots","tFound","aSource","aDest","sI","dI","connectByType","target_slotType","createEventInCase","firstFreeIfOutputGeneralInCase","generalTypeInCase","Number","connect","connectByTypeOutput","source_node","source_slotType","firstFreeIfInputGeneralInCase","source_slot","changed","onBeforeConnectInput","onConnectInput","onConnectOutput","doProcessChange","onNodeConnectionChange","is_input","slot_number","num_slots","offset","horizontal","round","trace","MAX_CONSOLE","dirty_foreground","dirty_background","loadImage","img","Image","ready","captureInput","list","node_capturing_input","collapse","force","collapsable","pin","pinned","localToScreen","scale","node_colors","pale_blue","groupcolor","_bounding","subarray","_size","bounding","font","move","deltax","deltay","ignore_nodes","recomputeInsideNodes","node_bounding","overlapBounding","DragAndScale","element","skip_events","max_scale","min_scale","onredraw","enabled","last_mouse","visible_area","bindEvents","_binded_mouse_callback","onMouse","pointerListenerAdd","computeVisibleArea","viewport","width","height","startx","starty","endx","endy","rect","getBoundingClientRect","clientX","left","clientY","top","canvasx","canvasy","dragging","is_inside","ignore","onmouse","pointerListenerRemove","mouseDrag","eventType","wheel","deltaY","wheelDeltaY","detail","delta","wheelDelta","changeDeltaScale","preventDefault","stopPropagation","toCanvasContext","ctx","translate","convertOffsetToCanvas","convertCanvasToOffset","changeScale","zooming_center","center","abs","new_center","delta_offset","reset","background_image","DEFAULT_BACKGROUND_IMAGE","querySelector","ds","zoom_modify_alpha","title_text_font","inner_text_font","node_title_color","default_link_color","default_connection_color","input_off","input_on","output_off","output_on","default_connection_color_byType","default_connection_color_byTypeOff","highquality_render","use_gradients","editor_alpha","pause_rendering","clear_background","read_only","render_only_selected","show_info","allow_dragcanvas","allow_dragnodes","allow_interaction","allow_searchbox","allow_reconnect_links","drag_mode","dragging_rectangle","set_canvas_dirty_on_mouse_event","always_render_background","render_shadows","render_canvas_border","render_connections_shadows","render_connections_border","render_curved_connections","render_connection_arrows","render_collapsed_slots","render_execution_order","render_title_colored","render_link_tooltip","links_render_mode","mouse","graph_mouse","canvas_mouse","onSearchBox","onSearchBoxSelection","onDrawBackground","onDrawForeground","onDrawOverlay","onDrawLinkTooltip","onNodeMoved","onSelectionChange","onConnectingChange","connections_width","round_radius","current_node","node_widget","over_link_center","last_mouse_position","visible_links","setCanvas","skip_render","startRendering","autoresize","link_type_colors","number","gradients","frame","last_draw_time","render_time","fps","selected_group","visible_nodes","node_over","connecting_node","highlighted_links","dragging_canvas","dirty_canvas","dirty_bgcanvas","dirty_area","node_in_panel","last_mouseclick","pointer_is_down","pointer_is_double","onClear","setGraph","skip_clear","_graph_stack","setDirty","getTopGraph","openSubgraph","checkPanels","closeSubgraph","subgraph_node","_subgraph_node","centerOnNode","selectNodes","getCurrentGraph","getElementById","unbindEvents","className","tabindex","bgcanvas","getContext","localName","webgl_enabled","enableWebGL","_doNothing","doNothing","_doReturnTrue","_events_binded","ref_window","getCanvasWindow","_mousedown_callback","processMouseDown","_mousewheel_callback","processMouseWheel","_mousemove_callback","processMouseMove","_mouseup_callback","processMouseUp","_key_callback","processKey","_ondrop_callback","processDrop","removeEventListener","getFileExtension","question","point","GL","enableWebGLCanvas","gl","webgl","bgctx","fgcanvas","doc","ownerDocument","defaultView","parentWindow","is_rendering","renderFrame","draw","stopRendering","blockClick","block_click","adjustMouseEvent","active_canvas","canvasX","canvasY","skip_dragging","skip_action","is_primary","isPrimary","is_double_click","last_click_position","focus","closeAllContextMenus","which","ctrlKey","altKey","cloned","doCalcSize","block_drag_node","processNodeSelected","clicking_canvas_bg","bringToFront","resizable","resizing_node","style","cursor","connecting_output","slot_index","connecting_pos","connecting_slot","shiftKey","onOutputDblClick","onOutputClick","onInputDblClick","onInputClick","connecting_input","processNodeWidgets","onDblClick","processNodeDblClicked","onMouseDown","subgraph","skip_subgraph_button","showLinkMenu","selected_group_resizing","dist","distance","showSearchBox","mClikSlot","mClikSlot_index","mClikSlot_isOut","alphaPosY","posRef","nodeCreated","createDefaultNodeForSlot","nodeFrom","slotFrom","nodeTo","slotTo","position","nodeType","posAdd","posSizeFix","keys","metaKey","processContextMenu","last_mouse_dragging","activeElement","nodeName","resize","mouseOver","onMouseLeave","redraw_on_mouse","onMouseEnter","onMouseMove","_highlight_input","isOverNodeBox","isOverNodeInput","_highlight_input_slot","_highlight_output","isOverNodeOutput","over_link","desired_size","min_size","click_time","diffx","diffy","h","to_select","nodeX","connInOrOut","connType","node_from","slot_from","type_filter_in","node_to","type_filter_out","showConnectionMenu","deselectAllNodes","onMouseUp","title_height","slot_pos","block_default","keyCode","node_panel","close","options_panel","copyToClipboard","pasteFromClipboard","deleteSelectedNodes","onKeyDown","onKeyUp","stopImmediatePropagation","clipboard_info","selected_nodes_array","_relative_id","localStorage","setItem","getItem","posMin","posMinIndexes","node_data","origin_node","onDropItem","checkDropItem","onDropFile","onDropData","files","dataTransfer","file","filename","readAsDataURL","nodetype","onShowNodePanel","showShowNodePanel","onNodeDblClicked","selectNode","onNodeSelected","add_to_current_selection","is_selected","onSelected","deselectNode","onDeselected","onNodeDeselected","block_delete","input_link","output_link","input_node","output_node","clientX_rel","clientY_rel","deltaX","setZoom","convertEventToCanvasOffset","sendToBack","unshift","temp","computeVisibleNodes","force_canvas","force_bgcanvas","drawBackCanvas","drawFrontCanvas","start2D","restore","setTransform","area","save","beginPath","clip","clearRect","drawImage","onRender","renderInfo","drawn_nodes","drawNode","drawExecutionOrder","links_ontop","drawConnections","lineWidth","link_color","connDir","connShape","renderLink","fill","moveTo","lineTo","closePath","arc","PI","fillStyle","strokeStyle","strokeRect","drawLinkTooltip","visible_rect","drawSubgraphPanel","finish2D","subnode","drawSubgraphPanelLeft","drawSubgraphPanelRight","globalAlpha","roundRect","textAlign","fillText","drawButton","not_subgraph_input","input_node_type","showSubgraphPropertiesDialog","canvas_w","title_text","tw","measureText","output_node_type","showSubgraphPropertiesDialogRight","hovercolor","textcolor","yFix","hover","clicked","was_clicked","isAreaClicked","hold_click","toFixed","parent_graph","bg_already_painted","onRenderBackground","imageSmoothingEnabled","_bg_img","pattern","_pattern","createPattern","_pattern_img","fillRect","drawGroups","onBackgroundRender","shadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","finish","temp_vec2","glow","low_quality","onDrawCollapsed","min","clip_area","drawNodeShape","render_text","out_slot","in_slot","max_y","slot_shape","color_on","color_off","doStroke","stroke","widgets_y","drawNodeWidgets","input_slot","output_slot","Boolean","toToolTip","tmp_area","fgcolor","selected","mouse_over","title_mode","render_title","old_alpha","onDrawTitleBar","title_color","grad","createLinearGradient","addColorStop","colState","box_size","onDrawTitleBox","onDrawTitleText","title_text_color","measure","over","onDrawTitle","margin_area","link_bounding","tempA","tempB","start_node","start_node_slot","start_node_slotpos","end_node_slotpos","start_slot","end_slot","start_dir","end_dir","f","skip_border","flow","num_sublines","lineJoin","offsety","start_offset_x","start_offset_y","end_offset_x","end_offset_y","bezierCurveTo","start_x","start_y","end_x","end_y","computeConnectionPoint","posA","posB","posC","posD","angleA","angleB","atan2","rotate","p0","p1","p2","p3","c1","c2","c3","c4","posY","active_widget","H","show_text","outline_color","background_color","text_color","secondary_text_color","last_y","disabled","widget_width","range","nvalue","marker_nvalue","precision","widget_height","old_value","clamp","inner_value_change","step","values_list","inner_clicked","option","text_values","menu","ContextMenu","prompt","multiline","onWidgetChanged","DEFAULT_GROUP_FONT_SIZE","adjustNodesSize","parent","parentNode","offsetWidth","offsetHeight","switchLiveMode","transition","self","onNodeSelectionChange","onGroupAdd","entry","mouse_event","onMenuAdd","prev_menu","inner_onMenuAdded","base_category","startsWith","entries","map","base_category_regex","RegExp","category_name","replace","category_path","findIndex","content","has_submenu","mouseEvent","contextMenu","slice","first_event","getFirstEvent","parentMenu","onMenuCollapseAll","onMenuNodeEdit","showMenuNodeOptionalInputs","optional_inputs","onGetInputs","removable","onMenuNodeInputs","retEntries","onNodeInputAdd","showMenuNodeOptionalOutputs","optional_outputs","onGetOutputs","skip_repeated_outputs","onMenuNodeOutputs","onNodeOutputAdd","onShowMenuNodeProperties","getPropertyPrintableValue","decodeHTML","allow_html","showEditPropertyValue","str","innerText","innerHTML","onMenuResizeNode","fApplyMultiNode","node_left","node_right","fromType","destType","optPass","isFrom","isTo","slotX","iSlotConn","fromSlotType","slotTypesDefault","nodeNewType","typeX","nodeNewOpts","newNode","onShowPropertyEditor","item","input_html","dialog","is_modified","inner","offsetx","button","dialogCloseTimer","setValue","prompt_box","transform","prevent_timeout","selInDia","querySelectorAll","forEach","selIn","first","name_element","value_element","search_limit","def_options","do_type_filter","show_general_if_none_on_typefilter","show_general_after_typefiltered","hide_on_mouse_leave","show_all_if_empty","show_all_on_open","root_document","fullscreenElement","body","overflow","selOut","search_box","blur","timeout_close","helper","changeSelection","select","refreshHelper","nSlots","iK","opt","layerY","maxHeight","iS","forward","classList","childNodes","nextSibling","previousSibling","scrollIntoView","block","behavior","addResult","inner_test_filter","skipFilter","inTypeOverride","outTypeOverride","sType","sV","sIn","doesInc","sOut","filtered","filtered_extra","help","dataset","escape","unescape","createDialog","modified","checked","onclose","html","checkForInput","closeOnLeave","closeOnLeave_checkModified","aI","focused","iX","createPanel","root","header","closable","title_element","alt_content","footer","onClose","toggleAltContent","vTo","vAlt","display","toggleFooterVisibility","addHTML","on_footer","elem","addButton","addSeparator","str_value","inner_showCodePad","propname","toggle","innerChange","setAttribute","proptype","elem_that","onOpen","desc_value","closePanels","panel","showShowGraphOptionsPanel","refOpts","obEv","refMenu","refMenu2","lgraphcanvas","OPTIONPANEL_IS_OPEN","inner_refresh","fUpdate","key","aProps","availableCanvasOptions","pI","pX","aLinks","SELECTED_NODE","NODEPANEL_IS_OPEN","kV","nodeCol","nK","pName","onAddPropertyToPanel","onShowCustomPanelInfo","textarea","fDoneWith","float","old_panel","not_subgraph_output","panels","onMenuNodeCollapse","onMenuNodePin","onMenuNodeMode","onMenuNodeColors","fApplyColor","onMenuNodeShapes","onMenuNodeRemove","onMenuNodeToSubgraph","buildFromNodes","onMenuNodeClone","newSelected","clonable","red","brown","green","blue","cyan","purple","yellow","black","getCanvasMenuOptions","getMenuOptions","getExtraMenuOptions","getNodeMenuOptions","onGetNodeMenuOptions","getGroupMenuOptions","menu_info","inner_option_clicked","active_node","getSlotMenuOptions","_slot","locked","submenu","CanvasRenderingContext2D","radius","radius_low","top_left_radius","top_right_radius","bottom_left_radius","bottom_right_radius","quadraticCurveTo","compareObjects","sqrt","colorToString","growBounding","isInsideBounding","p","bb","A_end_x","A_end_y","B_end_x","B_end_y","hex2num","hex","charAt","toUpperCase","hex_alphabets","int1","int2","num2hex","triplet","lock","current_submenu","eventClass","minWidth","minHeight","pointerEvents","on_mouse_wheel","parseInt","scroll_speed","addItem","closing_timer","body_rect","root_rect","onclick_callback","inner_onclick","autoopen","inner_over","close_parent","ignore_item_callbacks","ignore_parent_menu","isCursorOverElement","event_name","origin","evt","createEvent","initCustomEvent","srcElement","dispatchEvent","__events","getTopMenu","elements","extendClass","__lookupGetter__","__defineGetter__","__lookupSetter__","__defineSetter__","CurveEditor","points","nearest","must_update","sampleCurve","pn","local_f","line_color","inactive","localpos","max_dist","getCloserPoint","s","curvepos","_nearest","is_edge_point","min_dist","closest","last_valid","vec2","oDOM","sEvIn","fCall","capture","sMethod","sEvent","PointerEvent","webkitRequestAnimationFrame","mozRequestAnimationFrame","Time","_is_subgraph","onSubgraphTrigger","onSubgraphNewInput","onSubgraphRenamedInput","onSubgraphTypeChangeInput","onSubgraphRemovedInput","onSubgraphNewOutput","onSubgraphRenamedOutput","onSubgraphTypeChangeOutput","onSubgraphRemovedOutput","overleft","num_inputs","num_outputs","oldname","subgraph_inputs","subgraph_outputs","ids","min_x","max_x","last_input_y","last_output_y","is_external","name_in_graph","name_widget","type_widget","value_widget","updateType","GraphOutput","_value","ConstantNumber","parseFloat","ConstantBoolean","ConstantString","ConstantObject","_object","ConstantFile","_url","_type","ConstantData","ConstantArray","SetArray","arr","ArrayElement","TableElement","table","row","ObjectProperty","ObjectKeys","SetObject","MergeObjects","_result","C","Variable","varname","container","LITEGRAPH","GRAPH","GLOBALSCOPE","getContainer","DownloadData","downloadAsFile","URL","createObjectURL","click","revokeObjectURL","Watch","Cast","Console","Alert","alert","NodeScript","_func","compileCode","code_low","forbidden_words","GenericCompare","OP","getOwnPropertyNames","bProps","propName","LogEvent","TriggerEvent","only_on_change","must_resend","Sequence","render_box","Stepper","FilterEvent","equal_to","has_property","property_equal_to","prop","EventBranch","EventCounter","doCountExecution","DelayEvent","_pending","time","time_in_ms","dt","actionPass","TimerEvent","last_interval","triggered","onStart","on_color","off_color","isNaN","SemaphoreEvent","_ready","DataStore","_last_value","WidgetButton","local_pos","message","WidgetToggle","WidgetNumber","old_y","_remainder","_precision","mouse_captured","pixels_threshold","markers_color","steps","WidgetCombo","_values","WidgetKnob","center_x","center_y","angle","cos","sin","oldmouse","m","WidgetSliderGUI","slider","WidgetHSlider","WidgetProgress","WidgetText","fontsize","align","glowSize","decimals","lines","last_ctx","WidgetPanel","borderColor","bgcolorTop","bgcolorBottom","shadowSize","borderRadius","createGradient","lineargradient","GamepadInput","gamepad_index","threshold","_left_axis","_right_axis","_triggers","_previous_buttons","Uint8Array","_current_buttons","zero","buttons","gamepad","getGamepad","xbox","axes","hatmap","mapping","lb","rb","lt","rt","back","ls","rs","mapping_array","getGamepads","navigator","webkitGetGamepads","mozGetGamepads","gamepads","xbox_mapping","hat","pressed","was_pressed","la","ra","Converter","count","Bypass","ToNumber","MathRange","_last_v","in_min","in_max","out_min","out_max","MathRand","MathNoise","getValue","smooth","f_min","r1","r2","iterations","octaves","amp","seed","speed","total_amp","persistence","MathSpikes","_remaining_time","_blink_time","duration","pow","max_time","min_time","MathClamp","getCode","lang","MathLerp","v1","v2","_f","MathAbs","MathFloor","MathFrac","MathSmoothStep","edge0","edge1","MathScale","factor","Gate","MathAverageFilter","_current","num_samples","avr","samples","old","MathTendTo","MathOperation","MathCompare","MathCondition","MathBranch","V","cond","MathAccumulate","inc","increment","MathTrigonometry","bgImageUrl","amplitude","tan","asin","acos","atan","MathFormula","formula","code_widget","_func_code","Math3DVec2ToXY","Math3DXYToVec2","Math3DVec3ToXYZ","Math3DXYZToVec3","z","Math3DVec4ToXYZW","Math3DXYZWToVec4","Math3DMat4","R_in_degrees","mat4","create","_must_update","temp_quat","temp_mat4","temp_vec3","Q","T","R","identity","vec3","DEG2RAD","quat","fromEuler","fromQuat","multiply","Math3DOperation","sub","mul","div","dot","cross","Math3DVec3Scale","Math3DVec3Length","Math3DVec3Normalize","Math3DVec3Lerp","Math3DVec3Dot","glMatrix","Math3DQuaternion","normalize","Math3DRotation","axis","fromValues","MathEulerToQuat","euler","use_yaw_pitch_roll","_degs","MathQuatToEuler","Math3DRotateVec3","vec","Math3DMultQuat","Math3DQuatSlerp","Math3DRemapRange","range_min","range_max","target_min","target_max","_clamped","setAxisAngle","q","toEuler","transformQuat","slerp","compare","concatenate","contains","separator","StringToTable","_table","_str","_last_separator","trim","Selector","sel","sequence","seq","current_sequence","logicAnd","ret","inX","logicOr","logicNot","logicCompare","last","logicBranch","condtition","GraphicsPlot","colors","GraphicsImage","dirty","onWidget","ColorPalette","colorA","colorB","colorC","colorD","ImageFrame","videoWidth","videoHeight","show","showElement","ImageFade","fade","createCanvas","ImageCrop","CanvasNode","autoclear","DrawImageNode","opacity","DrawRectangleNode","ImageVideo","use_proxy","_video_url","loadVideo","_video","currentTime","pause","play","onStop","protocol","host","muted","autoplay","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","playPause","paused","ImageWebcam","filterFacingMode","facingMode","is_webcam_open","openStream","mediaDevices","getUserMedia","_waiting_confirmation","constraints","audio","video","streamReady","onFailSoHard","_webcam_stream","closeStream","tracks","getTracks","localMediaStream","srcObject","onloadedmetadata","txt","LGraphTexture","image_preview_size","loadTextureCallback","UNDEFINED","PASS_THROUGH","COPY","LOW","HIGH","REUSE","DEFAULT","MODE_VALUES","copy","low","high","reuse","default","getTexturesContainer","textures","loadTexture","tex","Texture","fromURL","getTexture","getTargetTexture","tex_type","UNSIGNED_BYTE","HIGH_PRECISION_FORMAT","format","LINEAR","getTextureType","ref_texture","getWhiteTexture","_white_texture","texture","fromMemory","RGBA","wrap","REPEAT","NEAREST","getNoiseTexture","_noise_texture","noise","_drop_texture","fromDDSInMemory","_last_tex","setParameter","TEXTURE_MAG_FILTER","fullpath","onResourceRenamed","new_name","_last_preview_tex","_canvas","tex_canvas","generateLowResTexturePreview","cloneCanvas","temp_tex","DEPTH_COMPONENT","_preview_temp_tex","minFilter","copyTo","_preview_canvas","toCanvas","getResources","res","replaceCode","context","LGraphTexturePreview","flipY","allow_preview","handle","LGraphTextureSave","generate_mipmaps","getPreviewTexture","_texture","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","generateMipmap","texture_type","unbind","storeTexture","LGraphTextureOperation","pixelcode","uvcode","has_error","presets","_tex","texB","shader","_shader","_shader_code","final_pixel_code","pixel_shader","UV_CODE","PIXEL_CODE","Shader","SCREEN_VERTEX_SHADER","dumpErrorToConsole","drawTo","disable","DEPTH_TEST","CULL_FACE","BLEND","mesh","Mesh","getScreenQuad","uniforms","u_texture","u_textureB","texSize","registerPreset","onInspect","addCombo","refresh","LGraphTextureShader","u_value","u_color","_uniforms","vec4","in_texture","getShader","uniformInfo","already","loc","samplers","tex_slot","in_tex","setUniform","LGraphTextureScaleOffset","u_scale","u_offset","LGraphTextureWarp","u_factor","LGraphTextureToViewport","additive","antialiasing","disable_alpha","gamma","_prev_viewport","enable","blendFunc","SRC_ALPHA","ONE","ONE_MINUS_SRC_ALPHA","old_viewport","viewport_data","new_view","getViewport","aa_pixel_shader","uViewportSize","u_igamma","inverseVP","_gamma_shader","gamma_pixel_shader","toViewport","LGraphTextureCopy","_temp_texture","isPowerOfTwo","magFilter","LGraphTextureDownsample","TEXTURE_2D","releaseTemporary","getTemporary","LGraphTextureResize","LGraphTextureAverage","use_previous_frame","high_quality","u_mipmap_offset","_luminance","updateAverage","onPreRenderExecute","u_samples_a","u_samples_b","FLOAT","_temp_pot2_texture","mipmap_offset","pixel","getPixels","HALF_FLOAT","HALF_FLOAT_OES","LGraphTextureMinMax","_max","_min","_textures_chain","update","LGraphTextureTemporalSmooth","_temp_texture2","LGraphTextureLinearAvgSmooth","frames_interval","u_samples","u_isamples","_shader_copy","pixel_shader_copy","_shader_avg","pixel_shader_avg","_temp_texture_out","shader_copy","shader_avg","LGraphImageToTexture","gltexture","uploadImage","LGraphTextureLUT","intensity","lut_tex","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","bindTexture","u_amount","LGraphTextureEncode","num_row_symbols","symbol_size","brightness","colorize","invert","u_row_simbols","u_simbol_size","u_res","symbols_tex","u_symbol_size","u_brightness","u_invert","u_colorize","LGraphTextureChannels","texA","_channels","RGB","masks","u_mask","LGraphChannelsTexture","G","_color","u_textureR","u_textureG","u_textureA","white","texR","texG","LGraphTextureColor","_tex_color","sqrDist","LGraphTextureGradient","texture_size","u_angle","u_colorA","u_colorB","LGraphTextureMix","size_from_biggest","u_textureMix","u_mix","texMix","_shader_tex","MIX_TEX","_shader_factor","LGraphTextureEdges","u_isize","u_threshold","LGraphTextureDepthRange","only_depth","high_precision","u_distance","u_range","u_camera_planes","half_float_ext","_shader_onlydepth","ONLY_DEPTH","planes","near_far_planes","LS","Renderer","_main_camera","LGraphTextureLinearDepth","u_ires","DEPTH_STENCIL","LGraphTextureBlur","preserve_aspect","max_iterations","_final_texture","aspect","camera_aspect","applyBlur","FXGlow","dirt_texture","dirt_factor","_textures","u_intensity","u_glow_texture","u_texel_size","applyFX","output_texture","glow_texture","average_texture","texture_info","_cut_shader","cut_pixel_shader","currentDestination","blit","currentSource","texel_size","u_delta","scale_pixel_shader","final_texture","_dirt_final_shader","_final_shader","final_pixel_shader","USE_DIRT","LGraphTextureGlow","fx","_average_texture","_glow_texture","LGraphTextureKuwaharaFilter","max_radius","_shaders","RADIUS","u_resolution","u_iResolution","LGraphTextureXDoGFilter","sigma","epsilon","phi","_xdog_shader","xdog_pixel_shader","cvsWidth","cvsHeight","LGraphTextureWebcam","texture_name","_video_texture","LGraphLensFX","LGraphTextureFromData","channels","LUMINANCE","uploadData","LGraphTextureCurve","split_channels","_curve_texture","u_curve","_points","curve_editor","curve_offset","updateCurve","curve_texture","curves","channel_line_colors","channel","globalCompositeOperation","LGraphExposition","exposition","u_exposition","exp","exp_input","LGraphToneMapping","average_lum","lum_white","u_lumwhite2","u_average_lum","avg","u_average_texture","_shader_texture","AVG_TEXTURE","LGraphTexturePerlin","_key","u_persistence","u_seed","u_viewport","u_octaves","u_amplitude","LGraphTextureCanvas2D","default_code","use_html_canvas","executeDraw","func_context","_ctx","clearColor","COLOR_BUFFER_BIT","LGraphTextureMatte","key_color","slope","u_key_color","u_slope","LGraphCubemapToTexture2D","yaw","TEXTURE_CUBE_MAP","cubemapToTexture2D","SHADERNODES_COLOR","LGShaders","Shaders","GLSL_types","GLSL_types_const","GLSL_functions_desc","GLSL_functions","GLSL_functions_name","parseGLSLDescriptions","ALL_TYPES","op","index2","func_name","registerShaderNode","node_ctor","clearDestination","shader_destination","propagateDestination","dest_name","getShaderNodeVarName","getInputLinkID","getOutputVarName","getOutputLinkID","valueToGLSL","varToTypeGLSL","input_type","output_type","convertVarToGLSLType","target_type","LGShaderContext","vs_template","fs_template","buffer_names","uvs","_functions","_codeparts","_uniform_value","addUniform","addFunction","addCode","hook","destinations","computeCodeBlocks","extra_uniforms","vertexout","fragmentout","functions","blocks","computeShaderCode","vs_code","replaceCodeUsingContext","fs_code","computeShader","finalcode","_shader_error","updateShader","join","fillUniforms","ShaderContext","Context","LGraphShaderGraph","alpha","inputNode","sampler","outnode","_context","template","intex","inputs_y","onDrawSubgraphBackground","shaderNodeFromFunction","LGraphShaderUniform","onGetCode","LGraphShaderAttribute","LGraphShaderSampler2D","texname","uvname","link0","link1","LGraphShaderConstant","updateWidgets","link_name","LGraphShaderVec2","varmodes","props","varmode","inlink","outlink","LGraphShaderVec3","LGraphShaderVec4","LGraphShaderFragColor","LGraphShaderOperation","operation","operations","inlinks","base_type","param_code","LGraphShaderFunc","func_desc","LGraphShaderSnippet","inlinkA","inlinkB","inA_type","inB_type","funcname","func_code","LGraphShaderRand","LGraphShaderNoise","NOISE_TYPES","intype","shader_functions","LGraphShaderTime","LGraphShaderDither","dither_func","dither_values","LGraphShaderRemap","min_value","max_value","min_value2","max_value2","minv","maxv","minv2","maxv2","view_matrix","projection_matrix","viewprojection_matrix","model_matrix","global_uniforms","u_view","u_projection","u_viewprojection","u_model","LGraphRender","onRequestCameraMatrices","generateGeometryId","LGraphPoints3D","num_points","generate_normals","regular","SPHERE","normals","geometry","vertices","_id","_old_obj","_last_radius","RECTANGLE","CIRCLE","CUBE","HEMISPHERE","INSIDE_SPHERE","OBJECT","OBJECT_UNIFORMLY","OBJECT_INSIDE","_old_obj_version","updatePoints","generatePoints","side","polarToCartesian","generateSphericalNormals","generateSphere","generateHemisphere","generateInsideCircle","generateInsideSphere","generateFromObject","generateFromInsideObject","u","theta","cbrt","sinTheta","cosTheta","sinPhi","cosPhi","findRandomTriangle","areas","imin","imid","imax","evenly","mesh_normals","indices","vertexBuffers","indexBuffers","triangles","num_triangles","total_area","P1","P2","P3","aL","bL","cL","sqrt_s","af","bf","cf","N","aabb","getBoundingBox","octree","Octree","tries","hit","testRay","ALL","LGraphPointsToInstances","autoupdate","matrices","first_time","NORMAL","VERTICAL","SPHERICAL","RANDOM","RANDOM_VERTICAL","modes","geo","has_changed","_geometry_id","updateInstances","FRONT","front","right","setTranslation","normal","LGraphGeometryTransform","_last_geometry_id","_last_version","_last_key","model","_output","typedArrayToArray","updateGeometry","old_vertices","multiplyVec3","normal_model","transpose","old_normals","LGraphGeometryPolygon","sides","geometry_id","last_info","gen_uvs","coords","LGraphGeometryExtrude","top_cap","bottom_cap","_last_geo_version","_geo","extrudeGeometry","tempC","tempD","new_vertices","npos","out_geo","LGraphGeometryEval","execute_every_frame","LGraphConnectPoints","max_connections","probability","my_version","x2","y2","z2","Uint32Array","LGraphToGeometry","last_mesh","buffer","LGraphGeometryToMesh","updateMesh","buffer_data","common_buffers","spacing","mesh_buffer","Buffer","ELEMENT_ARRAY_BUFFER","ARRAY_BUFFER","DYNAMIC_DRAW","upload","addBuffer","updateBoundingBox","LGraphRenderMesh","primitive","TRIANGLES","PRIMITIVE_VALUES","POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLE_FAN","TRIANGLE_STRIP","shaders","LGraphRenderPoints","vertex_shader_code","fragment_shader_code","USE_TEXTURE","u_point_size","depthMask","LGraphGeometryPrimitive","subdivisions","VALID","_mesh","cube","plane","xz","cylinder","sphere","lat","circle","slices","hemi","icosahedron","cone","point_size","fixed_size","u_perspective","u_point_perspective","USE_TEXTURED_POINTS","USE_POINTS","LGraphFXLens","aberration","distortion","pixel_data","LGraphFXBokeh","LGraphFXGeneric","value1","value2","LGraphFXVigneting","u_aberration","u_distortion","u_blur","blurred_tex","mask_tex","shape_tex","first_shader","_first_shader","_first_pixel_shader","second_shader","_second_shader","_second_vertex_shader","_second_pixel_shader","points_mesh","_points_mesh","_width","_height","_spacing","createPointsMesh","screen_mesh","min_light","u_texture_blur","u_texsize","u_shape","u_alpha","u_pointSize","u_itexsize","nwidth","nheight","ny","dx","dy","nx","vertices2D","pixel_shader_code","camera","_current_camera","camera_planes","near","far","u_noise","u_size","u_rand","u_value1","u_value2","pixel_shader_halftone","pixel_shader_pixelate","pixel_shader_lowpalette","pixel_shader_noise","pixel_shader_gamma","MIDI_COLOR","MIDIEvent","cmd","setup","fromJSON","raw_data","midiStatus","midiCommand","NOTEON","velocity","NOTEOFF","cmd_str","commands","notes","note_to_index","D","E","F","toNoteString","octave","getPitch","computePitch","note","getCC","getCCValue","getPitchBend","computePitchBend","setCommandFromString","computeCommandFromString","KEYPRESSURE","CONTROLLERCHANGE","PROGRAMCHANGE","CHANNELPRESSURE","PITCHBEND","TIMETICK","d","skip_octave","NoteStringToPitch","pitch","toHexString","toJSON","object_class","commands_short","commands_reversed","MIDIInterface","on_ready","requestMIDIAccess","state","cc","input_ports","input_ports_info","output_ports","output_ports_info","onMIDISuccess","onMIDIFailure","midiAccess","midi","updatePorts","it","it_value","next","done","port_info","manufacturer","num_input_ports","num_output_ports","openInputPort","port","input_port","onmidimessage","midi_event","updateState","on_message","parseMsg","sendMIDI","midi_data","output_port","LGMIDIIn","_last_midi_event","_current_midi_event","_midi","_waiting","onMIDIEvent","LGMIDIOut","getMIDIOutputs","default_ports","LGMIDIShow","LGMIDIFilter","_learning","LGMIDIEvent","gate","LGMIDICC","LGMIDIGenerator","notes_pitches","processScale","sequence_index","LGMIDITranspose","amount","LGMIDIQuantize","valid_notes","offset_notes","_current_scale","LGMIDIFromFile","_current_time","_playing","MidiParser","loadMIDIFile","current_time","track","_last_pos","_time","deltaTime","midi_cmd","LGMIDIPlay","volume","AudioSynth","Synth","synth","instrument","createInstrument","LGMIDIKeys","num_octaves","start_octave","num_keys","key_width","key_height","key_info","getKeyIndex","start_note","LGAudio","getAudioContext","_audio_context","AudioContext","webkitAudioContext","onmessage","onended","oncomplete","audionodeA","audionodeB","disconnect","changeAllAudiosConnections","origin_audionode","getAudioNodeInOutputSlot","audionode","target_audionode","getAudioNodeInInputSlot","connection","connected","local_audionode","createAudioNodeWrapper","class_object","old_func","cached_audios","loadSound","onProcessAudioURL","request","responseType","decodeAudioData","onError","LGAudioSource","gain","loop","playbackRate","_loading_audio","_audiobuffer","_audionodes","_last_sourcenode","createGain","graphnode","playBuffer","stopAllSounds","onPause","pauseAllSounds","onUnpause","unpauseAllSounds","_dropped_url","started","suspend","resume","createBufferSource","_request","abort","LGAudioMediaSource","_media_stream","audiosource_node","createMediaStreamSource","LGAudioAnalyser","fftSize","minDecibels","maxDecibels","smoothingTimeConstant","createAnalyser","_freq_bin","_time_bin","bufferLength","frequencyBinCount","getByteFrequencyData","getByteTimeDomainData","LGAudioGain","LGAudioConvolver","impulse_src","createConvolver","onRemove","loadImpulse","_impulse_buffer","_loading_impulse","LGAudioDynamicsCompressor","knee","ratio","reduction","attack","release","createDynamicsCompressor","LGAudioWaveShaper","createWaveShaper","curve","setWaveShape","LGAudioMixer","gain1","gain2","audionode1","audionode2","LGAudioADSR","audioContext","current_gate","cancelScheduledValues","setValueAtTime","linearRampToValueAtTime","LGAudioDelay","delayTime","createDelay","LGAudioBiquadFilter","frequency","detune","createBiquadFilter","LGAudioOscillatorNode","createOscillator","LGAudioVisualization","continuous","mark","_last_buffer","samplerate","sampleRate","binfreq","LGAudioBandSignal","band","_freqs","v0","LGAudioScript","default_function","createScriptProcessor","processCode","_bypass_function","onaudioprocess","_callback","_script","_old_code","audioProcessingEvent","inputBuffer","outputBuffer","numberOfChannels","inputData","getChannelData","outputData","sample","LGAudioDestination","destination","LGWebSocket","room","only_send_changes","_ws","_last_sent_data","_last_received_data","connectSocket","readyState","WebSocket","OPEN","only_changes","onopen","LGSillyClient","room_widget","setRoom","_server","SillyClient","room_name","is_connected","prev_data","is_equal","sendMessage","_error","on_close","_final_url","OVERLAY_ID","OldModule","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","isParcelRequire","hostname","ws","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","parcelRequire","every","generated","js","hmrApply","hmrAcceptRun","reload","removeErrorOverlay","stack","overlay","createErrorOverlay","stackTrace","getParents","modules","parents","dep","isArray","deps","cached","cache","some","cb"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA,IAAIA,OAAO,GAAGC,MAAM,CAACC,OAAO,GAAG,CAAC,CAAC;;AAEjC;AACA;AACA;AACA;;AAEA,IAAIC,gBAAgB;AACpB,IAAIC,kBAAkB;AAEtB,SAASC,gBAAgB,GAAG;EACxB,MAAM,IAAIC,KAAK,CAAC,iCAAiC,CAAC;AACtD;AACA,SAASC,mBAAmB,GAAI;EAC5B,MAAM,IAAID,KAAK,CAAC,mCAAmC,CAAC;AACxD;AACC,aAAY;EACT,IAAI;IACA,IAAI,OAAOE,UAAU,KAAK,UAAU,EAAE;MAClCL,gBAAgB,GAAGK,UAAU;IACjC,CAAC,MAAM;MACHL,gBAAgB,GAAGE,gBAAgB;IACvC;EACJ,CAAC,CAAC,OAAOI,CAAC,EAAE;IACRN,gBAAgB,GAAGE,gBAAgB;EACvC;EACA,IAAI;IACA,IAAI,OAAOK,YAAY,KAAK,UAAU,EAAE;MACpCN,kBAAkB,GAAGM,YAAY;IACrC,CAAC,MAAM;MACHN,kBAAkB,GAAGG,mBAAmB;IAC5C;EACJ,CAAC,CAAC,OAAOE,CAAC,EAAE;IACRL,kBAAkB,GAAGG,mBAAmB;EAC5C;AACJ,CAAC,GAAG;AACJ,SAASI,UAAU,CAACC,GAAG,EAAE;EACrB,IAAIT,gBAAgB,KAAKK,UAAU,EAAE;IACjC;IACA,OAAOA,UAAU,CAACI,GAAG,EAAE,CAAC,CAAC;EAC7B;EACA;EACA,IAAI,CAACT,gBAAgB,KAAKE,gBAAgB,IAAI,CAACF,gBAAgB,KAAKK,UAAU,EAAE;IAC5EL,gBAAgB,GAAGK,UAAU;IAC7B,OAAOA,UAAU,CAACI,GAAG,EAAE,CAAC,CAAC;EAC7B;EACA,IAAI;IACA;IACA,OAAOT,gBAAgB,CAACS,GAAG,EAAE,CAAC,CAAC;EACnC,CAAC,CAAC,OAAMH,CAAC,EAAC;IACN,IAAI;MACA;MACA,OAAON,gBAAgB,CAACU,IAAI,CAAC,IAAI,EAAED,GAAG,EAAE,CAAC,CAAC;IAC9C,CAAC,CAAC,OAAMH,CAAC,EAAC;MACN;MACA,OAAON,gBAAgB,CAACU,IAAI,CAAC,IAAI,EAAED,GAAG,EAAE,CAAC,CAAC;IAC9C;EACJ;AAGJ;AACA,SAASE,eAAe,CAACC,MAAM,EAAE;EAC7B,IAAIX,kBAAkB,KAAKM,YAAY,EAAE;IACrC;IACA,OAAOA,YAAY,CAACK,MAAM,CAAC;EAC/B;EACA;EACA,IAAI,CAACX,kBAAkB,KAAKG,mBAAmB,IAAI,CAACH,kBAAkB,KAAKM,YAAY,EAAE;IACrFN,kBAAkB,GAAGM,YAAY;IACjC,OAAOA,YAAY,CAACK,MAAM,CAAC;EAC/B;EACA,IAAI;IACA;IACA,OAAOX,kBAAkB,CAACW,MAAM,CAAC;EACrC,CAAC,CAAC,OAAON,CAAC,EAAC;IACP,IAAI;MACA;MACA,OAAOL,kBAAkB,CAACS,IAAI,CAAC,IAAI,EAAEE,MAAM,CAAC;IAChD,CAAC,CAAC,OAAON,CAAC,EAAC;MACP;MACA;MACA,OAAOL,kBAAkB,CAACS,IAAI,CAAC,IAAI,EAAEE,MAAM,CAAC;IAChD;EACJ;AAIJ;AACA,IAAIC,KAAK,GAAG,EAAE;AACd,IAAIC,QAAQ,GAAG,KAAK;AACpB,IAAIC,YAAY;AAChB,IAAIC,UAAU,GAAG,CAAC,CAAC;AAEnB,SAASC,eAAe,GAAG;EACvB,IAAI,CAACH,QAAQ,IAAI,CAACC,YAAY,EAAE;IAC5B;EACJ;EACAD,QAAQ,GAAG,KAAK;EAChB,IAAIC,YAAY,CAACG,MAAM,EAAE;IACrBL,KAAK,GAAGE,YAAY,CAACI,MAAM,CAACN,KAAK,CAAC;EACtC,CAAC,MAAM;IACHG,UAAU,GAAG,CAAC,CAAC;EACnB;EACA,IAAIH,KAAK,CAACK,MAAM,EAAE;IACdE,UAAU,EAAE;EAChB;AACJ;AAEA,SAASA,UAAU,GAAG;EAClB,IAAIN,QAAQ,EAAE;IACV;EACJ;EACA,IAAIO,OAAO,GAAGb,UAAU,CAACS,eAAe,CAAC;EACzCH,QAAQ,GAAG,IAAI;EAEf,IAAIQ,GAAG,GAAGT,KAAK,CAACK,MAAM;EACtB,OAAMI,GAAG,EAAE;IACPP,YAAY,GAAGF,KAAK;IACpBA,KAAK,GAAG,EAAE;IACV,OAAO,EAAEG,UAAU,GAAGM,GAAG,EAAE;MACvB,IAAIP,YAAY,EAAE;QACdA,YAAY,CAACC,UAAU,CAAC,CAACO,GAAG,EAAE;MAClC;IACJ;IACAP,UAAU,GAAG,CAAC,CAAC;IACfM,GAAG,GAAGT,KAAK,CAACK,MAAM;EACtB;EACAH,YAAY,GAAG,IAAI;EACnBD,QAAQ,GAAG,KAAK;EAChBH,eAAe,CAACU,OAAO,CAAC;AAC5B;AAEAxB,OAAO,CAAC2B,QAAQ,GAAG,UAAUf,GAAG,EAAE;EAC9B,IAAIgB,IAAI,GAAG,IAAIC,KAAK,CAACC,SAAS,CAACT,MAAM,GAAG,CAAC,CAAC;EAC1C,IAAIS,SAAS,CAACT,MAAM,GAAG,CAAC,EAAE;IACtB,KAAK,IAAIU,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,SAAS,CAACT,MAAM,EAAEU,CAAC,EAAE,EAAE;MACvCH,IAAI,CAACG,CAAC,GAAG,CAAC,CAAC,GAAGD,SAAS,CAACC,CAAC,CAAC;IAC9B;EACJ;EACAf,KAAK,CAACgB,IAAI,CAAC,IAAIC,IAAI,CAACrB,GAAG,EAAEgB,IAAI,CAAC,CAAC;EAC/B,IAAIZ,KAAK,CAACK,MAAM,KAAK,CAAC,IAAI,CAACJ,QAAQ,EAAE;IACjCN,UAAU,CAACY,UAAU,CAAC;EAC1B;AACJ,CAAC;;AAED;AACA,SAASU,IAAI,CAACrB,GAAG,EAAEsB,KAAK,EAAE;EACtB,IAAI,CAACtB,GAAG,GAAGA,GAAG;EACd,IAAI,CAACsB,KAAK,GAAGA,KAAK;AACtB;AACAD,IAAI,CAACE,SAAS,CAACT,GAAG,GAAG,YAAY;EAC7B,IAAI,CAACd,GAAG,CAACwB,KAAK,CAAC,IAAI,EAAE,IAAI,CAACF,KAAK,CAAC;AACpC,CAAC;AACDlC,OAAO,CAACqC,KAAK,GAAG,SAAS;AAEzBrC,OAAO,CAACsC,GAAG,GAAG,CAAC,CAAC;AAChBtC,OAAO,CAACuC,IAAI,GAAG,EAAE;AACjBvC,OAAO,CAACwC,OAAO,GAAG,EAAE,CAAC,CAAC;AACtBxC,OAAO,CAACyC,QAAQ,GAAG,CAAC,CAAC;AAErB,SAASC,IAAI,GAAG,CAAC;AAEjB1C,OAAO,CAAC2C,EAAE,GAAGD,IAAI;AACjB1C,OAAO,CAAC4C,WAAW,GAAGF,IAAI;AAC1B1C,OAAO,CAAC6C,IAAI,GAAGH,IAAI;AACnB1C,OAAO,CAAC8C,GAAG,GAAGJ,IAAI;AAClB1C,OAAO,CAAC+C,cAAc,GAAGL,IAAI;AAC7B1C,OAAO,CAACgD,kBAAkB,GAAGN,IAAI;AACjC1C,OAAO,CAACiD,IAAI,GAAGP,IAAI;AACnB1C,OAAO,CAACkD,eAAe,GAAGR,IAAI;AAC9B1C,OAAO,CAACmD,mBAAmB,GAAGT,IAAI;AAElC1C,OAAO,CAACoD,SAAS,GAAG,UAAUC,IAAI,EAAE;EAAE,OAAO,EAAE;AAAC,CAAC;AAEjDrD,OAAO,CAACsD,OAAO,GAAG,UAAUD,IAAI,EAAE;EAC9B,MAAM,IAAI/C,KAAK,CAAC,kCAAkC,CAAC;AACvD,CAAC;AAEDN,OAAO,CAACuD,GAAG,GAAG,YAAY;EAAE,OAAO,GAAG;AAAC,CAAC;AACxCvD,OAAO,CAACwD,KAAK,GAAG,UAAUC,GAAG,EAAE;EAC3B,MAAM,IAAInD,KAAK,CAAC,gCAAgC,CAAC;AACrD,CAAC;AACDN,OAAO,CAAC0D,KAAK,GAAG,YAAW;EAAE,OAAO,CAAC;AAAE,CAAC;;;;;ACvLxC;;AAGA,CAAC,UAASC,MAAM,EAAE;EACd;EACA;EACA;;EAEA;AACJ;AACA;AACA;AACA;AACA;;EAEI,IAAIC,SAAS,GAAID,MAAM,CAACC,SAAS,GAAG;IAChCC,OAAO,EAAE,GAAG;IAEZC,gBAAgB,EAAE,EAAE;IAEpBC,iBAAiB,EAAE,EAAE;IACrBC,iBAAiB,EAAE,EAAE;IACrBC,gBAAgB,EAAE,EAAE;IACpBC,kBAAkB,EAAE,EAAE;IACtBC,UAAU,EAAE,GAAG;IACfC,cAAc,EAAE,EAAE;IAClBC,qBAAqB,EAAE,EAAE;IACzBC,oBAAoB,EAAE,EAAE;IACxBC,gBAAgB,EAAE,MAAM;IACxBC,yBAAyB,EAAE,MAAM;IACjCC,cAAc,EAAE,EAAE;IAClBC,eAAe,EAAE,MAAM;IACvBC,iBAAiB,EAAE,EAAE;IACrBC,kBAAkB,EAAE,MAAM;IAC1BC,oBAAoB,EAAE,SAAS;IAC/BC,qBAAqB,EAAE,MAAM;IAC7BC,kBAAkB,EAAE,KAAK;IACzBC,sBAAsB,EAAE,MAAM;IAC9BC,oBAAoB,EAAE,iBAAiB;IACvCC,kBAAkB,EAAE,EAAE;IAEtBC,cAAc,EAAE,MAAM;IACtBC,oBAAoB,EAAE,MAAM;IAC5BC,iBAAiB,EAAE,MAAM;IACzBC,2BAA2B,EAAE,MAAM;IAEnCC,UAAU,EAAE,MAAM;IAClBC,gBAAgB,EAAE,MAAM;IACxBC,qBAAqB,EAAE,MAAM;IAE7BC,mBAAmB,EAAE,IAAI;IAAE;IAC3BC,gBAAgB,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC;IAAE;IAC9BC,YAAY,EAAE,CAAC,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,CAAC;IAAE;;IAEnD;IACAC,SAAS,EAAE,CAAC;IACZC,WAAW,EAAE,CAAC;IACdC,YAAY,EAAE,CAAC;IACfC,UAAU,EAAE,CAAC;IACbC,WAAW,EAAE,CAAC;IACdC,UAAU,EAAE,CAAC;IAAE;;IAEf;IACAC,KAAK,EAAE,CAAC;IACRC,MAAM,EAAE,CAAC;IAETC,KAAK,EAAE,CAAC,CAAC;IAAE;IACXC,MAAM,EAAE,CAAC,CAAC;IAAE;;IAEZC,UAAU,EAAE,CAAC,QAAQ,EAAE,UAAU,EAAE,OAAO,EAAE,YAAY,CAAC;IAAE;IAC3DC,iBAAiB,EAAC,CAAC,MAAM,EAAC,MAAM,EAAC,MAAM,EAAC,MAAM,EAAC,MAAM,CAAC;IAAE;IACxDC,MAAM,EAAE,CAAC;IACTC,QAAQ,EAAE,CAAC;IACXC,KAAK,EAAE,CAAC;IACRC,UAAU,EAAE,CAAC;IAEbC,EAAE,EAAE,CAAC;IACLC,IAAI,EAAE,CAAC;IACPC,IAAI,EAAE,CAAC;IACPC,KAAK,EAAE,CAAC;IACRC,MAAM,EAAE,CAAC;IAETC,iBAAiB,EAAE,CAAC,UAAU,EAAE,QAAQ,EAAE,QAAQ,CAAC;IAAE;IACrDC,aAAa,EAAE,CAAC;IAChBC,WAAW,EAAE,CAAC;IACdC,WAAW,EAAE,CAAC;IAEdC,YAAY,EAAE,CAAC;IACfC,QAAQ,EAAE,CAAC;IACXC,iBAAiB,EAAE,CAAC;IACpBC,cAAc,EAAE,CAAC;IACjBC,eAAe,EAAE,UAAU;IAAE;;IAE7BC,KAAK,EAAE,IAAI;IAAE;IACbC,gBAAgB,EAAE,EAAE;IAEpBC,KAAK,EAAE,KAAK;IACZC,gBAAgB,EAAE,IAAI;IACtBC,YAAY,EAAE,IAAI;IAClBC,aAAa,EAAE,KAAK;IAAE;IACtBC,qBAAqB,EAAE,CAAC,CAAC;IAAE;IAC3BC,4BAA4B,EAAE,CAAC,CAAC;IAAE;IAClCC,KAAK,EAAE,CAAC,CAAC;IAAE;IACjBC,OAAO,EAAE,CAAC,CAAC;IAAE;;IAEPC,gBAAgB,EAAE,CAAC,CAAC;IAAE;IACtBC,oBAAoB,EAAE,KAAK;IAAE;;IAEnCC,yBAAyB,EAAE,KAAK;IAAE;IAC5BC,yBAAyB,EAAE,KAAK;IAAE;;IAElCC,2BAA2B,EAAE,IAAI;IAAE;IACnCC,iCAAiC,EAAE,GAAG;IAEtCC,8BAA8B,EAAE,KAAK;IAAE;IACvCC,sBAAsB,EAAE,KAAK;IAAE;;IAE/BC,0BAA0B,EAAE,IAAI;IAAE;IAClCC,qBAAqB,EAAE,KAAK;IAAE;IAC9BC,uBAAuB,EAAE,IAAI;IAAE;;IAE/BC,oBAAoB,EAAE,KAAK;IAAE;;IAEnC;IACMC,wBAAwB,EAAE,CAAC,CAAC;IAAE;IAC9BC,yBAAyB,EAAE,CAAC,CAAC;IAAE;IAC/BC,aAAa,EAAE,EAAE;IAAE;IACnBC,cAAc,EAAE,EAAE;IAAE;IACpBC,qBAAqB,EAAE,EAAE;IAAE;IACjCC,sBAAsB,EAAE,EAAE;IAAE;;IAE5BC,uBAAuB,EAAE,KAAK;IAAE;;IAEhCC,qBAAqB,EAAE,KAAK;IAAE;;IAE9BC,6BAA6B,EAAE,IAAI;IAAE;;IAErCC,kCAAkC,EAAE,KAAK;IAAE;;IAE3CC,gCAAgC,EAAE,KAAK;IAAE;;IAEnCC,oBAAoB,EAAE,OAAO;IAAE;IAC/B;;IAEA;AACR;AACA;AACA;AACA;AACA;;IAEQC,gBAAgB,EAAE,0BAASC,IAAI,EAAEC,UAAU,EAAE;MACzC,IAAI,CAACA,UAAU,CAAC5H,SAAS,EAAE;QACvB,MAAM,sEAAsE;MAChF;MACA4H,UAAU,CAACD,IAAI,GAAGA,IAAI;MAEtB,IAAIlG,SAAS,CAACiE,KAAK,EAAE;QACjBmC,OAAO,CAACC,GAAG,CAAC,mBAAmB,GAAGH,IAAI,CAAC;MAC3C;MAEA,IAAII,UAAU,GAAGJ,IAAI,CAACK,KAAK,CAAC,GAAG,CAAC;MAChC,IAAIC,SAAS,GAAGL,UAAU,CAAC1G,IAAI;MAE/B,IAAIgH,GAAG,GAAGP,IAAI,CAACQ,WAAW,CAAC,GAAG,CAAC;MAC/BP,UAAU,CAACQ,QAAQ,GAAGT,IAAI,CAACU,MAAM,CAAC,CAAC,EAAEH,GAAG,CAAC;MAEzC,IAAI,CAACN,UAAU,CAAC1H,KAAK,EAAE;QACnB0H,UAAU,CAAC1H,KAAK,GAAG+H,SAAS;MAChC;MACA;;MAEA;MACA,IAAIL,UAAU,CAAC5H,SAAS,EAAE;QACtB;QACA,KAAK,IAAIJ,CAAC,IAAI0I,UAAU,CAACtI,SAAS,EAAE;UAChC,IAAI,CAAC4H,UAAU,CAAC5H,SAAS,CAACJ,CAAC,CAAC,EAAE;YAC1BgI,UAAU,CAAC5H,SAAS,CAACJ,CAAC,CAAC,GAAG0I,UAAU,CAACtI,SAAS,CAACJ,CAAC,CAAC;UACrD;QACJ;MACJ;MAEA,IAAI2I,IAAI,GAAG,IAAI,CAACzC,qBAAqB,CAAC6B,IAAI,CAAC;MACpD,IAAGY,IAAI,EACNV,OAAO,CAACC,GAAG,CAAC,uBAAuB,GAAGH,IAAI,CAAC,CAAC,KAE7C;QACC,IAAI,CAACa,MAAM,CAACC,cAAc,CAAEb,UAAU,CAAC5H,SAAS,EAAE,OAAO,CAAC,EAC1DwI,MAAM,CAACE,cAAc,CAACd,UAAU,CAAC5H,SAAS,EAAE,OAAO,EAAE;UACpD2I,GAAG,EAAE,aAASC,CAAC,EAAE;YAChB,QAAQA,CAAC;cACR,KAAK,SAAS;gBACb,OAAO,IAAI,CAACC,MAAM;gBAClB;cACD,KAAK,KAAK;gBACT,IAAI,CAACA,MAAM,GAAGpH,SAAS,CAACiC,SAAS;gBACjC;cACD,KAAK,OAAO;gBACX,IAAI,CAACmF,MAAM,GAAGpH,SAAS,CAACkC,WAAW;gBACnC;cACD,KAAK,QAAQ;gBACZ,IAAI,CAACkF,MAAM,GAAGpH,SAAS,CAACmC,YAAY;gBACpC;cACD,KAAK,MAAM;gBACV,IAAI,CAACiF,MAAM,GAAGpH,SAAS,CAACoC,UAAU;gBAClC;cACD;gBACC,IAAI,CAACgF,MAAM,GAAGD,CAAC;YAAC;UAEnB,CAAC;UACDE,GAAG,EAAE,aAASF,CAAC,EAAE;YAChB,OAAO,IAAI,CAACC,MAAM;UACnB,CAAC;UACDE,UAAU,EAAE,IAAI;UAChBC,YAAY,EAAE;QACf,CAAC,CAAC;;QAEF;QACA,IAAIpB,UAAU,CAAC5H,SAAS,CAACiJ,gBAAgB,EAAE;UAC1CpB,OAAO,CAACqB,IAAI,CACX,uBAAuB,GACtBvB,IAAI,GACJ,qFAAqF,CACtF;QACF;;QAEA;QACA,IAAIC,UAAU,CAACuB,oBAAoB,EAAE;UACpC,KAAK,IAAIvJ,CAAC,IAAIgI,UAAU,CAACuB,oBAAoB,EAAE;YAC9C,IAAIC,GAAG,GAAGxB,UAAU,CAACuB,oBAAoB,CAACvJ,CAAC,CAAC;YAC5C,IAAGwJ,GAAG,IAAIA,GAAG,CAACC,WAAW,KAAKC,MAAM,EACnC,IAAI,CAACvD,4BAA4B,CAAEqD,GAAG,CAACG,WAAW,EAAE,CAAE,GAAG3B,UAAU;UACrE;QACD;MACD;MAES,IAAI,CAAC9B,qBAAqB,CAAC6B,IAAI,CAAC,GAAGC,UAAU;MAC7C,IAAIA,UAAU,CAACyB,WAAW,CAACnI,IAAI,EAAE;QAC7B,IAAI,CAAC8E,KAAK,CAACiC,SAAS,CAAC,GAAGL,UAAU;MACtC;MACA,IAAInG,SAAS,CAAC+H,oBAAoB,EAAE;QAChC/H,SAAS,CAAC+H,oBAAoB,CAAC7B,IAAI,EAAEC,UAAU,CAAC;MACpD;MACA,IAAIW,IAAI,IAAI9G,SAAS,CAACgI,kBAAkB,EAAE;QACtChI,SAAS,CAACgI,kBAAkB,CAAC9B,IAAI,EAAEC,UAAU,EAAEW,IAAI,CAAC;MACxD;;MAEA;MACA,IAAIX,UAAU,CAAC5H,SAAS,CAACiJ,gBAAgB,EAAE;QACvCpB,OAAO,CAACqB,IAAI,CACR,uBAAuB,GACnBvB,IAAI,GACJ,qFAAqF,CAC5F;MACL;;MAET;MACS,IAAIC,UAAU,CAACuB,oBAAoB,EAAE;QACjC,KAAK,IAAIvJ,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAGgI,UAAU,CAACuB,oBAAoB,CAACjK,MAAM,EAAEU,CAAC,EAAE,EAAE;UAC1E,IAAIwJ,GAAG,GAAGxB,UAAU,CAACuB,oBAAoB,CAACvJ,CAAC,CAAC;UAC5C,IAAGwJ,GAAG,IAAIA,GAAG,CAACC,WAAW,KAAKC,MAAM,EACpB,IAAI,CAACvD,4BAA4B,CAAEqD,GAAG,CAACG,WAAW,EAAE,CAAE,GAAG3B,UAAU;QACxE;MACJ;;MAEA;MACA;MACA,IAAI,IAAI,CAACf,oBAAoB,EAAE6C,OAAO,GAAG,IAAI9B,UAAU,CAACA,UAAU,CAAC1H,KAAK,IAAI,SAAS,CAAC;IAC1F,CAAC;IAED;AACR;AACA;AACA;AACA;IACQyJ,kBAAkB,EAAE,4BAAShC,IAAI,EAAE;MACxC,IAAIC,UAAU,GAAGD,IAAI,CAAC0B,WAAW,KAAKC,MAAM,GAAG,IAAI,CAACxD,qBAAqB,CAAC6B,IAAI,CAAC,GAAGA,IAAI;MACtF,IAAG,CAACC,UAAU,EACb,MAAM,uBAAuB,GAAGD,IAAI;MACrC,OAAO,IAAI,CAAC7B,qBAAqB,CAAC8B,UAAU,CAACD,IAAI,CAAC;MAClD,IAAGC,UAAU,CAACyB,WAAW,CAACnI,IAAI,EAC7B,OAAO,IAAI,CAAC8E,KAAK,CAAC4B,UAAU,CAACyB,WAAW,CAACnI,IAAI,CAAC;IAChD,CAAC;IAEK;AACR;AACA;AACA;AACA;AACA;IACQ0I,uBAAuB,EAAE,iCAASjC,IAAI,EAACkC,SAAS,EAACC,GAAG,EAAC;MACjDA,GAAG,GAAGA,GAAG,IAAI,KAAK;MAClB,IAAIlC,UAAU,GAAGD,IAAI,CAAC0B,WAAW,KAAKC,MAAM,IAAI,IAAI,CAACxD,qBAAqB,CAAC6B,IAAI,CAAC,KAAK,WAAW,GAAG,IAAI,CAAC7B,qBAAqB,CAAC6B,IAAI,CAAC,GAAGA,IAAI;MAE1I,IAAIoC,GAAG,GAAGnC,UAAU,CAACyB,WAAW,CAAC1B,IAAI;MAErC,IAAI,OAAOkC,SAAS,IAAI,QAAQ,EAAC;QAC7B,IAAIG,MAAM,GAAGH,SAAS,CAAC7B,KAAK,CAAC,GAAG,CAAC;MACrC,CAAC,MAAK,IAAI6B,SAAS,IAAI,IAAI,CAAC3F,KAAK,IAAI2F,SAAS,IAAI,IAAI,CAAC1F,MAAM,EAAC;QAC1D,IAAI6F,MAAM,GAAG,CAAC,SAAS,CAAC;MAC5B,CAAC,MAAI;QACD,IAAIA,MAAM,GAAG,CAAC,GAAG,CAAC;MACtB;MAEA,KAAK,IAAIpK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGoK,MAAM,CAAC9K,MAAM,EAAE,EAAEU,CAAC,EAAE;QACpC,IAAIqK,EAAE,GAAGD,MAAM,CAACpK,CAAC,CAAC,CAAC,CAAC;QACpB,IAAIqK,EAAE,KAAK,EAAE,EAAC;UACVA,EAAE,GAAG,GAAG;QACZ;QACA,IAAIC,UAAU,GAAGJ,GAAG,GAAG,2BAA2B,GAAG,0BAA0B;QAC/E,IAAI,OAAO,IAAI,CAACI,UAAU,CAAC,CAACD,EAAE,CAAC,IAAI,WAAW,EAAE,IAAI,CAACC,UAAU,CAAC,CAACD,EAAE,CAAC,GAAG;UAACE,KAAK,EAAE;QAAE,CAAC;QAClF,IAAI,CAACD,UAAU,CAAC,CAACD,EAAE,CAAC,CAACE,KAAK,CAACtK,IAAI,CAACkK,GAAG,CAAC;;QAEpC;QACA,IAAI,CAACD,GAAG,EAAC;UACL,IAAI,CAAC,IAAI,CAAC9C,aAAa,CAACoD,QAAQ,CAACH,EAAE,CAACV,WAAW,EAAE,CAAC,EAAC;YAC/C,IAAI,CAACvC,aAAa,CAACnH,IAAI,CAACoK,EAAE,CAACV,WAAW,EAAE,CAAC;YACzC,IAAI,CAACvC,aAAa,CAACqD,IAAI,EAAE;UAC7B;QACJ,CAAC,MAAI;UACD,IAAI,CAAC,IAAI,CAACpD,cAAc,CAACmD,QAAQ,CAACH,EAAE,CAACV,WAAW,EAAE,CAAC,EAAC;YAChD,IAAI,CAACtC,cAAc,CAACpH,IAAI,CAACoK,EAAE,CAACV,WAAW,EAAE,CAAC;YAC1C,IAAI,CAACtC,cAAc,CAACoD,IAAI,EAAE;UAC9B;QACJ;MACJ;IACJ,CAAC;IAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACQC,kBAAkB,EAAE,4BAChBpJ,IAAI,EACJqJ,IAAI,EACJC,WAAW,EACXC,WAAW,EACXC,UAAU,EACZ;MACE,IAAIC,MAAM,GAAGjL,KAAK,CAAC6K,IAAI,CAACrL,MAAM,CAAC;MAC/B,IAAI0L,IAAI,GAAG,EAAE;MACb,IAAIC,KAAK,GAAGpJ,SAAS,CAACqJ,iBAAiB,CAACP,IAAI,CAAC;MAC7C,KAAK,IAAI3K,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiL,KAAK,CAAC3L,MAAM,EAAE,EAAEU,CAAC,EAAE;QACnCgL,IAAI,IACA,iBAAiB,GACjBC,KAAK,CAACjL,CAAC,CAAC,GACR,IAAI,IACH4K,WAAW,IAAIA,WAAW,CAAC5K,CAAC,CAAC,GACxB,GAAG,GAAG4K,WAAW,CAAC5K,CAAC,CAAC,GAAG,GAAG,GAC1B,GAAG,CAAC,GACV,MAAM;MACd;MACAgL,IAAI,IACA,uBAAuB,IACtBH,WAAW,GAAG,GAAG,GAAGA,WAAW,GAAG,GAAG,GAAG,CAAC,CAAC,GAC3C,MAAM;MACV,IAAIC,UAAU,EAAE;QACZE,IAAI,IACA,oBAAoB,GAAGG,IAAI,CAACC,SAAS,CAACN,UAAU,CAAC,GAAG,KAAK;MACjE;MACA,IAAIO,QAAQ,GAAGC,QAAQ,CAACN,IAAI,CAAC;MAC7BK,QAAQ,CAAC/K,KAAK,GAAGgB,IAAI,CAAC8G,KAAK,CAAC,GAAG,CAAC,CAACmD,GAAG,EAAE;MACtCF,QAAQ,CAACG,IAAI,GAAG,iBAAiB,GAAGb,IAAI,CAACrJ,IAAI;MAC7C+J,QAAQ,CAACjL,SAAS,CAACqL,SAAS,GAAG,SAASA,SAAS,GAAG;QAChD,KAAK,IAAIzL,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+K,MAAM,CAACzL,MAAM,EAAE,EAAEU,CAAC,EAAE;UACpC+K,MAAM,CAAC/K,CAAC,CAAC,GAAG,IAAI,CAAC0L,YAAY,CAAC1L,CAAC,CAAC;QACpC;QACA,IAAI2L,CAAC,GAAGhB,IAAI,CAACtK,KAAK,CAAC,IAAI,EAAE0K,MAAM,CAAC;QAChC,IAAI,CAACa,aAAa,CAAC,CAAC,EAAED,CAAC,CAAC;MAC5B,CAAC;MACD,IAAI,CAAC7D,gBAAgB,CAACxG,IAAI,EAAE+J,QAAQ,CAAC;IACzC,CAAC;IAED;AACR;AACA;IACQQ,oBAAoB,EAAE,gCAAW;MAC7B,IAAI,CAAC3F,qBAAqB,GAAG,CAAC,CAAC;MAC/B,IAAI,CAACC,4BAA4B,GAAG,CAAC,CAAC;MACtC,IAAI,CAACC,KAAK,GAAG,CAAC,CAAC;MACf,IAAI,CAACE,gBAAgB,GAAG,CAAC,CAAC;IAC9B,CAAC;IAED;AACR;AACA;AACA;AACA;AACA;IACQwF,aAAa,EAAE,uBAASxK,IAAI,EAAEqJ,IAAI,EAAE;MAChCjC,UAAU,CAACtI,SAAS,CAACkB,IAAI,CAAC,GAAGqJ,IAAI;MACjC,KAAK,IAAI3K,CAAC,IAAI,IAAI,CAACkG,qBAAqB,EAAE;QACtC,IAAI6B,IAAI,GAAG,IAAI,CAAC7B,qBAAqB,CAAClG,CAAC,CAAC;QACxC,IAAI+H,IAAI,CAAC3H,SAAS,CAACkB,IAAI,CAAC,EAAE;UACtByG,IAAI,CAAC3H,SAAS,CAAC,GAAG,GAAGkB,IAAI,CAAC,GAAGyG,IAAI,CAAC3H,SAAS,CAACkB,IAAI,CAAC;QACrD,CAAC,CAAC;QACFyG,IAAI,CAAC3H,SAAS,CAACkB,IAAI,CAAC,GAAGqJ,IAAI;MAC/B;IACJ,CAAC;IAED;AACR;AACA;AACA;AACA;AACA;AACA;;IAEQoB,UAAU,EAAE,oBAAShE,IAAI,EAAEzH,KAAK,EAAE0L,OAAO,EAAE;MACvC,IAAIhE,UAAU,GAAG,IAAI,CAAC9B,qBAAqB,CAAC6B,IAAI,CAAC;MACjD,IAAI,CAACC,UAAU,EAAE;QACb,IAAInG,SAAS,CAACiE,KAAK,EAAE;UACjBmC,OAAO,CAACC,GAAG,CACP,kBAAkB,GAAGH,IAAI,GAAG,mBAAmB,CAClD;QACL;QACA,OAAO,IAAI;MACf;MAEA,IAAI3H,SAAS,GAAG4H,UAAU,CAAC5H,SAAS,IAAI4H,UAAU;MAElD1H,KAAK,GAAGA,KAAK,IAAI0H,UAAU,CAAC1H,KAAK,IAAIyH,IAAI;MAEzC,IAAIkE,IAAI,GAAG,IAAI;MAEf,IAAIpK,SAAS,CAACkE,gBAAgB,EAAE;QAC5B,IAAI;UACAkG,IAAI,GAAG,IAAIjE,UAAU,CAAC1H,KAAK,CAAC;QAChC,CAAC,CAAC,OAAO4L,GAAG,EAAE;UACVjE,OAAO,CAACkE,KAAK,CAACD,GAAG,CAAC;UAClB,OAAO,IAAI;QACf;MACJ,CAAC,MAAM;QACHD,IAAI,GAAG,IAAIjE,UAAU,CAAC1H,KAAK,CAAC;MAChC;MAEA2L,IAAI,CAAClE,IAAI,GAAGA,IAAI;MAEhB,IAAI,CAACkE,IAAI,CAAC3L,KAAK,IAAIA,KAAK,EAAE;QACtB2L,IAAI,CAAC3L,KAAK,GAAGA,KAAK;MACtB;MACA,IAAI,CAAC2L,IAAI,CAACnB,UAAU,EAAE;QAClBmB,IAAI,CAACnB,UAAU,GAAG,CAAC,CAAC;MACxB;MACA,IAAI,CAACmB,IAAI,CAACG,eAAe,EAAE;QACvBH,IAAI,CAACG,eAAe,GAAG,EAAE;MAC7B;MACA,IAAI,CAACH,IAAI,CAACI,KAAK,EAAE;QACbJ,IAAI,CAACI,KAAK,GAAG,CAAC,CAAC;MACnB;MACA,IAAI,CAACJ,IAAI,CAACK,IAAI,EAAE;QACZL,IAAI,CAACK,IAAI,GAAGL,IAAI,CAACM,WAAW,EAAE;QAC1C;MACQ;;MACA,IAAI,CAACN,IAAI,CAAC3D,GAAG,EAAE;QACX2D,IAAI,CAAC3D,GAAG,GAAGzG,SAAS,CAAC+B,gBAAgB,CAACrE,MAAM,EAAE;MAClD;MACA,IAAI,CAAC0M,IAAI,CAACO,IAAI,EAAE;QACZP,IAAI,CAACO,IAAI,GAAG3K,SAAS,CAAC6C,MAAM;MAChC;;MAEA;MACA,IAAIsH,OAAO,EAAE;QACT,KAAK,IAAIhM,CAAC,IAAIgM,OAAO,EAAE;UACnBC,IAAI,CAACjM,CAAC,CAAC,GAAGgM,OAAO,CAAChM,CAAC,CAAC;QACxB;MACJ;;MAET;MACS,IAAKiM,IAAI,CAACQ,aAAa,EAAG;QACtBR,IAAI,CAACQ,aAAa,EAAE;MACxB;MAEA,OAAOR,IAAI;IACf,CAAC;IAED;AACR;AACA;AACA;AACA;AACA;IACQS,WAAW,EAAE,qBAAS3E,IAAI,EAAE;MACxB,OAAO,IAAI,CAAC7B,qBAAqB,CAAC6B,IAAI,CAAC;IAC3C,CAAC;IAED;AACR;AACA;AACA;AACA;AACA;;IAEQ4E,sBAAsB,EAAE,gCAASnE,QAAQ,EAAEoE,MAAM,EAAE;MAC/C,IAAIjB,CAAC,GAAG,EAAE;MACV,KAAK,IAAI3L,CAAC,IAAI,IAAI,CAACkG,qBAAqB,EAAE;QACtC,IAAI6B,IAAI,GAAG,IAAI,CAAC7B,qBAAqB,CAAClG,CAAC,CAAC;QACxC,IAAI+H,IAAI,CAAC6E,MAAM,IAAIA,MAAM,EAAE;UACvB;QACJ;QAEA,IAAIpE,QAAQ,IAAI,EAAE,EAAE;UAChB,IAAIT,IAAI,CAACS,QAAQ,IAAI,IAAI,EAAE;YACvBmD,CAAC,CAAC1L,IAAI,CAAC8H,IAAI,CAAC;UAChB;QACJ,CAAC,MAAM,IAAIA,IAAI,CAACS,QAAQ,IAAIA,QAAQ,EAAE;UAClCmD,CAAC,CAAC1L,IAAI,CAAC8H,IAAI,CAAC;QAChB;MACJ;MAEA,IAAI,IAAI,CAACxB,oBAAoB,EAAE;QAC3BoF,CAAC,CAAClB,IAAI,CAAC,UAASoC,CAAC,EAACC,CAAC,EAAC;UAAC,OAAOD,CAAC,CAACvM,KAAK,CAACyM,aAAa,CAACD,CAAC,CAACxM,KAAK,CAAC;QAAA,CAAC,CAAC;MAChE;MAEA,OAAOqL,CAAC;IACZ,CAAC;IAED;AACR;AACA;AACA;AACA;AACA;IACQqB,sBAAsB,EAAE,gCAAUJ,MAAM,EAAG;MACvC,IAAIzE,UAAU,GAAG;QAAE,EAAE,EAAE;MAAE,CAAC;MAC1B,KAAK,IAAInI,CAAC,IAAI,IAAI,CAACkG,qBAAqB,EAAE;QAClD,IAAI6B,IAAI,GAAG,IAAI,CAAC7B,qBAAqB,CAAClG,CAAC,CAAC;QAC5B,IAAK+H,IAAI,CAACS,QAAQ,IAAI,CAACT,IAAI,CAACkF,SAAS,EACrC;UACX,IAAGlF,IAAI,CAAC6E,MAAM,IAAIA,MAAM,EACvB;UACczE,UAAU,CAACJ,IAAI,CAACS,QAAQ,CAAC,GAAG,CAAC;QACjC;MACJ;MACA,IAAI0E,MAAM,GAAG,EAAE;MACf,KAAK,IAAIlN,CAAC,IAAImI,UAAU,EAAE;QACtB+E,MAAM,CAACjN,IAAI,CAACD,CAAC,CAAC;MAClB;MACA,OAAO,IAAI,CAACuG,oBAAoB,GAAG2G,MAAM,CAACzC,IAAI,EAAE,GAAGyC,MAAM;IAC7D,CAAC;IAED;IACAC,WAAW,EAAE,qBAASC,eAAe,EAAE;MACnC,IAAIC,GAAG,GAAGC,QAAQ,CAACC,oBAAoB,CAAC,QAAQ,CAAC;MACjD;MACA,IAAIC,YAAY,GAAG,EAAE;MACrB,KAAK,IAAIxN,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAGqN,GAAG,CAAC/N,MAAM,EAAEU,CAAC,EAAE,EAAE;QAC/BwN,YAAY,CAACvN,IAAI,CAACoN,GAAG,CAACrN,CAAC,CAAC,CAAC;MAC7B;MAEA,IAAIyN,UAAU,GAAGH,QAAQ,CAACC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;MACzDH,eAAe,GAAGE,QAAQ,CAACI,QAAQ,CAACC,IAAI,GAAGP,eAAe;MAE1D,KAAK,IAAIpN,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAGwN,YAAY,CAAClO,MAAM,EAAEU,CAAC,EAAE,EAAE;QACxC,IAAI4N,GAAG,GAAGJ,YAAY,CAACxN,CAAC,CAAC,CAAC4N,GAAG;QAC7B,IACI,CAACA,GAAG,IACJA,GAAG,CAACnF,MAAM,CAAC,CAAC,EAAE2E,eAAe,CAAC9N,MAAM,CAAC,IAAI8N,eAAe,EAC1D;UACE;QACJ;QAEA,IAAI;UACA,IAAIvL,SAAS,CAACiE,KAAK,EAAE;YACjBmC,OAAO,CAACC,GAAG,CAAC,aAAa,GAAG0F,GAAG,CAAC;UACpC;UACA,IAAIC,aAAa,GAAGP,QAAQ,CAACQ,aAAa,CAAC,QAAQ,CAAC;UACpDD,aAAa,CAAC9F,IAAI,GAAG,iBAAiB;UACtC8F,aAAa,CAACD,GAAG,GAAGA,GAAG;UACvBH,UAAU,CAACM,WAAW,CAACF,aAAa,CAAC;UACrCJ,UAAU,CAACO,WAAW,CAACR,YAAY,CAACxN,CAAC,CAAC,CAAC;QAC3C,CAAC,CAAC,OAAOkM,GAAG,EAAE;UACV,IAAIrK,SAAS,CAACmE,YAAY,EAAE;YACxB,MAAMkG,GAAG;UACb;UACA,IAAIrK,SAAS,CAACiE,KAAK,EAAE;YACjBmC,OAAO,CAACC,GAAG,CAAC,wBAAwB,GAAG0F,GAAG,CAAC;UAC/C;QACJ;MACJ;MAEA,IAAI/L,SAAS,CAACiE,KAAK,EAAE;QACjBmC,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAC;MACjC;IACJ,CAAC;IAED;IACA+F,WAAW,EAAE,qBAASC,GAAG,EAAEC,MAAM,EAAE;MAC/B,IAAID,GAAG,IAAI,IAAI,EAAE;QACb,OAAO,IAAI;MACf;MACA,IAAIvC,CAAC,GAAGR,IAAI,CAACiD,KAAK,CAACjD,IAAI,CAACC,SAAS,CAAC8C,GAAG,CAAC,CAAC;MACvC,IAAI,CAACC,MAAM,EAAE;QACT,OAAOxC,CAAC;MACZ;MAEA,KAAK,IAAI3L,CAAC,IAAI2L,CAAC,EAAE;QACbwC,MAAM,CAACnO,CAAC,CAAC,GAAG2L,CAAC,CAAC3L,CAAC,CAAC;MACpB;MACA,OAAOmO,MAAM;IACjB,CAAC;IAED;AACR;AACA;AACA;AACA;AACA;AACA;IACQE,iBAAiB,EAAE,2BAASC,MAAM,EAAEC,MAAM,EAAE;MACjD,IAAID,MAAM,IAAE,EAAE,IAAIA,MAAM,KAAG,GAAG,EAAEA,MAAM,GAAG,CAAC;MAC1C,IAAIC,MAAM,IAAE,EAAE,IAAIA,MAAM,KAAG,GAAG,EAAEA,MAAM,GAAG,CAAC;MACjC,IACI,CAACD,MAAM,CAAC;MAAA,GACL,CAACC,MAAM,CAAC;MAAA,GACRD,MAAM,IAAIC,MAAM,CAAC;MAAA,GAChBD,MAAM,IAAIzM,SAAS,CAACyC,KAAK,IAAIiK,MAAM,IAAI1M,SAAS,CAAC0C,MAAO,EAC9D;QACE,OAAO,IAAI;MACf;;MAEA;MACA+J,MAAM,GAAG5E,MAAM,CAAC4E,MAAM,CAAC;MACvBC,MAAM,GAAG7E,MAAM,CAAC6E,MAAM,CAAC;MACvBD,MAAM,GAAGA,MAAM,CAAC3E,WAAW,EAAE;MAC7B4E,MAAM,GAAGA,MAAM,CAAC5E,WAAW,EAAE;;MAE7B;MACA,IAAI2E,MAAM,CAACE,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,IAAID,MAAM,CAACC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE;QACxD,OAAOF,MAAM,IAAIC,MAAM;MAC3B;;MAEA;MACA,IAAIE,iBAAiB,GAAGH,MAAM,CAAClG,KAAK,CAAC,GAAG,CAAC;MACzC,IAAIsG,iBAAiB,GAAGH,MAAM,CAACnG,KAAK,CAAC,GAAG,CAAC;MACzC,KAAK,IAAIpI,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGyO,iBAAiB,CAACnP,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC/C,KAAK,IAAI2O,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,iBAAiB,CAACpP,MAAM,EAAE,EAAEqP,CAAC,EAAE;UAC/C,IAAG,IAAI,CAACN,iBAAiB,CAACI,iBAAiB,CAACzO,CAAC,CAAC,EAAC0O,iBAAiB,CAACC,CAAC,CAAC,CAAC,EAAC;YACpF;YACmB,OAAO,IAAI;UACf;QACJ;MACJ;MAEA,OAAO,KAAK;IAChB,CAAC;IAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;IACQC,sBAAsB,EAAE,gCAASC,SAAS,EAAEC,WAAW,EAAEC,IAAI,EAAE;MAC3D,IAAI,CAACzI,gBAAgB,CAACwI,WAAW,CAACnF,WAAW,EAAE,CAAC,GAAG;QAC/C5B,IAAI,EAAE8G,SAAS;QACfrD,IAAI,EAAEsD,WAAW;QACjBC,IAAI,EAAEA;MACV,CAAC;IACL,CAAC;IAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACEC,SAAS,EAAE,mBAAUC,GAAG,EAAElH,IAAI,EAAEmH,WAAW,EAAEC,QAAQ,EAAG;MACvD,IAAIC,IAAI,GAAG,IAAI;MACf,IAAG,CAACH,GAAG,EACN,OAAO,IAAI;MAEZlH,IAAI,GAAGA,IAAI,IAAI,MAAM;MACrB,IAAIkH,GAAG,CAACxF,WAAW,KAAKC,MAAM,EAC9B;QACC,IAAIuF,GAAG,CAACxG,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,MAAM,IAAI5G,SAAS,CAAC+D,KAAK,EAAE;UAClDqJ,GAAG,GAAGpN,SAAS,CAAC+D,KAAK,GAAGqJ,GAAG,CAACxG,MAAM,CAACwG,GAAG,CAACT,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QACzD;QACA,OAAOa,KAAK,CAACJ,GAAG,CAAC,CAChBK,IAAI,CAAC,UAASC,QAAQ,EAAE;UACxB,IAAG,CAACA,QAAQ,CAACC,EAAE,EACb,MAAM,IAAIjR,KAAK,CAAC,gBAAgB,CAAC,CAAC,CAAC;UACrC,IAAGwJ,IAAI,IAAI,aAAa,EACvB,OAAOwH,QAAQ,CAACE,WAAW,EAAE,CAAC,KAC1B,IAAG1H,IAAI,IAAI,MAAM,IAAIA,IAAI,IAAI,QAAQ,EACzC,OAAOwH,QAAQ,CAACG,IAAI,EAAE,CAAC,KACnB,IAAG3H,IAAI,IAAI,MAAM,EACrB,OAAOwH,QAAQ,CAACI,IAAI,EAAE,CAAC,KACnB,IAAG5H,IAAI,IAAI,MAAM,EACrB,OAAOwH,QAAQ,CAACK,IAAI,EAAE;QACxB,CAAC,CAAC,CACDN,IAAI,CAAC,UAASP,IAAI,EAAE;UACpB,IAAGG,WAAW,EACbA,WAAW,CAACH,IAAI,CAAC;QACnB,CAAC,CAAC,CACDc,KAAK,CAAC,UAAS1D,KAAK,EAAE;UACtBlE,OAAO,CAACkE,KAAK,CAAC,sBAAsB,EAAC8C,GAAG,CAAC;UACzC,IAAGE,QAAQ,EACVA,QAAQ,CAAChD,KAAK,CAAC;QACjB,CAAC,CAAC;MACH,CAAC,MACI,IAAI8C,GAAG,CAACxF,WAAW,KAAKqG,IAAI,IAAIb,GAAG,CAACxF,WAAW,KAAKsG,IAAI,EAC7D;QACC,IAAIC,MAAM,GAAG,IAAIC,UAAU,EAAE;QAC7BD,MAAM,CAACE,MAAM,GAAG,UAASxR,CAAC,EAC1B;UACC,IAAIsK,CAAC,GAAGtK,CAAC,CAACyP,MAAM,CAACjB,MAAM;UACvB,IAAInF,IAAI,IAAI,MAAM,EACjBiB,CAAC,GAAGmC,IAAI,CAACiD,KAAK,CAACpF,CAAC,CAAC;UAClB,IAAGkG,WAAW,EACbA,WAAW,CAAClG,CAAC,CAAC;QAChB,CAAC;QACD,IAAGjB,IAAI,IAAI,aAAa,EACvB,OAAOiI,MAAM,CAACG,iBAAiB,CAAClB,GAAG,CAAC,CAAC,KACjC,IAAGlH,IAAI,IAAI,MAAM,IAAIA,IAAI,IAAI,MAAM,EACvC,OAAOiI,MAAM,CAACI,UAAU,CAACnB,GAAG,CAAC,CAAC,KAC1B,IAAGlH,IAAI,IAAI,MAAM,EACrB,OAAOiI,MAAM,CAACK,kBAAkB,CAACpB,GAAG,CAAC;MACvC;MACA,OAAO,IAAI;IACZ;EACE,CAAE;;EAEF;EACA,IAAI,OAAOqB,WAAW,IAAI,WAAW,EAAE;IACnCzO,SAAS,CAAC0O,OAAO,GAAGD,WAAW,CAACE,GAAG,CAACC,IAAI,CAACH,WAAW,CAAC;EACzD,CAAC,MAAM,IAAI,OAAOI,IAAI,IAAI,WAAW,IAAIA,IAAI,CAACF,GAAG,EAAE;IAC/C3O,SAAS,CAAC0O,OAAO,GAAGG,IAAI,CAACF,GAAG,CAACC,IAAI,CAACC,IAAI,CAAC;EAC3C,CAAC,MAAM,IAAI,OAAOzS,OAAO,IAAI,WAAW,EAAE;IACtC4D,SAAS,CAAC0O,OAAO,GAAG,YAAW;MAC3B,IAAII,CAAC,GAAG1S,OAAO,CAAC2S,MAAM,EAAE;MACxB,OAAOD,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;IACrC,CAAC;EACL,CAAC,MAAM;IACH9O,SAAS,CAAC0O,OAAO,GAAG,SAASA,OAAO,GAAG;MACnC,OAAO,IAAIG,IAAI,EAAE,CAACH,OAAO,EAAE;IAC/B,CAAC;EACL;;EAEA;EACA;EACA;;EAEA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEI,SAASM,MAAM,CAACC,CAAC,EAAE;IACf,IAAIjP,SAAS,CAACiE,KAAK,EAAE;MACjBmC,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC;IAChC;IACA,IAAI,CAAC6I,mBAAmB,GAAG,IAAI;IAC/B,IAAI,CAACC,KAAK,EAAE;IAEZ,IAAIF,CAAC,EAAE;MACH,IAAI,CAACG,SAAS,CAACH,CAAC,CAAC;IACrB;EACJ;EAEAlP,MAAM,CAACiP,MAAM,GAAGhP,SAAS,CAACgP,MAAM,GAAGA,MAAM;;EAEzC;EACAA,MAAM,CAACK,eAAe,GAAG,CAAC,QAAQ,EAAE,QAAQ,EAAE,SAAS,CAAC;;EAExD;EACAL,MAAM,CAACzQ,SAAS,CAAC+Q,iBAAiB,GAAG,YAAW;IAC5C,OAAO,IAAI,CAACD,eAAe,IAAIL,MAAM,CAACK,eAAe;EACzD,CAAC;EAEDL,MAAM,CAACO,cAAc,GAAG,CAAC;EACzBP,MAAM,CAACQ,cAAc,GAAG,CAAC;;EAEzB;AACJ;AACA;AACA;;EAEIR,MAAM,CAACzQ,SAAS,CAAC4Q,KAAK,GAAG,YAAW;IAChC,IAAI,CAACM,IAAI,EAAE;IACX,IAAI,CAACC,MAAM,GAAGV,MAAM,CAACO,cAAc;IAEnC,IAAI,CAACI,YAAY,GAAG,CAAC;IACrB,IAAI,CAACC,YAAY,GAAG,CAAC;IAErB,IAAI,CAACC,QAAQ,GAAG,CAAC,CAAC,CAAC,CAAC;;IAEpB;IACA,IAAI,IAAI,CAACC,MAAM,EAAE;MACb,KAAK,IAAI3R,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC2R,MAAM,CAACrS,MAAM,EAAE,EAAEU,CAAC,EAAE;QACzC,IAAIiM,IAAI,GAAG,IAAI,CAAC0F,MAAM,CAAC3R,CAAC,CAAC;QACzB,IAAIiM,IAAI,CAAC2F,SAAS,EAAE;UAChB3F,IAAI,CAAC2F,SAAS,EAAE;QACpB;MACJ;IACJ;;IAEA;IACA,IAAI,CAACD,MAAM,GAAG,EAAE;IAChB,IAAI,CAACE,YAAY,GAAG,CAAC,CAAC;IACtB,IAAI,CAACC,eAAe,GAAG,EAAE,CAAC,CAAC;IAC3B,IAAI,CAACC,iBAAiB,GAAG,IAAI,CAAC,CAAC;;IAE/B;IACA,IAAI,CAACC,OAAO,GAAG,EAAE;;IAEjB;IACA,IAAI,CAACC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;;IAEjB;IACA,IAAI,CAACC,SAAS,GAAG,CAAC;;IAElB;IACA,IAAI,CAACC,MAAM,GAAG,CAAC,CAAC;IACtB,IAAI,CAACC,IAAI,GAAG,CAAC,CAAC;IACd,IAAI,CAACC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;;IAEX;IACA,IAAI,CAACC,UAAU,GAAG,CAAC;IACnB,IAAI,CAACC,WAAW,GAAG,CAAC;IACpB,IAAI,CAACC,SAAS,GAAG,CAAC;IAClB,IAAI,CAACC,eAAe,GAAG,IAAI;IAC3B,IAAI,CAACC,YAAY,GAAG,IAAI;IACxB,IAAI,CAACC,gBAAgB,GAAG,CAAC;IACzB,IAAI,CAACC,SAAS,GAAG,CAAC;IAElB,IAAI,CAACC,YAAY,GAAG,IAAI;IAExB,IAAI,CAACC,eAAe,GAAG,EAAE;IACzB,IAAI,CAACC,eAAe,GAAG,EAAE;IACzB,IAAI,CAACC,oBAAoB,GAAG,EAAE;;IAE9B;IACA,IAAI,CAACC,MAAM,GAAG,CAAC,CAAC;IAChB,IAAI,CAACC,OAAO,GAAG,CAAC,CAAC;;IAEjB;IACA,IAAI,CAACC,MAAM,EAAE;IAEb,IAAI,CAACC,kBAAkB,CAAC,OAAO,CAAC;EACpC,CAAC;;EAED;AACJ;AACA;AACA;AACA;;EAEIvC,MAAM,CAACzQ,SAAS,CAACiT,YAAY,GAAG,UAASC,WAAW,EAAE;IAClD,IAAIA,WAAW,CAAC7J,WAAW,IAAI8J,YAAY,EAAE;MACzC,MAAM,8CAA8C;IACxD;IACA,IAAID,WAAW,CAACE,KAAK,IAAIF,WAAW,CAACE,KAAK,IAAI,IAAI,EAAE;MAChDF,WAAW,CAACE,KAAK,CAACC,YAAY,CAACH,WAAW,CAAC;IAC/C;IAEAA,WAAW,CAACE,KAAK,GAAG,IAAI;IAExB,IAAI,CAAC,IAAI,CAACzC,mBAAmB,EAAE;MAC3B,IAAI,CAACA,mBAAmB,GAAG,EAAE;IACjC;IACA,IAAI,CAACA,mBAAmB,CAAC9Q,IAAI,CAACqT,WAAW,CAAC;EAC9C,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIzC,MAAM,CAACzQ,SAAS,CAACqT,YAAY,GAAG,UAASH,WAAW,EAAE;IAClD,IAAI,CAAC,IAAI,CAACvC,mBAAmB,EAAE;MAC3B;IACJ;IAEA,IAAIzI,GAAG,GAAG,IAAI,CAACyI,mBAAmB,CAACvC,OAAO,CAAC8E,WAAW,CAAC;IACvD,IAAIhL,GAAG,IAAI,CAAC,CAAC,EAAE;MACX;IACJ;IACAgL,WAAW,CAACE,KAAK,GAAG,IAAI;IACxB,IAAI,CAACzC,mBAAmB,CAAC2C,MAAM,CAACpL,GAAG,EAAE,CAAC,CAAC;EAC3C,CAAC;;EAED;AACJ;AACA;AACA;AACA;;EAEIuI,MAAM,CAACzQ,SAAS,CAACuT,KAAK,GAAG,UAASC,QAAQ,EAAE;IACxC,IAAI,IAAI,CAACrC,MAAM,IAAIV,MAAM,CAACQ,cAAc,EAAE;MACtC;IACJ;IACA,IAAI,CAACE,MAAM,GAAGV,MAAM,CAACQ,cAAc;IAEnC,IAAI,IAAI,CAACwC,WAAW,EAAE;MAClB,IAAI,CAACA,WAAW,EAAE;IACtB;IAEA,IAAI,CAACC,mBAAmB,CAAC,SAAS,CAAC;;IAEnC;IACA,IAAI,CAAClB,SAAS,GAAG/Q,SAAS,CAAC0O,OAAO,EAAE;IACpC,IAAI,CAACoC,gBAAgB,GAAG,IAAI,CAACC,SAAS;IACtCgB,QAAQ,GAAGA,QAAQ,IAAI,CAAC;IACxB,IAAIxE,IAAI,GAAG,IAAI;;IAErB;IACM,IAAKwE,QAAQ,IAAI,CAAC,IAAI,OAAOG,MAAM,IAAI,WAAW,IAAIA,MAAM,CAACC,qBAAqB,EAAG;MAAA,IACxEC,QAAQ,GAAjB,SAASA,QAAQ,GAAG;QAChB,IAAI7E,IAAI,CAAC8E,kBAAkB,IAAI,CAAC,CAAC,EAAE;UAC/B;QACJ;QACAH,MAAM,CAACC,qBAAqB,CAACC,QAAQ,CAAC;QAClD,IAAG7E,IAAI,CAAC+E,YAAY,EACnB/E,IAAI,CAAC+E,YAAY,EAAE;QACR/E,IAAI,CAACgF,OAAO,CAAC,CAAC,EAAE,CAAChF,IAAI,CAACyD,YAAY,CAAC;QAC/C,IAAGzD,IAAI,CAACiF,WAAW,EAClBjF,IAAI,CAACiF,WAAW,EAAE;MACX,CAAC;MACD,IAAI,CAACH,kBAAkB,GAAG,CAAC,CAAC;MAC5BD,QAAQ,EAAE;IACd,CAAC,MAAM;MAAE;MACL,IAAI,CAACC,kBAAkB,GAAGI,WAAW,CAAC,YAAW;QAC7C;QACZ,IAAGlF,IAAI,CAAC+E,YAAY,EACnB/E,IAAI,CAAC+E,YAAY,EAAE;QACR/E,IAAI,CAACgF,OAAO,CAAC,CAAC,EAAE,CAAChF,IAAI,CAACyD,YAAY,CAAC;QAC/C,IAAGzD,IAAI,CAACiF,WAAW,EAClBjF,IAAI,CAACiF,WAAW,EAAE;MACX,CAAC,EAAET,QAAQ,CAAC;IAChB;EACJ,CAAC;;EAED;AACJ;AACA;AACA;;EAEI/C,MAAM,CAACzQ,SAAS,CAACkR,IAAI,GAAG,YAAW;IAC/B,IAAI,IAAI,CAACC,MAAM,IAAIV,MAAM,CAACO,cAAc,EAAE;MACtC;IACJ;IAEA,IAAI,CAACG,MAAM,GAAGV,MAAM,CAACO,cAAc;IAEnC,IAAI,IAAI,CAACmD,WAAW,EAAE;MAClB,IAAI,CAACA,WAAW,EAAE;IACtB;IAEA,IAAI,IAAI,CAACL,kBAAkB,IAAI,IAAI,EAAE;MACjC,IAAI,IAAI,CAACA,kBAAkB,IAAI,CAAC,CAAC,EAAE;QAC/BM,aAAa,CAAC,IAAI,CAACN,kBAAkB,CAAC;MAC1C;MACA,IAAI,CAACA,kBAAkB,GAAG,IAAI;IAClC;IAEA,IAAI,CAACJ,mBAAmB,CAAC,QAAQ,CAAC;EACtC,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;;EAEIjD,MAAM,CAACzQ,SAAS,CAACgU,OAAO,GAAG,UAASK,GAAG,EAAEC,mBAAmB,EAAEC,KAAK,EAAG;IAClEF,GAAG,GAAGA,GAAG,IAAI,CAAC;IAEd,IAAId,KAAK,GAAG9R,SAAS,CAAC0O,OAAO,EAAE;IAC/B,IAAI,CAAC+B,UAAU,GAAG,KAAK,IAAIqB,KAAK,GAAG,IAAI,CAACf,SAAS,CAAC;IAElD,IAAIrI,KAAK,GAAG,IAAI,CAACwH,iBAAiB,GAC5B,IAAI,CAACA,iBAAiB,GACtB,IAAI,CAACJ,MAAM;IACjB,IAAI,CAACpH,KAAK,EAAE;MACR;IACJ;IAENoK,KAAK,GAAGA,KAAK,IAAIpK,KAAK,CAACjL,MAAM;IAEvB,IAAIoV,mBAAmB,EAAE;MACrB;MACA,KAAK,IAAI1U,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGyU,GAAG,EAAEzU,CAAC,EAAE,EAAE;QAC1B,KAAK,IAAI2O,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGgG,KAAK,EAAE,EAAEhG,CAAC,EAAE;UAC5B,IAAI1C,IAAI,GAAG1B,KAAK,CAACoE,CAAC,CAAC;UACnB,IAAI1C,IAAI,CAACO,IAAI,IAAI3K,SAAS,CAAC6C,MAAM,IAAIuH,IAAI,CAACR,SAAS,EAAE;YACjD;YAClBQ,IAAI,CAAC2I,SAAS,EAAE;UACF;QACJ;QAEA,IAAI,CAACpC,SAAS,IAAI,IAAI,CAACC,eAAe;QACtC,IAAI,IAAI,CAACoC,aAAa,EAAE;UACpB,IAAI,CAACA,aAAa,EAAE;QACxB;MACJ;MAEA,IAAI,IAAI,CAACC,cAAc,EAAE;QACrB,IAAI,CAACA,cAAc,EAAE;MACzB;IACJ,CAAC,MAAM;MACH,IAAI;QACA;QACA,KAAK,IAAI9U,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGyU,GAAG,EAAEzU,CAAC,EAAE,EAAE;UAC1B,KAAK,IAAI2O,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGgG,KAAK,EAAE,EAAEhG,CAAC,EAAE;YAC5B,IAAI1C,IAAI,GAAG1B,KAAK,CAACoE,CAAC,CAAC;YACnB,IAAI1C,IAAI,CAACO,IAAI,IAAI3K,SAAS,CAAC6C,MAAM,IAAIuH,IAAI,CAACR,SAAS,EAAE;cACjDQ,IAAI,CAACR,SAAS,EAAE;YACpB;UACJ;UAEA,IAAI,CAAC+G,SAAS,IAAI,IAAI,CAACC,eAAe;UACtC,IAAI,IAAI,CAACoC,aAAa,EAAE;YACpB,IAAI,CAACA,aAAa,EAAE;UACxB;QACJ;QAEA,IAAI,IAAI,CAACC,cAAc,EAAE;UACrB,IAAI,CAACA,cAAc,EAAE;QACzB;QACA,IAAI,CAACC,mBAAmB,GAAG,KAAK;MACpC,CAAC,CAAC,OAAO7I,GAAG,EAAE;QACV,IAAI,CAAC6I,mBAAmB,GAAG,IAAI;QAC/B,IAAIlT,SAAS,CAACmE,YAAY,EAAE;UACxB,MAAMkG,GAAG;QACb;QACA,IAAIrK,SAAS,CAACiE,KAAK,EAAE;UACjBmC,OAAO,CAACC,GAAG,CAAC,0BAA0B,GAAGgE,GAAG,CAAC;QACjD;QACA,IAAI,CAACoF,IAAI,EAAE;MACf;IACJ;IAEA,IAAId,GAAG,GAAG3O,SAAS,CAAC0O,OAAO,EAAE;IAC7B,IAAIyE,OAAO,GAAGxE,GAAG,GAAGmD,KAAK;IACzB,IAAIqB,OAAO,IAAI,CAAC,EAAE;MACdA,OAAO,GAAG,CAAC;IACf;IACA,IAAI,CAACC,cAAc,GAAG,KAAK,GAAGD,OAAO;IACrC,IAAI,CAAC1C,UAAU,IAAI,KAAK,GAAG0C,OAAO;IAClC,IAAI,CAAC9C,SAAS,IAAI,CAAC;IACnB,IAAI,CAACQ,YAAY,GAAG,CAAClC,GAAG,GAAG,IAAI,CAACmC,gBAAgB,IAAI,KAAK;IACzD,IAAI,CAACA,gBAAgB,GAAGnC,GAAG;IAC3B,IAAI,CAACsC,eAAe,GAAG,EAAE;IACzB,IAAI,CAACC,eAAe,GAAG,EAAE;IACzB,IAAI,CAACC,oBAAoB,GAAG,EAAE;EAClC,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACInC,MAAM,CAACzQ,SAAS,CAAC8U,oBAAoB,GAAG,YAAW;IAC/C,IAAI,CAACpD,eAAe,GAAG,IAAI,CAACqD,qBAAqB,CAAC,KAAK,CAAC;IACxD,IAAI,CAACpD,iBAAiB,GAAG,EAAE;IAC3B,KAAK,IAAI/R,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC8R,eAAe,CAACxS,MAAM,EAAE,EAAEU,CAAC,EAAE;MAClD,IAAI,IAAI,CAAC8R,eAAe,CAAC9R,CAAC,CAAC,CAACyL,SAAS,EAAE;QACnC,IAAI,CAACsG,iBAAiB,CAAC9R,IAAI,CAAC,IAAI,CAAC6R,eAAe,CAAC9R,CAAC,CAAC,CAAC;MACxD;IACJ;EACJ,CAAC;;EAED;EACA6Q,MAAM,CAACzQ,SAAS,CAAC+U,qBAAqB,GAAG,UACrCC,cAAc,EACdC,SAAS,EACX;IACE,IAAIC,CAAC,GAAG,EAAE;IACV,IAAIC,CAAC,GAAG,EAAE;IACV,IAAIC,CAAC,GAAG,CAAC,CAAC;IACV,IAAIC,aAAa,GAAG,CAAC,CAAC,CAAC,CAAC;IACxB,IAAIC,eAAe,GAAG,CAAC,CAAC,CAAC,CAAC;;IAE1B;IACA,KAAK,IAAI1V,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAAChE,MAAM,CAACrS,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAChD,IAAIiM,IAAI,GAAG,IAAI,CAAC0F,MAAM,CAAC3R,CAAC,CAAC;MACzB,IAAIoV,cAAc,IAAI,CAACnJ,IAAI,CAACR,SAAS,EAAE;QACnC;MACJ;MAEA+J,CAAC,CAACvJ,IAAI,CAAC2J,EAAE,CAAC,GAAG3J,IAAI,CAAC,CAAC;;MAEnB,IAAIwI,GAAG,GAAG,CAAC,CAAC,CAAC;MACb,IAAIxI,IAAI,CAACgH,MAAM,EAAE;QACb,KAAK,IAAItE,CAAC,GAAG,CAAC,EAAEkH,EAAE,GAAG5J,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAEqP,CAAC,GAAGkH,EAAE,EAAElH,CAAC,EAAE,EAAE;UAClD,IAAI1C,IAAI,CAACgH,MAAM,CAACtE,CAAC,CAAC,IAAI1C,IAAI,CAACgH,MAAM,CAACtE,CAAC,CAAC,CAACmH,IAAI,IAAI,IAAI,EAAE;YAC/CrB,GAAG,IAAI,CAAC;UACZ;QACJ;MACJ;MAEA,IAAIA,GAAG,IAAI,CAAC,EAAE;QACV;QACAc,CAAC,CAACtV,IAAI,CAACgM,IAAI,CAAC;QACZ,IAAIoJ,SAAS,EAAE;UACXpJ,IAAI,CAAC8J,MAAM,GAAG,CAAC;QACnB;MACJ,CAAC,CAAC;MAAA,KACG;QACD,IAAIV,SAAS,EAAE;UACXpJ,IAAI,CAAC8J,MAAM,GAAG,CAAC;QACnB;QACAL,eAAe,CAACzJ,IAAI,CAAC2J,EAAE,CAAC,GAAGnB,GAAG;MAClC;IACJ;IAEA,OAAO,IAAI,EAAE;MACT,IAAIc,CAAC,CAACjW,MAAM,IAAI,CAAC,EAAE;QACf;MACJ;;MAEA;MACA,IAAI2M,IAAI,GAAGsJ,CAAC,CAACS,KAAK,EAAE;MACpBV,CAAC,CAACrV,IAAI,CAACgM,IAAI,CAAC,CAAC,CAAC;MACd,OAAOuJ,CAAC,CAACvJ,IAAI,CAAC2J,EAAE,CAAC,CAAC,CAAC;;MAEnB,IAAI,CAAC3J,IAAI,CAACiH,OAAO,EAAE;QACf;MACJ;;MAEA;MACA,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAEU,CAAC,EAAE,EAAE;QAC1C,IAAIiW,MAAM,GAAGhK,IAAI,CAACiH,OAAO,CAAClT,CAAC,CAAC;QAC5B;QACA,IACIiW,MAAM,IAAI,IAAI,IACdA,MAAM,CAAChE,KAAK,IAAI,IAAI,IACpBgE,MAAM,CAAChE,KAAK,CAAC3S,MAAM,IAAI,CAAC,EAC1B;UACE;QACJ;;QAEA;QACA,KAAK,IAAIqP,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGsH,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAAEqP,CAAC,EAAE,EAAE;UAC1C,IAAIuH,OAAO,GAAGD,MAAM,CAAChE,KAAK,CAACtD,CAAC,CAAC;UAC7B,IAAImH,IAAI,GAAG,IAAI,CAAC7D,KAAK,CAACiE,OAAO,CAAC;UAC9B,IAAI,CAACJ,IAAI,EAAE;YACP;UACJ;;UAEA;UACA,IAAIL,aAAa,CAACK,IAAI,CAACF,EAAE,CAAC,EAAE;YACxB;UACJ;UAEA,IAAIO,WAAW,GAAG,IAAI,CAACC,WAAW,CAACN,IAAI,CAACO,SAAS,CAAC;UAClD,IAAIF,WAAW,IAAI,IAAI,EAAE;YACrBV,aAAa,CAACK,IAAI,CAACF,EAAE,CAAC,GAAG,IAAI;YAC7B;UACJ;UAEA,IACIP,SAAS,KACR,CAACc,WAAW,CAACJ,MAAM,IAChBI,WAAW,CAACJ,MAAM,IAAI9J,IAAI,CAAC8J,MAAM,CAAC,EACxC;YACEI,WAAW,CAACJ,MAAM,GAAG9J,IAAI,CAAC8J,MAAM,GAAG,CAAC;UACxC;UAEAN,aAAa,CAACK,IAAI,CAACF,EAAE,CAAC,GAAG,IAAI,CAAC,CAAC;UAC/BF,eAAe,CAACS,WAAW,CAACP,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;UACtC,IAAIF,eAAe,CAACS,WAAW,CAACP,EAAE,CAAC,IAAI,CAAC,EAAE;YACtCL,CAAC,CAACtV,IAAI,CAACkW,WAAW,CAAC;UACvB,CAAC,CAAC;QACN;MACJ;IACJ;;IAEA;IACA,KAAK,IAAInW,CAAC,IAAIwV,CAAC,EAAE;MACbF,CAAC,CAACrV,IAAI,CAACuV,CAAC,CAACxV,CAAC,CAAC,CAAC;IAChB;IAEA,IAAIsV,CAAC,CAAChW,MAAM,IAAI,IAAI,CAACqS,MAAM,CAACrS,MAAM,IAAIuC,SAAS,CAACiE,KAAK,EAAE;MACnDmC,OAAO,CAACqB,IAAI,CAAC,qCAAqC,CAAC;IACvD;IAEA,IAAIqM,CAAC,GAAGL,CAAC,CAAChW,MAAM;;IAEhB;IACA,KAAK,IAAIU,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MACxBsV,CAAC,CAACtV,CAAC,CAAC,CAACsW,KAAK,GAAGtW,CAAC;IAClB;;IAEA;IACAsV,CAAC,GAAGA,CAAC,CAAC7K,IAAI,CAAC,UAAS8L,CAAC,EAAEC,CAAC,EAAE;MACtB,IAAIC,EAAE,GAAGF,CAAC,CAAC9M,WAAW,CAACiN,QAAQ,IAAIH,CAAC,CAACG,QAAQ,IAAI,CAAC;MAClD,IAAIC,EAAE,GAAGH,CAAC,CAAC/M,WAAW,CAACiN,QAAQ,IAAIF,CAAC,CAACE,QAAQ,IAAI,CAAC;MAClD,IAAID,EAAE,IAAIE,EAAE,EAAE;QACV;QACA,OAAOJ,CAAC,CAACD,KAAK,GAAGE,CAAC,CAACF,KAAK;MAC5B;MACA,OAAOG,EAAE,GAAGE,EAAE,CAAC,CAAC;IACpB,CAAC,CAAC;;IAEF;IACA,KAAK,IAAI3W,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MACxBsV,CAAC,CAACtV,CAAC,CAAC,CAACsW,KAAK,GAAGtW,CAAC;IAClB;IAEA,OAAOsV,CAAC;EACZ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIzE,MAAM,CAACzQ,SAAS,CAACwW,YAAY,GAAG,UAAS3K,IAAI,EAAE;IAC3C,IAAI4K,SAAS,GAAG,EAAE;IAClB,IAAIC,OAAO,GAAG,CAAC7K,IAAI,CAAC;IACpB,IAAI8K,OAAO,GAAG,CAAC,CAAC;IAEhB,OAAOD,OAAO,CAACxX,MAAM,EAAE;MACnB,IAAI0X,OAAO,GAAGF,OAAO,CAACd,KAAK,EAAE;MAC7B,IAAI,CAACgB,OAAO,CAAC/D,MAAM,EAAE;QACjB;MACJ;MACA,IAAI,CAAC8D,OAAO,CAACC,OAAO,CAACpB,EAAE,CAAC,IAAIoB,OAAO,IAAI/K,IAAI,EAAE;QACzC8K,OAAO,CAACC,OAAO,CAACpB,EAAE,CAAC,GAAG,IAAI;QAC1BiB,SAAS,CAAC5W,IAAI,CAAC+W,OAAO,CAAC;MAC3B;MAEA,KAAK,IAAIhX,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGgX,OAAO,CAAC/D,MAAM,CAAC3T,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC5C,IAAIiX,KAAK,GAAGD,OAAO,CAACE,YAAY,CAAClX,CAAC,CAAC;QACnC,IAAIiX,KAAK,IAAIJ,SAAS,CAACrI,OAAO,CAACyI,KAAK,CAAC,IAAI,CAAC,CAAC,EAAE;UACzCH,OAAO,CAAC7W,IAAI,CAACgX,KAAK,CAAC;QACvB;MACJ;IACJ;IAEAJ,SAAS,CAACpM,IAAI,CAAC,UAASoC,CAAC,EAAEC,CAAC,EAAE;MAC1B,OAAOD,CAAC,CAACyJ,KAAK,GAAGxJ,CAAC,CAACwJ,KAAK;IAC5B,CAAC,CAAC;IACF,OAAOO,SAAS;EACpB,CAAC;;EAED;AACJ;AACA;AACA;EACIhG,MAAM,CAACzQ,SAAS,CAAC+W,OAAO,GAAG,UAAUC,MAAM,EAAEC,MAAM,EAAE;IACjDD,MAAM,GAAGA,MAAM,IAAI,GAAG;IAEtB,IAAI7M,KAAK,GAAG,IAAI,CAAC4K,qBAAqB,CAAC,KAAK,EAAE,IAAI,CAAC;IACnD,IAAImC,OAAO,GAAG,EAAE;IAChB,KAAK,IAAItX,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuK,KAAK,CAACjL,MAAM,EAAE,EAAEU,CAAC,EAAE;MACnC,IAAIiM,IAAI,GAAG1B,KAAK,CAACvK,CAAC,CAAC;MACnB,IAAIuX,GAAG,GAAGtL,IAAI,CAAC8J,MAAM,IAAI,CAAC;MAC1B,IAAI,CAACuB,OAAO,CAACC,GAAG,CAAC,EAAE;QACfD,OAAO,CAACC,GAAG,CAAC,GAAG,EAAE;MACrB;MACAD,OAAO,CAACC,GAAG,CAAC,CAACtX,IAAI,CAACgM,IAAI,CAAC;IAC3B;IAEA,IAAIuL,CAAC,GAAGJ,MAAM;IAEd,KAAK,IAAIpX,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGsX,OAAO,CAAChY,MAAM,EAAE,EAAEU,CAAC,EAAE;MACrC,IAAIyX,MAAM,GAAGH,OAAO,CAACtX,CAAC,CAAC;MACvB,IAAI,CAACyX,MAAM,EAAE;QACT;MACJ;MACA,IAAIC,QAAQ,GAAG,GAAG;MAClB,IAAIC,CAAC,GAAGP,MAAM,GAAGvV,SAAS,CAACG,iBAAiB;MAC5C,KAAK,IAAI2M,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG8I,MAAM,CAACnY,MAAM,EAAE,EAAEqP,CAAC,EAAE;QACpC,IAAI1C,IAAI,GAAGwL,MAAM,CAAC9I,CAAC,CAAC;QACpB1C,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAI+O,MAAM,IAAIxV,SAAS,CAAC8D,eAAe,GAAIgS,CAAC,GAAGH,CAAC;QAC3DvL,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAI+O,MAAM,IAAIxV,SAAS,CAAC8D,eAAe,GAAI6R,CAAC,GAAGG,CAAC;QAC3DC,cAAc,GAAIP,MAAM,IAAIxV,SAAS,CAAC8D,eAAe,GAAI,CAAC,GAAG,CAAC;QAC9D,IAAIsG,IAAI,CAACK,IAAI,CAACsL,cAAc,CAAC,GAAGF,QAAQ,EAAE;UACtCA,QAAQ,GAAGzL,IAAI,CAACK,IAAI,CAACsL,cAAc,CAAC;QACxC;QACAC,eAAe,GAAIR,MAAM,IAAIxV,SAAS,CAAC8D,eAAe,GAAI,CAAC,GAAG,CAAC;QAC/DgS,CAAC,IAAI1L,IAAI,CAACK,IAAI,CAACuL,eAAe,CAAC,GAAGT,MAAM,GAAGvV,SAAS,CAACG,iBAAiB;MAC1E;MACAwV,CAAC,IAAIE,QAAQ,GAAGN,MAAM;IAC1B;IAEA,IAAI,CAACU,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;EACnC,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIjH,MAAM,CAACzQ,SAAS,CAACmQ,OAAO,GAAG,YAAW;IAClC,OAAO,IAAI,CAAC+B,UAAU;EAC1B,CAAC;;EAED;AACJ;AACA;AACA;AACA;;EAEIzB,MAAM,CAACzQ,SAAS,CAAC2X,YAAY,GAAG,YAAW;IACvC,OAAO,IAAI,CAACvF,SAAS;EACzB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;;EAEI3B,MAAM,CAACzQ,SAAS,CAAC4X,cAAc,GAAG,YAAW;IACzC,OAAO,IAAI,CAACtF,YAAY;EAC5B,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI7B,MAAM,CAACzQ,SAAS,CAAC0T,mBAAmB,GAAG,UAASmE,SAAS,EAAElN,MAAM,EAAEyB,IAAI,EAAE;IACrEA,IAAI,GAAGA,IAAI,IAAI3K,SAAS,CAAC6C,MAAM;IAE/B,IAAI6F,KAAK,GAAG,IAAI,CAACuH,eAAe,GAAG,IAAI,CAACA,eAAe,GAAG,IAAI,CAACH,MAAM;IACrE,IAAI,CAACpH,KAAK,EAAE;MACR;IACJ;IAEA,KAAK,IAAIoE,CAAC,GAAG,CAAC,EAAEgH,CAAC,GAAGpL,KAAK,CAACjL,MAAM,EAAEqP,CAAC,GAAGgH,CAAC,EAAE,EAAEhH,CAAC,EAAE;MAC1C,IAAI1C,IAAI,GAAG1B,KAAK,CAACoE,CAAC,CAAC;MAEnB,IACI1C,IAAI,CAACxC,WAAW,KAAK5H,SAAS,CAACqW,QAAQ,IACvCD,SAAS,IAAI,WAAW,EAC1B;QACE,IAAIhM,IAAI,CAACO,IAAI,IAAIA,IAAI,EAAE;UACnBP,IAAI,CAAC6H,mBAAmB,CAACmE,SAAS,EAAElN,MAAM,EAAEyB,IAAI,CAAC;QACrD;QACA;MACJ;MAEA,IAAI,CAACP,IAAI,CAACgM,SAAS,CAAC,IAAIhM,IAAI,CAACO,IAAI,IAAIA,IAAI,EAAE;QACvC;MACJ;MACA,IAAIzB,MAAM,KAAKoN,SAAS,EAAE;QACtBlM,IAAI,CAACgM,SAAS,CAAC,EAAE;MACrB,CAAC,MAAM,IAAIlN,MAAM,IAAIA,MAAM,CAACtB,WAAW,KAAK3J,KAAK,EAAE;QAC/CmM,IAAI,CAACgM,SAAS,CAAC,CAAC5X,KAAK,CAAC4L,IAAI,EAAElB,MAAM,CAAC;MACvC,CAAC,MAAM;QACHkB,IAAI,CAACgM,SAAS,CAAC,CAAClN,MAAM,CAAC;MAC3B;IACJ;EACJ,CAAC;EAED8F,MAAM,CAACzQ,SAAS,CAACgT,kBAAkB,GAAG,UAASgF,MAAM,EAAErN,MAAM,EAAE;IAC3D,IAAI,CAAC,IAAI,CAACgG,mBAAmB,EAAE;MAC3B;IACJ;IAEA,KAAK,IAAI/Q,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC+Q,mBAAmB,CAACzR,MAAM,EAAE,EAAEU,CAAC,EAAE;MACtD,IAAIqY,CAAC,GAAG,IAAI,CAACtH,mBAAmB,CAAC/Q,CAAC,CAAC;MACnC,IAAIqY,CAAC,CAACD,MAAM,CAAC,EAAE;QACXC,CAAC,CAACD,MAAM,CAAC,CAAC/X,KAAK,CAACgY,CAAC,EAAEtN,MAAM,CAAC;MAC9B;IACJ;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;;EAEI8F,MAAM,CAACzQ,SAAS,CAACkY,GAAG,GAAG,UAASrM,IAAI,EAAEsM,kBAAkB,EAAE;IACtD,IAAI,CAACtM,IAAI,EAAE;MACP;IACJ;;IAEA;IACA,IAAIA,IAAI,CAACxC,WAAW,KAAK+O,WAAW,EAAE;MAClC,IAAI,CAACxG,OAAO,CAAC/R,IAAI,CAACgM,IAAI,CAAC;MACvB,IAAI,CAAC6L,cAAc,CAAC,IAAI,CAAC;MACzB,IAAI,CAAC3E,MAAM,EAAE;MACblH,IAAI,CAACuH,KAAK,GAAG,IAAI;MACjB,IAAI,CAAC9B,QAAQ,EAAE;MACf;IACJ;;IAEA;IACA,IAAIzF,IAAI,CAAC2J,EAAE,IAAI,CAAC,CAAC,IAAI,IAAI,CAAC/D,YAAY,CAAC5F,IAAI,CAAC2J,EAAE,CAAC,IAAI,IAAI,EAAE;MACrD3N,OAAO,CAACqB,IAAI,CACR,8DAA8D,CACjE;MACD2C,IAAI,CAAC2J,EAAE,GAAG,EAAE,IAAI,CAACpE,YAAY;IACjC;IAEA,IAAI,IAAI,CAACG,MAAM,CAACrS,MAAM,IAAIuC,SAAS,CAAC8B,mBAAmB,EAAE;MACrD,MAAM,mDAAmD;IAC7D;;IAEA;IACA,IAAIsI,IAAI,CAAC2J,EAAE,IAAI,IAAI,IAAI3J,IAAI,CAAC2J,EAAE,IAAI,CAAC,CAAC,EAAE;MAClC3J,IAAI,CAAC2J,EAAE,GAAG,EAAE,IAAI,CAACpE,YAAY;IACjC,CAAC,MAAM,IAAI,IAAI,CAACA,YAAY,GAAGvF,IAAI,CAAC2J,EAAE,EAAE;MACpC,IAAI,CAACpE,YAAY,GAAGvF,IAAI,CAAC2J,EAAE;IAC/B;IAEA3J,IAAI,CAACuH,KAAK,GAAG,IAAI;IACjB,IAAI,CAAC9B,QAAQ,EAAE;IAEf,IAAI,CAACC,MAAM,CAAC1R,IAAI,CAACgM,IAAI,CAAC;IACtB,IAAI,CAAC4F,YAAY,CAAC5F,IAAI,CAAC2J,EAAE,CAAC,GAAG3J,IAAI;IAEjC,IAAIA,IAAI,CAACwM,OAAO,EAAE;MACdxM,IAAI,CAACwM,OAAO,CAAC,IAAI,CAAC;IACtB;IAEA,IAAI,IAAI,CAACtG,MAAM,CAACuG,aAAa,EAAE;MAC3BzM,IAAI,CAAC0M,WAAW,EAAE;IACtB;IAEA,IAAI,CAACJ,kBAAkB,EAAE;MACrB,IAAI,CAACrD,oBAAoB,EAAE;IAC/B;IAEA,IAAI,IAAI,CAAC0D,WAAW,EAAE;MAClB,IAAI,CAACA,WAAW,CAAC3M,IAAI,CAAC;IAC1B;IAEA,IAAI,CAAC6L,cAAc,CAAC,IAAI,CAAC;IACzB,IAAI,CAAC3E,MAAM,EAAE;IAEb,OAAOlH,IAAI,CAAC,CAAC;EACjB,CAAC;;EAED;AACJ;AACA;AACA;AACA;;EAEI4E,MAAM,CAACzQ,SAAS,CAACyY,MAAM,GAAG,UAAS5M,IAAI,EAAE;IACrC,IAAIA,IAAI,CAACxC,WAAW,KAAK5H,SAAS,CAAC2W,WAAW,EAAE;MAC5C,IAAIM,KAAK,GAAG,IAAI,CAAC9G,OAAO,CAACxD,OAAO,CAACvC,IAAI,CAAC;MACtC,IAAI6M,KAAK,IAAI,CAAC,CAAC,EAAE;QACb,IAAI,CAAC9G,OAAO,CAAC0B,MAAM,CAACoF,KAAK,EAAE,CAAC,CAAC;MACjC;MACA7M,IAAI,CAACuH,KAAK,GAAG,IAAI;MACjB,IAAI,CAAC9B,QAAQ,EAAE;MACf,IAAI,CAACoG,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;MAC/B,IAAI,CAAC3E,MAAM,EAAE;MACb;IACJ;IAEA,IAAI,IAAI,CAACtB,YAAY,CAAC5F,IAAI,CAAC2J,EAAE,CAAC,IAAI,IAAI,EAAE;MACpC;IACJ,CAAC,CAAC;;IAEF,IAAI3J,IAAI,CAAC8M,aAAa,EAAE;MACpB;IACJ,CAAC,CAAC;;IAER,IAAI,CAACC,YAAY,EAAE,CAAC,CAAC;;IAEf;IACA,IAAI/M,IAAI,CAACgH,MAAM,EAAE;MACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAEU,CAAC,EAAE,EAAE;QACzC,IAAIiZ,IAAI,GAAGhN,IAAI,CAACgH,MAAM,CAACjT,CAAC,CAAC;QACzB,IAAIiZ,IAAI,CAACnD,IAAI,IAAI,IAAI,EAAE;UACnB7J,IAAI,CAACiN,eAAe,CAAClZ,CAAC,CAAC;QAC3B;MACJ;IACJ;;IAEA;IACA,IAAIiM,IAAI,CAACiH,OAAO,EAAE;MACd,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAEU,CAAC,EAAE,EAAE;QAC1C,IAAIiZ,IAAI,GAAGhN,IAAI,CAACiH,OAAO,CAAClT,CAAC,CAAC;QAC1B,IAAIiZ,IAAI,CAAChH,KAAK,IAAI,IAAI,IAAIgH,IAAI,CAAChH,KAAK,CAAC3S,MAAM,EAAE;UACzC2M,IAAI,CAACkN,gBAAgB,CAACnZ,CAAC,CAAC;QAC5B;MACJ;IACJ;;IAEA;;IAEA;IACA,IAAIiM,IAAI,CAAC2F,SAAS,EAAE;MAChB3F,IAAI,CAAC2F,SAAS,EAAE;IACpB;IAEA3F,IAAI,CAACuH,KAAK,GAAG,IAAI;IACjB,IAAI,CAAC9B,QAAQ,EAAE;;IAEf;IACA,IAAI,IAAI,CAACX,mBAAmB,EAAE;MAC1B,KAAK,IAAI/Q,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC+Q,mBAAmB,CAACzR,MAAM,EAAE,EAAEU,CAAC,EAAE;QACtD,IAAIoZ,MAAM,GAAG,IAAI,CAACrI,mBAAmB,CAAC/Q,CAAC,CAAC;QACxC,IAAIoZ,MAAM,CAACC,cAAc,CAACpN,IAAI,CAAC2J,EAAE,CAAC,EAAE;UAChC,OAAOwD,MAAM,CAACC,cAAc,CAACpN,IAAI,CAAC2J,EAAE,CAAC;QACzC;QACA,IAAIwD,MAAM,CAACE,YAAY,IAAIrN,IAAI,EAAE;UAC7BmN,MAAM,CAACE,YAAY,GAAG,IAAI;QAC9B;MACJ;IACJ;;IAEA;IACA,IAAIhR,GAAG,GAAG,IAAI,CAACqJ,MAAM,CAACnD,OAAO,CAACvC,IAAI,CAAC;IACnC,IAAI3D,GAAG,IAAI,CAAC,CAAC,EAAE;MACX,IAAI,CAACqJ,MAAM,CAAC+B,MAAM,CAACpL,GAAG,EAAE,CAAC,CAAC;IAC9B;IACA,OAAO,IAAI,CAACuJ,YAAY,CAAC5F,IAAI,CAAC2J,EAAE,CAAC;IAEjC,IAAI,IAAI,CAAC2D,aAAa,EAAE;MACpB,IAAI,CAACA,aAAa,CAACtN,IAAI,CAAC;IAC5B;;IAEN;IACA,IAAI,CAACmH,kBAAkB,CAAC,aAAa,CAAC;IAEhC,IAAI,CAAC0E,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;IACrC,IAAI,CAAC0B,WAAW,EAAE,CAAC,CAAC;IACd,IAAI,CAACrG,MAAM,EAAE;IAEb,IAAI,CAAC+B,oBAAoB,EAAE;EAC/B,CAAC;;EAED;AACJ;AACA;AACA;AACA;;EAEIrE,MAAM,CAACzQ,SAAS,CAACgW,WAAW,GAAG,UAASR,EAAE,EAAE;IACxC,IAAIA,EAAE,IAAI,IAAI,EAAE;MACZ,OAAO,IAAI;IACf;IACA,OAAO,IAAI,CAAC/D,YAAY,CAAC+D,EAAE,CAAC;EAChC,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI/E,MAAM,CAACzQ,SAAS,CAACqZ,gBAAgB,GAAG,UAASC,WAAW,EAAExM,MAAM,EAAE;IAC9DA,MAAM,GAAGA,MAAM,IAAI,EAAE;IACrBA,MAAM,CAAC5N,MAAM,GAAG,CAAC;IACjB,KAAK,IAAIU,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAAChE,MAAM,CAACrS,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAChD,IAAI,IAAI,CAAC2R,MAAM,CAAC3R,CAAC,CAAC,CAACyJ,WAAW,KAAKiQ,WAAW,EAAE;QAC5CxM,MAAM,CAACjN,IAAI,CAAC,IAAI,CAAC0R,MAAM,CAAC3R,CAAC,CAAC,CAAC;MAC/B;IACJ;IACA,OAAOkN,MAAM;EACjB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI2D,MAAM,CAACzQ,SAAS,CAACuZ,eAAe,GAAG,UAAS5R,IAAI,EAAEmF,MAAM,EAAE;IACtD,IAAInF,IAAI,GAAGA,IAAI,CAAC4B,WAAW,EAAE;IAC7BuD,MAAM,GAAGA,MAAM,IAAI,EAAE;IACrBA,MAAM,CAAC5N,MAAM,GAAG,CAAC;IACjB,KAAK,IAAIU,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAAChE,MAAM,CAACrS,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAChD,IAAI,IAAI,CAAC2R,MAAM,CAAC3R,CAAC,CAAC,CAAC+H,IAAI,CAAC4B,WAAW,EAAE,IAAI5B,IAAI,EAAE;QAC3CmF,MAAM,CAACjN,IAAI,CAAC,IAAI,CAAC0R,MAAM,CAAC3R,CAAC,CAAC,CAAC;MAC/B;IACJ;IACA,OAAOkN,MAAM;EACjB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI2D,MAAM,CAACzQ,SAAS,CAACwZ,eAAe,GAAG,UAAStZ,KAAK,EAAE;IAC/C,KAAK,IAAIN,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAAChE,MAAM,CAACrS,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAChD,IAAI,IAAI,CAAC2R,MAAM,CAAC3R,CAAC,CAAC,CAACM,KAAK,IAAIA,KAAK,EAAE;QAC/B,OAAO,IAAI,CAACqR,MAAM,CAAC3R,CAAC,CAAC;MACzB;IACJ;IACA,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI6Q,MAAM,CAACzQ,SAAS,CAACyZ,gBAAgB,GAAG,UAASvZ,KAAK,EAAE;IAChD,IAAI4M,MAAM,GAAG,EAAE;IACf,KAAK,IAAIlN,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAAChE,MAAM,CAACrS,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAChD,IAAI,IAAI,CAAC2R,MAAM,CAAC3R,CAAC,CAAC,CAACM,KAAK,IAAIA,KAAK,EAAE;QAC/B4M,MAAM,CAACjN,IAAI,CAAC,IAAI,CAAC0R,MAAM,CAAC3R,CAAC,CAAC,CAAC;MAC/B;IACJ;IACA,OAAOkN,MAAM;EACjB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACI2D,MAAM,CAACzQ,SAAS,CAAC0Z,YAAY,GAAG,UAAStC,CAAC,EAAEG,CAAC,EAAEoC,UAAU,EAAE3C,MAAM,EAAE;IAC/D2C,UAAU,GAAGA,UAAU,IAAI,IAAI,CAACpI,MAAM;IAC5C,IAAIqI,IAAI,GAAG,IAAI;IACT,KAAK,IAAIha,CAAC,GAAG+Z,UAAU,CAACza,MAAM,GAAG,CAAC,EAAEU,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;MAC7C,IAAIia,CAAC,GAAGF,UAAU,CAAC/Z,CAAC,CAAC;MACrB,IAAIia,CAAC,CAACC,aAAa,CAAC1C,CAAC,EAAEG,CAAC,EAAEP,MAAM,CAAC,EAAE;QAC/B;QACZ;AACJ;AACA;QACK,OAAO6C,CAAC;QACT;MACQ;IACJ;;IACA,OAAOD,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACInJ,MAAM,CAACzQ,SAAS,CAAC+Z,aAAa,GAAG,UAAS3C,CAAC,EAAEG,CAAC,EAAE;IAC5C,KAAK,IAAI3X,CAAC,GAAG,IAAI,CAACgS,OAAO,CAAC1S,MAAM,GAAG,CAAC,EAAEU,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;MAC/C,IAAIoa,CAAC,GAAG,IAAI,CAACpI,OAAO,CAAChS,CAAC,CAAC;MACvB,IAAIoa,CAAC,CAACF,aAAa,CAAC1C,CAAC,EAAEG,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE;QAChC,OAAOyC,CAAC;MACZ;IACJ;IACA,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIvJ,MAAM,CAACzQ,SAAS,CAACia,cAAc,GAAG,YAAW;IACzC,IAAIC,OAAO,GAAG,KAAK;IACnB,KAAK,IAAIta,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC2R,MAAM,CAACrS,MAAM,EAAEU,CAAC,EAAE,EAAE;MACzC,IAAIiM,IAAI,GAAG,IAAI,CAAC0F,MAAM,CAAC3R,CAAC,CAAC;MACzB,IAAIua,IAAI,GAAG1Y,SAAS,CAACqE,qBAAqB,CAAC+F,IAAI,CAAClE,IAAI,CAAC;MACrD,IAAIkE,IAAI,CAACxC,WAAW,IAAI8Q,IAAI,EAAE;QAC1B;MACJ;MACAtS,OAAO,CAACC,GAAG,CAAC,wCAAwC,GAAG+D,IAAI,CAAClE,IAAI,CAAC;MACjE,IAAIyS,OAAO,GAAG3Y,SAAS,CAACkK,UAAU,CAACE,IAAI,CAAClE,IAAI,CAAC;MAC7CuS,OAAO,GAAG,IAAI;MACd,IAAI,CAAC3I,MAAM,CAAC3R,CAAC,CAAC,GAAGwa,OAAO;MACxBA,OAAO,CAACvJ,SAAS,CAAChF,IAAI,CAACwO,SAAS,EAAE,CAAC;MACnCD,OAAO,CAAChH,KAAK,GAAG,IAAI;MACpB,IAAI,CAAC3B,YAAY,CAAC2I,OAAO,CAAC5E,EAAE,CAAC,GAAG4E,OAAO;MACvC,IAAIvO,IAAI,CAACgH,MAAM,EAAE;QACbuH,OAAO,CAACvH,MAAM,GAAGhH,IAAI,CAACgH,MAAM,CAAC1T,MAAM,EAAE;MACzC;MACA,IAAI0M,IAAI,CAACiH,OAAO,EAAE;QACdsH,OAAO,CAACtH,OAAO,GAAGjH,IAAI,CAACiH,OAAO,CAAC3T,MAAM,EAAE;MAC3C;IACJ;IACA,IAAI,CAAC2V,oBAAoB,EAAE;EAC/B,CAAC;;EAED;;EAEArE,MAAM,CAACzQ,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,EAAE;IACzD,IAAI,CAAC4O,YAAY,GAAG,IAAI,CAACnB,gBAAgB,CACrC5X,SAAS,CAACgZ,UAAU,EACpB,IAAI,CAACD,YAAY,CACpB;IACD,KAAK,IAAI5a,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC4a,YAAY,CAACtb,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC/C,IAAIiM,IAAI,GAAG,IAAI,CAAC2O,YAAY,CAAC5a,CAAC,CAAC;MAC/B,IAAIiM,IAAI,CAACnB,UAAU,CAACxJ,IAAI,IAAI8W,MAAM,EAAE;QAChC;MACJ;MACA;MACAnM,IAAI,CAAC6O,QAAQ,CAAC1C,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,CAAC;MACrC;IACJ;EACJ,CAAC;EAED6E,MAAM,CAACzQ,SAAS,CAAC2a,OAAO,GAAG,UAAS3C,MAAM,EAAEuC,KAAK,EAAE;IAC/C,IAAI,IAAI,CAACK,SAAS,EAAE;MAChB,IAAI,CAACA,SAAS,CAAC5C,MAAM,EAAEuC,KAAK,CAAC;IACjC;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACI9J,MAAM,CAACzQ,SAAS,CAAC6a,QAAQ,GAAG,UAAS3Z,IAAI,EAAEyG,IAAI,EAAEmT,KAAK,EAAE;IACpD,IAAIjE,KAAK,GAAG,IAAI,CAAChE,MAAM,CAAC3R,IAAI,CAAC;IAC7B,IAAI2V,KAAK,EAAE;MACP;MACA;IACJ;IAEN,IAAI,CAAC+B,YAAY,EAAE;IACb,IAAI,CAAC/F,MAAM,CAAC3R,IAAI,CAAC,GAAG;MAAEA,IAAI,EAAEA,IAAI;MAAEyG,IAAI,EAAEA,IAAI;MAAEmT,KAAK,EAAEA;IAAM,CAAC;IAC5D,IAAI,CAACxJ,QAAQ,EAAE;IACrB,IAAI,CAAC8H,WAAW,EAAE;IAEZ,IAAI,IAAI,CAAC2B,YAAY,EAAE;MACnB,IAAI,CAACA,YAAY,CAAC7Z,IAAI,EAAEyG,IAAI,CAAC;IACjC;IAEA,IAAI,IAAI,CAACqT,qBAAqB,EAAE;MAC5B,IAAI,CAACA,qBAAqB,EAAE;IAChC;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIvK,MAAM,CAACzQ,SAAS,CAACib,YAAY,GAAG,UAAS/Z,IAAI,EAAEyN,IAAI,EAAE;IACjD,IAAIkI,KAAK,GAAG,IAAI,CAAChE,MAAM,CAAC3R,IAAI,CAAC;IAC7B,IAAI,CAAC2V,KAAK,EAAE;MACR;IACJ;IACAA,KAAK,CAACiE,KAAK,GAAGnM,IAAI;EACtB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI8B,MAAM,CAACzQ,SAAS,CAACsL,YAAY,GAAG,UAASpK,IAAI,EAAE;IAC3C,IAAI2V,KAAK,GAAG,IAAI,CAAChE,MAAM,CAAC3R,IAAI,CAAC;IAC7B,IAAI,CAAC2V,KAAK,EAAE;MACR,OAAO,IAAI;IACf;IACA,OAAOA,KAAK,CAACiE,KAAK;EACtB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIrK,MAAM,CAACzQ,SAAS,CAACkb,WAAW,GAAG,UAASC,QAAQ,EAAEja,IAAI,EAAE;IACpD,IAAIA,IAAI,IAAIia,QAAQ,EAAE;MAClB;IACJ;IAEA,IAAI,CAAC,IAAI,CAACtI,MAAM,CAACsI,QAAQ,CAAC,EAAE;MACxB,OAAO,KAAK;IAChB;IAEA,IAAI,IAAI,CAACtI,MAAM,CAAC3R,IAAI,CAAC,EAAE;MACnB2G,OAAO,CAACkE,KAAK,CAAC,2CAA2C,CAAC;MAC1D,OAAO,KAAK;IAChB;IAEA,IAAI,CAAC8G,MAAM,CAAC3R,IAAI,CAAC,GAAG,IAAI,CAAC2R,MAAM,CAACsI,QAAQ,CAAC;IACzC,OAAO,IAAI,CAACtI,MAAM,CAACsI,QAAQ,CAAC;IAC5B,IAAI,CAAC7J,QAAQ,EAAE;IAEf,IAAI,IAAI,CAAC8J,cAAc,EAAE;MACrB,IAAI,CAACA,cAAc,CAACD,QAAQ,EAAEja,IAAI,CAAC;IACvC;IAEA,IAAI,IAAI,CAAC8Z,qBAAqB,EAAE;MAC5B,IAAI,CAACA,qBAAqB,EAAE;IAChC;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIvK,MAAM,CAACzQ,SAAS,CAACqb,eAAe,GAAG,UAASna,IAAI,EAAEyG,IAAI,EAAE;IACpD,IAAI,CAAC,IAAI,CAACkL,MAAM,CAAC3R,IAAI,CAAC,EAAE;MACpB,OAAO,KAAK;IAChB;IAEA,IACI,IAAI,CAAC2R,MAAM,CAAC3R,IAAI,CAAC,CAACyG,IAAI,IACtB2B,MAAM,CAAC,IAAI,CAACuJ,MAAM,CAAC3R,IAAI,CAAC,CAACyG,IAAI,CAAC,CAAC4B,WAAW,EAAE,IACxCD,MAAM,CAAC3B,IAAI,CAAC,CAAC4B,WAAW,EAAE,EAChC;MACE;IACJ;IAEA,IAAI,CAACsJ,MAAM,CAAC3R,IAAI,CAAC,CAACyG,IAAI,GAAGA,IAAI;IAC7B,IAAI,CAAC2J,QAAQ,EAAE;IACf,IAAI,IAAI,CAACgK,kBAAkB,EAAE;MACzB,IAAI,CAACA,kBAAkB,CAACpa,IAAI,EAAEyG,IAAI,CAAC;IACvC;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI8I,MAAM,CAACzQ,SAAS,CAACub,WAAW,GAAG,UAASra,IAAI,EAAE;IAC1C,IAAI,CAAC,IAAI,CAAC2R,MAAM,CAAC3R,IAAI,CAAC,EAAE;MACpB,OAAO,KAAK;IAChB;IAEA,OAAO,IAAI,CAAC2R,MAAM,CAAC3R,IAAI,CAAC;IACxB,IAAI,CAACoQ,QAAQ,EAAE;IAEf,IAAI,IAAI,CAACkK,cAAc,EAAE;MACrB,IAAI,CAACA,cAAc,CAACta,IAAI,CAAC;IAC7B;IAEA,IAAI,IAAI,CAAC8Z,qBAAqB,EAAE;MAC5B,IAAI,CAACA,qBAAqB,EAAE;IAChC;IACA,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIvK,MAAM,CAACzQ,SAAS,CAACyb,SAAS,GAAG,UAASva,IAAI,EAAEyG,IAAI,EAAEmT,KAAK,EAAE;IACrD,IAAI,CAAChI,OAAO,CAAC5R,IAAI,CAAC,GAAG;MAAEA,IAAI,EAAEA,IAAI;MAAEyG,IAAI,EAAEA,IAAI;MAAEmT,KAAK,EAAEA;IAAM,CAAC;IAC7D,IAAI,CAACxJ,QAAQ,EAAE;IAEf,IAAI,IAAI,CAACoK,aAAa,EAAE;MACpB,IAAI,CAACA,aAAa,CAACxa,IAAI,EAAEyG,IAAI,CAAC;IAClC;IAEA,IAAI,IAAI,CAACqT,qBAAqB,EAAE;MAC5B,IAAI,CAACA,qBAAqB,EAAE;IAChC;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIvK,MAAM,CAACzQ,SAAS,CAACwL,aAAa,GAAG,UAAStK,IAAI,EAAE4Z,KAAK,EAAE;IACnD,IAAIjF,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAC5R,IAAI,CAAC;IAC/B,IAAI,CAAC2U,MAAM,EAAE;MACT;IACJ;IACAA,MAAM,CAACiF,KAAK,GAAGA,KAAK;EACxB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIrK,MAAM,CAACzQ,SAAS,CAAC2b,aAAa,GAAG,UAASza,IAAI,EAAE;IAC5C,IAAI2U,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAC5R,IAAI,CAAC;IAC/B,IAAI,CAAC2U,MAAM,EAAE;MACT,OAAO,IAAI;IACf;IACA,OAAOA,MAAM,CAACiF,KAAK;EACvB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIrK,MAAM,CAACzQ,SAAS,CAAC4b,YAAY,GAAG,UAAST,QAAQ,EAAEja,IAAI,EAAE;IACrD,IAAI,CAAC,IAAI,CAAC4R,OAAO,CAACqI,QAAQ,CAAC,EAAE;MACzB,OAAO,KAAK;IAChB;IAEA,IAAI,IAAI,CAACrI,OAAO,CAAC5R,IAAI,CAAC,EAAE;MACpB2G,OAAO,CAACkE,KAAK,CAAC,4CAA4C,CAAC;MAC3D,OAAO,KAAK;IAChB;IAEA,IAAI,CAAC+G,OAAO,CAAC5R,IAAI,CAAC,GAAG,IAAI,CAAC4R,OAAO,CAACqI,QAAQ,CAAC;IAC3C,OAAO,IAAI,CAACrI,OAAO,CAACqI,QAAQ,CAAC;IAC7B,IAAI,CAAC7J,QAAQ,EAAE;IAEf,IAAI,IAAI,CAACuK,eAAe,EAAE;MACtB,IAAI,CAACA,eAAe,CAACV,QAAQ,EAAEja,IAAI,CAAC;IACxC;IAEA,IAAI,IAAI,CAAC8Z,qBAAqB,EAAE;MAC5B,IAAI,CAACA,qBAAqB,EAAE;IAChC;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIvK,MAAM,CAACzQ,SAAS,CAAC8b,gBAAgB,GAAG,UAAS5a,IAAI,EAAEyG,IAAI,EAAE;IACrD,IAAI,CAAC,IAAI,CAACmL,OAAO,CAAC5R,IAAI,CAAC,EAAE;MACrB,OAAO,KAAK;IAChB;IAEA,IACI,IAAI,CAAC4R,OAAO,CAAC5R,IAAI,CAAC,CAACyG,IAAI,IACvB2B,MAAM,CAAC,IAAI,CAACwJ,OAAO,CAAC5R,IAAI,CAAC,CAACyG,IAAI,CAAC,CAAC4B,WAAW,EAAE,IACzCD,MAAM,CAAC3B,IAAI,CAAC,CAAC4B,WAAW,EAAE,EAChC;MACE;IACJ;IAEA,IAAI,CAACuJ,OAAO,CAAC5R,IAAI,CAAC,CAACyG,IAAI,GAAGA,IAAI;IAC9B,IAAI,CAAC2J,QAAQ,EAAE;IACf,IAAI,IAAI,CAACyK,mBAAmB,EAAE;MAC1B,IAAI,CAACA,mBAAmB,CAAC7a,IAAI,EAAEyG,IAAI,CAAC;IACxC;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACI8I,MAAM,CAACzQ,SAAS,CAACgc,YAAY,GAAG,UAAS9a,IAAI,EAAE;IAC3C,IAAI,CAAC,IAAI,CAAC4R,OAAO,CAAC5R,IAAI,CAAC,EAAE;MACrB,OAAO,KAAK;IAChB;IACA,OAAO,IAAI,CAAC4R,OAAO,CAAC5R,IAAI,CAAC;IACzB,IAAI,CAACoQ,QAAQ,EAAE;IAEf,IAAI,IAAI,CAAC2K,eAAe,EAAE;MACtB,IAAI,CAACA,eAAe,CAAC/a,IAAI,CAAC;IAC9B;IAEA,IAAI,IAAI,CAAC8Z,qBAAqB,EAAE;MAC5B,IAAI,CAACA,qBAAqB,EAAE;IAChC;IACA,OAAO,IAAI;EACf,CAAC;EAEDvK,MAAM,CAACzQ,SAAS,CAACkc,YAAY,GAAG,UAAShb,IAAI,EAAE4Z,KAAK,EAAE;IAClD,IAAI3Q,KAAK,GAAG,IAAI,CAACsP,gBAAgB,CAACvY,IAAI,CAAC;IACvC,KAAK,IAAItB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuK,KAAK,CAACjL,MAAM,EAAE,EAAEU,CAAC,EAAE;MACnCuK,KAAK,CAACvK,CAAC,CAAC,CAACgb,SAAS,CAACE,KAAK,CAAC;IAC7B;EACJ,CAAC;EAEDrK,MAAM,CAACzQ,SAAS,CAACmc,WAAW,GAAG,UAASjb,IAAI,EAAEqJ,IAAI,EAAE;IAChD,IAAIJ,KAAK,GAAG,IAAI,CAACsP,gBAAgB,CAACvY,IAAI,CAAC;IACvC,KAAK,IAAItB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuK,KAAK,CAACjL,MAAM,EAAE,EAAEU,CAAC,EAAE;MACnCuK,KAAK,CAACvK,CAAC,CAAC,CAACwc,UAAU,CAAC7R,IAAI,CAAC;IAC7B;EACJ,CAAC;;EAEJ;EACGkG,MAAM,CAACzQ,SAAS,CAAC4Y,YAAY,GAAG,UAASyD,IAAI,EAAE;IAC3C,IAAI,IAAI,CAACC,cAAc,EAAE;MACrB,IAAI,CAACA,cAAc,CAAC,IAAI,EAACD,IAAI,CAAC;IAClC;IACA,IAAI,CAACrJ,kBAAkB,CAAC,gBAAgB,EAAE,IAAI,CAAC;EACnD,CAAC;;EAEJ;EACGvC,MAAM,CAACzQ,SAAS,CAACoZ,WAAW,GAAG,UAASiD,IAAI,EAAE;IAC1C,IAAI,IAAI,CAACE,aAAa,EAAE;MACpB,IAAI,CAACA,aAAa,CAAC,IAAI,EAACF,IAAI,CAAC;IACjC;IACA,IAAI,CAACrJ,kBAAkB,CAAC,eAAe,EAAE,IAAI,CAAC;EAClD,CAAC;EAEDvC,MAAM,CAACzQ,SAAS,CAACwc,gBAAgB,GAAG,UAAS3Q,IAAI,EAAE4Q,SAAS,EAAE;IAC1D,IAAI,CAAC3H,oBAAoB,EAAE;IAC3B,IAAI,IAAI,CAAC4H,kBAAkB,EAAE;MACzB,IAAI,CAACA,kBAAkB,CAAC7Q,IAAI,CAAC;IACjC;IACA,IAAI,CAACyF,QAAQ,EAAE;IACf,IAAI,CAAC0B,kBAAkB,CAAC,oBAAoB,CAAC;EACjD,CAAC;;EAED;AACJ;AACA;AACA;;EAEIvC,MAAM,CAACzQ,SAAS,CAAC2c,MAAM,GAAG,YAAW;IACjC,IAAI,CAAC,IAAI,CAAChM,mBAAmB,EAAE;MAC3B,OAAO,KAAK;IAChB;IAEA,KAAK,IAAI/Q,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC+Q,mBAAmB,CAACzR,MAAM,EAAE,EAAEU,CAAC,EAAE;MACtD,IAAIqY,CAAC,GAAG,IAAI,CAACtH,mBAAmB,CAAC/Q,CAAC,CAAC;MACnC,IAAIqY,CAAC,CAAC2E,SAAS,EAAE;QACb,OAAO,IAAI;MACf;IACJ;IACA,OAAO,KAAK;EAChB,CAAC;;EAED;AACJ;AACA;AACA;EACInM,MAAM,CAACzQ,SAAS,CAAC6c,mBAAmB,GAAG,YAAW;IAC9C,KAAK,IAAIjd,CAAC,IAAI,IAAI,CAACiS,KAAK,EAAE;MACtB,IAAI4K,SAAS,GAAG,IAAI,CAAC5K,KAAK,CAACjS,CAAC,CAAC;MAC7B,IAAI,CAAC6c,SAAS,EAAE;QACZ;MACJ;MACA,IAAIA,SAAS,CAACK,UAAU,EAAE;QACtBL,SAAS,CAACK,UAAU,GAAG,CAAC;MAC5B;IACJ;EACJ,CAAC;;EAED;EACArM,MAAM,CAACzQ,SAAS,CAAC+S,MAAM,GAAG,YAAW;IACjC,IAAItR,SAAS,CAACiE,KAAK,EAAE;MACjBmC,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC;IAChC;IACA,IAAI,CAACkL,kBAAkB,CAAC,UAAU,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IACjD,IAAI,IAAI,CAAC+J,SAAS,EAAE;MAChB,IAAI,CAACA,SAAS,CAAC,IAAI,CAAC;IACxB;EACJ,CAAC;EAEDtM,MAAM,CAACzQ,SAAS,CAAC0X,cAAc,GAAG,UAASsF,EAAE,EAAEC,EAAE,EAAE;IAC/C,IAAI,CAACjK,kBAAkB,CAAC,UAAU,EAAE,CAACgK,EAAE,EAAEC,EAAE,CAAC,CAAC;EACjD,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIxM,MAAM,CAACzQ,SAAS,CAACkd,UAAU,GAAG,UAASpH,OAAO,EAAE;IAC5C,IAAIJ,IAAI,GAAG,IAAI,CAAC7D,KAAK,CAACiE,OAAO,CAAC;IAC9B,IAAI,CAACJ,IAAI,EAAE;MACP;IACJ;IACA,IAAI7J,IAAI,GAAG,IAAI,CAACmK,WAAW,CAACN,IAAI,CAACO,SAAS,CAAC;IAC3C,IAAIpK,IAAI,EAAE;MACNA,IAAI,CAACiN,eAAe,CAACpD,IAAI,CAACyH,WAAW,CAAC;IAC1C;EACJ,CAAC;;EAED;EACA;AACJ;AACA;AACA;AACA;EACI1M,MAAM,CAACzQ,SAAS,CAACqa,SAAS,GAAG,YAAW;IACpC,IAAI+C,UAAU,GAAG,EAAE;IACnB,KAAK,IAAIxd,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAAChE,MAAM,CAACrS,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAChDwd,UAAU,CAACvd,IAAI,CAAC,IAAI,CAAC0R,MAAM,CAAC3R,CAAC,CAAC,CAACya,SAAS,EAAE,CAAC;IAC/C;;IAEA;IACA,IAAIxI,KAAK,GAAG,EAAE;IACd,KAAK,IAAIjS,CAAC,IAAI,IAAI,CAACiS,KAAK,EAAE;MACtB;MACA,IAAI6D,IAAI,GAAG,IAAI,CAAC7D,KAAK,CAACjS,CAAC,CAAC;MACxB,IAAI,CAAC8V,IAAI,CAAC2E,SAAS,EAAE;QACjB;QACAxS,OAAO,CAACqB,IAAI,CACR,gEAAgE,CACnE;QACD,IAAImU,KAAK,GAAG,IAAIC,KAAK,EAAE;QACvB,KAAK,IAAI/O,CAAC,IAAImH,IAAI,EAAE;UAChB2H,KAAK,CAAC9O,CAAC,CAAC,GAAGmH,IAAI,CAACnH,CAAC,CAAC;QACtB;QACA,IAAI,CAACsD,KAAK,CAACjS,CAAC,CAAC,GAAGyd,KAAK;QACrB3H,IAAI,GAAG2H,KAAK;MAChB;MAEAxL,KAAK,CAAChS,IAAI,CAAC6V,IAAI,CAAC2E,SAAS,EAAE,CAAC;IAChC;IAEA,IAAIkD,WAAW,GAAG,EAAE;IACpB,KAAK,IAAI3d,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACgS,OAAO,CAAC1S,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC1C2d,WAAW,CAAC1d,IAAI,CAAC,IAAI,CAAC+R,OAAO,CAAChS,CAAC,CAAC,CAACya,SAAS,EAAE,CAAC;IACjD;IAEA,IAAI1L,IAAI,GAAG;MACPyC,YAAY,EAAE,IAAI,CAACA,YAAY;MAC/BC,YAAY,EAAE,IAAI,CAACA,YAAY;MAC/BlH,KAAK,EAAEiT,UAAU;MACjBvL,KAAK,EAAEA,KAAK;MACZ2L,MAAM,EAAED,WAAW;MACnBxL,MAAM,EAAE,IAAI,CAACA,MAAM;MAC5BE,KAAK,EAAE,IAAI,CAACA,KAAK;MACR5R,OAAO,EAAEoB,SAAS,CAACC;IACvB,CAAC;IAEP,IAAG,IAAI,CAAC+b,WAAW,EAClB,IAAI,CAACA,WAAW,CAAC9O,IAAI,CAAC;IAEjB,OAAOA,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI8B,MAAM,CAACzQ,SAAS,CAAC6Q,SAAS,GAAG,UAASlC,IAAI,EAAE+O,QAAQ,EAAE;IAClD,IAAI,CAAC/O,IAAI,EAAE;MACP;IACJ;IAEA,IAAI,CAAC+O,QAAQ,EAAE;MACX,IAAI,CAAC9M,KAAK,EAAE;IAChB;IAEA,IAAIzG,KAAK,GAAGwE,IAAI,CAACxE,KAAK;;IAEtB;IACA,IAAIwE,IAAI,CAACkD,KAAK,IAAIlD,IAAI,CAACkD,KAAK,CAACxI,WAAW,KAAK3J,KAAK,EAAE;MAChD,IAAImS,KAAK,GAAG,EAAE;MACd,KAAK,IAAIjS,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+O,IAAI,CAACkD,KAAK,CAAC3S,MAAM,EAAE,EAAEU,CAAC,EAAE;QACxC,IAAI+d,SAAS,GAAGhP,IAAI,CAACkD,KAAK,CAACjS,CAAC,CAAC;QACzC,IAAG,CAAC+d,SAAS;UAAE;UACf;YACC9V,OAAO,CAACqB,IAAI,CAAC,uDAAuD,CAAC;YACrE;UACD;QACY,IAAIwM,IAAI,GAAG,IAAI4H,KAAK,EAAE;QACtB5H,IAAI,CAAC7E,SAAS,CAAC8M,SAAS,CAAC;QACzB9L,KAAK,CAAC6D,IAAI,CAACF,EAAE,CAAC,GAAGE,IAAI;MACzB;MACA/G,IAAI,CAACkD,KAAK,GAAGA,KAAK;IACtB;;IAEA;IACA,KAAK,IAAIjS,CAAC,IAAI+O,IAAI,EAAE;MACzB,IAAG/O,CAAC,IAAI,OAAO,IAAIA,CAAC,IAAI,QAAQ;QAAG;QAClC;MACQ,IAAI,CAACA,CAAC,CAAC,GAAG+O,IAAI,CAAC/O,CAAC,CAAC;IACrB;IAEA,IAAImM,KAAK,GAAG,KAAK;;IAEjB;IACA,IAAI,CAACwF,MAAM,GAAG,EAAE;IAChB,IAAIpH,KAAK,EAAE;MACP,KAAK,IAAIvK,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAGpL,KAAK,CAACjL,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;QAC1C,IAAIge,MAAM,GAAGzT,KAAK,CAACvK,CAAC,CAAC,CAAC,CAAC;QACvB,IAAIiM,IAAI,GAAGpK,SAAS,CAACkK,UAAU,CAACiS,MAAM,CAACjW,IAAI,EAAEiW,MAAM,CAAC1d,KAAK,CAAC;QAC1D,IAAI,CAAC2L,IAAI,EAAE;UACP,IAAIpK,SAAS,CAACiE,KAAK,EAAE;YACjBmC,OAAO,CAACC,GAAG,CACP,gCAAgC,GAAG8V,MAAM,CAACjW,IAAI,CACjD;UACL;;UAEA;UACAkE,IAAI,GAAG,IAAIvD,UAAU,EAAE;UACvBuD,IAAI,CAACgS,kBAAkB,GAAGD,MAAM;UAChC/R,IAAI,CAACiS,UAAU,GAAG,IAAI;UACtB/R,KAAK,GAAG,IAAI;UACZ;QACJ;;QAEAF,IAAI,CAAC2J,EAAE,GAAGoI,MAAM,CAACpI,EAAE,CAAC,CAAC;QACrB,IAAI,CAAC0C,GAAG,CAACrM,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC;MAC1B;;MAEA;MACA,KAAK,IAAIjM,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAGpL,KAAK,CAACjL,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;QAC1C,IAAIge,MAAM,GAAGzT,KAAK,CAACvK,CAAC,CAAC;QACrB,IAAIiM,IAAI,GAAG,IAAI,CAACmK,WAAW,CAAC4H,MAAM,CAACpI,EAAE,CAAC;QACtC,IAAI3J,IAAI,EAAE;UACNA,IAAI,CAACgF,SAAS,CAAC+M,MAAM,CAAC;QAC1B;MACJ;IACJ;;IAEA;IACA,IAAI,CAAChM,OAAO,CAAC1S,MAAM,GAAG,CAAC;IACvB,IAAIyP,IAAI,CAAC6O,MAAM,EAAE;MACb,KAAK,IAAI5d,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+O,IAAI,CAAC6O,MAAM,CAACte,MAAM,EAAE,EAAEU,CAAC,EAAE;QACzC,IAAIme,KAAK,GAAG,IAAItc,SAAS,CAAC2W,WAAW,EAAE;QACvC2F,KAAK,CAAClN,SAAS,CAAClC,IAAI,CAAC6O,MAAM,CAAC5d,CAAC,CAAC,CAAC;QAC/B,IAAI,CAACsY,GAAG,CAAC6F,KAAK,CAAC;MACnB;IACJ;IAEA,IAAI,CAACjJ,oBAAoB,EAAE;IAEjC,IAAI,CAAC7C,KAAK,GAAGtD,IAAI,CAACsD,KAAK,IAAI,CAAC,CAAC;IAE7B,IAAG,IAAI,CAAC+L,WAAW,EAClB,IAAI,CAACA,WAAW,CAACrP,IAAI,CAAC;IAEjB,IAAI,CAAC2C,QAAQ,EAAE;IACf,IAAI,CAACoG,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;IAC/B,OAAO3L,KAAK;EAChB,CAAC;EAED0E,MAAM,CAACzQ,SAAS,CAACie,IAAI,GAAG,UAASpP,GAAG,EAAEqP,QAAQ,EAAE;IAC5C,IAAIlP,IAAI,GAAG,IAAI;;IAErB;IACA,IAAGH,GAAG,CAACxF,WAAW,KAAKqG,IAAI,IAAIb,GAAG,CAACxF,WAAW,KAAKsG,IAAI,EACvD;MACC,IAAIC,MAAM,GAAG,IAAIC,UAAU,EAAE;MAC7BD,MAAM,CAACuO,gBAAgB,CAAC,MAAM,EAAE,UAASC,KAAK,EAAE;QAC/C,IAAIzP,IAAI,GAAG5D,IAAI,CAACiD,KAAK,CAACoQ,KAAK,CAACrQ,MAAM,CAACjB,MAAM,CAAC;QAC1CkC,IAAI,CAAC6B,SAAS,CAAClC,IAAI,CAAC;QACpB,IAAGuP,QAAQ,EACVA,QAAQ,EAAE;MACZ,CAAC,CAAC;MAEFtO,MAAM,CAACI,UAAU,CAACnB,GAAG,CAAC;MACtB;IACD;;IAEA;IACM,IAAIwP,GAAG,GAAG,IAAIC,cAAc,EAAE;IAC9BD,GAAG,CAACE,IAAI,CAAC,KAAK,EAAE1P,GAAG,EAAE,IAAI,CAAC;IAC1BwP,GAAG,CAACG,IAAI,CAAC,IAAI,CAAC;IACdH,GAAG,CAACvO,MAAM,GAAG,UAAS2O,MAAM,EAAE;MAC1B,IAAIJ,GAAG,CAAClN,MAAM,KAAK,GAAG,EAAE;QACpBtJ,OAAO,CAACkE,KAAK,CAAC,sBAAsB,EAAEsS,GAAG,CAAClN,MAAM,EAAEkN,GAAG,CAAClP,QAAQ,CAAC;QAC/D;MACJ;MACA,IAAIR,IAAI,GAAG5D,IAAI,CAACiD,KAAK,CAAEqQ,GAAG,CAAClP,QAAQ,CAAE;MACrCH,IAAI,CAAC6B,SAAS,CAAClC,IAAI,CAAC;MAC7B,IAAGuP,QAAQ,EACVA,QAAQ,EAAE;IACN,CAAC;IACDG,GAAG,CAACK,OAAO,GAAG,UAAS5S,GAAG,EAAE;MACxBjE,OAAO,CAACkE,KAAK,CAAC,sBAAsB,EAAED,GAAG,CAAC;IAC9C,CAAC;EACL,CAAC;EAED2E,MAAM,CAACzQ,SAAS,CAAC2e,WAAW,GAAG,UAAS9S,IAAI,EAAE+S,GAAG,EAAEC,KAAK,EAAE;IACtD;EAAA,CACH;;EAED;EACA,SAASvB,KAAK,CAAC9H,EAAE,EAAE7N,IAAI,EAAEmX,SAAS,EAAEC,WAAW,EAAE9I,SAAS,EAAEkH,WAAW,EAAE;IACrE,IAAI,CAAC3H,EAAE,GAAGA,EAAE;IACZ,IAAI,CAAC7N,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACmX,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACC,WAAW,GAAGA,WAAW;IAC9B,IAAI,CAAC9I,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACkH,WAAW,GAAGA,WAAW;IAE9B,IAAI,CAAC6B,KAAK,GAAG,IAAI;IACjB,IAAI,CAACC,IAAI,GAAG,IAAIC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;EACrC;;EAEA5B,KAAK,CAACtd,SAAS,CAAC6Q,SAAS,GAAG,UAASH,CAAC,EAAE;IACpC,IAAIA,CAAC,CAACrH,WAAW,KAAK3J,KAAK,EAAE;MACzB,IAAI,CAAC8V,EAAE,GAAG9E,CAAC,CAAC,CAAC,CAAC;MACd,IAAI,CAACoO,SAAS,GAAGpO,CAAC,CAAC,CAAC,CAAC;MACrB,IAAI,CAACqO,WAAW,GAAGrO,CAAC,CAAC,CAAC,CAAC;MACvB,IAAI,CAACuF,SAAS,GAAGvF,CAAC,CAAC,CAAC,CAAC;MACrB,IAAI,CAACyM,WAAW,GAAGzM,CAAC,CAAC,CAAC,CAAC;MACvB,IAAI,CAAC/I,IAAI,GAAG+I,CAAC,CAAC,CAAC,CAAC;IACpB,CAAC,MAAM;MACH,IAAI,CAAC8E,EAAE,GAAG9E,CAAC,CAAC8E,EAAE;MACd,IAAI,CAAC7N,IAAI,GAAG+I,CAAC,CAAC/I,IAAI;MAClB,IAAI,CAACmX,SAAS,GAAGpO,CAAC,CAACoO,SAAS;MAC5B,IAAI,CAACC,WAAW,GAAGrO,CAAC,CAACqO,WAAW;MAChC,IAAI,CAAC9I,SAAS,GAAGvF,CAAC,CAACuF,SAAS;MAC5B,IAAI,CAACkH,WAAW,GAAGzM,CAAC,CAACyM,WAAW;IACpC;EACJ,CAAC;EAEDG,KAAK,CAACtd,SAAS,CAACqa,SAAS,GAAG,YAAW;IACnC,OAAO,CACH,IAAI,CAAC7E,EAAE,EACP,IAAI,CAACsJ,SAAS,EACd,IAAI,CAACC,WAAW,EAChB,IAAI,CAAC9I,SAAS,EACd,IAAI,CAACkH,WAAW,EAChB,IAAI,CAACxV,IAAI,CACZ;EACL,CAAC;EAEDlG,SAAS,CAAC6b,KAAK,GAAGA,KAAK;;EAEvB;EACA;EACA;;EAEA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAMI;AACJ;AACA;AACA;AACA;;EAEI,SAAShV,UAAU,CAACpI,KAAK,EAAE;IACvB,IAAI,CAACif,KAAK,CAACjf,KAAK,CAAC;EACrB;EAEAsB,MAAM,CAAC8G,UAAU,GAAG7G,SAAS,CAAC6G,UAAU,GAAGA,UAAU;EAErDA,UAAU,CAACtI,SAAS,CAACmf,KAAK,GAAG,UAASjf,KAAK,EAAE;IACzC,IAAI,CAACA,KAAK,GAAGA,KAAK,IAAI,SAAS;IAC/B,IAAI,CAACgM,IAAI,GAAG,CAACzK,SAAS,CAACO,UAAU,EAAE,EAAE,CAAC;IACtC,IAAI,CAACoR,KAAK,GAAG,IAAI;IAEjB,IAAI,CAAC6L,IAAI,GAAG,IAAIC,YAAY,CAAC,EAAE,EAAE,EAAE,CAAC;IAEpC1W,MAAM,CAACE,cAAc,CAAC,IAAI,EAAE,KAAK,EAAE;MAC/BC,GAAG,EAAE,aAASC,CAAC,EAAE;QACb,IAAI,CAACA,CAAC,IAAIA,CAAC,CAAC1J,MAAM,GAAG,CAAC,EAAE;UACpB;QACJ;QACA,IAAI,CAAC+f,IAAI,CAAC,CAAC,CAAC,GAAGrW,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,CAACqW,IAAI,CAAC,CAAC,CAAC,GAAGrW,CAAC,CAAC,CAAC,CAAC;MACvB,CAAC;MACDE,GAAG,EAAE,eAAW;QACZ,OAAO,IAAI,CAACmW,IAAI;MACpB,CAAC;MACDlW,UAAU,EAAE;IAChB,CAAC,CAAC;IAEF,IAAI,CAACyM,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;IACd,IAAI,CAAC7N,IAAI,GAAG,IAAI;;IAEhB;IACA,IAAI,CAACkL,MAAM,GAAG,EAAE;IAChB,IAAI,CAACC,OAAO,GAAG,EAAE;IACjB,IAAI,CAACsM,WAAW,GAAG,EAAE;;IAErB;IACA,IAAI,CAAC1U,UAAU,GAAG,CAAC,CAAC,CAAC,CAAC;IACtB,IAAI,CAACsB,eAAe,GAAG,EAAE,CAAC,CAAC;;IAE3B,IAAI,CAACC,KAAK,GAAG,CAAC,CAAC;EACnB,CAAC;;EAED;AACJ;AACA;AACA;EACI3D,UAAU,CAACtI,SAAS,CAAC6Q,SAAS,GAAG,UAASwL,IAAI,EAAE;IAC5C,IAAI,IAAI,CAACjJ,KAAK,EAAE;MACZ,IAAI,CAACA,KAAK,CAAC9B,QAAQ,EAAE;IACzB;IACA,KAAK,IAAI/C,CAAC,IAAI8N,IAAI,EAAE;MAChB,IAAI9N,CAAC,IAAI,YAAY,EAAE;QACnB;QACA,KAAK,IAAI8Q,CAAC,IAAIhD,IAAI,CAAC3R,UAAU,EAAE;UAC3B,IAAI,CAACA,UAAU,CAAC2U,CAAC,CAAC,GAAGhD,IAAI,CAAC3R,UAAU,CAAC2U,CAAC,CAAC;UACvC,IAAI,IAAI,CAACC,iBAAiB,EAAE;YACxB,IAAI,CAACA,iBAAiB,CAAED,CAAC,EAAEhD,IAAI,CAAC3R,UAAU,CAAC2U,CAAC,CAAC,CAAE;UACnD;QACJ;QACA;MACJ;MAEA,IAAIhD,IAAI,CAAC9N,CAAC,CAAC,IAAI,IAAI,EAAE;QACjB;MACJ,CAAC,MAAM,IAAI,QAAO8N,IAAI,CAAC9N,CAAC,CAAC,KAAI,QAAQ,EAAE;QACnC;QACA,IAAI,IAAI,CAACA,CAAC,CAAC,IAAI,IAAI,CAACA,CAAC,CAAC,CAACsC,SAAS,EAAE;UAC9B,IAAI,CAACtC,CAAC,CAAC,CAACsC,SAAS,CAACwL,IAAI,CAAC9N,CAAC,CAAC,CAAC;QAC9B,CAAC,MAAM;UACH,IAAI,CAACA,CAAC,CAAC,GAAG9M,SAAS,CAACoM,WAAW,CAACwO,IAAI,CAAC9N,CAAC,CAAC,EAAE,IAAI,CAACA,CAAC,CAAC,CAAC;QACrD;MACJ,CAAC,CAAC;MAAA,KACG;QACD,IAAI,CAACA,CAAC,CAAC,GAAG8N,IAAI,CAAC9N,CAAC,CAAC;MACrB;IACJ;IAEA,IAAI,CAAC8N,IAAI,CAACnc,KAAK,EAAE;MACb,IAAI,CAACA,KAAK,GAAG,IAAI,CAACmJ,WAAW,CAACnJ,KAAK;IACvC;IAEN,IAAI,IAAI,CAAC2S,MAAM,EAAE;MAChB,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACiT,MAAM,CAAC3T,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC5C,IAAIiX,KAAK,GAAG,IAAI,CAAChE,MAAM,CAACjT,CAAC,CAAC;QAC1B,IAAI6c,SAAS,GAAG,IAAI,CAACrJ,KAAK,GAAG,IAAI,CAACA,KAAK,CAACvB,KAAK,CAACgF,KAAK,CAACnB,IAAI,CAAC,GAAG,IAAI;QAChE,IAAI,IAAI,CAAC6J,mBAAmB,EAC3B,IAAI,CAACA,mBAAmB,CAAE9d,SAAS,CAACuC,KAAK,EAAEpE,CAAC,EAAE,IAAI,EAAE6c,SAAS,EAAE5F,KAAK,CAAE,CAAC,CAAC;;QAEzE,IAAI,IAAI,CAACkE,YAAY,EACpB,IAAI,CAACA,YAAY,CAAClE,KAAK,CAAC;MAE1B;IACD;IAEA,IAAI,IAAI,CAAC/D,OAAO,EAAE;MACjB,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC5T,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC7C,IAAIiW,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAClT,CAAC,CAAC;QAC5B,IAAI,CAACiW,MAAM,CAAChE,KAAK,EAAE;UAClB;QACD;QACA,KAAK,IAAItD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGsH,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAAE,EAAEqP,CAAC,EAAE;UAC7C,IAAIkO,SAAS,GAAG,IAAI,CAACrJ,KAAK,GAAI,IAAI,CAACA,KAAK,CAACvB,KAAK,CAACgE,MAAM,CAAChE,KAAK,CAACtD,CAAC,CAAC,CAAC,GAAG,IAAI;UACtE,IAAI,IAAI,CAACgR,mBAAmB,EAC3B,IAAI,CAACA,mBAAmB,CAAE9d,SAAS,CAACwC,MAAM,EAAErE,CAAC,EAAE,IAAI,EAAE6c,SAAS,EAAE5G,MAAM,CAAE,CAAC,CAAC;QAC5E;;QAEA,IAAI,IAAI,CAAC6F,aAAa,EACrB,IAAI,CAACA,aAAa,CAAC7F,MAAM,CAAC;MAC5B;IACK;IAEN,IAAI,IAAI,CAAC2J,OAAO,EAChB;MACC,KAAK,IAAI5f,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC4f,OAAO,CAACtgB,MAAM,EAAE,EAAEU,CAAC,EAC5C;QACC,IAAI6f,CAAC,GAAG,IAAI,CAACD,OAAO,CAAC5f,CAAC,CAAC;QACvB,IAAG,CAAC6f,CAAC,EACJ;QACD,IAAGA,CAAC,CAAC7T,OAAO,IAAI6T,CAAC,CAAC7T,OAAO,CAAC8T,QAAQ,IAAI,IAAI,CAAChV,UAAU,CAAE+U,CAAC,CAAC7T,OAAO,CAAC8T,QAAQ,CAAE,EAC1ED,CAAC,CAAC3E,KAAK,GAAG/P,IAAI,CAACiD,KAAK,CAAEjD,IAAI,CAACC,SAAS,CAAE,IAAI,CAACN,UAAU,CAAE+U,CAAC,CAAC7T,OAAO,CAAC8T,QAAQ,CAAE,CAAE,CAAE;MACjF;MACA,IAAIrD,IAAI,CAACsD,cAAc,EAAE;QACxB,KAAK,IAAI/f,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGyc,IAAI,CAACsD,cAAc,CAACzgB,MAAM,EAAE,EAAEU,CAAC,EAAE;UACpD,IAAI,IAAI,CAAC4f,OAAO,CAAC5f,CAAC,CAAC,EAAE;YACpB,IAAI,CAAC4f,OAAO,CAAC5f,CAAC,CAAC,CAACkb,KAAK,GAAGuB,IAAI,CAACsD,cAAc,CAAC/f,CAAC,CAAC;UAC/C;QACD;MACD;IACD;IAEM,IAAI,IAAI,CAACoe,WAAW,EAAE;MAClB,IAAI,CAACA,WAAW,CAAC3B,IAAI,CAAC;IAC1B;EACJ,CAAC;;EAED;AACJ;AACA;AACA;;EAEI/T,UAAU,CAACtI,SAAS,CAACqa,SAAS,GAAG,YAAW;IACxC;IACA,IAAI3J,CAAC,GAAG;MACJ8E,EAAE,EAAE,IAAI,CAACA,EAAE;MACX7N,IAAI,EAAE,IAAI,CAACA,IAAI;MACfO,GAAG,EAAE,IAAI,CAACA,GAAG;MACbgE,IAAI,EAAE,IAAI,CAACA,IAAI;MACfD,KAAK,EAAExK,SAAS,CAACoM,WAAW,CAAC,IAAI,CAAC5B,KAAK,CAAC;MACjDiK,KAAK,EAAE,IAAI,CAACA,KAAK;MACR9J,IAAI,EAAE,IAAI,CAACA;IACf,CAAC;;IAED;IACA,IAAI,IAAI,CAAC/C,WAAW,KAAKf,UAAU,IAAI,IAAI,CAACuV,kBAAkB,EAAE;MAC5D,OAAO,IAAI,CAACA,kBAAkB;IAClC;IAEA,IAAI,IAAI,CAAChL,MAAM,EAAE;MACbnC,CAAC,CAACmC,MAAM,GAAG,IAAI,CAACA,MAAM;IAC1B;IAEA,IAAI,IAAI,CAACC,OAAO,EAAE;MACd;MACA,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC5T,MAAM,EAAEU,CAAC,EAAE,EAAE;QAC1C,OAAO,IAAI,CAACkT,OAAO,CAAClT,CAAC,CAAC,CAACof,KAAK;MAChC;MACAtO,CAAC,CAACoC,OAAO,GAAG,IAAI,CAACA,OAAO;IAC5B;IAEA,IAAI,IAAI,CAAC5S,KAAK,IAAI,IAAI,CAACA,KAAK,IAAI,IAAI,CAACmJ,WAAW,CAACnJ,KAAK,EAAE;MACpDwQ,CAAC,CAACxQ,KAAK,GAAG,IAAI,CAACA,KAAK;IACxB;IAEA,IAAI,IAAI,CAACwK,UAAU,EAAE;MACjBgG,CAAC,CAAChG,UAAU,GAAGjJ,SAAS,CAACoM,WAAW,CAAC,IAAI,CAACnD,UAAU,CAAC;IACzD;IAEA,IAAI,IAAI,CAAC8U,OAAO,IAAI,IAAI,CAACI,iBAAiB,EAAE;MACxClP,CAAC,CAACiP,cAAc,GAAG,EAAE;MACrB,KAAK,IAAI/f,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC4f,OAAO,CAACtgB,MAAM,EAAE,EAAEU,CAAC,EAAE;QACtD,IAAG,IAAI,CAAC4f,OAAO,CAAC5f,CAAC,CAAC,EACL8Q,CAAC,CAACiP,cAAc,CAAC/f,CAAC,CAAC,GAAG,IAAI,CAAC4f,OAAO,CAAC5f,CAAC,CAAC,CAACkb,KAAK,CAAC,KAExDpK,CAAC,CAACiP,cAAc,CAAC/f,CAAC,CAAC,GAAG,IAAI;MACnB;IACJ;IAEA,IAAI,CAAC8Q,CAAC,CAAC/I,IAAI,EAAE;MACT+I,CAAC,CAAC/I,IAAI,GAAG,IAAI,CAAC0B,WAAW,CAAC1B,IAAI;IAClC;IAEA,IAAI,IAAI,CAACkX,KAAK,EAAE;MACZnO,CAAC,CAACmO,KAAK,GAAG,IAAI,CAACA,KAAK;IACxB;IACA,IAAI,IAAI,CAACgB,OAAO,EAAE;MACdnP,CAAC,CAACmP,OAAO,GAAG,IAAI,CAACA,OAAO;IAC5B;IACA,IAAI,IAAI,CAACC,QAAQ,EAAE;MACfpP,CAAC,CAACoP,QAAQ,GAAG,IAAI,CAACA,QAAQ;IAC9B;IACA,IAAI,IAAI,CAACC,KAAK,EAAE;MACZrP,CAAC,CAACqP,KAAK,GAAG,IAAI,CAACA,KAAK;IACxB;IAEA,IAAI,IAAI,CAACtC,WAAW,EAAE;MAClB,IAAI,IAAI,CAACA,WAAW,CAAC/M,CAAC,CAAC,EAAE;QACrB7I,OAAO,CAACqB,IAAI,CACR,4GAA4G,CAC/G;MACL;IACJ;IAEA,OAAOwH,CAAC;EACZ,CAAC;;EAED;EACApI,UAAU,CAACtI,SAAS,CAACggB,KAAK,GAAG,YAAW;IACpC,IAAInU,IAAI,GAAGpK,SAAS,CAACkK,UAAU,CAAC,IAAI,CAAChE,IAAI,CAAC;IAC1C,IAAI,CAACkE,IAAI,EAAE;MACP,OAAO,IAAI;IACf;;IAEA;IACA,IAAI8C,IAAI,GAAGlN,SAAS,CAACoM,WAAW,CAAC,IAAI,CAACwM,SAAS,EAAE,CAAC;;IAElD;IACA,IAAI1L,IAAI,CAACkE,MAAM,EAAE;MACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+O,IAAI,CAACkE,MAAM,CAAC3T,MAAM,EAAE,EAAEU,CAAC,EAAE;QACzC+O,IAAI,CAACkE,MAAM,CAACjT,CAAC,CAAC,CAAC8V,IAAI,GAAG,IAAI;MAC9B;IACJ;IAEA,IAAI/G,IAAI,CAACmE,OAAO,EAAE;MACd,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+O,IAAI,CAACmE,OAAO,CAAC5T,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC1C,IAAI+O,IAAI,CAACmE,OAAO,CAAClT,CAAC,CAAC,CAACiS,KAAK,EAAE;UACvBlD,IAAI,CAACmE,OAAO,CAAClT,CAAC,CAAC,CAACiS,KAAK,CAAC3S,MAAM,GAAG,CAAC;QACpC;MACJ;IACJ;IAEA,OAAOyP,IAAI,CAAC,IAAI,CAAC;IACjB;IACA9C,IAAI,CAACgF,SAAS,CAAClC,IAAI,CAAC;IAEpB,OAAO9C,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;;EAEIvD,UAAU,CAACtI,SAAS,CAACigB,QAAQ,GAAG,YAAW;IACvC,OAAOlV,IAAI,CAACC,SAAS,CAAC,IAAI,CAACqP,SAAS,EAAE,CAAC;EAC3C,CAAC;EACD;;EAEA;AACJ;AACA;AACA;;EAEI/R,UAAU,CAACtI,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IACvC,OAAO,IAAI,CAAChgB,KAAK,IAAI,IAAI,CAACmJ,WAAW,CAACnJ,KAAK;EAC/C,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIoI,UAAU,CAACtI,SAAS,CAACmgB,WAAW,GAAG,UAASjf,IAAI,EAAE4Z,KAAK,EAAE;IACrD,IAAI,CAAC,IAAI,CAACpQ,UAAU,EAAE;MAClB,IAAI,CAACA,UAAU,GAAG,CAAC,CAAC;IACxB;IACN,IAAIoQ,KAAK,KAAK,IAAI,CAACpQ,UAAU,CAACxJ,IAAI,CAAC,EAClC;IACD,IAAIkf,UAAU,GAAG,IAAI,CAAC1V,UAAU,CAACxJ,IAAI,CAAC;IAChC,IAAI,CAACwJ,UAAU,CAACxJ,IAAI,CAAC,GAAG4Z,KAAK;IAC7B,IAAI,IAAI,CAACwE,iBAAiB,EAAE;MACxB,IAAI,IAAI,CAACA,iBAAiB,CAACpe,IAAI,EAAE4Z,KAAK,EAAEsF,UAAU,CAAC,KAAK,KAAK;QAAG;QACxE,IAAI,CAAC1V,UAAU,CAACxJ,IAAI,CAAC,GAAGkf,UAAU;IAC9B;IACN,IAAG,IAAI,CAACZ,OAAO;MAAE;MAChB,KAAI,IAAI5f,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC4f,OAAO,CAACtgB,MAAM,EAAE,EAAEU,CAAC,EAC3C;QACC,IAAI6f,CAAC,GAAG,IAAI,CAACD,OAAO,CAAC5f,CAAC,CAAC;QACvB,IAAG,CAAC6f,CAAC,EACJ;QACD,IAAGA,CAAC,CAAC7T,OAAO,CAAC8T,QAAQ,IAAIxe,IAAI,EAC7B;UACCue,CAAC,CAAC3E,KAAK,GAAGA,KAAK;UACf;QACD;MACD;EACC,CAAC;;EAED;EACA;AACJ;AACA;AACA;AACA;AACA;EACIxS,UAAU,CAACtI,SAAS,CAACwL,aAAa,GAAG,UAASqN,IAAI,EAAElK,IAAI,EAAE;IACtD,IAAI,CAAC,IAAI,CAACmE,OAAO,EAAE;MACf;IACJ;;IAEA;IACA;IACA;;IAEA,IAAI+F,IAAI,IAAI,CAAC,CAAC,IAAIA,IAAI,IAAI,IAAI,CAAC/F,OAAO,CAAC5T,MAAM,EAAE;MAC3C;IACJ;IAEA,IAAImhB,WAAW,GAAG,IAAI,CAACvN,OAAO,CAAC+F,IAAI,CAAC;IACpC,IAAI,CAACwH,WAAW,EAAE;MACd;IACJ;;IAEA;IACAA,WAAW,CAACrB,KAAK,GAAGrQ,IAAI;;IAExB;IACA,IAAI,IAAI,CAACmE,OAAO,CAAC+F,IAAI,CAAC,CAAChH,KAAK,EAAE;MAC1B,KAAK,IAAIjS,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC+F,IAAI,CAAC,CAAChH,KAAK,CAAC3S,MAAM,EAAEU,CAAC,EAAE,EAAE;QACtD,IAAIkW,OAAO,GAAG,IAAI,CAAChD,OAAO,CAAC+F,IAAI,CAAC,CAAChH,KAAK,CAACjS,CAAC,CAAC;QACrD,IAAI8V,IAAI,GAAG,IAAI,CAACtC,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC;QACpC,IAAGJ,IAAI,EACNA,IAAI,CAAC/G,IAAI,GAAGA,IAAI;MACT;IACJ;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIrG,UAAU,CAACtI,SAAS,CAACsgB,iBAAiB,GAAG,UAASzH,IAAI,EAAElR,IAAI,EAAE;IAC1D,IAAI,CAAC,IAAI,CAACmL,OAAO,EAAE;MACf;IACJ;IACA,IAAI+F,IAAI,IAAI,CAAC,CAAC,IAAIA,IAAI,IAAI,IAAI,CAAC/F,OAAO,CAAC5T,MAAM,EAAE;MAC3C;IACJ;IACA,IAAImhB,WAAW,GAAG,IAAI,CAACvN,OAAO,CAAC+F,IAAI,CAAC;IACpC,IAAI,CAACwH,WAAW,EAAE;MACd;IACJ;IACA;IACAA,WAAW,CAAC1Y,IAAI,GAAGA,IAAI;;IAEvB;IACA,IAAI,IAAI,CAACmL,OAAO,CAAC+F,IAAI,CAAC,CAAChH,KAAK,EAAE;MAC1B,KAAK,IAAIjS,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC+F,IAAI,CAAC,CAAChH,KAAK,CAAC3S,MAAM,EAAEU,CAAC,EAAE,EAAE;QACtD,IAAIkW,OAAO,GAAG,IAAI,CAAChD,OAAO,CAAC+F,IAAI,CAAC,CAAChH,KAAK,CAACjS,CAAC,CAAC;QACzC,IAAI,CAACwT,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC,CAACnO,IAAI,GAAGA,IAAI;MACzC;IACJ;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIW,UAAU,CAACtI,SAAS,CAACsL,YAAY,GAAG,UAASuN,IAAI,EAAE0H,YAAY,EAAE;IAC7D,IAAI,CAAC,IAAI,CAAC1N,MAAM,EAAE;MACd;IACJ,CAAC,CAAC;;IAEF,IAAIgG,IAAI,IAAI,IAAI,CAAChG,MAAM,CAAC3T,MAAM,IAAI,IAAI,CAAC2T,MAAM,CAACgG,IAAI,CAAC,CAACnD,IAAI,IAAI,IAAI,EAAE;MAC9D;IACJ;IAEA,IAAII,OAAO,GAAG,IAAI,CAACjD,MAAM,CAACgG,IAAI,CAAC,CAACnD,IAAI;IACpC,IAAIA,IAAI,GAAG,IAAI,CAACtC,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC;IACpC,IAAI,CAACJ,IAAI,EAAE;MACP;MACA,OAAO,IAAI;IACf;IAEA,IAAI,CAAC6K,YAAY,EAAE;MACf,OAAO7K,IAAI,CAAC/G,IAAI;IACpB;;IAEA;IACA,IAAI9C,IAAI,GAAG,IAAI,CAACuH,KAAK,CAAC4C,WAAW,CAACN,IAAI,CAACoJ,SAAS,CAAC;IACjD,IAAI,CAACjT,IAAI,EAAE;MACP,OAAO6J,IAAI,CAAC/G,IAAI;IACpB;IAEA,IAAI9C,IAAI,CAAC2U,gBAAgB,EAAE;MACvB3U,IAAI,CAAC2U,gBAAgB,CAAC9K,IAAI,CAACqJ,WAAW,CAAC;IAC3C,CAAC,MAAM,IAAIlT,IAAI,CAACR,SAAS,EAAE;MACvBQ,IAAI,CAACR,SAAS,EAAE;IACpB;IAEA,OAAOqK,IAAI,CAAC/G,IAAI;EACpB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIrG,UAAU,CAACtI,SAAS,CAACygB,gBAAgB,GAAG,UAAS5H,IAAI,EAAE;IACnD,IAAI,CAAC,IAAI,CAAChG,MAAM,EAAE;MACd,OAAO,IAAI;IACf,CAAC,CAAC;;IAEF,IAAIgG,IAAI,IAAI,IAAI,CAAChG,MAAM,CAAC3T,MAAM,IAAI,IAAI,CAAC2T,MAAM,CAACgG,IAAI,CAAC,CAACnD,IAAI,IAAI,IAAI,EAAE;MAC9D,OAAO,IAAI;IACf;IACA,IAAII,OAAO,GAAG,IAAI,CAACjD,MAAM,CAACgG,IAAI,CAAC,CAACnD,IAAI;IACpC,IAAIA,IAAI,GAAG,IAAI,CAACtC,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC;IACpC,IAAI,CAACJ,IAAI,EAAE;MACP;MACA,OAAO,IAAI;IACf;IACA,IAAI7J,IAAI,GAAG,IAAI,CAACuH,KAAK,CAAC4C,WAAW,CAACN,IAAI,CAACoJ,SAAS,CAAC;IACjD,IAAI,CAACjT,IAAI,EAAE;MACP,OAAO6J,IAAI,CAAC/N,IAAI;IACpB;IACA,IAAI0Y,WAAW,GAAGxU,IAAI,CAACiH,OAAO,CAAC4C,IAAI,CAACqJ,WAAW,CAAC;IAChD,IAAIsB,WAAW,EAAE;MACb,OAAOA,WAAW,CAAC1Y,IAAI;IAC3B;IACA,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIW,UAAU,CAACtI,SAAS,CAAC0gB,kBAAkB,GAAG,UACtCC,SAAS,EACTJ,YAAY,EACd;IACE,IAAI1H,IAAI,GAAG,IAAI,CAAC+H,aAAa,CAACD,SAAS,CAAC;IACxC,IAAI9H,IAAI,IAAI,CAAC,CAAC,EAAE;MACZ,OAAO,IAAI;IACf;IACA,OAAO,IAAI,CAACvN,YAAY,CAACuN,IAAI,EAAE0H,YAAY,CAAC;EAChD,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIjY,UAAU,CAACtI,SAAS,CAAC6gB,gBAAgB,GAAG,UAAShI,IAAI,EAAE;IACnD,IAAI,CAAC,IAAI,CAAChG,MAAM,EAAE;MACd,OAAO,KAAK;IAChB;IACA,OAAOgG,IAAI,GAAG,IAAI,CAAChG,MAAM,CAAC3T,MAAM,IAAI,IAAI,CAAC2T,MAAM,CAACgG,IAAI,CAAC,CAACnD,IAAI,IAAI,IAAI;EACtE,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIpN,UAAU,CAACtI,SAAS,CAAC8gB,YAAY,GAAG,UAASjI,IAAI,EAAE;IAC/C,IAAI,CAAC,IAAI,CAAChG,MAAM,EAAE;MACd,OAAO,IAAI;IACf;IACA,IAAIgG,IAAI,GAAG,IAAI,CAAChG,MAAM,CAAC3T,MAAM,EAAE;MAC3B,OAAO,IAAI,CAAC2T,MAAM,CAACgG,IAAI,CAAC;IAC5B;IACA,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIvQ,UAAU,CAACtI,SAAS,CAAC+gB,YAAY,GAAG,UAASlI,IAAI,EAAE;IAC/C,IAAI,CAAC,IAAI,CAAChG,MAAM,EAAE;MACd,OAAO,IAAI;IACf;IACA,IAAIgG,IAAI,GAAG,IAAI,CAAChG,MAAM,CAAC3T,MAAM,EAAE;MAC3B,IAAI8hB,SAAS,GAAG,IAAI,CAACnO,MAAM,CAACgG,IAAI,CAAC;MAC1C,OAAO,IAAI,CAACzF,KAAK,CAACvB,KAAK,CAAEmP,SAAS,CAACtL,IAAI,CAAE;IACpC;IACA,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIpN,UAAU,CAACtI,SAAS,CAAC8W,YAAY,GAAG,UAAS+B,IAAI,EAAE;IAC/C,IAAI,CAAC,IAAI,CAAChG,MAAM,EAAE;MACd,OAAO,IAAI;IACf;IACA,IAAIgG,IAAI,IAAI,IAAI,CAAChG,MAAM,CAAC3T,MAAM,EAAE;MAC5B,OAAO,IAAI;IACf;IACA,IAAI2X,KAAK,GAAG,IAAI,CAAChE,MAAM,CAACgG,IAAI,CAAC;IAC7B,IAAI,CAAChC,KAAK,IAAIA,KAAK,CAACnB,IAAI,KAAK,IAAI,EAAE;MAC/B,OAAO,IAAI;IACf;IACA,IAAI+G,SAAS,GAAG,IAAI,CAACrJ,KAAK,CAACvB,KAAK,CAACgF,KAAK,CAACnB,IAAI,CAAC;IAC5C,IAAI,CAAC+G,SAAS,EAAE;MACZ,OAAO,IAAI;IACf;IACA,OAAO,IAAI,CAACrJ,KAAK,CAAC4C,WAAW,CAACyG,SAAS,CAACqC,SAAS,CAAC;EACtD,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIxW,UAAU,CAACtI,SAAS,CAACihB,kBAAkB,GAAG,UAAS/f,IAAI,EAAE;IACrD,IAAI,CAAC,IAAI,CAAC2R,MAAM,IAAI,CAAC,IAAI,CAACA,MAAM,CAAC3T,MAAM,EAAE;MACrC,OAAO,IAAI,CAACwL,UAAU,GAAG,IAAI,CAACA,UAAU,CAACxJ,IAAI,CAAC,GAAG,IAAI;IACzD;IAEA,KAAK,IAAItB,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAAC1C,MAAM,CAAC3T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAChD,IAAIshB,UAAU,GAAG,IAAI,CAACrO,MAAM,CAACjT,CAAC,CAAC;MAC/B,IAAIsB,IAAI,IAAIggB,UAAU,CAAChgB,IAAI,IAAIggB,UAAU,CAACxL,IAAI,IAAI,IAAI,EAAE;QACpD,IAAIA,IAAI,GAAG,IAAI,CAACtC,KAAK,CAACvB,KAAK,CAACqP,UAAU,CAACxL,IAAI,CAAC;QAC5C,IAAIA,IAAI,EAAE;UACN,OAAOA,IAAI,CAAC/G,IAAI;QACpB;MACJ;IACJ;IACA,OAAO,IAAI,CAACjE,UAAU,CAACxJ,IAAI,CAAC;EAChC,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIoH,UAAU,CAACtI,SAAS,CAAC2b,aAAa,GAAG,UAAS9C,IAAI,EAAE;IAChD,IAAI,CAAC,IAAI,CAAC/F,OAAO,EAAE;MACf,OAAO,IAAI;IACf;IACA,IAAI+F,IAAI,IAAI,IAAI,CAAC/F,OAAO,CAAC5T,MAAM,EAAE;MAC7B,OAAO,IAAI;IACf;IAEA,IAAImd,IAAI,GAAG,IAAI,CAACvJ,OAAO,CAAC+F,IAAI,CAAC;IAC7B,OAAOwD,IAAI,CAAC2C,KAAK;EACrB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI1W,UAAU,CAACtI,SAAS,CAACmhB,aAAa,GAAG,UAAStI,IAAI,EAAE;IAChD,IAAI,CAAC,IAAI,CAAC/F,OAAO,EAAE;MACf,OAAO,IAAI;IACf;IACA,IAAI+F,IAAI,GAAG,IAAI,CAAC/F,OAAO,CAAC5T,MAAM,EAAE;MAC5B,OAAO,IAAI,CAAC4T,OAAO,CAAC+F,IAAI,CAAC;IAC7B;IACA,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIvQ,UAAU,CAACtI,SAAS,CAACohB,iBAAiB,GAAG,UAASvI,IAAI,EAAE;IACpD,IAAI,CAAC,IAAI,CAAC/F,OAAO,EAAE;MACf,OAAO,KAAK;IAChB;IACA,OACI+F,IAAI,GAAG,IAAI,CAAC/F,OAAO,CAAC5T,MAAM,IAC1B,IAAI,CAAC4T,OAAO,CAAC+F,IAAI,CAAC,CAAChH,KAAK,IACxB,IAAI,CAACiB,OAAO,CAAC+F,IAAI,CAAC,CAAChH,KAAK,CAAC3S,MAAM;EAEvC,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIoJ,UAAU,CAACtI,SAAS,CAACqhB,oBAAoB,GAAG,YAAW;IACnD,IAAI,CAAC,IAAI,CAACvO,OAAO,EAAE;MACf,OAAO,KAAK;IAChB;IACA,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC5T,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC1C,IAAI,IAAI,CAACkT,OAAO,CAAClT,CAAC,CAAC,CAACiS,KAAK,IAAI,IAAI,CAACiB,OAAO,CAAClT,CAAC,CAAC,CAACiS,KAAK,CAAC3S,MAAM,EAAE;QACvD,OAAO,IAAI;MACf;IACJ;IACA,OAAO,KAAK;EAChB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIoJ,UAAU,CAACtI,SAAS,CAACshB,cAAc,GAAG,UAASzI,IAAI,EAAE;IACjD,IAAI,CAAC,IAAI,CAAC/F,OAAO,IAAI,IAAI,CAACA,OAAO,CAAC5T,MAAM,IAAI,CAAC,EAAE;MAC3C,OAAO,IAAI;IACf;IAEA,IAAI2Z,IAAI,IAAI,IAAI,CAAC/F,OAAO,CAAC5T,MAAM,EAAE;MAC7B,OAAO,IAAI;IACf;IAEA,IAAI2W,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAC+F,IAAI,CAAC;IAC/B,IAAI,CAAChD,MAAM,CAAChE,KAAK,IAAIgE,MAAM,CAAChE,KAAK,CAAC3S,MAAM,IAAI,CAAC,EAAE;MAC3C,OAAO,IAAI;IACf;IAEA,IAAIqM,CAAC,GAAG,EAAE;IACV,KAAK,IAAI3L,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiW,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAAEU,CAAC,EAAE,EAAE;MAC1C,IAAIkW,OAAO,GAAGD,MAAM,CAAChE,KAAK,CAACjS,CAAC,CAAC;MAC7B,IAAI8V,IAAI,GAAG,IAAI,CAACtC,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC;MACpC,IAAIJ,IAAI,EAAE;QACN,IAAIK,WAAW,GAAG,IAAI,CAAC3C,KAAK,CAAC4C,WAAW,CAACN,IAAI,CAACO,SAAS,CAAC;QACxD,IAAIF,WAAW,EAAE;UACbxK,CAAC,CAAC1L,IAAI,CAACkW,WAAW,CAAC;QACvB;MACJ;IACJ;IACA,OAAOxK,CAAC;EACZ,CAAC;EAEDjD,UAAU,CAACtI,SAAS,CAACuhB,iBAAiB,GAAG,YAAU;IAC/C,IAAIC,KAAK,GAAG,IAAI,CAACZ,aAAa,CAAC,WAAW,CAAC;IAC3C,IAAIY,KAAK,IAAI,CAAC,CAAC,EAAC;MAAE;MACd,IAAI3K,KAAK,GAAG,IAAI,CAACgE,QAAQ,CAAC,WAAW,EAAEpZ,SAAS,CAACyC,KAAK,EAAE;QAACud,QAAQ,EAAE,IAAI;QAAEC,UAAU,EAAE;MAAI,CAAC,CAAC;MAC3F,OAAO,IAAI,CAACd,aAAa,CAAC,WAAW,CAAC;IAC1C;IACA,OAAOY,KAAK;EAChB,CAAC;EAEDlZ,UAAU,CAACtI,SAAS,CAAC2hB,mBAAmB,GAAG,YAAU;IACjD,IAAIH,KAAK,GAAG,IAAI,CAACI,cAAc,CAAC,YAAY,CAAC;IAC7C,IAAIJ,KAAK,IAAI,CAAC,CAAC,EAAC;MAAE;MACd,IAAI3L,MAAM,GAAG,IAAI,CAAC4F,SAAS,CAAC,YAAY,EAAEha,SAAS,CAAC0C,MAAM,EAAE;QAACsd,QAAQ,EAAE,IAAI;QAAEC,UAAU,EAAE;MAAI,CAAC,CAAC;MAC/F,OAAO,IAAI,CAACE,cAAc,CAAC,YAAY,CAAC;IAC5C;IACA,OAAOJ,KAAK;EAChB,CAAC;EAEDlZ,UAAU,CAACtI,SAAS,CAAC6hB,kBAAkB,GAAG,UAAStH,KAAK,EAAE3O,OAAO,EAAC;IAC9D,IAAI4V,KAAK,GAAG,IAAI,CAACI,cAAc,CAAC,YAAY,CAAC;IAC7C,IAAIJ,KAAK,IAAI,CAAC,CAAC,EAAC;MAEZ;MACA;MACA;MACA,IAAI,CAACM,WAAW,CAACN,KAAK,EAAEjH,KAAK,EAAE,IAAI,EAAE3O,OAAO,CAAC;IAEjD;EACJ,CAAC;EAEDtD,UAAU,CAACtI,SAAS,CAAC+hB,UAAU,GAAG,UAASC,MAAM,EAAC;IAC9C,QAAOA,MAAM;MACT,KAAKvgB,SAAS,CAAC8C,QAAQ;QACnB;QACA;MAEJ,KAAK9C,SAAS,CAACgD,UAAU;QACrB,IAAI,CAAC8c,iBAAiB,EAAE;QACxB,IAAI,CAACI,mBAAmB,EAAE;QAC1B;MAEJ,KAAKlgB,SAAS,CAAC+C,KAAK;QAChB;MAEJ,KAAK/C,SAAS,CAAC6C,MAAM;QACjB;MAEJ,KAAK7C,SAAS,CAACwgB,UAAU;QACrB;MAEJ;QACI,OAAO,KAAK;QACZ;IAAM;IAEd,IAAI,CAAC7V,IAAI,GAAG4V,MAAM;IAClB,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI1Z,UAAU,CAACtI,SAAS,CAACwU,SAAS,GAAG,UAAS+F,KAAK,EAAE3O,OAAO,EAAE;IACtDA,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;IACvB,IAAI,IAAI,CAACP,SAAS,EAAC;MAEf;MACT,IAAI,CAACO,OAAO,CAACsW,WAAW,EAAEtW,OAAO,CAACsW,WAAW,GAAG,IAAI,CAAC1M,EAAE,GAAC,QAAQ,GAAC2M,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAC,IAAI,CAAC;MAEtF,IAAI,CAACjP,KAAK,CAACV,eAAe,CAAC,IAAI,CAAC8C,EAAE,CAAC,GAAG,IAAI,CAAC,CAAC;;MAE5C,IAAI,CAACnK,SAAS,CAACkP,KAAK,EAAE3O,OAAO,CAAC;MAE9B,IAAI,CAACwH,KAAK,CAACV,eAAe,CAAC,IAAI,CAAC8C,EAAE,CAAC,GAAG,KAAK,CAAC,CAAC;;MAE7C;MACA,IAAI,CAAC8M,YAAY,GAAG,IAAI,CAAClP,KAAK,CAACtB,SAAS;MACxC,IAAGlG,OAAO,IAAIA,OAAO,CAACsW,WAAW,EAAC;QAC9B,IAAI,CAACA,WAAW,GAAGtW,OAAO,CAACsW,WAAW,CAAC,CAAC;QACxC,IAAI,CAAC9O,KAAK,CAACR,oBAAoB,CAAC,IAAI,CAAC4C,EAAE,CAAC,GAAG5J,OAAO,CAACsW,WAAW;MAClE;IACJ;IACA,IAAI,CAACK,iBAAiB,GAAG,CAAC,CAAC,CAAC;IAC5B,IAAG,IAAI,CAACV,kBAAkB,EAAE,IAAI,CAACA,kBAAkB,CAACtH,KAAK,EAAE3O,OAAO,CAAC,CAAC,CAAC;EACzE,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACItD,UAAU,CAACtI,SAAS,CAAC0a,QAAQ,GAAG,UAAS1C,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,EAAE;IAC7DA,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;IACvB,IAAI,IAAI,CAAC0O,QAAQ,EAAC;MAEvB;MACS,IAAI,CAAC1O,OAAO,CAACsW,WAAW,EAAEtW,OAAO,CAACsW,WAAW,GAAG,IAAI,CAAC1M,EAAE,GAAC,GAAG,IAAEwC,MAAM,GAACA,MAAM,GAAC,QAAQ,CAAC,GAAC,GAAG,GAACmK,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAC,IAAI,CAAC;MAEvH,IAAI,CAACjP,KAAK,CAACT,eAAe,CAAC,IAAI,CAAC6C,EAAE,CAAC,GAAIwC,MAAM,GAACA,MAAM,GAAC,WAAY,CAAC,CAAC;;MAEnE,IAAI,CAACsC,QAAQ,CAACtC,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,CAAC;MAErC,IAAI,CAACwH,KAAK,CAACT,eAAe,CAAC,IAAI,CAAC6C,EAAE,CAAC,GAAG,KAAK,CAAC,CAAC;;MAE7C;MACA,IAAG5J,OAAO,IAAIA,OAAO,CAACsW,WAAW,EAAC;QAC9B,IAAI,CAACA,WAAW,GAAGtW,OAAO,CAACsW,WAAW,CAAC,CAAC;QACxC,IAAI,CAAC9O,KAAK,CAACR,oBAAoB,CAAC,IAAI,CAAC4C,EAAE,CAAC,GAAG5J,OAAO,CAACsW,WAAW;MAClE;IACJ;IACA,IAAI,CAACM,gBAAgB,GAAG,CAAC,CAAC,CAAC;IAC3B,IAAG,IAAI,CAACX,kBAAkB,EAAE,IAAI,CAACA,kBAAkB,CAACtH,KAAK,EAAE3O,OAAO,CAAC;EACvE,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACItD,UAAU,CAACtI,SAAS,CAAC2a,OAAO,GAAG,UAAS3C,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,EAAE;IAC5D,IAAI,CAAC,IAAI,CAACkH,OAAO,IAAI,CAAC,IAAI,CAACA,OAAO,CAAC5T,MAAM,EAAE;MACvC;IACJ;IAEA,IAAI,IAAI,CAACkU,KAAK,EACV,IAAI,CAACA,KAAK,CAACqP,kBAAkB,GAAGhhB,SAAS,CAAC0O,OAAO,EAAE;IAEvD,KAAK,IAAIvQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC5T,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC1C,IAAIiW,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAClT,CAAC,CAAC;MAC5B,IAAK,CAACiW,MAAM,IAAIA,MAAM,CAAClO,IAAI,KAAKlG,SAAS,CAACyC,KAAK,IAAK8T,MAAM,IAAInC,MAAM,CAAC3U,IAAI,IAAI8W,MAAO,EAChF;MACJ,IAAI,CAAC8J,WAAW,CAACliB,CAAC,EAAE2a,KAAK,EAAE,IAAI,EAAE3O,OAAO,CAAC;IAC7C;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACItD,UAAU,CAACtI,SAAS,CAAC8hB,WAAW,GAAG,UAASjJ,IAAI,EAAE0B,KAAK,EAAEzE,OAAO,EAAElK,OAAO,EAAE;IACvEA,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;IACvB,IAAI,CAAC,IAAI,CAACkH,OAAO,EAAE;MACf;IACJ;IAEA,IAAI+C,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAC+F,IAAI,CAAC;IAC/B,IAAI,CAAChD,MAAM,EAAE;MACT;IACJ;IAEA,IAAIhE,KAAK,GAAGgE,MAAM,CAAChE,KAAK;IACxB,IAAI,CAACA,KAAK,IAAI,CAACA,KAAK,CAAC3S,MAAM,EAAE;MACzB;IACJ;IAEA,IAAI,IAAI,CAACkU,KAAK,EAAE;MACZ,IAAI,CAACA,KAAK,CAACqP,kBAAkB,GAAGhhB,SAAS,CAAC0O,OAAO,EAAE;IACvD;;IAEA;IACA,KAAK,IAAIkP,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGxN,KAAK,CAAC3S,MAAM,EAAE,EAAEmgB,CAAC,EAAE;MACnC,IAAI7J,EAAE,GAAG3D,KAAK,CAACwN,CAAC,CAAC;MACjB,IAAIvJ,OAAO,IAAI,IAAI,IAAIA,OAAO,IAAIN,EAAE,EAAE;QAClC;QACA;MACJ;MACA,IAAIiH,SAAS,GAAG,IAAI,CAACrJ,KAAK,CAACvB,KAAK,CAACA,KAAK,CAACwN,CAAC,CAAC,CAAC;MAC1C,IAAI,CAAC5C,SAAS,EAAE;QACZ;QACA;MACJ;MACAA,SAAS,CAACK,UAAU,GAAGrb,SAAS,CAAC0O,OAAO,EAAE;MAC1C,IAAItE,IAAI,GAAG,IAAI,CAACuH,KAAK,CAAC4C,WAAW,CAACyG,SAAS,CAACxG,SAAS,CAAC;MACtD,IAAI,CAACpK,IAAI,EAAE;QACP;QACA;MACJ;;MAEA;MACA,IAAI6W,iBAAiB,GAAG7W,IAAI,CAACgH,MAAM,CAAC4J,SAAS,CAACU,WAAW,CAAC;MAEnE,IAAItR,IAAI,CAACO,IAAI,KAAK3K,SAAS,CAACgD,UAAU,EACtC;QACC;QACA,IAAI,CAACmH,OAAO,CAACsW,WAAW,EAAEtW,OAAO,CAACsW,WAAW,GAAG,IAAI,CAAC1M,EAAE,GAAC,SAAS,GAAC2M,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAC,IAAI,CAAC;QACpF,IAAIxW,IAAI,CAACR,SAAS,EAAE;UAChB;UACAQ,IAAI,CAAC2I,SAAS,CAAC+F,KAAK,EAAE3O,OAAO,CAAC;QAClC;MACb,CAAC,MACI,IAAIC,IAAI,CAACyO,QAAQ,EAAE;QACX;QACZ,IAAI,CAAC1O,OAAO,CAACsW,WAAW,EAAEtW,OAAO,CAACsW,WAAW,GAAG,IAAI,CAAC1M,EAAE,GAAC,OAAO,GAAC2M,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAC,IAAI,CAAC;QAClF;QACA,IAAIK,iBAAiB,GAAG7W,IAAI,CAACgH,MAAM,CAAC4J,SAAS,CAACU,WAAW,CAAC;QACtE;QACYtR,IAAI,CAAC6O,QAAQ,CAACgI,iBAAiB,CAACxhB,IAAI,EAAEqZ,KAAK,EAAE3O,OAAO,CAAC;MACzD;IACJ;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACItD,UAAU,CAACtI,SAAS,CAAC2iB,kBAAkB,GAAG,UAAS9J,IAAI,EAAE/C,OAAO,EAAE;IAC9D,IAAI,CAAC,IAAI,CAAChD,OAAO,EAAE;MACf;IACJ;IAEA,IAAI+C,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAC+F,IAAI,CAAC;IAC/B,IAAI,CAAChD,MAAM,EAAE;MACT;IACJ;IAEA,IAAIhE,KAAK,GAAGgE,MAAM,CAAChE,KAAK;IACxB,IAAI,CAACA,KAAK,IAAI,CAACA,KAAK,CAAC3S,MAAM,EAAE;MACzB;IACJ;;IAEA;IACA,KAAK,IAAImgB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGxN,KAAK,CAAC3S,MAAM,EAAE,EAAEmgB,CAAC,EAAE;MACnC,IAAI7J,EAAE,GAAG3D,KAAK,CAACwN,CAAC,CAAC;MACjB,IAAIvJ,OAAO,IAAI,IAAI,IAAIA,OAAO,IAAIN,EAAE,EAAE;QAClC;QACA;MACJ;MACA,IAAIiH,SAAS,GAAG,IAAI,CAACrJ,KAAK,CAACvB,KAAK,CAACA,KAAK,CAACwN,CAAC,CAAC,CAAC;MAC1C,IAAI,CAAC5C,SAAS,EAAE;QACZ;QACA;MACJ;MACAA,SAAS,CAACK,UAAU,GAAG,CAAC;IAC5B;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIxU,UAAU,CAACtI,SAAS,CAAC4iB,OAAO,GAAG,UAAS1W,IAAI,EAC/C;IACC,IAAI,CAACA,IAAI,GAAGA,IAAI;IAChB,IAAG,IAAI,CAAC2W,QAAQ,EACf,IAAI,CAACA,QAAQ,CAAC,IAAI,CAAC3W,IAAI,CAAC;EAC1B,CAAC;;EAEE;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACI5D,UAAU,CAACtI,SAAS,CAAC8iB,WAAW,GAAG,UAC/B5hB,IAAI,EACJ6hB,aAAa,EACbpb,IAAI,EACJqb,UAAU,EACZ;IACE,IAAItS,CAAC,GAAG;MAAExP,IAAI,EAAEA,IAAI;MAAEyG,IAAI,EAAEA,IAAI;MAAEob,aAAa,EAAEA;IAAc,CAAC;IAChE,IAAIC,UAAU,EAAE;MACZ,KAAK,IAAIpjB,CAAC,IAAIojB,UAAU,EAAE;QACtBtS,CAAC,CAAC9Q,CAAC,CAAC,GAAGojB,UAAU,CAACpjB,CAAC,CAAC;MACxB;IACJ;IACA,IAAI,CAAC,IAAI,CAACoM,eAAe,EAAE;MACvB,IAAI,CAACA,eAAe,GAAG,EAAE;IAC7B;IACA,IAAI,CAACA,eAAe,CAACnM,IAAI,CAAC6Q,CAAC,CAAC;IAC5B,IAAI,CAAC,IAAI,CAAChG,UAAU,EAAE;MAClB,IAAI,CAACA,UAAU,GAAG,CAAC,CAAC;IACxB;IACA,IAAI,CAACA,UAAU,CAACxJ,IAAI,CAAC,GAAG6hB,aAAa;IACrC,OAAOrS,CAAC;EACZ,CAAC;;EAED;;EAEA;AACJ;AACA;AACA;AACA;AACA;AACA;EACIpI,UAAU,CAACtI,SAAS,CAACyb,SAAS,GAAG,UAASva,IAAI,EAAEyG,IAAI,EAAEqb,UAAU,EAAE;IAC9D,IAAInN,MAAM,GAAG;MAAE3U,IAAI,EAAEA,IAAI;MAAEyG,IAAI,EAAEA,IAAI;MAAEkK,KAAK,EAAE;IAAK,CAAC;IACpD,IAAImR,UAAU,EAAE;MACZ,KAAK,IAAIpjB,CAAC,IAAIojB,UAAU,EAAE;QACtBnN,MAAM,CAACjW,CAAC,CAAC,GAAGojB,UAAU,CAACpjB,CAAC,CAAC;MAC7B;IACJ;IAEA,IAAI,CAAC,IAAI,CAACkT,OAAO,EAAE;MACf,IAAI,CAACA,OAAO,GAAG,EAAE;IACrB;IACA,IAAI,CAACA,OAAO,CAACjT,IAAI,CAACgW,MAAM,CAAC;IACzB,IAAI,IAAI,CAAC6F,aAAa,EAAE;MACpB,IAAI,CAACA,aAAa,CAAC7F,MAAM,CAAC;IAC9B;IAEA,IAAIpU,SAAS,CAACoF,oBAAoB,EAAEpF,SAAS,CAACmI,uBAAuB,CAAC,IAAI,EAACjC,IAAI,EAAC,IAAI,CAAC;IAErF,IAAI,CAACib,OAAO,CAAE,IAAI,CAACzW,WAAW,EAAE,CAAE;IAClC,IAAI,CAACuL,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;IAC/B,OAAO7B,MAAM;EACjB,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIvN,UAAU,CAACtI,SAAS,CAACijB,UAAU,GAAG,UAASljB,KAAK,EAAE;IAC9C,KAAK,IAAIH,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGG,KAAK,CAACb,MAAM,EAAE,EAAEU,CAAC,EAAE;MACnC,IAAIyc,IAAI,GAAGtc,KAAK,CAACH,CAAC,CAAC;MACnB,IAAI8Q,CAAC,GAAG;QAAExP,IAAI,EAAEmb,IAAI,CAAC,CAAC,CAAC;QAAE1U,IAAI,EAAE0U,IAAI,CAAC,CAAC,CAAC;QAAE3G,IAAI,EAAE;MAAK,CAAC;MACpD,IAAI3V,KAAK,CAAC,CAAC,CAAC,EAAE;QACV,KAAK,IAAIwO,CAAC,IAAI8N,IAAI,CAAC,CAAC,CAAC,EAAE;UACnB3L,CAAC,CAACnC,CAAC,CAAC,GAAG8N,IAAI,CAAC,CAAC,CAAC,CAAC9N,CAAC,CAAC;QACrB;MACJ;MAEA,IAAI,CAAC,IAAI,CAACuE,OAAO,EAAE;QACf,IAAI,CAACA,OAAO,GAAG,EAAE;MACrB;MACA,IAAI,CAACA,OAAO,CAACjT,IAAI,CAAC6Q,CAAC,CAAC;MACpB,IAAI,IAAI,CAACgL,aAAa,EAAE;QACpB,IAAI,CAACA,aAAa,CAAChL,CAAC,CAAC;MACzB;MAEA,IAAIjP,SAAS,CAACoF,oBAAoB,EAAEpF,SAAS,CAACmI,uBAAuB,CAAC,IAAI,EAACyS,IAAI,CAAC,CAAC,CAAC,EAAC,IAAI,CAAC;IAE5F;IAEA,IAAI,CAACuG,OAAO,CAAE,IAAI,CAACzW,WAAW,EAAE,CAAE;IAClC,IAAI,CAACuL,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;EACnC,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIpP,UAAU,CAACtI,SAAS,CAACgc,YAAY,GAAG,UAASnD,IAAI,EAAE;IAC/C,IAAI,CAACE,gBAAgB,CAACF,IAAI,CAAC;IAC3B,IAAI,CAAC/F,OAAO,CAACQ,MAAM,CAACuF,IAAI,EAAE,CAAC,CAAC;IAC5B,KAAK,IAAIjZ,CAAC,GAAGiZ,IAAI,EAAEjZ,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC5T,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC7C,IAAI,CAAC,IAAI,CAACkT,OAAO,CAAClT,CAAC,CAAC,IAAI,CAAC,IAAI,CAACkT,OAAO,CAAClT,CAAC,CAAC,CAACiS,KAAK,EAAE;QAC5C;MACJ;MACA,IAAIA,KAAK,GAAG,IAAI,CAACiB,OAAO,CAAClT,CAAC,CAAC,CAACiS,KAAK;MACjC,KAAK,IAAItD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGsD,KAAK,CAAC3S,MAAM,EAAE,EAAEqP,CAAC,EAAE;QACnC,IAAImH,IAAI,GAAG,IAAI,CAACtC,KAAK,CAACvB,KAAK,CAACA,KAAK,CAACtD,CAAC,CAAC,CAAC;QACrC,IAAI,CAACmH,IAAI,EAAE;UACP;QACJ;QACAA,IAAI,CAACqJ,WAAW,IAAI,CAAC;MACzB;IACJ;IAEA,IAAI,CAAC6D,OAAO,CAAE,IAAI,CAACzW,WAAW,EAAE,CAAE;IAClC,IAAI,IAAI,CAAC8P,eAAe,EAAE;MACtB,IAAI,CAACA,eAAe,CAACpD,IAAI,CAAC;IAC9B;IACA,IAAI,CAACnB,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;EACnC,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIpP,UAAU,CAACtI,SAAS,CAAC6a,QAAQ,GAAG,UAAS3Z,IAAI,EAAEyG,IAAI,EAAEqb,UAAU,EAAE;IAC7Drb,IAAI,GAAGA,IAAI,IAAI,CAAC;IAChB,IAAIkP,KAAK,GAAG;MAAE3V,IAAI,EAAEA,IAAI;MAAEyG,IAAI,EAAEA,IAAI;MAAE+N,IAAI,EAAE;IAAK,CAAC;IAClD,IAAIsN,UAAU,EAAE;MACZ,KAAK,IAAIpjB,CAAC,IAAIojB,UAAU,EAAE;QACtBnM,KAAK,CAACjX,CAAC,CAAC,GAAGojB,UAAU,CAACpjB,CAAC,CAAC;MAC5B;IACJ;IAEA,IAAI,CAAC,IAAI,CAACiT,MAAM,EAAE;MACd,IAAI,CAACA,MAAM,GAAG,EAAE;IACpB;IAEA,IAAI,CAACA,MAAM,CAAChT,IAAI,CAACgX,KAAK,CAAC;IACvB,IAAI,CAAC+L,OAAO,CAAE,IAAI,CAACzW,WAAW,EAAE,CAAE;IAElC,IAAI,IAAI,CAAC4O,YAAY,EAAE;MACnB,IAAI,CAACA,YAAY,CAAClE,KAAK,CAAC;IAClC;IAEMpV,SAAS,CAACmI,uBAAuB,CAAC,IAAI,EAACjC,IAAI,CAAC;IAE5C,IAAI,CAAC+P,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;IAC/B,OAAOb,KAAK;EAChB,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIvO,UAAU,CAACtI,SAAS,CAACkjB,SAAS,GAAG,UAASnjB,KAAK,EAAE;IAC7C,KAAK,IAAIH,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGG,KAAK,CAACb,MAAM,EAAE,EAAEU,CAAC,EAAE;MACnC,IAAIyc,IAAI,GAAGtc,KAAK,CAACH,CAAC,CAAC;MACnB,IAAI8Q,CAAC,GAAG;QAAExP,IAAI,EAAEmb,IAAI,CAAC,CAAC,CAAC;QAAE1U,IAAI,EAAE0U,IAAI,CAAC,CAAC,CAAC;QAAE3G,IAAI,EAAE;MAAK,CAAC;MACpD,IAAI3V,KAAK,CAAC,CAAC,CAAC,EAAE;QACV,KAAK,IAAIwO,CAAC,IAAI8N,IAAI,CAAC,CAAC,CAAC,EAAE;UACnB3L,CAAC,CAACnC,CAAC,CAAC,GAAG8N,IAAI,CAAC,CAAC,CAAC,CAAC9N,CAAC,CAAC;QACrB;MACJ;MAEA,IAAI,CAAC,IAAI,CAACsE,MAAM,EAAE;QACd,IAAI,CAACA,MAAM,GAAG,EAAE;MACpB;MACA,IAAI,CAACA,MAAM,CAAChT,IAAI,CAAC6Q,CAAC,CAAC;MACnB,IAAI,IAAI,CAACqK,YAAY,EAAE;QACnB,IAAI,CAACA,YAAY,CAACrK,CAAC,CAAC;MACxB;MAEAjP,SAAS,CAACmI,uBAAuB,CAAC,IAAI,EAACyS,IAAI,CAAC,CAAC,CAAC,CAAC;IACnD;IAEA,IAAI,CAACuG,OAAO,CAAE,IAAI,CAACzW,WAAW,EAAE,CAAE;IAClC,IAAI,CAACuL,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;EACnC,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIpP,UAAU,CAACtI,SAAS,CAACub,WAAW,GAAG,UAAS1C,IAAI,EAAE;IAC9C,IAAI,CAACC,eAAe,CAACD,IAAI,CAAC;IAC1B,IAAImI,SAAS,GAAG,IAAI,CAACnO,MAAM,CAACS,MAAM,CAACuF,IAAI,EAAE,CAAC,CAAC;IAC3C,KAAK,IAAIjZ,CAAC,GAAGiZ,IAAI,EAAEjZ,CAAC,GAAG,IAAI,CAACiT,MAAM,CAAC3T,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC5C,IAAI,CAAC,IAAI,CAACiT,MAAM,CAACjT,CAAC,CAAC,EAAE;QACjB;MACJ;MACA,IAAI8V,IAAI,GAAG,IAAI,CAACtC,KAAK,CAACvB,KAAK,CAAC,IAAI,CAACgB,MAAM,CAACjT,CAAC,CAAC,CAAC8V,IAAI,CAAC;MAChD,IAAI,CAACA,IAAI,EAAE;QACP;MACJ;MACAA,IAAI,CAACyH,WAAW,IAAI,CAAC;IACzB;IACA,IAAI,CAACyF,OAAO,CAAE,IAAI,CAACzW,WAAW,EAAE,CAAE;IAClC,IAAI,IAAI,CAACqP,cAAc,EAAE;MACrB,IAAI,CAACA,cAAc,CAAC3C,IAAI,EAAEmI,SAAS,CAAC,CAAC,CAAC,CAAE;IAC5C;IACA,IAAI,CAACtJ,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;EACnC,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACIpP,UAAU,CAACtI,SAAS,CAACmjB,aAAa,GAAG,UAASjiB,IAAI,EAAEyG,IAAI,EAAEO,GAAG,EAAEkb,SAAS,EAAE;IACtE,IAAI1S,CAAC,GAAG;MACJxP,IAAI,EAAEA,IAAI;MACVyG,IAAI,EAAEA,IAAI;MACVO,GAAG,EAAEA,GAAG;MACRkb,SAAS,EAAEA,SAAS;MACpBvR,KAAK,EAAE;IACX,CAAC;IACD,IAAI,CAACuN,WAAW,CAACvf,IAAI,CAAC6Q,CAAC,CAAC;IACxB,OAAOA,CAAC;EACZ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIpI,UAAU,CAACtI,SAAS,CAACmM,WAAW,GAAG,UAASrC,GAAG,EAAE;IAC7C,IAAI,IAAI,CAACT,WAAW,CAAC6C,IAAI,EAAE;MACvB,OAAO,IAAI,CAAC7C,WAAW,CAAC6C,IAAI,CAAC/M,MAAM,EAAE;IACzC;IAEA,IAAIkkB,IAAI,GAAGlB,IAAI,CAACmB,GAAG,CACf,IAAI,CAACzQ,MAAM,GAAG,IAAI,CAACA,MAAM,CAAC3T,MAAM,GAAG,CAAC,EACpC,IAAI,CAAC4T,OAAO,GAAG,IAAI,CAACA,OAAO,CAAC5T,MAAM,GAAG,CAAC,CACzC;IACD,IAAIgN,IAAI,GAAGpC,GAAG,IAAI,IAAIoV,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAC1CmE,IAAI,GAAGlB,IAAI,CAACmB,GAAG,CAACD,IAAI,EAAE,CAAC,CAAC;IACxB,IAAIE,SAAS,GAAG9hB,SAAS,CAACa,cAAc,CAAC,CAAC;;IAE1C,IAAIkhB,WAAW,GAAGC,iBAAiB,CAAC,IAAI,CAACvjB,KAAK,CAAC;IAC/C,IAAIwjB,WAAW,GAAG,CAAC;IACnB,IAAIC,YAAY,GAAG,CAAC;IAEpB,IAAI,IAAI,CAAC9Q,MAAM,EAAE;MACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAAC1C,MAAM,CAAC3T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;QAChD,IAAIiX,KAAK,GAAG,IAAI,CAAChE,MAAM,CAACjT,CAAC,CAAC;QAC1B,IAAI0P,IAAI,GAAGuH,KAAK,CAAC+M,KAAK,IAAI/M,KAAK,CAAC3V,IAAI,IAAI,EAAE;QAC1C,IAAI2iB,UAAU,GAAGJ,iBAAiB,CAACnU,IAAI,CAAC;QACxC,IAAIoU,WAAW,GAAGG,UAAU,EAAE;UAC1BH,WAAW,GAAGG,UAAU;QAC5B;MACJ;IACJ;IAEA,IAAI,IAAI,CAAC/Q,OAAO,EAAE;MACd,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAACzC,OAAO,CAAC5T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;QACjD,IAAIiW,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAClT,CAAC,CAAC;QAC5B,IAAI0P,IAAI,GAAGuG,MAAM,CAAC+N,KAAK,IAAI/N,MAAM,CAAC3U,IAAI,IAAI,EAAE;QAC5C,IAAI2iB,UAAU,GAAGJ,iBAAiB,CAACnU,IAAI,CAAC;QACxC,IAAIqU,YAAY,GAAGE,UAAU,EAAE;UAC3BF,YAAY,GAAGE,UAAU;QAC7B;MACJ;IACJ;IAEA3X,IAAI,CAAC,CAAC,CAAC,GAAGiW,IAAI,CAACmB,GAAG,CAACI,WAAW,GAAGC,YAAY,GAAG,EAAE,EAAEH,WAAW,CAAC;IAChEtX,IAAI,CAAC,CAAC,CAAC,GAAGiW,IAAI,CAACmB,GAAG,CAACpX,IAAI,CAAC,CAAC,CAAC,EAAEzK,SAAS,CAACO,UAAU,CAAC;IACjD,IAAI,IAAI,CAACwd,OAAO,IAAI,IAAI,CAACA,OAAO,CAACtgB,MAAM,EAAE;MACrCgN,IAAI,CAAC,CAAC,CAAC,GAAGiW,IAAI,CAACmB,GAAG,CAACpX,IAAI,CAAC,CAAC,CAAC,EAAEzK,SAAS,CAACO,UAAU,GAAG,GAAG,CAAC;IAC3D;IAEAkK,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC7C,WAAW,CAACya,YAAY,IAAI,CAAC,IAAIT,IAAI,GAAG5hB,SAAS,CAACK,gBAAgB;IAElF,IAAIiiB,cAAc,GAAG,CAAC;IACtB,IAAI,IAAI,CAACvE,OAAO,IAAI,IAAI,CAACA,OAAO,CAACtgB,MAAM,EAAE;MACrC,KAAK,IAAIU,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAACiK,OAAO,CAACtgB,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;QACjD,IAAI,IAAI,CAAC4f,OAAO,CAAC5f,CAAC,CAAC,CAACuM,WAAW,EAC3B4X,cAAc,IAAI,IAAI,CAACvE,OAAO,CAAC5f,CAAC,CAAC,CAACuM,WAAW,CAACD,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,KAE9D6X,cAAc,IAAItiB,SAAS,CAACM,kBAAkB,GAAG,CAAC;MAC1D;MACAgiB,cAAc,IAAI,CAAC;IACvB;;IAEA;IACA,IAAI,IAAI,CAACC,UAAU,EACf9X,IAAI,CAAC,CAAC,CAAC,GAAGiW,IAAI,CAACmB,GAAG,CAAEpX,IAAI,CAAC,CAAC,CAAC,EAAE6X,cAAc,CAAE,CAAC,KAC7C,IAAI,IAAI,CAACE,eAAe,IAAI,IAAI,EACjC/X,IAAI,CAAC,CAAC,CAAC,GAAGiW,IAAI,CAACmB,GAAG,CAAEpX,IAAI,CAAC,CAAC,CAAC,EAAE6X,cAAc,GAAG,IAAI,CAACE,eAAe,CAAE,CAAC,KAErE/X,IAAI,CAAC,CAAC,CAAC,IAAI6X,cAAc;IAE7B,SAASN,iBAAiB,CAACnU,IAAI,EAAE;MAC7B,IAAI,CAACA,IAAI,EAAE;QACP,OAAO,CAAC;MACZ;MACA,OAAOiU,SAAS,GAAGjU,IAAI,CAACpQ,MAAM,GAAG,GAAG;IACxC;IAEA,IACI,IAAI,CAACmK,WAAW,CAAC6a,UAAU,IAC3BhY,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC7C,WAAW,CAAC6a,UAAU,EACvC;MACEhY,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC7C,WAAW,CAAC6a,UAAU;IACzC;IAEAhY,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;;IAEd,OAAOA,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACI5D,UAAU,CAACtI,SAAS,CAACmkB,eAAe,GAAG,UAAUzE,QAAQ,EAC5D;IACO,IAAIrD,IAAI,GAAG,IAAI;;IAErB;IACA;IACA,IAAI,IAAI,CAACrQ,eAAe,EAAE;MAChB,KAAK,IAAIpM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACoM,eAAe,CAAC9M,MAAM,EAAE,EAAEU,CAAC,EAAE;QAClD,IAAI,IAAI,CAACoM,eAAe,CAACpM,CAAC,CAAC,CAACsB,IAAI,IAAIwe,QAAQ,EAAE;UAC1CrD,IAAI,GAAG,IAAI,CAACrQ,eAAe,CAACpM,CAAC,CAAC;UAC9B;QACJ;MACJ;IACJ;IACN;IACA,IAAG,IAAI,CAACyJ,WAAW,CAAC,GAAG,GAAGqW,QAAQ,CAAC,EAClCrD,IAAI,GAAG,IAAI,CAAChT,WAAW,CAAC,GAAG,GAAGqW,QAAQ,CAAC;IAExC,IAAG,IAAI,CAACrW,WAAW,CAAC+a,YAAY,IAAI,IAAI,CAAC/a,WAAW,CAAC+a,YAAY,CAAC1E,QAAQ,CAAC,EAC1ErD,IAAI,GAAG,IAAI,CAAChT,WAAW,CAAC+a,YAAY,CAAC1E,QAAQ,CAAC;;IAE/C;IACA,IAAI,CAACrD,IAAI,IAAI,IAAI,CAACgI,iBAAiB,EAAE;MAC3BhI,IAAI,GAAG,IAAI,CAACgI,iBAAiB,CAAC3E,QAAQ,CAAC;IAC3C;IAEA,IAAI,CAACrD,IAAI,EACLA,IAAI,GAAG,CAAC,CAAC;IACnB,IAAG,CAACA,IAAI,CAAC1U,IAAI,EACZ0U,IAAI,CAAC1U,IAAI,WAAU,IAAI,CAAC+C,UAAU,CAACgV,QAAQ,CAAC;IAC7C,IAAGrD,IAAI,CAACiI,MAAM,IAAI,OAAO,EACxBjI,IAAI,CAAC1U,IAAI,GAAG,MAAM;IAEnB,OAAO0U,IAAI;EACZ,CAAC;;EAEE;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI/T,UAAU,CAACtI,SAAS,CAACukB,SAAS,GAAG,UAAU5c,IAAI,EAAEzG,IAAI,EAAE4Z,KAAK,EAAEoD,QAAQ,EAAEtS,OAAO,EAClF;IACO,IAAI,CAAC,IAAI,CAAC4T,OAAO,EAAE;MACf,IAAI,CAACA,OAAO,GAAG,EAAE;IACrB;IAEN,IAAG,CAAC5T,OAAO,IAAIsS,QAAQ,IAAIA,QAAQ,CAAC7U,WAAW,KAAKb,MAAM,EAC1D;MACCoD,OAAO,GAAGsS,QAAQ;MAClBA,QAAQ,GAAG,IAAI;IAChB;IAEA,IAAGtS,OAAO,IAAIA,OAAO,CAACvC,WAAW,KAAKC,MAAM;MAAE;MAC7CsC,OAAO,GAAG;QAAE8T,QAAQ,EAAE9T;MAAQ,CAAC;IAEhC,IAAGsS,QAAQ,IAAIA,QAAQ,CAAC7U,WAAW,KAAKC,MAAM;MAAE;MAChD;QACC,IAAG,CAACsC,OAAO,EACVA,OAAO,GAAG,CAAC,CAAC;QACbA,OAAO,CAAC8T,QAAQ,GAAGxB,QAAQ;QAC3BA,QAAQ,GAAG,IAAI;MAChB;IAEA,IAAGA,QAAQ,IAAIA,QAAQ,CAAC7U,WAAW,KAAK6B,QAAQ,EAChD;MACCrD,OAAO,CAACqB,IAAI,CAAC,wCAAwC,CAAC;MACtDgV,QAAQ,GAAG,IAAI;IAChB;IAEM,IAAIuB,CAAC,GAAG;MACJ9X,IAAI,EAAEA,IAAI,CAAC4B,WAAW,EAAE;MACxBrI,IAAI,EAAEA,IAAI;MACV4Z,KAAK,EAAEA,KAAK;MACZoD,QAAQ,EAAEA,QAAQ;MAClBtS,OAAO,EAAEA,OAAO,IAAI,CAAC;IACzB,CAAC;IAED,IAAI6T,CAAC,CAAC7T,OAAO,CAAC2L,CAAC,KAAKQ,SAAS,EAAE;MAC3B0H,CAAC,CAAClI,CAAC,GAAGkI,CAAC,CAAC7T,OAAO,CAAC2L,CAAC;IACrB;IAEA,IAAI,CAAC2G,QAAQ,IAAI,CAACuB,CAAC,CAAC7T,OAAO,CAACsS,QAAQ,IAAI,CAACuB,CAAC,CAAC7T,OAAO,CAAC8T,QAAQ,EAAE;MACzD7X,OAAO,CAACqB,IAAI,CAAC,kEAAkE,CAAC;IACpF;IACA,IAAIvB,IAAI,IAAI,OAAO,IAAI,CAAC8X,CAAC,CAAC7T,OAAO,CAAC4Y,MAAM,EAAE;MACtC,MAAM,gGAAgG;IAC1G;IACA,IAAI,CAAChF,OAAO,CAAC3f,IAAI,CAAC4f,CAAC,CAAC;IAC1B,IAAI,CAACmD,OAAO,CAAE,IAAI,CAACzW,WAAW,EAAE,CAAE;IAC5B,OAAOsT,CAAC;EACZ,CAAC;EAEDnX,UAAU,CAACtI,SAAS,CAACykB,eAAe,GAAG,UAASC,aAAa,EAAE;IAC3D,IAAI,CAAC,IAAI,CAAClF,OAAO,EAAE;MACf,IAAI,CAACA,OAAO,GAAG,EAAE;IACrB;IACA,IAAI,CAACA,OAAO,CAAC3f,IAAI,CAAC6kB,aAAa,CAAC;IAChC,OAAOA,aAAa;EACxB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIpc,UAAU,CAACtI,SAAS,CAAC2kB,WAAW,GAAG,UAAS7a,GAAG,EAAE;IAC7CA,GAAG,GAAGA,GAAG,IAAI,IAAIoV,YAAY,CAAC,CAAC,CAAC;IAChCpV,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC;IACxB4B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB;IAClDkI,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACoC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC;IACzBpC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACmC,KAAK,CAAC2Y,SAAS,GAAGnjB,SAAS,CAACG,iBAAiB,GAAG,IAAI,CAACsK,IAAI,CAAC,CAAC,CAAC,GAAGzK,SAAS,CAACG,iBAAiB;IAExG,IAAI,IAAI,CAACijB,UAAU,EAAE;MACjB,IAAI,CAACA,UAAU,CAAC/a,GAAG,CAAC;IACxB;IACA,OAAOA,GAAG;EACd,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIxB,UAAU,CAACtI,SAAS,CAAC8Z,aAAa,GAAG,UAAS1C,CAAC,EAAEG,CAAC,EAAEP,MAAM,EAAE8N,UAAU,EAAE;IACpE9N,MAAM,GAAGA,MAAM,IAAI,CAAC;IAEpB,IAAI+N,UAAU,GAAG,IAAI,CAAC3R,KAAK,IAAI,IAAI,CAACA,KAAK,CAACuJ,MAAM,EAAE,GAAG,CAAC,GAAGlb,SAAS,CAACG,iBAAiB;IACpF,IAAIkjB,UAAU,EAAE;MACZC,UAAU,GAAG,CAAC;IAClB;IACA,IAAI,IAAI,CAAC9Y,KAAK,IAAI,IAAI,CAACA,KAAK,CAAC2Y,SAAS,EAAE;MACpC;MACA,IACII,iBAAiB,CACb5N,CAAC,EACDG,CAAC,EACD,IAAI,CAACrP,GAAG,CAAC,CAAC,CAAC,GAAG8O,MAAM,EACpB,IAAI,CAAC9O,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB,GAAGoV,MAAM,EAClD,CAAC,IAAI,CAACiO,gBAAgB,IAAIxjB,SAAS,CAACU,oBAAoB,IACpD,CAAC,GAAG6U,MAAM,EACdvV,SAAS,CAACG,iBAAiB,GAAG,CAAC,GAAGoV,MAAM,CAC3C,EACH;QACE,OAAO,IAAI;MACf;IACJ,CAAC,MAAM,IACH,IAAI,CAAC9O,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG8O,MAAM,GAAGI,CAAC,IAC5B,IAAI,CAAClP,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACgE,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG8K,MAAM,GAAGI,CAAC,IAC3C,IAAI,CAAClP,GAAG,CAAC,CAAC,CAAC,GAAG6c,UAAU,GAAG/N,MAAM,GAAGO,CAAC,IACrC,IAAI,CAACrP,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACgE,IAAI,CAAC,CAAC,CAAC,GAAG8K,MAAM,GAAGO,CAAC,EACzC;MACE,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIjP,UAAU,CAACtI,SAAS,CAACklB,iBAAiB,GAAG,UAAS9N,CAAC,EAAEG,CAAC,EAAE;IACpD;IACA,IAAI4N,QAAQ,GAAG,IAAIjG,YAAY,CAAC,CAAC,CAAC;IAClC,IAAI,IAAI,CAACrM,MAAM,EAAE;MACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAAC1C,MAAM,CAAC3T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;QAChD,IAAIiX,KAAK,GAAG,IAAI,CAAChE,MAAM,CAACjT,CAAC,CAAC;QAC1B,IAAI,CAACwlB,gBAAgB,CAAC,IAAI,EAAExlB,CAAC,EAAEulB,QAAQ,CAAC;QACxC,IACIH,iBAAiB,CACb5N,CAAC,EACDG,CAAC,EACD4N,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAChBA,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,EACf,EAAE,EACF,EAAE,CACL,EACH;UACE,OAAO;YAAEtO,KAAK,EAAEA,KAAK;YAAEgC,IAAI,EAAEjZ,CAAC;YAAEulB,QAAQ,EAAEA;UAAS,CAAC;QACxD;MACJ;IACJ;IAEA,IAAI,IAAI,CAACrS,OAAO,EAAE;MACd,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAACzC,OAAO,CAAC5T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;QACjD,IAAIiW,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAClT,CAAC,CAAC;QAC5B,IAAI,CAACwlB,gBAAgB,CAAC,KAAK,EAAExlB,CAAC,EAAEulB,QAAQ,CAAC;QACzC,IACIH,iBAAiB,CACb5N,CAAC,EACDG,CAAC,EACD4N,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAChBA,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,EACf,EAAE,EACF,EAAE,CACL,EACH;UACE,OAAO;YAAEtP,MAAM,EAAEA,MAAM;YAAEgD,IAAI,EAAEjZ,CAAC;YAAEulB,QAAQ,EAAEA;UAAS,CAAC;QAC1D;MACJ;IACJ;IAEA,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACI7c,UAAU,CAACtI,SAAS,CAAC4gB,aAAa,GAAG,UAAS1f,IAAI,EAAGmkB,SAAS,EAAE;IAC5D,IAAI,CAAC,IAAI,CAACxS,MAAM,EAAE;MACd,OAAO,CAAC,CAAC;IACb;IACA,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAAC1C,MAAM,CAAC3T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAChD,IAAIsB,IAAI,IAAI,IAAI,CAAC2R,MAAM,CAACjT,CAAC,CAAC,CAACsB,IAAI,EAAE;QAC7B,OAAO,CAACmkB,SAAS,GAAGzlB,CAAC,GAAG,IAAI,CAACiT,MAAM,CAACjT,CAAC,CAAC;MAC1C;IACJ;IACA,OAAO,CAAC,CAAC;EACb,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACI0I,UAAU,CAACtI,SAAS,CAAC4hB,cAAc,GAAG,UAAS1gB,IAAI,EAAEmkB,SAAS,EAAE;IAC5DA,SAAS,GAAGA,SAAS,IAAI,KAAK;IAC9B,IAAI,CAAC,IAAI,CAACvS,OAAO,EAAE;MACf,OAAO,CAAC,CAAC;IACb;IACA,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAACzC,OAAO,CAAC5T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MACjD,IAAIsB,IAAI,IAAI,IAAI,CAAC4R,OAAO,CAAClT,CAAC,CAAC,CAACsB,IAAI,EAAE;QAC9B,OAAO,CAACmkB,SAAS,GAAGzlB,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAClT,CAAC,CAAC;MAC3C;IACJ;IACA,OAAO,CAAC,CAAC;EACb,CAAC;;EAED;;EAEA;AACJ;AACA;AACA;AACA;AACA;EACI0I,UAAU,CAACtI,SAAS,CAACslB,iBAAiB,GAAG,UAASC,MAAM,EAAE;IACtD,IAAIA,MAAM,GAAGA,MAAM,IAAI,CAAC,CAAC;IACzB,IAAIC,OAAO,GAAG;MAACH,SAAS,EAAE,KAAK;MACdI,gBAAgB,EAAE;IACrB,CAAC;IACf,IAAIC,IAAI,GAAGld,MAAM,CAACmd,MAAM,CAACH,OAAO,EAACD,MAAM,CAAC;IACxC,IAAI,CAAC,IAAI,CAAC1S,MAAM,EAAE;MACd,OAAO,CAAC,CAAC;IACb;IACA,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAAC1C,MAAM,CAAC3T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAChD,IAAI,IAAI,CAACiT,MAAM,CAACjT,CAAC,CAAC,CAAC8V,IAAI,IAAI,IAAI,CAAC7C,MAAM,CAACjT,CAAC,CAAC,CAAC8V,IAAI,IAAI,IAAI,EAAE;QACpD;MACJ;MACA,IAAIgQ,IAAI,CAACD,gBAAgB,IAAIC,IAAI,CAACD,gBAAgB,CAACrb,QAAQ,IAAIsb,IAAI,CAACD,gBAAgB,CAACrb,QAAQ,CAAC,IAAI,CAACyI,MAAM,CAACjT,CAAC,CAAC,CAAC+H,IAAI,CAAC,EAAC;QAC/G;MACJ;MACA,OAAO,CAAC+d,IAAI,CAACL,SAAS,GAAGzlB,CAAC,GAAG,IAAI,CAACiT,MAAM,CAACjT,CAAC,CAAC;IAC/C;IACA,OAAO,CAAC,CAAC;EACb,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI0I,UAAU,CAACtI,SAAS,CAAC4lB,kBAAkB,GAAG,UAASL,MAAM,EAAE;IACvD,IAAIA,MAAM,GAAGA,MAAM,IAAI,CAAC,CAAC;IACzB,IAAIC,OAAO,GAAG;MAAEH,SAAS,EAAE,KAAK;MACfI,gBAAgB,EAAE;IACrB,CAAC;IACf,IAAIC,IAAI,GAAGld,MAAM,CAACmd,MAAM,CAACH,OAAO,EAACD,MAAM,CAAC;IACxC,IAAI,CAAC,IAAI,CAACzS,OAAO,EAAE;MACf,OAAO,CAAC,CAAC;IACb;IACA,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAACzC,OAAO,CAAC5T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MACjD,IAAI,IAAI,CAACkT,OAAO,CAAClT,CAAC,CAAC,CAACiS,KAAK,IAAI,IAAI,CAACiB,OAAO,CAAClT,CAAC,CAAC,CAACiS,KAAK,IAAI,IAAI,EAAE;QACxD;MACJ;MACA,IAAI6T,IAAI,CAACD,gBAAgB,IAAIC,IAAI,CAACD,gBAAgB,CAACrb,QAAQ,IAAIsb,IAAI,CAACD,gBAAgB,CAACrb,QAAQ,CAAC,IAAI,CAAC0I,OAAO,CAAClT,CAAC,CAAC,CAAC+H,IAAI,CAAC,EAAC;QAChH;MACJ;MACA,OAAO,CAAC+d,IAAI,CAACL,SAAS,GAAGzlB,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAClT,CAAC,CAAC;IAChD;IACA,OAAO,CAAC,CAAC;EACb,CAAC;;EAED;AACJ;AACA;EACI0I,UAAU,CAACtI,SAAS,CAAC6lB,mBAAmB,GAAG,UAASle,IAAI,EAAE0d,SAAS,EAAES,cAAc,EAAEC,gBAAgB,EAAE;IACnG,OAAO,IAAI,CAACC,cAAc,CAAC,IAAI,EAAEre,IAAI,EAAE0d,SAAS,EAAES,cAAc,EAAEC,gBAAgB,CAAC;EACvF,CAAC;;EAED;AACJ;AACA;EACIzd,UAAU,CAACtI,SAAS,CAACimB,oBAAoB,GAAG,UAASte,IAAI,EAAE0d,SAAS,EAAES,cAAc,EAAEC,gBAAgB,EAAE;IACpG,OAAO,IAAI,CAACC,cAAc,CAAC,KAAK,EAAEre,IAAI,EAAE0d,SAAS,EAAES,cAAc,EAAEC,gBAAgB,CAAC;EACxF,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIzd,UAAU,CAACtI,SAAS,CAACgmB,cAAc,GAAG,UAASnP,KAAK,EAAElP,IAAI,EAAE0d,SAAS,EAAES,cAAc,EAAEC,gBAAgB,EAAE;IACrGlP,KAAK,GAAGA,KAAK,IAAI,KAAK;IACtBwO,SAAS,GAAGA,SAAS,IAAI,KAAK;IAC9BS,cAAc,GAAGA,cAAc,IAAI,KAAK;IACxCC,gBAAgB,GAAGA,gBAAgB,IAAI,KAAK;IAC5C,IAAIG,MAAM,GAAGrP,KAAK,GAAG,IAAI,CAAChE,MAAM,GAAG,IAAI,CAACC,OAAO;IAC/C,IAAI,CAACoT,MAAM,EAAE;MACT,OAAO,CAAC,CAAC;IACb;IACN;IACA,IAAIve,IAAI,IAAI,EAAE,IAAIA,IAAI,IAAI,GAAG,EAAEA,IAAI,GAAG,CAAC;IACjC,KAAK,IAAI/H,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG2Q,MAAM,CAAChnB,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAC3C,IAAIumB,MAAM,GAAG,KAAK;MAClB,IAAIC,OAAO,GAAG,CAACze,IAAI,GAAC,EAAE,EAAE4B,WAAW,EAAE,CAACvB,KAAK,CAAC,GAAG,CAAC;MAChD,IAAIqe,KAAK,GAAGH,MAAM,CAACtmB,CAAC,CAAC,CAAC+H,IAAI,IAAE,GAAG,IAAEue,MAAM,CAACtmB,CAAC,CAAC,CAAC+H,IAAI,IAAE,GAAG,GAAC,GAAG,GAACue,MAAM,CAACtmB,CAAC,CAAC,CAAC+H,IAAI;MAChF0e,KAAK,GAAG,CAACA,KAAK,GAAC,EAAE,EAAE9c,WAAW,EAAE,CAACvB,KAAK,CAAC,GAAG,CAAC;MAClC,KAAIse,EAAE,GAAC,CAAC,EAACA,EAAE,GAACF,OAAO,CAAClnB,MAAM,EAAConB,EAAE,EAAE,EAAC;QAC5B,KAAIC,EAAE,GAAC,CAAC,EAACA,EAAE,GAACF,KAAK,CAACnnB,MAAM,EAACqnB,EAAE,EAAE,EAAC;UACzC,IAAIH,OAAO,CAACE,EAAE,CAAC,IAAE,SAAS,EAAEF,OAAO,CAACE,EAAE,CAAC,GAAG7kB,SAAS,CAACyC,KAAK;UACzD,IAAImiB,KAAK,CAACC,EAAE,CAAC,IAAE,SAAS,EAAED,KAAK,CAACC,EAAE,CAAC,GAAG7kB,SAAS,CAACyC,KAAK;UACrD,IAAIkiB,OAAO,CAACE,EAAE,CAAC,IAAE,GAAG,EAAEF,OAAO,CAACE,EAAE,CAAC,GAAG,CAAC;UACrC,IAAID,KAAK,CAACC,EAAE,CAAC,IAAE,GAAG,EAAED,KAAK,CAACC,EAAE,CAAC,GAAG,CAAC;UACjC,IAAIF,OAAO,CAACE,EAAE,CAAC,IAAID,KAAK,CAACE,EAAE,CAAC,EAAE;YACX,IAAIT,cAAc,IAAII,MAAM,CAACtmB,CAAC,CAAC,CAACiS,KAAK,IAAIqU,MAAM,CAACtmB,CAAC,CAAC,CAACiS,KAAK,KAAK,IAAI,EAAE;YACnE,OAAO,CAACwT,SAAS,GAAGzlB,CAAC,GAAGsmB,MAAM,CAACtmB,CAAC,CAAC;UACrC;QACJ;MACJ;IACJ;IACA;IACA,IAAIkmB,cAAc,IAAI,CAACC,gBAAgB,EAAC;MACpC,KAAK,IAAInmB,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG2Q,MAAM,CAAChnB,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;QAC3C,IAAIumB,MAAM,GAAG,KAAK;QAClB,IAAIC,OAAO,GAAG,CAACze,IAAI,GAAC,EAAE,EAAE4B,WAAW,EAAE,CAACvB,KAAK,CAAC,GAAG,CAAC;QAChD,IAAIqe,KAAK,GAAGH,MAAM,CAACtmB,CAAC,CAAC,CAAC+H,IAAI,IAAE,GAAG,IAAEue,MAAM,CAACtmB,CAAC,CAAC,CAAC+H,IAAI,IAAE,GAAG,GAAC,GAAG,GAACue,MAAM,CAACtmB,CAAC,CAAC,CAAC+H,IAAI;QACnF0e,KAAK,GAAG,CAACA,KAAK,GAAC,EAAE,EAAE9c,WAAW,EAAE,CAACvB,KAAK,CAAC,GAAG,CAAC;QAC/B,KAAIse,EAAE,GAAC,CAAC,EAACA,EAAE,GAACF,OAAO,CAAClnB,MAAM,EAAConB,EAAE,EAAE,EAAC;UAC5B,KAAIC,EAAE,GAAC,CAAC,EAACA,EAAE,GAACF,KAAK,CAACnnB,MAAM,EAACqnB,EAAE,EAAE,EAAC;YAC5C,IAAIH,OAAO,CAACE,EAAE,CAAC,IAAE,GAAG,EAAEF,OAAO,CAACE,EAAE,CAAC,GAAG,CAAC;YACrC,IAAID,KAAK,CAACC,EAAE,CAAC,IAAE,GAAG,EAAED,KAAK,CAACC,EAAE,CAAC,GAAG,CAAC;YACf,IAAIF,OAAO,CAACE,EAAE,CAAC,IAAID,KAAK,CAACE,EAAE,CAAC,EAAE;cAC1B,OAAO,CAAClB,SAAS,GAAGzlB,CAAC,GAAGsmB,MAAM,CAACtmB,CAAC,CAAC;YACrC;UACJ;QACJ;MACJ;IACJ;IACA,OAAO,CAAC,CAAC;EACb,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACI0I,UAAU,CAACtI,SAAS,CAACwmB,aAAa,GAAG,UAAS3N,IAAI,EAAE9C,WAAW,EAAE0Q,eAAe,EAAElB,MAAM,EAAE;IACtF,IAAIA,MAAM,GAAGA,MAAM,IAAI,CAAC,CAAC;IACzB,IAAIC,OAAO,GAAG;MAAEkB,iBAAiB,EAAE,IAAI;MACrCC,8BAA8B,EAAE,IAAI;MACrBC,iBAAiB,EAAE;IACtB,CAAC;IACf,IAAIlB,IAAI,GAAGld,MAAM,CAACmd,MAAM,CAACH,OAAO,EAACD,MAAM,CAAC;IACxC,IAAIxP,WAAW,IAAIA,WAAW,CAAC1M,WAAW,KAAKwd,MAAM,EAAE;MACnD9Q,WAAW,GAAG,IAAI,CAAC3C,KAAK,CAAC4C,WAAW,CAACD,WAAW,CAAC;IACrD;IACAoH,WAAW,GAAGpH,WAAW,CAAC8P,mBAAmB,CAACY,eAAe,EAAE,KAAK,EAAE,IAAI,CAAC;IAC3E,IAAItJ,WAAW,IAAI,CAAC,IAAIA,WAAW,KAAK,IAAI,EAAC;MACzC;MACA,OAAO,IAAI,CAAC2J,OAAO,CAACjO,IAAI,EAAE9C,WAAW,EAAEoH,WAAW,CAAC;IACvD,CAAC,MAAI;MACD;MACA,IAAIuI,IAAI,CAACgB,iBAAiB,IAAID,eAAe,IAAIhlB,SAAS,CAACyC,KAAK,EAAC;QAC7D;QACZ;QACY,OAAO,IAAI,CAAC4iB,OAAO,CAACjO,IAAI,EAAE9C,WAAW,EAAE,CAAC,CAAC,CAAC;MAC9C;MACT;MACS,IAAI2P,IAAI,CAACkB,iBAAiB,EAAC;QACvB,IAAIzJ,WAAW,GAAGpH,WAAW,CAAC8P,mBAAmB,CAAC,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC;QACnF;QACY,IAAI1I,WAAW,IAAI,CAAC,EAAC;UACjB,OAAO,IAAI,CAAC2J,OAAO,CAACjO,IAAI,EAAE9C,WAAW,EAAEoH,WAAW,CAAC;QACvD;MACJ;MACA;MACA,IAAIuI,IAAI,CAACiB,8BAA8B,KAAKF,eAAe,IAAI,CAAC,IAAIA,eAAe,IAAI,GAAG,IAAIA,eAAe,IAAI,EAAE,CAAC,EAAC;QACjH,IAAItJ,WAAW,GAAGpH,WAAW,CAACuP,iBAAiB,CAAC;UAACG,gBAAgB,EAAE,CAAChkB,SAAS,CAACyC,KAAK;QAAE,CAAC,CAAC;QACnG;QACY,IAAIiZ,WAAW,IAAI,CAAC,EAAC;UAChC,OAAO,IAAI,CAAC2J,OAAO,CAACjO,IAAI,EAAE9C,WAAW,EAAEoH,WAAW,CAAC;QACxC;MACJ;MAETtV,OAAO,CAACnC,KAAK,CAAC,0BAA0B,EAAC+gB,eAAe,EAAC,iBAAiB,EAAC1Q,WAAW,CAAC;MACvF;;MAES,OAAO,IAAI;IACf;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACIzN,UAAU,CAACtI,SAAS,CAAC+mB,mBAAmB,GAAG,UAASlO,IAAI,EAAEmO,WAAW,EAAEC,eAAe,EAAE1B,MAAM,EAAE;IAC5F,IAAIA,MAAM,GAAGA,MAAM,IAAI,CAAC,CAAC;IACzB,IAAIC,OAAO,GAAG;MAAEkB,iBAAiB,EAAE,IAAI;MACtBQ,6BAA6B,EAAE,IAAI;MACnCN,iBAAiB,EAAE;IACtB,CAAC;IACf,IAAIlB,IAAI,GAAGld,MAAM,CAACmd,MAAM,CAACH,OAAO,EAACD,MAAM,CAAC;IACxC,IAAIyB,WAAW,IAAIA,WAAW,CAAC3d,WAAW,KAAKwd,MAAM,EAAE;MACnDG,WAAW,GAAG,IAAI,CAAC5T,KAAK,CAAC4C,WAAW,CAACgR,WAAW,CAAC;IACrD;IACAG,WAAW,GAAGH,WAAW,CAACf,oBAAoB,CAACgB,eAAe,EAAE,KAAK,EAAE,IAAI,CAAC;IAC5E,IAAIE,WAAW,IAAI,CAAC,IAAIA,WAAW,KAAK,IAAI,EAAC;MACzC;MACA,OAAOH,WAAW,CAACF,OAAO,CAACK,WAAW,EAAE,IAAI,EAAEtO,IAAI,CAAC;IACvD,CAAC,MAAI;MAED;MACA,IAAI6M,IAAI,CAACkB,iBAAiB,EAAC;QACvB,IAAIO,WAAW,GAAGH,WAAW,CAACf,oBAAoB,CAAC,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC;QACxE,IAAIkB,WAAW,IAAI,CAAC,EAAC;UACjB,OAAOH,WAAW,CAACF,OAAO,CAACK,WAAW,EAAE,IAAI,EAAEtO,IAAI,CAAC;QACvD;MACJ;MAEA,IAAI6M,IAAI,CAACgB,iBAAiB,IAAIO,eAAe,IAAIxlB,SAAS,CAACyC,KAAK,EAAC;QAC7D;QACZ,IAAIzC,SAAS,CAAC4F,qBAAqB,EAAC;UACnC,IAAI8f,WAAW,GAAGH,WAAW,CAACrF,mBAAmB,EAAE;UACnD,OAAOqF,WAAW,CAACF,OAAO,CAACK,WAAW,EAAE,IAAI,EAAEtO,IAAI,CAAC;QACpD;MACQ;MACA;MACA,IAAI6M,IAAI,CAACwB,6BAA6B,KAAKD,eAAe,IAAI,CAAC,IAAIA,eAAe,IAAI,GAAG,IAAIA,eAAe,IAAI,EAAE,CAAC,EAAC;QAChH,IAAIE,WAAW,GAAGH,WAAW,CAACpB,kBAAkB,CAAC;UAACH,gBAAgB,EAAE,CAAChkB,SAAS,CAACyC,KAAK;QAAE,CAAC,CAAC;QACxF,IAAIijB,WAAW,IAAI,CAAC,EAAC;UACjB,OAAOH,WAAW,CAACF,OAAO,CAACK,WAAW,EAAE,IAAI,EAAEtO,IAAI,CAAC;QACvD;MACJ;MAEThR,OAAO,CAACnC,KAAK,CAAC,gCAAgC,EAACuhB,eAAe,EAAC,iBAAiB,EAACD,WAAW,CAAC;MAC7F;;MAES;MACA,OAAO,IAAI;IACf;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACI1e,UAAU,CAACtI,SAAS,CAAC8mB,OAAO,GAAG,UAASjO,IAAI,EAAE9C,WAAW,EAAEoH,WAAW,EAAE;IACpEA,WAAW,GAAGA,WAAW,IAAI,CAAC;IAE9B,IAAI,CAAC,IAAI,CAAC/J,KAAK,EAAE;MACb;MACAvL,OAAO,CAACC,GAAG,CACP,gHAAgH,CACnH,CAAC,CAAC;MACH,OAAO,IAAI;IACf;;IAEA;IACA,IAAI+Q,IAAI,CAACxP,WAAW,KAAKC,MAAM,EAAE;MAC7BuP,IAAI,GAAG,IAAI,CAAC+I,cAAc,CAAC/I,IAAI,CAAC;MAChC,IAAIA,IAAI,IAAI,CAAC,CAAC,EAAE;QACZ,IAAIpX,SAAS,CAACiE,KAAK,EAAE;UACjBmC,OAAO,CAACC,GAAG,CAAC,kCAAkC,GAAG+Q,IAAI,CAAC;QAC1D;QACA,OAAO,IAAI;MACf;IACJ,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC/F,OAAO,IAAI+F,IAAI,IAAI,IAAI,CAAC/F,OAAO,CAAC5T,MAAM,EAAE;MACrD,IAAIuC,SAAS,CAACiE,KAAK,EAAE;QACjBmC,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC;MACxD;MACA,OAAO,IAAI;IACf;IAEA,IAAIiO,WAAW,IAAIA,WAAW,CAAC1M,WAAW,KAAKwd,MAAM,EAAE;MACnD9Q,WAAW,GAAG,IAAI,CAAC3C,KAAK,CAAC4C,WAAW,CAACD,WAAW,CAAC;IACrD;IACA,IAAI,CAACA,WAAW,EAAE;MACd,MAAM,qBAAqB;IAC/B;;IAEA;IACA,IAAIA,WAAW,IAAI,IAAI,EAAE;MACrB,OAAO,IAAI;IACf;;IAEA;IACA,IAAIoH,WAAW,CAAC9T,WAAW,KAAKC,MAAM,EAAE;MACpC6T,WAAW,GAAGpH,WAAW,CAAC6K,aAAa,CAACzD,WAAW,CAAC;MACpD,IAAIA,WAAW,IAAI,CAAC,CAAC,EAAE;QACnB,IAAI1b,SAAS,CAACiE,KAAK,EAAE;UACjBmC,OAAO,CAACC,GAAG,CACP,kCAAkC,GAAGqV,WAAW,CACnD;QACL;QACA,OAAO,IAAI;MACf;IACJ,CAAC,MAAM,IAAIA,WAAW,KAAK1b,SAAS,CAACyC,KAAK,EAAE;MAExC,IAAIzC,SAAS,CAAC4F,qBAAqB,EAAC;QACnC;QACT;QACS;QACA0O,WAAW,CAACgM,UAAU,CAACtgB,SAAS,CAACgD,UAAU,CAAC;QAC5C0Y,WAAW,GAAGpH,WAAW,CAAC6K,aAAa,CAAC,WAAW,CAAC;MACxD,CAAC,MAAI;QACD,OAAO,IAAI,CAAC,CAAC;MACvB;IACK,CAAC,MAAM,IACH,CAAC7K,WAAW,CAAClD,MAAM,IACnBsK,WAAW,IAAIpH,WAAW,CAAClD,MAAM,CAAC3T,MAAM,EAC1C;MACE,IAAIuC,SAAS,CAACiE,KAAK,EAAE;QACjBmC,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC;MACxD;MACA,OAAO,IAAI;IACf;IAEN,IAAIsf,OAAO,GAAG,KAAK;IAEb,IAAIvQ,KAAK,GAAGd,WAAW,CAAClD,MAAM,CAACsK,WAAW,CAAC;IAC3C,IAAIV,SAAS,GAAG,IAAI;IACpB,IAAI5G,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAC+F,IAAI,CAAC;IAE/B,IAAI,CAAC,IAAI,CAAC/F,OAAO,CAAC+F,IAAI,CAAC,EAAC;MACpB;AACZ;MACY,OAAO,IAAI;IACf;;IAEA;IACA,IAAI9C,WAAW,CAACsR,oBAAoB,EAAE;MAClC;MACAlK,WAAW,GAAGpH,WAAW,CAACsR,oBAAoB,CAAClK,WAAW,CAAC,CAAC,CAAC;IACjE;;IAEN;IACM,IAAIA,WAAW,KAAG,KAAK,IAAIA,WAAW,KAAG,IAAI,IAAI,CAAC1b,SAAS,CAACwM,iBAAiB,CAAC4H,MAAM,CAAClO,IAAI,EAAEkP,KAAK,CAAClP,IAAI,CAAC,EAC5G;MACO,IAAI,CAAC+P,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC;MACtC,IAAG0P,OAAO,EACH,IAAI,CAAChU,KAAK,CAACoJ,gBAAgB,CAAC,IAAI,EAAEC,SAAS,CAAC;MACnD,OAAO,IAAI;IACZ,CAAC,MAAI;MACJ;IAAA;;IAGK;IACA,IAAI1G,WAAW,CAACuR,cAAc,EAAE;MAC5B,IAAKvR,WAAW,CAACuR,cAAc,CAACnK,WAAW,EAAEtH,MAAM,CAAClO,IAAI,EAAEkO,MAAM,EAAE,IAAI,EAAEgD,IAAI,CAAC,KAAK,KAAK,EAAG;QACtF,OAAO,IAAI;MACf;IACJ;IACA,IAAI,IAAI,CAAC0O,eAAe,EAAE;MAAE;MACxB,IAAK,IAAI,CAACA,eAAe,CAAC1O,IAAI,EAAEhC,KAAK,CAAClP,IAAI,EAAEkP,KAAK,EAAEd,WAAW,EAAEoH,WAAW,CAAC,KAAK,KAAK,EAAG;QACrF,OAAO,IAAI;MACf;IACJ;;IAEA;IACA,IAAIpH,WAAW,CAAClD,MAAM,CAACsK,WAAW,CAAC,IAAIpH,WAAW,CAAClD,MAAM,CAACsK,WAAW,CAAC,CAACzH,IAAI,IAAI,IAAI,EAAE;MAC1F,IAAI,CAACtC,KAAK,CAACwF,YAAY,EAAE;MAChB7C,WAAW,CAAC+C,eAAe,CAACqE,WAAW,EAAE;QAACqK,eAAe,EAAE;MAAK,CAAC,CAAC;MAC3EJ,OAAO,GAAG,IAAI;IACT;IACA,IAAIvR,MAAM,CAAChE,KAAK,KAAK,IAAI,IAAIgE,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAAC;MAC7C,QAAO2W,MAAM,CAAClO,IAAI;QACd,KAAKlG,SAAS,CAACyC,KAAK;UAChB,IAAI,CAACzC,SAAS,CAAC6F,6BAA6B,EAAC;YACzC,IAAI,CAAC8L,KAAK,CAACwF,YAAY,EAAE;YACzB,IAAI,CAACG,gBAAgB,CAACF,IAAI,EAAE,KAAK,EAAE;cAAC2O,eAAe,EAAE;YAAK,CAAC,CAAC,CAAC,CAAC;YAC9DJ,OAAO,GAAG,IAAI;UAClB;UACJ;QACA;UACA;MAAM;IAEd;;IAEN;IACA3K,SAAS,GAAG,IAAIa,KAAK,CACpB,EAAE,IAAI,CAAClK,KAAK,CAAC/B,YAAY,EACzBwF,KAAK,CAAClP,IAAI,IAAIkO,MAAM,CAAClO,IAAI,EACzB,IAAI,CAAC6N,EAAE,EACPqD,IAAI,EACJ9C,WAAW,CAACP,EAAE,EACd2H,WAAW,CACX;;IAED;IACA,IAAI,CAAC/J,KAAK,CAACvB,KAAK,CAAC4K,SAAS,CAACjH,EAAE,CAAC,GAAGiH,SAAS;;IAE1C;IACA,IAAI5G,MAAM,CAAChE,KAAK,IAAI,IAAI,EAAE;MACzBgE,MAAM,CAAChE,KAAK,GAAG,EAAE;IAClB;IACAgE,MAAM,CAAChE,KAAK,CAAChS,IAAI,CAAC4c,SAAS,CAACjH,EAAE,CAAC;IAC/B;IACAO,WAAW,CAAClD,MAAM,CAACsK,WAAW,CAAC,CAACzH,IAAI,GAAG+G,SAAS,CAACjH,EAAE;IACnD,IAAI,IAAI,CAACpC,KAAK,EAAE;MACf,IAAI,CAACA,KAAK,CAAC9B,QAAQ,EAAE;IACtB;IACA,IAAI,IAAI,CAACiO,mBAAmB,EAAE;MAC7B,IAAI,CAACA,mBAAmB,CACvB9d,SAAS,CAACwC,MAAM,EAChB4U,IAAI,EACJ,IAAI,EACJ4D,SAAS,EACT5G,MAAM,CACN;IACF,CAAC,CAAC;IACF,IAAIE,WAAW,CAACwJ,mBAAmB,EAAE;MACpCxJ,WAAW,CAACwJ,mBAAmB,CAC9B9d,SAAS,CAACuC,KAAK,EACfmZ,WAAW,EACX,IAAI,EACJV,SAAS,EACT5F,KAAK,CACL;IACF;IACA,IAAI,IAAI,CAACzD,KAAK,IAAI,IAAI,CAACA,KAAK,CAACqU,sBAAsB,EAAE;MACpD,IAAI,CAACrU,KAAK,CAACqU,sBAAsB,CAChChmB,SAAS,CAACuC,KAAK,EACf+R,WAAW,EACXoH,WAAW,EACX,IAAI,EACJtE,IAAI,CACJ;MACD,IAAI,CAACzF,KAAK,CAACqU,sBAAsB,CAChChmB,SAAS,CAACwC,MAAM,EAChB,IAAI,EACJ4U,IAAI,EACJ9C,WAAW,EACXoH,WAAW,CACX;IACF;IAEM,IAAI,CAACzF,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC;IACtC,IAAI,CAACtE,KAAK,CAACgG,WAAW,EAAE;IACxB,IAAI,CAAChG,KAAK,CAACoJ,gBAAgB,CAAC,IAAI,EAAEC,SAAS,CAAC;IAEtC,OAAOA,SAAS;EACpB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACInU,UAAU,CAACtI,SAAS,CAAC+Y,gBAAgB,GAAG,UAASF,IAAI,EAAE9C,WAAW,EAAE;IAChE,IAAI8C,IAAI,CAACxP,WAAW,KAAKC,MAAM,EAAE;MAC7BuP,IAAI,GAAG,IAAI,CAAC+I,cAAc,CAAC/I,IAAI,CAAC;MAChC,IAAIA,IAAI,IAAI,CAAC,CAAC,EAAE;QACZ,IAAIpX,SAAS,CAACiE,KAAK,EAAE;UACjBmC,OAAO,CAACC,GAAG,CAAC,kCAAkC,GAAG+Q,IAAI,CAAC;QAC1D;QACA,OAAO,KAAK;MAChB;IACJ,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC/F,OAAO,IAAI+F,IAAI,IAAI,IAAI,CAAC/F,OAAO,CAAC5T,MAAM,EAAE;MACrD,IAAIuC,SAAS,CAACiE,KAAK,EAAE;QACjBmC,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC;MACxD;MACA,OAAO,KAAK;IAChB;;IAEA;IACA,IAAI+N,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAC+F,IAAI,CAAC;IAC/B,IAAI,CAAChD,MAAM,IAAI,CAACA,MAAM,CAAChE,KAAK,IAAIgE,MAAM,CAAChE,KAAK,CAAC3S,MAAM,IAAI,CAAC,EAAE;MACtD,OAAO,KAAK;IAChB;;IAEA;IACA,IAAI6W,WAAW,EAAE;MACb,IAAIA,WAAW,CAAC1M,WAAW,KAAKwd,MAAM,EAAE;QACpC9Q,WAAW,GAAG,IAAI,CAAC3C,KAAK,CAAC4C,WAAW,CAACD,WAAW,CAAC;MACrD;MACA,IAAI,CAACA,WAAW,EAAE;QACd,MAAM,uBAAuB;MACjC;MAEA,KAAK,IAAInW,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAGM,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE3V,CAAC,EAAE,EAAE;QACjD,IAAIkW,OAAO,GAAGD,MAAM,CAAChE,KAAK,CAACjS,CAAC,CAAC;QAC7B,IAAI6c,SAAS,GAAG,IAAI,CAACrJ,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC;;QAEzC;QACA,IAAI2G,SAAS,CAACxG,SAAS,IAAIF,WAAW,CAACP,EAAE,EAAE;UACvCK,MAAM,CAAChE,KAAK,CAACyB,MAAM,CAAC1T,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;UAC3B,IAAIiX,KAAK,GAAGd,WAAW,CAAClD,MAAM,CAAC4J,SAAS,CAACU,WAAW,CAAC;UACrDtG,KAAK,CAACnB,IAAI,GAAG,IAAI,CAAC,CAAC;UACnB,OAAO,IAAI,CAACtC,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC,CAAC,CAAC;UAClC,IAAI,IAAI,CAAC1C,KAAK,EAAE;YACZ,IAAI,CAACA,KAAK,CAAC9B,QAAQ,EAAE;UACzB;UACA,IAAIyE,WAAW,CAACwJ,mBAAmB,EAAE;YACjCxJ,WAAW,CAACwJ,mBAAmB,CAC3B9d,SAAS,CAACuC,KAAK,EACfyY,SAAS,CAACU,WAAW,EACrB,KAAK,EACLV,SAAS,EACT5F,KAAK,CACR;UACL,CAAC,CAAC;UACF,IAAI,IAAI,CAAC0I,mBAAmB,EAAE;YAC1B,IAAI,CAACA,mBAAmB,CACpB9d,SAAS,CAACwC,MAAM,EAChB4U,IAAI,EACJ,KAAK,EACL4D,SAAS,EACT5G,MAAM,CACT;UACL;UACA,IAAI,IAAI,CAACzC,KAAK,IAAI,IAAI,CAACA,KAAK,CAACqU,sBAAsB,EAAE;YACjD,IAAI,CAACrU,KAAK,CAACqU,sBAAsB,CAC7BhmB,SAAS,CAACwC,MAAM,EAChB,IAAI,EACJ4U,IAAI,CACP;UACL;UACA,IAAI,IAAI,CAACzF,KAAK,IAAI,IAAI,CAACA,KAAK,CAACqU,sBAAsB,EAAE;YACjD,IAAI,CAACrU,KAAK,CAACqU,sBAAsB,CAC7BhmB,SAAS,CAACwC,MAAM,EAChB,IAAI,EACJ4U,IAAI,CACP;YACD,IAAI,CAACzF,KAAK,CAACqU,sBAAsB,CAC7BhmB,SAAS,CAACuC,KAAK,EACf+R,WAAW,EACX0G,SAAS,CAACU,WAAW,CACxB;UACL;UACA;QACJ;MACJ;IACJ,CAAC,CAAC;IAAA,KACG;MACD,KAAK,IAAIvd,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAGM,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE3V,CAAC,EAAE,EAAE;QACjD,IAAIkW,OAAO,GAAGD,MAAM,CAAChE,KAAK,CAACjS,CAAC,CAAC;QAC7B,IAAI6c,SAAS,GAAG,IAAI,CAACrJ,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC;QACzC,IAAI,CAAC2G,SAAS,EAAE;UACZ;UACA;QACJ;QAEA,IAAI1G,WAAW,GAAG,IAAI,CAAC3C,KAAK,CAAC4C,WAAW,CAACyG,SAAS,CAACxG,SAAS,CAAC;QAC7D,IAAIY,KAAK,GAAG,IAAI;QAChB,IAAI,IAAI,CAACzD,KAAK,EAAE;UACZ,IAAI,CAACA,KAAK,CAAC9B,QAAQ,EAAE;QACzB;QACA,IAAIyE,WAAW,EAAE;UACbc,KAAK,GAAGd,WAAW,CAAClD,MAAM,CAAC4J,SAAS,CAACU,WAAW,CAAC;UACjDtG,KAAK,CAACnB,IAAI,GAAG,IAAI,CAAC,CAAC;UACnB,IAAIK,WAAW,CAACwJ,mBAAmB,EAAE;YACjCxJ,WAAW,CAACwJ,mBAAmB,CAC3B9d,SAAS,CAACuC,KAAK,EACfyY,SAAS,CAACU,WAAW,EACrB,KAAK,EACLV,SAAS,EACT5F,KAAK,CACR;UACL,CAAC,CAAC;UACF,IAAI,IAAI,CAACzD,KAAK,IAAI,IAAI,CAACA,KAAK,CAACqU,sBAAsB,EAAE;YACjD,IAAI,CAACrU,KAAK,CAACqU,sBAAsB,CAC7BhmB,SAAS,CAACuC,KAAK,EACf+R,WAAW,EACX0G,SAAS,CAACU,WAAW,CACxB;UACL;QACJ;QACA,OAAO,IAAI,CAAC/J,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC,CAAC,CAAC;QAClC,IAAI,IAAI,CAACyJ,mBAAmB,EAAE;UAC1B,IAAI,CAACA,mBAAmB,CACpB9d,SAAS,CAACwC,MAAM,EAChB4U,IAAI,EACJ,KAAK,EACL4D,SAAS,EACT5G,MAAM,CACT;QACL;QACA,IAAI,IAAI,CAACzC,KAAK,IAAI,IAAI,CAACA,KAAK,CAACqU,sBAAsB,EAAE;UACjD,IAAI,CAACrU,KAAK,CAACqU,sBAAsB,CAC7BhmB,SAAS,CAACwC,MAAM,EAChB,IAAI,EACJ4U,IAAI,CACP;UACD,IAAI,CAACzF,KAAK,CAACqU,sBAAsB,CAC7BhmB,SAAS,CAACuC,KAAK,EACf+R,WAAW,EACX0G,SAAS,CAACU,WAAW,CACxB;QACL;MACJ;MACAtH,MAAM,CAAChE,KAAK,GAAG,IAAI;IACvB;IAEA,IAAI,CAAC6F,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC;IAChC,IAAI,CAACtE,KAAK,CAACoJ,gBAAgB,CAAC,IAAI,CAAC;IACjC,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIlU,UAAU,CAACtI,SAAS,CAAC8Y,eAAe,GAAG,UAASD,IAAI,EAAE;IAClD;IACA,IAAIA,IAAI,CAACxP,WAAW,KAAKC,MAAM,EAAE;MAC7BuP,IAAI,GAAG,IAAI,CAAC+H,aAAa,CAAC/H,IAAI,CAAC;MAC/B,IAAIA,IAAI,IAAI,CAAC,CAAC,EAAE;QACZ,IAAIpX,SAAS,CAACiE,KAAK,EAAE;UACjBmC,OAAO,CAACC,GAAG,CAAC,kCAAkC,GAAG+Q,IAAI,CAAC;QAC1D;QACA,OAAO,KAAK;MAChB;IACJ,CAAC,MAAM,IAAI,CAAC,IAAI,CAAChG,MAAM,IAAIgG,IAAI,IAAI,IAAI,CAAChG,MAAM,CAAC3T,MAAM,EAAE;MACnD,IAAIuC,SAAS,CAACiE,KAAK,EAAE;QACjBmC,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC;MACxD;MACA,OAAO,KAAK;IAChB;IAEA,IAAI+O,KAAK,GAAG,IAAI,CAAChE,MAAM,CAACgG,IAAI,CAAC;IAC7B,IAAI,CAAChC,KAAK,EAAE;MACR,OAAO,KAAK;IAChB;IAEA,IAAIf,OAAO,GAAG,IAAI,CAACjD,MAAM,CAACgG,IAAI,CAAC,CAACnD,IAAI;IAC1C,IAAGI,OAAO,IAAI,IAAI,EAClB;MACC,IAAI,CAACjD,MAAM,CAACgG,IAAI,CAAC,CAACnD,IAAI,GAAG,IAAI;;MAE7B;MACA,IAAI+G,SAAS,GAAG,IAAI,CAACrJ,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC;MACzC,IAAI2G,SAAS,EAAE;QACd,IAAI1G,WAAW,GAAG,IAAI,CAAC3C,KAAK,CAAC4C,WAAW,CAACyG,SAAS,CAACqC,SAAS,CAAC;QAC7D,IAAI,CAAC/I,WAAW,EAAE;UACjB,OAAO,KAAK;QACb;QAEA,IAAIF,MAAM,GAAGE,WAAW,CAACjD,OAAO,CAAC2J,SAAS,CAACsC,WAAW,CAAC;QACvD,IAAI,CAAClJ,MAAM,IAAI,CAACA,MAAM,CAAChE,KAAK,IAAIgE,MAAM,CAAChE,KAAK,CAAC3S,MAAM,IAAI,CAAC,EAAE;UACzD,OAAO,KAAK;QACb;;QAEA;QACA,KAAK,IAAIU,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAGM,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE3V,CAAC,EAAE,EAAE;UACpD,IAAIiW,MAAM,CAAChE,KAAK,CAACjS,CAAC,CAAC,IAAIkW,OAAO,EAAE;YAC/BD,MAAM,CAAChE,KAAK,CAACyB,MAAM,CAAC1T,CAAC,EAAE,CAAC,CAAC;YACzB;UACD;QACD;QAEA,OAAO,IAAI,CAACwT,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC,CAAC,CAAC;QAClC,IAAI,IAAI,CAAC1C,KAAK,EAAE;UACf,IAAI,CAACA,KAAK,CAAC9B,QAAQ,EAAE;QACtB;QACA,IAAI,IAAI,CAACiO,mBAAmB,EAAE;UAC7B,IAAI,CAACA,mBAAmB,CACvB9d,SAAS,CAACuC,KAAK,EACf6U,IAAI,EACJ,KAAK,EACL4D,SAAS,EACT5F,KAAK,CACL;QACF;QACA,IAAId,WAAW,CAACwJ,mBAAmB,EAAE;UACpCxJ,WAAW,CAACwJ,mBAAmB,CAC9B9d,SAAS,CAACwC,MAAM,EAChBrE,CAAC,EACD,KAAK,EACL6c,SAAS,EACT5G,MAAM,CACN;QACF;QACA,IAAI,IAAI,CAACzC,KAAK,IAAI,IAAI,CAACA,KAAK,CAACqU,sBAAsB,EAAE;UACpD,IAAI,CAACrU,KAAK,CAACqU,sBAAsB,CAChChmB,SAAS,CAACwC,MAAM,EAChB8R,WAAW,EACXnW,CAAC,CACD;UACD,IAAI,CAACwT,KAAK,CAACqU,sBAAsB,CAAChmB,SAAS,CAACuC,KAAK,EAAE,IAAI,EAAE6U,IAAI,CAAC;QAC/D;MACD;IACD,CAAC,CAAC;;IAEI,IAAI,CAACnB,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC;IACtC,IAAG,IAAI,CAACtE,KAAK,EACN,IAAI,CAACA,KAAK,CAACoJ,gBAAgB,CAAC,IAAI,CAAC;IAClC,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACIlU,UAAU,CAACtI,SAAS,CAAColB,gBAAgB,GAAG,UACpCsC,QAAQ,EACRC,WAAW,EACX7d,GAAG,EACL;IACEA,GAAG,GAAGA,GAAG,IAAI,IAAIoV,YAAY,CAAC,CAAC,CAAC;IAChC,IAAI0I,SAAS,GAAG,CAAC;IACjB,IAAIF,QAAQ,IAAI,IAAI,CAAC7U,MAAM,EAAE;MACzB+U,SAAS,GAAG,IAAI,CAAC/U,MAAM,CAAC3T,MAAM;IAClC;IACA,IAAI,CAACwoB,QAAQ,IAAI,IAAI,CAAC5U,OAAO,EAAE;MAC3B8U,SAAS,GAAG,IAAI,CAAC9U,OAAO,CAAC5T,MAAM;IACnC;IAEA,IAAI2oB,MAAM,GAAGpmB,SAAS,CAACK,gBAAgB,GAAG,GAAG;IAE7C,IAAI,IAAI,CAACmK,KAAK,CAAC2Y,SAAS,EAAE;MACtB,IAAInF,CAAC,GAAG,IAAI,CAACwF,gBAAgB,IAAIxjB,SAAS,CAACU,oBAAoB;MAC/D,IAAI,IAAI,CAAC2lB,UAAU,EAAE;QACjBhe,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAGuX,CAAC,GAAG,GAAG;QAC9B,IAAIiI,QAAQ,EAAE;UACV5d,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB;QACtD,CAAC,MAAM;UACHkI,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC;QACxB;MACJ,CAAC,MAAM;QACH,IAAIwf,QAAQ,EAAE;UACV5d,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC;QACxB,CAAC,MAAM;UACH4B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAGuX,CAAC;QAC5B;QACA3V,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB,GAAG,GAAG;MAC5D;MACA,OAAOkI,GAAG;IACd;;IAEA;IACA,IAAI4d,QAAQ,IAAIC,WAAW,IAAI,CAAC,CAAC,EAAE;MAC/B7d,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB,GAAG,GAAG;MACxDkI,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB,GAAG,GAAG;MACxD,OAAOkI,GAAG;IACd;;IAEA;IACA,IACI4d,QAAQ,IACRE,SAAS,GAAGD,WAAW,IACvB,IAAI,CAAC9U,MAAM,CAAC8U,WAAW,CAAC,CAACzf,GAAG,EAC9B;MACE4B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC2K,MAAM,CAAC8U,WAAW,CAAC,CAACzf,GAAG,CAAC,CAAC,CAAC;MACtD4B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC2K,MAAM,CAAC8U,WAAW,CAAC,CAACzf,GAAG,CAAC,CAAC,CAAC;MACtD,OAAO4B,GAAG;IACd,CAAC,MAAM,IACH,CAAC4d,QAAQ,IACTE,SAAS,GAAGD,WAAW,IACvB,IAAI,CAAC7U,OAAO,CAAC6U,WAAW,CAAC,CAACzf,GAAG,EAC/B;MACE4B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC4K,OAAO,CAAC6U,WAAW,CAAC,CAACzf,GAAG,CAAC,CAAC,CAAC;MACvD4B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC4K,OAAO,CAAC6U,WAAW,CAAC,CAACzf,GAAG,CAAC,CAAC,CAAC;MACvD,OAAO4B,GAAG;IACd;;IAEA;IACA,IAAI,IAAI,CAACge,UAAU,EAAE;MACjBhe,GAAG,CAAC,CAAC,CAAC,GACF,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAG,CAACyf,WAAW,GAAG,GAAG,KAAK,IAAI,CAACzb,IAAI,CAAC,CAAC,CAAC,GAAG0b,SAAS,CAAC;MAClE,IAAIF,QAAQ,EAAE;QACV5d,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB;MACtD,CAAC,MAAM;QACHkI,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACgE,IAAI,CAAC,CAAC,CAAC;MACvC;MACA,OAAOpC,GAAG;IACd;;IAEA;IACA,IAAI4d,QAAQ,EAAE;MACV5d,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAG2f,MAAM;IACjC,CAAC,MAAM;MACH/d,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACgE,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG2b,MAAM;IACpD;IACA/d,GAAG,CAAC,CAAC,CAAC,GACF,IAAI,CAAC5B,GAAG,CAAC,CAAC,CAAC,GACX,CAACyf,WAAW,GAAG,GAAG,IAAIlmB,SAAS,CAACK,gBAAgB,IAC/C,IAAI,CAACuH,WAAW,CAACya,YAAY,IAAI,CAAC,CAAC;IACxC,OAAOha,GAAG;EACd,CAAC;;EAED;EACAxB,UAAU,CAACtI,SAAS,CAACuY,WAAW,GAAG,YAAW;IAC1C,IAAI,CAACrQ,GAAG,CAAC,CAAC,CAAC,GACPzG,SAAS,CAACE,gBAAgB,GAC1BwgB,IAAI,CAAC4F,KAAK,CAAC,IAAI,CAAC7f,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACE,gBAAgB,CAAC;IACxD,IAAI,CAACuG,GAAG,CAAC,CAAC,CAAC,GACPzG,SAAS,CAACE,gBAAgB,GAC1BwgB,IAAI,CAAC4F,KAAK,CAAC,IAAI,CAAC7f,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACE,gBAAgB,CAAC;EAC5D,CAAC;;EAED;EACA2G,UAAU,CAACtI,SAAS,CAACgoB,KAAK,GAAG,UAASpJ,GAAG,EAAE;IACvC,IAAI,CAAC,IAAI,CAAC/W,OAAO,EAAE;MACf,IAAI,CAACA,OAAO,GAAG,EAAE;IACrB;IAEA,IAAI,CAACA,OAAO,CAAChI,IAAI,CAAC+e,GAAG,CAAC;IACtB,IAAI,IAAI,CAAC/W,OAAO,CAAC3I,MAAM,GAAGoJ,UAAU,CAAC2f,WAAW,EAAE;MAC9C,IAAI,CAACpgB,OAAO,CAAC+N,KAAK,EAAE;IACxB;IAEN,IAAG,IAAI,CAACxC,KAAK,CAACuL,WAAW,EAClB,IAAI,CAACvL,KAAK,CAACuL,WAAW,CAAC,IAAI,EAAEC,GAAG,CAAC;EACtC,CAAC;;EAED;EACAtW,UAAU,CAACtI,SAAS,CAAC0X,cAAc,GAAG,UAClCwQ,gBAAgB,EAChBC,gBAAgB,EAClB;IACE,IAAI,CAAC,IAAI,CAAC/U,KAAK,EAAE;MACb;IACJ;IACA,IAAI,CAACA,KAAK,CAACJ,kBAAkB,CAAC,UAAU,EAAE,CACtCkV,gBAAgB,EAChBC,gBAAgB,CACnB,CAAC;EACN,CAAC;EAED7f,UAAU,CAACtI,SAAS,CAACooB,SAAS,GAAG,UAASvZ,GAAG,EAAE;IAC3C,IAAIwZ,GAAG,GAAG,IAAIC,KAAK,EAAE;IACrBD,GAAG,CAAC7a,GAAG,GAAG/L,SAAS,CAACgE,gBAAgB,GAAGoJ,GAAG;IAC1CwZ,GAAG,CAACE,KAAK,GAAG,KAAK;IAEjB,IAAIvZ,IAAI,GAAG,IAAI;IACfqZ,GAAG,CAACvY,MAAM,GAAG,YAAW;MACpB,IAAI,CAACyY,KAAK,GAAG,IAAI;MACjBvZ,IAAI,CAAC0I,cAAc,CAAC,IAAI,CAAC;IAC7B,CAAC;IACD,OAAO2Q,GAAG;EACd,CAAC;;EAED;EACA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAOI;EACA/f,UAAU,CAACtI,SAAS,CAACwoB,YAAY,GAAG,UAAS5f,CAAC,EAAE;IAC5C,IAAI,CAAC,IAAI,CAACwK,KAAK,IAAI,CAAC,IAAI,CAACA,KAAK,CAACzC,mBAAmB,EAAE;MAChD;IACJ;IAEA,IAAI8X,IAAI,GAAG,IAAI,CAACrV,KAAK,CAACzC,mBAAmB;IAEzC,KAAK,IAAI/Q,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG6oB,IAAI,CAACvpB,MAAM,EAAE,EAAEU,CAAC,EAAE;MAClC,IAAIqY,CAAC,GAAGwQ,IAAI,CAAC7oB,CAAC,CAAC;MACf;MACA,IAAI,CAACgJ,CAAC,IAAIqP,CAAC,CAACyQ,oBAAoB,IAAI,IAAI,EAAE;QACtC;MACJ;;MAEA;MACAzQ,CAAC,CAACyQ,oBAAoB,GAAG9f,CAAC,GAAG,IAAI,GAAG,IAAI;IAC5C;EACJ,CAAC;;EAED;AACJ;AACA;AACA;EACIN,UAAU,CAACtI,SAAS,CAAC2oB,QAAQ,GAAG,UAASC,KAAK,EAAE;IAC5C,IAAI,CAACxV,KAAK,CAAC9B,QAAQ,EAAE;IACrB,IAAI,IAAI,CAACjI,WAAW,CAACwf,WAAW,KAAK,KAAK,IAAI,CAACD,KAAK,EAAE;MAClD;IACJ;IACA,IAAI,CAAC,IAAI,CAAC3c,KAAK,CAAC2Y,SAAS,EAAE;MACvB,IAAI,CAAC3Y,KAAK,CAAC2Y,SAAS,GAAG,IAAI;IAC/B,CAAC,MAAM;MACH,IAAI,CAAC3Y,KAAK,CAAC2Y,SAAS,GAAG,KAAK;IAChC;IACA,IAAI,CAAClN,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;EACnC,CAAC;;EAED;AACJ;AACA;AACA;;EAEIpP,UAAU,CAACtI,SAAS,CAAC8oB,GAAG,GAAG,UAASlgB,CAAC,EAAE;IACnC,IAAI,CAACwK,KAAK,CAAC9B,QAAQ,EAAE;IACrB,IAAI1I,CAAC,KAAKmP,SAAS,EAAE;MACjB,IAAI,CAAC9L,KAAK,CAAC8c,MAAM,GAAG,CAAC,IAAI,CAAC9c,KAAK,CAAC8c,MAAM;IAC1C,CAAC,MAAM;MACH,IAAI,CAAC9c,KAAK,CAAC8c,MAAM,GAAGngB,CAAC;IACzB;EACJ,CAAC;EAEDN,UAAU,CAACtI,SAAS,CAACgpB,aAAa,GAAG,UAAS5R,CAAC,EAAEG,CAAC,EAAErE,WAAW,EAAE;IAC7D,OAAO,CACH,CAACkE,CAAC,GAAG,IAAI,CAAClP,GAAG,CAAC,CAAC,CAAC,IAAIgL,WAAW,CAAC+V,KAAK,GAAG/V,WAAW,CAAC2U,MAAM,CAAC,CAAC,CAAC,EAC7D,CAACtQ,CAAC,GAAG,IAAI,CAACrP,GAAG,CAAC,CAAC,CAAC,IAAIgL,WAAW,CAAC+V,KAAK,GAAG/V,WAAW,CAAC2U,MAAM,CAAC,CAAC,CAAC,CAChE;EACL,CAAC;EAED,SAASzP,WAAW,CAAClY,KAAK,EAAE;IACxB,IAAI,CAACif,KAAK,CAACjf,KAAK,CAAC;EACrB;EAEAsB,MAAM,CAAC4W,WAAW,GAAG3W,SAAS,CAAC2W,WAAW,GAAGA,WAAW;EAExDA,WAAW,CAACpY,SAAS,CAACmf,KAAK,GAAG,UAASjf,KAAK,EAAE;IAC1C,IAAI,CAACA,KAAK,GAAGA,KAAK,IAAI,OAAO;IAC7B,IAAI,CAACqjB,SAAS,GAAG,EAAE;IACnB,IAAI,CAAC1E,KAAK,GAAG1L,YAAY,CAAC+V,WAAW,CAACC,SAAS,GACzChW,YAAY,CAAC+V,WAAW,CAACC,SAAS,CAACC,UAAU,GAC7C,MAAM;IACZ,IAAI,CAACC,SAAS,GAAG,IAAInK,YAAY,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;IACpD,IAAI,CAACD,IAAI,GAAG,IAAI,CAACoK,SAAS,CAACC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;IACzC,IAAI,CAACC,KAAK,GAAG,IAAI,CAACF,SAAS,CAACC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;IAC1C,IAAI,CAAC/X,MAAM,GAAG,EAAE;IAChB,IAAI,CAAC6B,KAAK,GAAG,IAAI;IAEjB5K,MAAM,CAACE,cAAc,CAAC,IAAI,EAAE,KAAK,EAAE;MAC/BC,GAAG,EAAE,aAASC,CAAC,EAAE;QACb,IAAI,CAACA,CAAC,IAAIA,CAAC,CAAC1J,MAAM,GAAG,CAAC,EAAE;UACpB;QACJ;QACA,IAAI,CAAC+f,IAAI,CAAC,CAAC,CAAC,GAAGrW,CAAC,CAAC,CAAC,CAAC;QACnB,IAAI,CAACqW,IAAI,CAAC,CAAC,CAAC,GAAGrW,CAAC,CAAC,CAAC,CAAC;MACvB,CAAC;MACDE,GAAG,EAAE,eAAW;QACZ,OAAO,IAAI,CAACmW,IAAI;MACpB,CAAC;MACDlW,UAAU,EAAE;IAChB,CAAC,CAAC;IAEFP,MAAM,CAACE,cAAc,CAAC,IAAI,EAAE,MAAM,EAAE;MAChCC,GAAG,EAAE,aAASC,CAAC,EAAE;QACb,IAAI,CAACA,CAAC,IAAIA,CAAC,CAAC1J,MAAM,GAAG,CAAC,EAAE;UACpB;QACJ;QACA,IAAI,CAACqqB,KAAK,CAAC,CAAC,CAAC,GAAGpH,IAAI,CAACmB,GAAG,CAAC,GAAG,EAAE1a,CAAC,CAAC,CAAC,CAAC,CAAC;QACnC,IAAI,CAAC2gB,KAAK,CAAC,CAAC,CAAC,GAAGpH,IAAI,CAACmB,GAAG,CAAC,EAAE,EAAE1a,CAAC,CAAC,CAAC,CAAC,CAAC;MACtC,CAAC;MACDE,GAAG,EAAE,eAAW;QACZ,OAAO,IAAI,CAACygB,KAAK;MACrB,CAAC;MACDxgB,UAAU,EAAE;IAChB,CAAC,CAAC;EACN,CAAC;EAEDqP,WAAW,CAACpY,SAAS,CAAC6Q,SAAS,GAAG,UAASH,CAAC,EAAE;IAC1C,IAAI,CAACxQ,KAAK,GAAGwQ,CAAC,CAACxQ,KAAK;IACpB,IAAI,CAACmpB,SAAS,CAAC1gB,GAAG,CAAC+H,CAAC,CAAC8Y,QAAQ,CAAC;IAC9B,IAAI,CAAC3K,KAAK,GAAGnO,CAAC,CAACmO,KAAK;IACpB,IAAI,CAAC4K,IAAI,GAAG/Y,CAAC,CAAC+Y,IAAI;EACtB,CAAC;EAEDrR,WAAW,CAACpY,SAAS,CAACqa,SAAS,GAAG,YAAW;IACzC,IAAI3N,CAAC,GAAG,IAAI,CAAC2c,SAAS;IACtB,OAAO;MACHnpB,KAAK,EAAE,IAAI,CAACA,KAAK;MACjBspB,QAAQ,EAAE,CACNrH,IAAI,CAAC4F,KAAK,CAACrb,CAAC,CAAC,CAAC,CAAC,CAAC,EAChByV,IAAI,CAAC4F,KAAK,CAACrb,CAAC,CAAC,CAAC,CAAC,CAAC,EAChByV,IAAI,CAAC4F,KAAK,CAACrb,CAAC,CAAC,CAAC,CAAC,CAAC,EAChByV,IAAI,CAAC4F,KAAK,CAACrb,CAAC,CAAC,CAAC,CAAC,CAAC,CACnB;MACDmS,KAAK,EAAE,IAAI,CAACA,KAAK;MACjB4K,IAAI,EAAE,IAAI,CAACA;IACf,CAAC;EACL,CAAC;EAEDrR,WAAW,CAACpY,SAAS,CAAC0pB,IAAI,GAAG,UAASC,MAAM,EAAEC,MAAM,EAAEC,YAAY,EAAE;IAChE,IAAI,CAAC5K,IAAI,CAAC,CAAC,CAAC,IAAI0K,MAAM;IACtB,IAAI,CAAC1K,IAAI,CAAC,CAAC,CAAC,IAAI2K,MAAM;IACtB,IAAIC,YAAY,EAAE;MACd;IACJ;IACA,KAAK,IAAIjqB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC2R,MAAM,CAACrS,MAAM,EAAE,EAAEU,CAAC,EAAE;MACzC,IAAIiM,IAAI,GAAG,IAAI,CAAC0F,MAAM,CAAC3R,CAAC,CAAC;MACzBiM,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,IAAIyhB,MAAM;MACrB9d,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,IAAI0hB,MAAM;IACzB;EACJ,CAAC;EAEDxR,WAAW,CAACpY,SAAS,CAAC8pB,oBAAoB,GAAG,YAAW;IACpD,IAAI,CAACvY,MAAM,CAACrS,MAAM,GAAG,CAAC;IACtB,IAAIiL,KAAK,GAAG,IAAI,CAACiJ,KAAK,CAAC7B,MAAM;IAC7B,IAAIwY,aAAa,GAAG,IAAI7K,YAAY,CAAC,CAAC,CAAC;IAEvC,KAAK,IAAItf,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuK,KAAK,CAACjL,MAAM,EAAE,EAAEU,CAAC,EAAE;MACnC,IAAIiM,IAAI,GAAG1B,KAAK,CAACvK,CAAC,CAAC;MACnBiM,IAAI,CAAC8Y,WAAW,CAACoF,aAAa,CAAC;MAC/B,IAAI,CAACC,eAAe,CAAC,IAAI,CAACX,SAAS,EAAEU,aAAa,CAAC,EAAE;QACjD;MACJ,CAAC,CAAC;MACF,IAAI,CAACxY,MAAM,CAAC1R,IAAI,CAACgM,IAAI,CAAC;IAC1B;EACJ,CAAC;EAEDuM,WAAW,CAACpY,SAAS,CAAC8Z,aAAa,GAAGxR,UAAU,CAACtI,SAAS,CAAC8Z,aAAa;EACxE1B,WAAW,CAACpY,SAAS,CAAC0X,cAAc,GAAGpP,UAAU,CAACtI,SAAS,CAAC0X,cAAc;;EAE1E;;EAEA;EACA,SAASuS,YAAY,CAACC,OAAO,EAAEC,WAAW,EAAE;IACxC,IAAI,CAACtC,MAAM,GAAG,IAAI3I,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACtC,IAAI,CAAC+J,KAAK,GAAG,CAAC;IACd,IAAI,CAACmB,SAAS,GAAG,EAAE;IACnB,IAAI,CAACC,SAAS,GAAG,GAAG;IACpB,IAAI,CAACC,QAAQ,GAAG,IAAI;IACpB,IAAI,CAACC,OAAO,GAAG,IAAI;IACnB,IAAI,CAACC,UAAU,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;IACxB,IAAI,CAACN,OAAO,GAAG,IAAI;IACnB,IAAI,CAACO,YAAY,GAAG,IAAIvL,YAAY,CAAC,CAAC,CAAC;IAEvC,IAAIgL,OAAO,EAAE;MACT,IAAI,CAACA,OAAO,GAAGA,OAAO;MACtB,IAAI,CAACC,WAAW,EAAE;QACd,IAAI,CAACO,UAAU,CAACR,OAAO,CAAC;MAC5B;IACJ;EACJ;EAEAzoB,SAAS,CAACwoB,YAAY,GAAGA,YAAY;EAErCA,YAAY,CAACjqB,SAAS,CAAC0qB,UAAU,GAAG,UAASR,OAAO,EAAE;IAClD,IAAI,CAACM,UAAU,GAAG,IAAItL,YAAY,CAAC,CAAC,CAAC;IAErC,IAAI,CAACyL,sBAAsB,GAAG,IAAI,CAACC,OAAO,CAACva,IAAI,CAAC,IAAI,CAAC;IAE3D5O,SAAS,CAACopB,kBAAkB,CAACX,OAAO,EAAC,MAAM,EAAE,IAAI,CAACS,sBAAsB,CAAC;IACzElpB,SAAS,CAACopB,kBAAkB,CAACX,OAAO,EAAC,MAAM,EAAE,IAAI,CAACS,sBAAsB,CAAC;IACzElpB,SAAS,CAACopB,kBAAkB,CAACX,OAAO,EAAC,IAAI,EAAE,IAAI,CAACS,sBAAsB,CAAC;IAEjET,OAAO,CAAC/L,gBAAgB,CACpB,YAAY,EACZ,IAAI,CAACwM,sBAAsB,EAC3B,KAAK,CACR;IACDT,OAAO,CAAC/L,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAACwM,sBAAsB,EAAE,KAAK,CAAC;EACzE,CAAC;EAEDV,YAAY,CAACjqB,SAAS,CAAC8qB,kBAAkB,GAAG,UAAUC,QAAQ,EAAG;IAC7D,IAAI,CAAC,IAAI,CAACb,OAAO,EAAE;MACf,IAAI,CAACO,YAAY,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,YAAY,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,YAAY,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC;MAC7F;IACJ;IACA,IAAIO,KAAK,GAAG,IAAI,CAACd,OAAO,CAACc,KAAK;IAC9B,IAAIC,MAAM,GAAG,IAAI,CAACf,OAAO,CAACe,MAAM;IAChC,IAAIC,MAAM,GAAG,CAAC,IAAI,CAACrD,MAAM,CAAC,CAAC,CAAC;IAC5B,IAAIsD,MAAM,GAAG,CAAC,IAAI,CAACtD,MAAM,CAAC,CAAC,CAAC;IAClC,IAAIkD,QAAQ,EACZ;MACCG,MAAM,IAAIH,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9B,KAAK;MAClCkC,MAAM,IAAIJ,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9B,KAAK;MAClC+B,KAAK,GAAGD,QAAQ,CAAC,CAAC,CAAC;MACnBE,MAAM,GAAGF,QAAQ,CAAC,CAAC,CAAC;IACrB;IACM,IAAIK,IAAI,GAAGF,MAAM,GAAGF,KAAK,GAAG,IAAI,CAAC/B,KAAK;IACtC,IAAIoC,IAAI,GAAGF,MAAM,GAAGF,MAAM,GAAG,IAAI,CAAChC,KAAK;IACvC,IAAI,CAACwB,YAAY,CAAC,CAAC,CAAC,GAAGS,MAAM;IAC7B,IAAI,CAACT,YAAY,CAAC,CAAC,CAAC,GAAGU,MAAM;IAC7B,IAAI,CAACV,YAAY,CAAC,CAAC,CAAC,GAAGW,IAAI,GAAGF,MAAM;IACpC,IAAI,CAACT,YAAY,CAAC,CAAC,CAAC,GAAGY,IAAI,GAAGF,MAAM;EACxC,CAAC;EAEDlB,YAAY,CAACjqB,SAAS,CAAC4qB,OAAO,GAAG,UAAStsB,CAAC,EAAE;IACzC,IAAI,CAAC,IAAI,CAACisB,OAAO,EAAE;MACf;IACJ;IAEA,IAAIvR,MAAM,GAAG,IAAI,CAACkR,OAAO;IACzB,IAAIoB,IAAI,GAAGtS,MAAM,CAACuS,qBAAqB,EAAE;IACzC,IAAInU,CAAC,GAAG9Y,CAAC,CAACktB,OAAO,GAAGF,IAAI,CAACG,IAAI;IAC7B,IAAIlU,CAAC,GAAGjZ,CAAC,CAACotB,OAAO,GAAGJ,IAAI,CAACK,GAAG;IAC5BrtB,CAAC,CAACstB,OAAO,GAAGxU,CAAC;IACb9Y,CAAC,CAACutB,OAAO,GAAGtU,CAAC;IACbjZ,CAAC,CAACwtB,QAAQ,GAAG,IAAI,CAACA,QAAQ;IAEhC,IAAIC,SAAS,GAAG,CAAC,IAAI,CAAChB,QAAQ,IAAM,IAAI,CAACA,QAAQ,IAAI3T,CAAC,IAAI,IAAI,CAAC2T,QAAQ,CAAC,CAAC,CAAC,IAAI3T,CAAC,GAAI,IAAI,CAAC2T,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,QAAQ,CAAC,CAAC,CAAE,IAAIxT,CAAC,IAAI,IAAI,CAACwT,QAAQ,CAAC,CAAC,CAAC,IAAIxT,CAAC,GAAI,IAAI,CAACwT,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,QAAQ,CAAC,CAAC,CAAI;;IAE/L;;IAEM,IAAIiB,MAAM,GAAG,KAAK;IAClB,IAAI,IAAI,CAACC,OAAO,EAAE;MACdD,MAAM,GAAG,IAAI,CAACC,OAAO,CAAC3tB,CAAC,CAAC;IAC5B;IAEA,IAAIA,CAAC,CAACqJ,IAAI,IAAIlG,SAAS,CAACgG,oBAAoB,GAAC,MAAM,IAAIskB,SAAS,EAAE;MAC9D,IAAI,CAACD,QAAQ,GAAG,IAAI;MAC7BrqB,SAAS,CAACyqB,qBAAqB,CAAClT,MAAM,EAAC,MAAM,EAAC,IAAI,CAAC2R,sBAAsB,CAAC;MAC1ElpB,SAAS,CAACopB,kBAAkB,CAAC3d,QAAQ,EAAC,MAAM,EAAC,IAAI,CAACyd,sBAAsB,CAAC;MACzElpB,SAAS,CAACopB,kBAAkB,CAAC3d,QAAQ,EAAC,IAAI,EAAC,IAAI,CAACyd,sBAAsB,CAAC;IAClE,CAAC,MAAM,IAAIrsB,CAAC,CAACqJ,IAAI,IAAIlG,SAAS,CAACgG,oBAAoB,GAAC,MAAM,EAAE;MACxD,IAAI,CAACukB,MAAM,EAAE;QACT,IAAIrC,MAAM,GAAGvS,CAAC,GAAG,IAAI,CAACoT,UAAU,CAAC,CAAC,CAAC;QACnC,IAAIZ,MAAM,GAAGrS,CAAC,GAAG,IAAI,CAACiT,UAAU,CAAC,CAAC,CAAC;QACnC,IAAI,IAAI,CAACsB,QAAQ,EAAE;UACf,IAAI,CAACK,SAAS,CAACxC,MAAM,EAAEC,MAAM,CAAC;QAClC;MACJ;IACJ,CAAC,MAAM,IAAItrB,CAAC,CAACqJ,IAAI,IAAIlG,SAAS,CAACgG,oBAAoB,GAAC,IAAI,EAAE;MACtD,IAAI,CAACqkB,QAAQ,GAAG,KAAK;MAC9BrqB,SAAS,CAACyqB,qBAAqB,CAAChf,QAAQ,EAAC,MAAM,EAAC,IAAI,CAACyd,sBAAsB,CAAC;MAC5ElpB,SAAS,CAACyqB,qBAAqB,CAAChf,QAAQ,EAAC,IAAI,EAAC,IAAI,CAACyd,sBAAsB,CAAC;MAC1ElpB,SAAS,CAACopB,kBAAkB,CAAC7R,MAAM,EAAC,MAAM,EAAC,IAAI,CAAC2R,sBAAsB,CAAC;IAClE,CAAC,MAAM,IAAKoB,SAAS,KAChBztB,CAAC,CAACqJ,IAAI,IAAI,YAAY,IACvBrJ,CAAC,CAACqJ,IAAI,IAAI,OAAO,IACjBrJ,CAAC,CAACqJ,IAAI,IAAI,gBAAgB,CAAC,EAC7B;MACErJ,CAAC,CAAC8tB,SAAS,GAAG,YAAY;MAC1B,IAAI9tB,CAAC,CAACqJ,IAAI,IAAI,OAAO,EAAE;QACnBrJ,CAAC,CAAC+tB,KAAK,GAAG,CAAC/tB,CAAC,CAACguB,MAAM;MACvB,CAAC,MAAM;QACHhuB,CAAC,CAAC+tB,KAAK,GACH/tB,CAAC,CAACiuB,WAAW,IAAI,IAAI,GAAGjuB,CAAC,CAACiuB,WAAW,GAAGjuB,CAAC,CAACkuB,MAAM,GAAG,CAAC,EAAE;MAC9D;;MAEA;MACAluB,CAAC,CAACmuB,KAAK,GAAGnuB,CAAC,CAACouB,UAAU,GAChBpuB,CAAC,CAACouB,UAAU,GAAG,EAAE,GACjBpuB,CAAC,CAACguB,MAAM,GACR,CAAChuB,CAAC,CAACguB,MAAM,GAAG,CAAC,GACb,CAAC;MACP,IAAI,CAACK,gBAAgB,CAAC,GAAG,GAAGruB,CAAC,CAACmuB,KAAK,GAAG,IAAI,CAAC;IAC/C;IAEA,IAAI,CAACjC,UAAU,CAAC,CAAC,CAAC,GAAGpT,CAAC;IACtB,IAAI,CAACoT,UAAU,CAAC,CAAC,CAAC,GAAGjT,CAAC;IAE5B,IAAGwU,SAAS,EACZ;MACOztB,CAAC,CAACsuB,cAAc,EAAE;MACrBtuB,CAAC,CAACuuB,eAAe,EAAE;MACnB,OAAO,KAAK;IAChB;EACE,CAAC;EAED5C,YAAY,CAACjqB,SAAS,CAAC8sB,eAAe,GAAG,UAASC,GAAG,EAAE;IACnDA,GAAG,CAAC9D,KAAK,CAAC,IAAI,CAACA,KAAK,EAAE,IAAI,CAACA,KAAK,CAAC;IACjC8D,GAAG,CAACC,SAAS,CAAC,IAAI,CAACnF,MAAM,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,MAAM,CAAC,CAAC,CAAC,CAAC;EACjD,CAAC;EAEDoC,YAAY,CAACjqB,SAAS,CAACitB,qBAAqB,GAAG,UAAS/kB,GAAG,EAAE;IACzD;IACA,OAAO,CACH,CAACA,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC2f,MAAM,CAAC,CAAC,CAAC,IAAI,IAAI,CAACoB,KAAK,EACtC,CAAC/gB,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC2f,MAAM,CAAC,CAAC,CAAC,IAAI,IAAI,CAACoB,KAAK,CACzC;EACL,CAAC;EAEDgB,YAAY,CAACjqB,SAAS,CAACktB,qBAAqB,GAAG,UAAShlB,GAAG,EAAE4B,GAAG,EAAE;IAC9DA,GAAG,GAAGA,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;IACnBA,GAAG,CAAC,CAAC,CAAC,GAAG5B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC+gB,KAAK,GAAG,IAAI,CAACpB,MAAM,CAAC,CAAC,CAAC;IAC7C/d,GAAG,CAAC,CAAC,CAAC,GAAG5B,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC+gB,KAAK,GAAG,IAAI,CAACpB,MAAM,CAAC,CAAC,CAAC;IAC7C,OAAO/d,GAAG;EACd,CAAC;EAEDmgB,YAAY,CAACjqB,SAAS,CAACmsB,SAAS,GAAG,UAAS/U,CAAC,EAAEG,CAAC,EAAE;IAC9C,IAAI,CAACsQ,MAAM,CAAC,CAAC,CAAC,IAAIzQ,CAAC,GAAG,IAAI,CAAC6R,KAAK;IAChC,IAAI,CAACpB,MAAM,CAAC,CAAC,CAAC,IAAItQ,CAAC,GAAG,IAAI,CAAC0R,KAAK;IAEhC,IAAI,IAAI,CAACqB,QAAQ,EAAE;MACf,IAAI,CAACA,QAAQ,CAAC,IAAI,CAAC;IACvB;EACJ,CAAC;EAEDL,YAAY,CAACjqB,SAAS,CAACmtB,WAAW,GAAG,UAASrS,KAAK,EAAEsS,cAAc,EAAE;IACjE,IAAItS,KAAK,GAAG,IAAI,CAACuP,SAAS,EAAE;MACxBvP,KAAK,GAAG,IAAI,CAACuP,SAAS;IAC1B,CAAC,MAAM,IAAIvP,KAAK,GAAG,IAAI,CAACsP,SAAS,EAAE;MAC/BtP,KAAK,GAAG,IAAI,CAACsP,SAAS;IAC1B;IAEA,IAAItP,KAAK,IAAI,IAAI,CAACmO,KAAK,EAAE;MACrB;IACJ;IAEA,IAAI,CAAC,IAAI,CAACiB,OAAO,EAAE;MACf;IACJ;IAEA,IAAIoB,IAAI,GAAG,IAAI,CAACpB,OAAO,CAACqB,qBAAqB,EAAE;IAC/C,IAAI,CAACD,IAAI,EAAE;MACP;IACJ;IAEA8B,cAAc,GAAGA,cAAc,IAAI,CAC/B9B,IAAI,CAACN,KAAK,GAAG,GAAG,EAChBM,IAAI,CAACL,MAAM,GAAG,GAAG,CACpB;IACD,IAAIoC,MAAM,GAAG,IAAI,CAACH,qBAAqB,CAACE,cAAc,CAAC;IACvD,IAAI,CAACnE,KAAK,GAAGnO,KAAK;IAClB,IAAIqH,IAAI,CAACmL,GAAG,CAAC,IAAI,CAACrE,KAAK,GAAG,CAAC,CAAC,GAAG,IAAI,EAAE;MACjC,IAAI,CAACA,KAAK,GAAG,CAAC;IAClB;IAEA,IAAIsE,UAAU,GAAG,IAAI,CAACL,qBAAqB,CAACE,cAAc,CAAC;IAC3D,IAAII,YAAY,GAAG,CACfD,UAAU,CAAC,CAAC,CAAC,GAAGF,MAAM,CAAC,CAAC,CAAC,EACzBE,UAAU,CAAC,CAAC,CAAC,GAAGF,MAAM,CAAC,CAAC,CAAC,CAC5B;IAED,IAAI,CAACxF,MAAM,CAAC,CAAC,CAAC,IAAI2F,YAAY,CAAC,CAAC,CAAC;IACjC,IAAI,CAAC3F,MAAM,CAAC,CAAC,CAAC,IAAI2F,YAAY,CAAC,CAAC,CAAC;IAEjC,IAAI,IAAI,CAAClD,QAAQ,EAAE;MACf,IAAI,CAACA,QAAQ,CAAC,IAAI,CAAC;IACvB;EACJ,CAAC;EAEDL,YAAY,CAACjqB,SAAS,CAAC2sB,gBAAgB,GAAG,UAAS7R,KAAK,EAAEsS,cAAc,EAAE;IACtE,IAAI,CAACD,WAAW,CAAC,IAAI,CAAClE,KAAK,GAAGnO,KAAK,EAAEsS,cAAc,CAAC;EACxD,CAAC;EAEDnD,YAAY,CAACjqB,SAAS,CAACytB,KAAK,GAAG,YAAW;IACtC,IAAI,CAACxE,KAAK,GAAG,CAAC;IACd,IAAI,CAACpB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC;IAClB,IAAI,CAACA,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC;EACtB,CAAC;;EAED;EACA;EACA;;EAEA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,SAAS1U,YAAY,CAAC6F,MAAM,EAAE5F,KAAK,EAAExH,OAAO,EAAE;IAC1C,IAAI,CAACA,OAAO,GAAGA,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;;IAEtC;IACA;IACA,IAAI,CAAC8hB,gBAAgB,GAAGva,YAAY,CAACwa,wBAAwB;IAE7D,IAAI3U,MAAM,IAAIA,MAAM,CAAC3P,WAAW,KAAKC,MAAM,EAAE;MACzC0P,MAAM,GAAG9L,QAAQ,CAAC0gB,aAAa,CAAC5U,MAAM,CAAC;IAC3C;IAEA,IAAI,CAAC6U,EAAE,GAAG,IAAI5D,YAAY,EAAE;IAC5B,IAAI,CAAC6D,iBAAiB,GAAG,IAAI,CAAC,CAAC;;IAE/B,IAAI,CAACC,eAAe,GAAG,EAAE,GAAGtsB,SAAS,CAACa,cAAc,GAAG,UAAU;IACjE,IAAI,CAAC0rB,eAAe,GAChB,SAAS,GAAGvsB,SAAS,CAACe,iBAAiB,GAAG,UAAU;IACxD,IAAI,CAACyrB,gBAAgB,GAAGxsB,SAAS,CAACW,gBAAgB;IAClD,IAAI,CAAC8rB,kBAAkB,GAAGzsB,SAAS,CAAC2B,UAAU;IAC9C,IAAI,CAAC+qB,wBAAwB,GAAG;MAC5BC,SAAS,EAAE,MAAM;MACjBC,QAAQ,EAAE,MAAM;MAAE;MAClBC,UAAU,EAAE,MAAM;MAClBC,SAAS,EAAE,MAAM,CAAC;IAC5B,CAAC;;IACK,IAAI,CAACC,+BAA+B,GAAG;MACnC;AACZ;AACA;IAFY,CAGH;IACD,IAAI,CAACC,kCAAkC,GAAG;MACtC;AACZ;AACA;IAFY,CAGH;IAED,IAAI,CAACC,kBAAkB,GAAG,IAAI;IAC9B,IAAI,CAACC,aAAa,GAAG,KAAK,CAAC,CAAC;IAC5B,IAAI,CAACC,YAAY,GAAG,CAAC,CAAC,CAAC;IACvB,IAAI,CAACC,eAAe,GAAG,KAAK;IAC5B,IAAI,CAACC,gBAAgB,GAAG,IAAI;IAElC,IAAI,CAACC,SAAS,GAAG,KAAK,CAAC,CAAC;IAClB,IAAI,CAACC,oBAAoB,GAAG,IAAI;IAChC,IAAI,CAACpS,SAAS,GAAG,KAAK;IACtB,IAAI,CAACqS,SAAS,GAAG,IAAI;IACrB,IAAI,CAACC,gBAAgB,GAAG,IAAI;IAC5B,IAAI,CAACC,eAAe,GAAG,IAAI;IAC3B,IAAI,CAACC,iBAAiB,GAAG,IAAI,CAAC,CAAC;IAC/B,IAAI,CAACC,eAAe,GAAG,IAAI;IAC3B,IAAI,CAACC,qBAAqB,GAAG,IAAI,CAAC,CAAC;IACzC,IAAI,CAAChX,aAAa,GAAG,KAAK,CAAC,CAAC;;IAEtB,IAAI,CAACiX,SAAS,GAAG,KAAK;IACtB,IAAI,CAACC,kBAAkB,GAAG,IAAI;IAE9B,IAAI,CAAChjB,MAAM,GAAG,IAAI,CAAC,CAAC;;IAE1B,IAAI,CAACijB,+BAA+B,GAAG,IAAI,CAAC,CAAC;IACvC,IAAI,CAACC,wBAAwB,GAAG,KAAK;IACrC,IAAI,CAACC,cAAc,GAAG,IAAI;IAC1B,IAAI,CAACC,oBAAoB,GAAG,IAAI;IAChC,IAAI,CAACC,0BAA0B,GAAG,KAAK,CAAC,CAAC;IACzC,IAAI,CAACC,yBAAyB,GAAG,IAAI;IACrC,IAAI,CAACC,yBAAyB,GAAG,KAAK;IACtC,IAAI,CAACC,wBAAwB,GAAG,KAAK;IACrC,IAAI,CAACC,sBAAsB,GAAG,IAAI;IAClC,IAAI,CAACC,sBAAsB,GAAG,KAAK;IACnC,IAAI,CAACC,oBAAoB,GAAG,IAAI;IACtC,IAAI,CAACC,mBAAmB,GAAG,IAAI;IAEzB,IAAI,CAACC,iBAAiB,GAAG5uB,SAAS,CAACyD,WAAW;IAE9C,IAAI,CAACorB,KAAK,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACrB,IAAI,CAACC,WAAW,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACjC,IAAI,CAACC,YAAY,GAAG,IAAI,CAACD,WAAW,CAAC,CAAC;;IAEhC;IACA,IAAI,CAACE,WAAW,GAAG,IAAI;IACvB,IAAI,CAACC,oBAAoB,GAAG,IAAI;;IAEhC;IACA,IAAI,CAAC9F,OAAO,GAAG,IAAI;IACnB,IAAI,CAAC+F,gBAAgB,GAAG,IAAI,CAAC,CAAC;IAC9B,IAAI,CAACC,gBAAgB,GAAG,IAAI,CAAC,CAAC;IAC9B,IAAI,CAACC,aAAa,GAAG,IAAI,CAAC,CAAC;IACjC,IAAI,CAACC,iBAAiB,GAAG,IAAI,CAAC,CAAC;IAC/B,IAAI,CAACC,WAAW,GAAG,IAAI,CAAC,CAAC;IACzB,IAAI,CAACC,iBAAiB,GAAG,IAAI,CAAC,CAAC;IAC/B,IAAI,CAACC,kBAAkB,GAAG,IAAI,CAAC,CAAC;IAChC,IAAI,CAAC3U,cAAc,GAAG,IAAI,CAAC,CAAC;IAC5B,IAAI,CAACC,aAAa,GAAG,IAAI,CAAC,CAAC;;IAErB,IAAI,CAAC2U,iBAAiB,GAAG,CAAC;IAC1B,IAAI,CAACC,YAAY,GAAG,CAAC;IAErB,IAAI,CAACC,YAAY,GAAG,IAAI;IACxB,IAAI,CAACC,WAAW,GAAG,IAAI,CAAC,CAAC;IAC/B,IAAI,CAACC,gBAAgB,GAAG,IAAI;IACtB,IAAI,CAACC,mBAAmB,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;IACjC,IAAI,CAAC9G,YAAY,GAAG,IAAI,CAACoD,EAAE,CAACpD,YAAY;IACxC,IAAI,CAAC+G,aAAa,GAAG,EAAE;IAE7B,IAAI,CAACzG,QAAQ,GAAGnf,OAAO,CAACmf,QAAQ,IAAI,IAAI,CAAC,CAAC;;IAEpC;IACA,IAAI3X,KAAK,EAAE;MACPA,KAAK,CAACH,YAAY,CAAC,IAAI,CAAC;IAC5B;IAEA,IAAI,CAACwe,SAAS,CAACzY,MAAM,EAACpN,OAAO,CAACue,WAAW,CAAC;IAC1C,IAAI,CAACvZ,KAAK,EAAE;IAEZ,IAAI,CAAChF,OAAO,CAAC8lB,WAAW,EAAE;MACtB,IAAI,CAACC,cAAc,EAAE;IACzB;IAEA,IAAI,CAACC,UAAU,GAAGhmB,OAAO,CAACgmB,UAAU;EACxC;EAEApwB,MAAM,CAAC2R,YAAY,GAAG1R,SAAS,CAAC0R,YAAY,GAAGA,YAAY;EAE9DA,YAAY,CAACwa,wBAAwB,GAAG,4eAA4e;EAEjhBxa,YAAY,CAAC0e,gBAAgB,GAAG;IAC5B,IAAI,EAAEpwB,SAAS,CAAC4B,gBAAgB;IAChCyuB,MAAM,EAAE,MAAM;IACdjmB,IAAI,EAAE;EACV,CAAC;EACDsH,YAAY,CAAC4e,SAAS,GAAG,CAAC,CAAC,CAAC,CAAC;;EAE7B;AACJ;AACA;AACA;AACA;EACI5e,YAAY,CAACnT,SAAS,CAAC4Q,KAAK,GAAG,YAAW;IACtC,IAAI,CAACohB,KAAK,GAAG,CAAC;IACd,IAAI,CAACC,cAAc,GAAG,CAAC;IACvB,IAAI,CAACC,WAAW,GAAG,CAAC;IACpB,IAAI,CAACC,GAAG,GAAG,CAAC;;IAEZ;IACA;;IAEA,IAAI,CAAC3C,kBAAkB,GAAG,IAAI;IAE9B,IAAI,CAACvW,cAAc,GAAG,CAAC,CAAC;IACxB,IAAI,CAACmZ,cAAc,GAAG,IAAI;IAE1B,IAAI,CAACC,aAAa,GAAG,EAAE;IACvB,IAAI,CAACnZ,YAAY,GAAG,IAAI;IACxB,IAAI,CAACoZ,SAAS,GAAG,IAAI;IACrB,IAAI,CAAC5J,oBAAoB,GAAG,IAAI;IAChC,IAAI,CAAC6J,eAAe,GAAG,IAAI;IAC3B,IAAI,CAACC,iBAAiB,GAAG,CAAC,CAAC;IAEjC,IAAI,CAACC,eAAe,GAAG,KAAK;IAEtB,IAAI,CAACC,YAAY,GAAG,IAAI;IACxB,IAAI,CAACC,cAAc,GAAG,IAAI;IAC1B,IAAI,CAACC,UAAU,GAAG,IAAI;IAEtB,IAAI,CAACC,aAAa,GAAG,IAAI;IACzB,IAAI,CAACxB,WAAW,GAAG,IAAI;IAEvB,IAAI,CAAC7G,UAAU,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;IACxB,IAAI,CAACsI,eAAe,GAAG,CAAC;IAC5B,IAAI,CAACC,eAAe,GAAG,KAAK;IAC5B,IAAI,CAACC,iBAAiB,GAAG,KAAK;IAC1B,IAAI,CAACvI,YAAY,CAAC9hB,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAEnC,IAAI,IAAI,CAACsqB,OAAO,EAAE;MACd,IAAI,CAACA,OAAO,EAAE;IAClB;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACI9f,YAAY,CAACnT,SAAS,CAACkzB,QAAQ,GAAG,UAAS9f,KAAK,EAAE+f,UAAU,EAAE;IAC1D,IAAI,IAAI,CAAC/f,KAAK,IAAIA,KAAK,EAAE;MACrB;IACJ;IAEA,IAAI,CAAC+f,UAAU,EAAE;MACb,IAAI,CAACviB,KAAK,EAAE;IAChB;IAEA,IAAI,CAACwC,KAAK,IAAI,IAAI,CAACA,KAAK,EAAE;MACtB,IAAI,CAACA,KAAK,CAACC,YAAY,CAAC,IAAI,CAAC;MAC7B;IACJ;IAEAD,KAAK,CAACH,YAAY,CAAC,IAAI,CAAC;;IAE9B;IACA,IAAI,IAAI,CAACmgB,YAAY,EACpB,IAAI,CAACA,YAAY,GAAG,IAAI;IAEnB,IAAI,CAACC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC;EAC7B,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACClgB,YAAY,CAACnT,SAAS,CAACszB,WAAW,GAAG,YACrC;IACC,IAAG,IAAI,CAACF,YAAY,CAACl0B,MAAM,EAC1B,OAAO,IAAI,CAACk0B,YAAY,CAAC,CAAC,CAAC;IAC5B,OAAO,IAAI,CAAChgB,KAAK;EAClB,CAAC;;EAEE;AACJ;AACA;AACA;AACA;AACA;EACID,YAAY,CAACnT,SAAS,CAACuzB,YAAY,GAAG,UAASngB,KAAK,EAAE;IAClD,IAAI,CAACA,KAAK,EAAE;MACR,MAAM,sBAAsB;IAChC;IAEA,IAAI,IAAI,CAACA,KAAK,IAAIA,KAAK,EAAE;MACrB,MAAM,0BAA0B;IACpC;IAEA,IAAI,CAACxC,KAAK,EAAE;IAEZ,IAAI,IAAI,CAACwC,KAAK,EAAE;MACZ,IAAI,CAAC,IAAI,CAACggB,YAAY,EAAE;QACpB,IAAI,CAACA,YAAY,GAAG,EAAE;MAC1B;MACA,IAAI,CAACA,YAAY,CAACvzB,IAAI,CAAC,IAAI,CAACuT,KAAK,CAAC;IACtC;IAEAA,KAAK,CAACH,YAAY,CAAC,IAAI,CAAC;IAC9B,IAAI,CAACugB,WAAW,EAAE;IACZ,IAAI,CAACH,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC;EAC7B,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIlgB,YAAY,CAACnT,SAAS,CAACyzB,aAAa,GAAG,YAAW;IAC9C,IAAI,CAAC,IAAI,CAACL,YAAY,IAAI,IAAI,CAACA,YAAY,CAACl0B,MAAM,IAAI,CAAC,EAAE;MACrD;IACJ;IACA,IAAIw0B,aAAa,GAAG,IAAI,CAACtgB,KAAK,CAACugB,cAAc;IAC7C,IAAIvgB,KAAK,GAAG,IAAI,CAACggB,YAAY,CAACjoB,GAAG,EAAE;IACnC,IAAI,CAAC8N,cAAc,GAAG,CAAC,CAAC;IACxB,IAAI,CAACuZ,iBAAiB,GAAG,CAAC,CAAC;IAC3Bpf,KAAK,CAACH,YAAY,CAAC,IAAI,CAAC;IACxB,IAAI,CAACogB,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC;IACzB,IAAIK,aAAa,EAAE;MACf,IAAI,CAACE,YAAY,CAACF,aAAa,CAAC;MAChC,IAAI,CAACG,WAAW,CAAC,CAACH,aAAa,CAAC,CAAC;IACrC;IACA;IACA,IAAI,CAAC7F,EAAE,CAAChG,MAAM,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;IACvB,IAAI,CAACgG,EAAE,CAAC5E,KAAK,GAAG,CAAC;EACrB,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACI9V,YAAY,CAACnT,SAAS,CAAC8zB,eAAe,GAAG,YAAW;IAChD,OAAO,IAAI,CAAC1gB,KAAK;EACrB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACID,YAAY,CAACnT,SAAS,CAACyxB,SAAS,GAAG,UAASzY,MAAM,EAAEmR,WAAW,EAAE;IAC7D,IAAInb,IAAI,GAAG,IAAI;IAEf,IAAIgK,MAAM,EAAE;MACR,IAAIA,MAAM,CAAC3P,WAAW,KAAKC,MAAM,EAAE;QAC/B0P,MAAM,GAAG9L,QAAQ,CAAC6mB,cAAc,CAAC/a,MAAM,CAAC;QACxC,IAAI,CAACA,MAAM,EAAE;UACT,MAAM,mDAAmD;QAC7D;MACJ;IACJ;IAEA,IAAIA,MAAM,KAAK,IAAI,CAACA,MAAM,EAAE;MACxB;IACJ;IAEA,IAAI,CAACA,MAAM,IAAI,IAAI,CAACA,MAAM,EAAE;MACxB;MACA,IAAI,CAACmR,WAAW,EAAE;QACd,IAAI,CAAC6J,YAAY,EAAE;MACvB;IACJ;IAEA,IAAI,CAAChb,MAAM,GAAGA,MAAM;IACpB,IAAI,CAAC6U,EAAE,CAAC3D,OAAO,GAAGlR,MAAM;IAExB,IAAI,CAACA,MAAM,EAAE;MACT;IACJ;;IAEA;IACAA,MAAM,CAACib,SAAS,IAAI,eAAe;IACnCjb,MAAM,CAACrK,IAAI,GAAG,IAAI;IAClBqK,MAAM,CAACkb,QAAQ,GAAG,GAAG,CAAC,CAAC;;IAEvB;IACA,IAAI,CAACC,QAAQ,GAAG,IAAI;IACpB,IAAI,CAAC,IAAI,CAACA,QAAQ,EAAE;MAChB,IAAI,CAACA,QAAQ,GAAGjnB,QAAQ,CAACQ,aAAa,CAAC,QAAQ,CAAC;MAChD,IAAI,CAACymB,QAAQ,CAACnJ,KAAK,GAAG,IAAI,CAAChS,MAAM,CAACgS,KAAK;MACvC,IAAI,CAACmJ,QAAQ,CAAClJ,MAAM,GAAG,IAAI,CAACjS,MAAM,CAACiS,MAAM;IAC7C;IAEA,IAAIjS,MAAM,CAACob,UAAU,IAAI,IAAI,EAAE;MAC3B,IAAIpb,MAAM,CAACqb,SAAS,IAAI,QAAQ,EAAE;QAC9B,MAAM,6EAA6E,GAC/Erb,MAAM,CAACqb,SAAS;MACxB;MACA,MAAM,qCAAqC;IAC/C;IAEA,IAAItH,GAAG,GAAI,IAAI,CAACA,GAAG,GAAG/T,MAAM,CAACob,UAAU,CAAC,IAAI,CAAE;IAC9C,IAAIrH,GAAG,IAAI,IAAI,EAAE;MACb,IAAI,CAAC/T,MAAM,CAACsb,aAAa,EAAE;QACvBzsB,OAAO,CAACqB,IAAI,CACR,wDAAwD,CAC3D;MACL;MACA,IAAI,CAACqrB,WAAW,EAAE;IACtB;;IAEA;IACA;IACA;;IAEA,IAAI,CAACpK,WAAW,EAAE;MACd,IAAI,CAACO,UAAU,EAAE;IACrB;EACJ,CAAC;;EAED;EACAvX,YAAY,CAACnT,SAAS,CAACw0B,UAAU,GAAG,SAASC,SAAS,CAACn2B,CAAC,EAAE;IACzD;IACGA,CAAC,CAACsuB,cAAc,EAAE;IAClB,OAAO,KAAK;EAChB,CAAC;EACDzZ,YAAY,CAACnT,SAAS,CAAC00B,aAAa,GAAG,SAASD,SAAS,CAACn2B,CAAC,EAAE;IACzDA,CAAC,CAACsuB,cAAc,EAAE;IAClB,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;EACIzZ,YAAY,CAACnT,SAAS,CAAC0qB,UAAU,GAAG,YAAW;IAC3C,IAAI,IAAI,CAACiK,cAAc,EAAE;MACrB9sB,OAAO,CAACqB,IAAI,CAAC,qCAAqC,CAAC;MACnD;IACJ;;IAEA;;IAEA,IAAI8P,MAAM,GAAG,IAAI,CAACA,MAAM;IAExB,IAAI4b,UAAU,GAAG,IAAI,CAACC,eAAe,EAAE;IACvC,IAAI3nB,QAAQ,GAAG0nB,UAAU,CAAC1nB,QAAQ,CAAC,CAAC;;IAEpC,IAAI,CAAC4nB,mBAAmB,GAAG,IAAI,CAACC,gBAAgB,CAAC1kB,IAAI,CAAC,IAAI,CAAC;IAC3D,IAAI,CAAC2kB,oBAAoB,GAAG,IAAI,CAACC,iBAAiB,CAAC5kB,IAAI,CAAC,IAAI,CAAC;IAC7D;IACA,IAAI,CAAC6kB,mBAAmB,GAAG,IAAI,CAACC,gBAAgB,CAAC9kB,IAAI,CAAC,IAAI,CAAC;IAC3D,IAAI,CAAC+kB,iBAAiB,GAAG,IAAI,CAACC,cAAc,CAAChlB,IAAI,CAAC,IAAI,CAAC;;IAEvD;IACA;;IAEN5O,SAAS,CAACopB,kBAAkB,CAAC7R,MAAM,EAAC,MAAM,EAAE,IAAI,CAAC8b,mBAAmB,EAAE,IAAI,CAAC,CAAC,CAAC;IACvE9b,MAAM,CAACmF,gBAAgB,CAAC,YAAY,EAAE,IAAI,CAAC6W,oBAAoB,EAAE,KAAK,CAAC;IAEvEvzB,SAAS,CAACopB,kBAAkB,CAAC7R,MAAM,EAAC,IAAI,EAAE,IAAI,CAACoc,iBAAiB,EAAE,IAAI,CAAC,CAAC,CAAC;IAC/E3zB,SAAS,CAACopB,kBAAkB,CAAC7R,MAAM,EAAC,MAAM,EAAE,IAAI,CAACkc,mBAAmB,CAAC;IAE/Dlc,MAAM,CAACmF,gBAAgB,CAAC,aAAa,EAAE,IAAI,CAACqW,UAAU,CAAC;IACvDxb,MAAM,CAACmF,gBAAgB,CACnB,gBAAgB,EAChB,IAAI,CAAC6W,oBAAoB,EACzB,KAAK,CACR;;IAED;IACA;AACR;AACA;AACA;AACA;AACA;AACA;;IAEQ;IACA,IAAI,CAACM,aAAa,GAAG,IAAI,CAACC,UAAU,CAACllB,IAAI,CAAC,IAAI,CAAC;IAE/C2I,MAAM,CAACmF,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAACmX,aAAa,EAAE,IAAI,CAAC;IAC5DpoB,QAAQ,CAACiR,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAACmX,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC;;IAE9D;IACA,IAAI,CAACE,gBAAgB,GAAG,IAAI,CAACC,WAAW,CAACplB,IAAI,CAAC,IAAI,CAAC;IAEnD2I,MAAM,CAACmF,gBAAgB,CAAC,UAAU,EAAE,IAAI,CAACqW,UAAU,EAAE,KAAK,CAAC;IAC3Dxb,MAAM,CAACmF,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAACqW,UAAU,EAAE,KAAK,CAAC;IAC1Dxb,MAAM,CAACmF,gBAAgB,CAAC,MAAM,EAAE,IAAI,CAACqX,gBAAgB,EAAE,KAAK,CAAC;IAC7Dxc,MAAM,CAACmF,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAACuW,aAAa,EAAE,KAAK,CAAC;IAE/D,IAAI,CAACC,cAAc,GAAG,IAAI;EAC9B,CAAC;;EAED;AACJ;AACA;AACA;EACIxhB,YAAY,CAACnT,SAAS,CAACg0B,YAAY,GAAG,YAAW;IAC7C,IAAI,CAAC,IAAI,CAACW,cAAc,EAAE;MACtB9sB,OAAO,CAACqB,IAAI,CAAC,gCAAgC,CAAC;MAC9C;IACJ;;IAEA;;IAEA,IAAI0rB,UAAU,GAAG,IAAI,CAACC,eAAe,EAAE;IACvC,IAAI3nB,QAAQ,GAAG0nB,UAAU,CAAC1nB,QAAQ;IAExCzL,SAAS,CAACyqB,qBAAqB,CAAC,IAAI,CAAClT,MAAM,EAAC,MAAM,EAAE,IAAI,CAAC8b,mBAAmB,CAAC;IACvErzB,SAAS,CAACyqB,qBAAqB,CAAC,IAAI,CAAClT,MAAM,EAAC,IAAI,EAAE,IAAI,CAAC8b,mBAAmB,CAAC;IAC3ErzB,SAAS,CAACyqB,qBAAqB,CAAC,IAAI,CAAClT,MAAM,EAAC,MAAM,EAAE,IAAI,CAAC8b,mBAAmB,CAAC;IAC7E,IAAI,CAAC9b,MAAM,CAAC0c,mBAAmB,CAC3B,YAAY,EACZ,IAAI,CAACV,oBAAoB,CAC5B;IACD,IAAI,CAAChc,MAAM,CAAC0c,mBAAmB,CAC3B,gBAAgB,EAChB,IAAI,CAACV,oBAAoB,CAC5B;IACD,IAAI,CAAChc,MAAM,CAAC0c,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAACJ,aAAa,CAAC;IAC9DpoB,QAAQ,CAACwoB,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAACJ,aAAa,CAAC;IACzD,IAAI,CAACtc,MAAM,CAAC0c,mBAAmB,CAAC,aAAa,EAAE,IAAI,CAAClB,UAAU,CAAC;IAC/D,IAAI,CAACxb,MAAM,CAAC0c,mBAAmB,CAAC,MAAM,EAAE,IAAI,CAACF,gBAAgB,CAAC;IAC9D,IAAI,CAACxc,MAAM,CAAC0c,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAChB,aAAa,CAAC;;IAEhE;IACA;AACR;AACA;AACA;;IAEQ,IAAI,CAACI,mBAAmB,GAAG,IAAI;IAC/B,IAAI,CAACE,oBAAoB,GAAG,IAAI;IAChC,IAAI,CAACM,aAAa,GAAG,IAAI;IACzB,IAAI,CAACE,gBAAgB,GAAG,IAAI;IAE5B,IAAI,CAACb,cAAc,GAAG,KAAK;EAC/B,CAAC;EAEDxhB,YAAY,CAACwiB,gBAAgB,GAAG,UAAS9mB,GAAG,EAAE;IAC1C,IAAI+mB,QAAQ,GAAG/mB,GAAG,CAACT,OAAO,CAAC,GAAG,CAAC;IAC/B,IAAIwnB,QAAQ,IAAI,CAAC,CAAC,EAAE;MAChB/mB,GAAG,GAAGA,GAAG,CAACxG,MAAM,CAAC,CAAC,EAAEutB,QAAQ,CAAC;IACjC;IACA,IAAIC,KAAK,GAAGhnB,GAAG,CAAC1G,WAAW,CAAC,GAAG,CAAC;IAChC,IAAI0tB,KAAK,IAAI,CAAC,CAAC,EAAE;MACb,OAAO,EAAE;IACb;IACA,OAAOhnB,GAAG,CAACxG,MAAM,CAACwtB,KAAK,GAAG,CAAC,CAAC,CAACtsB,WAAW,EAAE;EAC9C,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACI4J,YAAY,CAACnT,SAAS,CAACu0B,WAAW,GAAG,YAAW;IAC5C,IAAI,QAAOuB,EAAE,yCAAFA,EAAE,OAAK/d,SAAS,EAAE;MACzB,MAAM,kDAAkD;IAC5D;IACA,IAAI,QAAOge,iBAAiB,yCAAjBA,iBAAiB,OAAKhe,SAAS,EAAE;MACxC,MAAM,qDAAqD;IAC/D;IAEA,IAAI,CAACie,EAAE,GAAG,IAAI,CAACjJ,GAAG,GAAGgJ,iBAAiB,CAAC,IAAI,CAAC/c,MAAM,CAAC;IACnD,IAAI,CAAC+T,GAAG,CAACkJ,KAAK,GAAG,IAAI;IACrB,IAAI,CAAC9B,QAAQ,GAAG,IAAI,CAACnb,MAAM;IAC3B,IAAI,CAACkd,KAAK,GAAG,IAAI,CAACF,EAAE;IACpB,IAAI,CAAChd,MAAM,CAACsb,aAAa,GAAG,IAAI;;IAEhC;AACR;AACA;AACA;AACA;EACI,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACInhB,YAAY,CAACnT,SAAS,CAACqzB,QAAQ,GAAG,UAAS8C,QAAQ,EAAEhC,QAAQ,EAAE;IAC3D,IAAIgC,QAAQ,EAAE;MACV,IAAI,CAACzD,YAAY,GAAG,IAAI;IAC5B;IACA,IAAIyB,QAAQ,EAAE;MACV,IAAI,CAACxB,cAAc,GAAG,IAAI;IAC9B;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;EACIxf,YAAY,CAACnT,SAAS,CAAC60B,eAAe,GAAG,YAAW;IAChD,IAAI,CAAC,IAAI,CAAC7b,MAAM,EAAE;MACd,OAAOrF,MAAM;IACjB;IACA,IAAIyiB,GAAG,GAAG,IAAI,CAACpd,MAAM,CAACqd,aAAa;IACnC,OAAOD,GAAG,CAACE,WAAW,IAAIF,GAAG,CAACG,YAAY;EAC9C,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIpjB,YAAY,CAACnT,SAAS,CAAC2xB,cAAc,GAAG,YAAW;IAC/C,IAAI,IAAI,CAAC6E,YAAY,EAAE;MACnB;IACJ,CAAC,CAAC;;IAEF,IAAI,CAACA,YAAY,GAAG,IAAI;IACxBC,WAAW,CAAC/3B,IAAI,CAAC,IAAI,CAAC;IAEtB,SAAS+3B,WAAW,GAAG;MACnB,IAAI,CAAC,IAAI,CAAC5H,eAAe,EAAE;QACvB,IAAI,CAAC6H,IAAI,EAAE;MACf;MAEA,IAAI/iB,MAAM,GAAG,IAAI,CAACkhB,eAAe,EAAE;MACnC,IAAI,IAAI,CAAC2B,YAAY,EAAE;QACnB7iB,MAAM,CAACC,qBAAqB,CAAC6iB,WAAW,CAACpmB,IAAI,CAAC,IAAI,CAAC,CAAC;MACxD;IACJ;EACJ,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACI8C,YAAY,CAACnT,SAAS,CAAC22B,aAAa,GAAG,YAAW;IAC9C,IAAI,CAACH,YAAY,GAAG,KAAK;IACzB;AACR;AACA;AACA;AACA;AACA;AACA;EACI,CAAC;;EAED;;EAEH;EACArjB,YAAY,CAACnT,SAAS,CAAC42B,UAAU,GAAG,YACpC;IACC,IAAI,CAACC,WAAW,GAAG,IAAI;IACvB,IAAI,CAAC/D,eAAe,GAAG,CAAC;EACzB,CAAC;EAEE3f,YAAY,CAACnT,SAAS,CAAC+0B,gBAAgB,GAAG,UAASz2B,CAAC,EAAE;IAExD,IAAI,IAAI,CAACmxB,+BAA+B,EACvC,IAAI,CAACiD,YAAY,GAAG,IAAI;IAEzB,IAAI,CAAC,IAAI,CAACtf,KAAK,EAAE;MACP;IACJ;IAEA,IAAI,CAAC0jB,gBAAgB,CAACx4B,CAAC,CAAC;IAExB,IAAIs2B,UAAU,GAAG,IAAI,CAACC,eAAe,EAAE;IACvC,IAAI3nB,QAAQ,GAAG0nB,UAAU,CAAC1nB,QAAQ;IAClCiG,YAAY,CAAC4jB,aAAa,GAAG,IAAI;IACjC,IAAI/nB,IAAI,GAAG,IAAI;IAErB,IAAIoI,CAAC,GAAG9Y,CAAC,CAACktB,OAAO;IACjB,IAAIjU,CAAC,GAAGjZ,CAAC,CAACotB,OAAO;IACjB;IACA;;IAEA,IAAI,CAACmC,EAAE,CAAC9C,QAAQ,GAAG,IAAI,CAACA,QAAQ;IAChC,IAAIgB,SAAS,GAAG,CAAC,IAAI,CAAChB,QAAQ,IAAM,IAAI,CAACA,QAAQ,IAAI3T,CAAC,IAAI,IAAI,CAAC2T,QAAQ,CAAC,CAAC,CAAC,IAAI3T,CAAC,GAAI,IAAI,CAAC2T,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,QAAQ,CAAC,CAAC,CAAE,IAAIxT,CAAC,IAAI,IAAI,CAACwT,QAAQ,CAAC,CAAC,CAAC,IAAIxT,CAAC,GAAI,IAAI,CAACwT,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,QAAQ,CAAC,CAAC,CAAI;;IAEzL;IACN,IAAG,CAAC,IAAI,CAACnf,OAAO,CAACue,WAAW,EAC5B;MACC1oB,SAAS,CAACyqB,qBAAqB,CAAC,IAAI,CAAClT,MAAM,EAAC,MAAM,EAAE,IAAI,CAACkc,mBAAmB,CAAC;MAC7EzzB,SAAS,CAACopB,kBAAkB,CAAC+J,UAAU,CAAC1nB,QAAQ,EAAC,MAAM,EAAE,IAAI,CAACgoB,mBAAmB,EAAC,IAAI,CAAC,CAAC,CAAC;MACzFzzB,SAAS,CAACopB,kBAAkB,CAAC+J,UAAU,CAAC1nB,QAAQ,EAAC,IAAI,EAAE,IAAI,CAACkoB,iBAAiB,EAAC,IAAI,CAAC;IACpF;IAEA,IAAG,CAACrJ,SAAS,EAAC;MACb;IACD;IAEM,IAAIlgB,IAAI,GAAG,IAAI,CAACuH,KAAK,CAACsG,YAAY,CAAEpb,CAAC,CAAC04B,OAAO,EAAE14B,CAAC,CAAC24B,OAAO,EAAE,IAAI,CAAC5E,aAAa,EAAE,CAAC,CAAE;IACjF,IAAI6E,aAAa,GAAG,KAAK;IACzB,IAAIC,WAAW,GAAG,KAAK;IACvB,IAAI/mB,GAAG,GAAG3O,SAAS,CAAC0O,OAAO,EAAE;IACnC,IAAIinB,UAAU,GAAI94B,CAAC,CAAC+4B,SAAS,KAAKtf,SAAS,IAAI,CAACzZ,CAAC,CAAC+4B,SAAU;IACtD,IAAIC,eAAe,GAAIlnB,GAAG,GAAG,IAAI,CAAC0iB,eAAe,GAAG,GAAG,IAAKsE,UAAU;IAC5E,IAAI,CAAC9G,KAAK,CAAC,CAAC,CAAC,GAAGhyB,CAAC,CAACktB,OAAO;IACzB,IAAI,CAAC8E,KAAK,CAAC,CAAC,CAAC,GAAGhyB,CAAC,CAACotB,OAAO;IACnB,IAAI,CAAC6E,WAAW,CAAC,CAAC,CAAC,GAAGjyB,CAAC,CAAC04B,OAAO;IAC/B,IAAI,CAACzG,WAAW,CAAC,CAAC,CAAC,GAAGjyB,CAAC,CAAC24B,OAAO;IACrC,IAAI,CAACM,mBAAmB,GAAG,CAAC,IAAI,CAACjH,KAAK,CAAC,CAAC,CAAC,EAAC,IAAI,CAACA,KAAK,CAAC,CAAC,CAAC,CAAC;IAEtD,IAAI,IAAI,CAACyC,eAAe,IAAIqE,UAAU,EAAE;MACxC,IAAI,CAACpE,iBAAiB,GAAG,IAAI;MAC7B;IACF,CAAC,MAAI;MACH,IAAI,CAACA,iBAAiB,GAAG,KAAK;IAChC;IACE,IAAI,CAACD,eAAe,GAAG,IAAI;IAGvB,IAAI,CAAC/Z,MAAM,CAACwe,KAAK,EAAE;IAEnB/1B,SAAS,CAACg2B,oBAAoB,CAAC7C,UAAU,CAAC;IAE1C,IAAI,IAAI,CAAChK,OAAO,EACtB;MACU,IAAI,IAAI,CAACA,OAAO,CAACtsB,CAAC,CAAC,IAAI,IAAI,EACvB;IACR;;IAEN;IACM,IAAIA,CAAC,CAACo5B,KAAK,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC1E,iBAAiB,EACjD;MACU,IAAI10B,CAAC,CAACq5B,OAAO,EACtB;QACa,IAAI,CAACnI,kBAAkB,GAAG,IAAItQ,YAAY,CAAC,CAAC,CAAC;QAC7C,IAAI,CAACsQ,kBAAkB,CAAC,CAAC,CAAC,GAAGlxB,CAAC,CAAC04B,OAAO;QACtC,IAAI,CAACxH,kBAAkB,CAAC,CAAC,CAAC,GAAGlxB,CAAC,CAAC24B,OAAO;QACtC,IAAI,CAACzH,kBAAkB,CAAC,CAAC,CAAC,GAAG,CAAC;QAC9B,IAAI,CAACA,kBAAkB,CAAC,CAAC,CAAC,GAAG,CAAC;QAC9B2H,WAAW,GAAG,IAAI;MACtB;;MAEA;MACA,IAAI11B,SAAS,CAAC2F,uBAAuB,IAAI9I,CAAC,CAACs5B,MAAM,IAAI/rB,IAAI,IAAI,IAAI,CAACujB,iBAAiB,IAAI,CAAC+H,WAAW,IAAI,CAAC,IAAI,CAACpI,SAAS,EACtH;QACI,IAAI8I,MAAM,GAAGhsB,IAAI,CAACmU,KAAK,EAAE,EAAC;UACtB6X,MAAM,CAAC3vB,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC;UAClB2vB,MAAM,CAAC3vB,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC;UAClB,IAAI,CAACkL,KAAK,CAAC8E,GAAG,CAAC2f,MAAM,EAAC,KAAK,EAAC;YAACC,UAAU,EAAE;UAAK,CAAC,CAAC;UAChDjsB,IAAI,GAAGgsB,MAAM;UACbV,WAAW,GAAG,IAAI;UAClB,IAAI,CAACY,eAAe,EAAE;YAClB,IAAI,IAAI,CAAC5I,eAAe,EAAE;cAC3C,IAAI,CAAC/b,KAAK,CAACwF,YAAY,EAAE;cACJ,IAAI,CAACM,YAAY,GAAGrN,IAAI;YAC5B;YACA,IAAI,CAAC,IAAI,CAACoN,cAAc,CAACpN,IAAI,CAAC2J,EAAE,CAAC,EAAE;cAC/B,IAAI,CAACwiB,mBAAmB,CAACnsB,IAAI,EAAEvN,CAAC,CAAC;YACrC;UACJ;QACJ;MACJ;MAEA,IAAI25B,kBAAkB,GAAG,KAAK;;MAE9B;MACA;MACA,IAAIpsB,IAAI,IAAI,IAAI,CAACujB,iBAAiB,IAAI,CAAC+H,WAAW,IAAI,CAAC,IAAI,CAACpI,SAAS,EAAE;QACnE,IAAI,CAAC,IAAI,CAACnS,SAAS,IAAI,CAAC/Q,IAAI,CAACI,KAAK,CAAC8c,MAAM,EAAE;UACvC,IAAI,CAACmP,YAAY,CAACrsB,IAAI,CAAC;QAC3B,CAAC,CAAC;;QAEF;QACA,IAAK,CAAC,IAAI,CAAC0mB,eAAe,IAAI,CAAC1mB,IAAI,CAACI,KAAK,CAAC2Y,SAAS,IAAI,CAAC,IAAI,CAAChI,SAAS,EAAG;UACrE;UACA,IAAK,CAACua,WAAW,IACbtrB,IAAI,CAACssB,SAAS,KAAK,KAAK,IACxBnT,iBAAiB,CAAE1mB,CAAC,CAAC04B,OAAO,EACxB14B,CAAC,CAAC24B,OAAO,EACTprB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAG2D,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAC9BL,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAG2D,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAC9B,EAAE,EACF,EAAE,CACL,EACH;YAChB,IAAI,CAACkH,KAAK,CAACwF,YAAY,EAAE;YACP,IAAI,CAACwf,aAAa,GAAGvsB,IAAI;YACzB,IAAI,CAACmN,MAAM,CAACqf,KAAK,CAACC,MAAM,GAAG,WAAW;YACtCnB,WAAW,GAAG,IAAI;UACtB,CAAC,MAAM;YACH;YACA,IAAItrB,IAAI,CAACiH,OAAO,EAAE;cACd,KAAM,IAAIlT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG1J,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAG;gBACnD,IAAIiW,MAAM,GAAGhK,IAAI,CAACiH,OAAO,CAAClT,CAAC,CAAC;gBAC5B,IAAIulB,QAAQ,GAAGtZ,IAAI,CAACuZ,gBAAgB,CAAC,KAAK,EAAExlB,CAAC,CAAC;gBAC9C,IACIolB,iBAAiB,CACb1mB,CAAC,CAAC04B,OAAO,EACT14B,CAAC,CAAC24B,OAAO,EACT9R,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAChBA,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAChB,EAAE,EACF,EAAE,CACL,EACH;kBACE,IAAI,CAACoN,eAAe,GAAG1mB,IAAI;kBAC3B,IAAI,CAAC0sB,iBAAiB,GAAG1iB,MAAM;kBAC/B,IAAI,CAAC0iB,iBAAiB,CAACC,UAAU,GAAG54B,CAAC;kBACrC,IAAI,CAAC64B,cAAc,GAAG5sB,IAAI,CAACuZ,gBAAgB,CAAE,KAAK,EAAExlB,CAAC,CAAE;kBACvD,IAAI,CAAC84B,eAAe,GAAG94B,CAAC;kBAExB,IAAI6B,SAAS,CAAC+E,8BAA8B,EAAC;oBACzC,IAAIlI,CAAC,CAACq6B,QAAQ,EAAE;sBACZ9sB,IAAI,CAACkN,gBAAgB,CAACnZ,CAAC,CAAC;oBAC5B;kBACJ;kBAEA,IAAI03B,eAAe,EAAE;oBACjB,IAAIzrB,IAAI,CAAC+sB,gBAAgB,EAAE;sBACvB/sB,IAAI,CAAC+sB,gBAAgB,CAACh5B,CAAC,EAAEtB,CAAC,CAAC;oBAC/B;kBACJ,CAAC,MAAM;oBACH,IAAIuN,IAAI,CAACgtB,aAAa,EAAE;sBACpBhtB,IAAI,CAACgtB,aAAa,CAACj5B,CAAC,EAAEtB,CAAC,CAAC;oBAC5B;kBACJ;kBAEA64B,WAAW,GAAG,IAAI;kBAClB;gBACJ;cACJ;YACJ;;YAEA;YACA,IAAItrB,IAAI,CAACgH,MAAM,EAAE;cACb,KAAM,IAAIjT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG1J,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAG;gBAClD,IAAIiX,KAAK,GAAGhL,IAAI,CAACgH,MAAM,CAACjT,CAAC,CAAC;gBAC1B,IAAIulB,QAAQ,GAAGtZ,IAAI,CAACuZ,gBAAgB,CAAC,IAAI,EAAExlB,CAAC,CAAC;gBAC7C,IACIolB,iBAAiB,CACb1mB,CAAC,CAAC04B,OAAO,EACT14B,CAAC,CAAC24B,OAAO,EACT9R,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAChBA,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAChB,EAAE,EACF,EAAE,CACL,EACH;kBACE,IAAImS,eAAe,EAAE;oBACjB,IAAIzrB,IAAI,CAACitB,eAAe,EAAE;sBACtBjtB,IAAI,CAACitB,eAAe,CAACl5B,CAAC,EAAEtB,CAAC,CAAC;oBAC9B;kBACJ,CAAC,MAAM;oBACH,IAAIuN,IAAI,CAACktB,YAAY,EAAE;sBACnBltB,IAAI,CAACktB,YAAY,CAACn5B,CAAC,EAAEtB,CAAC,CAAC;oBAC3B;kBACJ;kBAEA,IAAIuY,KAAK,CAACnB,IAAI,KAAK,IAAI,EAAE;oBACrB,IAAI+G,SAAS,GAAG,IAAI,CAACrJ,KAAK,CAACvB,KAAK,CAC5BgF,KAAK,CAACnB,IAAI,CACb,CAAC,CAAC;oBACH,IAAIjU,SAAS,CAACgF,sBAAsB,EAAC;sBACjCoF,IAAI,CAACiN,eAAe,CAAClZ,CAAC,CAAC;sBACvB,IAAI,CAAC+yB,cAAc,GAAG,IAAI;sBAC1BwE,WAAW,GAAG,IAAI;oBACtB,CAAC,MAAI;sBACD;oBAAA;oBAGJ,IACI,IAAI,CAAC7H,qBAAqB;oBAC3D;oBACiChxB,CAAC,CAACq6B,QAAQ,EACZ;sBACE,IAAI,CAACl3B,SAAS,CAACgF,sBAAsB,EAAC;wBAClCoF,IAAI,CAACiN,eAAe,CAAClZ,CAAC,CAAC;sBAC3B;sBACA,IAAI,CAAC2yB,eAAe,GAAG,IAAI,CAACnf,KAAK,CAAC3B,YAAY,CAC1CgL,SAAS,CAACqC,SAAS,CACtB;sBACD,IAAI,CAAC4Z,eAAe,GAChBjc,SAAS,CAACsC,WAAW;sBACzB,IAAI,CAACwZ,iBAAiB,GAAG,IAAI,CAAChG,eAAe,CAACzf,OAAO,CACjD,IAAI,CAAC4lB,eAAe,CACvB;sBACD,IAAI,CAACD,cAAc,GAAG,IAAI,CAAClG,eAAe,CAACnN,gBAAgB,CAAE,KAAK,EAAE,IAAI,CAACsT,eAAe,CAAE;sBAE1F,IAAI,CAAC/F,cAAc,GAAG,IAAI;sBAC1BwE,WAAW,GAAG,IAAI;oBACtB;kBAGJ,CAAC,MAAI;oBACD;kBAAA;kBAGJ,IAAI,CAACA,WAAW,EAAC;oBACb;oBACA,IAAI,CAAC5E,eAAe,GAAG1mB,IAAI;oBAC3B,IAAI,CAACmtB,gBAAgB,GAAGniB,KAAK;oBAC7B,IAAI,CAACmiB,gBAAgB,CAACR,UAAU,GAAG54B,CAAC;oBACpC,IAAI,CAAC64B,cAAc,GAAG5sB,IAAI,CAACuZ,gBAAgB,CAAE,IAAI,EAAExlB,CAAC,CAAE;oBACtD,IAAI,CAAC84B,eAAe,GAAG94B,CAAC;oBAExB,IAAI,CAAC+yB,cAAc,GAAG,IAAI;oBAC1BwE,WAAW,GAAG,IAAI;kBACtB;gBACJ;cACJ;YACJ;UACJ,CAAC,CAAC;QACN;;QAEA;QACA,IAAI,CAACA,WAAW,EAAE;UACd,IAAIY,eAAe,GAAG,KAAK;UAC1C,IAAI7vB,GAAG,GAAG,CAAC5J,CAAC,CAAC04B,OAAO,GAAGnrB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,EAAE5J,CAAC,CAAC24B,OAAO,GAAGprB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,CAAC;;UAE7C;UACA,IAAIoc,MAAM,GAAG,IAAI,CAAC2U,kBAAkB,CAAEptB,IAAI,EAAE,IAAI,CAAC0kB,WAAW,EAAEjyB,CAAC,CAAE;UACjE,IAAIgmB,MAAM,EAAE;YACRyT,eAAe,GAAG,IAAI;YACtB,IAAI,CAAC1G,WAAW,GAAG,CAACxlB,IAAI,EAAEyY,MAAM,CAAC;UACrC;;UAEA;UACA,IAAIgT,eAAe,IAAI,IAAI,CAACre,cAAc,CAACpN,IAAI,CAAC2J,EAAE,CAAC,EAAE;YACjD;YACA,IAAI3J,IAAI,CAACqtB,UAAU,EAAE;cACjBrtB,IAAI,CAACqtB,UAAU,CAAE56B,CAAC,EAAE4J,GAAG,EAAE,IAAI,CAAE;YACnC;YACA,IAAI,CAACixB,qBAAqB,CAACttB,IAAI,CAAC;YAChCksB,eAAe,GAAG,IAAI;UAC1B;;UAEA;UACA,IAAKlsB,IAAI,CAACutB,WAAW,IAAIvtB,IAAI,CAACutB,WAAW,CAAE96B,CAAC,EAAE4J,GAAG,EAAE,IAAI,CAAE,EAAG;YACxD6vB,eAAe,GAAG,IAAI;UAC1B,CAAC,MAAM;YACrB;YACA,IAAGlsB,IAAI,CAACwtB,QAAQ,IAAI,CAACxtB,IAAI,CAACytB,oBAAoB,EAC9C;cACC,IAAK,CAACztB,IAAI,CAACI,KAAK,CAAC2Y,SAAS,IAAI1c,GAAG,CAAC,CAAC,CAAC,GAAG2D,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,GAAGzK,SAAS,CAACG,iBAAiB,IAAIsG,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAG;gBACjG,IAAI8G,IAAI,GAAG,IAAI;gBACf3Q,UAAU,CAAC,YAAW;kBACrB2Q,IAAI,CAACukB,YAAY,CAAC1nB,IAAI,CAACwtB,QAAQ,CAAC;gBACjC,CAAC,EAAE,EAAE,CAAC;cACP;YACD;YAEA,IAAI,IAAI,CAACzc,SAAS,EAAE;cACnBqb,kBAAkB,GAAG,IAAI;cACPF,eAAe,GAAG,IAAI;YACzC;UACc;UAEA,IAAI,CAACA,eAAe,EAAE;YAClB,IAAI,IAAI,CAAC5I,eAAe,EAAE;cAC3C,IAAI,CAAC/b,KAAK,CAACwF,YAAY,EAAE;cACJ,IAAI,CAACM,YAAY,GAAGrN,IAAI;YAC5B;YACA,IAAI,CAAC,IAAI,CAACoN,cAAc,CAACpN,IAAI,CAAC2J,EAAE,CAAC,EAAE;cAC/B,IAAI,CAACwiB,mBAAmB,CAACnsB,IAAI,EAAEvN,CAAC,CAAC;YACrC;UACJ;UAEA,IAAI,CAACo0B,YAAY,GAAG,IAAI;QAC5B;MACJ,CAAC,CAAC;MAAA,KACG;QACb,IAAI,CAACyE,WAAW,EAAC;UAChB;UACA,IAAG,CAAC,IAAI,CAACpI,SAAS,EAAE;YACnB,KAAK,IAAInvB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC4xB,aAAa,CAACtyB,MAAM,EAAE,EAAEU,CAAC,EAAE;cACnD,IAAI8V,IAAI,GAAG,IAAI,CAAC8b,aAAa,CAAC5xB,CAAC,CAAC;cAChC,IAAIytB,MAAM,GAAG3X,IAAI,CAACuJ,IAAI;cACtB,IACC,CAACoO,MAAM,IACP/uB,CAAC,CAAC04B,OAAO,GAAG3J,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,IACzB/uB,CAAC,CAAC04B,OAAO,GAAG3J,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,IACzB/uB,CAAC,CAAC24B,OAAO,GAAG5J,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,IACzB/uB,CAAC,CAAC24B,OAAO,GAAG5J,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,EACxB;gBACD;cACD;cACA;cACA,IAAI,CAACkM,YAAY,CAAC7jB,IAAI,EAAEpX,CAAC,CAAC;cAC1B,IAAI,CAACgzB,gBAAgB,GAAG,IAAI,CAAC,CAAC;cAC9B;YACD;UACD;UAEA,IAAI,CAACc,cAAc,GAAG,IAAI,CAAChf,KAAK,CAAC2G,aAAa,CAAEzb,CAAC,CAAC04B,OAAO,EAAE14B,CAAC,CAAC24B,OAAO,CAAE;UACtE,IAAI,CAACuC,uBAAuB,GAAG,KAAK;UACpC,IAAI,IAAI,CAACpH,cAAc,IAAI,CAAC,IAAI,CAACrD,SAAS,EAAG;YAC5C,IAAIzwB,CAAC,CAACq5B,OAAO,EAAE;cACd,IAAI,CAACnI,kBAAkB,GAAG,IAAI;YAC/B;YAEA,IAAIiK,IAAI,GAAGC,QAAQ,CAAE,CAACp7B,CAAC,CAAC04B,OAAO,EAAE14B,CAAC,CAAC24B,OAAO,CAAC,EAAE,CAAE,IAAI,CAAC7E,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACkqB,cAAc,CAAClmB,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAACkmB,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACkqB,cAAc,CAAClmB,IAAI,CAAC,CAAC,CAAC,CAAE,CAAE;YACrK,IAAIutB,IAAI,GAAG,IAAI,CAAC5L,EAAE,CAAC5E,KAAK,GAAG,EAAE,EAAE;cAC9B,IAAI,CAACuQ,uBAAuB,GAAG,IAAI;YACpC,CAAC,MAAM;cACN,IAAI,CAACpH,cAAc,CAACtI,oBAAoB,EAAE;YAC3C;UACD;UAEA,IAAIwN,eAAe,IAAI,CAAC,IAAI,CAACvI,SAAS,IAAI,IAAI,CAACM,eAAe,EAAE;YAC/D,IAAI,CAACsK,aAAa,CAACr7B,CAAC,CAAC;YACrBA,CAAC,CAACsuB,cAAc,EAAE;YAClBtuB,CAAC,CAACuuB,eAAe,EAAE;UACpB;UAEAoL,kBAAkB,GAAG,IAAI;QAC1B;MACQ;MAEA,IAAI,CAACd,WAAW,IAAIc,kBAAkB,IAAI,IAAI,CAAC/I,gBAAgB,EAAE;QAChE;QACA,IAAI,CAACuD,eAAe,GAAG,IAAI;MAC5B;IAEJ,CAAC,MAAM,IAAIn0B,CAAC,CAACo5B,KAAK,IAAI,CAAC,EAAE;MACrB;;MAET,IAAIj2B,SAAS,CAAC8F,kCAAkC,EAAC;QAChD,IAAIsE,IAAI,IAAI,IAAI,CAACujB,iBAAiB,IAAI,CAAC+H,WAAW,IAAI,CAAC,IAAI,CAACpI,SAAS,EAAC;UACrE;UACA,IACC,CAAC,IAAI,CAACwD,eAAe,IACrB,CAAC1mB,IAAI,CAACI,KAAK,CAAC2Y,SAAS,IACrB,CAAC,IAAI,CAAChI,SAAS,EACd;YACD,IAAIgd,SAAS,GAAG,KAAK;YACrB,IAAIC,eAAe,GAAG,KAAK;YAC3B,IAAIC,eAAe,GAAG,KAAK;YAC3B;YACA,IAAIjuB,IAAI,CAACiH,OAAO,EAAE;cACjB,KAAM,IAAIlT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG1J,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAG;gBACtD,IAAIiW,MAAM,GAAGhK,IAAI,CAACiH,OAAO,CAAClT,CAAC,CAAC;gBAC5B,IAAIulB,QAAQ,GAAGtZ,IAAI,CAACuZ,gBAAgB,CAAC,KAAK,EAAExlB,CAAC,CAAC;gBAC9C,IAAIolB,iBAAiB,CAAC1mB,CAAC,CAAC04B,OAAO,EAAC14B,CAAC,CAAC24B,OAAO,EAAC9R,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAACA,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAAC,EAAE,EAAC,EAAE,CAAC,EAAE;kBACnFyU,SAAS,GAAG/jB,MAAM;kBAClBgkB,eAAe,GAAGj6B,CAAC;kBACnBk6B,eAAe,GAAG,IAAI;kBACtB;gBACD;cACD;YACD;;YAEA;YACA,IAAIjuB,IAAI,CAACgH,MAAM,EAAE;cAChB,KAAM,IAAIjT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG1J,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAG;gBACrD,IAAIiX,KAAK,GAAGhL,IAAI,CAACgH,MAAM,CAACjT,CAAC,CAAC;gBAC1B,IAAIulB,QAAQ,GAAGtZ,IAAI,CAACuZ,gBAAgB,CAAC,IAAI,EAAExlB,CAAC,CAAC;gBAC7C,IAAIolB,iBAAiB,CAAC1mB,CAAC,CAAC04B,OAAO,EAAC14B,CAAC,CAAC24B,OAAO,EAAC9R,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAACA,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAAC,EAAE,EAAC,EAAE,CAAC,EAAE;kBACnFyU,SAAS,GAAG/iB,KAAK;kBACjBgjB,eAAe,GAAGj6B,CAAC;kBACnBk6B,eAAe,GAAG,KAAK;kBACvB;gBACD;cACD;YACD;YACA;YACA,IAAIF,SAAS,IAAIC,eAAe,KAAG,KAAK,EAAC;cAExC,IAAIE,SAAS,GAAG,GAAG,GAAE,CAACF,eAAe,GAAC,CAAC,KAAIC,eAAe,GAACjuB,IAAI,CAACiH,OAAO,CAAC5T,MAAM,GAAC2M,IAAI,CAACgH,MAAM,CAAC3T,MAAM,CAAG;cACpG,IAAI6qB,aAAa,GAAGle,IAAI,CAAC8Y,WAAW,EAAE;cACtC;cACA,IAAIqV,MAAM,GAAG,CAAG,CAACF,eAAe,GAAC/P,aAAa,CAAC,CAAC,CAAC,GAACA,aAAa,CAAC,CAAC,CAAC,GAACA,aAAa,CAAC,CAAC,CAAC,CAAC;cAAA,EAC/EzrB,CAAC,CAAC24B,OAAO,GAAC,EAAE;cAAA,CACX;;cACN,IAAIgD,WAAW,GAAG,IAAI,CAACC,wBAAwB,CAAC;gBAAKC,QAAQ,EAAE,CAACL,eAAe,GAAC,IAAI,GAACjuB,IAAI;gBAC1EuuB,QAAQ,EAAE,CAACN,eAAe,GAAC,IAAI,GAACD,eAAe;gBAC/CQ,MAAM,EAAE,CAACP,eAAe,GAACjuB,IAAI,GAAC,IAAI;gBAClCyuB,MAAM,EAAE,CAACR,eAAe,GAACD,eAAe,GAAC,IAAI;gBAC7CU,QAAQ,EAAEP,MAAM,CAAC;gBAAA;gBACjBQ,QAAQ,EAAE,MAAM,CAAC;gBAAA;gBACjBC,MAAM,EAAC,CAAC,CAACX,eAAe,GAAC,CAAC,EAAE,GAAC,EAAE,EAAE,CAACC,SAAS,GAAC,GAAG,CAAC,CAAC;gBAAA;gBACjDW,UAAU,EAAC,CAAC,CAACZ,eAAe,GAAC,CAAC,CAAC,GAAC,CAAC,EAAE,CAAC,CAAC,CAAC;cACxC,CAAC,CAAC;YAEhB;UACD;QACD;MACD;IAEK,CAAC,MAAM,IAAIx7B,CAAC,CAACo5B,KAAK,IAAI,CAAC,IAAI,IAAI,CAAC1E,iBAAiB,EAAE;MAE/C;MACT,IAAI,IAAI,CAAC5D,iBAAiB,IAAI,CAAC+H,WAAW,IAAI,CAAC,IAAI,CAACpI,SAAS,EAAC;QAE7D;QACA,IAAIljB,IAAI,EAAC;UACR,IAAGrD,MAAM,CAACmyB,IAAI,CAAC,IAAI,CAAC1hB,cAAc,CAAC,CAAC/Z,MAAM,KACnC,IAAI,CAAC+Z,cAAc,CAACpN,IAAI,CAAC2J,EAAE,CAAC,IAAIlX,CAAC,CAACq6B,QAAQ,IAAIr6B,CAAC,CAACq5B,OAAO,IAAIr5B,CAAC,CAACs8B,OAAO,CAAC,EAC3E;YACA;YACA,IAAI,CAAC,IAAI,CAAC3hB,cAAc,CAACpN,IAAI,CAAC2J,EAAE,CAAC,EAAE,IAAI,CAACqe,WAAW,CAAC,CAAChoB,IAAI,CAAC,EAAC,IAAI,CAAC,CAAC,CAAC;UACnE,CAAC,MAAI;YACJ;YACA,IAAI,CAACgoB,WAAW,CAAC,CAAChoB,IAAI,CAAC,CAAC;UACzB;QACD;;QAEA;QACA,IAAI,CAACgvB,kBAAkB,CAAChvB,IAAI,EAAEvN,CAAC,CAAC;MACjC;IAEK;;IAEA;IACA;IACA;;IAEA,IAAI,CAACksB,UAAU,CAAC,CAAC,CAAC,GAAGlsB,CAAC,CAACktB,OAAO;IAC9B,IAAI,CAAChB,UAAU,CAAC,CAAC,CAAC,GAAGlsB,CAAC,CAACotB,OAAO;IAC9B,IAAI,CAACoH,eAAe,GAAGrxB,SAAS,CAAC0O,OAAO,EAAE;IAC1C,IAAI,CAAC2qB,mBAAmB,GAAG,IAAI;;IAE/B;AACR;AACA;AACA;;IAEQ,IAAI,CAAC1nB,KAAK,CAACL,MAAM,EAAE;;IAEnB;IACA,IACI,CAAC6hB,UAAU,CAAC1nB,QAAQ,CAAC6tB,aAAa,IACjCnG,UAAU,CAAC1nB,QAAQ,CAAC6tB,aAAa,CAACC,QAAQ,CAACzxB,WAAW,EAAE,IACrD,OAAO,IACPqrB,UAAU,CAAC1nB,QAAQ,CAAC6tB,aAAa,CAACC,QAAQ,CAACzxB,WAAW,EAAE,IACpD,UAAW,EACrB;MACEjL,CAAC,CAACsuB,cAAc,EAAE;IACtB;IACAtuB,CAAC,CAACuuB,eAAe,EAAE;IAEnB,IAAI,IAAI,CAACuM,WAAW,EAAE;MAClB,IAAI,CAACA,WAAW,CAAC96B,CAAC,CAAC;IACvB;IAEA,OAAO,KAAK;EAChB,CAAC;;EAED;AACJ;AACA;AACA;EACI6U,YAAY,CAACnT,SAAS,CAACm1B,gBAAgB,GAAG,UAAS72B,CAAC,EAAE;IAClD,IAAI,IAAI,CAACszB,UAAU,EAAE;MACjB,IAAI,CAACqJ,MAAM,EAAE;IACjB;IAEN,IAAI,IAAI,CAACxL,+BAA+B,EACvC,IAAI,CAACiD,YAAY,GAAG,IAAI;IAEnB,IAAI,CAAC,IAAI,CAACtf,KAAK,EAAE;MACb;IACJ;IAEAD,YAAY,CAAC4jB,aAAa,GAAG,IAAI;IACjC,IAAI,CAACD,gBAAgB,CAACx4B,CAAC,CAAC;IACxB,IAAIgyB,KAAK,GAAG,CAAChyB,CAAC,CAACktB,OAAO,EAAEltB,CAAC,CAACotB,OAAO,CAAC;IACxC,IAAI,CAAC4E,KAAK,CAAC,CAAC,CAAC,GAAGA,KAAK,CAAC,CAAC,CAAC;IACxB,IAAI,CAACA,KAAK,CAAC,CAAC,CAAC,GAAGA,KAAK,CAAC,CAAC,CAAC;IAClB,IAAI7D,KAAK,GAAG,CACR6D,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9F,UAAU,CAAC,CAAC,CAAC,EAC7B8F,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9F,UAAU,CAAC,CAAC,CAAC,CAChC;IACD,IAAI,CAACA,UAAU,GAAG8F,KAAK;IACvB,IAAI,CAACC,WAAW,CAAC,CAAC,CAAC,GAAGjyB,CAAC,CAAC04B,OAAO;IAC/B,IAAI,CAACzG,WAAW,CAAC,CAAC,CAAC,GAAGjyB,CAAC,CAAC24B,OAAO;;IAE/B;;IAEN,IAAG,IAAI,CAACJ,WAAW,EACnB;MACC;MACAv4B,CAAC,CAACsuB,cAAc,EAAE;MAClB,OAAO,KAAK;IACb;IAEMtuB,CAAC,CAACwtB,QAAQ,GAAG,IAAI,CAACgP,mBAAmB;IAErC,IAAI,IAAI,CAACzJ,WAAW,EAAE;MAClB,IAAI,CAAC4H,kBAAkB,CACnB,IAAI,CAAC5H,WAAW,CAAC,CAAC,CAAC,EACnB,IAAI,CAACd,WAAW,EAChBjyB,CAAC,EACD,IAAI,CAAC+yB,WAAW,CAAC,CAAC,CAAC,CACtB;MACD,IAAI,CAACqB,YAAY,GAAG,IAAI;IAC5B;IAEA,IAAI,IAAI,CAAClD,kBAAkB,EACjC;MACU,IAAI,CAACA,kBAAkB,CAAC,CAAC,CAAC,GAAGlxB,CAAC,CAAC04B,OAAO,GAAG,IAAI,CAACxH,kBAAkB,CAAC,CAAC,CAAC;MACnE,IAAI,CAACA,kBAAkB,CAAC,CAAC,CAAC,GAAGlxB,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAACzH,kBAAkB,CAAC,CAAC,CAAC;MACnE,IAAI,CAACkD,YAAY,GAAG,IAAI;IAC5B,CAAC,MACF,IAAI,IAAI,CAACN,cAAc,IAAI,CAAC,IAAI,CAACrD,SAAS,EAC/C;MACU;MACA,IAAI,IAAI,CAACyK,uBAAuB,EAAE;QAC9B,IAAI,CAACpH,cAAc,CAAClmB,IAAI,GAAG,CACvB5N,CAAC,CAAC04B,OAAO,GAAG,IAAI,CAAC5E,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,EACtC5J,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAAC7E,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,CACzC;MACL,CAAC,MAAM;QACH,IAAIyhB,MAAM,GAAG8C,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACoB,EAAE,CAAC5E,KAAK;QACrC,IAAIW,MAAM,GAAG6C,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACoB,EAAE,CAAC5E,KAAK;QACrC,IAAI,CAACmJ,cAAc,CAAC1I,IAAI,CAACC,MAAM,EAAEC,MAAM,EAAEtrB,CAAC,CAACq5B,OAAO,CAAC;QACnD,IAAI,IAAI,CAACvF,cAAc,CAAC7gB,MAAM,CAACrS,MAAM,EAAE;UACnC,IAAI,CAACwzB,YAAY,GAAG,IAAI;QAC5B;MACJ;MACA,IAAI,CAACC,cAAc,GAAG,IAAI;IAC9B,CAAC,MAAM,IAAI,IAAI,CAACF,eAAe,EAAE;MAChC;MACG,IAAI,CAAC5E,EAAE,CAAChG,MAAM,CAAC,CAAC,CAAC,IAAI4E,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACoB,EAAE,CAAC5E,KAAK;MAC7C,IAAI,CAAC4E,EAAE,CAAChG,MAAM,CAAC,CAAC,CAAC,IAAI4E,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACoB,EAAE,CAAC5E,KAAK;MAC7C,IAAI,CAACyJ,YAAY,GAAG,IAAI;MACxB,IAAI,CAACC,cAAc,GAAG,IAAI;IAC9B,CAAC,MAAM,IAAI,IAAI,CAACvD,iBAAiB,IAAI,CAAC,IAAI,CAACL,SAAS,EAAE;MAClD,IAAI,IAAI,CAACwD,eAAe,EAAE;QACtB,IAAI,CAACG,YAAY,GAAG,IAAI;MAC5B;;MAEA;MACA,IAAI7mB,IAAI,GAAG,IAAI,CAACuH,KAAK,CAACsG,YAAY,CAACpb,CAAC,CAAC04B,OAAO,EAAC14B,CAAC,CAAC24B,OAAO,EAAC,IAAI,CAAC5E,aAAa,CAAC;;MAE1E;MACA,KAAK,IAAIzyB,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAACnC,KAAK,CAAC7B,MAAM,CAACrS,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;QACtD,IAAI,IAAI,CAACwT,KAAK,CAAC7B,MAAM,CAAC3R,CAAC,CAAC,CAACs7B,SAAS,IAAIrvB,IAAI,IAAI,IAAI,CAACuH,KAAK,CAAC7B,MAAM,CAAC3R,CAAC,CAAC,EAAG;UACjE;UACA,IAAI,CAACwT,KAAK,CAAC7B,MAAM,CAAC3R,CAAC,CAAC,CAACs7B,SAAS,GAAG,KAAK;UACtC,IAAI,IAAI,CAAC5I,SAAS,IAAI,IAAI,CAACA,SAAS,CAAC6I,YAAY,EAAE;YAC/C,IAAI,CAAC7I,SAAS,CAAC6I,YAAY,CAAC78B,CAAC,CAAC;UAClC;UACA,IAAI,CAACg0B,SAAS,GAAG,IAAI;UACrB,IAAI,CAACI,YAAY,GAAG,IAAI;QAC5B;MACJ;;MAEA;MACA,IAAI7mB,IAAI,EAAE;QAElB,IAAGA,IAAI,CAACuvB,eAAe,EACP,IAAI,CAAC1I,YAAY,GAAG,IAAI;;QAE5B;QACA,IAAI,CAAC7mB,IAAI,CAACqvB,SAAS,EAAE;UACjB;UACArvB,IAAI,CAACqvB,SAAS,GAAG,IAAI;UACrB,IAAI,CAAC5I,SAAS,GAAGzmB,IAAI;UACrB,IAAI,CAAC6mB,YAAY,GAAG,IAAI;UAExB,IAAI7mB,IAAI,CAACwvB,YAAY,EAAE;YACnBxvB,IAAI,CAACwvB,YAAY,CAAC/8B,CAAC,CAAC;UACxB;QACJ;;QAEA;QACA,IAAIuN,IAAI,CAACyvB,WAAW,EAAE;UAClBzvB,IAAI,CAACyvB,WAAW,CAAEh9B,CAAC,EAAE,CAACA,CAAC,CAAC04B,OAAO,GAAGnrB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,EAAE5J,CAAC,CAAC24B,OAAO,GAAGprB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,CAAE;QACnF;;QAEA;QACA,IAAI,IAAI,CAACqqB,eAAe,EAAE;UAEtB,IAAI,IAAI,CAACgG,iBAAiB,EAAC;YAEvB,IAAIrwB,GAAG,GAAG,IAAI,CAACqzB,gBAAgB,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;YAE3C;YACA,IAAI,IAAI,CAACC,aAAa,CAAC3vB,IAAI,EAAEvN,CAAC,CAAC04B,OAAO,EAAE14B,CAAC,CAAC24B,OAAO,CAAC,EAAE;cAChD;YAAA,CACH,MAAM;cACH;cACA,IAAIpe,IAAI,GAAG,IAAI,CAAC4iB,eAAe,CAAE5vB,IAAI,EAAEvN,CAAC,CAAC04B,OAAO,EAAE14B,CAAC,CAAC24B,OAAO,EAAE/uB,GAAG,CAAE;cAClE,IAAI2Q,IAAI,IAAI,CAAC,CAAC,IAAIhN,IAAI,CAACgH,MAAM,CAACgG,IAAI,CAAC,EAAE;gBACjC,IAAIhP,SAAS,GAAGgC,IAAI,CAACgH,MAAM,CAACgG,IAAI,CAAC,CAAClR,IAAI;gBACtC,IAAKlG,SAAS,CAACwM,iBAAiB,CAAE,IAAI,CAACsqB,iBAAiB,CAAC5wB,IAAI,EAAEkC,SAAS,CAAE,EAAG;kBACzE,IAAI,CAAC0xB,gBAAgB,GAAGrzB,GAAG;kBACtD,IAAI,CAACwzB,qBAAqB,GAAG7vB,IAAI,CAACgH,MAAM,CAACgG,IAAI,CAAC,CAAC,CAAC;gBACzB;cACJ,CAAC,MAAM;gBACH,IAAI,CAAC0iB,gBAAgB,GAAG,IAAI;gBACpD,IAAI,CAACG,qBAAqB,GAAG,IAAI,CAAC,CAAE;cAChB;YACJ;UAEJ,CAAC,MAAK,IAAG,IAAI,CAAC1C,gBAAgB,EAAC;YAE3B,IAAI9wB,GAAG,GAAG,IAAI,CAACyzB,iBAAiB,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;YAE5C;YACA,IAAI,IAAI,CAACH,aAAa,CAAC3vB,IAAI,EAAEvN,CAAC,CAAC04B,OAAO,EAAE14B,CAAC,CAAC24B,OAAO,CAAC,EAAE;cAChD;YAAA,CACH,MAAM;cACH;cACA,IAAIpe,IAAI,GAAG,IAAI,CAAC+iB,gBAAgB,CAAE/vB,IAAI,EAAEvN,CAAC,CAAC04B,OAAO,EAAE14B,CAAC,CAAC24B,OAAO,EAAE/uB,GAAG,CAAE;cACnE,IAAI2Q,IAAI,IAAI,CAAC,CAAC,IAAIhN,IAAI,CAACiH,OAAO,CAAC+F,IAAI,CAAC,EAAE;gBAClC,IAAIhP,SAAS,GAAGgC,IAAI,CAACiH,OAAO,CAAC+F,IAAI,CAAC,CAAClR,IAAI;gBACvC,IAAKlG,SAAS,CAACwM,iBAAiB,CAAE,IAAI,CAAC+qB,gBAAgB,CAACrxB,IAAI,EAAEkC,SAAS,CAAE,EAAG;kBACxE,IAAI,CAAC8xB,iBAAiB,GAAGzzB,GAAG;gBAChC;cACJ,CAAC,MAAM;gBACH,IAAI,CAACyzB,iBAAiB,GAAG,IAAI;cACjC;YACJ;UACJ;QACJ;;QAEA;QACA,IAAI,IAAI,CAAC3iB,MAAM,EAAE;UACb,IACIgM,iBAAiB,CACb1mB,CAAC,CAAC04B,OAAO,EACT14B,CAAC,CAAC24B,OAAO,EACTprB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAG2D,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAC9BL,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAG2D,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAC9B,CAAC,EACD,CAAC,CACJ,EACH;YACE,IAAI,CAAC8M,MAAM,CAACqf,KAAK,CAACC,MAAM,GAAG,WAAW;UAC1C,CAAC,MAAM;YACH,IAAI,CAACtf,MAAM,CAACqf,KAAK,CAACC,MAAM,GAAG,WAAW;UAC1C;QACJ;MACJ,CAAC,MAAM;QAAE;;QAEL;QACZ,IAAIuD,SAAS,GAAG,IAAI;QACpB,KAAK,IAAIj8B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAC4xB,aAAa,CAACtyB,MAAM,EAAE,EAAEU,CAAC,EAAE;UACnD,IAAI8V,IAAI,GAAG,IAAI,CAAC8b,aAAa,CAAC5xB,CAAC,CAAC;UAChC,IAAIytB,MAAM,GAAG3X,IAAI,CAACuJ,IAAI;UACtB,IACC,CAACoO,MAAM,IACP/uB,CAAC,CAAC04B,OAAO,GAAG3J,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,IACzB/uB,CAAC,CAAC04B,OAAO,GAAG3J,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,IACzB/uB,CAAC,CAAC24B,OAAO,GAAG5J,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,IACzB/uB,CAAC,CAAC24B,OAAO,GAAG5J,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,EACxB;YACD;UACD;UACAwO,SAAS,GAAGnmB,IAAI;UAChB;QACD;QACA,IAAImmB,SAAS,IAAI,IAAI,CAACvK,gBAAgB,EACtC;UACC,IAAI,CAACA,gBAAgB,GAAGuK,SAAS;UACrB,IAAI,CAACnJ,YAAY,GAAG,IAAI;QACrC;QAEA,IAAI,IAAI,CAAC1Z,MAAM,EAAE;UACJ,IAAI,CAACA,MAAM,CAACqf,KAAK,CAACC,MAAM,GAAG,EAAE;QAC1C;MACD,CAAC,CAAC;;MAEF;MACS,IAAK,IAAI,CAAC5P,oBAAoB,IAAI,IAAI,CAACA,oBAAoB,IAAI7c,IAAI,IAAI,IAAI,CAAC6c,oBAAoB,CAAC4S,WAAW,EAAG;QAC3G,IAAI,CAAC5S,oBAAoB,CAAC4S,WAAW,CAACh9B,CAAC,EAAC,CAACA,CAAC,CAAC04B,OAAO,GAAG,IAAI,CAACtO,oBAAoB,CAACxgB,GAAG,CAAC,CAAC,CAAC,EAAC5J,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAACvO,oBAAoB,CAACxgB,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;MAC9I;;MAET;MACS,IAAI,IAAI,CAACgR,YAAY,IAAI,CAAC,IAAI,CAAC0D,SAAS,EAAE;QAClD;QACY,KAAK,IAAIhd,CAAC,IAAI,IAAI,CAACqZ,cAAc,EAAE;UAC/B,IAAIY,CAAC,GAAG,IAAI,CAACZ,cAAc,CAACrZ,CAAC,CAAC;UAC9Bia,CAAC,CAAC3R,GAAG,CAAC,CAAC,CAAC,IAAIukB,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACoB,EAAE,CAAC5E,KAAK;UACpCpP,CAAC,CAAC3R,GAAG,CAAC,CAAC,CAAC,IAAIukB,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACoB,EAAE,CAAC5E,KAAK;QACxC;QAEA,IAAI,CAACyJ,YAAY,GAAG,IAAI;QACxB,IAAI,CAACC,cAAc,GAAG,IAAI;MAC9B;MAEA,IAAI,IAAI,CAACyF,aAAa,IAAI,CAAC,IAAI,CAACxb,SAAS,EAAE;QACvC;QACZ,IAAIkf,YAAY,GAAG,CAAEx9B,CAAC,CAAC04B,OAAO,GAAG,IAAI,CAACoB,aAAa,CAAClwB,GAAG,CAAC,CAAC,CAAC,EAAE5J,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAACmB,aAAa,CAAClwB,GAAG,CAAC,CAAC,CAAC,CAAE;QACnG,IAAI6zB,QAAQ,GAAG,IAAI,CAAC3D,aAAa,CAACjsB,WAAW,EAAE;QAC/C2vB,YAAY,CAAC,CAAC,CAAC,GAAG3Z,IAAI,CAACmB,GAAG,CAAEyY,QAAQ,CAAC,CAAC,CAAC,EAAED,YAAY,CAAC,CAAC,CAAC,CAAE;QAC1DA,YAAY,CAAC,CAAC,CAAC,GAAG3Z,IAAI,CAACmB,GAAG,CAAEyY,QAAQ,CAAC,CAAC,CAAC,EAAED,YAAY,CAAC,CAAC,CAAC,CAAE;QAC1D,IAAI,CAAC1D,aAAa,CAACxV,OAAO,CAAEkZ,YAAY,CAAE;QAE9B,IAAI,CAAC9iB,MAAM,CAACqf,KAAK,CAACC,MAAM,GAAG,WAAW;QACtC,IAAI,CAAC5F,YAAY,GAAG,IAAI;QACxB,IAAI,CAACC,cAAc,GAAG,IAAI;MAC9B;IACJ;IAEAr0B,CAAC,CAACsuB,cAAc,EAAE;IAClB,OAAO,KAAK;EAChB,CAAC;;EAED;AACJ;AACA;AACA;EACIzZ,YAAY,CAACnT,SAAS,CAACq1B,cAAc,GAAG,UAAS/2B,CAAC,EAAE;IAEtD,IAAI84B,UAAU,GAAK94B,CAAC,CAAC+4B,SAAS,KAAKtf,SAAS,IAAIzZ,CAAC,CAAC+4B,SAAW;;IAE1D;IACA,IAAG,CAACD,UAAU,EAAC;MACd;AACN;MACM;MACA,OAAO,KAAK;IACb;;IAEA;;IAEH,IAAI,IAAI,CAAC3H,+BAA+B,EACvC,IAAI,CAACiD,YAAY,GAAG,IAAI;IAEnB,IAAI,CAAC,IAAI,CAACtf,KAAK,EACX;IAEJ,IAAIO,MAAM,GAAG,IAAI,CAACkhB,eAAe,EAAE;IACnC,IAAI3nB,QAAQ,GAAGyG,MAAM,CAACzG,QAAQ;IAC9BiG,YAAY,CAAC4jB,aAAa,GAAG,IAAI;;IAEjC;IACN,IAAG,CAAC,IAAI,CAACnrB,OAAO,CAACue,WAAW,EAC5B;MACC;MACA1oB,SAAS,CAACyqB,qBAAqB,CAAChf,QAAQ,EAAC,MAAM,EAAE,IAAI,CAACgoB,mBAAmB,EAAC,IAAI,CAAC;MAC/EzzB,SAAS,CAACopB,kBAAkB,CAAC,IAAI,CAAC7R,MAAM,EAAC,MAAM,EAAE,IAAI,CAACkc,mBAAmB,EAAC,IAAI,CAAC;MAC/EzzB,SAAS,CAACyqB,qBAAqB,CAAChf,QAAQ,EAAC,IAAI,EAAE,IAAI,CAACkoB,iBAAiB,EAAC,IAAI,CAAC;IAC5E;IAEM,IAAI,CAAC0B,gBAAgB,CAACx4B,CAAC,CAAC;IACxB,IAAI8R,GAAG,GAAG3O,SAAS,CAAC0O,OAAO,EAAE;IAC7B7R,CAAC,CAAC09B,UAAU,GAAG5rB,GAAG,GAAG,IAAI,CAAC0iB,eAAe;IACzC,IAAI,CAACgI,mBAAmB,GAAG,KAAK;IACtC,IAAI,CAACvD,mBAAmB,GAAG,IAAI;IAE/B,IAAG,IAAI,CAACV,WAAW,EACnB;MACC;MACA,IAAI,CAACA,WAAW,GAAG,KAAK,CAAC,CAAC;IAC3B;;IAEA;;IAEM,IAAIv4B,CAAC,CAACo5B,KAAK,IAAI,CAAC,EAAE;MAEvB,IAAI,IAAI,CAACrG,WAAW,EACpB;QACC,IAAI,CAAC4H,kBAAkB,CAAE,IAAI,CAAC5H,WAAW,CAAC,CAAC,CAAC,EAAE,IAAI,CAACd,WAAW,EAAEjyB,CAAC,CAAE;MACpE;;MAES;MACA,IAAI,CAAC+yB,WAAW,GAAG,IAAI;MAEvB,IAAI,IAAI,CAACe,cAAc,EAAE;QACrB,IAAI6J,KAAK,GACL,IAAI,CAAC7J,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,GAC1Bia,IAAI,CAAC4F,KAAK,CAAC,IAAI,CAACqK,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,CAAC;QAC1C,IAAIg0B,KAAK,GACL,IAAI,CAAC9J,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,GAC1Bia,IAAI,CAAC4F,KAAK,CAAC,IAAI,CAACqK,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,CAAC;QAC1C,IAAI,CAACkqB,cAAc,CAAC1I,IAAI,CAACuS,KAAK,EAAEC,KAAK,EAAE59B,CAAC,CAACq5B,OAAO,CAAC;QACjD,IAAI,CAACvF,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,GAAGia,IAAI,CAAC4F,KAAK,CACnC,IAAI,CAACqK,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,CAC7B;QACD,IAAI,CAACkqB,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,GAAGia,IAAI,CAAC4F,KAAK,CACnC,IAAI,CAACqK,cAAc,CAAClqB,GAAG,CAAC,CAAC,CAAC,CAC7B;QACD,IAAI,IAAI,CAACkqB,cAAc,CAAC7gB,MAAM,CAACrS,MAAM,EAAE;UACnC,IAAI,CAACwzB,YAAY,GAAG,IAAI;QAC5B;QACA,IAAI,CAACN,cAAc,GAAG,IAAI;MAC9B;MACA,IAAI,CAACoH,uBAAuB,GAAG,KAAK;MAE7C,IAAI3tB,IAAI,GAAG,IAAI,CAACuH,KAAK,CAACsG,YAAY,CAC9Bpb,CAAC,CAAC04B,OAAO,EACT14B,CAAC,CAAC24B,OAAO,EACT,IAAI,CAAC5E,aAAa,CAClB;MAEK,IAAI,IAAI,CAAC7C,kBAAkB,EAAE;QACzB,IAAI,IAAI,CAACpc,KAAK,EAAE;UACZ,IAAIjJ,KAAK,GAAG,IAAI,CAACiJ,KAAK,CAAC7B,MAAM;UAC7B,IAAIwY,aAAa,GAAG,IAAI7K,YAAY,CAAC,CAAC,CAAC;;UAEvC;UACA,IAAIO,CAAC,GAAG0C,IAAI,CAACmL,GAAG,CAAC,IAAI,CAACkC,kBAAkB,CAAC,CAAC,CAAC,CAAC;UAC5C,IAAI2M,CAAC,GAAGha,IAAI,CAACmL,GAAG,CAAC,IAAI,CAACkC,kBAAkB,CAAC,CAAC,CAAC,CAAC;UAC5C,IAAItE,MAAM,GACN,IAAI,CAACsE,kBAAkB,CAAC,CAAC,CAAC,GAAG,CAAC,GACxB,IAAI,CAACA,kBAAkB,CAAC,CAAC,CAAC,GAAG/P,CAAC,GAC9B,IAAI,CAAC+P,kBAAkB,CAAC,CAAC,CAAC;UACpC,IAAIrE,MAAM,GACN,IAAI,CAACqE,kBAAkB,CAAC,CAAC,CAAC,GAAG,CAAC,GACxB,IAAI,CAACA,kBAAkB,CAAC,CAAC,CAAC,GAAG2M,CAAC,GAC9B,IAAI,CAAC3M,kBAAkB,CAAC,CAAC,CAAC;UACpC,IAAI,CAACA,kBAAkB,CAAC,CAAC,CAAC,GAAGtE,MAAM;UACnC,IAAI,CAACsE,kBAAkB,CAAC,CAAC,CAAC,GAAGrE,MAAM;UACnC,IAAI,CAACqE,kBAAkB,CAAC,CAAC,CAAC,GAAG/P,CAAC;UAC9B,IAAI,CAAC+P,kBAAkB,CAAC,CAAC,CAAC,GAAG2M,CAAC;;UAE7C;UACA,IAAI,CAACtwB,IAAI,IAAK4T,CAAC,GAAG,EAAE,IAAI0c,CAAC,GAAG,EAAI,EAAC;YAChC;YACA,IAAIC,SAAS,GAAG,EAAE;YAClB,KAAK,IAAIx8B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuK,KAAK,CAACjL,MAAM,EAAE,EAAEU,CAAC,EAAE;cACtC,IAAIy8B,KAAK,GAAGlyB,KAAK,CAACvK,CAAC,CAAC;cACpBy8B,KAAK,CAAC1X,WAAW,CAACoF,aAAa,CAAC;cAChC,IACC,CAACC,eAAe,CACf,IAAI,CAACwF,kBAAkB,EACvBzF,aAAa,CACb,EACA;gBACD;cACD,CAAC,CAAC;cACFqS,SAAS,CAACv8B,IAAI,CAACw8B,KAAK,CAAC;YACtB;YACA,IAAID,SAAS,CAACl9B,MAAM,EAAE;cACrB,IAAI,CAAC20B,WAAW,CAACuI,SAAS,EAAC99B,CAAC,CAACq6B,QAAQ,CAAC,CAAC,CAAC;YACzC;UACD,CAAC,MAAI;YACJ;YACA,IAAI,CAAC9E,WAAW,CAAC,CAAChoB,IAAI,CAAC,EAACvN,CAAC,CAACq6B,QAAQ,IAAEr6B,CAAC,CAACq5B,OAAO,CAAC,CAAC,CAAC;UACjD;QAEW;;QACA,IAAI,CAACnI,kBAAkB,GAAG,IAAI;MAClC,CAAC,MAAM,IAAI,IAAI,CAAC+C,eAAe,EAAE;QAC7B;QACA,IAAI,CAACG,YAAY,GAAG,IAAI;QACxB,IAAI,CAACC,cAAc,GAAG,IAAI;QAE1B,IAAI2J,WAAW,GAAG,IAAI,CAAC/D,iBAAiB,IAAI,IAAI,CAACS,gBAAgB;QACjE,IAAIuD,QAAQ,GAAGD,WAAW,CAAC30B,IAAI;;QAE/B;QACA,IAAIkE,IAAI,EAAE;UAEN;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;UAEwB;;UAEA,IAAI,IAAI,CAAC0sB,iBAAiB,EAAC;YAEvB,IAAI1f,IAAI,GAAG,IAAI,CAAC4iB,eAAe,CAC3B5vB,IAAI,EACJvN,CAAC,CAAC04B,OAAO,EACT14B,CAAC,CAAC24B,OAAO,CACZ;YACD,IAAIpe,IAAI,IAAI,CAAC,CAAC,EAAE;cACZ,IAAI,CAAC0Z,eAAe,CAACzL,OAAO,CAAC,IAAI,CAAC4R,eAAe,EAAE7sB,IAAI,EAAEgN,IAAI,CAAC;YAClE,CAAC,MAAM;cACH;cACA;cACA,IAAI,CAAC0Z,eAAe,CAAC/L,aAAa,CAAC,IAAI,CAACkS,eAAe,EAAC7sB,IAAI,EAAC0wB,QAAQ,CAAC;YAC1E;UAEJ,CAAC,MAAK,IAAI,IAAI,CAACvD,gBAAgB,EAAC;YAE5B,IAAIngB,IAAI,GAAG,IAAI,CAAC+iB,gBAAgB,CAC5B/vB,IAAI,EACJvN,CAAC,CAAC04B,OAAO,EACT14B,CAAC,CAAC24B,OAAO,CACZ;YAED,IAAIpe,IAAI,IAAI,CAAC,CAAC,EAAE;cACZhN,IAAI,CAACib,OAAO,CAACjO,IAAI,EAAE,IAAI,CAAC0Z,eAAe,EAAE,IAAI,CAACmG,eAAe,CAAC,CAAC,CAAC;YACpE,CAAC,MAAM;cACH;cACA;cACA,IAAI,CAACnG,eAAe,CAACxL,mBAAmB,CAAC,IAAI,CAAC2R,eAAe,EAAC7sB,IAAI,EAAC0wB,QAAQ,CAAC;YAChF;UAEJ;;UAGJ;QAEJ,CAAC,MAAI;UAED;UACH,IAAI96B,SAAS,CAAC+F,gCAAgC,EAAC;YAC3C,IAAIlJ,CAAC,CAACq6B,QAAQ,IAAI,IAAI,CAACtJ,eAAe,EAAC;cACnC,IAAG,IAAI,CAACkJ,iBAAiB,EAAC;gBACtB,IAAI,CAACoB,aAAa,CAACr7B,CAAC,EAAC;kBAACk+B,SAAS,EAAE,IAAI,CAACjK,eAAe;kBAAEkK,SAAS,EAAE,IAAI,CAAClE,iBAAiB;kBAAEmE,cAAc,EAAE,IAAI,CAACnE,iBAAiB,CAAC5wB;gBAAI,CAAC,CAAC;cAC3I,CAAC,MAAK,IAAG,IAAI,CAACqxB,gBAAgB,EAAC;gBAC3B,IAAI,CAACW,aAAa,CAACr7B,CAAC,EAAC;kBAACq+B,OAAO,EAAE,IAAI,CAACpK,eAAe;kBAAEkK,SAAS,EAAE,IAAI,CAACzD,gBAAgB;kBAAE4D,eAAe,EAAE,IAAI,CAAC5D,gBAAgB,CAACrxB;gBAAI,CAAC,CAAC;cACxI;YACJ,CAAC,MAAI;cACD,IAAG,IAAI,CAAC4wB,iBAAiB,EAAC;gBACtB,IAAI,CAACsE,kBAAkB,CAAC;kBAAC1C,QAAQ,EAAE,IAAI,CAAC5H,eAAe;kBAAE6H,QAAQ,EAAE,IAAI,CAAC7B,iBAAiB;kBAAEj6B,CAAC,EAAEA;gBAAC,CAAC,CAAC;cACrG,CAAC,MAAK,IAAG,IAAI,CAAC06B,gBAAgB,EAAC;gBAC3B,IAAI,CAAC6D,kBAAkB,CAAC;kBAACxC,MAAM,EAAE,IAAI,CAAC9H,eAAe;kBAAE+H,MAAM,EAAE,IAAI,CAACtB,gBAAgB;kBAAE16B,CAAC,EAAEA;gBAAC,CAAC,CAAC;cAChG;YACJ;UACJ;QACD;QAEA,IAAI,CAACi6B,iBAAiB,GAAG,IAAI;QAC7B,IAAI,CAACS,gBAAgB,GAAG,IAAI;QAC5B,IAAI,CAACP,cAAc,GAAG,IAAI;QAC1B,IAAI,CAAClG,eAAe,GAAG,IAAI;QAC3B,IAAI,CAACmG,eAAe,GAAG,CAAC,CAAC;MAC7B,CAAC,CAAC;MAAA,KACG,IAAI,IAAI,CAACN,aAAa,EAAE;QACzB,IAAI,CAAC1F,YAAY,GAAG,IAAI;QACxB,IAAI,CAACC,cAAc,GAAG,IAAI;QACtC,IAAI,CAACvf,KAAK,CAACgG,WAAW,CAAC,IAAI,CAACgf,aAAa,CAAC;QAC9B,IAAI,CAACA,aAAa,GAAG,IAAI;MAC7B,CAAC,MAAM,IAAI,IAAI,CAAClf,YAAY,EAAE;QAC1B;QACA,IAAIrN,IAAI,GAAG,IAAI,CAACqN,YAAY;QAC5B,IACIrN,IAAI,IACJvN,CAAC,CAAC09B,UAAU,GAAG,GAAG,IAClBhX,iBAAiB,CAAE1mB,CAAC,CAAC04B,OAAO,EAAE14B,CAAC,CAAC24B,OAAO,EAAEprB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,EAAE2D,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB,EAAEH,SAAS,CAACG,iBAAiB,EAAEH,SAAS,CAACG,iBAAiB,CAAE,EAC7J;UACEiK,IAAI,CAAC8c,QAAQ,EAAE;QACnB;QAEA,IAAI,CAAC+J,YAAY,GAAG,IAAI;QACxB,IAAI,CAACC,cAAc,GAAG,IAAI;QAC1B,IAAI,CAACzZ,YAAY,CAAChR,GAAG,CAAC,CAAC,CAAC,GAAGia,IAAI,CAAC4F,KAAK,CAAC,IAAI,CAAC7O,YAAY,CAAChR,GAAG,CAAC,CAAC,CAAC,CAAC;QAC/D,IAAI,CAACgR,YAAY,CAAChR,GAAG,CAAC,CAAC,CAAC,GAAGia,IAAI,CAAC4F,KAAK,CAAC,IAAI,CAAC7O,YAAY,CAAChR,GAAG,CAAC,CAAC,CAAC,CAAC;QAC/D,IAAI,IAAI,CAACkL,KAAK,CAACrB,MAAM,CAACuG,aAAa,IAAI,IAAI,CAACA,aAAa,EAAG;UACxD,IAAI,CAACY,YAAY,CAACX,WAAW,EAAE;QACnC;QACZ,IAAI,IAAI,CAACwY,WAAW,EACnB,IAAI,CAACA,WAAW,CAAE,IAAI,CAAC7X,YAAY,CAAE;QACtC,IAAI,CAAC9F,KAAK,CAACgG,WAAW,CAAC,IAAI,CAACF,YAAY,CAAC;QAC7B,IAAI,CAACA,YAAY,GAAG,IAAI;MAC5B,CAAC,CAAC;MAAA,KACG;QACD;QACA,IAAIrN,IAAI,GAAG,IAAI,CAACuH,KAAK,CAACsG,YAAY,CAC9Bpb,CAAC,CAAC04B,OAAO,EACT14B,CAAC,CAAC24B,OAAO,EACT,IAAI,CAAC5E,aAAa,CACrB;QAED,IAAI,CAACxmB,IAAI,IAAIvN,CAAC,CAAC09B,UAAU,GAAG,GAAG,EAAE;UAC7B,IAAI,CAACc,gBAAgB,EAAE;QAC3B;QAEA,IAAI,CAACpK,YAAY,GAAG,IAAI;QACxB,IAAI,CAACD,eAAe,GAAG,KAAK;QAE5B,IAAI,IAAI,CAACH,SAAS,IAAI,IAAI,CAACA,SAAS,CAACyK,SAAS,EAAE;UAC5C,IAAI,CAACzK,SAAS,CAACyK,SAAS,CAAEz+B,CAAC,EAAE,CAAEA,CAAC,CAAC04B,OAAO,GAAG,IAAI,CAAC1E,SAAS,CAACpqB,GAAG,CAAC,CAAC,CAAC,EAAE5J,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAAC3E,SAAS,CAACpqB,GAAG,CAAC,CAAC,CAAC,CAAE,EAAE,IAAI,CAAE;QACjH;QACA,IACI,IAAI,CAACwgB,oBAAoB,IACzB,IAAI,CAACA,oBAAoB,CAACqU,SAAS,EACrC;UACE,IAAI,CAACrU,oBAAoB,CAACqU,SAAS,CAACz+B,CAAC,EAAE,CACnCA,CAAC,CAAC04B,OAAO,GAAG,IAAI,CAACtO,oBAAoB,CAACxgB,GAAG,CAAC,CAAC,CAAC,EAC5C5J,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAACvO,oBAAoB,CAACxgB,GAAG,CAAC,CAAC,CAAC,CAC/C,CAAC;QACN;MACJ;IACJ,CAAC,MAAM,IAAI5J,CAAC,CAACo5B,KAAK,IAAI,CAAC,EAAE;MACrB;MACA;MACA,IAAI,CAAChF,YAAY,GAAG,IAAI;MACxB,IAAI,CAACD,eAAe,GAAG,KAAK;IAChC,CAAC,MAAM,IAAIn0B,CAAC,CAACo5B,KAAK,IAAI,CAAC,EAAE;MACrB;MACA;MACA,IAAI,CAAChF,YAAY,GAAG,IAAI;MACxB,IAAI,CAACD,eAAe,GAAG,KAAK;IAChC;;IAEA;AACR;AACA;AACA;;IAEI,IAAI2E,UAAU,EAChB;MACC,IAAI,CAACrE,eAAe,GAAG,KAAK;MAC5B,IAAI,CAACC,iBAAiB,GAAG,KAAK;IAC/B;IAEM,IAAI,CAAC5f,KAAK,CAACL,MAAM,EAAE;;IAEnB;IACAzU,CAAC,CAACuuB,eAAe,EAAE;IACnBvuB,CAAC,CAACsuB,cAAc,EAAE;IAClB,OAAO,KAAK;EAChB,CAAC;;EAED;AACJ;AACA;AACA;EACIzZ,YAAY,CAACnT,SAAS,CAACi1B,iBAAiB,GAAG,UAAS32B,CAAC,EAAE;IACnD,IAAI,CAAC,IAAI,CAAC8U,KAAK,IAAI,CAAC,IAAI,CAAC8b,gBAAgB,EAAE;MACvC;IACJ;IAEA,IAAIzC,KAAK,GAAGnuB,CAAC,CAACiuB,WAAW,IAAI,IAAI,GAAGjuB,CAAC,CAACiuB,WAAW,GAAGjuB,CAAC,CAACkuB,MAAM,GAAG,CAAC,EAAE;IAElE,IAAI,CAACsK,gBAAgB,CAACx4B,CAAC,CAAC;IAE9B,IAAI8Y,CAAC,GAAG9Y,CAAC,CAACktB,OAAO;IACjB,IAAIjU,CAAC,GAAGjZ,CAAC,CAACotB,OAAO;IACjB,IAAIK,SAAS,GAAG,CAAC,IAAI,CAAChB,QAAQ,IAAM,IAAI,CAACA,QAAQ,IAAI3T,CAAC,IAAI,IAAI,CAAC2T,QAAQ,CAAC,CAAC,CAAC,IAAI3T,CAAC,GAAI,IAAI,CAAC2T,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,QAAQ,CAAC,CAAC,CAAE,IAAIxT,CAAC,IAAI,IAAI,CAACwT,QAAQ,CAAC,CAAC,CAAC,IAAIxT,CAAC,GAAI,IAAI,CAACwT,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,QAAQ,CAAC,CAAC,CAAI;IAC/L,IAAG,CAACgB,SAAS,EACZ;IAEK,IAAI9C,KAAK,GAAG,IAAI,CAAC4E,EAAE,CAAC5E,KAAK;IAEzB,IAAIwD,KAAK,GAAG,CAAC,EAAE;MACXxD,KAAK,IAAI,GAAG;IAChB,CAAC,MAAM,IAAIwD,KAAK,GAAG,CAAC,EAAE;MAClBxD,KAAK,IAAI,CAAC,GAAG,GAAG;IACpB;;IAEA;IACA,IAAI,CAAC4E,EAAE,CAACV,WAAW,CAAClE,KAAK,EAAE,CAAC3qB,CAAC,CAACktB,OAAO,EAAEltB,CAAC,CAACotB,OAAO,CAAC,CAAC;IAElD,IAAI,CAACtY,KAAK,CAACL,MAAM,EAAE;IAEnBzU,CAAC,CAACsuB,cAAc,EAAE;IAClB,OAAO,KAAK,CAAC,CAAC;EAClB,CAAC;;EAED;AACJ;AACA;AACA;EACIzZ,YAAY,CAACnT,SAAS,CAACw7B,aAAa,GAAG,UAAS3vB,IAAI,EAAE+f,OAAO,EAAEC,OAAO,EAAE;IACpE,IAAImR,YAAY,GAAGv7B,SAAS,CAACG,iBAAiB;IAC9C,IACIojB,iBAAiB,CACb4G,OAAO,EACPC,OAAO,EACPhgB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EACf2D,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG80B,YAAY,EAC9BA,YAAY,GAAG,CAAC,EAChBA,YAAY,GAAG,CAAC,CACnB,EACH;MACE,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB,CAAC;;EAED;AACJ;AACA;AACA;EACI7pB,YAAY,CAACnT,SAAS,CAACy7B,eAAe,GAAG,UACrC5vB,IAAI,EACJ+f,OAAO,EACPC,OAAO,EACPoR,QAAQ,EACV;IACE,IAAIpxB,IAAI,CAACgH,MAAM,EAAE;MACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG1J,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;QAChD,IAAIiX,KAAK,GAAGhL,IAAI,CAACgH,MAAM,CAACjT,CAAC,CAAC;QAC1B,IAAIulB,QAAQ,GAAGtZ,IAAI,CAACuZ,gBAAgB,CAAC,IAAI,EAAExlB,CAAC,CAAC;QAC7C,IAAImsB,SAAS,GAAG,KAAK;QACrB,IAAIlgB,IAAI,CAACic,UAAU,EAAE;UACjBiE,SAAS,GAAG/G,iBAAiB,CACzB4G,OAAO,EACPC,OAAO,EACP1G,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,EACfA,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAChB,EAAE,EACF,EAAE,CACL;QACL,CAAC,MAAM;UACH4G,SAAS,GAAG/G,iBAAiB,CACzB4G,OAAO,EACPC,OAAO,EACP1G,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAChBA,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,EACf,EAAE,EACF,EAAE,CACL;QACL;QACA,IAAI4G,SAAS,EAAE;UACX,IAAIkR,QAAQ,EAAE;YACVA,QAAQ,CAAC,CAAC,CAAC,GAAG9X,QAAQ,CAAC,CAAC,CAAC;YACzB8X,QAAQ,CAAC,CAAC,CAAC,GAAG9X,QAAQ,CAAC,CAAC,CAAC;UAC7B;UACA,OAAOvlB,CAAC;QACZ;MACJ;IACJ;IACA,OAAO,CAAC,CAAC;EACb,CAAC;;EAED;AACJ;AACA;AACA;EACIuT,YAAY,CAACnT,SAAS,CAAC47B,gBAAgB,GAAG,UACtC/vB,IAAI,EACJ+f,OAAO,EACPC,OAAO,EACPoR,QAAQ,EACV;IACE,IAAIpxB,IAAI,CAACiH,OAAO,EAAE;MACd,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG1J,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;QACjD,IAAIiW,MAAM,GAAGhK,IAAI,CAACiH,OAAO,CAAClT,CAAC,CAAC;QAC5B,IAAIulB,QAAQ,GAAGtZ,IAAI,CAACuZ,gBAAgB,CAAC,KAAK,EAAExlB,CAAC,CAAC;QAC9C,IAAImsB,SAAS,GAAG,KAAK;QACrB,IAAIlgB,IAAI,CAACic,UAAU,EAAE;UACjBiE,SAAS,GAAG/G,iBAAiB,CACzB4G,OAAO,EACPC,OAAO,EACP1G,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,EACfA,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAChB,EAAE,EACF,EAAE,CACL;QACL,CAAC,MAAM;UACH4G,SAAS,GAAG/G,iBAAiB,CACzB4G,OAAO,EACPC,OAAO,EACP1G,QAAQ,CAAC,CAAC,CAAC,GAAG,EAAE,EAChBA,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,EACf,EAAE,EACF,EAAE,CACL;QACL;QACA,IAAI4G,SAAS,EAAE;UACX,IAAIkR,QAAQ,EAAE;YACVA,QAAQ,CAAC,CAAC,CAAC,GAAG9X,QAAQ,CAAC,CAAC,CAAC;YACzB8X,QAAQ,CAAC,CAAC,CAAC,GAAG9X,QAAQ,CAAC,CAAC,CAAC;UAC7B;UACA,OAAOvlB,CAAC;QACZ;MACJ;IACJ;IACA,OAAO,CAAC,CAAC;EACb,CAAC;;EAED;AACJ;AACA;AACA;EACIuT,YAAY,CAACnT,SAAS,CAACu1B,UAAU,GAAG,UAASj3B,CAAC,EAAE;IAC5C,IAAI,CAAC,IAAI,CAAC8U,KAAK,EAAE;MACb;IACJ;IAEA,IAAI8pB,aAAa,GAAG,KAAK;IACzB;;IAEA,IAAI5+B,CAAC,CAACyP,MAAM,CAACsmB,SAAS,IAAI,OAAO,EAAE;MAC/B;IACJ;IAEA,IAAI/1B,CAAC,CAACqJ,IAAI,IAAI,SAAS,EAAE;MACrB,IAAIrJ,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;QACjB;QACA,IAAI,CAAC1K,eAAe,GAAG,IAAI;QAC3ByK,aAAa,GAAG,IAAI;MACxB;MAEA,IAAI5+B,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;QACjB;QACA,IAAG,IAAI,CAACC,UAAU,EAAE,IAAI,CAACA,UAAU,CAACC,KAAK,EAAE;QAC3C,IAAG,IAAI,CAACC,aAAa,EAAE,IAAI,CAACA,aAAa,CAACD,KAAK,EAAE;QACjDH,aAAa,GAAG,IAAI;MACxB;;MAEA;MACA,IAAI5+B,CAAC,CAAC6+B,OAAO,IAAI,EAAE,IAAI7+B,CAAC,CAACq5B,OAAO,EAAE;QAC9B,IAAI,CAAC9D,WAAW,EAAE;QAClBqJ,aAAa,GAAG,IAAI;MACxB;MAEA,IAAI5+B,CAAC,CAACsM,IAAI,IAAI,MAAM,KAAKtM,CAAC,CAACs8B,OAAO,IAAIt8B,CAAC,CAACq5B,OAAO,CAAC,IAAI,CAACr5B,CAAC,CAACq6B,QAAQ,EAAE;QAC7D;QACA,IAAI,IAAI,CAAC1f,cAAc,EAAE;UACrB,IAAI,CAACskB,eAAe,EAAE;UACtBL,aAAa,GAAG,IAAI;QACxB;MACJ;MAEA,IAAI5+B,CAAC,CAACsM,IAAI,IAAI,MAAM,KAAKtM,CAAC,CAACs8B,OAAO,IAAIt8B,CAAC,CAACq5B,OAAO,CAAC,IAAI,CAACr5B,CAAC,CAACq6B,QAAQ,EAAE;QAC7D;QACA,IAAI,CAAC6E,kBAAkB,EAAE;MAC7B;;MAEA;MACA,IAAIl/B,CAAC,CAAC6+B,OAAO,IAAI,EAAE,IAAI7+B,CAAC,CAAC6+B,OAAO,IAAI,CAAC,EAAE;QACnC,IACI7+B,CAAC,CAACyP,MAAM,CAACsmB,SAAS,IAAI,OAAO,IAC7B/1B,CAAC,CAACyP,MAAM,CAACsmB,SAAS,IAAI,UAAU,EAClC;UACE,IAAI,CAACoJ,mBAAmB,EAAE;UAC1BP,aAAa,GAAG,IAAI;QACxB;MACJ;;MAEA;MACA;;MAEA;MACA,IAAI,IAAI,CAACjkB,cAAc,EAAE;QACrB,KAAK,IAAIrZ,CAAC,IAAI,IAAI,CAACqZ,cAAc,EAAE;UAC/B,IAAI,IAAI,CAACA,cAAc,CAACrZ,CAAC,CAAC,CAAC89B,SAAS,EAAE;YAClC,IAAI,CAACzkB,cAAc,CAACrZ,CAAC,CAAC,CAAC89B,SAAS,CAACp/B,CAAC,CAAC;UACvC;QACJ;MACJ;IACJ,CAAC,MAAM,IAAIA,CAAC,CAACqJ,IAAI,IAAI,OAAO,EAAE;MAC1B,IAAIrJ,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;QACjB;QACA,IAAI,CAAC1K,eAAe,GAAG,KAAK;MAChC;MAEA,IAAI,IAAI,CAACxZ,cAAc,EAAE;QACrB,KAAK,IAAIrZ,CAAC,IAAI,IAAI,CAACqZ,cAAc,EAAE;UAC/B,IAAI,IAAI,CAACA,cAAc,CAACrZ,CAAC,CAAC,CAAC+9B,OAAO,EAAE;YAChC,IAAI,CAAC1kB,cAAc,CAACrZ,CAAC,CAAC,CAAC+9B,OAAO,CAACr/B,CAAC,CAAC;UACrC;QACJ;MACJ;IACJ;IAEA,IAAI,CAAC8U,KAAK,CAACL,MAAM,EAAE;IAEnB,IAAImqB,aAAa,EAAE;MACf5+B,CAAC,CAACsuB,cAAc,EAAE;MAClBtuB,CAAC,CAACs/B,wBAAwB,EAAE;MAC5B,OAAO,KAAK;IAChB;EACJ,CAAC;EAEDzqB,YAAY,CAACnT,SAAS,CAACu9B,eAAe,GAAG,YAAW;IAChD,IAAIM,cAAc,GAAG;MACjB1zB,KAAK,EAAE,EAAE;MACT0H,KAAK,EAAE;IACX,CAAC;IACD,IAAI6G,KAAK,GAAG,CAAC;IACb,IAAIolB,oBAAoB,GAAG,EAAE;IAC7B,KAAK,IAAIl+B,CAAC,IAAI,IAAI,CAACqZ,cAAc,EAAE;MAC/B,IAAIpN,IAAI,GAAG,IAAI,CAACoN,cAAc,CAACrZ,CAAC,CAAC;MACjCiM,IAAI,CAACkyB,YAAY,GAAGrlB,KAAK;MACzBolB,oBAAoB,CAACj+B,IAAI,CAACgM,IAAI,CAAC;MAC/B6M,KAAK,IAAI,CAAC;IACd;IAEA,KAAK,IAAI9Y,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGk+B,oBAAoB,CAAC5+B,MAAM,EAAE,EAAEU,CAAC,EAAE;MAClD,IAAIiM,IAAI,GAAGiyB,oBAAoB,CAACl+B,CAAC,CAAC;MAC3C,IAAIi4B,MAAM,GAAGhsB,IAAI,CAACmU,KAAK,EAAE;MACzB,IAAG,CAAC6X,MAAM,EACV;QACChwB,OAAO,CAACqB,IAAI,CAAC,uBAAuB,GAAG2C,IAAI,CAAClE,IAAI,CAAE;QAClD;MACD;MACSk2B,cAAc,CAAC1zB,KAAK,CAACtK,IAAI,CAACg4B,MAAM,CAACxd,SAAS,EAAE,CAAC;MAC7C,IAAIxO,IAAI,CAACgH,MAAM,IAAIhH,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAE;QACnC,KAAK,IAAIqP,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG1C,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAE,EAAEqP,CAAC,EAAE;UACzC,IAAIsI,KAAK,GAAGhL,IAAI,CAACgH,MAAM,CAACtE,CAAC,CAAC;UAC1B,IAAI,CAACsI,KAAK,IAAIA,KAAK,CAACnB,IAAI,IAAI,IAAI,EAAE;YAC9B;UACJ;UACA,IAAI+G,SAAS,GAAG,IAAI,CAACrJ,KAAK,CAACvB,KAAK,CAACgF,KAAK,CAACnB,IAAI,CAAC;UAC5C,IAAI,CAAC+G,SAAS,EAAE;YACZ;UACJ;UACA,IAAI1G,WAAW,GAAG,IAAI,CAAC3C,KAAK,CAAC4C,WAAW,CACpCyG,SAAS,CAACqC,SAAS,CACtB;UACD,IAAI,CAAC/I,WAAW,IAAI,CAAC,IAAI,CAACkD,cAAc,CAAClD,WAAW,CAACP,EAAE,CAAC,EAAE;YACtD;YACA;UACJ,CAAC,CAAC;UACFqoB,cAAc,CAAChsB,KAAK,CAAChS,IAAI,CAAC,CACtBkW,WAAW,CAACgoB,YAAY,EACxBthB,SAAS,CAACsC,WAAW;UAAE;UACvBlT,IAAI,CAACkyB,YAAY,EACjBthB,SAAS,CAACU,WAAW,CACxB,CAAC;QACN;MACJ;IACJ;IACA6gB,YAAY,CAACC,OAAO,CAChB,2BAA2B,EAC3BlzB,IAAI,CAACC,SAAS,CAAC6yB,cAAc,CAAC,CACjC;EACL,CAAC;EAED1qB,YAAY,CAACnT,SAAS,CAACw9B,kBAAkB,GAAG,YAAW;IACnD,IAAI7uB,IAAI,GAAGqvB,YAAY,CAACE,OAAO,CAAC,2BAA2B,CAAC;IAC5D,IAAI,CAACvvB,IAAI,EAAE;MACP;IACJ;IAEN,IAAI,CAACyE,KAAK,CAACwF,YAAY,EAAE;;IAEnB;IACA,IAAIilB,cAAc,GAAG9yB,IAAI,CAACiD,KAAK,CAACW,IAAI,CAAC;IACrC;IACA,IAAIwvB,MAAM,GAAG,KAAK;IAClB,IAAIC,aAAa,GAAG,KAAK;IACzB,KAAK,IAAIx+B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGi+B,cAAc,CAAC1zB,KAAK,CAACjL,MAAM,EAAE,EAAEU,CAAC,EAAE;MAClD,IAAIu+B,MAAM,EAAC;QACP,IAAGA,MAAM,CAAC,CAAC,CAAC,GAACN,cAAc,CAAC1zB,KAAK,CAACvK,CAAC,CAAC,CAACsI,GAAG,CAAC,CAAC,CAAC,EAAC;UACxCi2B,MAAM,CAAC,CAAC,CAAC,GAAGN,cAAc,CAAC1zB,KAAK,CAACvK,CAAC,CAAC,CAACsI,GAAG,CAAC,CAAC,CAAC;UAC1Ck2B,aAAa,CAAC,CAAC,CAAC,GAAGx+B,CAAC;QACxB;QACA,IAAGu+B,MAAM,CAAC,CAAC,CAAC,GAACN,cAAc,CAAC1zB,KAAK,CAACvK,CAAC,CAAC,CAACsI,GAAG,CAAC,CAAC,CAAC,EAAC;UACxCi2B,MAAM,CAAC,CAAC,CAAC,GAAGN,cAAc,CAAC1zB,KAAK,CAACvK,CAAC,CAAC,CAACsI,GAAG,CAAC,CAAC,CAAC;UAC1Ck2B,aAAa,CAAC,CAAC,CAAC,GAAGx+B,CAAC;QACxB;MACJ,CAAC,MACG;QACAu+B,MAAM,GAAG,CAACN,cAAc,CAAC1zB,KAAK,CAACvK,CAAC,CAAC,CAACsI,GAAG,CAAC,CAAC,CAAC,EAAE21B,cAAc,CAAC1zB,KAAK,CAACvK,CAAC,CAAC,CAACsI,GAAG,CAAC,CAAC,CAAC,CAAC;QACzEk2B,aAAa,GAAG,CAACx+B,CAAC,EAAEA,CAAC,CAAC;MAC1B;IACJ;IACA,IAAIuK,KAAK,GAAG,EAAE;IACd,KAAK,IAAIvK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGi+B,cAAc,CAAC1zB,KAAK,CAACjL,MAAM,EAAE,EAAEU,CAAC,EAAE;MAClD,IAAIy+B,SAAS,GAAGR,cAAc,CAAC1zB,KAAK,CAACvK,CAAC,CAAC;MACvC,IAAIiM,IAAI,GAAGpK,SAAS,CAACkK,UAAU,CAAC0yB,SAAS,CAAC12B,IAAI,CAAC;MAC/C,IAAIkE,IAAI,EAAE;QACNA,IAAI,CAACgF,SAAS,CAACwtB,SAAS,CAAC;;QAErC;QACYxyB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,IAAI,IAAI,CAACqoB,WAAW,CAAC,CAAC,CAAC,GAAG4N,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QAChDtyB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,IAAI,IAAI,CAACqoB,WAAW,CAAC,CAAC,CAAC,GAAG4N,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;;QAEhD,IAAI,CAAC/qB,KAAK,CAAC8E,GAAG,CAACrM,IAAI,EAAC;UAAC2b,eAAe,EAAC;QAAK,CAAC,CAAC;QAE5Crd,KAAK,CAACtK,IAAI,CAACgM,IAAI,CAAC;MACpB;IACJ;;IAEA;IACA,KAAK,IAAIjM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGi+B,cAAc,CAAChsB,KAAK,CAAC3S,MAAM,EAAE,EAAEU,CAAC,EAAE;MAClD,IAAI6c,SAAS,GAAGohB,cAAc,CAAChsB,KAAK,CAACjS,CAAC,CAAC;MACvC,IAAI0+B,WAAW,GAAGn0B,KAAK,CAACsS,SAAS,CAAC,CAAC,CAAC,CAAC;MACrC,IAAI1G,WAAW,GAAG5L,KAAK,CAACsS,SAAS,CAAC,CAAC,CAAC,CAAC;MAC9C,IAAI6hB,WAAW,IAAIvoB,WAAW,EACpBuoB,WAAW,CAACxX,OAAO,CAACrK,SAAS,CAAC,CAAC,CAAC,EAAE1G,WAAW,EAAE0G,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,KAEtE5U,OAAO,CAACqB,IAAI,CAAC,mCAAmC,CAAC;IAC7C;IAEA,IAAI,CAAC2qB,WAAW,CAAC1pB,KAAK,CAAC;IAE7B,IAAI,CAACiJ,KAAK,CAACgG,WAAW,EAAE;EACtB,CAAC;;EAED;AACJ;AACA;AACA;EACIjG,YAAY,CAACnT,SAAS,CAACy1B,WAAW,GAAG,UAASn3B,CAAC,EAAE;IAC7CA,CAAC,CAACsuB,cAAc,EAAE;IAClB,IAAI,CAACkK,gBAAgB,CAACx4B,CAAC,CAAC;IAC9B,IAAI8Y,CAAC,GAAG9Y,CAAC,CAACktB,OAAO;IACjB,IAAIjU,CAAC,GAAGjZ,CAAC,CAACotB,OAAO;IACjB,IAAIK,SAAS,GAAG,CAAC,IAAI,CAAChB,QAAQ,IAAM,IAAI,CAACA,QAAQ,IAAI3T,CAAC,IAAI,IAAI,CAAC2T,QAAQ,CAAC,CAAC,CAAC,IAAI3T,CAAC,GAAI,IAAI,CAAC2T,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,QAAQ,CAAC,CAAC,CAAE,IAAIxT,CAAC,IAAI,IAAI,CAACwT,QAAQ,CAAC,CAAC,CAAC,IAAIxT,CAAC,GAAI,IAAI,CAACwT,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAACA,QAAQ,CAAC,CAAC,CAAI;IAC/L,IAAG,CAACgB,SAAS,EAAC;MACb;MACA;IACD;;IAEM,IAAI7jB,GAAG,GAAG,CAAC5J,CAAC,CAAC04B,OAAO,EAAE14B,CAAC,CAAC24B,OAAO,CAAC;IAGhC,IAAIprB,IAAI,GAAG,IAAI,CAACuH,KAAK,GAAG,IAAI,CAACA,KAAK,CAACsG,YAAY,CAACxR,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;IAEtE,IAAI,CAAC2D,IAAI,EAAE;MACP,IAAIN,CAAC,GAAG,IAAI;MACZ,IAAI,IAAI,CAACgzB,UAAU,EAAE;QACjBhzB,CAAC,GAAG,IAAI,CAACgzB,UAAU,CAACngB,KAAK,CAAC;MAC9B;MACA,IAAI,CAAC7S,CAAC,EAAE;QACJ,IAAI,CAACizB,aAAa,CAAClgC,CAAC,CAAC;MACzB;MACA;IACJ;IAEA,IAAIuN,IAAI,CAAC4yB,UAAU,IAAI5yB,IAAI,CAAC6yB,UAAU,EAAE;MACpC,IAAIC,KAAK,GAAGrgC,CAAC,CAACsgC,YAAY,CAACD,KAAK;MAChC,IAAIA,KAAK,IAAIA,KAAK,CAACz/B,MAAM,EAAE;QACvB,KAAK,IAAIU,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG++B,KAAK,CAACz/B,MAAM,EAAEU,CAAC,EAAE,EAAE;UACnC,IAAIi/B,IAAI,GAAGvgC,CAAC,CAACsgC,YAAY,CAACD,KAAK,CAAC,CAAC,CAAC;UAClC,IAAIG,QAAQ,GAAGD,IAAI,CAAC39B,IAAI;UACxB,IAAIkI,GAAG,GAAG+J,YAAY,CAACwiB,gBAAgB,CAACmJ,QAAQ,CAAC;UACjD;;UAEA,IAAIjzB,IAAI,CAAC4yB,UAAU,EAAE;YACjB5yB,IAAI,CAAC4yB,UAAU,CAACI,IAAI,CAAC;UACzB;UAEA,IAAIhzB,IAAI,CAAC6yB,UAAU,EAAE;YACjB;YACA,IAAI9uB,MAAM,GAAG,IAAIC,UAAU,EAAE;YAC7BD,MAAM,CAACE,MAAM,GAAG,UAASsO,KAAK,EAAE;cAC5B;cACA,IAAIzP,IAAI,GAAGyP,KAAK,CAACrQ,MAAM,CAACjB,MAAM;cAC9BjB,IAAI,CAAC6yB,UAAU,CAAC/vB,IAAI,EAAEmwB,QAAQ,EAAED,IAAI,CAAC;YACzC,CAAC;;YAED;YACA,IAAIl3B,IAAI,GAAGk3B,IAAI,CAACl3B,IAAI,CAACK,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YAClC,IAAIL,IAAI,IAAI,MAAM,IAAIA,IAAI,IAAI,EAAE,EAAE;cAC9BiI,MAAM,CAACI,UAAU,CAAC6uB,IAAI,CAAC;YAC3B,CAAC,MAAM,IAAIl3B,IAAI,IAAI,OAAO,EAAE;cACxBiI,MAAM,CAACmvB,aAAa,CAACF,IAAI,CAAC;YAC9B,CAAC,MAAM;cACHjvB,MAAM,CAACG,iBAAiB,CAAC8uB,IAAI,CAAC;YAClC;UACJ;QACJ;MACJ;IACJ;IAEA,IAAIhzB,IAAI,CAAC0yB,UAAU,EAAE;MACjB,IAAI1yB,IAAI,CAAC0yB,UAAU,CAACngB,KAAK,CAAC,EAAE;QACxB,OAAO,IAAI;MACf;IACJ;IAEA,IAAI,IAAI,CAACmgB,UAAU,EAAE;MACjB,OAAO,IAAI,CAACA,UAAU,CAACngB,KAAK,CAAC;IACjC;IAEA,OAAO,KAAK;EAChB,CAAC;;EAED;EACAjL,YAAY,CAACnT,SAAS,CAACw+B,aAAa,GAAG,UAASlgC,CAAC,EAAE;IAC/C,IAAIA,CAAC,CAACsgC,YAAY,CAACD,KAAK,CAACz/B,MAAM,EAAE;MAC7B,IAAI2/B,IAAI,GAAGvgC,CAAC,CAACsgC,YAAY,CAACD,KAAK,CAAC,CAAC,CAAC;MAClC,IAAIv1B,GAAG,GAAG+J,YAAY,CAACwiB,gBAAgB,CAACkJ,IAAI,CAAC39B,IAAI,CAAC,CAACqI,WAAW,EAAE;MAChE,IAAIy1B,QAAQ,GAAGv9B,SAAS,CAACsE,4BAA4B,CAACqD,GAAG,CAAC;MAC1D,IAAI41B,QAAQ,EAAE;QACtB,IAAI,CAAC5rB,KAAK,CAACwF,YAAY,EAAE;QACb,IAAI/M,IAAI,GAAGpK,SAAS,CAACkK,UAAU,CAACqzB,QAAQ,CAACr3B,IAAI,CAAC;QAC9CkE,IAAI,CAAC3D,GAAG,GAAG,CAAC5J,CAAC,CAAC04B,OAAO,EAAE14B,CAAC,CAAC24B,OAAO,CAAC;QACjC,IAAI,CAAC7jB,KAAK,CAAC8E,GAAG,CAACrM,IAAI,CAAC;QACpB,IAAIA,IAAI,CAAC4yB,UAAU,EAAE;UACjB5yB,IAAI,CAAC4yB,UAAU,CAACI,IAAI,CAAC;QACzB;QACZ,IAAI,CAACzrB,KAAK,CAACgG,WAAW,EAAE;MAChB;IACJ;EACJ,CAAC;EAEDjG,YAAY,CAACnT,SAAS,CAACm5B,qBAAqB,GAAG,UAAStf,CAAC,EAAE;IACvD,IAAI,IAAI,CAAColB,eAAe,EAAE;MACtB,IAAI,CAACA,eAAe,CAACplB,CAAC,CAAC;IAC3B,CAAC,MAEP;MACC,IAAI,CAACqlB,iBAAiB,CAACrlB,CAAC,CAAC;IAC1B;IAEM,IAAI,IAAI,CAACslB,gBAAgB,EAAE;MACvB,IAAI,CAACA,gBAAgB,CAACtlB,CAAC,CAAC;IAC5B;IAEA,IAAI,CAACwZ,QAAQ,CAAC,IAAI,CAAC;EACvB,CAAC;EAEDlgB,YAAY,CAACnT,SAAS,CAACg4B,mBAAmB,GAAG,UAASnsB,IAAI,EAAEvN,CAAC,EAAE;IAC3D,IAAI,CAAC8gC,UAAU,CAACvzB,IAAI,EAAEvN,CAAC,KAAKA,CAAC,CAACq6B,QAAQ,IAAEr6B,CAAC,CAACq5B,OAAO,CAAC,CAAC;IACnD,IAAI,IAAI,CAAC0H,cAAc,EAAE;MACrB,IAAI,CAACA,cAAc,CAACxzB,IAAI,CAAC;IAC7B;EACJ,CAAC;;EAED;AACJ;AACA;AACA;EACIsH,YAAY,CAACnT,SAAS,CAACo/B,UAAU,GAAG,UAChCvzB,IAAI,EACJyzB,wBAAwB,EAC1B;IACE,IAAIzzB,IAAI,IAAI,IAAI,EAAE;MACd,IAAI,CAACixB,gBAAgB,EAAE;IAC3B,CAAC,MAAM;MACH,IAAI,CAACjJ,WAAW,CAAC,CAAChoB,IAAI,CAAC,EAAEyzB,wBAAwB,CAAC;IACtD;EACJ,CAAC;;EAED;AACJ;AACA;AACA;EACInsB,YAAY,CAACnT,SAAS,CAAC6zB,WAAW,GAAG,UAAU1pB,KAAK,EAAEm1B,wBAAwB,EACjF;IACC,IAAI,CAACA,wBAAwB,EAAE;MACrB,IAAI,CAACxC,gBAAgB,EAAE;IAC3B;IAEA3yB,KAAK,GAAGA,KAAK,IAAI,IAAI,CAACiJ,KAAK,CAAC7B,MAAM;IACxC,IAAI,OAAOpH,KAAK,IAAI,QAAQ,EAAEA,KAAK,GAAG,CAACA,KAAK,CAAC;IACvC,KAAK,IAAIvK,CAAC,IAAIuK,KAAK,EAAE;MACjB,IAAI0B,IAAI,GAAG1B,KAAK,CAACvK,CAAC,CAAC;MACnB,IAAIiM,IAAI,CAAC0zB,WAAW,EAAE;QAClB;MACJ;MAEA,IAAI,CAAC1zB,IAAI,CAAC0zB,WAAW,IAAI1zB,IAAI,CAAC2zB,UAAU,EAAE;QACtC3zB,IAAI,CAAC2zB,UAAU,EAAE;MACrB;MACA3zB,IAAI,CAAC0zB,WAAW,GAAG,IAAI;MACvB,IAAI,CAACtmB,cAAc,CAACpN,IAAI,CAAC2J,EAAE,CAAC,GAAG3J,IAAI;MAEnC,IAAIA,IAAI,CAACgH,MAAM,EAAE;QACb,KAAK,IAAItE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG1C,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAE,EAAEqP,CAAC,EAAE;UACzC,IAAI,CAACikB,iBAAiB,CAAC3mB,IAAI,CAACgH,MAAM,CAACtE,CAAC,CAAC,CAACmH,IAAI,CAAC,GAAG,IAAI;QACtD;MACJ;MACA,IAAI7J,IAAI,CAACiH,OAAO,EAAE;QACd,KAAK,IAAIvE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG1C,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAE,EAAEqP,CAAC,EAAE;UAC1C,IAAIzE,GAAG,GAAG+B,IAAI,CAACiH,OAAO,CAACvE,CAAC,CAAC;UACzB,IAAIzE,GAAG,CAAC+H,KAAK,EAAE;YACX,KAAK,IAAIwN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGvV,GAAG,CAAC+H,KAAK,CAAC3S,MAAM,EAAE,EAAEmgB,CAAC,EAAE;cACvC,IAAI,CAACmT,iBAAiB,CAAC1oB,GAAG,CAAC+H,KAAK,CAACwN,CAAC,CAAC,CAAC,GAAG,IAAI;YAC/C;UACJ;QACJ;MACJ;IACJ;IAEN,IAAI,IAAI,CAAC2R,iBAAiB,EACzB,IAAI,CAACA,iBAAiB,CAAE,IAAI,CAAC/X,cAAc,CAAE;IAExC,IAAI,CAACoa,QAAQ,CAAC,IAAI,CAAC;EACvB,CAAC;;EAED;AACJ;AACA;AACA;EACIlgB,YAAY,CAACnT,SAAS,CAACy/B,YAAY,GAAG,UAAS5zB,IAAI,EAAE;IACjD,IAAI,CAACA,IAAI,CAAC0zB,WAAW,EAAE;MACnB;IACJ;IACA,IAAI1zB,IAAI,CAAC6zB,YAAY,EAAE;MACnB7zB,IAAI,CAAC6zB,YAAY,EAAE;IACvB;IACA7zB,IAAI,CAAC0zB,WAAW,GAAG,KAAK;IAExB,IAAI,IAAI,CAACI,gBAAgB,EAAE;MACvB,IAAI,CAACA,gBAAgB,CAAC9zB,IAAI,CAAC;IAC/B;;IAEA;IACA,IAAIA,IAAI,CAACgH,MAAM,EAAE;MACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAE,EAAEU,CAAC,EAAE;QACzC,OAAO,IAAI,CAAC4yB,iBAAiB,CAAC3mB,IAAI,CAACgH,MAAM,CAACjT,CAAC,CAAC,CAAC8V,IAAI,CAAC;MACtD;IACJ;IACA,IAAI7J,IAAI,CAACiH,OAAO,EAAE;MACd,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC1C,IAAIkK,GAAG,GAAG+B,IAAI,CAACiH,OAAO,CAAClT,CAAC,CAAC;QACzB,IAAIkK,GAAG,CAAC+H,KAAK,EAAE;UACX,KAAK,IAAItD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGzE,GAAG,CAAC+H,KAAK,CAAC3S,MAAM,EAAE,EAAEqP,CAAC,EAAE;YACvC,OAAO,IAAI,CAACikB,iBAAiB,CAAC1oB,GAAG,CAAC+H,KAAK,CAACtD,CAAC,CAAC,CAAC;UAC/C;QACJ;MACJ;IACJ;EACJ,CAAC;;EAED;AACJ;AACA;AACA;EACI4E,YAAY,CAACnT,SAAS,CAAC88B,gBAAgB,GAAG,YAAW;IACjD,IAAI,CAAC,IAAI,CAAC1pB,KAAK,EAAE;MACb;IACJ;IACA,IAAIjJ,KAAK,GAAG,IAAI,CAACiJ,KAAK,CAAC7B,MAAM;IAC7B,KAAK,IAAI3R,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAGpL,KAAK,CAACjL,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAC1C,IAAIiM,IAAI,GAAG1B,KAAK,CAACvK,CAAC,CAAC;MACnB,IAAI,CAACiM,IAAI,CAAC0zB,WAAW,EAAE;QACnB;MACJ;MACA,IAAI1zB,IAAI,CAAC6zB,YAAY,EAAE;QACnB7zB,IAAI,CAAC6zB,YAAY,EAAE;MACvB;MACA7zB,IAAI,CAAC0zB,WAAW,GAAG,KAAK;MACjC,IAAI,IAAI,CAACI,gBAAgB,EAAE;QAC1B,IAAI,CAACA,gBAAgB,CAAC9zB,IAAI,CAAC;MAC5B;IACK;IACA,IAAI,CAACoN,cAAc,GAAG,CAAC,CAAC;IACxB,IAAI,CAACmY,YAAY,GAAG,IAAI;IACxB,IAAI,CAACoB,iBAAiB,GAAG,CAAC,CAAC;IACjC,IAAI,IAAI,CAACxB,iBAAiB,EACzB,IAAI,CAACA,iBAAiB,CAAE,IAAI,CAAC/X,cAAc,CAAE;IACxC,IAAI,CAACoa,QAAQ,CAAC,IAAI,CAAC;EACvB,CAAC;;EAED;AACJ;AACA;AACA;EACIlgB,YAAY,CAACnT,SAAS,CAACy9B,mBAAmB,GAAG,YAAW;IAE1D,IAAI,CAACrqB,KAAK,CAACwF,YAAY,EAAE;IAEnB,KAAK,IAAIhZ,CAAC,IAAI,IAAI,CAACqZ,cAAc,EAAE;MAC/B,IAAIpN,IAAI,GAAG,IAAI,CAACoN,cAAc,CAACrZ,CAAC,CAAC;MAE1C,IAAGiM,IAAI,CAAC+zB,YAAY,EACnB;;MAED;MACA,IAAG/zB,IAAI,CAACgH,MAAM,IAAIhH,IAAI,CAACgH,MAAM,CAAC3T,MAAM,IAAI2M,IAAI,CAACiH,OAAO,IAAIjH,IAAI,CAACiH,OAAO,CAAC5T,MAAM,IAAIuC,SAAS,CAACwM,iBAAiB,CAAEpC,IAAI,CAACgH,MAAM,CAAC,CAAC,CAAC,CAAClL,IAAI,EAAEkE,IAAI,CAACiH,OAAO,CAAC,CAAC,CAAC,CAACnL,IAAI,CAAE,IAAIkE,IAAI,CAACgH,MAAM,CAAC,CAAC,CAAC,CAAC6C,IAAI,IAAI7J,IAAI,CAACiH,OAAO,CAAC,CAAC,CAAC,CAACjB,KAAK,IAAIhG,IAAI,CAACiH,OAAO,CAAC,CAAC,CAAC,CAACjB,KAAK,CAAC3S,MAAM,EACvO;QACC,IAAI2gC,UAAU,GAAGh0B,IAAI,CAACuH,KAAK,CAACvB,KAAK,CAAEhG,IAAI,CAACgH,MAAM,CAAC,CAAC,CAAC,CAAC6C,IAAI,CAAE;QACxD,IAAIoqB,WAAW,GAAGj0B,IAAI,CAACuH,KAAK,CAACvB,KAAK,CAAEhG,IAAI,CAACiH,OAAO,CAAC,CAAC,CAAC,CAACjB,KAAK,CAAC,CAAC,CAAC,CAAE;QAC9D,IAAIkuB,UAAU,GAAGl0B,IAAI,CAACiL,YAAY,CAAC,CAAC,CAAC;QACrC,IAAIkpB,WAAW,GAAGn0B,IAAI,CAACyV,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3C,IAAGye,UAAU,IAAIC,WAAW,EAC3BD,UAAU,CAACjZ,OAAO,CAAE+Y,UAAU,CAAC9gB,WAAW,EAAEihB,WAAW,EAAEF,WAAW,CAAC3iB,WAAW,CAAE;MACpF;MACS,IAAI,CAAC/J,KAAK,CAACqF,MAAM,CAAC5M,IAAI,CAAC;MAChC,IAAI,IAAI,CAAC8zB,gBAAgB,EAAE;QAC1B,IAAI,CAACA,gBAAgB,CAAC9zB,IAAI,CAAC;MAC5B;IACK;IACA,IAAI,CAACoN,cAAc,GAAG,CAAC,CAAC;IACxB,IAAI,CAACmY,YAAY,GAAG,IAAI;IACxB,IAAI,CAACoB,iBAAiB,GAAG,CAAC,CAAC;IAC3B,IAAI,CAACa,QAAQ,CAAC,IAAI,CAAC;IACzB,IAAI,CAACjgB,KAAK,CAACgG,WAAW,EAAE;EACtB,CAAC;;EAED;AACJ;AACA;AACA;EACIjG,YAAY,CAACnT,SAAS,CAAC4zB,YAAY,GAAG,UAAS/nB,IAAI,EAAE;IACjD,IAAI,CAACgiB,EAAE,CAAChG,MAAM,CAAC,CAAC,CAAC,GACb,CAAChc,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GACZ2D,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,GACjB,IAAI,CAAC8M,MAAM,CAACgS,KAAK,GAAG,GAAG,GAAI,IAAI,CAAC6C,EAAE,CAAC5E,KAAK;IAC7C,IAAI,CAAC4E,EAAE,CAAChG,MAAM,CAAC,CAAC,CAAC,GACb,CAAChc,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GACZ2D,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,GACjB,IAAI,CAAC8M,MAAM,CAACiS,MAAM,GAAG,GAAG,GAAI,IAAI,CAAC4C,EAAE,CAAC5E,KAAK;IAC9C,IAAI,CAACoK,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC;EAC7B,CAAC;;EAED;AACJ;AACA;AACA;EACIlgB,YAAY,CAACnT,SAAS,CAAC82B,gBAAgB,GAAG,UAASx4B,CAAC,EAAE;IACzD,IAAI2hC,WAAW,GAAG,CAAC;IACZ,IAAIC,WAAW,GAAG,CAAC;IAEtB,IAAI,IAAI,CAAClnB,MAAM,EAAE;MACV,IAAItM,CAAC,GAAG,IAAI,CAACsM,MAAM,CAACuS,qBAAqB,EAAE;MAC3C0U,WAAW,GAAG3hC,CAAC,CAACktB,OAAO,GAAG9e,CAAC,CAAC+e,IAAI;MAChCyU,WAAW,GAAG5hC,CAAC,CAACotB,OAAO,GAAGhf,CAAC,CAACif,GAAG;IACnC,CAAC,MAAM;MACNsU,WAAW,GAAG3hC,CAAC,CAACktB,OAAO;MACvB0U,WAAW,GAAG5hC,CAAC,CAACotB,OAAO;IACxB;IAEAptB,CAAC,CAAC6hC,MAAM,GAAGF,WAAW,GAAG,IAAI,CAAC1O,mBAAmB,CAAC,CAAC,CAAC;IACpDjzB,CAAC,CAACguB,MAAM,GAAG4T,WAAW,GAAE,IAAI,CAAC3O,mBAAmB,CAAC,CAAC,CAAC;IAEnD,IAAI,CAACA,mBAAmB,CAAC,CAAC,CAAC,GAAG0O,WAAW;IACzC,IAAI,CAAC1O,mBAAmB,CAAC,CAAC,CAAC,GAAG2O,WAAW;IAEzC5hC,CAAC,CAAC04B,OAAO,GAAGiJ,WAAW,GAAG,IAAI,CAACpS,EAAE,CAAC5E,KAAK,GAAG,IAAI,CAAC4E,EAAE,CAAChG,MAAM,CAAC,CAAC,CAAC;IAC3DvpB,CAAC,CAAC24B,OAAO,GAAGiJ,WAAW,GAAG,IAAI,CAACrS,EAAE,CAAC5E,KAAK,GAAG,IAAI,CAAC4E,EAAE,CAAChG,MAAM,CAAC,CAAC,CAAC;;IAE3D;EACJ,CAAC;;EAED;AACJ;AACA;AACA;EACI1U,YAAY,CAACnT,SAAS,CAACogC,OAAO,GAAG,UAAStlB,KAAK,EAAEsS,cAAc,EAAE;IAC7D,IAAI,CAACS,EAAE,CAACV,WAAW,CAACrS,KAAK,EAAEsS,cAAc,CAAC;IAC1C;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAOQ,IAAI,CAACsF,YAAY,GAAG,IAAI;IACxB,IAAI,CAACC,cAAc,GAAG,IAAI;EAC9B,CAAC;;EAED;AACJ;AACA;AACA;EACIxf,YAAY,CAACnT,SAAS,CAACitB,qBAAqB,GAAG,UAAS/kB,GAAG,EAAE4B,GAAG,EAAE;IAC9D,OAAO,IAAI,CAAC+jB,EAAE,CAACZ,qBAAqB,CAAC/kB,GAAG,EAAE4B,GAAG,CAAC;EAClD,CAAC;;EAED;AACJ;AACA;AACA;EACIqJ,YAAY,CAACnT,SAAS,CAACktB,qBAAqB,GAAG,UAAShlB,GAAG,EAAE4B,GAAG,EAAE;IAC9D,OAAO,IAAI,CAAC+jB,EAAE,CAACX,qBAAqB,CAAChlB,GAAG,EAAE4B,GAAG,CAAC;EAClD,CAAC;;EAED;EACAqJ,YAAY,CAACnT,SAAS,CAACqgC,0BAA0B,GAAG,UAAS/hC,CAAC,EAAE;IAC5D,IAAIgtB,IAAI,GAAG,IAAI,CAACtS,MAAM,CAACuS,qBAAqB,EAAE;IAC9C,OAAO,IAAI,CAAC2B,qBAAqB,CAAC,CAC9B5uB,CAAC,CAACktB,OAAO,GAAGF,IAAI,CAACG,IAAI,EACrBntB,CAAC,CAACotB,OAAO,GAAGJ,IAAI,CAACK,GAAG,CACvB,CAAC;EACN,CAAC;;EAED;AACJ;AACA;AACA;EACIxY,YAAY,CAACnT,SAAS,CAACk4B,YAAY,GAAG,UAASrsB,IAAI,EAAE;IACjD,IAAIjM,CAAC,GAAG,IAAI,CAACwT,KAAK,CAAC7B,MAAM,CAACnD,OAAO,CAACvC,IAAI,CAAC;IACvC,IAAIjM,CAAC,IAAI,CAAC,CAAC,EAAE;MACT;IACJ;IAEA,IAAI,CAACwT,KAAK,CAAC7B,MAAM,CAAC+B,MAAM,CAAC1T,CAAC,EAAE,CAAC,CAAC;IAC9B,IAAI,CAACwT,KAAK,CAAC7B,MAAM,CAAC1R,IAAI,CAACgM,IAAI,CAAC;EAChC,CAAC;;EAED;AACJ;AACA;AACA;EACIsH,YAAY,CAACnT,SAAS,CAACsgC,UAAU,GAAG,UAASz0B,IAAI,EAAE;IAC/C,IAAIjM,CAAC,GAAG,IAAI,CAACwT,KAAK,CAAC7B,MAAM,CAACnD,OAAO,CAACvC,IAAI,CAAC;IACvC,IAAIjM,CAAC,IAAI,CAAC,CAAC,EAAE;MACT;IACJ;IAEA,IAAI,CAACwT,KAAK,CAAC7B,MAAM,CAAC+B,MAAM,CAAC1T,CAAC,EAAE,CAAC,CAAC;IAC9B,IAAI,CAACwT,KAAK,CAAC7B,MAAM,CAACgvB,OAAO,CAAC10B,IAAI,CAAC;EACnC,CAAC;;EAED;;EAEA;EACA,IAAI20B,IAAI,GAAG,IAAIthB,YAAY,CAAC,CAAC,CAAC;;EAE9B;AACJ;AACA;AACA;EACI/L,YAAY,CAACnT,SAAS,CAACygC,mBAAmB,GAAG,UAASt2B,KAAK,EAAEL,GAAG,EAAE;IAC9D,IAAIuoB,aAAa,GAAGvoB,GAAG,IAAI,EAAE;IAC7BuoB,aAAa,CAACnzB,MAAM,GAAG,CAAC;IACxBiL,KAAK,GAAGA,KAAK,IAAI,IAAI,CAACiJ,KAAK,CAAC7B,MAAM;IAClC,KAAK,IAAI3R,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAGpL,KAAK,CAACjL,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MAC1C,IAAIia,CAAC,GAAG1P,KAAK,CAACvK,CAAC,CAAC;;MAEhB;MACA,IAAI,IAAI,CAACgd,SAAS,IAAI,CAAC/C,CAAC,CAAC8W,gBAAgB,IAAI,CAAC9W,CAAC,CAAC+W,gBAAgB,EAAE;QAC9D;MACJ;MAEA,IAAI,CAAC5G,eAAe,CAAC,IAAI,CAACS,YAAY,EAAE5Q,CAAC,CAAC8K,WAAW,CAAC6b,IAAI,CAAC,CAAC,EAAE;QAC1D;MACJ,CAAC,CAAC;;MAEFnO,aAAa,CAACxyB,IAAI,CAACga,CAAC,CAAC;IACzB;IACA,OAAOwY,aAAa;EACxB,CAAC;;EAED;AACJ;AACA;AACA;EACIlf,YAAY,CAACnT,SAAS,CAAC02B,IAAI,GAAG,UAASgK,YAAY,EAAEC,cAAc,EAAE;IACjE,IAAI,CAAC,IAAI,CAAC3nB,MAAM,IAAI,IAAI,CAACA,MAAM,CAACgS,KAAK,IAAI,CAAC,IAAI,IAAI,CAAChS,MAAM,CAACiS,MAAM,IAAI,CAAC,EAAE;MACnE;IACJ;;IAEA;IACA,IAAI7a,GAAG,GAAG3O,SAAS,CAAC0O,OAAO,EAAE;IAC7B,IAAI,CAAC+hB,WAAW,GAAG,CAAC9hB,GAAG,GAAG,IAAI,CAAC6hB,cAAc,IAAI,KAAK;IACtD,IAAI,CAACA,cAAc,GAAG7hB,GAAG;IAEzB,IAAI,IAAI,CAACgD,KAAK,EAAE;MACZ,IAAI,CAACya,EAAE,CAAC/C,kBAAkB,CAAC,IAAI,CAACC,QAAQ,CAAC;IAC7C;IAEA,IACI,IAAI,CAAC4H,cAAc,IACnBgO,cAAc,IACd,IAAI,CAACjR,wBAAwB,IAC5B,IAAI,CAACtc,KAAK,IACP,IAAI,CAACA,KAAK,CAACqP,kBAAkB,IAC7BrS,GAAG,GAAG,IAAI,CAACgD,KAAK,CAACqP,kBAAkB,GAAG,IAAK,EACjD;MACE,IAAI,CAACme,cAAc,EAAE;IACzB;IAEA,IAAI,IAAI,CAAClO,YAAY,IAAIgO,YAAY,EAAE;MACnC,IAAI,CAACG,eAAe,EAAE;IAC1B;IAEA,IAAI,CAAC1O,GAAG,GAAG,IAAI,CAACD,WAAW,GAAG,GAAG,GAAG,IAAI,CAACA,WAAW,GAAG,CAAC;IACxD,IAAI,CAACF,KAAK,IAAI,CAAC;EACnB,CAAC;;EAED;AACJ;AACA;AACA;EACI7e,YAAY,CAACnT,SAAS,CAAC6gC,eAAe,GAAG,YAAW;IAChD,IAAI,CAACnO,YAAY,GAAG,KAAK;IAEzB,IAAI,CAAC,IAAI,CAAC3F,GAAG,EAAE;MACX,IAAI,CAACA,GAAG,GAAG,IAAI,CAACoH,QAAQ,CAACC,UAAU,CAAC,IAAI,CAAC;IAC7C;IACA,IAAIrH,GAAG,GAAG,IAAI,CAACA,GAAG;IAClB,IAAI,CAACA,GAAG,EAAE;MACN;MACA;IACJ;IAEA,IAAI/T,MAAM,GAAG,IAAI,CAACA,MAAM;IACxB,IAAK+T,GAAG,CAAC+T,OAAO,IAAI,CAAC,IAAI,CAAC/V,QAAQ,EAAG;MACjCgC,GAAG,CAAC+T,OAAO,EAAE;MACtB/T,GAAG,CAACgU,OAAO,EAAE;MACbhU,GAAG,CAACiU,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IAC7B;;IAEA;IACN,IAAIC,IAAI,GAAG,IAAI,CAAClW,QAAQ,IAAI,IAAI,CAAC6H,UAAU;IACrC,IAAIqO,IAAI,EAAE;MACNlU,GAAG,CAACmU,IAAI,EAAE;MACVnU,GAAG,CAACoU,SAAS,EAAE;MACfpU,GAAG,CAACzB,IAAI,CAAE2V,IAAI,CAAC,CAAC,CAAC,EAACA,IAAI,CAAC,CAAC,CAAC,EAACA,IAAI,CAAC,CAAC,CAAC,EAACA,IAAI,CAAC,CAAC,CAAC,CAAE;MAC3ClU,GAAG,CAACqU,IAAI,EAAE;IACd;;IAEA;IACA;IACA,IAAI,IAAI,CAACtS,gBAAgB,EAAE;MAChC,IAAGmS,IAAI,EACGlU,GAAG,CAACsU,SAAS,CAAEJ,IAAI,CAAC,CAAC,CAAC,EAACA,IAAI,CAAC,CAAC,CAAC,EAACA,IAAI,CAAC,CAAC,CAAC,EAACA,IAAI,CAAC,CAAC,CAAC,CAAE,CAAC,KAEjDlU,GAAG,CAACsU,SAAS,CAAC,CAAC,EAAE,CAAC,EAAEroB,MAAM,CAACgS,KAAK,EAAEhS,MAAM,CAACiS,MAAM,CAAC;IACrD;;IAEA;IACA,IAAI,IAAI,CAACkJ,QAAQ,IAAI,IAAI,CAACnb,MAAM,EAAE;MAC9B,IAAI,CAAC4nB,cAAc,EAAE;IACzB,CAAC,MAAM;MACH7T,GAAG,CAACuU,SAAS,CAAE,IAAI,CAACnN,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAE;IACxC;;IAEA;IACA,IAAI,IAAI,CAACoN,QAAQ,EAAE;MACf,IAAI,CAACA,QAAQ,CAACvoB,MAAM,EAAE+T,GAAG,CAAC;IAC9B;;IAEA;IACA,IAAI,IAAI,CAACkC,SAAS,EAAE;MAChB,IAAI,CAACuS,UAAU,CAACzU,GAAG,EAAEkU,IAAI,GAAGA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,IAAI,GAAGA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAE;IACjE;IAEA,IAAI,IAAI,CAAC7tB,KAAK,EAAE;MACZ;MACA2Z,GAAG,CAACmU,IAAI,EAAE;MACV,IAAI,CAACrT,EAAE,CAACf,eAAe,CAACC,GAAG,CAAC;;MAE5B;MACA,IAAI0U,WAAW,GAAG,CAAC;MACnB,IAAIpP,aAAa,GAAG,IAAI,CAACoO,mBAAmB,CACxC,IAAI,EACJ,IAAI,CAACpO,aAAa,CACrB;MAED,KAAK,IAAIzyB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGyyB,aAAa,CAACnzB,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC3C,IAAIiM,IAAI,GAAGwmB,aAAa,CAACzyB,CAAC,CAAC;;QAE3B;QACAmtB,GAAG,CAACmU,IAAI,EAAE;QACVnU,GAAG,CAACC,SAAS,CAACnhB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,EAAE2D,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,CAAC;;QAEvC;QACA,IAAI,CAACw5B,QAAQ,CAAC71B,IAAI,EAAEkhB,GAAG,CAAC;QACxB0U,WAAW,IAAI,CAAC;;QAEhB;QACA1U,GAAG,CAACgU,OAAO,EAAE;MACjB;;MAEA;MACA,IAAI,IAAI,CAAC7Q,sBAAsB,EAAE;QAC7B,IAAI,CAACyR,kBAAkB,CAAC5U,GAAG,CAAC;MAChC;;MAEA;MACA,IAAI,IAAI,CAAC3Z,KAAK,CAACrB,MAAM,CAAC6vB,WAAW,EAAE;QAC/B,IAAI,CAAC,IAAI,CAAChlB,SAAS,EAAE;UACjB,IAAI,CAACilB,eAAe,CAAC9U,GAAG,CAAC;QAC7B;MACJ;;MAEA;MACA,IAAI,IAAI,CAAC0L,cAAc,IAAI,IAAI,EAAE;QAC7B1L,GAAG,CAAC+U,SAAS,GAAG,IAAI,CAAC5Q,iBAAiB;QACtC,IAAI6Q,UAAU,GAAG,IAAI;QAErB,IAAIzF,WAAW,GAAG,IAAI,CAAC/D,iBAAiB,IAAI,IAAI,CAACS,gBAAgB;QAEjE,IAAIuD,QAAQ,GAAGD,WAAW,CAAC30B,IAAI;QAC/B,IAAIq6B,OAAO,GAAG1F,WAAW,CAACh7B,GAAG;QACzC,IAAG0gC,OAAO,IAAI,IAAI,EAClB;UACC,IAAI,IAAI,CAACzJ,iBAAiB,EACzByJ,OAAO,GAAG,IAAI,CAACzP,eAAe,CAACzK,UAAU,GAAGrmB,SAAS,CAACkD,IAAI,GAAGlD,SAAS,CAACoD,KAAK,CAAC,KAE7Em9B,OAAO,GAAG,IAAI,CAACzP,eAAe,CAACzK,UAAU,GAAGrmB,SAAS,CAACiD,EAAE,GAAGjD,SAAS,CAACmD,IAAI;QAC3E;QACY,IAAIq9B,SAAS,GAAG3F,WAAW,CAACvc,KAAK;QAEjC,QAAQwc,QAAQ;UACZ,KAAK96B,SAAS,CAACyC,KAAK;YAChB69B,UAAU,GAAGtgC,SAAS,CAAC4B,gBAAgB;YACvC;UACJ;YACI0+B,UAAU,GAAGtgC,SAAS,CAAC6B,qBAAqB;QAAC;;QAGrD;QACA,IAAI,CAAC4+B,UAAU,CACXnV,GAAG,EACH,IAAI,CAAC0L,cAAc,EACnB,CAAC,IAAI,CAAClI,WAAW,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,WAAW,CAAC,CAAC,CAAC,CAAC,EAC1C,IAAI,EACJ,KAAK,EACL,IAAI,EACJwR,UAAU,EACVC,OAAO,EACPvgC,SAAS,CAACqD,MAAM,CACnB;QAEDioB,GAAG,CAACoU,SAAS,EAAE;QACf,IACI5E,QAAQ,KAAK96B,SAAS,CAACyC,KAAK,IAC5B+9B,SAAS,KAAKxgC,SAAS,CAACiC,SAAS,EACnC;UACEqpB,GAAG,CAACzB,IAAI,CACJ,IAAI,CAACmN,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAChC,IAAI,CAACA,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAChC,EAAE,EACF,EAAE,CACL;UACJ1L,GAAG,CAACoV,IAAI,EAAE;UACtBpV,GAAG,CAACoU,SAAS,EAAE;UACApU,GAAG,CAACzB,IAAI,CACJ,IAAI,CAACiF,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAC7B,IAAI,CAACA,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAC7B,EAAE,EACF,EAAE,CACL;QACL,CAAC,MAAM,IAAI0R,SAAS,KAAKxgC,SAAS,CAACqC,WAAW,EAAE;UAC5CipB,GAAG,CAACqV,MAAM,CAAC,IAAI,CAAC3J,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAACA,cAAc,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;UACpE1L,GAAG,CAACsV,MAAM,CAAC,IAAI,CAAC5J,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAACA,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;UACxE1L,GAAG,CAACsV,MAAM,CAAC,IAAI,CAAC5J,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAACA,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;UACxE1L,GAAG,CAACuV,SAAS,EAAE;QACnB,CAAC,MACI;UACDvV,GAAG,CAACwV,GAAG,CACH,IAAI,CAAC9J,cAAc,CAAC,CAAC,CAAC,EACtB,IAAI,CAACA,cAAc,CAAC,CAAC,CAAC,EACtB,CAAC,EACD,CAAC,EACDtW,IAAI,CAACqgB,EAAE,GAAG,CAAC,CACd;UACJzV,GAAG,CAACoV,IAAI,EAAE;UACtBpV,GAAG,CAACoU,SAAS,EAAE;UACApU,GAAG,CAACwV,GAAG,CACH,IAAI,CAAChS,WAAW,CAAC,CAAC,CAAC,EACnB,IAAI,CAACA,WAAW,CAAC,CAAC,CAAC,EACnB,CAAC,EACD,CAAC,EACDpO,IAAI,CAACqgB,EAAE,GAAG,CAAC,CACd;QACL;QACAzV,GAAG,CAACoV,IAAI,EAAE;QAEVpV,GAAG,CAAC0V,SAAS,GAAG,SAAS;QACzB,IAAI,IAAI,CAAClH,gBAAgB,EAAE;UACvBxO,GAAG,CAACoU,SAAS,EAAE;UACf,IAAIphB,KAAK,GAAG,IAAI,CAAC2b,qBAAqB,CAAC3b,KAAK;UAC5C,IAAIA,KAAK,KAAKte,SAAS,CAACqC,WAAW,EAAE;YACjCipB,GAAG,CAACqV,MAAM,CAAC,IAAI,CAAC7G,gBAAgB,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAACA,gBAAgB,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;YACxExO,GAAG,CAACsV,MAAM,CAAC,IAAI,CAAC9G,gBAAgB,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAACA,gBAAgB,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;YAC5ExO,GAAG,CAACsV,MAAM,CAAC,IAAI,CAAC9G,gBAAgB,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAACA,gBAAgB,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;YAC5ExO,GAAG,CAACuV,SAAS,EAAE;UACnB,CAAC,MAAM;YACHvV,GAAG,CAACwV,GAAG,CACH,IAAI,CAAChH,gBAAgB,CAAC,CAAC,CAAC,EACxB,IAAI,CAACA,gBAAgB,CAAC,CAAC,CAAC,EACxB,CAAC,EACD,CAAC,EACDpZ,IAAI,CAACqgB,EAAE,GAAG,CAAC,CACd;UACL;UACAzV,GAAG,CAACoV,IAAI,EAAE;QACd;QACA,IAAI,IAAI,CAACxG,iBAAiB,EAAE;UACxB5O,GAAG,CAACoU,SAAS,EAAE;UACf,IAAIphB,KAAK,KAAKte,SAAS,CAACqC,WAAW,EAAE;YACjCipB,GAAG,CAACqV,MAAM,CAAC,IAAI,CAACzG,iBAAiB,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAACA,iBAAiB,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;YAC1E5O,GAAG,CAACsV,MAAM,CAAC,IAAI,CAAC1G,iBAAiB,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAACA,iBAAiB,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;YAC9E5O,GAAG,CAACsV,MAAM,CAAC,IAAI,CAAC1G,iBAAiB,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAACA,iBAAiB,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;YAC9E5O,GAAG,CAACuV,SAAS,EAAE;UACnB,CAAC,MAAM;YACHvV,GAAG,CAACwV,GAAG,CACH,IAAI,CAAC5G,iBAAiB,CAAC,CAAC,CAAC,EACzB,IAAI,CAACA,iBAAiB,CAAC,CAAC,CAAC,EACzB,CAAC,EACD,CAAC,EACDxZ,IAAI,CAACqgB,EAAE,GAAG,CAAC,CACd;UACL;UACAzV,GAAG,CAACoV,IAAI,EAAE;QACd;MACJ;;MAET;MACS,IAAI,IAAI,CAAC3S,kBAAkB,EAAE;QACzBzC,GAAG,CAAC2V,WAAW,GAAG,MAAM;QACxB3V,GAAG,CAAC4V,UAAU,CACV,IAAI,CAACnT,kBAAkB,CAAC,CAAC,CAAC,EAC1B,IAAI,CAACA,kBAAkB,CAAC,CAAC,CAAC,EAC1B,IAAI,CAACA,kBAAkB,CAAC,CAAC,CAAC,EAC1B,IAAI,CAACA,kBAAkB,CAAC,CAAC,CAAC,CAC7B;MACL;;MAET;MACA,IAAG,IAAI,CAAC8B,gBAAgB,IAAI,IAAI,CAAClB,mBAAmB,EACnD,IAAI,CAACwS,eAAe,CAAE7V,GAAG,EAAE,IAAI,CAACuE,gBAAgB,CAAE,CAAC,KAEnD,IAAG,IAAI,CAACR,iBAAiB;QAAE;QAC1B,IAAI,CAACA,iBAAiB,CAAC/D,GAAG,EAAC,IAAI,CAAC;;MAElC;MACS,IAAI,IAAI,CAAC6D,gBAAgB,EAAE;QACvB,IAAI,CAACA,gBAAgB,CAAC7D,GAAG,EAAE,IAAI,CAAC8V,YAAY,CAAC;MACjD;MAEA9V,GAAG,CAACgU,OAAO,EAAE;IACjB;;IAEN;IACA,IAAI,IAAI,CAAC3N,YAAY,IAAI,IAAI,CAACA,YAAY,CAACl0B,MAAM,EAAE;MAClD,IAAI,CAAC4jC,iBAAiB,CAAE/V,GAAG,CAAE;IAC9B;IAGM,IAAI,IAAI,CAAC8D,aAAa,EAAE;MACpB,IAAI,CAACA,aAAa,CAAC9D,GAAG,CAAC;IAC3B;IAEA,IAAIkU,IAAI,EAAC;MACLlU,GAAG,CAACgU,OAAO,EAAE;IACjB;IAEA,IAAIhU,GAAG,CAACgW,QAAQ,EAAE;MACd;MACAhW,GAAG,CAACgW,QAAQ,EAAE;IAClB;EACJ,CAAC;;EAED;AACJ;AACA;AACA;EACI5vB,YAAY,CAACnT,SAAS,CAAC8iC,iBAAiB,GAAG,UAAU/V,GAAG,EAAE;IACtD,IAAIsM,QAAQ,GAAG,IAAI,CAACjmB,KAAK;IACzB,IAAI4vB,OAAO,GAAG3J,QAAQ,CAAC1F,cAAc;IACrC,IAAI,CAACqP,OAAO,EAAE;MACVn7B,OAAO,CAACqB,IAAI,CAAC,0BAA0B,CAAC;MACxC;IACJ;IACA,IAAI,CAAC+5B,qBAAqB,CAAC5J,QAAQ,EAAE2J,OAAO,EAAEjW,GAAG,CAAC;IAClD,IAAI,CAACmW,sBAAsB,CAAC7J,QAAQ,EAAE2J,OAAO,EAAEjW,GAAG,CAAC;EACvD,CAAC;EAED5Z,YAAY,CAACnT,SAAS,CAACijC,qBAAqB,GAAG,UAAU5J,QAAQ,EAAE2J,OAAO,EAAEjW,GAAG,EAAE;IAC7E,IAAI1Y,GAAG,GAAG2uB,OAAO,CAACnwB,MAAM,GAAGmwB,OAAO,CAACnwB,MAAM,CAAC3T,MAAM,GAAG,CAAC;IACpD,IAAIugB,CAAC,GAAG,GAAG;IACX,IAAI0c,CAAC,GAAGha,IAAI,CAACC,KAAK,CAAC3gB,SAAS,CAACK,gBAAgB,GAAG,GAAG,CAAC;IAEpDirB,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACoW,WAAW,GAAG,GAAG;IACrBpW,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACqW,SAAS,CAAC,EAAE,EAAE,EAAE,EAAE3jB,CAAC,EAAE,CAACpL,GAAG,GAAG,CAAC,IAAI8nB,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;IACjDpP,GAAG,CAACoV,IAAI,EAAE;IACVpV,GAAG,CAACoW,WAAW,GAAG,CAAC;IAEnBpW,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACtD,IAAI,GAAG,YAAY;IACvBsD,GAAG,CAACsW,SAAS,GAAG,MAAM;IACtBtW,GAAG,CAACuW,QAAQ,CAAC,cAAc,EAAE,EAAE,EAAE,EAAE,CAAC;IACpC;;IAEA,IAAI,IAAI,CAACC,UAAU,CAAC9jB,CAAC,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,SAAS,CAAC,EAAE;MACrD,IAAI,CAACgU,aAAa,EAAE;MACpB;IACJ;IAEA,IAAIlc,CAAC,GAAG,EAAE;IACVwV,GAAG,CAACtD,IAAI,GAAG,YAAY;IACvB,IAAIuZ,OAAO,CAACnwB,MAAM,EACd,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGojC,OAAO,CAACnwB,MAAM,CAAC3T,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC5C,IAAIiX,KAAK,GAAGmsB,OAAO,CAACnwB,MAAM,CAACjT,CAAC,CAAC;MAC7B,IAAIiX,KAAK,CAAC2sB,kBAAkB,EACxB;;MAEJ;MACA,IAAI,IAAI,CAACD,UAAU,CAAC,EAAE,EAAEhsB,CAAC,GAAG,CAAC,EAAEkI,CAAC,GAAG,EAAE,EAAE0c,CAAC,GAAG,CAAC,CAAC,EAAE;QAC3C,IAAIx0B,IAAI,GAAGq7B,OAAO,CAAC35B,WAAW,CAACo6B,eAAe,IAAI,aAAa;QAC/D,IAAI,CAACrwB,KAAK,CAACwF,YAAY,EAAE;QACzB,IAAIwB,OAAO,GAAG3Y,SAAS,CAACkK,UAAU,CAAChE,IAAI,CAAC;QACxC,IAAIyS,OAAO,EAAE;UACTif,QAAQ,CAACnhB,GAAG,CAACkC,OAAO,CAAC;UACrB,IAAI,CAACyc,WAAW,GAAG,KAAK;UACxB,IAAI,CAACU,mBAAmB,GAAG,IAAI;UAC/B,IAAI,CAAC1D,WAAW,CAAC,CAACzZ,OAAO,CAAC,CAAC;UAC3B,IAAI,CAAClB,YAAY,GAAGkB,OAAO;UAC3B,IAAI,CAACqY,eAAe,GAAG,KAAK;UAC5BrY,OAAO,CAAC+F,WAAW,CAAC,MAAM,EAAEtJ,KAAK,CAAC3V,IAAI,CAAC;UACvCkZ,OAAO,CAAC+F,WAAW,CAAC,MAAM,EAAEtJ,KAAK,CAAClP,IAAI,CAAC;UACvC,IAAI,CAACuR,YAAY,CAAChR,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACqoB,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC;UAClD,IAAI,CAACrX,YAAY,CAAChR,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACqoB,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC;UAClD,IAAI,CAACnd,KAAK,CAACgG,WAAW,EAAE;QAC5B,CAAC,MAEGvR,OAAO,CAACkE,KAAK,CAAC,6BAA6B,EAAEpE,IAAI,CAAC;MAC1D;MACAolB,GAAG,CAAC0V,SAAS,GAAG,MAAM;MACtB1V,GAAG,CAACoU,SAAS,EAAE;MACfpU,GAAG,CAACwV,GAAG,CAAC9iB,CAAC,GAAG,EAAE,EAAElI,CAAC,GAAG4kB,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAGha,IAAI,CAACqgB,EAAE,CAAC;MAC/CzV,GAAG,CAACoV,IAAI,EAAE;MACVpV,GAAG,CAAC0V,SAAS,GAAG,MAAM;MACtB1V,GAAG,CAACuW,QAAQ,CAACzsB,KAAK,CAAC3V,IAAI,EAAE,EAAE,EAAEqW,CAAC,GAAG4kB,CAAC,GAAG,IAAI,CAAC;MAC1C;MACApP,GAAG,CAAC0V,SAAS,GAAG,MAAM;MACtB1V,GAAG,CAACuW,QAAQ,CAACzsB,KAAK,CAAClP,IAAI,EAAE,GAAG,EAAE4P,CAAC,GAAG4kB,CAAC,GAAG,IAAI,CAAC;MAC3C5kB,CAAC,IAAI4kB,CAAC;IACV;IACJ;IACA,IAAI,IAAI,CAACoH,UAAU,CAAC,EAAE,EAAEhsB,CAAC,GAAG,CAAC,EAAEkI,CAAC,GAAG,EAAE,EAAE0c,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,SAAS,EAAE,MAAM,CAAC,EAAE;MACnE,IAAI,CAACuH,4BAA4B,CAACV,OAAO,CAAC;IAC9C;EACJ,CAAC;EACD7vB,YAAY,CAACnT,SAAS,CAACkjC,sBAAsB,GAAG,UAAU7J,QAAQ,EAAE2J,OAAO,EAAEjW,GAAG,EAAE;IAC9E,IAAI1Y,GAAG,GAAG2uB,OAAO,CAAClwB,OAAO,GAAGkwB,OAAO,CAAClwB,OAAO,CAAC5T,MAAM,GAAG,CAAC;IACtD,IAAIykC,QAAQ,GAAG,IAAI,CAACxP,QAAQ,CAACnJ,KAAK;IAClC,IAAIvL,CAAC,GAAG,GAAG;IACX,IAAI0c,CAAC,GAAGha,IAAI,CAACC,KAAK,CAAC3gB,SAAS,CAACK,gBAAgB,GAAG,GAAG,CAAC;IAEpDirB,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACoW,WAAW,GAAG,GAAG;IACrBpW,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACqW,SAAS,CAACO,QAAQ,GAAGlkB,CAAC,GAAG,EAAE,EAAE,EAAE,EAAEA,CAAC,EAAE,CAACpL,GAAG,GAAG,CAAC,IAAI8nB,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;IAChEpP,GAAG,CAACoV,IAAI,EAAE;IACVpV,GAAG,CAACoW,WAAW,GAAG,CAAC;IAEnBpW,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACtD,IAAI,GAAG,YAAY;IACvBsD,GAAG,CAACsW,SAAS,GAAG,MAAM;IACtB,IAAIO,UAAU,GAAG,eAAe;IAChC,IAAIC,EAAE,GAAG9W,GAAG,CAAC+W,WAAW,CAACF,UAAU,CAAC,CAAC5Y,KAAK;IAC1C+B,GAAG,CAACuW,QAAQ,CAACM,UAAU,EAAGD,QAAQ,GAAGE,EAAE,GAAI,EAAE,EAAE,EAAE,CAAC;IAClD;IACA,IAAI,IAAI,CAACN,UAAU,CAACI,QAAQ,GAAGlkB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,SAAS,CAAC,EAAE;MAC3D,IAAI,CAACgU,aAAa,EAAE;MACpB;IACJ;IAEA,IAAIlc,CAAC,GAAG,EAAE;IACVwV,GAAG,CAACtD,IAAI,GAAG,YAAY;IACvB,IAAIuZ,OAAO,CAAClwB,OAAO,EACf,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGojC,OAAO,CAAClwB,OAAO,CAAC5T,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC7C,IAAIiW,MAAM,GAAGmtB,OAAO,CAAClwB,OAAO,CAAClT,CAAC,CAAC;MAC/B,IAAIiW,MAAM,CAAC2tB,kBAAkB,EACzB;;MAEJ;MACA,IAAI,IAAI,CAACD,UAAU,CAACI,QAAQ,GAAGlkB,CAAC,EAAElI,CAAC,GAAG,CAAC,EAAEkI,CAAC,GAAG,EAAE,EAAE0c,CAAC,GAAG,CAAC,CAAC,EAAE;QACrD,IAAIx0B,IAAI,GAAGq7B,OAAO,CAAC35B,WAAW,CAAC06B,gBAAgB,IAAI,cAAc;QACjE,IAAI,CAAC3wB,KAAK,CAACwF,YAAY,EAAE;QACzB,IAAIwB,OAAO,GAAG3Y,SAAS,CAACkK,UAAU,CAAChE,IAAI,CAAC;QACxC,IAAIyS,OAAO,EAAE;UACTif,QAAQ,CAACnhB,GAAG,CAACkC,OAAO,CAAC;UACrB,IAAI,CAACyc,WAAW,GAAG,KAAK;UACxB,IAAI,CAACU,mBAAmB,GAAG,IAAI;UAC/B,IAAI,CAAC1D,WAAW,CAAC,CAACzZ,OAAO,CAAC,CAAC;UAC3B,IAAI,CAAClB,YAAY,GAAGkB,OAAO;UAC3B,IAAI,CAACqY,eAAe,GAAG,KAAK;UAC5BrY,OAAO,CAAC+F,WAAW,CAAC,MAAM,EAAEtK,MAAM,CAAC3U,IAAI,CAAC;UACxCkZ,OAAO,CAAC+F,WAAW,CAAC,MAAM,EAAEtK,MAAM,CAAClO,IAAI,CAAC;UACxC,IAAI,CAACuR,YAAY,CAAChR,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACqoB,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC;UAClD,IAAI,CAACrX,YAAY,CAAChR,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACqoB,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC;UAClD,IAAI,CAACnd,KAAK,CAACgG,WAAW,EAAE;QAC5B,CAAC,MAEGvR,OAAO,CAACkE,KAAK,CAAC,6BAA6B,EAAEpE,IAAI,CAAC;MAC1D;MACAolB,GAAG,CAAC0V,SAAS,GAAG,MAAM;MACtB1V,GAAG,CAACoU,SAAS,EAAE;MACfpU,GAAG,CAACwV,GAAG,CAACoB,QAAQ,GAAGlkB,CAAC,GAAG,EAAE,EAAElI,CAAC,GAAG4kB,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAGha,IAAI,CAACqgB,EAAE,CAAC;MAC1DzV,GAAG,CAACoV,IAAI,EAAE;MACVpV,GAAG,CAAC0V,SAAS,GAAG,MAAM;MACtB1V,GAAG,CAACuW,QAAQ,CAACztB,MAAM,CAAC3U,IAAI,EAAEyiC,QAAQ,GAAGlkB,CAAC,GAAG,EAAE,EAAElI,CAAC,GAAG4kB,CAAC,GAAG,IAAI,CAAC;MAC1D;MACApP,GAAG,CAAC0V,SAAS,GAAG,MAAM;MACtB1V,GAAG,CAACuW,QAAQ,CAACztB,MAAM,CAAClO,IAAI,EAAEg8B,QAAQ,GAAGlkB,CAAC,GAAG,GAAG,EAAElI,CAAC,GAAG4kB,CAAC,GAAG,IAAI,CAAC;MAC3D5kB,CAAC,IAAI4kB,CAAC;IACV;IACJ;IACA,IAAI,IAAI,CAACoH,UAAU,CAACI,QAAQ,GAAGlkB,CAAC,EAAElI,CAAC,GAAG,CAAC,EAAEkI,CAAC,GAAG,EAAE,EAAE0c,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,SAAS,EAAE,MAAM,CAAC,EAAE;MAC7E,IAAI,CAAC6H,iCAAiC,CAAChB,OAAO,CAAC;IACnD;EACJ,CAAC;EACJ;EACA7vB,YAAY,CAACnT,SAAS,CAACujC,UAAU,GAAG,UAAUnsB,CAAC,EAACG,CAAC,EAACkI,CAAC,EAAC0c,CAAC,EAAE7sB,IAAI,EAAEuQ,OAAO,EAAEokB,UAAU,EAAEC,SAAS,EAC3F;IACC,IAAInX,GAAG,GAAG,IAAI,CAACA,GAAG;IAClBlN,OAAO,GAAGA,OAAO,IAAIpe,SAAS,CAACgB,kBAAkB;IACjDwhC,UAAU,GAAGA,UAAU,IAAI,MAAM;IACjCC,SAAS,GAAGA,SAAS,IAAIziC,SAAS,CAACc,eAAe;IAClD,IAAI4hC,IAAI,GAAG5sB,CAAC,GAAG9V,SAAS,CAACG,iBAAiB,GAAG,CAAC,CAAC,CAAC;IAChD,IAAIsG,GAAG,GAAG,IAAI,CAACooB,KAAK;IACpB,IAAI8T,KAAK,GAAG3iC,SAAS,CAACujB,iBAAiB,CAAE9c,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAEkP,CAAC,EAAC+sB,IAAI,EAAC1kB,CAAC,EAAC0c,CAAC,CAAE;IACrEj0B,GAAG,GAAG,IAAI,CAACqvB,mBAAmB;IAC9B,IAAI8M,OAAO,GAAGn8B,GAAG,IAAIzG,SAAS,CAACujB,iBAAiB,CAAE9c,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAEkP,CAAC,EAAC+sB,IAAI,EAAC1kB,CAAC,EAAC0c,CAAC,CAAE;IAE9EpP,GAAG,CAAC0V,SAAS,GAAG2B,KAAK,GAAGH,UAAU,GAAGpkB,OAAO;IAC5C,IAAGwkB,OAAO,EACTtX,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACvB1V,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACqW,SAAS,CAAChsB,CAAC,EAACG,CAAC,EAACkI,CAAC,EAAC0c,CAAC,EAAC,CAAC,CAAC,CAAC,CAAE;IAC3BpP,GAAG,CAACoV,IAAI,EAAE;IAEV,IAAG7yB,IAAI,IAAI,IAAI,EACf;MACC,IAAGA,IAAI,CAACjG,WAAW,IAAIC,MAAM,EAC7B;QACCyjB,GAAG,CAAC0V,SAAS,GAAGyB,SAAS;QACzBnX,GAAG,CAACsW,SAAS,GAAG,QAAQ;QACxBtW,GAAG,CAACtD,IAAI,GAAG,CAAE0S,CAAC,GAAG,IAAI,GAAE,CAAC,IAAI,UAAU;QACtCpP,GAAG,CAACuW,QAAQ,CAAEh0B,IAAI,EAAE8H,CAAC,GAAGqI,CAAC,GAAG,GAAG,EAAClI,CAAC,GAAG4kB,CAAC,GAAG,IAAI,CAAE;QAC9CpP,GAAG,CAACsW,SAAS,GAAG,MAAM;MACvB;IACD;IAEA,IAAIiB,WAAW,GAAGD,OAAO,IAAI,CAAC,IAAI,CAACxN,WAAW;IAC9C,IAAGwN,OAAO,EACT,IAAI,CAACzN,UAAU,EAAE;IAClB,OAAO0N,WAAW;EACnB,CAAC;EAEDnxB,YAAY,CAACnT,SAAS,CAACukC,aAAa,GAAG,UAAUntB,CAAC,EAACG,CAAC,EAACkI,CAAC,EAAC0c,CAAC,EAAEqI,UAAU,EACpE;IACC,IAAIt8B,GAAG,GAAG,IAAI,CAACooB,KAAK;IACpB,IAAI8T,KAAK,GAAG3iC,SAAS,CAACujB,iBAAiB,CAAE9c,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAEkP,CAAC,EAACG,CAAC,EAACkI,CAAC,EAAC0c,CAAC,CAAE;IAClEj0B,GAAG,GAAG,IAAI,CAACqvB,mBAAmB;IAC9B,IAAI8M,OAAO,GAAGn8B,GAAG,IAAIzG,SAAS,CAACujB,iBAAiB,CAAE9c,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAEkP,CAAC,EAACG,CAAC,EAACkI,CAAC,EAAC0c,CAAC,CAAE;IAC3E,IAAImI,WAAW,GAAGD,OAAO,IAAI,CAAC,IAAI,CAACxN,WAAW;IAC9C,IAAGwN,OAAO,IAAIG,UAAU,EACvB,IAAI,CAAC5N,UAAU,EAAE;IAClB,OAAO0N,WAAW;EACnB,CAAC;;EAEE;AACJ;AACA;AACA;EACInxB,YAAY,CAACnT,SAAS,CAACwhC,UAAU,GAAG,UAASzU,GAAG,EAAE3V,CAAC,EAAEG,CAAC,EAAE;IACpDH,CAAC,GAAGA,CAAC,IAAI,EAAE;IACXG,CAAC,GAAGA,CAAC,IAAI,IAAI,CAACyB,MAAM,CAACiS,MAAM,GAAG,EAAE;IAEhC8B,GAAG,CAACmU,IAAI,EAAE;IACVnU,GAAG,CAACC,SAAS,CAAC5V,CAAC,EAAEG,CAAC,CAAC;IAEnBwV,GAAG,CAACtD,IAAI,GAAG,YAAY;IACvBsD,GAAG,CAAC0V,SAAS,GAAG,MAAM;IAC5B1V,GAAG,CAACsW,SAAS,GAAG,MAAM;IAChB,IAAI,IAAI,CAACjwB,KAAK,EAAE;MACZ2Z,GAAG,CAACuW,QAAQ,CAAE,KAAK,GAAG,IAAI,CAAClwB,KAAK,CAAClB,UAAU,CAACuyB,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,CAAE;MACzE1X,GAAG,CAACuW,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAClwB,KAAK,CAACtB,SAAS,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,CAAE;MACtDib,GAAG,CAACuW,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAClwB,KAAK,CAAC7B,MAAM,CAACrS,MAAM,GAAG,IAAI,GAAG,IAAI,CAACmzB,aAAa,CAACnzB,MAAM,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,CAAE;MACnG6tB,GAAG,CAACuW,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAClwB,KAAK,CAAC9B,QAAQ,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;MACpDyb,GAAG,CAACuW,QAAQ,CAAC,MAAM,GAAG,IAAI,CAACnR,GAAG,CAACsS,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;IACzD,CAAC,MAAM;MACH1X,GAAG,CAACuW,QAAQ,CAAC,mBAAmB,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;IAChD;IACAvW,GAAG,CAACgU,OAAO,EAAE;EACjB,CAAC;;EAED;AACJ;AACA;AACA;EACI5tB,YAAY,CAACnT,SAAS,CAAC4gC,cAAc,GAAG,YAAW;IAC/C,IAAI5nB,MAAM,GAAG,IAAI,CAACmb,QAAQ;IAC1B,IACInb,MAAM,CAACgS,KAAK,IAAI,IAAI,CAAChS,MAAM,CAACgS,KAAK,IACjChS,MAAM,CAACiS,MAAM,IAAI,IAAI,CAACjS,MAAM,CAACiS,MAAM,EACrC;MACEjS,MAAM,CAACgS,KAAK,GAAG,IAAI,CAAChS,MAAM,CAACgS,KAAK;MAChChS,MAAM,CAACiS,MAAM,GAAG,IAAI,CAACjS,MAAM,CAACiS,MAAM;IACtC;IAEA,IAAI,CAAC,IAAI,CAACiL,KAAK,EAAE;MACb,IAAI,CAACA,KAAK,GAAG,IAAI,CAAC/B,QAAQ,CAACC,UAAU,CAAC,IAAI,CAAC;IAC/C;IACA,IAAIrH,GAAG,GAAG,IAAI,CAACmJ,KAAK;IACpB,IAAInJ,GAAG,CAACxZ,KAAK,EAAE;MACXwZ,GAAG,CAACxZ,KAAK,EAAE;IACf;IAEN,IAAIwX,QAAQ,GAAG,IAAI,CAACA,QAAQ,IAAI,CAAC,CAAC,EAAC,CAAC,EAACgC,GAAG,CAAC/T,MAAM,CAACgS,KAAK,EAAC+B,GAAG,CAAC/T,MAAM,CAACiS,MAAM,CAAC;;IAElE;IACA,IAAI,IAAI,CAAC6D,gBAAgB,EAAE;MACvB/B,GAAG,CAACsU,SAAS,CAAEtW,QAAQ,CAAC,CAAC,CAAC,EAAEA,QAAQ,CAAC,CAAC,CAAC,EAAEA,QAAQ,CAAC,CAAC,CAAC,EAAEA,QAAQ,CAAC,CAAC,CAAC,CAAE;IACvE;;IAEN;IACM,IAAI,IAAI,CAACqI,YAAY,IAAI,IAAI,CAACA,YAAY,CAACl0B,MAAM,EAAE;MAC/C6tB,GAAG,CAACmU,IAAI,EAAE;MACV,IAAIwD,YAAY,GAAG,IAAI,CAACtR,YAAY,CAAC,IAAI,CAACA,YAAY,CAACl0B,MAAM,GAAG,CAAC,CAAC;MAClE,IAAIw0B,aAAa,GAAG,IAAI,CAACtgB,KAAK,CAACugB,cAAc;MAC7C5G,GAAG,CAAC2V,WAAW,GAAGhP,aAAa,CAAC7T,OAAO;MACvCkN,GAAG,CAAC+U,SAAS,GAAG,EAAE;MAClB/U,GAAG,CAAC4V,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE3pB,MAAM,CAACgS,KAAK,GAAG,CAAC,EAAEhS,MAAM,CAACiS,MAAM,GAAG,CAAC,CAAC;MACzD8B,GAAG,CAAC+U,SAAS,GAAG,CAAC;MACjB/U,GAAG,CAACtD,IAAI,GAAG,YAAY;MACvBsD,GAAG,CAACsW,SAAS,GAAG,QAAQ;MACxBtW,GAAG,CAAC0V,SAAS,GAAG/O,aAAa,CAAC7T,OAAO,IAAI,MAAM;MAC/C,IAAI3f,KAAK,GAAG,EAAE;MACd,KAAK,IAAIN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACwzB,YAAY,CAACl0B,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC/CM,KAAK,IACD,IAAI,CAACkzB,YAAY,CAACxzB,CAAC,CAAC,CAAC+zB,cAAc,CAACzT,QAAQ,EAAE,GAAG,MAAM;MAC/D;MACA6M,GAAG,CAACuW,QAAQ,CACRpjC,KAAK,GAAGwzB,aAAa,CAACxT,QAAQ,EAAE,EAChClH,MAAM,CAACgS,KAAK,GAAG,GAAG,EAClB,EAAE,CACL;MACD+B,GAAG,CAACgU,OAAO,EAAE;IACjB;IAEA,IAAI4D,kBAAkB,GAAG,KAAK;IAC9B,IAAI,IAAI,CAACC,kBAAkB,EAAE;MACzBD,kBAAkB,GAAG,IAAI,CAACC,kBAAkB,CAAC5rB,MAAM,EAAE+T,GAAG,CAAC;IAC7D;;IAEA;IACA,IAAK,CAAC,IAAI,CAAChC,QAAQ,EACzB;MACOgC,GAAG,CAACgU,OAAO,EAAE;MAChBhU,GAAG,CAACiU,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACtC;IACM,IAAI,CAACxP,aAAa,CAACtyB,MAAM,GAAG,CAAC;IAE7B,IAAI,IAAI,CAACkU,KAAK,EAAE;MACZ;MACA2Z,GAAG,CAACmU,IAAI,EAAE;MACV,IAAI,CAACrT,EAAE,CAACf,eAAe,CAACC,GAAG,CAAC;;MAE5B;MACA,IACI,IAAI,CAACW,gBAAgB,IACrB,IAAI,CAACG,EAAE,CAAC5E,KAAK,GAAG,GAAG,IACnB,CAAC0b,kBAAkB,EACrB;QACE,IAAI,IAAI,CAAC7W,iBAAiB,EAAE;UACxBf,GAAG,CAACoW,WAAW,GACX,CAAC,GAAG,GAAG,GAAG,GAAG,IAAI,CAACtV,EAAE,CAAC5E,KAAK,IAAI,IAAI,CAAC2F,YAAY;QACvD,CAAC,MAAM;UACH7B,GAAG,CAACoW,WAAW,GAAG,IAAI,CAACvU,YAAY;QACvC;QACA7B,GAAG,CAAC8X,qBAAqB,GAAG9X,GAAG,CAAC8X,qBAAqB,GAAG,KAAK,CAAC,CAAC;QAC/D,IACI,CAAC,IAAI,CAACC,OAAO,IACb,IAAI,CAACA,OAAO,CAAC5jC,IAAI,IAAI,IAAI,CAACwsB,gBAAgB,EAC5C;UACE,IAAI,CAACoX,OAAO,GAAG,IAAIxc,KAAK,EAAE;UAC1B,IAAI,CAACwc,OAAO,CAAC5jC,IAAI,GAAG,IAAI,CAACwsB,gBAAgB;UACzC,IAAI,CAACoX,OAAO,CAACt3B,GAAG,GAAG,IAAI,CAACkgB,gBAAgB;UACxC,IAAI1e,IAAI,GAAG,IAAI;UACf,IAAI,CAAC81B,OAAO,CAACh1B,MAAM,GAAG,YAAW;YAC7Bd,IAAI,CAAC0nB,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC;UACzB,CAAC;QACL;QAEA,IAAIqO,OAAO,GAAG,IAAI;QAClB,IAAI,IAAI,CAACC,QAAQ,IAAI,IAAI,IAAI,IAAI,CAACF,OAAO,CAAC9Z,KAAK,GAAG,CAAC,EAAE;UACjD+Z,OAAO,GAAGhY,GAAG,CAACkY,aAAa,CAAC,IAAI,CAACH,OAAO,EAAE,QAAQ,CAAC;UACnD,IAAI,CAACI,YAAY,GAAG,IAAI,CAACJ,OAAO;UAChC,IAAI,CAACE,QAAQ,GAAGD,OAAO;QAC3B,CAAC,MAAM;UACHA,OAAO,GAAG,IAAI,CAACC,QAAQ;QAC3B;QACA,IAAID,OAAO,EAAE;UACThY,GAAG,CAAC0V,SAAS,GAAGsC,OAAO;UACvBhY,GAAG,CAACoY,QAAQ,CACR,IAAI,CAAC1a,YAAY,CAAC,CAAC,CAAC,EACpB,IAAI,CAACA,YAAY,CAAC,CAAC,CAAC,EACpB,IAAI,CAACA,YAAY,CAAC,CAAC,CAAC,EACpB,IAAI,CAACA,YAAY,CAAC,CAAC,CAAC,CACvB;UACDsC,GAAG,CAAC0V,SAAS,GAAG,aAAa;QACjC;QAEA1V,GAAG,CAACoW,WAAW,GAAG,GAAG;QACrBpW,GAAG,CAAC8X,qBAAqB,GAAG9X,GAAG,CAAC8X,qBAAqB,GAAG,IAAI,CAAC,CAAC;MAClE;;MAEA;MACA,IAAI,IAAI,CAACzxB,KAAK,CAACxB,OAAO,CAAC1S,MAAM,IAAI,CAAC,IAAI,CAAC0d,SAAS,EAAE;QAC9C,IAAI,CAACwoB,UAAU,CAACpsB,MAAM,EAAE+T,GAAG,CAAC;MAChC;MAEA,IAAI,IAAI,CAAC4D,gBAAgB,EAAE;QACvB,IAAI,CAACA,gBAAgB,CAAC5D,GAAG,EAAE,IAAI,CAACtC,YAAY,CAAC;MACjD;MACA,IAAI,IAAI,CAAC4a,kBAAkB,EAAE;QACzB;QACAx9B,OAAO,CAACkE,KAAK,CACT,wEAAwE,CAC3E;QACD,IAAI,CAACs5B,kBAAkB,GAAG,IAAI;MAClC;;MAEA;MACA;MACA;;MAEA;MACA,IAAI,IAAI,CAACzV,oBAAoB,EAAE;QAC3B7C,GAAG,CAAC2V,WAAW,GAAG,MAAM;QACxB3V,GAAG,CAAC4V,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE3pB,MAAM,CAACgS,KAAK,EAAEhS,MAAM,CAACiS,MAAM,CAAC;MACrD;MAEA,IAAI,IAAI,CAAC4E,0BAA0B,EAAE;QACjC9C,GAAG,CAACuY,WAAW,GAAG,MAAM;QACxBvY,GAAG,CAACwY,aAAa,GAAG,CAAC;QACrBxY,GAAG,CAACyY,aAAa,GAAG,CAAC;QACrBzY,GAAG,CAAC0Y,UAAU,GAAG,CAAC;MACtB,CAAC,MAAM;QACH1Y,GAAG,CAACuY,WAAW,GAAG,eAAe;MACrC;;MAEA;MACA,IAAI,CAAC,IAAI,CAAC1oB,SAAS,EAAE;QACjB,IAAI,CAACilB,eAAe,CAAC9U,GAAG,CAAC;MAC7B;MAEAA,GAAG,CAACuY,WAAW,GAAG,eAAe;;MAEjC;MACAvY,GAAG,CAACgU,OAAO,EAAE;IACjB;IAEA,IAAIhU,GAAG,CAAC2Y,MAAM,EAAE;MACZ3Y,GAAG,CAAC2Y,MAAM,EAAE;IAChB;IAEA,IAAI,CAAC/S,cAAc,GAAG,KAAK;IAC3B,IAAI,CAACD,YAAY,GAAG,IAAI,CAAC,CAAC;EAC9B,CAAC;;EAED,IAAIiT,SAAS,GAAG,IAAIzmB,YAAY,CAAC,CAAC,CAAC;;EAEnC;AACJ;AACA;AACA;EACI/L,YAAY,CAACnT,SAAS,CAAC0hC,QAAQ,GAAG,UAAS71B,IAAI,EAAEkhB,GAAG,EAAE;IAClD,IAAI6Y,IAAI,GAAG,KAAK;IAChB,IAAI,CAACxU,YAAY,GAAGvlB,IAAI;IAExB,IAAIgT,KAAK,GAAGhT,IAAI,CAACgT,KAAK,IAAIhT,IAAI,CAACxC,WAAW,CAACwV,KAAK,IAAIpd,SAAS,CAACgB,kBAAkB;IAChF,IAAIod,OAAO,GAAGhU,IAAI,CAACgU,OAAO,IAAIhU,IAAI,CAACxC,WAAW,CAACwW,OAAO,IAAIpe,SAAS,CAACiB,oBAAoB;;IAExF;IACA,IAAImJ,IAAI,CAACqvB,SAAS,EAAE;MAChB0K,IAAI,GAAG,IAAI;IACf;IAEA,IAAIC,WAAW,GAAG,IAAI,CAAChY,EAAE,CAAC5E,KAAK,GAAG,GAAG,CAAC,CAAC;;IAEvC;IACA,IAAI,IAAI,CAACrM,SAAS,EAAE;MAChB,IAAI,CAAC/Q,IAAI,CAACI,KAAK,CAAC2Y,SAAS,EAAE;QACvBmI,GAAG,CAACuY,WAAW,GAAG,aAAa;QAC/B,IAAIz5B,IAAI,CAAC+kB,gBAAgB,EAAE;UACvB/kB,IAAI,CAAC+kB,gBAAgB,CAAC7D,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC/T,MAAM,CAAC;QACjD;MACJ;MACA;IACJ;IAEA,IAAI4V,YAAY,GAAG,IAAI,CAACA,YAAY;IACpC7B,GAAG,CAACoW,WAAW,GAAGvU,YAAY;IAE9B,IAAI,IAAI,CAACe,cAAc,IAAI,CAACkW,WAAW,EAAE;MACrC9Y,GAAG,CAACuY,WAAW,GAAG7jC,SAAS,CAACqB,oBAAoB;MAChDiqB,GAAG,CAACwY,aAAa,GAAG,CAAC,GAAG,IAAI,CAAC1X,EAAE,CAAC5E,KAAK;MACrC8D,GAAG,CAACyY,aAAa,GAAG,CAAC,GAAG,IAAI,CAAC3X,EAAE,CAAC5E,KAAK;MACrC8D,GAAG,CAAC0Y,UAAU,GAAG,CAAC,GAAG,IAAI,CAAC5X,EAAE,CAAC5E,KAAK;IACtC,CAAC,MAAM;MACH8D,GAAG,CAACuY,WAAW,GAAG,aAAa;IACnC;;IAEA;IACA,IACIz5B,IAAI,CAACI,KAAK,CAAC2Y,SAAS,IACpB/Y,IAAI,CAACi6B,eAAe,IACpBj6B,IAAI,CAACi6B,eAAe,CAAC/Y,GAAG,EAAE,IAAI,CAAC,IAAI,IAAI,EACzC;MACE;IACJ;;IAEA;IACA,IAAIhN,KAAK,GAAGlU,IAAI,CAAChD,MAAM,IAAIpH,SAAS,CAACiC,SAAS;IAC9C,IAAIwI,IAAI,GAAGy5B,SAAS;IACpBA,SAAS,CAACh9B,GAAG,CAACkD,IAAI,CAACK,IAAI,CAAC;IACxB,IAAI4b,UAAU,GAAGjc,IAAI,CAACic,UAAU,CAAC,CAAC;;IAElC,IAAIjc,IAAI,CAACI,KAAK,CAAC2Y,SAAS,EAAE;MACtBmI,GAAG,CAACtD,IAAI,GAAG,IAAI,CAACuE,eAAe;MAC/B,IAAI9tB,KAAK,GAAG2L,IAAI,CAACqU,QAAQ,GAAGrU,IAAI,CAACqU,QAAQ,EAAE,GAAGrU,IAAI,CAAC3L,KAAK;MACxD,IAAIA,KAAK,IAAI,IAAI,EAAE;QACf2L,IAAI,CAACoZ,gBAAgB,GAAG9C,IAAI,CAAC4jB,GAAG,CAC5Bl6B,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,EACZ6gB,GAAG,CAAC+W,WAAW,CAAC5jC,KAAK,CAAC,CAAC8qB,KAAK,GACxBvpB,SAAS,CAACG,iBAAiB,GAAG,CAAC,CACtC,CAAC,CAAC;QACHsK,IAAI,CAAC,CAAC,CAAC,GAAGL,IAAI,CAACoZ,gBAAgB;QAC/B/Y,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC;MACf;IACJ;IAEA,IAAIL,IAAI,CAACm6B,SAAS,EAAE;MAChB;MACAjZ,GAAG,CAACmU,IAAI,EAAE;MACVnU,GAAG,CAACoU,SAAS,EAAE;MACf,IAAIphB,KAAK,IAAIte,SAAS,CAACiC,SAAS,EAAE;QAC9BqpB,GAAG,CAACzB,IAAI,CAAC,CAAC,EAAE,CAAC,EAAEpf,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,CAAC;MACpC,CAAC,MAAM,IAAI6T,KAAK,IAAIte,SAAS,CAACkC,WAAW,EAAE;QACvCopB,GAAG,CAACqW,SAAS,CAAC,CAAC,EAAE,CAAC,EAAEl3B,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MAC/C,CAAC,MAAM,IAAI6T,KAAK,IAAIte,SAAS,CAACmC,YAAY,EAAE;QACxCmpB,GAAG,CAACwV,GAAG,CACHr2B,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EACbA,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EACbA,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EACb,CAAC,EACDiW,IAAI,CAACqgB,EAAE,GAAG,CAAC,CACd;MACL;MACAzV,GAAG,CAACqU,IAAI,EAAE;IACd;;IAEA;IACA,IAAIv1B,IAAI,CAACiS,UAAU,EAAE;MACjB+B,OAAO,GAAG,KAAK;IACnB;IACA,IAAI,CAAComB,aAAa,CACdp6B,IAAI,EACJkhB,GAAG,EACH7gB,IAAI,EACJ2S,KAAK,EACLgB,OAAO,EACPhU,IAAI,CAAC0zB,WAAW,EAChB1zB,IAAI,CAACqvB,SAAS,CACjB;IACDnO,GAAG,CAACuY,WAAW,GAAG,aAAa;;IAE/B;IACA,IAAIz5B,IAAI,CAAC+kB,gBAAgB,EAAE;MACvB/kB,IAAI,CAAC+kB,gBAAgB,CAAC7D,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC/T,MAAM,CAAC;IACjD;;IAEA;IACA+T,GAAG,CAACsW,SAAS,GAAGvb,UAAU,GAAG,QAAQ,GAAG,MAAM;IAC9CiF,GAAG,CAACtD,IAAI,GAAG,IAAI,CAACuE,eAAe;IAE/B,IAAIkY,WAAW,GAAG,CAACL,WAAW;IAE9B,IAAIM,QAAQ,GAAG,IAAI,CAAC5N,iBAAiB;IACrC,IAAI6N,OAAO,GAAG,IAAI,CAACpN,gBAAgB;IACnCjM,GAAG,CAAC+U,SAAS,GAAG,CAAC;IAEjB,IAAIuE,KAAK,GAAG,CAAC;IACb,IAAIpJ,QAAQ,GAAG,IAAI/d,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;;IAEpC;IACA,IAAI,CAACrT,IAAI,CAACI,KAAK,CAAC2Y,SAAS,EAAE;MACvB;MACA,IAAI/Y,IAAI,CAACgH,MAAM,EAAE;QACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAEU,CAAC,EAAE,EAAE;UACzC,IAAIiZ,IAAI,GAAGhN,IAAI,CAACgH,MAAM,CAACjT,CAAC,CAAC;UAEzB,IAAIiK,SAAS,GAAGgP,IAAI,CAAClR,IAAI;UACzB,IAAI2+B,UAAU,GAAGztB,IAAI,CAACkH,KAAK;UAE3BgN,GAAG,CAACoW,WAAW,GAAGvU,YAAY;UAC9B;UACA,IAAK,IAAI,CAAC2J,iBAAiB,IAAI,CAAC92B,SAAS,CAACwM,iBAAiB,CAAE4K,IAAI,CAAClR,IAAI,EAAGw+B,QAAQ,CAACx+B,IAAI,CAAC,EAAG;YACtFolB,GAAG,CAACoW,WAAW,GAAG,GAAG,GAAGvU,YAAY;UACxC;UAEA7B,GAAG,CAAC0V,SAAS,GACT5pB,IAAI,CAACnD,IAAI,IAAI,IAAI,GACXmD,IAAI,CAAC0tB,QAAQ,IACb,IAAI,CAAC/X,+BAA+B,CAAC3kB,SAAS,CAAC,IAC/C,IAAI,CAACskB,wBAAwB,CAACE,QAAQ,GACtCxV,IAAI,CAAC2tB,SAAS,IACd,IAAI,CAAC/X,kCAAkC,CAAC5kB,SAAS,CAAC,IAClD,IAAI,CAAC2kB,+BAA+B,CAAC3kB,SAAS,CAAC,IAC/C,IAAI,CAACskB,wBAAwB,CAACC,SAAS;UAEjD,IAAIlmB,GAAG,GAAG2D,IAAI,CAACuZ,gBAAgB,CAAC,IAAI,EAAExlB,CAAC,EAAEq9B,QAAQ,CAAC;UAClD/0B,GAAG,CAAC,CAAC,CAAC,IAAI2D,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC;UACrBA,GAAG,CAAC,CAAC,CAAC,IAAI2D,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC;UACrB,IAAIm+B,KAAK,GAAGn+B,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACK,gBAAgB,GAAG,GAAG,EAAE;YACnDukC,KAAK,GAAGn+B,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACK,gBAAgB,GAAG,GAAG;UACrD;UAEAirB,GAAG,CAACoU,SAAS,EAAE;UAE9B,IAAIt3B,SAAS,IAAI,OAAO,EAAC;YACNy8B,UAAU,GAAG7kC,SAAS,CAACsC,UAAU,CAAC,CAAC;UACvC;;UAEA,IAAI0iC,QAAQ,GAAG,IAAI;UAEnB,IACI5tB,IAAI,CAAClR,IAAI,KAAKlG,SAAS,CAACyC,KAAK,IAC7B2U,IAAI,CAACkH,KAAK,KAAKte,SAAS,CAACiC,SAAS,EACpC;YACE,IAAIokB,UAAU,EAAE;cACZiF,GAAG,CAACzB,IAAI,CACJpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAChBA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAChB,EAAE,EACF,EAAE,CACL;YACL,CAAC,MAAM;cACH6kB,GAAG,CAACzB,IAAI,CACJpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAChBA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAChB,EAAE,EACF,EAAE,CACL;YACL;UACJ,CAAC,MAAM,IAAIo+B,UAAU,KAAK7kC,SAAS,CAACqC,WAAW,EAAE;YAC7CipB,GAAG,CAACqV,MAAM,CAACl6B,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;YACpC6kB,GAAG,CAACsV,MAAM,CAACn6B,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;YACxC6kB,GAAG,CAACsV,MAAM,CAACn6B,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;YACxC6kB,GAAG,CAACuV,SAAS,EAAE;UACnB,CAAC,MAAM,IAAIgE,UAAU,KAAK7kC,SAAS,CAACsC,UAAU,EAAE;YAC5CgpB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtCu+B,QAAQ,GAAG,KAAK;UACpB,CAAC,MAAM;YACrB,IAAGZ,WAAW,EACK9Y,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC,CAAC;YAAA,KAEzC6kB,GAAG,CAACwV,GAAG,CAACr6B,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAEia,IAAI,CAACqgB,EAAE,GAAG,CAAC,CAAC;UAC/C;UACAzV,GAAG,CAACoV,IAAI,EAAE;;UAEV;UACA,IAAI+D,WAAW,EAAE;YACb,IAAI52B,IAAI,GAAGuJ,IAAI,CAAC+K,KAAK,IAAI,IAAI,GAAG/K,IAAI,CAAC+K,KAAK,GAAG/K,IAAI,CAAC3X,IAAI;YACtD,IAAIoO,IAAI,EAAE;cACNyd,GAAG,CAAC0V,SAAS,GAAGhhC,SAAS,CAACc,eAAe;cACzC,IAAIulB,UAAU,IAAIjP,IAAI,CAACvX,GAAG,IAAIG,SAAS,CAACiD,EAAE,EAAE;gBACxCqoB,GAAG,CAACuW,QAAQ,CAACh0B,IAAI,EAAEpH,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;cAC3C,CAAC,MAAM;gBACH6kB,GAAG,CAACuW,QAAQ,CAACh0B,IAAI,EAAEpH,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;cAC/C;YACJ;UACJ;QACJ;MACJ;;MAEA;;MAEA6kB,GAAG,CAACsW,SAAS,GAAGvb,UAAU,GAAG,QAAQ,GAAG,OAAO;MAC/CiF,GAAG,CAAC2V,WAAW,GAAG,OAAO;MACzB,IAAI72B,IAAI,CAACiH,OAAO,EAAE;QACd,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAEU,CAAC,EAAE,EAAE;UAC1C,IAAIiZ,IAAI,GAAGhN,IAAI,CAACiH,OAAO,CAAClT,CAAC,CAAC;UAE1B,IAAIiK,SAAS,GAAGgP,IAAI,CAAClR,IAAI;UACzB,IAAI2+B,UAAU,GAAGztB,IAAI,CAACkH,KAAK;;UAE3B;UACA,IAAI,IAAI,CAACiZ,gBAAgB,IAAI,CAACv3B,SAAS,CAACwM,iBAAiB,CAAEpE,SAAS,EAAGu8B,OAAO,CAACz+B,IAAI,CAAC,EAAG;YACnFolB,GAAG,CAACoW,WAAW,GAAG,GAAG,GAAGvU,YAAY;UACxC;UAEA,IAAI1mB,GAAG,GAAG2D,IAAI,CAACuZ,gBAAgB,CAAC,KAAK,EAAExlB,CAAC,EAAEq9B,QAAQ,CAAC;UACnD/0B,GAAG,CAAC,CAAC,CAAC,IAAI2D,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC;UACrBA,GAAG,CAAC,CAAC,CAAC,IAAI2D,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC;UACrB,IAAIm+B,KAAK,GAAGn+B,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACK,gBAAgB,GAAG,GAAG,EAAE;YACnDukC,KAAK,GAAGn+B,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACK,gBAAgB,GAAG,GAAG;UACrD;UAEAirB,GAAG,CAAC0V,SAAS,GACT5pB,IAAI,CAAChH,KAAK,IAAIgH,IAAI,CAAChH,KAAK,CAAC3S,MAAM,GACzB2Z,IAAI,CAAC0tB,QAAQ,IACb,IAAI,CAAC/X,+BAA+B,CAAC3kB,SAAS,CAAC,IAC/C,IAAI,CAACskB,wBAAwB,CAACI,SAAS,GACvC1V,IAAI,CAAC2tB,SAAS,IACd,IAAI,CAAC/X,kCAAkC,CAAC5kB,SAAS,CAAC,IAClD,IAAI,CAAC2kB,+BAA+B,CAAC3kB,SAAS,CAAC,IAC/C,IAAI,CAACskB,wBAAwB,CAACG,UAAU;UAClDvB,GAAG,CAACoU,SAAS,EAAE;UACf;;UAEf,IAAIt3B,SAAS,IAAI,OAAO,EAAC;YACNy8B,UAAU,GAAG7kC,SAAS,CAACsC,UAAU;UACrC;UAEA,IAAI0iC,QAAQ,GAAG,IAAI;UAEnB,IACI58B,SAAS,KAAKpI,SAAS,CAACyC,KAAK,IAC7BoiC,UAAU,KAAK7kC,SAAS,CAACiC,SAAS,EACpC;YACE,IAAIokB,UAAU,EAAE;cACZiF,GAAG,CAACzB,IAAI,CACJpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAChBA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAChB,EAAE,EACF,EAAE,CACL;YACL,CAAC,MAAM;cACH6kB,GAAG,CAACzB,IAAI,CACJpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAChBA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,EAChB,EAAE,EACF,EAAE,CACL;YACL;UACJ,CAAC,MAAM,IAAIo+B,UAAU,KAAK7kC,SAAS,CAACqC,WAAW,EAAE;YAC7CipB,GAAG,CAACqV,MAAM,CAACl6B,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;YACpC6kB,GAAG,CAACsV,MAAM,CAACn6B,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;YACxC6kB,GAAG,CAACsV,MAAM,CAACn6B,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;YACxC6kB,GAAG,CAACuV,SAAS,EAAE;UACnB,CAAC,MAAO,IAAIgE,UAAU,KAAK7kC,SAAS,CAACsC,UAAU,EAAE;YAC7CgpB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtC6kB,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACtCu+B,QAAQ,GAAG,KAAK;UACpB,CAAC,MAAM;YACrB,IAAGZ,WAAW,EACK9Y,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC,KAExC6kB,GAAG,CAACwV,GAAG,CAACr6B,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAEia,IAAI,CAACqgB,EAAE,GAAG,CAAC,CAAC;UAC/C;;UAEA;UACA;UACA;;UAEA;UACAzV,GAAG,CAACoV,IAAI,EAAE;UACzB,IAAG,CAAC0D,WAAW,IAAIY,QAAQ,EACX1Z,GAAG,CAAC2Z,MAAM,EAAE;;UAEb;UACA,IAAIR,WAAW,EAAE;YACb,IAAI52B,IAAI,GAAGuJ,IAAI,CAAC+K,KAAK,IAAI,IAAI,GAAG/K,IAAI,CAAC+K,KAAK,GAAG/K,IAAI,CAAC3X,IAAI;YACtD,IAAIoO,IAAI,EAAE;cACNyd,GAAG,CAAC0V,SAAS,GAAGhhC,SAAS,CAACc,eAAe;cACzC,IAAIulB,UAAU,IAAIjP,IAAI,CAACvX,GAAG,IAAIG,SAAS,CAACkD,IAAI,EAAE;gBAC1CooB,GAAG,CAACuW,QAAQ,CAACh0B,IAAI,EAAEpH,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;cAC1C,CAAC,MAAM;gBACH6kB,GAAG,CAACuW,QAAQ,CAACh0B,IAAI,EAAEpH,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;cAC/C;YACJ;UACJ;QACJ;MACJ;MAEA6kB,GAAG,CAACsW,SAAS,GAAG,MAAM;MACtBtW,GAAG,CAACoW,WAAW,GAAG,CAAC;MAEnB,IAAIt3B,IAAI,CAAC2T,OAAO,EAAE;QAC1B,IAAImnB,SAAS,GAAGN,KAAK;QACT,IAAIve,UAAU,IAAIjc,IAAI,CAACmY,UAAU,EAAE;UAC/B2iB,SAAS,GAAG,CAAC;QACjB;QACZ,IAAI96B,IAAI,CAACoY,eAAe,IAAI,IAAI,EAChB0iB,SAAS,GAAG96B,IAAI,CAACoY,eAAe;QACpC,IAAI,CAAC2iB,eAAe,CAChB/6B,IAAI,EACJ86B,SAAS,EACT5Z,GAAG,EACH,IAAI,CAACsE,WAAW,IAAI,IAAI,CAACA,WAAW,CAAC,CAAC,CAAC,IAAIxlB,IAAI,GACzC,IAAI,CAACwlB,WAAW,CAAC,CAAC,CAAC,GACnB,IAAI,CACb;MACL;IACJ,CAAC,MAAM,IAAI,IAAI,CAACpB,sBAAsB,EAAE;MACpC;MACA,IAAI4W,UAAU,GAAG,IAAI;MACrB,IAAIC,WAAW,GAAG,IAAI;;MAEtB;MACA,IAAIj7B,IAAI,CAACgH,MAAM,EAAE;QACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAEU,CAAC,EAAE,EAAE;UACzC,IAAIiZ,IAAI,GAAGhN,IAAI,CAACgH,MAAM,CAACjT,CAAC,CAAC;UACzB,IAAIiZ,IAAI,CAACnD,IAAI,IAAI,IAAI,EAAE;YACnB;UACJ;UACAmxB,UAAU,GAAGhuB,IAAI;UACjB;QACJ;MACJ;MACA,IAAIhN,IAAI,CAACiH,OAAO,EAAE;QACd,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAEU,CAAC,EAAE,EAAE;UAC1C,IAAIiZ,IAAI,GAAGhN,IAAI,CAACiH,OAAO,CAAClT,CAAC,CAAC;UAC1B,IAAI,CAACiZ,IAAI,CAAChH,KAAK,IAAI,CAACgH,IAAI,CAAChH,KAAK,CAAC3S,MAAM,EAAE;YACnC;UACJ;UACA4nC,WAAW,GAAGjuB,IAAI;QACtB;MACJ;MAEA,IAAIguB,UAAU,EAAE;QACZ,IAAIzvB,CAAC,GAAG,CAAC;QACT,IAAIG,CAAC,GAAG9V,SAAS,CAACG,iBAAiB,GAAG,CAAC,GAAG,CAAC,CAAC;QAC5C,IAAIkmB,UAAU,EAAE;UACZ1Q,CAAC,GAAGvL,IAAI,CAACoZ,gBAAgB,GAAG,GAAG;UAC/B1N,CAAC,GAAG,CAAC9V,SAAS,CAACG,iBAAiB;QACpC;QACAmrB,GAAG,CAAC0V,SAAS,GAAG,MAAM;QACtB1V,GAAG,CAACoU,SAAS,EAAE;QACf,IACItoB,IAAI,CAAClR,IAAI,KAAKlG,SAAS,CAACyC,KAAK,IAC7B2U,IAAI,CAACkH,KAAK,KAAKte,SAAS,CAACiC,SAAS,EACpC;UACEqpB,GAAG,CAACzB,IAAI,CAAClU,CAAC,GAAG,CAAC,GAAG,GAAG,EAAEG,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;QACvC,CAAC,MAAM,IAAIsB,IAAI,CAACkH,KAAK,KAAKte,SAAS,CAACqC,WAAW,EAAE;UAC7CipB,GAAG,CAACqV,MAAM,CAAChrB,CAAC,GAAG,CAAC,EAAEG,CAAC,CAAC;UACpBwV,GAAG,CAACsV,MAAM,CAACjrB,CAAC,GAAG,CAAC,CAAC,EAAEG,CAAC,GAAG,CAAC,CAAC;UACzBwV,GAAG,CAACsV,MAAM,CAACjrB,CAAC,GAAG,CAAC,CAAC,EAAEG,CAAC,GAAG,CAAC,CAAC;UACzBwV,GAAG,CAACuV,SAAS,EAAE;QACnB,CAAC,MAAM;UACHvV,GAAG,CAACwV,GAAG,CAACnrB,CAAC,EAAEG,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE4K,IAAI,CAACqgB,EAAE,GAAG,CAAC,CAAC;QACpC;QACAzV,GAAG,CAACoV,IAAI,EAAE;MACd;MAEA,IAAI2E,WAAW,EAAE;QACb,IAAI1vB,CAAC,GAAGvL,IAAI,CAACoZ,gBAAgB;QAC7B,IAAI1N,CAAC,GAAG9V,SAAS,CAACG,iBAAiB,GAAG,CAAC,GAAG,CAAC,CAAC;QAC5C,IAAIkmB,UAAU,EAAE;UACZ1Q,CAAC,GAAGvL,IAAI,CAACoZ,gBAAgB,GAAG,GAAG;UAC/B1N,CAAC,GAAG,CAAC;QACT;QACAwV,GAAG,CAAC0V,SAAS,GAAG,MAAM;QACtB1V,GAAG,CAAC2V,WAAW,GAAG,OAAO;QACzB3V,GAAG,CAACoU,SAAS,EAAE;QACf,IACItoB,IAAI,CAAClR,IAAI,KAAKlG,SAAS,CAACyC,KAAK,IAC7B2U,IAAI,CAACkH,KAAK,KAAKte,SAAS,CAACiC,SAAS,EACpC;UACEqpB,GAAG,CAACzB,IAAI,CAAClU,CAAC,GAAG,CAAC,GAAG,GAAG,EAAEG,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;QACvC,CAAC,MAAM,IAAIsB,IAAI,CAACkH,KAAK,KAAKte,SAAS,CAACqC,WAAW,EAAE;UAC7CipB,GAAG,CAACqV,MAAM,CAAChrB,CAAC,GAAG,CAAC,EAAEG,CAAC,CAAC;UACpBwV,GAAG,CAACsV,MAAM,CAACjrB,CAAC,GAAG,CAAC,EAAEG,CAAC,GAAG,CAAC,CAAC;UACxBwV,GAAG,CAACsV,MAAM,CAACjrB,CAAC,GAAG,CAAC,EAAEG,CAAC,GAAG,CAAC,CAAC;UACxBwV,GAAG,CAACuV,SAAS,EAAE;QACnB,CAAC,MAAM;UACHvV,GAAG,CAACwV,GAAG,CAACnrB,CAAC,EAAEG,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE4K,IAAI,CAACqgB,EAAE,GAAG,CAAC,CAAC;QACpC;QACAzV,GAAG,CAACoV,IAAI,EAAE;QACV;MACJ;IACJ;;IAEA,IAAIt2B,IAAI,CAACm6B,SAAS,EAAE;MAChBjZ,GAAG,CAACgU,OAAO,EAAE;IACjB;IAEAhU,GAAG,CAACoW,WAAW,GAAG,GAAG;EACzB,CAAC;;EAEJ;EACAhwB,YAAY,CAACnT,SAAS,CAAC4iC,eAAe,GAAG,UAAU7V,GAAG,EAAErX,IAAI,EAC5D;IACC,IAAIxN,GAAG,GAAGwN,IAAI,CAACuJ,IAAI;IACnB8N,GAAG,CAAC0V,SAAS,GAAG,OAAO;IACvB1V,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACwV,GAAG,CAAEr6B,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAEia,IAAI,CAACqgB,EAAE,GAAG,CAAC,CAAE;IAC5CzV,GAAG,CAACoV,IAAI,EAAE;IAEV,IAAGzsB,IAAI,CAAC/G,IAAI,IAAI,IAAI,EACnB;IAED,IAAG,IAAI,CAACmiB,iBAAiB,EACxB,IAAI,IAAI,CAACA,iBAAiB,CAAC/D,GAAG,EAACrX,IAAI,EAAC,IAAI,CAAC,IAAI,IAAI,EAChD;IAEF,IAAI/G,IAAI,GAAG+G,IAAI,CAAC/G,IAAI;IACpB,IAAIW,IAAI,GAAG,IAAI;IAEf,IAAIX,IAAI,CAACtF,WAAW,KAAKwd,MAAM,EAC9BvX,IAAI,GAAGX,IAAI,CAAC81B,OAAO,CAAC,CAAC,CAAC,CAAC,KACnB,IAAI91B,IAAI,CAACtF,WAAW,KAAKC,MAAM,EACnCgG,IAAI,GAAG,IAAI,GAAGX,IAAI,GAAG,IAAI,CAAC,KACtB,IAAIA,IAAI,CAACtF,WAAW,KAAK09B,OAAO,EACpCz3B,IAAI,GAAGhG,MAAM,CAACqF,IAAI,CAAC,CAAC,KAChB,IAAIA,IAAI,CAACq4B,SAAS,EACtB13B,IAAI,GAAGX,IAAI,CAACq4B,SAAS,EAAE,CAAC,KAExB13B,IAAI,GAAG,GAAG,GAAGX,IAAI,CAACtF,WAAW,CAACnI,IAAI,GAAG,GAAG;IAEzC,IAAGoO,IAAI,IAAI,IAAI,EACd;IACDA,IAAI,GAAGA,IAAI,CAACjH,MAAM,CAAC,CAAC,EAAC,EAAE,CAAC,CAAC,CAAC;;IAE1B0kB,GAAG,CAACtD,IAAI,GAAG,kBAAkB;IAC7B,IAAIpN,IAAI,GAAG0Q,GAAG,CAAC+W,WAAW,CAACx0B,IAAI,CAAC;IAChC,IAAImQ,CAAC,GAAGpD,IAAI,CAAC2O,KAAK,GAAG,EAAE;IACvB,IAAImR,CAAC,GAAG,EAAE;IACVpP,GAAG,CAACuY,WAAW,GAAG,OAAO;IACzBvY,GAAG,CAACwY,aAAa,GAAG,CAAC;IACrBxY,GAAG,CAACyY,aAAa,GAAG,CAAC;IACrBzY,GAAG,CAAC0Y,UAAU,GAAG,CAAC;IAClB1Y,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACqW,SAAS,CAAEl7B,GAAG,CAAC,CAAC,CAAC,GAAGuX,CAAC,GAAC,GAAG,EAAEvX,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAGi0B,CAAC,EAAE1c,CAAC,EAAE0c,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAC1DpP,GAAG,CAACqV,MAAM,CAAEl6B,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,CAAE;IACtC6kB,GAAG,CAACsV,MAAM,CAAEn6B,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,CAAE;IACtC6kB,GAAG,CAACsV,MAAM,CAAEn6B,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAE;IAChC6kB,GAAG,CAACoV,IAAI,EAAE;IACJpV,GAAG,CAACuY,WAAW,GAAG,aAAa;IACrCvY,GAAG,CAACsW,SAAS,GAAG,QAAQ;IACxBtW,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACuW,QAAQ,CAACh0B,IAAI,EAAEpH,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAGi0B,CAAC,GAAG,GAAG,CAAC;EAClD,CAAC;;EAEE;AACJ;AACA;AACA;EACI,IAAI8K,QAAQ,GAAG,IAAI/nB,YAAY,CAAC,CAAC,CAAC;EAElC/L,YAAY,CAACnT,SAAS,CAACimC,aAAa,GAAG,UACnCp6B,IAAI,EACJkhB,GAAG,EACH7gB,IAAI,EACJg7B,OAAO,EACPrnB,OAAO,EACPsnB,QAAQ,EACRC,UAAU,EACZ;IACE;IACAra,GAAG,CAAC2V,WAAW,GAAGwE,OAAO;IACzBna,GAAG,CAAC0V,SAAS,GAAG5iB,OAAO;IAEvB,IAAImd,YAAY,GAAGv7B,SAAS,CAACG,iBAAiB;IAC9C,IAAIikC,WAAW,GAAG,IAAI,CAAChY,EAAE,CAAC5E,KAAK,GAAG,GAAG;;IAErC;IACA,IAAIlJ,KAAK,GACLlU,IAAI,CAAChD,MAAM,IAAIgD,IAAI,CAACxC,WAAW,CAAC0W,KAAK,IAAIte,SAAS,CAACkC,WAAW;IAElE,IAAI0jC,UAAU,GAAGx7B,IAAI,CAACxC,WAAW,CAACg+B,UAAU;IAE5C,IAAIC,YAAY,GAAG,IAAI;IACvB,IAAID,UAAU,IAAI5lC,SAAS,CAAC4D,iBAAiB,IAAIgiC,UAAU,IAAI5lC,SAAS,CAAC2D,QAAQ,EAAE;MAC/EkiC,YAAY,GAAG,KAAK;IACxB,CAAC,MAAM,IAAID,UAAU,IAAI5lC,SAAS,CAAC6D,cAAc,IAAI8hC,UAAU,EAAE;MAC7DE,YAAY,GAAG,IAAI;IACvB;IAEA,IAAIrG,IAAI,GAAGgG,QAAQ;IACnBhG,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;IACbA,IAAI,CAAC,CAAC,CAAC,GAAGqG,YAAY,GAAG,CAACtK,YAAY,GAAG,CAAC,CAAC,CAAC;IAC5CiE,IAAI,CAAC,CAAC,CAAC,GAAG/0B,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;IACvB+0B,IAAI,CAAC,CAAC,CAAC,GAAGqG,YAAY,GAAGp7B,IAAI,CAAC,CAAC,CAAC,GAAG8wB,YAAY,GAAG9wB,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;;IAE3D,IAAIq7B,SAAS,GAAGxa,GAAG,CAACoW,WAAW;;IAE/B;IACA;IACA;MACIpW,GAAG,CAACoU,SAAS,EAAE;MACf,IAAIphB,KAAK,IAAIte,SAAS,CAACiC,SAAS,IAAImiC,WAAW,EAAE;QAC7C9Y,GAAG,CAACoY,QAAQ,CAAClE,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,CAAC;MACpD,CAAC,MAAM,IACHlhB,KAAK,IAAIte,SAAS,CAACkC,WAAW,IAC9Boc,KAAK,IAAIte,SAAS,CAACoC,UAAU,EAC/B;QACEkpB,GAAG,CAACqW,SAAS,CACTnC,IAAI,CAAC,CAAC,CAAC,EACPA,IAAI,CAAC,CAAC,CAAC,EACPA,IAAI,CAAC,CAAC,CAAC,EACPA,IAAI,CAAC,CAAC,CAAC,EACPlhB,KAAK,IAAIte,SAAS,CAACoC,UAAU,GAAG,CAAC,IAAI,CAACstB,YAAY,EAAC,IAAI,CAACA,YAAY,EAAC,CAAC,EAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAACA,YAAY,CAAC,CAClG;MACL,CAAC,MAAM,IAAIpR,KAAK,IAAIte,SAAS,CAACmC,YAAY,EAAE;QACxCmpB,GAAG,CAACwV,GAAG,CACHr2B,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EACbA,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EACbA,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EACb,CAAC,EACDiW,IAAI,CAACqgB,EAAE,GAAG,CAAC,CACd;MACL;MACAzV,GAAG,CAACoV,IAAI,EAAE;;MAEnB;MACA,IAAG,CAACt2B,IAAI,CAACI,KAAK,CAAC2Y,SAAS,IAAI0iB,YAAY,EACxC;QACCva,GAAG,CAACuY,WAAW,GAAG,aAAa;QAC/BvY,GAAG,CAAC0V,SAAS,GAAG,iBAAiB;QACjC1V,GAAG,CAACoY,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,EAAElE,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;MAChC;IACK;IACAlU,GAAG,CAACuY,WAAW,GAAG,aAAa;IAE/B,IAAIz5B,IAAI,CAAC8kB,gBAAgB,EAAE;MACvB9kB,IAAI,CAAC8kB,gBAAgB,CAAC5D,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC/T,MAAM,EAAE,IAAI,CAACuX,WAAW,CAAE;IACpE;;IAEA;IACA,IAAI+W,YAAY,IAAID,UAAU,IAAI5lC,SAAS,CAAC4D,iBAAiB,EAAE;MAC3D;MACA,IAAIwG,IAAI,CAAC27B,cAAc,EAAE;QACrB37B,IAAI,CAAC27B,cAAc,CAAEza,GAAG,EAAEiQ,YAAY,EAAE9wB,IAAI,EAAE,IAAI,CAAC2hB,EAAE,CAAC5E,KAAK,EAAEie,OAAO,CAAE;MAC1E,CAAC,MAAM,IACHG,UAAU,IAAI5lC,SAAS,CAAC4D,iBAAiB,KACxCwG,IAAI,CAACxC,WAAW,CAACo+B,WAAW,IAAI,IAAI,CAACtX,oBAAoB,CAAC,EAC7D;QACE,IAAIsX,WAAW,GAAG57B,IAAI,CAACxC,WAAW,CAACo+B,WAAW,IAAIP,OAAO;QAEzD,IAAIr7B,IAAI,CAACI,KAAK,CAAC2Y,SAAS,EAAE;UACtBmI,GAAG,CAACuY,WAAW,GAAG7jC,SAAS,CAACqB,oBAAoB;QACpD;;QAEA;QACA,IAAI,IAAI,CAAC6rB,aAAa,EAAE;UACpB,IAAI+Y,IAAI,GAAGv0B,YAAY,CAAC4e,SAAS,CAAC0V,WAAW,CAAC;UAC9C,IAAI,CAACC,IAAI,EAAE;YACPA,IAAI,GAAGv0B,YAAY,CAAC4e,SAAS,CAAE0V,WAAW,CAAE,GAAG1a,GAAG,CAAC4a,oBAAoB,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC;YACrFD,IAAI,CAACE,YAAY,CAAC,CAAC,EAAEH,WAAW,CAAC,CAAC,CAAC;YACnCC,IAAI,CAACE,YAAY,CAAC,CAAC,EAAE,MAAM,CAAC;UAChC;UACA7a,GAAG,CAAC0V,SAAS,GAAGiF,IAAI;QACxB,CAAC,MAAM;UACH3a,GAAG,CAAC0V,SAAS,GAAGgF,WAAW;QAC/B;;QAEA;QACA1a,GAAG,CAACoU,SAAS,EAAE;QACf,IAAIphB,KAAK,IAAIte,SAAS,CAACiC,SAAS,IAAImiC,WAAW,EAAE;UAC7C9Y,GAAG,CAACzB,IAAI,CAAC,CAAC,EAAE,CAAC0R,YAAY,EAAE9wB,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE8wB,YAAY,CAAC;QACzD,CAAC,MAAM,IAAMjd,KAAK,IAAIte,SAAS,CAACkC,WAAW,IAAIoc,KAAK,IAAIte,SAAS,CAACoC,UAAU,EAAG;UAC3EkpB,GAAG,CAACqW,SAAS,CACT,CAAC,EACD,CAACpG,YAAY,EACb9wB,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EACX8wB,YAAY,EACZnxB,IAAI,CAACI,KAAK,CAAC2Y,SAAS,GAAG,CAAC,IAAI,CAACuM,YAAY,CAAC,GAAG,CAAC,IAAI,CAACA,YAAY,EAAC,IAAI,CAACA,YAAY,EAAC,CAAC,EAAC,CAAC,CAAC,CACzF;QACL;QACApE,GAAG,CAACoV,IAAI,EAAE;QACVpV,GAAG,CAACuY,WAAW,GAAG,aAAa;MACnC;MAEA,IAAIuC,QAAQ,GAAG,KAAK;MACpB,IAAIpmC,SAAS,CAAC4E,yBAAyB,EAAC;QACpC,IAAG5E,SAAS,CAAC4C,iBAAiB,CAACwH,IAAI,CAACO,IAAI,CAAC,EAAC;UACtCy7B,QAAQ,GAAGpmC,SAAS,CAAC4C,iBAAiB,CAACwH,IAAI,CAACO,IAAI,CAAC;QACrD;MACJ;MACA,IAAI3K,SAAS,CAAC2E,yBAAyB,EAAC;QACpCyhC,QAAQ,GAAGh8B,IAAI,CAAC2W,gBAAgB,GAAG,MAAM,GAAI3W,IAAI,CAAC0W,iBAAiB,GAAG,MAAM,GAAGslB,QAAS;MAC5F;;MAEA;MACA,IAAIC,QAAQ,GAAG,EAAE;MACjB,IAAIj8B,IAAI,CAACk8B,cAAc,EAAE;QACrBl8B,IAAI,CAACk8B,cAAc,CAAChb,GAAG,EAAEiQ,YAAY,EAAE9wB,IAAI,EAAE,IAAI,CAAC2hB,EAAE,CAAC5E,KAAK,CAAC;MAC/D,CAAC,MAAM,IACHlJ,KAAK,IAAIte,SAAS,CAACkC,WAAW,IAC9Boc,KAAK,IAAIte,SAAS,CAACmC,YAAY,IAC/Bmc,KAAK,IAAIte,SAAS,CAACoC,UAAU,EAC/B;QACE,IAAIgiC,WAAW,EAAE;UACb9Y,GAAG,CAAC0V,SAAS,GAAG,OAAO;UACvB1V,GAAG,CAACoU,SAAS,EAAE;UACfpU,GAAG,CAACwV,GAAG,CACHvF,YAAY,GAAG,GAAG,EAClBA,YAAY,GAAG,CAAC,GAAG,EACnB8K,QAAQ,GAAG,GAAG,GAAG,CAAC,EAClB,CAAC,EACD3lB,IAAI,CAACqgB,EAAE,GAAG,CAAC,CACd;UACDzV,GAAG,CAACoV,IAAI,EAAE;QACd;QAEApV,GAAG,CAAC0V,SAAS,GAAG52B,IAAI,CAACiU,QAAQ,IAAI+nB,QAAQ,IAAIpmC,SAAS,CAACkB,qBAAqB;QACxF,IAAGkjC,WAAW,EACb9Y,GAAG,CAACoY,QAAQ,CAAEnI,YAAY,GAAG,GAAG,GAAG8K,QAAQ,GAAE,GAAG,EAAE9K,YAAY,GAAG,CAAC,GAAG,GAAG8K,QAAQ,GAAE,GAAG,EAAEA,QAAQ,EAAGA,QAAQ,CAAG,CAAC,KAE/G;UACC/a,GAAG,CAACoU,SAAS,EAAE;UACfpU,GAAG,CAACwV,GAAG,CACNvF,YAAY,GAAG,GAAG,EAClBA,YAAY,GAAG,CAAC,GAAG,EACnB8K,QAAQ,GAAG,GAAG,EACd,CAAC,EACD3lB,IAAI,CAACqgB,EAAE,GAAG,CAAC,CACX;UACDzV,GAAG,CAACoV,IAAI,EAAE;QACX;MACQ,CAAC,MAAM;QACH,IAAI0D,WAAW,EAAE;UACb9Y,GAAG,CAAC0V,SAAS,GAAG,OAAO;UACvB1V,GAAG,CAACoY,QAAQ,CACR,CAACnI,YAAY,GAAG8K,QAAQ,IAAI,GAAG,GAAG,CAAC,EACnC,CAAC9K,YAAY,GAAG8K,QAAQ,IAAI,CAAC,GAAG,GAAG,CAAC,EACpCA,QAAQ,GAAG,CAAC,EACZA,QAAQ,GAAG,CAAC,CACf;QACL;QACA/a,GAAG,CAAC0V,SAAS,GAAG52B,IAAI,CAACiU,QAAQ,IAAI+nB,QAAQ,IAAIpmC,SAAS,CAACkB,qBAAqB;QAC5EoqB,GAAG,CAACoY,QAAQ,CACR,CAACnI,YAAY,GAAG8K,QAAQ,IAAI,GAAG,EAC/B,CAAC9K,YAAY,GAAG8K,QAAQ,IAAI,CAAC,GAAG,EAChCA,QAAQ,EACRA,QAAQ,CACX;MACL;MACA/a,GAAG,CAACoW,WAAW,GAAGoE,SAAS;;MAE3B;MACA,IAAI17B,IAAI,CAACm8B,eAAe,EAAE;QACtBn8B,IAAI,CAACm8B,eAAe,CAChBjb,GAAG,EACHiQ,YAAY,EACZ9wB,IAAI,EACJ,IAAI,CAAC2hB,EAAE,CAAC5E,KAAK,EACb,IAAI,CAAC8E,eAAe,EACpBoZ,QAAQ,CACX;MACL;MACA,IAAI,CAACtB,WAAW,EAAE;QACd9Y,GAAG,CAACtD,IAAI,GAAG,IAAI,CAACsE,eAAe;QAC/B,IAAI7tB,KAAK,GAAGoJ,MAAM,CAACuC,IAAI,CAACqU,QAAQ,EAAE,CAAC;QACnC,IAAIhgB,KAAK,EAAE;UACP,IAAIinC,QAAQ,EAAE;YACVpa,GAAG,CAAC0V,SAAS,GAAGhhC,SAAS,CAACY,yBAAyB;UACvD,CAAC,MAAM;YACH0qB,GAAG,CAAC0V,SAAS,GACT52B,IAAI,CAACxC,WAAW,CAAC4+B,gBAAgB,IACjC,IAAI,CAACha,gBAAgB;UAC7B;UACA,IAAIpiB,IAAI,CAACI,KAAK,CAAC2Y,SAAS,EAAE;YACtBmI,GAAG,CAACsW,SAAS,GAAG,MAAM;YACtB,IAAI6E,OAAO,GAAGnb,GAAG,CAAC+W,WAAW,CAAC5jC,KAAK,CAAC;YACpC6sB,GAAG,CAACuW,QAAQ,CACRpjC,KAAK,CAACmI,MAAM,CAAC,CAAC,EAAC,EAAE,CAAC;YAAE;YACpB20B,YAAY;YAAC;YACbv7B,SAAS,CAACI,iBAAiB,GAAGm7B,YAAY,CAC7C;YACDjQ,GAAG,CAACsW,SAAS,GAAG,MAAM;UAC1B,CAAC,MAAM;YACHtW,GAAG,CAACsW,SAAS,GAAG,MAAM;YACtBtW,GAAG,CAACuW,QAAQ,CACRpjC,KAAK,EACL88B,YAAY,EACZv7B,SAAS,CAACI,iBAAiB,GAAGm7B,YAAY,CAC7C;UACL;QACJ;MACJ;;MAET;MACA,IAAI,CAACnxB,IAAI,CAACI,KAAK,CAAC2Y,SAAS,IAAI/Y,IAAI,CAACwtB,QAAQ,IAAI,CAACxtB,IAAI,CAACytB,oBAAoB,EAAE;QACzE,IAAI7Z,CAAC,GAAGhe,SAAS,CAACG,iBAAiB;QACnC,IAAIwV,CAAC,GAAGvL,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,GAAGuT,CAAC;QACxB,IAAI0oB,IAAI,GAAG1mC,SAAS,CAACujB,iBAAiB,CAAE,IAAI,CAACuL,WAAW,CAAC,CAAC,CAAC,GAAG1kB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,EAAE,IAAI,CAACqoB,WAAW,CAAC,CAAC,CAAC,GAAG1kB,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,EAAEkP,CAAC,GAAC,CAAC,EAAE,CAACqI,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAC,CAAC,CAAE;QACnIsN,GAAG,CAAC0V,SAAS,GAAG0F,IAAI,GAAG,MAAM,GAAG,MAAM;QACtC,IAAIpoB,KAAK,IAAIte,SAAS,CAACiC,SAAS,IAAImiC,WAAW,EAC9C9Y,GAAG,CAACoY,QAAQ,CAAC/tB,CAAC,GAAC,CAAC,EAAE,CAACqI,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAC,CAAC,CAAC,CAAC,KAEnC;UACCsN,GAAG,CAACoU,SAAS,EAAE;UACfpU,GAAG,CAACqW,SAAS,CAAChsB,CAAC,GAAC,CAAC,EAAE,CAACqI,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAC,CAAC,EAAC,CAAC,CAAC,CAAC,CAAC;UACtCsN,GAAG,CAACoV,IAAI,EAAE;QACX;QACApV,GAAG,CAAC0V,SAAS,GAAG,MAAM;QACtB1V,GAAG,CAACoU,SAAS,EAAE;QACfpU,GAAG,CAACqV,MAAM,CAAChrB,CAAC,GAAGqI,CAAC,GAAG,GAAG,EAAE,CAACA,CAAC,GAAG,GAAG,CAAC;QACjCsN,GAAG,CAACsV,MAAM,CAACjrB,CAAC,GAAGqI,CAAC,GAAG,GAAG,EAAE,CAACA,CAAC,GAAG,GAAG,CAAC;QACjCsN,GAAG,CAACsV,MAAM,CAACjrB,CAAC,GAAGqI,CAAC,GAAG,GAAG,EAAE,CAACA,CAAC,GAAG,GAAG,CAAC;QACjCsN,GAAG,CAACoV,IAAI,EAAE;MACX;;MAEA;MACS,IAAIt2B,IAAI,CAACu8B,WAAW,EAAE;QAClBv8B,IAAI,CAACu8B,WAAW,CAACrb,GAAG,CAAC;MACzB;IACJ;;IAEA;IACA,IAAIoa,QAAQ,EAAE;MACV,IAAIt7B,IAAI,CAACgZ,UAAU,EAAE;QACjBhZ,IAAI,CAACgZ,UAAU,CAACoc,IAAI,CAAC;MACzB;MAEA,IAAIoG,UAAU,IAAI5lC,SAAS,CAAC4D,iBAAiB,EAAE;QAC3C47B,IAAI,CAAC,CAAC,CAAC,IAAIjE,YAAY;QACvBiE,IAAI,CAAC,CAAC,CAAC,IAAIjE,YAAY;MAC3B;MACAjQ,GAAG,CAAC+U,SAAS,GAAG,CAAC;MACjB/U,GAAG,CAACoW,WAAW,GAAG,GAAG;MACrBpW,GAAG,CAACoU,SAAS,EAAE;MACf,IAAIphB,KAAK,IAAIte,SAAS,CAACiC,SAAS,EAAE;QAC9BqpB,GAAG,CAACzB,IAAI,CACJ,CAAC,CAAC,GAAG2V,IAAI,CAAC,CAAC,CAAC,EACZ,CAAC,CAAC,GAAGA,IAAI,CAAC,CAAC,CAAC,EACZ,EAAE,GAAGA,IAAI,CAAC,CAAC,CAAC,EACZ,EAAE,GAAGA,IAAI,CAAC,CAAC,CAAC,CACf;MACL,CAAC,MAAM,IACHlhB,KAAK,IAAIte,SAAS,CAACkC,WAAW,IAC7Boc,KAAK,IAAIte,SAAS,CAACoC,UAAU,IAAIgI,IAAI,CAACI,KAAK,CAAC2Y,SAAU,EACzD;QACEmI,GAAG,CAACqW,SAAS,CACT,CAAC,CAAC,GAAGnC,IAAI,CAAC,CAAC,CAAC,EACZ,CAAC,CAAC,GAAGA,IAAI,CAAC,CAAC,CAAC,EACZ,EAAE,GAAGA,IAAI,CAAC,CAAC,CAAC,EACZ,EAAE,GAAGA,IAAI,CAAC,CAAC,CAAC,EACZ,CAAC,IAAI,CAAC9P,YAAY,GAAG,CAAC,CAAC,CAC1B;MACL,CAAC,MAAM,IAAIpR,KAAK,IAAIte,SAAS,CAACoC,UAAU,EAAE;QACtCkpB,GAAG,CAACqW,SAAS,CACT,CAAC,CAAC,GAAGnC,IAAI,CAAC,CAAC,CAAC,EACZ,CAAC,CAAC,GAAGA,IAAI,CAAC,CAAC,CAAC,EACZ,EAAE,GAAGA,IAAI,CAAC,CAAC,CAAC,EACZ,EAAE,GAAGA,IAAI,CAAC,CAAC,CAAC,EACZ,CAAC,IAAI,CAAC9P,YAAY,GAAG,CAAC,EAAC,CAAC,EAAC,IAAI,CAACA,YAAY,GAAG,CAAC,EAAC,CAAC,CAAC,CACpD;MACL,CAAC,MAAM,IAAIpR,KAAK,IAAIte,SAAS,CAACmC,YAAY,EAAE;QACxCmpB,GAAG,CAACwV,GAAG,CACHr2B,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EACbA,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EACbA,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,CAAC,EACjB,CAAC,EACDiW,IAAI,CAACqgB,EAAE,GAAG,CAAC,CACd;MACL;MACAzV,GAAG,CAAC2V,WAAW,GAAGjhC,SAAS,CAACoB,sBAAsB;MAClDkqB,GAAG,CAAC2Z,MAAM,EAAE;MACZ3Z,GAAG,CAAC2V,WAAW,GAAGwE,OAAO;MACzBna,GAAG,CAACoW,WAAW,GAAG,CAAC;IACvB;;IAEA;IACA,IAAIt3B,IAAI,CAAC0W,iBAAiB,GAAC,CAAC,EAAE1W,IAAI,CAAC0W,iBAAiB,EAAE;IACtD,IAAI1W,IAAI,CAAC2W,gBAAgB,GAAC,CAAC,EAAE3W,IAAI,CAAC2W,gBAAgB,EAAE;EACxD,CAAC;EAED,IAAI6lB,WAAW,GAAG,IAAInpB,YAAY,CAAC,CAAC,CAAC;EACrC,IAAIopB,aAAa,GAAG,IAAIppB,YAAY,CAAC,CAAC,CAAC;EACvC,IAAIqpB,KAAK,GAAG,IAAIrpB,YAAY,CAAC,CAAC,CAAC;EAC/B,IAAIspB,KAAK,GAAG,IAAItpB,YAAY,CAAC,CAAC,CAAC;;EAE/B;AACJ;AACA;AACA;AACA;EACI/L,YAAY,CAACnT,SAAS,CAAC6hC,eAAe,GAAG,UAAS9U,GAAG,EAAE;IACnD,IAAI3c,GAAG,GAAG3O,SAAS,CAAC0O,OAAO,EAAE;IAC7B,IAAIsa,YAAY,GAAG,IAAI,CAACA,YAAY;IACpC4d,WAAW,CAAC,CAAC,CAAC,GAAG5d,YAAY,CAAC,CAAC,CAAC,GAAG,EAAE;IACrC4d,WAAW,CAAC,CAAC,CAAC,GAAG5d,YAAY,CAAC,CAAC,CAAC,GAAG,EAAE;IACrC4d,WAAW,CAAC,CAAC,CAAC,GAAG5d,YAAY,CAAC,CAAC,CAAC,GAAG,EAAE;IACrC4d,WAAW,CAAC,CAAC,CAAC,GAAG5d,YAAY,CAAC,CAAC,CAAC,GAAG,EAAE;;IAErC;IACAsC,GAAG,CAAC+U,SAAS,GAAG,IAAI,CAAC5Q,iBAAiB;IAEtCnE,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAAC2V,WAAW,GAAG,MAAM;IACxB3V,GAAG,CAACoW,WAAW,GAAG,IAAI,CAACvU,YAAY;IACnC;IACA,IAAIzkB,KAAK,GAAG,IAAI,CAACiJ,KAAK,CAAC7B,MAAM;IAC7B,KAAK,IAAIsI,CAAC,GAAG,CAAC,EAAEtE,CAAC,GAAGpL,KAAK,CAACjL,MAAM,EAAE2a,CAAC,GAAGtE,CAAC,EAAE,EAAEsE,CAAC,EAAE;MAC1C,IAAIhO,IAAI,GAAG1B,KAAK,CAAC0P,CAAC,CAAC;MACnB;MACA,IAAI,CAAChO,IAAI,CAACgH,MAAM,IAAI,CAAChH,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAE;QACrC;MACJ;MAEA,KAAK,IAAIU,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAE,EAAEU,CAAC,EAAE;QACzC,IAAIiX,KAAK,GAAGhL,IAAI,CAACgH,MAAM,CAACjT,CAAC,CAAC;QAC1B,IAAI,CAACiX,KAAK,IAAIA,KAAK,CAACnB,IAAI,IAAI,IAAI,EAAE;UAC9B;QACJ;QACA,IAAII,OAAO,GAAGe,KAAK,CAACnB,IAAI;QACxB,IAAIA,IAAI,GAAG,IAAI,CAACtC,KAAK,CAACvB,KAAK,CAACiE,OAAO,CAAC;QACpC,IAAI,CAACJ,IAAI,EAAE;UACP;QACJ;;QAEA;QACA,IAAI+yB,UAAU,GAAG,IAAI,CAACr1B,KAAK,CAAC4C,WAAW,CAACN,IAAI,CAACoJ,SAAS,CAAC;QACvD,IAAI2pB,UAAU,IAAI,IAAI,EAAE;UACpB;QACJ;QACA,IAAIC,eAAe,GAAGhzB,IAAI,CAACqJ,WAAW;QACtC,IAAI4pB,kBAAkB,GAAG,IAAI;QAC7B,IAAID,eAAe,IAAI,CAAC,CAAC,EAAE;UACvBC,kBAAkB,GAAG,CACjBF,UAAU,CAACvgC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,EACtBugC,UAAU,CAACvgC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,CACzB;QACL,CAAC,MAAM;UACHygC,kBAAkB,GAAGF,UAAU,CAACrjB,gBAAgB,CAC5C,KAAK,EACLsjB,eAAe,EACfH,KAAK,CACR;QACL;QACA,IAAIK,gBAAgB,GAAG/8B,IAAI,CAACuZ,gBAAgB,CAAC,IAAI,EAAExlB,CAAC,EAAE4oC,KAAK,CAAC;;QAE5D;QACAF,aAAa,CAAC,CAAC,CAAC,GAAGK,kBAAkB,CAAC,CAAC,CAAC;QACxCL,aAAa,CAAC,CAAC,CAAC,GAAGK,kBAAkB,CAAC,CAAC,CAAC;QACxCL,aAAa,CAAC,CAAC,CAAC,GAAGM,gBAAgB,CAAC,CAAC,CAAC,GAAGD,kBAAkB,CAAC,CAAC,CAAC;QAC9DL,aAAa,CAAC,CAAC,CAAC,GAAGM,gBAAgB,CAAC,CAAC,CAAC,GAAGD,kBAAkB,CAAC,CAAC,CAAC;QAC9D,IAAIL,aAAa,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;UACtBA,aAAa,CAAC,CAAC,CAAC,IAAIA,aAAa,CAAC,CAAC,CAAC;UACpCA,aAAa,CAAC,CAAC,CAAC,GAAGnmB,IAAI,CAACmL,GAAG,CAACgb,aAAa,CAAC,CAAC,CAAC,CAAC;QACjD;QACA,IAAIA,aAAa,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;UACtBA,aAAa,CAAC,CAAC,CAAC,IAAIA,aAAa,CAAC,CAAC,CAAC;UACpCA,aAAa,CAAC,CAAC,CAAC,GAAGnmB,IAAI,CAACmL,GAAG,CAACgb,aAAa,CAAC,CAAC,CAAC,CAAC;QACjD;;QAEA;QACA,IAAI,CAACte,eAAe,CAACse,aAAa,EAAED,WAAW,CAAC,EAAE;UAC9C;QACJ;QAEA,IAAIQ,UAAU,GAAGJ,UAAU,CAAC31B,OAAO,CAAC41B,eAAe,CAAC;QACpD,IAAII,QAAQ,GAAGj9B,IAAI,CAACgH,MAAM,CAACjT,CAAC,CAAC;QAC7B,IAAI,CAACipC,UAAU,IAAI,CAACC,QAAQ,EAAE;UAC1B;QACJ;QACA,IAAIC,SAAS,GACTF,UAAU,CAACvnC,GAAG,KACbmnC,UAAU,CAAC3gB,UAAU,GAAGrmB,SAAS,CAACkD,IAAI,GAAGlD,SAAS,CAACoD,KAAK,CAAC;QAC9D,IAAImkC,OAAO,GACPF,QAAQ,CAACxnC,GAAG,KACXuK,IAAI,CAACic,UAAU,GAAGrmB,SAAS,CAACiD,EAAE,GAAGjD,SAAS,CAACmD,IAAI,CAAC;QAErD,IAAI,CAACs9B,UAAU,CACXnV,GAAG,EACH4b,kBAAkB,EAClBC,gBAAgB,EAChBlzB,IAAI,EACJ,KAAK,EACL,CAAC,EACD,IAAI,EACJqzB,SAAS,EACTC,OAAO,CACV;;QAED;QACA,IAAItzB,IAAI,IAAIA,IAAI,CAACoH,UAAU,IAAI1M,GAAG,GAAGsF,IAAI,CAACoH,UAAU,GAAG,IAAI,EAAE;UACzD,IAAImsB,CAAC,GAAG,GAAG,GAAG,CAAC74B,GAAG,GAAGsF,IAAI,CAACoH,UAAU,IAAI,KAAK;UAC7C,IAAI7P,GAAG,GAAG8f,GAAG,CAACoW,WAAW;UACzBpW,GAAG,CAACoW,WAAW,GAAGl2B,GAAG,GAAGg8B,CAAC;UACzB,IAAI,CAAC/G,UAAU,CACXnV,GAAG,EACH4b,kBAAkB,EAClBC,gBAAgB,EAChBlzB,IAAI,EACJ,IAAI,EACJuzB,CAAC,EACD,OAAO,EACPF,SAAS,EACTC,OAAO,CACV;UACDjc,GAAG,CAACoW,WAAW,GAAGl2B,GAAG;QACzB;MACJ;IACJ;IACA8f,GAAG,CAACoW,WAAW,GAAG,CAAC;EACvB,CAAC;;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIhwB,YAAY,CAACnT,SAAS,CAACkiC,UAAU,GAAG,UAChCnV,GAAG,EACHtgB,CAAC,EACDC,CAAC,EACDgJ,IAAI,EACJwzB,WAAW,EACXC,IAAI,EACJtqB,KAAK,EACLkqB,SAAS,EACTC,OAAO,EACPI,YAAY,EACd;IACE,IAAI1zB,IAAI,EAAE;MACN,IAAI,CAAC8b,aAAa,CAAC3xB,IAAI,CAAC6V,IAAI,CAAC;IACjC;;IAEA;IACA,IAAI,CAACmJ,KAAK,IAAInJ,IAAI,EAAE;MAChBmJ,KAAK,GAAGnJ,IAAI,CAACmJ,KAAK,IAAI1L,YAAY,CAAC0e,gBAAgB,CAACnc,IAAI,CAAC/N,IAAI,CAAC;IAClE;IACA,IAAI,CAACkX,KAAK,EAAE;MACRA,KAAK,GAAG,IAAI,CAACqP,kBAAkB;IACnC;IACA,IAAIxY,IAAI,IAAI,IAAI,IAAI,IAAI,CAAC8c,iBAAiB,CAAC9c,IAAI,CAACF,EAAE,CAAC,EAAE;MACjDqJ,KAAK,GAAG,MAAM;IAClB;IAEAkqB,SAAS,GAAGA,SAAS,IAAItnC,SAAS,CAACoD,KAAK;IACxCmkC,OAAO,GAAGA,OAAO,IAAIvnC,SAAS,CAACmD,IAAI;IAEnC,IAAI60B,IAAI,GAAGC,QAAQ,CAACjtB,CAAC,EAAEC,CAAC,CAAC;IAEzB,IAAI,IAAI,CAACojB,yBAAyB,IAAI,IAAI,CAACjC,EAAE,CAAC5E,KAAK,GAAG,GAAG,EAAE;MACvD8D,GAAG,CAAC+U,SAAS,GAAG,IAAI,CAAC5Q,iBAAiB,GAAG,CAAC;IAC9C;IACAnE,GAAG,CAACsc,QAAQ,GAAG,OAAO;IACtBD,YAAY,GAAGA,YAAY,IAAI,CAAC;IAChC,IAAIA,YAAY,GAAG,CAAC,EAAE;MAClBrc,GAAG,CAAC+U,SAAS,GAAG,GAAG;IACvB;;IAEA;IACA/U,GAAG,CAACoU,SAAS,EAAE;IACf,KAAK,IAAIvhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGwpC,YAAY,EAAExpC,CAAC,IAAI,CAAC,EAAE;MACtC,IAAI0pC,OAAO,GAAG,CAAC1pC,CAAC,GAAG,CAACwpC,YAAY,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC;MAEhD,IAAI,IAAI,CAAC/Y,iBAAiB,IAAI5uB,SAAS,CAACyD,WAAW,EAAE;QACjD6nB,GAAG,CAACqV,MAAM,CAAC31B,CAAC,CAAC,CAAC,CAAC,EAAEA,CAAC,CAAC,CAAC,CAAC,GAAG68B,OAAO,CAAC;QAChC,IAAIC,cAAc,GAAG,CAAC;QACtB,IAAIC,cAAc,GAAG,CAAC;QACtB,IAAIC,YAAY,GAAG,CAAC;QACpB,IAAIC,YAAY,GAAG,CAAC;QACpB,QAAQX,SAAS;UACb,KAAKtnC,SAAS,CAACmD,IAAI;YACf2kC,cAAc,GAAG9P,IAAI,GAAG,CAAC,IAAI;YAC7B;UACJ,KAAKh4B,SAAS,CAACoD,KAAK;YAChB0kC,cAAc,GAAG9P,IAAI,GAAG,IAAI;YAC5B;UACJ,KAAKh4B,SAAS,CAACiD,EAAE;YACb8kC,cAAc,GAAG/P,IAAI,GAAG,CAAC,IAAI;YAC7B;UACJ,KAAKh4B,SAAS,CAACkD,IAAI;YACf6kC,cAAc,GAAG/P,IAAI,GAAG,IAAI;YAC5B;QAAM;QAEd,QAAQuP,OAAO;UACX,KAAKvnC,SAAS,CAACmD,IAAI;YACf6kC,YAAY,GAAGhQ,IAAI,GAAG,CAAC,IAAI;YAC3B;UACJ,KAAKh4B,SAAS,CAACoD,KAAK;YAChB4kC,YAAY,GAAGhQ,IAAI,GAAG,IAAI;YAC1B;UACJ,KAAKh4B,SAAS,CAACiD,EAAE;YACbglC,YAAY,GAAGjQ,IAAI,GAAG,CAAC,IAAI;YAC3B;UACJ,KAAKh4B,SAAS,CAACkD,IAAI;YACf+kC,YAAY,GAAGjQ,IAAI,GAAG,IAAI;YAC1B;QAAM;QAEd1M,GAAG,CAAC4c,aAAa,CACbl9B,CAAC,CAAC,CAAC,CAAC,GAAG88B,cAAc,EACrB98B,CAAC,CAAC,CAAC,CAAC,GAAG+8B,cAAc,GAAGF,OAAO,EAC/B58B,CAAC,CAAC,CAAC,CAAC,GAAG+8B,YAAY,EACnB/8B,CAAC,CAAC,CAAC,CAAC,GAAGg9B,YAAY,GAAGJ,OAAO,EAC7B58B,CAAC,CAAC,CAAC,CAAC,EACJA,CAAC,CAAC,CAAC,CAAC,GAAG48B,OAAO,CACjB;MACL,CAAC,MAAM,IAAI,IAAI,CAACjZ,iBAAiB,IAAI5uB,SAAS,CAACwD,WAAW,EAAE;QACxD8nB,GAAG,CAACqV,MAAM,CAAC31B,CAAC,CAAC,CAAC,CAAC,EAAEA,CAAC,CAAC,CAAC,CAAC,GAAG68B,OAAO,CAAC;QAChC,IAAIC,cAAc,GAAG,CAAC;QACtB,IAAIC,cAAc,GAAG,CAAC;QACtB,IAAIC,YAAY,GAAG,CAAC;QACpB,IAAIC,YAAY,GAAG,CAAC;QACpB,QAAQX,SAAS;UACb,KAAKtnC,SAAS,CAACmD,IAAI;YACf2kC,cAAc,GAAG,CAAC,CAAC;YACnB;UACJ,KAAK9nC,SAAS,CAACoD,KAAK;YAChB0kC,cAAc,GAAG,CAAC;YAClB;UACJ,KAAK9nC,SAAS,CAACiD,EAAE;YACb8kC,cAAc,GAAG,CAAC,CAAC;YACnB;UACJ,KAAK/nC,SAAS,CAACkD,IAAI;YACf6kC,cAAc,GAAG,CAAC;YAClB;QAAM;QAEd,QAAQR,OAAO;UACX,KAAKvnC,SAAS,CAACmD,IAAI;YACf6kC,YAAY,GAAG,CAAC,CAAC;YACjB;UACJ,KAAKhoC,SAAS,CAACoD,KAAK;YAChB4kC,YAAY,GAAG,CAAC;YAChB;UACJ,KAAKhoC,SAAS,CAACiD,EAAE;YACbglC,YAAY,GAAG,CAAC,CAAC;YACjB;UACJ,KAAKjoC,SAAS,CAACkD,IAAI;YACf+kC,YAAY,GAAG,CAAC;YAChB;QAAM;QAEd,IAAIn0B,CAAC,GAAG,EAAE;QACVwX,GAAG,CAACsV,MAAM,CACN51B,CAAC,CAAC,CAAC,CAAC,GAAG88B,cAAc,GAAGh0B,CAAC,EACzB9I,CAAC,CAAC,CAAC,CAAC,GAAG+8B,cAAc,GAAGj0B,CAAC,GAAG+zB,OAAO,CACtC;QACDvc,GAAG,CAACsV,MAAM,CACN31B,CAAC,CAAC,CAAC,CAAC,GAAG+8B,YAAY,GAAGl0B,CAAC,EACvB7I,CAAC,CAAC,CAAC,CAAC,GAAGg9B,YAAY,GAAGn0B,CAAC,GAAG+zB,OAAO,CACpC;QACDvc,GAAG,CAACsV,MAAM,CAAC31B,CAAC,CAAC,CAAC,CAAC,EAAEA,CAAC,CAAC,CAAC,CAAC,GAAG48B,OAAO,CAAC;MACpC,CAAC,MAAM,IAAI,IAAI,CAACjZ,iBAAiB,IAAI5uB,SAAS,CAACuD,aAAa,EAAE;QAC1D+nB,GAAG,CAACqV,MAAM,CAAC31B,CAAC,CAAC,CAAC,CAAC,EAAEA,CAAC,CAAC,CAAC,CAAC,CAAC;QACtB,IAAIm9B,OAAO,GAAGn9B,CAAC,CAAC,CAAC,CAAC;QAClB,IAAIo9B,OAAO,GAAGp9B,CAAC,CAAC,CAAC,CAAC;QAClB,IAAIq9B,KAAK,GAAGp9B,CAAC,CAAC,CAAC,CAAC;QAChB,IAAIq9B,KAAK,GAAGr9B,CAAC,CAAC,CAAC,CAAC;QAChB,IAAIq8B,SAAS,IAAItnC,SAAS,CAACoD,KAAK,EAAE;UAC9B+kC,OAAO,IAAI,EAAE;QACjB,CAAC,MAAM;UACHC,OAAO,IAAI,EAAE;QACjB;QACA,IAAIb,OAAO,IAAIvnC,SAAS,CAACmD,IAAI,EAAE;UAC3BklC,KAAK,IAAI,EAAE;QACf,CAAC,MAAM;UACHC,KAAK,IAAI,EAAE;QACf;QACAhd,GAAG,CAACsV,MAAM,CAACuH,OAAO,EAAEC,OAAO,CAAC;QAC5B9c,GAAG,CAACsV,MAAM,CAAC,CAACuH,OAAO,GAAGE,KAAK,IAAI,GAAG,EAAED,OAAO,CAAC;QAC5C9c,GAAG,CAACsV,MAAM,CAAC,CAACuH,OAAO,GAAGE,KAAK,IAAI,GAAG,EAAEC,KAAK,CAAC;QAC1Chd,GAAG,CAACsV,MAAM,CAACyH,KAAK,EAAEC,KAAK,CAAC;QACxBhd,GAAG,CAACsV,MAAM,CAAC31B,CAAC,CAAC,CAAC,CAAC,EAAEA,CAAC,CAAC,CAAC,CAAC,CAAC;MAC1B,CAAC,MAAM;QACH;MACJ,CAAC,CAAC;IACN;;IAEA;IACA,IACI,IAAI,CAACojB,yBAAyB,IAC9B,IAAI,CAACjC,EAAE,CAAC5E,KAAK,GAAG,GAAG,IACnB,CAACigB,WAAW,EACd;MACEnc,GAAG,CAAC2V,WAAW,GAAG,iBAAiB;MACnC3V,GAAG,CAAC2Z,MAAM,EAAE;IAChB;IAEA3Z,GAAG,CAAC+U,SAAS,GAAG,IAAI,CAAC5Q,iBAAiB;IACtCnE,GAAG,CAAC0V,SAAS,GAAG1V,GAAG,CAAC2V,WAAW,GAAG7jB,KAAK;IACvCkO,GAAG,CAAC2Z,MAAM,EAAE;IACZ;;IAEA,IAAIx+B,GAAG,GAAG,IAAI,CAAC8hC,sBAAsB,CAACv9B,CAAC,EAAEC,CAAC,EAAE,GAAG,EAAEq8B,SAAS,EAAEC,OAAO,CAAC;IACpE,IAAItzB,IAAI,IAAIA,IAAI,CAACuJ,IAAI,EAAE;MACnBvJ,IAAI,CAACuJ,IAAI,CAAC,CAAC,CAAC,GAAG/W,GAAG,CAAC,CAAC,CAAC;MACrBwN,IAAI,CAACuJ,IAAI,CAAC,CAAC,CAAC,GAAG/W,GAAG,CAAC,CAAC,CAAC;IACzB;;IAEA;IACA,IACI,IAAI,CAAC2lB,EAAE,CAAC5E,KAAK,IAAI,GAAG,IACpB,IAAI,CAACyF,kBAAkB,IACvBsa,OAAO,IAAIvnC,SAAS,CAACqD,MAAM,EAC7B;MACE;MACA,IAAI,IAAI,CAACkrB,wBAAwB,EAAE;QAC/B;QACA,IAAIia,IAAI,GAAG,IAAI,CAACD,sBAAsB,CAClCv9B,CAAC,EACDC,CAAC,EACD,IAAI,EACJq8B,SAAS,EACTC,OAAO,CACV;QACD,IAAIkB,IAAI,GAAG,IAAI,CAACF,sBAAsB,CAClCv9B,CAAC,EACDC,CAAC,EACD,IAAI,EACJq8B,SAAS,EACTC,OAAO,CACV;QACD,IAAImB,IAAI,GAAG,IAAI,CAACH,sBAAsB,CAClCv9B,CAAC,EACDC,CAAC,EACD,IAAI,EACJq8B,SAAS,EACTC,OAAO,CACV;QACD,IAAIoB,IAAI,GAAG,IAAI,CAACJ,sBAAsB,CAClCv9B,CAAC,EACDC,CAAC,EACD,IAAI,EACJq8B,SAAS,EACTC,OAAO,CACV;;QAED;QACA,IAAIqB,MAAM,GAAG,CAAC;QACd,IAAIC,MAAM,GAAG,CAAC;QACd,IAAI,IAAI,CAACva,yBAAyB,EAAE;UAChCsa,MAAM,GAAG,CAACloB,IAAI,CAACooB,KAAK,CAACL,IAAI,CAAC,CAAC,CAAC,GAAGD,IAAI,CAAC,CAAC,CAAC,EAAEC,IAAI,CAAC,CAAC,CAAC,GAAGD,IAAI,CAAC,CAAC,CAAC,CAAC;UAC1DK,MAAM,GAAG,CAACnoB,IAAI,CAACooB,KAAK,CAACH,IAAI,CAAC,CAAC,CAAC,GAAGD,IAAI,CAAC,CAAC,CAAC,EAAEC,IAAI,CAAC,CAAC,CAAC,GAAGD,IAAI,CAAC,CAAC,CAAC,CAAC;QAC9D,CAAC,MAAM;UACHG,MAAM,GAAGD,MAAM,GAAG39B,CAAC,CAAC,CAAC,CAAC,GAAGD,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG0V,IAAI,CAACqgB,EAAE;QAC/C;;QAEA;QACAzV,GAAG,CAACmU,IAAI,EAAE;QACVnU,GAAG,CAACC,SAAS,CAACid,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,CAAC;QAC/Bld,GAAG,CAACyd,MAAM,CAACH,MAAM,CAAC;QAClBtd,GAAG,CAACoU,SAAS,EAAE;QACfpU,GAAG,CAACqV,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAClBrV,GAAG,CAACsV,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QACjBtV,GAAG,CAACsV,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAClBtV,GAAG,CAACoV,IAAI,EAAE;QACVpV,GAAG,CAACgU,OAAO,EAAE;QACbhU,GAAG,CAACmU,IAAI,EAAE;QACVnU,GAAG,CAACC,SAAS,CAACmd,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,CAAC;QAC/Bpd,GAAG,CAACyd,MAAM,CAACF,MAAM,CAAC;QAClBvd,GAAG,CAACoU,SAAS,EAAE;QACfpU,GAAG,CAACqV,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAClBrV,GAAG,CAACsV,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QACjBtV,GAAG,CAACsV,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAClBtV,GAAG,CAACoV,IAAI,EAAE;QACVpV,GAAG,CAACgU,OAAO,EAAE;MACjB;;MAEA;MACAhU,GAAG,CAACoU,SAAS,EAAE;MACfpU,GAAG,CAACwV,GAAG,CAACr6B,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAEia,IAAI,CAACqgB,EAAE,GAAG,CAAC,CAAC;MAC1CzV,GAAG,CAACoV,IAAI,EAAE;IACd;;IAEA;IACA,IAAIgH,IAAI,EAAE;MACNpc,GAAG,CAAC0V,SAAS,GAAG5jB,KAAK;MACrB,KAAK,IAAIjf,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAE,EAAEA,CAAC,EAAE;QACxB,IAAIqpC,CAAC,GAAG,CAACxnC,SAAS,CAAC0O,OAAO,EAAE,GAAG,KAAK,GAAGvQ,CAAC,GAAG,GAAG,IAAI,CAAC;QACnD,IAAIsI,GAAG,GAAG,IAAI,CAAC8hC,sBAAsB,CACjCv9B,CAAC,EACDC,CAAC,EACDu8B,CAAC,EACDF,SAAS,EACTC,OAAO,CACV;QACDjc,GAAG,CAACoU,SAAS,EAAE;QACfpU,GAAG,CAACwV,GAAG,CAACr6B,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAGia,IAAI,CAACqgB,EAAE,CAAC;QAC1CzV,GAAG,CAACoV,IAAI,EAAE;MACd;IACJ;EACJ,CAAC;;EAED;EACAhvB,YAAY,CAACnT,SAAS,CAACgqC,sBAAsB,GAAG,UAC5Cv9B,CAAC,EACDC,CAAC,EACD6D,CAAC,EACDw4B,SAAS,EACTC,OAAO,EACT;IACED,SAAS,GAAGA,SAAS,IAAItnC,SAAS,CAACoD,KAAK;IACxCmkC,OAAO,GAAGA,OAAO,IAAIvnC,SAAS,CAACmD,IAAI;IAEnC,IAAI60B,IAAI,GAAGC,QAAQ,CAACjtB,CAAC,EAAEC,CAAC,CAAC;IACzB,IAAI+9B,EAAE,GAAGh+B,CAAC;IACV,IAAIi+B,EAAE,GAAG,CAACj+B,CAAC,CAAC,CAAC,CAAC,EAAEA,CAAC,CAAC,CAAC,CAAC,CAAC;IACrB,IAAIk+B,EAAE,GAAG,CAACj+B,CAAC,CAAC,CAAC,CAAC,EAAEA,CAAC,CAAC,CAAC,CAAC,CAAC;IACrB,IAAIk+B,EAAE,GAAGl+B,CAAC;IAEV,QAAQq8B,SAAS;MACb,KAAKtnC,SAAS,CAACmD,IAAI;QACf8lC,EAAE,CAAC,CAAC,CAAC,IAAIjR,IAAI,GAAG,CAAC,IAAI;QACrB;MACJ,KAAKh4B,SAAS,CAACoD,KAAK;QAChB6lC,EAAE,CAAC,CAAC,CAAC,IAAIjR,IAAI,GAAG,IAAI;QACpB;MACJ,KAAKh4B,SAAS,CAACiD,EAAE;QACbgmC,EAAE,CAAC,CAAC,CAAC,IAAIjR,IAAI,GAAG,CAAC,IAAI;QACrB;MACJ,KAAKh4B,SAAS,CAACkD,IAAI;QACf+lC,EAAE,CAAC,CAAC,CAAC,IAAIjR,IAAI,GAAG,IAAI;QACpB;IAAM;IAEd,QAAQuP,OAAO;MACX,KAAKvnC,SAAS,CAACmD,IAAI;QACf+lC,EAAE,CAAC,CAAC,CAAC,IAAIlR,IAAI,GAAG,CAAC,IAAI;QACrB;MACJ,KAAKh4B,SAAS,CAACoD,KAAK;QAChB8lC,EAAE,CAAC,CAAC,CAAC,IAAIlR,IAAI,GAAG,IAAI;QACpB;MACJ,KAAKh4B,SAAS,CAACiD,EAAE;QACbimC,EAAE,CAAC,CAAC,CAAC,IAAIlR,IAAI,GAAG,CAAC,IAAI;QACrB;MACJ,KAAKh4B,SAAS,CAACkD,IAAI;QACfgmC,EAAE,CAAC,CAAC,CAAC,IAAIlR,IAAI,GAAG,IAAI;QACpB;IAAM;IAGd,IAAIoR,EAAE,GAAG,CAAC,CAAC,GAAGt6B,CAAC,KAAK,CAAC,GAAGA,CAAC,CAAC,IAAI,CAAC,GAAGA,CAAC,CAAC;IACpC,IAAIu6B,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC,GAAGv6B,CAAC,KAAK,CAAC,GAAGA,CAAC,CAAC,CAAC,GAAGA,CAAC;IACpC,IAAIw6B,EAAE,GAAG,CAAC,IAAI,CAAC,GAAGx6B,CAAC,CAAC,IAAIA,CAAC,GAAGA,CAAC,CAAC;IAC9B,IAAIy6B,EAAE,GAAGz6B,CAAC,GAAGA,CAAC,GAAGA,CAAC;IAElB,IAAI6G,CAAC,GAAGyzB,EAAE,GAAGJ,EAAE,CAAC,CAAC,CAAC,GAAGK,EAAE,GAAGJ,EAAE,CAAC,CAAC,CAAC,GAAGK,EAAE,GAAGJ,EAAE,CAAC,CAAC,CAAC,GAAGK,EAAE,GAAGJ,EAAE,CAAC,CAAC,CAAC;IACzD,IAAIrzB,CAAC,GAAGszB,EAAE,GAAGJ,EAAE,CAAC,CAAC,CAAC,GAAGK,EAAE,GAAGJ,EAAE,CAAC,CAAC,CAAC,GAAGK,EAAE,GAAGJ,EAAE,CAAC,CAAC,CAAC,GAAGK,EAAE,GAAGJ,EAAE,CAAC,CAAC,CAAC;IACzD,OAAO,CAACxzB,CAAC,EAAEG,CAAC,CAAC;EACjB,CAAC;EAEDpE,YAAY,CAACnT,SAAS,CAAC2hC,kBAAkB,GAAG,UAAS5U,GAAG,EAAE;IACtDA,GAAG,CAACuY,WAAW,GAAG,aAAa;IAC/BvY,GAAG,CAACoW,WAAW,GAAG,IAAI;IAEtBpW,GAAG,CAACsW,SAAS,GAAG,QAAQ;IACxBtW,GAAG,CAAC2V,WAAW,GAAG,OAAO;IACzB3V,GAAG,CAACoW,WAAW,GAAG,IAAI;IAEtB,IAAI9Q,aAAa,GAAG,IAAI,CAACA,aAAa;IACtC,KAAK,IAAIzyB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGyyB,aAAa,CAACnzB,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC3C,IAAIiM,IAAI,GAAGwmB,aAAa,CAACzyB,CAAC,CAAC;MAC3BmtB,GAAG,CAAC0V,SAAS,GAAG,OAAO;MACvB1V,GAAG,CAACoY,QAAQ,CACRt5B,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB,EACzCiK,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB,EACzCH,SAAS,CAACG,iBAAiB,EAC3BH,SAAS,CAACG,iBAAiB,CAC9B;MACD,IAAIiK,IAAI,CAACqK,KAAK,IAAI,CAAC,EAAE;QACjB6W,GAAG,CAAC4V,UAAU,CACV92B,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB,GAAG,GAAG,EAC/CiK,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB,GAAG,GAAG,EAC/CH,SAAS,CAACG,iBAAiB,EAC3BH,SAAS,CAACG,iBAAiB,CAC9B;MACL;MACAmrB,GAAG,CAAC0V,SAAS,GAAG,MAAM;MACtB1V,GAAG,CAACuW,QAAQ,CACRz3B,IAAI,CAACqK,KAAK,EACVrK,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAGzG,SAAS,CAACG,iBAAiB,GAAG,CAAC,GAAG,EAChDiK,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAClB;IACL;IACA6kB,GAAG,CAACoW,WAAW,GAAG,CAAC;EACvB,CAAC;;EAED;AACJ;AACA;AACA;EACIhwB,YAAY,CAACnT,SAAS,CAAC4mC,eAAe,GAAG,UACrC/6B,IAAI,EACJo/B,IAAI,EACJle,GAAG,EACHme,aAAa,EACf;IACE,IAAI,CAACr/B,IAAI,CAAC2T,OAAO,IAAI,CAAC3T,IAAI,CAAC2T,OAAO,CAACtgB,MAAM,EAAE;MACvC,OAAO,CAAC;IACZ;IACA,IAAI8rB,KAAK,GAAGnf,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC;IACxB,IAAIsT,OAAO,GAAG3T,IAAI,CAAC2T,OAAO;IAC1ByrB,IAAI,IAAI,CAAC;IACT,IAAIE,CAAC,GAAG1pC,SAAS,CAACM,kBAAkB;IACpC,IAAIqpC,SAAS,GAAG,IAAI,CAACvd,EAAE,CAAC5E,KAAK,GAAG,GAAG;IACnC8D,GAAG,CAACmU,IAAI,EAAE;IACVnU,GAAG,CAACoW,WAAW,GAAG,IAAI,CAACvU,YAAY;IACnC,IAAIyc,aAAa,GAAG5pC,SAAS,CAACwB,oBAAoB;IAClD,IAAIqoC,gBAAgB,GAAG7pC,SAAS,CAACuB,cAAc;IAC/C,IAAIuoC,UAAU,GAAG9pC,SAAS,CAACyB,iBAAiB;IAClD,IAAIsoC,oBAAoB,GAAG/pC,SAAS,CAAC0B,2BAA2B;IAC1D,IAAI6T,MAAM,GAAG,EAAE;IAEf,KAAK,IAAIpX,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG4f,OAAO,CAACtgB,MAAM,EAAE,EAAEU,CAAC,EAAE;MACrC,IAAI6f,CAAC,GAAGD,OAAO,CAAC5f,CAAC,CAAC;MAClB,IAAI2X,CAAC,GAAG0zB,IAAI;MACZ,IAAIxrB,CAAC,CAAClI,CAAC,EAAE;QACLA,CAAC,GAAGkI,CAAC,CAAClI,CAAC;MACX;MACAkI,CAAC,CAACgsB,MAAM,GAAGl0B,CAAC;MACZwV,GAAG,CAAC2V,WAAW,GAAG2I,aAAa;MAC/Bte,GAAG,CAAC0V,SAAS,GAAG,MAAM;MACtB1V,GAAG,CAACsW,SAAS,GAAG,MAAM;MAC/B;MACA,IAAG5jB,CAAC,CAACisB,QAAQ,EACZ3e,GAAG,CAACoW,WAAW,IAAI,GAAG;MACvB,IAAIwI,YAAY,GAAGlsB,CAAC,CAACuL,KAAK,IAAIA,KAAK;MAE1B,QAAQvL,CAAC,CAAC9X,IAAI;QACV,KAAK,QAAQ;UACT,IAAI8X,CAAC,CAAC4kB,OAAO,EAAE;YACXtX,GAAG,CAAC0V,SAAS,GAAG,MAAM;YACtBhjB,CAAC,CAAC4kB,OAAO,GAAG,KAAK;YACjB,IAAI,CAAC3R,YAAY,GAAG,IAAI;UAC5B;UACA3F,GAAG,CAACoY,QAAQ,CAACnuB,MAAM,EAAEO,CAAC,EAAEo0B,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEm0B,CAAC,CAAC;UACpE,IAAGC,SAAS,IAAI,CAAC3rB,CAAC,CAACisB,QAAQ,EACX3e,GAAG,CAAC4V,UAAU,CAAE3rB,MAAM,EAAEO,CAAC,EAAEo0B,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEm0B,CAAC,CAAE;UAC1D,IAAIC,SAAS,EAAE;YACXre,GAAG,CAACsW,SAAS,GAAG,QAAQ;YACxBtW,GAAG,CAAC0V,SAAS,GAAG8I,UAAU;YAC1Bxe,GAAG,CAACuW,QAAQ,CAAC7jB,CAAC,CAACve,IAAI,EAAEyqC,YAAY,GAAG,GAAG,EAAEp0B,CAAC,GAAG4zB,CAAC,GAAG,GAAG,CAAC;UACzD;UACA;QACJ,KAAK,QAAQ;UACTpe,GAAG,CAACsW,SAAS,GAAG,MAAM;UACtBtW,GAAG,CAAC2V,WAAW,GAAG2I,aAAa;UAC/Bte,GAAG,CAAC0V,SAAS,GAAG6I,gBAAgB;UAChCve,GAAG,CAACoU,SAAS,EAAE;UACf,IAAIiK,SAAS,EACZre,GAAG,CAACqW,SAAS,CAACpsB,MAAM,EAAEO,CAAC,EAAEo0B,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEm0B,CAAC,EAAE,CAACA,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,KAElEpe,GAAG,CAACzB,IAAI,CAACtU,MAAM,EAAEO,CAAC,EAAEo0B,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEm0B,CAAC,CAAE;UACnDpe,GAAG,CAACoV,IAAI,EAAE;UACzB,IAAGiJ,SAAS,IAAI,CAAC3rB,CAAC,CAACisB,QAAQ,EACX3e,GAAG,CAAC2Z,MAAM,EAAE;UACb3Z,GAAG,CAAC0V,SAAS,GAAGhjB,CAAC,CAAC3E,KAAK,GAAG,MAAM,GAAG,MAAM;UACzCiS,GAAG,CAACoU,SAAS,EAAE;UACfpU,GAAG,CAACwV,GAAG,CAAEoJ,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEO,CAAC,GAAG4zB,CAAC,GAAG,GAAG,EAAEA,CAAC,GAAG,IAAI,EAAE,CAAC,EAAEhpB,IAAI,CAACqgB,EAAE,GAAG,CAAC,CAAE;UAC3EzV,GAAG,CAACoV,IAAI,EAAE;UACV,IAAIiJ,SAAS,EAAE;YACXre,GAAG,CAAC0V,SAAS,GAAG+I,oBAAoB;YACpC,IAAI/rB,CAAC,CAACve,IAAI,IAAI,IAAI,EAAE;cAChB6rB,GAAG,CAACuW,QAAQ,CAAC7jB,CAAC,CAACve,IAAI,EAAE8V,MAAM,GAAG,CAAC,EAAEO,CAAC,GAAG4zB,CAAC,GAAG,GAAG,CAAC;YACjD;YACApe,GAAG,CAAC0V,SAAS,GAAGhjB,CAAC,CAAC3E,KAAK,GAAGywB,UAAU,GAAGC,oBAAoB;YAC3Dze,GAAG,CAACsW,SAAS,GAAG,OAAO;YACvBtW,GAAG,CAACuW,QAAQ,CACR7jB,CAAC,CAAC3E,KAAK,GACD2E,CAAC,CAAC7T,OAAO,CAACpL,EAAE,IAAI,MAAM,GACtBif,CAAC,CAAC7T,OAAO,CAACjL,GAAG,IAAI,OAAO,EAC9BgrC,YAAY,GAAG,EAAE,EACjBp0B,CAAC,GAAG4zB,CAAC,GAAG,GAAG,CACd;UACL;UACA;QACJ,KAAK,QAAQ;UACTpe,GAAG,CAAC0V,SAAS,GAAG6I,gBAAgB;UAChCve,GAAG,CAACoY,QAAQ,CAACnuB,MAAM,EAAEO,CAAC,EAAEo0B,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEm0B,CAAC,CAAC;UACrD,IAAIS,KAAK,GAAGnsB,CAAC,CAAC7T,OAAO,CAAC0X,GAAG,GAAG7D,CAAC,CAAC7T,OAAO,CAACm6B,GAAG;UACzC,IAAI8F,MAAM,GAAG,CAACpsB,CAAC,CAAC3E,KAAK,GAAG2E,CAAC,CAAC7T,OAAO,CAACm6B,GAAG,IAAI6F,KAAK;UAC9C7e,GAAG,CAAC0V,SAAS,GAAGyI,aAAa,IAAIzrB,CAAC,GAAG,MAAM,GAAG,MAAM;UACpDsN,GAAG,CAACoY,QAAQ,CAACnuB,MAAM,EAAEO,CAAC,EAAEs0B,MAAM,IAAIF,YAAY,GAAG30B,MAAM,GAAG,CAAC,CAAC,EAAEm0B,CAAC,CAAC;UAC/E,IAAGC,SAAS,IAAI,CAAC3rB,CAAC,CAACisB,QAAQ,EACX3e,GAAG,CAAC4V,UAAU,CAAC3rB,MAAM,EAAEO,CAAC,EAAEo0B,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEm0B,CAAC,CAAC;UACxD,IAAI1rB,CAAC,CAAC7gB,MAAM,EAAE;YACV,IAAIktC,aAAa,GAAG,CAACrsB,CAAC,CAAC7gB,MAAM,GAAG6gB,CAAC,CAAC7T,OAAO,CAACm6B,GAAG,IAAI6F,KAAK;YACtD7e,GAAG,CAAC0V,SAAS,GAAG,MAAM;YACtB1V,GAAG,CAACoY,QAAQ,CAAEnuB,MAAM,GAAG80B,aAAa,IAAIH,YAAY,GAAG30B,MAAM,GAAG,CAAC,CAAC,EAAEO,CAAC,EAAE,CAAC,EAAE4zB,CAAC,CAAE;UACjF;UACA,IAAIC,SAAS,EAAE;YACXre,GAAG,CAACsW,SAAS,GAAG,QAAQ;YACxBtW,GAAG,CAAC0V,SAAS,GAAG8I,UAAU;YAC1Bxe,GAAG,CAACuW,QAAQ,CACR7jB,CAAC,CAACve,IAAI,GAAG,IAAI,GAAG2lB,MAAM,CAACpH,CAAC,CAAC3E,KAAK,CAAC,CAAC2pB,OAAO,CAAC,CAAC,CAAC,EAC1CkH,YAAY,GAAG,GAAG,EAClBp0B,CAAC,GAAG4zB,CAAC,GAAG,GAAG,CACd;UACL;UACA;QACJ,KAAK,QAAQ;QACb,KAAK,OAAO;UACRpe,GAAG,CAACsW,SAAS,GAAG,MAAM;UACtBtW,GAAG,CAAC2V,WAAW,GAAG2I,aAAa;UAC/Bte,GAAG,CAAC0V,SAAS,GAAG6I,gBAAgB;UAChCve,GAAG,CAACoU,SAAS,EAAE;UAC9B,IAAGiK,SAAS,EACIre,GAAG,CAACqW,SAAS,CAACpsB,MAAM,EAAEO,CAAC,EAAEo0B,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEm0B,CAAC,EAAE,CAACA,CAAC,GAAG,GAAG,CAAC,CAAE,CAAC,KAEnEpe,GAAG,CAACzB,IAAI,CAACtU,MAAM,EAAEO,CAAC,EAAEo0B,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEm0B,CAAC,CAAE;UACnDpe,GAAG,CAACoV,IAAI,EAAE;UACV,IAAIiJ,SAAS,EAAE;YAC7B,IAAG,CAAC3rB,CAAC,CAACisB,QAAQ,EACE3e,GAAG,CAAC2Z,MAAM,EAAE;YACV3Z,GAAG,CAAC0V,SAAS,GAAG8I,UAAU;YAC5C,IAAG,CAAC9rB,CAAC,CAACisB,QAAQ,EACd;cACC3e,GAAG,CAACoU,SAAS,EAAE;cACfpU,GAAG,CAACqV,MAAM,CAACprB,MAAM,GAAG,EAAE,EAAEO,CAAC,GAAG,CAAC,CAAC;cAC9BwV,GAAG,CAACsV,MAAM,CAACrrB,MAAM,GAAG,CAAC,EAAEO,CAAC,GAAG4zB,CAAC,GAAG,GAAG,CAAC;cACnCpe,GAAG,CAACsV,MAAM,CAACrrB,MAAM,GAAG,EAAE,EAAEO,CAAC,GAAG4zB,CAAC,GAAG,CAAC,CAAC;cAClCpe,GAAG,CAACoV,IAAI,EAAE;cACVpV,GAAG,CAACoU,SAAS,EAAE;cACfpU,GAAG,CAACqV,MAAM,CAACuJ,YAAY,GAAG30B,MAAM,GAAG,EAAE,EAAEO,CAAC,GAAG,CAAC,CAAC;cAC7CwV,GAAG,CAACsV,MAAM,CAACsJ,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEO,CAAC,GAAG4zB,CAAC,GAAG,GAAG,CAAC;cAClDpe,GAAG,CAACsV,MAAM,CAACsJ,YAAY,GAAG30B,MAAM,GAAG,EAAE,EAAEO,CAAC,GAAG4zB,CAAC,GAAG,CAAC,CAAC;cACjDpe,GAAG,CAACoV,IAAI,EAAE;YACX;YACkBpV,GAAG,CAAC0V,SAAS,GAAG+I,oBAAoB;YACpCze,GAAG,CAACuW,QAAQ,CAAC7jB,CAAC,CAACve,IAAI,EAAE8V,MAAM,GAAG,CAAC,GAAG,CAAC,EAAEO,CAAC,GAAG4zB,CAAC,GAAG,GAAG,CAAC;YACjDpe,GAAG,CAAC0V,SAAS,GAAG8I,UAAU;YAC1Bxe,GAAG,CAACsW,SAAS,GAAG,OAAO;YACvB,IAAI5jB,CAAC,CAAC9X,IAAI,IAAI,QAAQ,EAAE;cACpBolB,GAAG,CAACuW,QAAQ,CACRzc,MAAM,CAACpH,CAAC,CAAC3E,KAAK,CAAC,CAAC2pB,OAAO,CACnBhlB,CAAC,CAAC7T,OAAO,CAACmgC,SAAS,KAAKh0B,SAAS,GAC3B0H,CAAC,CAAC7T,OAAO,CAACmgC,SAAS,GACnB,CAAC,CACV,EACDJ,YAAY,GAAG30B,MAAM,GAAG,CAAC,GAAG,EAAE,EAC9BO,CAAC,GAAG4zB,CAAC,GAAG,GAAG,CACd;YACL,CAAC,MAAM;cACxB,IAAIviC,CAAC,GAAG6W,CAAC,CAAC3E,KAAK;cACf,IAAI2E,CAAC,CAAC7T,OAAO,CAAC4Y,MAAM,EACpB;gBACC,IAAIA,MAAM,GAAG/E,CAAC,CAAC7T,OAAO,CAAC4Y,MAAM;gBAC7B,IAAIA,MAAM,CAACnb,WAAW,KAAK6B,QAAQ,EAClCsZ,MAAM,GAAGA,MAAM,EAAE;gBAClB,IAAGA,MAAM,IAAIA,MAAM,CAACnb,WAAW,KAAK3J,KAAK,EACxCkJ,CAAC,GAAG4b,MAAM,CAAE/E,CAAC,CAAC3E,KAAK,CAAE;cACvB;cACqBiS,GAAG,CAACuW,QAAQ,CACR16B,CAAC,EACD+iC,YAAY,GAAG30B,MAAM,GAAG,CAAC,GAAG,EAAE,EAC9BO,CAAC,GAAG4zB,CAAC,GAAG,GAAG,CACd;YACL;UACJ;UACA;QACJ,KAAK,QAAQ;QACb,KAAK,MAAM;UACPpe,GAAG,CAACsW,SAAS,GAAG,MAAM;UACtBtW,GAAG,CAAC2V,WAAW,GAAG2I,aAAa;UAC/Bte,GAAG,CAAC0V,SAAS,GAAG6I,gBAAgB;UAChCve,GAAG,CAACoU,SAAS,EAAE;UACf,IAAIiK,SAAS,EACZre,GAAG,CAACqW,SAAS,CAACpsB,MAAM,EAAEO,CAAC,EAAEo0B,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEm0B,CAAC,EAAE,CAACA,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,KAElEpe,GAAG,CAACzB,IAAI,CAAEtU,MAAM,EAAEO,CAAC,EAAEo0B,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEm0B,CAAC,CAAE;UACpDpe,GAAG,CAACoV,IAAI,EAAE;UACb,IAAIiJ,SAAS,EAAE;YAC1B,IAAG,CAAC3rB,CAAC,CAACisB,QAAQ,EACb3e,GAAG,CAAC2Z,MAAM,EAAE;YACV3Z,GAAG,CAACmU,IAAI,EAAE;YACbnU,GAAG,CAACoU,SAAS,EAAE;YACfpU,GAAG,CAACzB,IAAI,CAACtU,MAAM,EAAEO,CAAC,EAAEo0B,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEm0B,CAAC,CAAC;YACjDpe,GAAG,CAACqU,IAAI,EAAE;;YAEK;YACGrU,GAAG,CAAC0V,SAAS,GAAG+I,oBAAoB;YACpC,IAAI/rB,CAAC,CAACve,IAAI,IAAI,IAAI,EAAE;cAChB6rB,GAAG,CAACuW,QAAQ,CAAC7jB,CAAC,CAACve,IAAI,EAAE8V,MAAM,GAAG,CAAC,EAAEO,CAAC,GAAG4zB,CAAC,GAAG,GAAG,CAAC;YACjD;YACApe,GAAG,CAAC0V,SAAS,GAAG8I,UAAU;YAC1Bxe,GAAG,CAACsW,SAAS,GAAG,OAAO;YACvBtW,GAAG,CAACuW,QAAQ,CAACh6B,MAAM,CAACmW,CAAC,CAAC3E,KAAK,CAAC,CAACzS,MAAM,CAAC,CAAC,EAAC,EAAE,CAAC,EAAEsjC,YAAY,GAAG30B,MAAM,GAAG,CAAC,EAAEO,CAAC,GAAG4zB,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;YACtGpe,GAAG,CAACgU,OAAO,EAAE;UACC;UACA;QACJ;UACI,IAAIthB,CAAC,CAACiX,IAAI,EAAE;YACRjX,CAAC,CAACiX,IAAI,CAAC3J,GAAG,EAAElhB,IAAI,EAAE8/B,YAAY,EAAEp0B,CAAC,EAAE4zB,CAAC,CAAC;UACzC;UACA;MAAM;MAEdF,IAAI,IAAI,CAACxrB,CAAC,CAACtT,WAAW,GAAGsT,CAAC,CAACtT,WAAW,CAACw/B,YAAY,CAAC,CAAC,CAAC,CAAC,GAAGR,CAAC,IAAI,CAAC;MACzEpe,GAAG,CAACoW,WAAW,GAAG,IAAI,CAACvU,YAAY;IAE9B;IACA7B,GAAG,CAACgU,OAAO,EAAE;IACnBhU,GAAG,CAACsW,SAAS,GAAG,MAAM;EACpB,CAAC;;EAED;AACJ;AACA;AACA;EACIlwB,YAAY,CAACnT,SAAS,CAACi5B,kBAAkB,GAAG,UACxCptB,IAAI,EACJ3D,GAAG,EACHkW,KAAK,EACL8sB,aAAa,EACf;IAAA;IACE,IAAI,CAACr/B,IAAI,CAAC2T,OAAO,IAAI,CAAC3T,IAAI,CAAC2T,OAAO,CAACtgB,MAAM,EAAE;MACvC,OAAO,IAAI;IACf;IAEA,IAAIkY,CAAC,GAAGlP,GAAG,CAAC,CAAC,CAAC,GAAG2D,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC;IAC5B,IAAIqP,CAAC,GAAGrP,GAAG,CAAC,CAAC,CAAC,GAAG2D,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC;IAC5B,IAAI8iB,KAAK,GAAGnf,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC;IACxB,IAAI8C,IAAI,GAAG,IAAI;IACf,IAAI4lB,UAAU,GAAG,IAAI,CAACC,eAAe,EAAE;IAAC,6BAEM;MACtCpV,CAAC,GAAG5T,IAAI,CAAC2T,OAAO,CAAC5f,CAAC,CAAC;MAChC,IAAG,CAAC6f,CAAC,IAAIA,CAAC,CAACisB,QAAQ;MAEfM,aAAa,GAAGvsB,CAAC,CAACtT,WAAW,GAAGsT,CAAC,CAACtT,WAAW,CAAC6e,KAAK,CAAC,CAAC,CAAC,CAAC,GAAGvpB,SAAS,CAACM,kBAAkB;MACtF4pC,YAAY,GAAGlsB,CAAC,CAACuL,KAAK,IAAIA,KAAK,EACnC;MACA,IAAKvL,CAAC,IAAIyrB,aAAa,KACrB9zB,CAAC,GAAG,CAAC,IAAIA,CAAC,GAAGu0B,YAAY,GAAG,EAAE,IAAIp0B,CAAC,GAAGkI,CAAC,CAACgsB,MAAM,IAAIl0B,CAAC,GAAGkI,CAAC,CAACgsB,MAAM,GAAGO,aAAa,IAAIvsB,CAAC,CAACgsB,MAAM,KAAK1zB,SAAS,CAAC;MAGvGk0B,SAAS,GAAGxsB,CAAC,CAAC3E,KAAK,EAEd;MACT;MACA,QAAQ2E,CAAC,CAAC9X,IAAI;QACb,KAAK,QAAQ;UACZ,IAAIyW,KAAK,CAACzW,IAAI,KAAKlG,SAAS,CAACgG,oBAAoB,GAAC,MAAM,EAAE;YACvC,IAAIgY,CAAC,CAACvB,QAAQ,EAAE;cACZ7f,UAAU,CAAC,YAAW;gBAClBohB,CAAC,CAACvB,QAAQ,CAACuB,CAAC,EAAEzQ,IAAI,EAAEnD,IAAI,EAAE3D,GAAG,EAAEkW,KAAK,CAAC;cACzC,CAAC,EAAE,EAAE,CAAC;YACV;YACAqB,CAAC,CAAC4kB,OAAO,GAAG,IAAI;YAChB,KAAI,CAAC3R,YAAY,GAAG,IAAI;UAC5B;UACf;QACD,KAAK,QAAQ;UACRkZ,KAAK,GAAGnsB,CAAC,CAAC7T,OAAO,CAAC0X,GAAG,GAAG7D,CAAC,CAAC7T,OAAO,CAACm6B,GAAG;UACrC8F,MAAM,GAAG1pB,IAAI,CAAC+pB,KAAK,CAAC,CAAC90B,CAAC,GAAG,EAAE,KAAKu0B,YAAY,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;UAC7DlsB,CAAC,CAAC3E,KAAK,GAAG2E,CAAC,CAAC7T,OAAO,CAACm6B,GAAG,GAAG,CAACtmB,CAAC,CAAC7T,OAAO,CAAC0X,GAAG,GAAG7D,CAAC,CAAC7T,OAAO,CAACm6B,GAAG,IAAI8F,MAAM;UAClE,IAAIpsB,CAAC,CAACvB,QAAQ,EAAE;YACf7f,UAAU,CAAC,YAAW;cACrB8tC,kBAAkB,CAAC1sB,CAAC,EAAEA,CAAC,CAAC3E,KAAK,CAAC;YAC/B,CAAC,EAAE,EAAE,CAAC;UACP;UACA,KAAI,CAAC4X,YAAY,GAAG,IAAI;UACxB;QACD,KAAK,QAAQ;QACb,KAAK,OAAO;UACPuZ,SAAS,GAAGxsB,CAAC,CAAC3E,KAAK;UACvB,IAAIsD,KAAK,CAACzW,IAAI,IAAIlG,SAAS,CAACgG,oBAAoB,GAAC,MAAM,IAAIgY,CAAC,CAAC9X,IAAI,IAAI,QAAQ,EAAE;YAC9E8X,CAAC,CAAC3E,KAAK,IAAIsD,KAAK,CAAC+hB,MAAM,GAAG,GAAG,IAAI1gB,CAAC,CAAC7T,OAAO,CAACwgC,IAAI,IAAI,CAAC,CAAC;YACrD,IAAK3sB,CAAC,CAAC7T,OAAO,CAACm6B,GAAG,IAAI,IAAI,IAAItmB,CAAC,CAAC3E,KAAK,GAAG2E,CAAC,CAAC7T,OAAO,CAACm6B,GAAG,EAAG;cACvDtmB,CAAC,CAAC3E,KAAK,GAAG2E,CAAC,CAAC7T,OAAO,CAACm6B,GAAG;YACxB;YACA,IAAKtmB,CAAC,CAAC7T,OAAO,CAAC0X,GAAG,IAAI,IAAI,IAAI7D,CAAC,CAAC3E,KAAK,GAAG2E,CAAC,CAAC7T,OAAO,CAAC0X,GAAG,EAAG;cACvD7D,CAAC,CAAC3E,KAAK,GAAG2E,CAAC,CAAC7T,OAAO,CAAC0X,GAAG;YACxB;UACD,CAAC,MAAM,IAAIlF,KAAK,CAACzW,IAAI,IAAIlG,SAAS,CAACgG,oBAAoB,GAAC,MAAM,EAAE;YAC3D+c,MAAM,GAAG/E,CAAC,CAAC7T,OAAO,CAAC4Y,MAAM;YAC7B,IAAIA,MAAM,IAAIA,MAAM,CAACnb,WAAW,KAAK6B,QAAQ,EAAE;cAC9CsZ,MAAM,GAAG/E,CAAC,CAAC7T,OAAO,CAAC4Y,MAAM,CAAC/E,CAAC,EAAE5T,IAAI,CAAC;YACnC;YACIwgC,WAAW,GAAG,IAAI;YAEtB,IAAI5sB,CAAC,CAAC9X,IAAI,IAAI,QAAQ,EACrB0kC,WAAW,GAAG7nB,MAAM,CAACnb,WAAW,KAAK3J,KAAK,GAAG8kB,MAAM,GAAGhc,MAAM,CAACmyB,IAAI,CAACnW,MAAM,CAAC;YAEtEiI,KAAK,GAAGrV,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,GAAGA,CAAC,GAAGu0B,YAAY,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC;YACvD,IAAIlsB,CAAC,CAAC9X,IAAI,IAAI,QAAQ,EAAE;cACvB8X,CAAC,CAAC3E,KAAK,IAAI2R,KAAK,GAAG,GAAG,IAAIhN,CAAC,CAAC7T,OAAO,CAACwgC,IAAI,IAAI,CAAC,CAAC;cAC9C,IAAK3sB,CAAC,CAAC7T,OAAO,CAACm6B,GAAG,IAAI,IAAI,IAAItmB,CAAC,CAAC3E,KAAK,GAAG2E,CAAC,CAAC7T,OAAO,CAACm6B,GAAG,EAAG;gBACvDtmB,CAAC,CAAC3E,KAAK,GAAG2E,CAAC,CAAC7T,OAAO,CAACm6B,GAAG;cACxB;cACA,IAAKtmB,CAAC,CAAC7T,OAAO,CAAC0X,GAAG,IAAI,IAAI,IAAI7D,CAAC,CAAC3E,KAAK,GAAG2E,CAAC,CAAC7T,OAAO,CAAC0X,GAAG,EAAG;gBACvD7D,CAAC,CAAC3E,KAAK,GAAG2E,CAAC,CAAC7T,OAAO,CAAC0X,GAAG;cACxB;YACD,CAAC,MAAM,IAAImJ,KAAK,EAAE;cAAE;cACf/T,KAAK,GAAG,CAAC,CAAC;cACd,KAAI,CAACoa,eAAe,GAAG,CAAC,CAAC,CAAC;cAC1B,IAAGtO,MAAM,CAACnb,WAAW,KAAKb,MAAM,EAC/BkQ,KAAK,GAAG2zB,WAAW,CAACj+B,OAAO,CAAE9E,MAAM,CAAEmW,CAAC,CAAC3E,KAAK,CAAE,CAAE,GAAG2R,KAAK,CAAC,KAEzD/T,KAAK,GAAG2zB,WAAW,CAACj+B,OAAO,CAAEqR,CAAC,CAAC3E,KAAK,CAAE,GAAG2R,KAAK;cAC/C,IAAI/T,KAAK,IAAI2zB,WAAW,CAACntC,MAAM,EAAE;gBAChCwZ,KAAK,GAAG2zB,WAAW,CAACntC,MAAM,GAAG,CAAC;cAC/B;cACA,IAAIwZ,KAAK,GAAG,CAAC,EAAE;gBACdA,KAAK,GAAG,CAAC;cACV;cACA,IAAI8L,MAAM,CAACnb,WAAW,KAAK3J,KAAK,EAC/B+f,CAAC,CAAC3E,KAAK,GAAG0J,MAAM,CAAC9L,KAAK,CAAC,CAAC,KAExB+G,CAAC,CAAC3E,KAAK,GAAGpC,KAAK;YACjB,CAAC,MAAM;cAAA,IASG4zB,aAAa,GAAtB,uBAAuB1jC,CAAC,EAAE2jC,MAAM,EAAEnuB,KAAK,EAAE;gBACxC,IAAGoG,MAAM,IAAI6nB,WAAW,EACvBzjC,CAAC,GAAG4jC,WAAW,CAACp+B,OAAO,CAACxF,CAAC,CAAC;gBAC3B,IAAI,CAACkS,KAAK,GAAGlS,CAAC;gBACdujC,kBAAkB,CAAC,IAAI,EAAEvjC,CAAC,CAAC;gBAC3BoG,IAAI,CAAC0jB,YAAY,GAAG,IAAI;gBACxB,OAAO,KAAK;cACb,CAAC;cAhBO;cACJ8Z,WAAW,GAAGhoB,MAAM,IAAI6nB,WAAW,GAAG7jC,MAAM,CAACgc,MAAM,CAACA,MAAM,CAAC,GAAGA,MAAM;cACpEioB,IAAI,GAAG,IAAIhrC,SAAS,CAACirC,WAAW,CAACF,WAAW,EAAE;gBAChDvjB,KAAK,EAAE9G,IAAI,CAACmB,GAAG,CAAC,CAAC,EAAE,KAAI,CAACuK,EAAE,CAAC5E,KAAK,CAAC;gBACjC7K,KAAK,EAAEA,KAAK;gBACZ6V,SAAS,EAAE,MAAM;gBACjB/V,QAAQ,EAAEouB,aAAa,CAACj8B,IAAI,CAACoP,CAAC;cAC/B,CAAC,EACDmV,UAAU,CAAC;YASb;UACD,CAAC,CAAC;UAAA,KACG,IAAGxW,KAAK,CAACzW,IAAI,IAAIlG,SAAS,CAACgG,oBAAoB,GAAC,IAAI,IAAIgY,CAAC,CAAC9X,IAAI,IAAI,QAAQ,EAC/E;YACK8kB,KAAK,GAAGrV,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,GAAGA,CAAC,GAAGu0B,YAAY,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC;YACvD,IAAIvtB,KAAK,CAAC4d,UAAU,GAAG,GAAG,IAAIvP,KAAK,IAAI,CAAC,EAAE;cACzC,KAAI,CAACkgB,MAAM,CAAC,OAAO,EAACltB,CAAC,CAAC3E,KAAK,EAAC,UAASlS,CAAC,EAAE;gBACtC,IAAI,CAACkS,KAAK,GAAG+L,MAAM,CAACje,CAAC,CAAC;gBACtBujC,kBAAkB,CAAC,IAAI,EAAE,IAAI,CAACrxB,KAAK,CAAC;cACrC,CAAC,CAACzK,IAAI,CAACoP,CAAC,CAAC,EACTrB,KAAK,CAAC;YACR;UACD;UAEA,IAAI6tB,SAAS,IAAIxsB,CAAC,CAAC3E,KAAK,EACvBzc,UAAU,CACT,YAAW;YACV8tC,kBAAkB,CAAC,IAAI,EAAE,IAAI,CAACrxB,KAAK,CAAC;UACrC,CAAC,CAACzK,IAAI,CAACoP,CAAC,CAAC,EACT,EAAE,CACF;UACF,KAAI,CAACiT,YAAY,GAAG,IAAI;UACxB;QACD,KAAK,QAAQ;UACZ,IAAItU,KAAK,CAACzW,IAAI,IAAIlG,SAAS,CAACgG,oBAAoB,GAAC,MAAM,EAAE;YACxDgY,CAAC,CAAC3E,KAAK,GAAG,CAAC2E,CAAC,CAAC3E,KAAK;YAClBzc,UAAU,CAAC,YAAW;cACrB8tC,kBAAkB,CAAC1sB,CAAC,EAAEA,CAAC,CAAC3E,KAAK,CAAC;YAC/B,CAAC,EAAE,EAAE,CAAC;UACP;UACA;QACD,KAAK,QAAQ;QACb,KAAK,MAAM;UACV,IAAIsD,KAAK,CAACzW,IAAI,IAAIlG,SAAS,CAACgG,oBAAoB,GAAC,MAAM,EAAE;YACxD,KAAI,CAACklC,MAAM,CAAC,OAAO,EAACltB,CAAC,CAAC3E,KAAK,EAAC,UAASlS,CAAC,EAAE;cACtC,IAAI,CAACkS,KAAK,GAAGlS,CAAC;cACdujC,kBAAkB,CAAC,IAAI,EAAEvjC,CAAC,CAAC;YAC5B,CAAC,CAACyH,IAAI,CAACoP,CAAC,CAAC,EACTrB,KAAK,EAACqB,CAAC,CAAC7T,OAAO,GAAG6T,CAAC,CAAC7T,OAAO,CAACghC,SAAS,GAAG,KAAK,CAAE;UACjD;UACA;QACD;UACC,IAAIntB,CAAC,CAAC6Q,KAAK,EAAE;YACZ,KAAI,CAACoC,YAAY,GAAGjT,CAAC,CAAC6Q,KAAK,CAAClS,KAAK,EAAE,CAAChH,CAAC,EAAEG,CAAC,CAAC,EAAE1L,IAAI,CAAC;UACjD;UACA;MAAM,CACP,CAAC;;MAEF;MACA,IAAIogC,SAAS,IAAIxsB,CAAC,CAAC3E,KAAK,EACxB;QACC,IAAGjP,IAAI,CAACghC,eAAe,EACtBhhC,IAAI,CAACghC,eAAe,CAAEptB,CAAC,CAACve,IAAI,EAACue,CAAC,CAAC3E,KAAK,EAACmxB,SAAS,EAACxsB,CAAC,CAAE;QACvC5T,IAAI,CAACuH,KAAK,CAAC9B,QAAQ,EAAE;MAClC;MAAC;QAAA,GAEMmO;MAAC;IACH,CAAC;IA/JD,KAAK,IAAI7f,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAAC2T,OAAO,CAACtgB,MAAM,EAAE,EAAEU,CAAC;MAAA;MAAA;MAAA,yBAGhD;MAAS;IAAA,CA4JJ;;IAED,SAASusC,kBAAkB,CAAC7nB,MAAM,EAAExJ,KAAK,EAAE;MACvCwJ,MAAM,CAACxJ,KAAK,GAAGA,KAAK;MACpB,IAAKwJ,MAAM,CAAC1Y,OAAO,IAAI0Y,MAAM,CAAC1Y,OAAO,CAAC8T,QAAQ,IAAI7T,IAAI,CAACnB,UAAU,CAAC4Z,MAAM,CAAC1Y,OAAO,CAAC8T,QAAQ,CAAC,KAAK3H,SAAS,EAAG;QACvGlM,IAAI,CAACsU,WAAW,CAAEmE,MAAM,CAAC1Y,OAAO,CAAC8T,QAAQ,EAAE5E,KAAK,CAAE;MACtD;MACA,IAAIwJ,MAAM,CAACpG,QAAQ,EAAE;QACjBoG,MAAM,CAACpG,QAAQ,CAACoG,MAAM,CAACxJ,KAAK,EAAE9L,IAAI,EAAEnD,IAAI,EAAE3D,GAAG,EAAEkW,KAAK,CAAC;MACzD;IACJ;IAEA,OAAO,IAAI;EACf,CAAC;;EAED;AACJ;AACA;AACA;EACIjL,YAAY,CAACnT,SAAS,CAAColC,UAAU,GAAG,UAASpsB,MAAM,EAAE+T,GAAG,EAAE;IACtD,IAAI,CAAC,IAAI,CAAC3Z,KAAK,EAAE;MACb;IACJ;IAEA,IAAIoK,MAAM,GAAG,IAAI,CAACpK,KAAK,CAACxB,OAAO;IAE/Bmb,GAAG,CAACmU,IAAI,EAAE;IACVnU,GAAG,CAACoW,WAAW,GAAG,GAAG,GAAG,IAAI,CAACvU,YAAY;IAEzC,KAAK,IAAIhvB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG4d,MAAM,CAACte,MAAM,EAAE,EAAEU,CAAC,EAAE;MACpC,IAAIme,KAAK,GAAGP,MAAM,CAAC5d,CAAC,CAAC;MAErB,IAAI,CAACoqB,eAAe,CAAC,IAAI,CAACS,YAAY,EAAE1M,KAAK,CAACsL,SAAS,CAAC,EAAE;QACtD;MACJ,CAAC,CAAC;;MAEF0D,GAAG,CAAC0V,SAAS,GAAG1kB,KAAK,CAACc,KAAK,IAAI,MAAM;MACrCkO,GAAG,CAAC2V,WAAW,GAAG3kB,KAAK,CAACc,KAAK,IAAI,MAAM;MACvC,IAAI3W,GAAG,GAAG6V,KAAK,CAACkB,IAAI;MACpB,IAAI/S,IAAI,GAAG6R,KAAK,CAACwL,KAAK;MACtBwD,GAAG,CAACoW,WAAW,GAAG,IAAI,GAAG,IAAI,CAACvU,YAAY;MAC1C7B,GAAG,CAACoU,SAAS,EAAE;MACfpU,GAAG,CAACzB,IAAI,CAACpjB,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,EAAEgE,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,CAAC;MACtD6gB,GAAG,CAACoV,IAAI,EAAE;MACVpV,GAAG,CAACoW,WAAW,GAAG,IAAI,CAACvU,YAAY;MACnC7B,GAAG,CAAC2Z,MAAM,EAAE;MAEZ3Z,GAAG,CAACoU,SAAS,EAAE;MACfpU,GAAG,CAACqV,MAAM,CAACl6B,GAAG,CAAC,CAAC,CAAC,GAAGgE,IAAI,CAAC,CAAC,CAAC,EAAEhE,GAAG,CAAC,CAAC,CAAC,GAAGgE,IAAI,CAAC,CAAC,CAAC,CAAC;MAC9C6gB,GAAG,CAACsV,MAAM,CAACn6B,GAAG,CAAC,CAAC,CAAC,GAAGgE,IAAI,CAAC,CAAC,CAAC,GAAG,EAAE,EAAEhE,GAAG,CAAC,CAAC,CAAC,GAAGgE,IAAI,CAAC,CAAC,CAAC,CAAC;MACnD6gB,GAAG,CAACsV,MAAM,CAACn6B,GAAG,CAAC,CAAC,CAAC,GAAGgE,IAAI,CAAC,CAAC,CAAC,EAAEhE,GAAG,CAAC,CAAC,CAAC,GAAGgE,IAAI,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;MACnD6gB,GAAG,CAACoV,IAAI,EAAE;MAEV,IAAI5e,SAAS,GACTxF,KAAK,CAACwF,SAAS,IAAI9hB,SAAS,CAACqrC,uBAAuB;MACxD/f,GAAG,CAACtD,IAAI,GAAGlG,SAAS,GAAG,UAAU;MAC1CwJ,GAAG,CAACsW,SAAS,GAAG,MAAM;MACbtW,GAAG,CAACuW,QAAQ,CAACvlB,KAAK,CAAC7d,KAAK,EAAEgI,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,GAAGqb,SAAS,CAAC;IAC7D;IAEAwJ,GAAG,CAACgU,OAAO,EAAE;EACjB,CAAC;EAED5tB,YAAY,CAACnT,SAAS,CAAC+sC,eAAe,GAAG,YAAW;IAChD,IAAI5iC,KAAK,GAAG,IAAI,CAACiJ,KAAK,CAAC7B,MAAM;IAC7B,KAAK,IAAI3R,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuK,KAAK,CAACjL,MAAM,EAAE,EAAEU,CAAC,EAAE;MACnCuK,KAAK,CAACvK,CAAC,CAAC,CAACsM,IAAI,GAAG/B,KAAK,CAACvK,CAAC,CAAC,CAACuM,WAAW,EAAE;IAC1C;IACA,IAAI,CAACknB,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC;EAC7B,CAAC;;EAED;AACJ;AACA;AACA;EACIlgB,YAAY,CAACnT,SAAS,CAACi7B,MAAM,GAAG,UAASjQ,KAAK,EAAEC,MAAM,EAAE;IACpD,IAAI,CAACD,KAAK,IAAI,CAACC,MAAM,EAAE;MACnB,IAAI+hB,MAAM,GAAG,IAAI,CAACh0B,MAAM,CAACi0B,UAAU;MACnCjiB,KAAK,GAAGgiB,MAAM,CAACE,WAAW;MAC1BjiB,MAAM,GAAG+hB,MAAM,CAACG,YAAY;IAChC;IAEA,IAAI,IAAI,CAACn0B,MAAM,CAACgS,KAAK,IAAIA,KAAK,IAAI,IAAI,CAAChS,MAAM,CAACiS,MAAM,IAAIA,MAAM,EAAE;MAC5D;IACJ;IAEA,IAAI,CAACjS,MAAM,CAACgS,KAAK,GAAGA,KAAK;IACzB,IAAI,CAAChS,MAAM,CAACiS,MAAM,GAAGA,MAAM;IAC3B,IAAI,CAACkJ,QAAQ,CAACnJ,KAAK,GAAG,IAAI,CAAChS,MAAM,CAACgS,KAAK;IACvC,IAAI,CAACmJ,QAAQ,CAAClJ,MAAM,GAAG,IAAI,CAACjS,MAAM,CAACiS,MAAM;IACzC,IAAI,CAACoI,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC;EAC7B,CAAC;;EAED;AACJ;AACA;AACA;AACA;EACIlgB,YAAY,CAACnT,SAAS,CAACotC,cAAc,GAAG,UAASC,UAAU,EAAE;IACzD,IAAI,CAACA,UAAU,EAAE;MACb,IAAI,CAACzwB,SAAS,GAAG,CAAC,IAAI,CAACA,SAAS;MAChC,IAAI,CAAC8V,YAAY,GAAG,IAAI;MACxB,IAAI,CAACC,cAAc,GAAG,IAAI;MAC1B;IACJ;IAEA,IAAI2a,IAAI,GAAG,IAAI;IACf,IAAI7gB,KAAK,GAAG,IAAI,CAAC7P,SAAS,GAAG,GAAG,GAAG,GAAG;IACtC,IAAI,IAAI,CAACA,SAAS,EAAE;MAChB,IAAI,CAACA,SAAS,GAAG,KAAK;MACtB,IAAI,CAACgS,YAAY,GAAG,GAAG;IAC3B;IAEA,IAAIre,CAAC,GAAG2D,WAAW,CAAC,YAAW;MAC3Bo5B,IAAI,CAAC1e,YAAY,IAAInC,KAAK;MAC1B6gB,IAAI,CAAC5a,YAAY,GAAG,IAAI;MACxB4a,IAAI,CAAC3a,cAAc,GAAG,IAAI;MAE1B,IAAIlG,KAAK,GAAG,CAAC,IAAI6gB,IAAI,CAAC1e,YAAY,GAAG,IAAI,EAAE;QACvCxa,aAAa,CAAC7D,CAAC,CAAC;QAChB,IAAIkc,KAAK,GAAG,CAAC,EAAE;UACX6gB,IAAI,CAAC1wB,SAAS,GAAG,IAAI;QACzB;MACJ;MACA,IAAI6P,KAAK,GAAG,CAAC,IAAI6gB,IAAI,CAAC1e,YAAY,GAAG,IAAI,EAAE;QACvCxa,aAAa,CAAC7D,CAAC,CAAC;QAChB+8B,IAAI,CAAC1e,YAAY,GAAG,CAAC;MACzB;IACJ,CAAC,EAAE,CAAC,CAAC;EACT,CAAC;EAEDzb,YAAY,CAACnT,SAAS,CAACutC,qBAAqB,GAAG,UAAS1hC,IAAI,EAAE;IAC1D,OAAO,CAAC;EACZ,CAAC;;EAED;AACJ;EACI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAMI;;EAEAsH,YAAY,CAACq6B,UAAU,GAAG,UAASnxB,IAAI,EAAEoxB,KAAK,EAAEC,WAAW,EAAE;IACzD,IAAI10B,MAAM,GAAG7F,YAAY,CAAC4jB,aAAa;IACvC,IAAInC,UAAU,GAAG5b,MAAM,CAAC6b,eAAe,EAAE;IAEzC,IAAI9W,KAAK,GAAG,IAAItc,SAAS,CAAC2W,WAAW,EAAE;IACvC2F,KAAK,CAAC7V,GAAG,GAAG8Q,MAAM,CAACqnB,0BAA0B,CAACqN,WAAW,CAAC;IAC1D10B,MAAM,CAAC5F,KAAK,CAAC8E,GAAG,CAAC6F,KAAK,CAAC;EAC3B,CAAC;EAED5K,YAAY,CAACw6B,SAAS,GAAG,UAAU9hC,IAAI,EAAED,OAAO,EAAEtN,CAAC,EAAEsvC,SAAS,EAAE1vB,SAAQ,EAAE;IAEtE,IAAIlF,MAAM,GAAG7F,YAAY,CAAC4jB,aAAa;IACvC,IAAInC,UAAU,GAAG5b,MAAM,CAAC6b,eAAe,EAAE;IACzC,IAAIzhB,KAAK,GAAG4F,MAAM,CAAC5F,KAAK;IACxB,IAAI,CAACA,KAAK,EACN;IAEJ,SAASy6B,iBAAiB,CAACC,aAAa,EAAEF,SAAS,EAAC;MAEhD,IAAI7lC,UAAU,GAAItG,SAAS,CAACmL,sBAAsB,CAACoM,MAAM,CAACxM,MAAM,IAAI4G,KAAK,CAAC5G,MAAM,CAAC,CAACA,MAAM,CAAC,UAASpE,QAAQ,EAAC;QAAC,OAAOA,QAAQ,CAAC2lC,UAAU,CAACD,aAAa,CAAC;MAAA,CAAC,CAAC;MACvJ,IAAIE,OAAO,GAAG,EAAE;MAEhBjmC,UAAU,CAACkmC,GAAG,CAAC,UAAS7lC,QAAQ,EAAC;QAE7B,IAAI,CAACA,QAAQ,EACT;QAEJ,IAAI8lC,mBAAmB,GAAG,IAAIC,MAAM,CAAC,IAAI,GAAGL,aAAa,GAAG,GAAG,CAAC;QAChE,IAAIM,aAAa,GAAGhmC,QAAQ,CAACimC,OAAO,CAACH,mBAAmB,EAAC,EAAE,CAAC,CAAClmC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QAC1E,IAAIsmC,aAAa,GAAGR,aAAa,KAAM,EAAE,GAAGM,aAAa,GAAG,GAAG,GAAGN,aAAa,GAAGM,aAAa,GAAG,GAAG;QAErG,IAAIltC,IAAI,GAAGktC,aAAa;QACxB,IAAGltC,IAAI,CAACkN,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;UAAE;UACzBlN,IAAI,GAAGA,IAAI,CAAC8G,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAE9B,IAAI0Q,KAAK,GAAGs1B,OAAO,CAACO,SAAS,CAAC,UAASd,KAAK,EAAC;UAAC,OAAOA,KAAK,CAAC3yB,KAAK,KAAKwzB,aAAa;QAAA,CAAC,CAAC;QACpF,IAAI51B,KAAK,KAAK,CAAC,CAAC,EAAE;UACds1B,OAAO,CAACnuC,IAAI,CAAC;YAAEib,KAAK,EAAEwzB,aAAa;YAAEE,OAAO,EAAEttC,IAAI;YAAEutC,WAAW,EAAE,IAAI;YAAEvwB,QAAQ,EAAG,kBAASpD,KAAK,EAAEsD,KAAK,EAAEswB,UAAU,EAAEC,WAAW,EAAC;cAC7Hd,iBAAiB,CAAC/yB,KAAK,CAACA,KAAK,EAAE6zB,WAAW,CAAC;YAC/C;UAAC,CAAC,CAAC;QACP;MAEJ,CAAC,CAAC;MAEF,IAAIxkC,KAAK,GAAG1I,SAAS,CAAC8K,sBAAsB,CAACuhC,aAAa,CAACc,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE51B,MAAM,CAACxM,MAAM,IAAI4G,KAAK,CAAC5G,MAAM,CAAE;MACxGrC,KAAK,CAAC8jC,GAAG,CAAC,UAASpiC,IAAI,EAAC;QAEpB,IAAIA,IAAI,CAACgB,SAAS,EACd;QAEJ,IAAI4gC,KAAK,GAAG;UAAE3yB,KAAK,EAAEjP,IAAI,CAAClE,IAAI;UAAE6mC,OAAO,EAAE3iC,IAAI,CAAC3L,KAAK;UAAEuuC,WAAW,EAAE,KAAK;UAAGvwB,QAAQ,EAAG,kBAASpD,KAAK,EAAEsD,KAAK,EAAEswB,UAAU,EAAEC,WAAW,EAAC;YAE5H,IAAIE,WAAW,GAAGF,WAAW,CAACG,aAAa,EAAE;YAC7C91B,MAAM,CAAC5F,KAAK,CAACwF,YAAY,EAAE;YAC3B,IAAI/M,IAAI,GAAGpK,SAAS,CAACkK,UAAU,CAACmP,KAAK,CAACA,KAAK,CAAC;YAC5C,IAAIjP,IAAI,EAAE;cACNA,IAAI,CAAC3D,GAAG,GAAG8Q,MAAM,CAACqnB,0BAA0B,CAACwO,WAAW,CAAC;cACzD71B,MAAM,CAAC5F,KAAK,CAAC8E,GAAG,CAACrM,IAAI,CAAC;YAC1B;YACA,IAAGqS,SAAQ,EACPA,SAAQ,CAACrS,IAAI,CAAC;YAClBmN,MAAM,CAAC5F,KAAK,CAACgG,WAAW,EAAE;UAE9B;QACJ,CAAC;QAED40B,OAAO,CAACnuC,IAAI,CAAC4tC,KAAK,CAAC;MAEvB,CAAC,CAAC;MAEF,IAAIhsC,SAAS,CAACirC,WAAW,CAAEsB,OAAO,EAAE;QAAE5vB,KAAK,EAAE9f,CAAC;QAAEywC,UAAU,EAAEnB;MAAU,CAAC,EAAEhZ,UAAU,CAAE;IAEzF;IAEAiZ,iBAAiB,CAAC,EAAE,EAACD,SAAS,CAAC;IAC/B,OAAO,KAAK;EAEhB,CAAC;EAEDz6B,YAAY,CAAC67B,iBAAiB,GAAG,YAAW,CAAC,CAAC;EAE9C77B,YAAY,CAAC87B,cAAc,GAAG,YAAW,CAAC,CAAC;EAE3C97B,YAAY,CAAC+7B,0BAA0B,GAAG,UACtCtmC,CAAC,EACDgD,OAAO,EACPtN,CAAC,EACDsvC,SAAS,EACT/hC,IAAI,EACN;IACE,IAAI,CAACA,IAAI,EAAE;MACP;IACJ;IAEA,IAAImD,IAAI,GAAG,IAAI;IACf,IAAIgK,MAAM,GAAG7F,YAAY,CAAC4jB,aAAa;IACvC,IAAInC,UAAU,GAAG5b,MAAM,CAAC6b,eAAe,EAAE;IAEzC,IAAIjpB,OAAO,GAAGC,IAAI,CAACsjC,eAAe;IAClC,IAAItjC,IAAI,CAACujC,WAAW,EAAE;MAClBxjC,OAAO,GAAGC,IAAI,CAACujC,WAAW,EAAE;IAChC;IAEA,IAAIpB,OAAO,GAAG,EAAE;IAChB,IAAIpiC,OAAO,EAAE;MACT,KAAK,IAAIhM,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAGgM,OAAO,CAAC1M,MAAM,EAAEU,CAAC,EAAE,EAAE;QACnC,IAAI6tC,KAAK,GAAG7hC,OAAO,CAAChM,CAAC,CAAC;QACtB,IAAI,CAAC6tC,KAAK,EAAE;UACRO,OAAO,CAACnuC,IAAI,CAAC,IAAI,CAAC;UAClB;QACJ;QACA,IAAI+jB,KAAK,GAAG6pB,KAAK,CAAC,CAAC,CAAC;QAChC,IAAG,CAACA,KAAK,CAAC,CAAC,CAAC,EACXA,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;QAEF,IAAIA,KAAK,CAAC,CAAC,CAAC,CAAC7pB,KAAK,EAAE;UAChBA,KAAK,GAAG6pB,KAAK,CAAC,CAAC,CAAC,CAAC7pB,KAAK;QAC1B;QAEZ6pB,KAAK,CAAC,CAAC,CAAC,CAAC4B,SAAS,GAAG,IAAI;QACb,IAAI1gC,IAAI,GAAG;UAAE6/B,OAAO,EAAE5qB,KAAK;UAAE9I,KAAK,EAAE2yB;QAAM,CAAC;QAC3C,IAAIA,KAAK,CAAC,CAAC,CAAC,IAAIhsC,SAAS,CAAC0C,MAAM,EAAE;UAC9BwK,IAAI,CAACslB,SAAS,GAAG,OAAO;QAC5B;QACA+Z,OAAO,CAACnuC,IAAI,CAAC8O,IAAI,CAAC;MACtB;IACJ;IAEA,IAAI9C,IAAI,CAACyjC,gBAAgB,EAAE;MACvB,IAAIC,UAAU,GAAG1jC,IAAI,CAACyjC,gBAAgB,CAACtB,OAAO,CAAC;MAC/C,IAAGuB,UAAU,EAAEvB,OAAO,GAAGuB,UAAU;IACvC;IAEA,IAAI,CAACvB,OAAO,CAAC9uC,MAAM,EAAE;MAC1B2I,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;MACtB;IACJ;IAEA,IAAI2kC,IAAI,GAAG,IAAIhrC,SAAS,CAACirC,WAAW,CAChCsB,OAAO,EACP;MACI5vB,KAAK,EAAE9f,CAAC;MACR4f,QAAQ,EAAEouB,aAAa;MACvByC,UAAU,EAAEnB,SAAS;MACrB/hC,IAAI,EAAEA;IACV,CAAC,EACD+oB,UAAU,CACb;IAED,SAAS0X,aAAa,CAAC1jC,CAAC,EAAEtK,CAAC,EAAEiK,IAAI,EAAE;MAC/B,IAAI,CAACsD,IAAI,EAAE;QACP;MACJ;MAEA,IAAIjD,CAAC,CAACsV,QAAQ,EAAE;QACZtV,CAAC,CAACsV,QAAQ,CAACxf,IAAI,CAACsQ,IAAI,EAAEnD,IAAI,EAAEjD,CAAC,EAAEtK,CAAC,EAAEiK,IAAI,CAAC;MAC3C;MAEA,IAAIK,CAAC,CAACkS,KAAK,EAAE;QACrBjP,IAAI,CAACuH,KAAK,CAACwF,YAAY,EAAE;QACb/M,IAAI,CAACgP,QAAQ,CAACjS,CAAC,CAACkS,KAAK,CAAC,CAAC,CAAC,EAAElS,CAAC,CAACkS,KAAK,CAAC,CAAC,CAAC,EAAElS,CAAC,CAACkS,KAAK,CAAC,CAAC,CAAC,CAAC;QAEjD,IAAIjP,IAAI,CAAC2jC,cAAc,EAAE;UAAE;UACvB3jC,IAAI,CAAC2jC,cAAc,CAAC5mC,CAAC,CAACkS,KAAK,CAAC;QAChC;QACAjP,IAAI,CAAC6L,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;QAC3C7L,IAAI,CAACuH,KAAK,CAACgG,WAAW,EAAE;MAChB;IACJ;IAEA,OAAO,KAAK;EAChB,CAAC;EAEDjG,YAAY,CAACs8B,2BAA2B,GAAG,UACvC7mC,CAAC,EACDgD,OAAO,EACPtN,CAAC,EACDsvC,SAAS,EACT/hC,IAAI,EACN;IACE,IAAI,CAACA,IAAI,EAAE;MACP;IACJ;IAEA,IAAImD,IAAI,GAAG,IAAI;IACf,IAAIgK,MAAM,GAAG7F,YAAY,CAAC4jB,aAAa;IACvC,IAAInC,UAAU,GAAG5b,MAAM,CAAC6b,eAAe,EAAE;IAEzC,IAAIjpB,OAAO,GAAGC,IAAI,CAAC6jC,gBAAgB;IACnC,IAAI7jC,IAAI,CAAC8jC,YAAY,EAAE;MACnB/jC,OAAO,GAAGC,IAAI,CAAC8jC,YAAY,EAAE;IACjC;IAEA,IAAI3B,OAAO,GAAG,EAAE;IAChB,IAAIpiC,OAAO,EAAE;MACT,KAAK,IAAIhM,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAGgM,OAAO,CAAC1M,MAAM,EAAEU,CAAC,EAAE,EAAE;QACnC,IAAI6tC,KAAK,GAAG7hC,OAAO,CAAChM,CAAC,CAAC;QACtB,IAAI,CAAC6tC,KAAK,EAAE;UACR;UACAO,OAAO,CAACnuC,IAAI,CAAC,IAAI,CAAC;UAClB;QACJ;QAEA,IACIgM,IAAI,CAACI,KAAK,IACVJ,IAAI,CAACI,KAAK,CAAC2jC,qBAAqB,IAChC/jC,IAAI,CAAC+V,cAAc,CAAC6rB,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EACrC;UACE;QACJ,CAAC,CAAC;QACF,IAAI7pB,KAAK,GAAG6pB,KAAK,CAAC,CAAC,CAAC;QAChC,IAAG,CAACA,KAAK,CAAC,CAAC,CAAC,EACXA,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;QACF,IAAIA,KAAK,CAAC,CAAC,CAAC,CAAC7pB,KAAK,EAAE;UAChBA,KAAK,GAAG6pB,KAAK,CAAC,CAAC,CAAC,CAAC7pB,KAAK;QAC1B;QACZ6pB,KAAK,CAAC,CAAC,CAAC,CAAC4B,SAAS,GAAG,IAAI;QACb,IAAI1gC,IAAI,GAAG;UAAE6/B,OAAO,EAAE5qB,KAAK;UAAE9I,KAAK,EAAE2yB;QAAM,CAAC;QAC3C,IAAIA,KAAK,CAAC,CAAC,CAAC,IAAIhsC,SAAS,CAACyC,KAAK,EAAE;UAC7ByK,IAAI,CAACslB,SAAS,GAAG,OAAO;QAC5B;QACA+Z,OAAO,CAACnuC,IAAI,CAAC8O,IAAI,CAAC;MACtB;IACJ;IAEA,IAAI,IAAI,CAACkhC,iBAAiB,EAAE;MACxB7B,OAAO,GAAG,IAAI,CAAC6B,iBAAiB,CAAC7B,OAAO,CAAC;IAC7C;IACA,IAAIvsC,SAAS,CAAC4F,qBAAqB,EAAC;MAAE;MAClC,IAAIwE,IAAI,CAAC+V,cAAc,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,EAAC;QACxCosB,OAAO,CAACnuC,IAAI,CAAC;UAAC2uC,OAAO,EAAE,aAAa;UAAE1zB,KAAK,EAAE,CAAC,YAAY,EAAErZ,SAAS,CAACyC,KAAK,EAAE;YAACwd,UAAU,EAAE;UAAI,CAAC,CAAC;UAAEuS,SAAS,EAAE;QAAO,CAAC,CAAC,CAAC,CAAC;MAC5H;IACJ;IACA;IACA,IAAIpoB,IAAI,CAACgkC,iBAAiB,EAAE;MACxB,IAAIN,UAAU,GAAG1jC,IAAI,CAACgkC,iBAAiB,CAAC7B,OAAO,CAAC;MAChD,IAAGuB,UAAU,EAAEvB,OAAO,GAAGuB,UAAU;IACvC;IAEA,IAAI,CAACvB,OAAO,CAAC9uC,MAAM,EAAE;MACjB;IACJ;IAEA,IAAIutC,IAAI,GAAG,IAAIhrC,SAAS,CAACirC,WAAW,CAChCsB,OAAO,EACP;MACI5vB,KAAK,EAAE9f,CAAC;MACR4f,QAAQ,EAAEouB,aAAa;MACvByC,UAAU,EAAEnB,SAAS;MACrB/hC,IAAI,EAAEA;IACV,CAAC,EACD+oB,UAAU,CACb;IAED,SAAS0X,aAAa,CAAC1jC,CAAC,EAAEtK,CAAC,EAAEiK,IAAI,EAAE;MAC/B,IAAI,CAACsD,IAAI,EAAE;QACP;MACJ;MAEA,IAAIjD,CAAC,CAACsV,QAAQ,EAAE;QACZtV,CAAC,CAACsV,QAAQ,CAACxf,IAAI,CAACsQ,IAAI,EAAEnD,IAAI,EAAEjD,CAAC,EAAEtK,CAAC,EAAEiK,IAAI,CAAC;MAC3C;MAEA,IAAI,CAACK,CAAC,CAACkS,KAAK,EAAE;QACV;MACJ;MAEA,IAAIA,KAAK,GAAGlS,CAAC,CAACkS,KAAK,CAAC,CAAC,CAAC;MAEtB,IACIA,KAAK,KACJA,KAAK,CAACzR,WAAW,KAAKb,MAAM,IAAIsS,KAAK,CAACzR,WAAW,KAAK3J,KAAK,CAAC,EAC/D;QACE;QACA,IAAIsuC,OAAO,GAAG,EAAE;QAChB,KAAK,IAAIpuC,CAAC,IAAIkb,KAAK,EAAE;UACjBkzB,OAAO,CAACnuC,IAAI,CAAC;YAAE2uC,OAAO,EAAE5uC,CAAC;YAAEkb,KAAK,EAAEA,KAAK,CAAClb,CAAC;UAAE,CAAC,CAAC;QACjD;QACA,IAAI6B,SAAS,CAACirC,WAAW,CAACsB,OAAO,EAAE;UAC/B5vB,KAAK,EAAE9f,CAAC;UACR4f,QAAQ,EAAEouB,aAAa;UACvByC,UAAU,EAAEnB,SAAS;UACrB/hC,IAAI,EAAEA;QACV,CAAC,CAAC;QACF,OAAO,KAAK;MAChB,CAAC,MAAM;QACfA,IAAI,CAACuH,KAAK,CAACwF,YAAY,EAAE;QACb/M,IAAI,CAAC4P,SAAS,CAAC7S,CAAC,CAACkS,KAAK,CAAC,CAAC,CAAC,EAAElS,CAAC,CAACkS,KAAK,CAAC,CAAC,CAAC,EAAElS,CAAC,CAACkS,KAAK,CAAC,CAAC,CAAC,CAAC;QAElD,IAAIjP,IAAI,CAACikC,eAAe,EAAE;UAAE;UACxBjkC,IAAI,CAACikC,eAAe,CAAClnC,CAAC,CAACkS,KAAK,CAAC;QACjC;QACAjP,IAAI,CAAC6L,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;QAC3C7L,IAAI,CAACuH,KAAK,CAACgG,WAAW,EAAE;MAChB;IACJ;IAEA,OAAO,KAAK;EAChB,CAAC;EAEDjG,YAAY,CAAC48B,wBAAwB,GAAG,UACpCj1B,KAAK,EACLlP,OAAO,EACPtN,CAAC,EACDsvC,SAAS,EACT/hC,IAAI,EACN;IACE,IAAI,CAACA,IAAI,IAAI,CAACA,IAAI,CAACnB,UAAU,EAAE;MAC3B;IACJ;IAEA,IAAIsE,IAAI,GAAG,IAAI;IACf,IAAIgK,MAAM,GAAG7F,YAAY,CAAC4jB,aAAa;IACvC,IAAInC,UAAU,GAAG5b,MAAM,CAAC6b,eAAe,EAAE;IAEzC,IAAImZ,OAAO,GAAG,EAAE;IAChB,KAAK,IAAIpuC,CAAC,IAAIiM,IAAI,CAACnB,UAAU,EAAE;MAC3B,IAAIoQ,KAAK,GAAGjP,IAAI,CAACnB,UAAU,CAAC9K,CAAC,CAAC,KAAKmY,SAAS,GAAGlM,IAAI,CAACnB,UAAU,CAAC9K,CAAC,CAAC,GAAG,GAAG;MAChF,IAAI,QAAOkb,KAAK,KAAI,QAAQ,EAC3BA,KAAK,GAAG/P,IAAI,CAACC,SAAS,CAAC8P,KAAK,CAAC;MAC9B,IAAIuB,IAAI,GAAGxQ,IAAI,CAACsY,eAAe,CAACvkB,CAAC,CAAC;MAClC,IAAGyc,IAAI,CAAC1U,IAAI,IAAI,MAAM,IAAI0U,IAAI,CAAC1U,IAAI,IAAI,OAAO,EAC7CmT,KAAK,GAAG3H,YAAY,CAAC68B,yBAAyB,CAAEl1B,KAAK,EAAEuB,IAAI,CAACmI,MAAM,CAAE;;MAE5D;MACA1J,KAAK,GAAG3H,YAAY,CAAC88B,UAAU,CAACn1B,KAAK,CAAC;MACtCkzB,OAAO,CAACnuC,IAAI,CAAC;QACT2uC,OAAO,EACH,8BAA8B,IAC7BnyB,IAAI,CAACuH,KAAK,GAAGvH,IAAI,CAACuH,KAAK,GAAGhkB,CAAC,CAAC,GAC7B,SAAS,GACT,+BAA+B,GAC/Bkb,KAAK,GACL,SAAS;QACbA,KAAK,EAAElb;MACX,CAAC,CAAC;IACN;IACA,IAAI,CAACouC,OAAO,CAAC9uC,MAAM,EAAE;MACjB;IACJ;IAEA,IAAIutC,IAAI,GAAG,IAAIhrC,SAAS,CAACirC,WAAW,CAChCsB,OAAO,EACP;MACI5vB,KAAK,EAAE9f,CAAC;MACR4f,QAAQ,EAAEouB,aAAa;MACvByC,UAAU,EAAEnB,SAAS;MACrBsC,UAAU,EAAE,IAAI;MAChBrkC,IAAI,EAAEA;IACV,CAAC,EACD+oB,UAAU,CACb;IAED,SAAS0X,aAAa,CAAC1jC,CAAC,EAAEgD,OAAO,EAAEtN,CAAC,EAAEiK,IAAI,EAAE;MACxC,IAAI,CAACsD,IAAI,EAAE;QACP;MACJ;MACA,IAAIyf,IAAI,GAAG,IAAI,CAACC,qBAAqB,EAAE;MACvCvS,MAAM,CAACm3B,qBAAqB,CAACtkC,IAAI,EAAEjD,CAAC,CAACkS,KAAK,EAAE;QACxCyf,QAAQ,EAAE,CAACjP,IAAI,CAACG,IAAI,EAAEH,IAAI,CAACK,GAAG;MAClC,CAAC,CAAC;IACN;IAEA,OAAO,KAAK;EAChB,CAAC;EAEDxY,YAAY,CAAC88B,UAAU,GAAG,UAASG,GAAG,EAAE;IACpC,IAAI9xC,CAAC,GAAG4O,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;IACrCpP,CAAC,CAAC+xC,SAAS,GAAGD,GAAG;IACjB,OAAO9xC,CAAC,CAACgyC,SAAS;EACtB,CAAC;EAEDn9B,YAAY,CAACo9B,gBAAgB,GAAG,UAASz1B,KAAK,EAAElP,OAAO,EAAEtN,CAAC,EAAEmuC,IAAI,EAAE5gC,IAAI,EAAE;IACpE,IAAI,CAACA,IAAI,EAAE;MACP;IACJ;IAEN,IAAI2kC,eAAe,GAAG,SAAlBA,eAAe,CAAY3kC,IAAI,EAAC;MACnCA,IAAI,CAACK,IAAI,GAAGL,IAAI,CAACM,WAAW,EAAE;MAC9B,IAAIN,IAAI,CAACgX,QAAQ,EAChBhX,IAAI,CAACgX,QAAQ,CAAChX,IAAI,CAACK,IAAI,CAAC;IAC1B,CAAC;IAED,IAAIgH,WAAW,GAAGC,YAAY,CAAC4jB,aAAa;IAC5C,IAAI,CAAC7jB,WAAW,CAAC+F,cAAc,IAAIzQ,MAAM,CAACmyB,IAAI,CAACznB,WAAW,CAAC+F,cAAc,CAAC,CAAC/Z,MAAM,IAAI,CAAC,EAAC;MACtFsxC,eAAe,CAAC3kC,IAAI,CAAC;IACtB,CAAC,MAAI;MACJ,KAAK,IAAIjM,CAAC,IAAIsT,WAAW,CAAC+F,cAAc,EAAE;QACzCu3B,eAAe,CAACt9B,WAAW,CAAC+F,cAAc,CAACrZ,CAAC,CAAC,CAAC;MAC/C;IACD;IAEMiM,IAAI,CAAC6L,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;EACnC,CAAC;EAEDvE,YAAY,CAACnT,SAAS,CAACu5B,YAAY,GAAG,UAAS7jB,IAAI,EAAEpX,CAAC,EAAE;IACpD,IAAI0Q,IAAI,GAAG,IAAI;IACrB;IACA,IAAIyhC,SAAS,GAAGzhC,IAAI,CAACoE,KAAK,CAAC4C,WAAW,CAAEN,IAAI,CAACoJ,SAAS,CAAE;IACxD,IAAI4xB,UAAU,GAAG1hC,IAAI,CAACoE,KAAK,CAAC4C,WAAW,CAAEN,IAAI,CAACO,SAAS,CAAE;IACzD,IAAI06B,QAAQ,GAAG,KAAK;IACpB,IAAIF,SAAS,IAAIA,SAAS,CAAC39B,OAAO,IAAI29B,SAAS,CAAC39B,OAAO,CAAC4C,IAAI,CAACqJ,WAAW,CAAC,EAAE4xB,QAAQ,GAAGF,SAAS,CAAC39B,OAAO,CAAC4C,IAAI,CAACqJ,WAAW,CAAC,CAACpX,IAAI;IACxH,IAAIipC,QAAQ,GAAG,KAAK;IAC1B,IAAIF,UAAU,IAAIA,UAAU,CAAC59B,OAAO,IAAI49B,UAAU,CAAC59B,OAAO,CAAC4C,IAAI,CAACyH,WAAW,CAAC,EAAEyzB,QAAQ,GAAGF,UAAU,CAAC79B,MAAM,CAAC6C,IAAI,CAACyH,WAAW,CAAC,CAACxV,IAAI;IAEjI,IAAIiE,OAAO,GAAG,CAAC,UAAU,EAAC,IAAI,EAAC,QAAQ,EAAC,IAAI,CAAC;IAGvC,IAAI6gC,IAAI,GAAG,IAAIhrC,SAAS,CAACirC,WAAW,CAAC9gC,OAAO,EAAE;MAC1CwS,KAAK,EAAE9f,CAAC;MACjB4B,KAAK,EAAEwV,IAAI,CAAC/G,IAAI,IAAI,IAAI,GAAG+G,IAAI,CAAC/G,IAAI,CAACtF,WAAW,CAACnI,IAAI,GAAG,IAAI;MACnDgd,QAAQ,EAAEouB;IACd,CAAC,CAAC;IAEF,SAASA,aAAa,CAAC1jC,CAAC,EAACgD,OAAO,EAACtN,CAAC,EAAE;MAChC,QAAQsK,CAAC;QACL,KAAK,UAAU;UAC1BuK,YAAY,CAACw6B,SAAS,CAAC,IAAI,EAAE,IAAI,EAAErvC,CAAC,EAAEmuC,IAAI,EAAE,UAAS5gC,IAAI,EAAC;YACzD;YACA,IAAG,CAACA,IAAI,CAACgH,MAAM,IAAI,CAAChH,IAAI,CAACgH,MAAM,CAAC3T,MAAM,IAAI,CAAC2M,IAAI,CAACiH,OAAO,IAAI,CAACjH,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAC;cAC/E;YACD;YACA;YACA,IAAIuxC,SAAS,CAACjqB,aAAa,CAAE9Q,IAAI,CAACqJ,WAAW,EAAElT,IAAI,EAAE8kC,QAAQ,CAAE,EAAC;cAC7C9kC,IAAI,CAAC2a,aAAa,CAAE9Q,IAAI,CAACyH,WAAW,EAAEuzB,UAAU,EAAEE,QAAQ,CAAE;cACzD/kC,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,IAAI2D,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG;YACrC;UACnB,CAAC,CAAC;UACF;QAEW,KAAK,QAAQ;UACT8C,IAAI,CAACoE,KAAK,CAAC8J,UAAU,CAACxH,IAAI,CAACF,EAAE,CAAC;UAC9B;QACJ;QACX;AACL;AACA;AACA;AACA;AACA;AACA;AACA;MAPK;IASG;;IAEA,OAAO,KAAK;EAChB,CAAC;EAEHrC,YAAY,CAACnT,SAAS,CAACk6B,wBAAwB,GAAG,UAAS2W,OAAO,EAAE;IAAE;IAChE,IAAIA,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;IAC3B,IAAInrB,IAAI,GAAGld,MAAM,CAACmd,MAAM,CAAC;MAAIwU,QAAQ,EAAE,IAAI,CAAC;MAAA;MACfC,QAAQ,EAAE,IAAI,CAAC;MAAA;MACfC,MAAM,EAAE,IAAI,CAAG;MAAA;MACfC,MAAM,EAAE,IAAI,CAAG;MAAA;MACfC,QAAQ,EAAE,EAAE,CAAC;MAAA;MACtCC,QAAQ,EAAE,IAAI,CAAC;MAAA;MACfC,MAAM,EAAC,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;MAAA;MACbC,UAAU,EAAC,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;IACG,CAAC,EACAmW,OAAO,CACX;IACrB,IAAI7hC,IAAI,GAAG,IAAI;IAEf,IAAI8hC,MAAM,GAAGprB,IAAI,CAACyU,QAAQ,IAAIzU,IAAI,CAAC0U,QAAQ,KAAG,IAAI;IAClD,IAAI2W,IAAI,GAAG,CAACD,MAAM,IAAIprB,IAAI,CAAC2U,MAAM,IAAI3U,IAAI,CAAC4U,MAAM,KAAG,IAAI;IAEvD,IAAI,CAACwW,MAAM,IAAI,CAACC,IAAI,EAAC;MACjBlpC,OAAO,CAACqB,IAAI,CAAC,6CAA6C,GAACwc,IAAI,CAACyU,QAAQ,GAAC,GAAG,GAACzU,IAAI,CAAC0U,QAAQ,GAAC,GAAG,GAAC1U,IAAI,CAAC2U,MAAM,GAAC,GAAG,GAAC3U,IAAI,CAAC4U,MAAM,CAAC;MAC3H,OAAO,KAAK;IAChB;IACN,IAAI,CAAC5U,IAAI,CAAC8U,QAAQ,EAAC;MACT3yB,OAAO,CAACqB,IAAI,CAAC,qCAAqC,CAAC;MACnD,OAAO,KAAK;IAChB;IAEA,IAAImzB,KAAK,GAAGyU,MAAM,GAAGprB,IAAI,CAACyU,QAAQ,GAAGzU,IAAI,CAAC2U,MAAM;IAChD,IAAI2W,KAAK,GAAGF,MAAM,GAAGprB,IAAI,CAAC0U,QAAQ,GAAG1U,IAAI,CAAC4U,MAAM;IAEhD,IAAI2W,SAAS,GAAG,KAAK;IACrB,gBAAeD,KAAK;MAChB,KAAK,QAAQ;QACTC,SAAS,GAAGH,MAAM,GAAGzU,KAAK,CAACza,cAAc,CAACovB,KAAK,EAAC,KAAK,CAAC,GAAG3U,KAAK,CAACzb,aAAa,CAACowB,KAAK,EAAC,KAAK,CAAC;QACzFA,KAAK,GAAGF,MAAM,GAAGzU,KAAK,CAACvpB,OAAO,CAACk+B,KAAK,CAAC,GAAG3U,KAAK,CAACxpB,MAAM,CAACm+B,KAAK,CAAC;QAC/D;MACA,KAAK,QAAQ;QACT;QACAC,SAAS,GAAGH,MAAM,GAAGzU,KAAK,CAACza,cAAc,CAACovB,KAAK,CAAC9vC,IAAI,CAAC,GAAGm7B,KAAK,CAACzb,aAAa,CAACowB,KAAK,CAAC9vC,IAAI,CAAC;QAC3F;MACA,KAAK,QAAQ;QACT+vC,SAAS,GAAGD,KAAK;QACjBA,KAAK,GAAGF,MAAM,GAAGzU,KAAK,CAACvpB,OAAO,CAACk+B,KAAK,CAAC,GAAG3U,KAAK,CAACxpB,MAAM,CAACm+B,KAAK,CAAC;QAC/D;MACT,KAAK,WAAW;MACP;QACI;QACA;QACAnpC,OAAO,CAACqB,IAAI,CAAC,4BAA4B,GAAC8nC,KAAK,CAAC;QAChD,OAAO,KAAK;IAAC;IAG3B,IAAIA,KAAK,KAAG,KAAK,IAAIC,SAAS,KAAG,KAAK,EAAC;MACtCppC,OAAO,CAACqB,IAAI,CAAC,qCAAqC,GAAC8nC,KAAK,GAAC,GAAG,GAACC,SAAS,CAAC;IACxE;;IAEA;IACA,IAAIC,YAAY,GAAGF,KAAK,CAACrpC,IAAI,IAAElG,SAAS,CAACyC,KAAK,GAAC,SAAS,GAAC8sC,KAAK,CAACrpC,IAAI;IACnE,IAAIwpC,gBAAgB,GAAGL,MAAM,GAAGrvC,SAAS,CAAC0F,sBAAsB,GAAG1F,SAAS,CAACyF,qBAAqB;IAClG,IAAGiqC,gBAAgB,IAAIA,gBAAgB,CAACD,YAAY,CAAC,EAAC;MACrD,IAAIF,KAAK,CAACt7B,IAAI,KAAK,IAAI,EAAE;QACxB;MAAA,CACA,MAAI;QACJ;MAAA;MAED07B,WAAW,GAAG,KAAK;MACnB,IAAG,QAAOD,gBAAgB,CAACD,YAAY,CAAC,KAAI,QAAQ,IAAI,OAAOC,gBAAgB,CAACD,YAAY,CAAC,IAAI,OAAO,EAAC;QACxG,KAAI,IAAIG,KAAK,IAAIF,gBAAgB,CAACD,YAAY,CAAC,EAAC;UAC/C,IAAIxrB,IAAI,CAAC8U,QAAQ,IAAI2W,gBAAgB,CAACD,YAAY,CAAC,CAACG,KAAK,CAAC,IAAI3rB,IAAI,CAAC8U,QAAQ,IAAI,MAAM,EAAC;YACrF4W,WAAW,GAAGD,gBAAgB,CAACD,YAAY,CAAC,CAACG,KAAK,CAAC;YACnD;YACA,MAAM,CAAC;UACR;QACD;MACD,CAAC,MAAI;QACJ,IAAI3rB,IAAI,CAAC8U,QAAQ,IAAI2W,gBAAgB,CAACD,YAAY,CAAC,IAAIxrB,IAAI,CAAC8U,QAAQ,IAAI,MAAM,EAAE4W,WAAW,GAAGD,gBAAgB,CAACD,YAAY,CAAC;MAC7H;MACA,IAAIE,WAAW,EAAE;QAChB,IAAIE,WAAW,GAAG,KAAK;QACvB,IAAI,QAAOF,WAAW,yCAAXA,WAAW,MAAI,QAAQ,IAAIA,WAAW,CAACvlC,IAAI,EAAC;UACtDylC,WAAW,GAAGF,WAAW;UACzBA,WAAW,GAAGA,WAAW,CAACvlC,IAAI;QAC/B;;QAEA;;QAEA,IAAI0lC,OAAO,GAAG9vC,SAAS,CAACkK,UAAU,CAACylC,WAAW,CAAC;QAC/C,IAAGG,OAAO,EAAC;UACV;UACA,IAAID,WAAW,EAAC;YACf,IAAIA,WAAW,CAAC5mC,UAAU,EAAE;cAC3B,KAAK,IAAI9K,CAAC,IAAI0xC,WAAW,CAAC5mC,UAAU,EAAE;gBACrC6mC,OAAO,CAACzuB,WAAW,CAAEljB,CAAC,EAAE0xC,WAAW,CAAC5mC,UAAU,CAAC9K,CAAC,CAAC,CAAE;cACpD;YACD;YACA,IAAI0xC,WAAW,CAACz+B,MAAM,EAAE;cACvB0+B,OAAO,CAAC1+B,MAAM,GAAG,EAAE;cACnB,KAAK,IAAIjT,CAAC,IAAI0xC,WAAW,CAACz+B,MAAM,EAAE;gBACjC0+B,OAAO,CAAC91B,SAAS,CAChB61B,WAAW,CAACz+B,MAAM,CAACjT,CAAC,CAAC,CAAC,CAAC,CAAC,EACxB0xC,WAAW,CAACz+B,MAAM,CAACjT,CAAC,CAAC,CAAC,CAAC,CAAC,CACxB;cACF;YACD;YACA,IAAI0xC,WAAW,CAACx+B,OAAO,EAAE;cACxBy+B,OAAO,CAACz+B,OAAO,GAAG,EAAE;cACpB,KAAK,IAAIlT,CAAC,IAAI0xC,WAAW,CAACx+B,OAAO,EAAE;gBAClCy+B,OAAO,CAAC91B,SAAS,CAChB61B,WAAW,CAACx+B,OAAO,CAAClT,CAAC,CAAC,CAAC,CAAC,CAAC,EACzB0xC,WAAW,CAACx+B,OAAO,CAAClT,CAAC,CAAC,CAAC,CAAC,CAAC,CACzB;cACF;YACD;YACA,IAAI0xC,WAAW,CAACpxC,KAAK,EAAE;cACtBqxC,OAAO,CAACrxC,KAAK,GAAGoxC,WAAW,CAACpxC,KAAK;YAClC;YACA,IAAIoxC,WAAW,CAAC/hC,IAAI,EAAE;cACrBgiC,OAAO,CAAC1gC,SAAS,CAACygC,WAAW,CAAC/hC,IAAI,CAAC;YACpC;UAED;;UAEA;UACAP,IAAI,CAACoE,KAAK,CAAC8E,GAAG,CAACq5B,OAAO,CAAC;UACvBA,OAAO,CAACrpC,GAAG,GAAG,CAAEwd,IAAI,CAAC6U,QAAQ,CAAC,CAAC,CAAC,GAAC7U,IAAI,CAAC+U,MAAM,CAAC,CAAC,CAAC,IAAE/U,IAAI,CAACgV,UAAU,CAAC,CAAC,CAAC,GAAChV,IAAI,CAACgV,UAAU,CAAC,CAAC,CAAC,GAAC6W,OAAO,CAACrlC,IAAI,CAAC,CAAC,CAAC,GAAC,CAAC,CAAC,EACjGwZ,IAAI,CAAC6U,QAAQ,CAAC,CAAC,CAAC,GAAC7U,IAAI,CAAC+U,MAAM,CAAC,CAAC,CAAC,IAAE/U,IAAI,CAACgV,UAAU,CAAC,CAAC,CAAC,GAAChV,IAAI,CAACgV,UAAU,CAAC,CAAC,CAAC,GAAC6W,OAAO,CAACrlC,IAAI,CAAC,CAAC,CAAC,GAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;UAEpG;;UAEA;UACA,IAAI4kC,MAAM,EAAC;YACVprB,IAAI,CAACyU,QAAQ,CAAC3T,aAAa,CAAEyqB,SAAS,EAAEM,OAAO,EAAEL,YAAY,CAAE;UAChE,CAAC,MAAI;YACJxrB,IAAI,CAAC2U,MAAM,CAACtT,mBAAmB,CAAEkqB,SAAS,EAAEM,OAAO,EAAEL,YAAY,CAAE;UACpE;;UAEA;UACA,IAAIJ,MAAM,IAAIC,IAAI,EAAC;YAClB;UAAA;UAGD,OAAO,IAAI;QAEZ,CAAC,MAAI;UACJlpC,OAAO,CAACC,GAAG,CAAC,kBAAkB,GAACspC,WAAW,CAAC;QAC5C;MACD;IACD;IACA,OAAO,KAAK;EACb,CAAC;EAEEj+B,YAAY,CAACnT,SAAS,CAAC68B,kBAAkB,GAAG,UAASgU,OAAO,EAAE;IAAE;IAC5D,IAAIA,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;IAC3B,IAAInrB,IAAI,GAAGld,MAAM,CAACmd,MAAM,CAAC;MAAIwU,QAAQ,EAAE,IAAI,CAAE;MAAA;MAChBC,QAAQ,EAAE,IAAI,CAAC;MAAA;MACfC,MAAM,EAAE,IAAI,CAAG;MAAA;MACfC,MAAM,EAAE,IAAI,CAAG;MAAA;MACfh8B,CAAC,EAAE;IACR,CAAC,EACAuyC,OAAO,CACX;IACrB,IAAI7hC,IAAI,GAAG,IAAI;IAEf,IAAI8hC,MAAM,GAAGprB,IAAI,CAACyU,QAAQ,IAAIzU,IAAI,CAAC0U,QAAQ;IAC3C,IAAI2W,IAAI,GAAG,CAACD,MAAM,IAAIprB,IAAI,CAAC2U,MAAM,IAAI3U,IAAI,CAAC4U,MAAM;IAEhD,IAAI,CAACwW,MAAM,IAAI,CAACC,IAAI,EAAC;MACjBlpC,OAAO,CAACqB,IAAI,CAAC,sCAAsC,CAAC;MACpD,OAAO,KAAK;IAChB;IAEA,IAAImzB,KAAK,GAAGyU,MAAM,GAAGprB,IAAI,CAACyU,QAAQ,GAAGzU,IAAI,CAAC2U,MAAM;IAChD,IAAI2W,KAAK,GAAGF,MAAM,GAAGprB,IAAI,CAAC0U,QAAQ,GAAG1U,IAAI,CAAC4U,MAAM;IAEhD,IAAI2W,SAAS,GAAG,KAAK;IACrB,gBAAeD,KAAK;MAChB,KAAK,QAAQ;QACTC,SAAS,GAAGH,MAAM,GAAGzU,KAAK,CAACza,cAAc,CAACovB,KAAK,EAAC,KAAK,CAAC,GAAG3U,KAAK,CAACzb,aAAa,CAACowB,KAAK,EAAC,KAAK,CAAC;QACzFA,KAAK,GAAGF,MAAM,GAAGzU,KAAK,CAACvpB,OAAO,CAACk+B,KAAK,CAAC,GAAG3U,KAAK,CAACxpB,MAAM,CAACm+B,KAAK,CAAC;QAC/D;MACA,KAAK,QAAQ;QACT;QACAC,SAAS,GAAGH,MAAM,GAAGzU,KAAK,CAACza,cAAc,CAACovB,KAAK,CAAC9vC,IAAI,CAAC,GAAGm7B,KAAK,CAACzb,aAAa,CAACowB,KAAK,CAAC9vC,IAAI,CAAC;QAC3F;MACA,KAAK,QAAQ;QACT+vC,SAAS,GAAGD,KAAK;QACjBA,KAAK,GAAGF,MAAM,GAAGzU,KAAK,CAACvpB,OAAO,CAACk+B,KAAK,CAAC,GAAG3U,KAAK,CAACxpB,MAAM,CAACm+B,KAAK,CAAC;QAC/D;MACA;QACI;QACA;QACAnpC,OAAO,CAACqB,IAAI,CAAC,4BAA4B,GAAC8nC,KAAK,CAAC;QAChD,OAAO,KAAK;IAAC;IAG3B,IAAIplC,OAAO,GAAG,CAAC,UAAU,EAAC,IAAI,CAAC;IAE/B,IAAIoD,IAAI,CAACqgB,eAAe,EAAC;MACxBzjB,OAAO,CAAC/L,IAAI,CAAC,QAAQ,CAAC;MACtB+L,OAAO,CAAC/L,IAAI,CAAC,IAAI,CAAC;IACnB;;IAEA;IACA,IAAIqxC,YAAY,GAAGF,KAAK,CAACrpC,IAAI,IAAElG,SAAS,CAACyC,KAAK,GAAC,SAAS,GAAC8sC,KAAK,CAACrpC,IAAI;IACnE,IAAIwpC,gBAAgB,GAAGL,MAAM,GAAGrvC,SAAS,CAAC0F,sBAAsB,GAAG1F,SAAS,CAACyF,qBAAqB;IAClG,IAAGiqC,gBAAgB,IAAIA,gBAAgB,CAACD,YAAY,CAAC,EAAC;MACrD,IAAG,QAAOC,gBAAgB,CAACD,YAAY,CAAC,KAAI,QAAQ,IAAI,OAAOC,gBAAgB,CAACD,YAAY,CAAC,IAAI,OAAO,EAAC;QACxG,KAAI,IAAIG,KAAK,IAAIF,gBAAgB,CAACD,YAAY,CAAC,EAAC;UAC/CtlC,OAAO,CAAC/L,IAAI,CAACsxC,gBAAgB,CAACD,YAAY,CAAC,CAACG,KAAK,CAAC,CAAC;QACpD;MACD,CAAC,MAAI;QACJzlC,OAAO,CAAC/L,IAAI,CAACsxC,gBAAgB,CAACD,YAAY,CAAC,CAAC;MAC7C;IACD;;IAEA;IACM,IAAIzE,IAAI,GAAG,IAAIhrC,SAAS,CAACirC,WAAW,CAAC9gC,OAAO,EAAE;MAC1CwS,KAAK,EAAEsH,IAAI,CAACpnB,CAAC;MACtB4B,KAAK,EAAE,CAAC8wC,KAAK,IAAIA,KAAK,CAAC9vC,IAAI,IAAE,EAAE,GAAI8vC,KAAK,CAAC9vC,IAAI,IAAIgwC,YAAY,GAAC,KAAK,GAAC,EAAE,CAAC,GAAI,EAAE,KAAGF,KAAK,IAAIE,YAAY,GAAGA,YAAY,GAAG,EAAE,CAAC;MACjHhzB,QAAQ,EAAEouB;IACd,CAAC,CAAC;;IAER;IACM,SAASA,aAAa,CAAC1jC,CAAC,EAACgD,OAAO,EAACtN,CAAC,EAAE;MAChC;MACA,QAAQsK,CAAC;QACL,KAAK,UAAU;UACXuK,YAAY,CAACw6B,SAAS,CAAC,IAAI,EAAE,IAAI,EAAErvC,CAAC,EAAEmuC,IAAI,EAAE,UAAS5gC,IAAI,EAAC;YACtD,IAAIilC,MAAM,EAAC;cACPprB,IAAI,CAACyU,QAAQ,CAAC3T,aAAa,CAAEyqB,SAAS,EAAEplC,IAAI,EAAEqlC,YAAY,CAAE;YAChE,CAAC,MAAI;cACDxrB,IAAI,CAAC2U,MAAM,CAACtT,mBAAmB,CAAEkqB,SAAS,EAAEplC,IAAI,EAAEqlC,YAAY,CAAE;YACpE;UACJ,CAAC,CAAC;UACF;QAChB,KAAK,QAAQ;UACZ,IAAGJ,MAAM,EAAC;YACT9hC,IAAI,CAAC2qB,aAAa,CAACr7B,CAAC,EAAC;cAACk+B,SAAS,EAAE9W,IAAI,CAACyU,QAAQ;cAAEsC,SAAS,EAAEuU,KAAK;cAAEtU,cAAc,EAAEwU;YAAY,CAAC,CAAC;UACjG,CAAC,MAAI;YACJliC,IAAI,CAAC2qB,aAAa,CAACr7B,CAAC,EAAC;cAACq+B,OAAO,EAAEjX,IAAI,CAAC2U,MAAM;cAAEoC,SAAS,EAAEuU,KAAK;cAAEpU,eAAe,EAAEsU;YAAY,CAAC,CAAC;UAC9F;UACA;QACW;UACX;UACA,IAAIjX,WAAW,GAAGjrB,IAAI,CAACkrB,wBAAwB,CAAC1xB,MAAM,CAACmd,MAAM,CAACD,IAAI,EAAC;YAAE6U,QAAQ,EAAE,CAAC7U,IAAI,CAACpnB,CAAC,CAAC04B,OAAO,EAAEtR,IAAI,CAACpnB,CAAC,CAAC24B,OAAO,CAAC;YAC7FuD,QAAQ,EAAE5xB;UACZ,CAAC,CAAC,CAAC;UACnB,IAAIqxB,WAAW,EAAC;YACf;YACA;UAAA,CACA,MAAI;YACJ;UAAA;UAED;MAAM;IAEH;IAEA,OAAO,KAAK;EAChB,CAAC;;EAED;EACA9mB,YAAY,CAACq+B,oBAAoB,GAAG,UAASC,IAAI,EAAE7lC,OAAO,EAAEtN,CAAC,EAAEmuC,IAAI,EAAE5gC,IAAI,EAAE;IACvE,IAAI6lC,UAAU,GAAG,EAAE;IACnB,IAAIhyB,QAAQ,GAAG+xB,IAAI,CAAC/xB,QAAQ,IAAI,OAAO;IACvC,IAAI5E,KAAK,GAAGjP,IAAI,CAAC6T,QAAQ,CAAC;;IAE1B;;IAEA,IAAIiyB,MAAM,GAAGzkC,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;IAC1CikC,MAAM,CAACC,WAAW,GAAG,KAAK;IAC1BD,MAAM,CAAC1d,SAAS,GAAG,aAAa;IAChC0d,MAAM,CAACrB,SAAS,GACZ,2FAA2F;IAC/FqB,MAAM,CAACtU,KAAK,GAAG,YAAW;MACtB,IAAIsU,MAAM,CAAC1E,UAAU,EAAE;QACnB0E,MAAM,CAAC1E,UAAU,CAACr/B,WAAW,CAAC+jC,MAAM,CAAC;MACzC;IACJ,CAAC;IACD,IAAIzxC,KAAK,GAAGyxC,MAAM,CAAC/jB,aAAa,CAAC,OAAO,CAAC;IACzC1tB,KAAK,CAACmwC,SAAS,GAAG3wB,QAAQ;IAC1B,IAAI7I,KAAK,GAAG86B,MAAM,CAAC/jB,aAAa,CAAC,QAAQ,CAAC;IAC1C,IAAI/W,KAAK,EAAE;MACPA,KAAK,CAACiE,KAAK,GAAGA,KAAK;MACnBjE,KAAK,CAACsH,gBAAgB,CAAC,MAAM,EAAE,UAAS7f,CAAC,EAAE;QACvC,IAAI,CAACk5B,KAAK,EAAE;MAChB,CAAC,CAAC;MACF3gB,KAAK,CAACsH,gBAAgB,CAAC,SAAS,EAAE,UAAS7f,CAAC,EAAE;QAC1CqzC,MAAM,CAACC,WAAW,GAAG,IAAI;QACzB,IAAItzC,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;UACjB;UACAwU,MAAM,CAACtU,KAAK,EAAE;QAClB,CAAC,MAAM,IAAI/+B,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;UACxB0U,KAAK,EAAE,CAAC,CAAC;QACb,CAAC,MAAM,IAAIvzC,CAAC,CAAC6+B,OAAO,IAAI,EAAE,IAAI7+B,CAAC,CAACyP,MAAM,CAACsmB,SAAS,IAAI,UAAU,EAAE;UAC5D;QACJ;QACA/1B,CAAC,CAACsuB,cAAc,EAAE;QAClBtuB,CAAC,CAACuuB,eAAe,EAAE;MACvB,CAAC,CAAC;IACN;IAEA,IAAI3Z,WAAW,GAAGC,YAAY,CAAC4jB,aAAa;IAC5C,IAAI/d,MAAM,GAAG9F,WAAW,CAAC8F,MAAM;IAE/B,IAAIsS,IAAI,GAAGtS,MAAM,CAACuS,qBAAqB,EAAE;IACzC,IAAIumB,OAAO,GAAG,CAAC,EAAE;IACjB,IAAIxI,OAAO,GAAG,CAAC,EAAE;IACjB,IAAIhe,IAAI,EAAE;MACNwmB,OAAO,IAAIxmB,IAAI,CAACG,IAAI;MACpB6d,OAAO,IAAIhe,IAAI,CAACK,GAAG;IACvB;IAEA,IAAIvN,KAAK,EAAE;MACPuzB,MAAM,CAACtZ,KAAK,CAAC5M,IAAI,GAAGrN,KAAK,CAACoN,OAAO,GAAGsmB,OAAO,GAAG,IAAI;MAClDH,MAAM,CAACtZ,KAAK,CAAC1M,GAAG,GAAGvN,KAAK,CAACsN,OAAO,GAAG4d,OAAO,GAAG,IAAI;IACrD,CAAC,MAAM;MACHqI,MAAM,CAACtZ,KAAK,CAAC5M,IAAI,GAAGzS,MAAM,CAACgS,KAAK,GAAG,GAAG,GAAG8mB,OAAO,GAAG,IAAI;MACvDH,MAAM,CAACtZ,KAAK,CAAC1M,GAAG,GAAG3S,MAAM,CAACiS,MAAM,GAAG,GAAG,GAAGqe,OAAO,GAAG,IAAI;IAC3D;IAEA,IAAIyI,MAAM,GAAGJ,MAAM,CAAC/jB,aAAa,CAAC,QAAQ,CAAC;IAC3CmkB,MAAM,CAAC5zB,gBAAgB,CAAC,OAAO,EAAE0zB,KAAK,CAAC;IACvC74B,MAAM,CAACi0B,UAAU,CAACt/B,WAAW,CAACgkC,MAAM,CAAC;IAErC,IAAG96B,KAAK,EAAEA,KAAK,CAAC2gB,KAAK,EAAE;IAEvB,IAAIwa,gBAAgB,GAAG,IAAI;IAC3BL,MAAM,CAACxzB,gBAAgB,CAAC,YAAY,EAAE,UAAS7f,CAAC,EAAE;MAC9C,IAAGmD,SAAS,CAAC6E,2BAA2B,EACpC,IAAI,CAACqrC,MAAM,CAACC,WAAW,IAAInwC,SAAS,CAAC6E,2BAA2B,EAC5D0rC,gBAAgB,GAAG3zC,UAAU,CAACszC,MAAM,CAACtU,KAAK,EAAE57B,SAAS,CAAC8E,iCAAiC,CAAC,CAAC,CAAC;IACtG,CAAC,CAAC;;IACForC,MAAM,CAACxzB,gBAAgB,CAAC,YAAY,EAAE,UAAS7f,CAAC,EAAE;MAC9C,IAAGmD,SAAS,CAAC6E,2BAA2B,EACpC,IAAG0rC,gBAAgB,EAAEzzC,YAAY,CAACyzC,gBAAgB,CAAC;IAC3D,CAAC,CAAC;IAEF,SAASH,KAAK,GAAG;MACb,IAAGh7B,KAAK,EAAEo7B,QAAQ,CAACp7B,KAAK,CAACiE,KAAK,CAAC;IACnC;IAEA,SAASm3B,QAAQ,CAACn3B,KAAK,EAAE;MACrB,IAAI22B,IAAI,CAAC9pC,IAAI,IAAI,QAAQ,EAAE;QACvBmT,KAAK,GAAG+L,MAAM,CAAC/L,KAAK,CAAC;MACzB,CAAC,MAAM,IAAI22B,IAAI,CAAC9pC,IAAI,IAAI,SAAS,EAAE;QAC/BmT,KAAK,GAAGisB,OAAO,CAACjsB,KAAK,CAAC;MAC1B;MACAjP,IAAI,CAAC6T,QAAQ,CAAC,GAAG5E,KAAK;MACtB,IAAI62B,MAAM,CAAC1E,UAAU,EAAE;QACnB0E,MAAM,CAAC1E,UAAU,CAACr/B,WAAW,CAAC+jC,MAAM,CAAC;MACzC;MACA9lC,IAAI,CAAC6L,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;IACnC;EACJ,CAAC;;EAED;EACAvE,YAAY,CAACnT,SAAS,CAAC2sC,MAAM,GAAG,UAASzsC,KAAK,EAAE4a,KAAK,EAAEoD,QAAQ,EAAEE,KAAK,EAAEwuB,SAAS,EAAE;IAC/E,IAAI59B,IAAI,GAAG,IAAI;IACf,IAAI0iC,UAAU,GAAG,EAAE;IACnBxxC,KAAK,GAAGA,KAAK,IAAI,EAAE;IAEnB,IAAIyxC,MAAM,GAAGzkC,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;IAC1CikC,MAAM,CAACC,WAAW,GAAG,KAAK;IAC1BD,MAAM,CAAC1d,SAAS,GAAG,qBAAqB;IACxC,IAAG2Y,SAAS,EACX+E,MAAM,CAACrB,SAAS,GAAG,6GAA6G,CAAC,KAEjIqB,MAAM,CAACrB,SAAS,GAAG,4GAA4G;IAChIqB,MAAM,CAACtU,KAAK,GAAG,YAAW;MACtBruB,IAAI,CAACkjC,UAAU,GAAG,IAAI;MACtB,IAAIP,MAAM,CAAC1E,UAAU,EAAE;QACnB0E,MAAM,CAAC1E,UAAU,CAACr/B,WAAW,CAAC+jC,MAAM,CAAC;MACzC;IACJ,CAAC;IAED,IAAIz+B,WAAW,GAAGC,YAAY,CAAC4jB,aAAa;IAC5C,IAAI/d,MAAM,GAAG9F,WAAW,CAAC8F,MAAM;IAC/BA,MAAM,CAACi0B,UAAU,CAACt/B,WAAW,CAACgkC,MAAM,CAAC;IAErC,IAAI,IAAI,CAAC9jB,EAAE,CAAC5E,KAAK,GAAG,CAAC,EAAE;MACnB0oB,MAAM,CAACtZ,KAAK,CAAC8Z,SAAS,GAAG,QAAQ,GAAG,IAAI,CAACtkB,EAAE,CAAC5E,KAAK,GAAG,GAAG;IAC3D;IAEA,IAAI+oB,gBAAgB,GAAG,IAAI;IAC3B,IAAII,eAAe,GAAG,KAAK;IAC3B3wC,SAAS,CAACopB,kBAAkB,CAAC8mB,MAAM,EAAC,OAAO,EAAE,UAASrzC,CAAC,EAAE;MACrD,IAAI8zC,eAAe,EACf;MACJ,IAAG3wC,SAAS,CAAC6E,2BAA2B,EACpC,IAAI,CAACqrC,MAAM,CAACC,WAAW,IAAInwC,SAAS,CAAC6E,2BAA2B,EAC5D0rC,gBAAgB,GAAG3zC,UAAU,CAACszC,MAAM,CAACtU,KAAK,EAAE57B,SAAS,CAAC8E,iCAAiC,CAAC,CAAC,CAAC;IACtG,CAAC,CAAC;;IACF9E,SAAS,CAACopB,kBAAkB,CAAC8mB,MAAM,EAAC,OAAO,EAAE,UAASrzC,CAAC,EAAE;MACrD,IAAGmD,SAAS,CAAC6E,2BAA2B,EACpC,IAAG0rC,gBAAgB,EAAEzzC,YAAY,CAACyzC,gBAAgB,CAAC;IAC3D,CAAC,CAAC;IACF,IAAIK,QAAQ,GAAGV,MAAM,CAACW,gBAAgB,CAAC,QAAQ,CAAC;IAChD,IAAID,QAAQ,EAAC;MACT;MACAA,QAAQ,CAACE,OAAO,CAAC,UAASC,KAAK,EAAE;QAC7BA,KAAK,CAACr0B,gBAAgB,CAAC,OAAO,EAAE,UAAS7f,CAAC,EAAE;UACxC8zC,eAAe,EAAE;QACrB,CAAC,CAAC;QACFI,KAAK,CAACr0B,gBAAgB,CAAC,MAAM,EAAE,UAAS7f,CAAC,EAAE;UACxC8zC,eAAe,GAAG,CAAC;QACtB,CAAC,CAAC;QACFI,KAAK,CAACr0B,gBAAgB,CAAC,QAAQ,EAAE,UAAS7f,CAAC,EAAE;UACzC8zC,eAAe,GAAG,CAAC,CAAC;QACxB,CAAC,CAAC;MACN,CAAC,CAAC;IACN;IAEA,IAAIpjC,IAAI,CAACkjC,UAAU,EAAE;MACjBljC,IAAI,CAACkjC,UAAU,CAAC7U,KAAK,EAAE;IAC3B;IACAruB,IAAI,CAACkjC,UAAU,GAAGP,MAAM;IAExB,IAAIc,KAAK,GAAG,IAAI;IAChB,IAAIpzC,OAAO,GAAG,IAAI;IAClB,IAAI8nC,QAAQ,GAAG,IAAI;IAEnB,IAAIuL,YAAY,GAAGf,MAAM,CAAC/jB,aAAa,CAAC,OAAO,CAAC;IAChD8kB,YAAY,CAACrC,SAAS,GAAGnwC,KAAK;IAC9B,IAAIyyC,aAAa,GAAGhB,MAAM,CAAC/jB,aAAa,CAAC,QAAQ,CAAC;IAClD+kB,aAAa,CAAC73B,KAAK,GAAGA,KAAK;IAE3B,IAAIjE,KAAK,GAAG87B,aAAa;IACzB97B,KAAK,CAACsH,gBAAgB,CAAC,SAAS,EAAE,UAAS7f,CAAC,EAAE;MAC1CqzC,MAAM,CAACC,WAAW,GAAG,IAAI;MACzB,IAAItzC,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;QACjB;QACAwU,MAAM,CAACtU,KAAK,EAAE;MAClB,CAAC,MAAM,IAAI/+B,CAAC,CAAC6+B,OAAO,IAAI,EAAE,IAAI7+B,CAAC,CAACyP,MAAM,CAACsmB,SAAS,IAAI,UAAU,EAAE;QAC5D,IAAInW,QAAQ,EAAE;UACVA,QAAQ,CAAC,IAAI,CAACpD,KAAK,CAAC;QACxB;QACA62B,MAAM,CAACtU,KAAK,EAAE;MAClB,CAAC,MAAM;QACH;MACJ;MACA/+B,CAAC,CAACsuB,cAAc,EAAE;MAClBtuB,CAAC,CAACuuB,eAAe,EAAE;IACvB,CAAC,CAAC;IAEF,IAAIklB,MAAM,GAAGJ,MAAM,CAAC/jB,aAAa,CAAC,QAAQ,CAAC;IAC3CmkB,MAAM,CAAC5zB,gBAAgB,CAAC,OAAO,EAAE,UAAS7f,CAAC,EAAE;MACzC,IAAI4f,QAAQ,EAAE;QACVA,QAAQ,CAACrH,KAAK,CAACiE,KAAK,CAAC;MACzB;MACA9L,IAAI,CAACqkB,QAAQ,CAAC,IAAI,CAAC;MACnBse,MAAM,CAACtU,KAAK,EAAE;IAClB,CAAC,CAAC;IAEF,IAAI/R,IAAI,GAAGtS,MAAM,CAACuS,qBAAqB,EAAE;IACzC,IAAIumB,OAAO,GAAG,CAAC,EAAE;IACjB,IAAIxI,OAAO,GAAG,CAAC,EAAE;IACjB,IAAIhe,IAAI,EAAE;MACNwmB,OAAO,IAAIxmB,IAAI,CAACG,IAAI;MACpB6d,OAAO,IAAIhe,IAAI,CAACK,GAAG;IACvB;IAEA,IAAIvN,KAAK,EAAE;MACPuzB,MAAM,CAACtZ,KAAK,CAAC5M,IAAI,GAAGrN,KAAK,CAACoN,OAAO,GAAGsmB,OAAO,GAAG,IAAI;MAClDH,MAAM,CAACtZ,KAAK,CAAC1M,GAAG,GAAGvN,KAAK,CAACsN,OAAO,GAAG4d,OAAO,GAAG,IAAI;IACrD,CAAC,MAAM;MACHqI,MAAM,CAACtZ,KAAK,CAAC5M,IAAI,GAAGzS,MAAM,CAACgS,KAAK,GAAG,GAAG,GAAG8mB,OAAO,GAAG,IAAI;MACvDH,MAAM,CAACtZ,KAAK,CAAC1M,GAAG,GAAG3S,MAAM,CAACiS,MAAM,GAAG,GAAG,GAAGqe,OAAO,GAAG,IAAI;IAC3D;IAEAjrC,UAAU,CAAC,YAAW;MAClBwY,KAAK,CAAC2gB,KAAK,EAAE;IACjB,CAAC,EAAE,EAAE,CAAC;IAEN,OAAOma,MAAM;EACjB,CAAC;EAEDx+B,YAAY,CAACy/B,YAAY,GAAG,CAAC,CAAC;EAC9Bz/B,YAAY,CAACnT,SAAS,CAAC25B,aAAa,GAAG,UAASvb,KAAK,EAAExS,OAAO,EAAE;IAC5D;IACAinC,WAAW,GAAG;MAAEpW,SAAS,EAAE,IAAI;MACdD,SAAS,EAAE,IAAI;MACfG,OAAO,EAAE,IAAI;MACbmW,cAAc,EAAErxC,SAAS,CAACkF,qBAAqB,CAAC;MAAA;MAChD+1B,cAAc,EAAE,KAAK,CAA0B;MAAA;MAC/CE,eAAe,EAAE,KAAK;MACtBmW,kCAAkC,EAAE,IAAI;MACxCC,+BAA+B,EAAE,IAAI;MACrCC,mBAAmB,EAAExxC,SAAS,CAACiF,0BAA0B;MACzDwsC,iBAAiB,EAAE,IAAI;MACvBC,gBAAgB,EAAE1xC,SAAS,CAACmF;IACjC,CAAC;IACbgF,OAAO,GAAGpD,MAAM,CAACmd,MAAM,CAACktB,WAAW,EAAEjnC,OAAO,IAAI,CAAC,CAAC,CAAC;;IAEzD;;IAEM,IAAIoD,IAAI,GAAG,IAAI;IACf,IAAI0iC,UAAU,GAAG,EAAE;IACnB,IAAIx+B,WAAW,GAAGC,YAAY,CAAC4jB,aAAa;IAC5C,IAAI/d,MAAM,GAAG9F,WAAW,CAAC8F,MAAM;IAC/B,IAAIo6B,aAAa,GAAGp6B,MAAM,CAACqd,aAAa,IAAInpB,QAAQ;IAEpD,IAAIykC,MAAM,GAAGzkC,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;IAC1CikC,MAAM,CAAC1d,SAAS,GAAG,6CAA6C;IAChE0d,MAAM,CAACrB,SAAS,GAAG,uFAAuF;IAC1G,IAAI1kC,OAAO,CAACknC,cAAc,EAAC;MACvBnB,MAAM,CAACrB,SAAS,IAAI,yEAAyE;MAC7FqB,MAAM,CAACrB,SAAS,IAAI,0EAA0E;IAClG;IACAqB,MAAM,CAACrB,SAAS,IAAI,4BAA4B;IAEhD,IAAI8C,aAAa,CAACC,iBAAiB,EAClCD,aAAa,CAACC,iBAAiB,CAAC1lC,WAAW,CAACgkC,MAAM,CAAC,CAAC,KAE3D;MACIyB,aAAa,CAACE,IAAI,CAAC3lC,WAAW,CAACgkC,MAAM,CAAC;MACzCyB,aAAa,CAACE,IAAI,CAACjb,KAAK,CAACkb,QAAQ,GAAG,QAAQ;IAC7C;IACM;;IAEA,IAAI3nC,OAAO,CAACknC,cAAc,EAAC;MACvB,IAAIN,KAAK,GAAGb,MAAM,CAAC/jB,aAAa,CAAC,sBAAsB,CAAC;MACxD,IAAI4lB,MAAM,GAAG7B,MAAM,CAAC/jB,aAAa,CAAC,uBAAuB,CAAC;IAC9D;IAEA+jB,MAAM,CAACtU,KAAK,GAAG,YAAW;MACtBruB,IAAI,CAACykC,UAAU,GAAG,IAAI;MAC/B,IAAI,CAACC,IAAI,EAAE;MACF16B,MAAM,CAACwe,KAAK,EAAE;MACvB4b,aAAa,CAACE,IAAI,CAACjb,KAAK,CAACkb,QAAQ,GAAG,EAAE;MAE7Bl1C,UAAU,CAAC,YAAW;QAClB2Q,IAAI,CAACgK,MAAM,CAACwe,KAAK,EAAE;MACvB,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;MACR,IAAIma,MAAM,CAAC1E,UAAU,EAAE;QACnB0E,MAAM,CAAC1E,UAAU,CAACr/B,WAAW,CAAC+jC,MAAM,CAAC;MACzC;IACJ,CAAC;IAED,IAAI,IAAI,CAAC9jB,EAAE,CAAC5E,KAAK,GAAG,CAAC,EAAE;MACnB0oB,MAAM,CAACtZ,KAAK,CAAC8Z,SAAS,GAAG,QAAQ,GAAG,IAAI,CAACtkB,EAAE,CAAC5E,KAAK,GAAG,GAAG;IAC3D;;IAEA;IACA,IAAGrd,OAAO,CAACqnC,mBAAmB,EAAC;MAC3B,IAAIb,eAAe,GAAG,KAAK;MAC3B,IAAIuB,aAAa,GAAG,IAAI;MACxBlyC,SAAS,CAACopB,kBAAkB,CAAC8mB,MAAM,EAAC,OAAO,EAAE,UAASrzC,CAAC,EAAE;QACrD,IAAIq1C,aAAa,EAAE;UACfp1C,YAAY,CAACo1C,aAAa,CAAC;UAC3BA,aAAa,GAAG,IAAI;QACxB;MACJ,CAAC,CAAC;MACFlyC,SAAS,CAACopB,kBAAkB,CAAC8mB,MAAM,EAAC,OAAO,EAAE,UAASrzC,CAAC,EAAE;QACrD,IAAI8zC,eAAe,EAAC;UAChB;QACJ;QACAuB,aAAa,GAAGt1C,UAAU,CAAC,YAAW;UAClCszC,MAAM,CAACtU,KAAK,EAAE;QAClB,CAAC,EAAE,GAAG,CAAC;MACX,CAAC,CAAC;MACF;MACA,IAAIzxB,OAAO,CAACknC,cAAc,EAAC;QACvBN,KAAK,CAACr0B,gBAAgB,CAAC,OAAO,EAAE,UAAS7f,CAAC,EAAE;UACxC8zC,eAAe,EAAE;QACrB,CAAC,CAAC;QACFI,KAAK,CAACr0B,gBAAgB,CAAC,MAAM,EAAE,UAAS7f,CAAC,EAAE;UACxC8zC,eAAe,GAAG,CAAC;QACtB,CAAC,CAAC;QACFI,KAAK,CAACr0B,gBAAgB,CAAC,QAAQ,EAAE,UAAS7f,CAAC,EAAE;UACzC8zC,eAAe,GAAG,CAAC,CAAC;QACxB,CAAC,CAAC;QACFoB,MAAM,CAACr1B,gBAAgB,CAAC,OAAO,EAAE,UAAS7f,CAAC,EAAE;UACzC8zC,eAAe,EAAE;QACrB,CAAC,CAAC;QACFoB,MAAM,CAACr1B,gBAAgB,CAAC,MAAM,EAAE,UAAS7f,CAAC,EAAE;UACzC8zC,eAAe,GAAG,CAAC;QACtB,CAAC,CAAC;QACFoB,MAAM,CAACr1B,gBAAgB,CAAC,QAAQ,EAAE,UAAS7f,CAAC,EAAE;UAC1C8zC,eAAe,GAAG,CAAC,CAAC;QACxB,CAAC,CAAC;MACN;IACJ;IAEA,IAAIpjC,IAAI,CAACykC,UAAU,EAAE;MACjBzkC,IAAI,CAACykC,UAAU,CAACpW,KAAK,EAAE;IAC3B;IACAruB,IAAI,CAACykC,UAAU,GAAG9B,MAAM;IAExB,IAAIiC,MAAM,GAAGjC,MAAM,CAAC/jB,aAAa,CAAC,SAAS,CAAC;IAE5C,IAAI6kB,KAAK,GAAG,IAAI;IAChB,IAAIpzC,OAAO,GAAG,IAAI;IAClB,IAAI8nC,QAAQ,GAAG,IAAI;IAEnB,IAAItwB,KAAK,GAAG86B,MAAM,CAAC/jB,aAAa,CAAC,OAAO,CAAC;IACzC,IAAI/W,KAAK,EAAE;MACPA,KAAK,CAACsH,gBAAgB,CAAC,MAAM,EAAE,UAAS7f,CAAC,EAAE;QACvC,IAAI,CAACk5B,KAAK,EAAE;MAChB,CAAC,CAAC;MACF3gB,KAAK,CAACsH,gBAAgB,CAAC,SAAS,EAAE,UAAS7f,CAAC,EAAE;QAC1C,IAAIA,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;UACjB;UACA0W,eAAe,CAAC,KAAK,CAAC;QAC1B,CAAC,MAAM,IAAIv1C,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;UACxB;UACA0W,eAAe,CAAC,IAAI,CAAC;QACzB,CAAC,MAAM,IAAIv1C,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;UACxB;UACAwU,MAAM,CAACtU,KAAK,EAAE;QAClB,CAAC,MAAM,IAAI/+B,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;UACxB,IAAIgK,QAAQ,EAAE;YACV2M,MAAM,CAAC3M,QAAQ,CAACmJ,SAAS,CAAC;UAC9B,CAAC,MAAM,IAAImC,KAAK,EAAE;YACdqB,MAAM,CAACrB,KAAK,CAAC;UACjB,CAAC,MAAM;YACHd,MAAM,CAACtU,KAAK,EAAE;UAClB;QACJ,CAAC,MAAM;UACH,IAAIh+B,OAAO,EAAE;YACT+U,aAAa,CAAC/U,OAAO,CAAC;UAC1B;UACAA,OAAO,GAAGhB,UAAU,CAAC01C,aAAa,EAAE,GAAG,CAAC;UACxC;QACJ;QACAz1C,CAAC,CAACsuB,cAAc,EAAE;QAClBtuB,CAAC,CAACuuB,eAAe,EAAE;QAC/BvuB,CAAC,CAACs/B,wBAAwB,EAAE;QAC5B,OAAO,IAAI;MACH,CAAC,CAAC;IACN;;IAEA;IACA,IAAIhyB,OAAO,CAACknC,cAAc,EAAC;MACvB,IAAIN,KAAK,EAAC;QACN,IAAItsB,MAAM,GAAGzkB,SAAS,CAACuF,aAAa;QACpC,IAAIgtC,MAAM,GAAG9tB,MAAM,CAAChnB,MAAM,CAAC,CAAC;;QAE5B,IAAI0M,OAAO,CAAC8wB,cAAc,IAAIj7B,SAAS,CAACyC,KAAK,IAAI0H,OAAO,CAAC8wB,cAAc,IAAIj7B,SAAS,CAAC0C,MAAM,EACvFyH,OAAO,CAAC8wB,cAAc,GAAG,SAAS;QACtC;AAChB;AACA;;QAEgB,KAAK,IAAIuX,EAAE,GAAC,CAAC,EAAEA,EAAE,GAACD,MAAM,EAAEC,EAAE,EAAE,EAAC;UAC3B,IAAIC,GAAG,GAAGhnC,QAAQ,CAACQ,aAAa,CAAC,QAAQ,CAAC;UAC1CwmC,GAAG,CAACp5B,KAAK,GAAGoL,MAAM,CAAC+tB,EAAE,CAAC;UACtBC,GAAG,CAAC5D,SAAS,GAAGpqB,MAAM,CAAC+tB,EAAE,CAAC;UAC1BzB,KAAK,CAAC7kC,WAAW,CAACumC,GAAG,CAAC;UACtB,IAAGtoC,OAAO,CAAC8wB,cAAc,KAAI,KAAK,IAAI,CAAC9wB,OAAO,CAAC8wB,cAAc,GAAC,EAAE,EAAEnzB,WAAW,EAAE,IAAI,CAAC2c,MAAM,CAAC+tB,EAAE,CAAC,GAAC,EAAE,EAAE1qC,WAAW,EAAE,EAAC;YAC7G;YACA2qC,GAAG,CAAC/M,QAAQ,GAAG,IAAI;YACrC;UACW,CAAC,MAAI;YAChB;UAAA;QAEF;QACYqL,KAAK,CAACr0B,gBAAgB,CAAC,QAAQ,EAAC,YAAU;UACtC41B,aAAa,EAAE;QACnB,CAAC,CAAC;MACN;MACA,IAAIP,MAAM,EAAC;QACP,IAAIttB,MAAM,GAAGzkB,SAAS,CAACwF,cAAc;QACrC,IAAI+sC,MAAM,GAAG9tB,MAAM,CAAChnB,MAAM,CAAC,CAAC;;QAE5B,IAAI0M,OAAO,CAACgxB,eAAe,IAAIn7B,SAAS,CAACyC,KAAK,IAAI0H,OAAO,CAACgxB,eAAe,IAAIn7B,SAAS,CAAC0C,MAAM,EACzFyH,OAAO,CAACgxB,eAAe,GAAG,SAAS;QACvC;AAChB;AACA;;QAEgB,KAAK,IAAIqX,EAAE,GAAC,CAAC,EAAEA,EAAE,GAACD,MAAM,EAAEC,EAAE,EAAE,EAAC;UAC3B,IAAIC,GAAG,GAAGhnC,QAAQ,CAACQ,aAAa,CAAC,QAAQ,CAAC;UAC1CwmC,GAAG,CAACp5B,KAAK,GAAGoL,MAAM,CAAC+tB,EAAE,CAAC;UACtBC,GAAG,CAAC5D,SAAS,GAAGpqB,MAAM,CAAC+tB,EAAE,CAAC;UAC1BT,MAAM,CAAC7lC,WAAW,CAACumC,GAAG,CAAC;UACvB,IAAGtoC,OAAO,CAACgxB,eAAe,KAAI,KAAK,IAAI,CAAChxB,OAAO,CAACgxB,eAAe,GAAC,EAAE,EAAErzB,WAAW,EAAE,IAAI,CAAC2c,MAAM,CAAC+tB,EAAE,CAAC,GAAC,EAAE,EAAE1qC,WAAW,EAAE,EAAC;YAC/G;YACA2qC,GAAG,CAAC/M,QAAQ,GAAG,IAAI;UACvB;QACJ;QACAqM,MAAM,CAACr1B,gBAAgB,CAAC,QAAQ,EAAC,YAAU;UACvC41B,aAAa,EAAE;QACnB,CAAC,CAAC;MACN;IACJ;;IAEA;IACA,IAAIzoB,IAAI,GAAGtS,MAAM,CAACuS,qBAAqB,EAAE;IAEzC,IAAIE,IAAI,GAAG,CAAErN,KAAK,GAAGA,KAAK,CAACoN,OAAO,GAAIF,IAAI,CAACG,IAAI,GAAGH,IAAI,CAACN,KAAK,GAAG,GAAI,IAAK,EAAE;IAC1E,IAAIW,GAAG,GAAG,CAAEvN,KAAK,GAAGA,KAAK,CAACsN,OAAO,GAAIJ,IAAI,CAACK,GAAG,GAAGL,IAAI,CAACL,MAAM,GAAG,GAAI,IAAK,EAAE;IACzE0mB,MAAM,CAACtZ,KAAK,CAAC5M,IAAI,GAAGA,IAAI,GAAG,IAAI;IAC/BkmB,MAAM,CAACtZ,KAAK,CAAC1M,GAAG,GAAGA,GAAG,GAAG,IAAI;;IAEnC;IACA,IAAGvN,KAAK,CAAC+1B,MAAM,GAAI7oB,IAAI,CAACL,MAAM,GAAG,GAAI,EAC3B2oB,MAAM,CAACvb,KAAK,CAAC+b,SAAS,GAAI9oB,IAAI,CAACL,MAAM,GAAG7M,KAAK,CAAC+1B,MAAM,GAAG,EAAE,GAAI,IAAI;;IAE3E;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAGQt9B,KAAK,CAAC2gB,KAAK,EAAE;IACb,IAAI5rB,OAAO,CAACunC,gBAAgB,EAAEY,aAAa,EAAE;IAE7C,SAASD,MAAM,CAAC5yC,IAAI,EAAE;MAClB,IAAIA,IAAI,EAAE;QACN,IAAI8N,IAAI,CAAC0hB,oBAAoB,EAAE;UAC3B1hB,IAAI,CAAC0hB,oBAAoB,CAACxvB,IAAI,EAAEkd,KAAK,EAAElL,WAAW,CAAC;QACvD,CAAC,MAAM;UACH,IAAIjB,KAAK,GAAGxQ,SAAS,CAACyE,gBAAgB,CAAChF,IAAI,CAACqI,WAAW,EAAE,CAAC;UAC1D,IAAI0I,KAAK,EAAE;YACP/Q,IAAI,GAAG+Q,KAAK,CAACtK,IAAI;UACrB;UAEfuL,WAAW,CAACE,KAAK,CAACwF,YAAY,EAAE;UACjB,IAAI/M,IAAI,GAAGpK,SAAS,CAACkK,UAAU,CAACzK,IAAI,CAAC;UACrC,IAAI2K,IAAI,EAAE;YACNA,IAAI,CAAC3D,GAAG,GAAGgL,WAAW,CAACmtB,0BAA0B,CAC7CjiB,KAAK,CACR;YACDlL,WAAW,CAACE,KAAK,CAAC8E,GAAG,CAACrM,IAAI,EAAE,KAAK,CAAC;UACtC;UAEA,IAAIoG,KAAK,IAAIA,KAAK,CAACtD,IAAI,EAAE;YACrB,IAAIsD,KAAK,CAACtD,IAAI,CAACjE,UAAU,EAAE;cACvB,KAAK,IAAI9K,CAAC,IAAIqS,KAAK,CAACtD,IAAI,CAACjE,UAAU,EAAE;gBACjCmB,IAAI,CAACiX,WAAW,CAAEljB,CAAC,EAAEqS,KAAK,CAACtD,IAAI,CAACjE,UAAU,CAAC9K,CAAC,CAAC,CAAE;cACnD;YACJ;YACA,IAAIqS,KAAK,CAACtD,IAAI,CAACkE,MAAM,EAAE;cACnBhH,IAAI,CAACgH,MAAM,GAAG,EAAE;cAChB,KAAK,IAAIjT,CAAC,IAAIqS,KAAK,CAACtD,IAAI,CAACkE,MAAM,EAAE;gBAC7BhH,IAAI,CAAC4P,SAAS,CACVxJ,KAAK,CAACtD,IAAI,CAACkE,MAAM,CAACjT,CAAC,CAAC,CAAC,CAAC,CAAC,EACvBqS,KAAK,CAACtD,IAAI,CAACkE,MAAM,CAACjT,CAAC,CAAC,CAAC,CAAC,CAAC,CAC1B;cACL;YACJ;YACA,IAAIqS,KAAK,CAACtD,IAAI,CAACmE,OAAO,EAAE;cACpBjH,IAAI,CAACiH,OAAO,GAAG,EAAE;cACjB,KAAK,IAAIlT,CAAC,IAAIqS,KAAK,CAACtD,IAAI,CAACmE,OAAO,EAAE;gBAC9BjH,IAAI,CAAC4P,SAAS,CACVxJ,KAAK,CAACtD,IAAI,CAACmE,OAAO,CAAClT,CAAC,CAAC,CAAC,CAAC,CAAC,EACxBqS,KAAK,CAACtD,IAAI,CAACmE,OAAO,CAAClT,CAAC,CAAC,CAAC,CAAC,CAAC,CAC3B;cACL;YACJ;YACA,IAAIqS,KAAK,CAACtD,IAAI,CAACzO,KAAK,EAAE;cAClB2L,IAAI,CAAC3L,KAAK,GAAG+R,KAAK,CAACtD,IAAI,CAACzO,KAAK;YACjC;YACA,IAAI+R,KAAK,CAACtD,IAAI,CAACY,IAAI,EAAE;cACjB1D,IAAI,CAACgF,SAAS,CAACoB,KAAK,CAACtD,IAAI,CAACY,IAAI,CAAC;YACnC;UAEJ;;UAEA;UACA,IAAI3D,OAAO,CAAC4wB,SAAS,EAAC;YAClB,IAAI6X,EAAE,GAAG,KAAK;YACd,gBAAezoC,OAAO,CAAC6wB,SAAS;cAC5B,KAAK,QAAQ;gBACT4X,EAAE,GAAGzoC,OAAO,CAAC4wB,SAAS,CAAC5a,cAAc,CAAChW,OAAO,CAAC6wB,SAAS,CAAC;gBAC5D;cACA,KAAK,QAAQ;gBACT,IAAI7wB,OAAO,CAAC6wB,SAAS,CAACv7B,IAAI,EAAC;kBACvBmzC,EAAE,GAAGzoC,OAAO,CAAC4wB,SAAS,CAAC5a,cAAc,CAAChW,OAAO,CAAC6wB,SAAS,CAACv7B,IAAI,CAAC;gBACjE,CAAC,MAAI;kBACDmzC,EAAE,GAAG,CAAC,CAAC;gBACX;gBACA,IAAIA,EAAE,IAAE,CAAC,CAAC,IAAI,OAAOzoC,OAAO,CAAC6wB,SAAS,CAACjE,UAAU,KAAK,WAAW,EAAE6b,EAAE,GAAGzoC,OAAO,CAAC6wB,SAAS,CAACjE,UAAU;gBACxG;cACA,KAAK,QAAQ;gBACT6b,EAAE,GAAGzoC,OAAO,CAAC6wB,SAAS;gBAC1B;cACA;gBACI4X,EAAE,GAAG,CAAC;cAAE;YAAA;;YAEhB,IAAI,QAAOzoC,OAAO,CAAC4wB,SAAS,CAAC1pB,OAAO,CAACuhC,EAAE,CAAC,MAAKt8B,SAAS,EAAC;cACnD,IAAIs8B,EAAE,KAAG,KAAK,IAAIA,EAAE,GAAC,CAAC,CAAC,EAAC;gBACpBzoC,OAAO,CAAC4wB,SAAS,CAAChW,aAAa,CAAE6tB,EAAE,EAAExoC,IAAI,EAAED,OAAO,CAAC4wB,SAAS,CAAC1pB,OAAO,CAACuhC,EAAE,CAAC,CAAC1sC,IAAI,CAAE;cACnF;YACJ,CAAC,MAAI;cACD;YAAA;UAER;UACA,IAAIiE,OAAO,CAAC+wB,OAAO,EAAC;YAChB,IAAI0X,EAAE,GAAG,KAAK;YACd,gBAAezoC,OAAO,CAAC6wB,SAAS;cAC5B,KAAK,QAAQ;gBACT4X,EAAE,GAAGzoC,OAAO,CAAC+wB,OAAO,CAAC/b,aAAa,CAAChV,OAAO,CAAC6wB,SAAS,CAAC;gBACzD;cACA,KAAK,QAAQ;gBACT,IAAI7wB,OAAO,CAAC6wB,SAAS,CAACv7B,IAAI,EAAC;kBACvBmzC,EAAE,GAAGzoC,OAAO,CAAC+wB,OAAO,CAAC/b,aAAa,CAAChV,OAAO,CAAC6wB,SAAS,CAACv7B,IAAI,CAAC;gBAC9D,CAAC,MAAI;kBACDmzC,EAAE,GAAG,CAAC,CAAC;gBACX;gBACA,IAAIA,EAAE,IAAE,CAAC,CAAC,IAAI,OAAOzoC,OAAO,CAAC6wB,SAAS,CAACjE,UAAU,KAAK,WAAW,EAAE6b,EAAE,GAAGzoC,OAAO,CAAC6wB,SAAS,CAACjE,UAAU;gBACxG;cACA,KAAK,QAAQ;gBACT6b,EAAE,GAAGzoC,OAAO,CAAC6wB,SAAS;gBAC1B;cACA;gBACI4X,EAAE,GAAG,CAAC;cAAE;YAAA;;YAEhB,IAAI,QAAOzoC,OAAO,CAAC+wB,OAAO,CAAC9pB,MAAM,CAACwhC,EAAE,CAAC,MAAKt8B,SAAS,EAAC;cAChD,IAAIs8B,EAAE,KAAG,KAAK,IAAIA,EAAE,GAAC,CAAC,CAAC,EAAC;gBACpB;gBACAzoC,OAAO,CAAC+wB,OAAO,CAAC5V,mBAAmB,CAACstB,EAAE,EAACxoC,IAAI,EAACD,OAAO,CAAC+wB,OAAO,CAAC9pB,MAAM,CAACwhC,EAAE,CAAC,CAAC1sC,IAAI,CAAC;cAChF;YACJ,CAAC,MAAI;cACD;YAAA;UAER;UAEAuL,WAAW,CAACE,KAAK,CAACgG,WAAW,EAAE;QACnC;MACJ;MAEAu4B,MAAM,CAACtU,KAAK,EAAE;IAClB;IAEA,SAASwW,eAAe,CAACS,OAAO,EAAE;MAC9B,IAAI/rC,IAAI,GAAG4+B,QAAQ;MACnB,IAAIA,QAAQ,EAAE;QACVA,QAAQ,CAACoN,SAAS,CAAC97B,MAAM,CAAC,UAAU,CAAC;MACzC;MACA,IAAI,CAAC0uB,QAAQ,EAAE;QACXA,QAAQ,GAAGmN,OAAO,GACZV,MAAM,CAACY,UAAU,CAAC,CAAC,CAAC,GACpBZ,MAAM,CAACY,UAAU,CAACZ,MAAM,CAACY,UAAU,CAACt1C,MAAM,CAAC;MACrD,CAAC,MAAM;QACHioC,QAAQ,GAAGmN,OAAO,GACZnN,QAAQ,CAACsN,WAAW,GACpBtN,QAAQ,CAACuN,eAAe;QAC9B,IAAI,CAACvN,QAAQ,EAAE;UACXA,QAAQ,GAAG5+B,IAAI;QACnB;MACJ;MACA,IAAI,CAAC4+B,QAAQ,EAAE;QACX;MACJ;MACAA,QAAQ,CAACoN,SAAS,CAACr8B,GAAG,CAAC,UAAU,CAAC;MAClCivB,QAAQ,CAACwN,cAAc,CAAC;QAACC,KAAK,EAAE,KAAK;QAAEC,QAAQ,EAAE;MAAQ,CAAC,CAAC;IAC/D;IAEA,SAASd,aAAa,GAAG;MACrB10C,OAAO,GAAG,IAAI;MACd,IAAI+wC,GAAG,GAAGv5B,KAAK,CAACiE,KAAK;MACrB23B,KAAK,GAAG,IAAI;MACZmB,MAAM,CAACtD,SAAS,GAAG,EAAE;MACrB,IAAI,CAACF,GAAG,IAAI,CAACxkC,OAAO,CAACsnC,iBAAiB,EAAE;QACpC;MACJ;MAEA,IAAIlkC,IAAI,CAACyhB,WAAW,EAAE;QAClB,IAAIhI,IAAI,GAAGzZ,IAAI,CAACyhB,WAAW,CAACmjB,MAAM,EAAExD,GAAG,EAAEl9B,WAAW,CAAC;QACrD,IAAIuV,IAAI,EAAE;UACN,KAAK,IAAI7oB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG6oB,IAAI,CAACvpB,MAAM,EAAE,EAAEU,CAAC,EAAE;YAClCk1C,SAAS,CAACrsB,IAAI,CAAC7oB,CAAC,CAAC,CAAC;UACtB;QACJ;MACJ,CAAC,MAAM;QAAA,IAoFNm1C,iBAAiB,GAA1B,SAASA,iBAAiB,CAAEptC,IAAI,EAAE4d,MAAM,EACxC;UACgB,IAAIA,MAAM,GAAGA,MAAM,IAAI,CAAC,CAAC;UACzB,IAAIC,OAAO,GAAG;YAAEwvB,UAAU,EAAE,KAAK;YAChBC,cAAc,EAAE,KAAK;YACrBC,eAAe,EAAE;UACpB,CAAC;UACf,IAAIxvB,IAAI,GAAGld,MAAM,CAACmd,MAAM,CAACH,OAAO,EAACD,MAAM,CAAC;UACvD,IAAIpL,IAAI,GAAG1Y,SAAS,CAACqE,qBAAqB,CAAE6B,IAAI,CAAE;UAClD,IAAG6E,MAAM,IAAI2N,IAAI,CAAC3N,MAAM,IAAIA,MAAM,EACjC,OAAO,KAAK;UACE,IAAI,CAAC,CAACZ,OAAO,CAACsnC,iBAAiB,IAAI9C,GAAG,KAAKzoC,IAAI,CAAC4B,WAAW,EAAE,CAAC6E,OAAO,CAACgiC,GAAG,CAAC,KAAK,CAAC,CAAC,EAC7E,OAAO,KAAK;;UAEhB;UACA,IAAGxkC,OAAO,CAACknC,cAAc,IAAI,CAACptB,IAAI,CAACsvB,UAAU,EAAC;YAC1C,IAAIG,KAAK,GAAGxtC,IAAI;YAEhB,IAAIytC,EAAE,GAAGC,GAAG,CAACv6B,KAAK;YAClB,IAAI4K,IAAI,CAACuvB,cAAc,KAAG,KAAK,EAAEG,EAAE,GAAG1vB,IAAI,CAACuvB,cAAc;YAC3E;;YAEkB,IAAGI,GAAG,IAAID,EAAE,EAAC;cACT;cACA,IAAI3zC,SAAS,CAACqF,wBAAwB,CAACsuC,EAAE,CAAC,IAAI3zC,SAAS,CAACqF,wBAAwB,CAACsuC,EAAE,CAAC,CAACjrC,KAAK,EAAC;gBAAE;gBACzF;gBACA,IAAImrC,OAAO,GAAG7zC,SAAS,CAACqF,wBAAwB,CAACsuC,EAAE,CAAC,CAACjrC,KAAK,CAACC,QAAQ,CAAC+qC,KAAK,CAAC;gBAC1E,IAAIG,OAAO,KAAG,KAAK,EAAC;kBAChB;gBAAA,CACH,MAAI;kBACD;AACpC;kBACoC,OAAO,KAAK;gBAChB;cACJ;YACJ;YAEA,IAAIF,EAAE,GAAGG,IAAI,CAACz6B,KAAK;YACnB,IAAI4K,IAAI,CAACwvB,eAAe,KAAG,KAAK,EAAEE,EAAE,GAAG1vB,IAAI,CAACwvB,eAAe;YAC3D;;YAEA,IAAGK,IAAI,IAAIH,EAAE,EAAC;cACV;cACA,IAAI3zC,SAAS,CAACsF,yBAAyB,CAACquC,EAAE,CAAC,IAAI3zC,SAAS,CAACsF,yBAAyB,CAACquC,EAAE,CAAC,CAACjrC,KAAK,EAAC;gBAAE;gBAC3F;gBACA,IAAImrC,OAAO,GAAG7zC,SAAS,CAACsF,yBAAyB,CAACquC,EAAE,CAAC,CAACjrC,KAAK,CAACC,QAAQ,CAAC+qC,KAAK,CAAC;gBAC3E,IAAIG,OAAO,KAAG,KAAK,EAAC;kBAChB;gBAAA,CACH,MAAI;kBACD;AACpC;kBACoC,OAAO,KAAK;gBAChB;cACJ;YACJ;UACJ;UACA,OAAO,IAAI;QAC3B,CAAC;QA5IW,IAAIr9B,CAAC,GAAG,CAAC;QACTm4B,GAAG,GAAGA,GAAG,CAAC7mC,WAAW,EAAE;QACnC,IAAIiD,MAAM,GAAG0G,WAAW,CAAC1G,MAAM,IAAI0G,WAAW,CAACE,KAAK,CAAC5G,MAAM;;QAE/C;QACA,IAAGZ,OAAO,CAACknC,cAAc,IAAI9jC,IAAI,CAACykC,UAAU,EAAC;UACzC,IAAI4B,GAAG,GAAGrmC,IAAI,CAACykC,UAAU,CAAC7lB,aAAa,CAAC,sBAAsB,CAAC;UAC/D,IAAI2nB,IAAI,GAAGvmC,IAAI,CAACykC,UAAU,CAAC7lB,aAAa,CAAC,uBAAuB,CAAC;QACrE,CAAC,MAAI;UACD,IAAIynB,GAAG,GAAG,KAAK;UACf,IAAIE,IAAI,GAAG,KAAK;QACpB;;QAEA;QACA,KAAK,IAAI31C,CAAC,IAAI6B,SAAS,CAACyE,gBAAgB,EAAE;UACtC,IAAI+L,KAAK,GAAGxQ,SAAS,CAACyE,gBAAgB,CAACtG,CAAC,CAAC;UACzC,IAAI,CAAC,CAACgM,OAAO,CAACsnC,iBAAiB,IAAI9C,GAAG,KAAKn+B,KAAK,CAAC7G,IAAI,CAAC7B,WAAW,EAAE,CAAC6E,OAAO,CAACgiC,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE;YACrF;UACJ;UACf,IAAIj2B,IAAI,GAAG1Y,SAAS,CAACqE,qBAAqB,CAAEmM,KAAK,CAACtK,IAAI,CAAE;UACxD,IAAIwS,IAAI,IAAIA,IAAI,CAAC3N,MAAM,IAAIA,MAAM,EAChC;UACc,IAAI,CAAEuoC,iBAAiB,CAAC9iC,KAAK,CAACtK,IAAI,CAAC,EAC/B;UACJmtC,SAAS,CAAE7iC,KAAK,CAAC7G,IAAI,EAAE,iBAAiB,CAAE;UAC1C,IAAK+H,YAAY,CAACy/B,YAAY,KAAK,CAAC,CAAC,IAAI36B,CAAC,EAAE,GAAG9E,YAAY,CAACy/B,YAAY,EAAG;YACvE;UACJ;QACJ;QAEZ,IAAI4C,QAAQ,GAAG,IAAI;QACP,IAAI91C,KAAK,CAACM,SAAS,CAACwM,MAAM,EAAE;UAAE;UAC1B,IAAImuB,IAAI,GAAGnyB,MAAM,CAACmyB,IAAI,CAAEl5B,SAAS,CAACqE,qBAAqB,CAAE,CAAC,CAAC;UAC3D,IAAI0vC,QAAQ,GAAG7a,IAAI,CAACnuB,MAAM,CAAEuoC,iBAAiB,CAAE;QACnD,CAAC,MAAM;UAClBS,QAAQ,GAAG,EAAE;UACE,KAAK,IAAI51C,CAAC,IAAI6B,SAAS,CAACqE,qBAAqB,EAAE;YAC7D,IAAIivC,iBAAiB,CAACn1C,CAAC,CAAC,EACvB41C,QAAQ,CAAC31C,IAAI,CAACD,CAAC,CAAC;UACH;QACJ;QAEZ,KAAK,IAAIA,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG41C,QAAQ,CAACt2C,MAAM,EAAEU,CAAC,EAAE,EAAE;UACzCk1C,SAAS,CAACU,QAAQ,CAAC51C,CAAC,CAAC,CAAC;UACtB,IAAKuT,YAAY,CAACy/B,YAAY,KAAK,CAAC,CAAC,IAAI36B,CAAC,EAAE,GAAG9E,YAAY,CAACy/B,YAAY,EAAG;YAC1E;UACD;QACD;;QAEY;QACA,IAAIhnC,OAAO,CAAConC,+BAA+B,KACnCqC,GAAG,CAACv6B,KAAK,IAAIy6B,IAAI,CAACz6B,KAAK,CAAC,EAC/B;UACG26B,cAAc,GAAG,EAAE;UACnB,KAAK,IAAI71C,CAAC,IAAI6B,SAAS,CAACqE,qBAAqB,EAAE;YAC7D,IAAIivC,iBAAiB,CAACn1C,CAAC,EAAE;cAACq1C,cAAc,EAAEI,GAAG,IAAEA,GAAG,CAACv6B,KAAK,GAAC,GAAG,GAAC,KAAK;cAAEo6B,eAAe,EAAEK,IAAI,IAAEA,IAAI,CAACz6B,KAAK,GAAC,GAAG,GAAC;YAAK,CAAC,CAAC,EAChH26B,cAAc,CAAC51C,IAAI,CAACD,CAAC,CAAC;UACT;UACA,KAAK,IAAIA,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG61C,cAAc,CAACv2C,MAAM,EAAEU,CAAC,EAAE,EAAE;YAC5Ck1C,SAAS,CAACW,cAAc,CAAC71C,CAAC,CAAC,EAAE,cAAc,CAAC;YAC5C,IAAKuT,YAAY,CAACy/B,YAAY,KAAK,CAAC,CAAC,IAAI36B,CAAC,EAAE,GAAG9E,YAAY,CAACy/B,YAAY,EAAG;cACvE;YACJ;UACJ;QACJ;;QAEA;QACA,IAAI,CAACyC,GAAG,CAACv6B,KAAK,IAAIy6B,IAAI,CAACz6B,KAAK,KACrB84B,MAAM,CAACY,UAAU,CAACt1C,MAAM,IAAI,CAAC,IAAI0M,OAAO,CAACmnC,kCAAqC,EACpF;UACG0C,cAAc,GAAG,EAAE;UACnB,KAAK,IAAI71C,CAAC,IAAI6B,SAAS,CAACqE,qBAAqB,EAAE;YAC7D,IAAIivC,iBAAiB,CAACn1C,CAAC,EAAE;cAACo1C,UAAU,EAAE;YAAI,CAAC,CAAC,EAC3CS,cAAc,CAAC51C,IAAI,CAACD,CAAC,CAAC;UACT;UACA,KAAK,IAAIA,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG61C,cAAc,CAACv2C,MAAM,EAAEU,CAAC,EAAE,EAAE;YAC5Ck1C,SAAS,CAACW,cAAc,CAAC71C,CAAC,CAAC,EAAE,eAAe,CAAC;YAC7C,IAAKuT,YAAY,CAACy/B,YAAY,KAAK,CAAC,CAAC,IAAI36B,CAAC,EAAE,GAAG9E,YAAY,CAACy/B,YAAY,EAAG;cACvE;YACJ;UACJ;QACJ;MA4DJ;MAEA,SAASkC,SAAS,CAACntC,IAAI,EAAEssB,SAAS,EAAE;QAChC,IAAIyhB,IAAI,GAAGxoC,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;QACxC,IAAI,CAAC+kC,KAAK,EAAE;UACRA,KAAK,GAAG9qC,IAAI;QAChB;QACA+tC,IAAI,CAACrF,SAAS,GAAG1oC,IAAI;QACrB+tC,IAAI,CAACC,OAAO,CAAC,MAAM,CAAC,GAAGC,MAAM,CAACjuC,IAAI,CAAC;QACnC+tC,IAAI,CAACzhB,SAAS,GAAG,4BAA4B;QAC7C,IAAIA,SAAS,EAAE;UACXyhB,IAAI,CAACzhB,SAAS,IAAI,GAAG,GAAGA,SAAS;QACrC;QACAyhB,IAAI,CAACv3B,gBAAgB,CAAC,OAAO,EAAE,UAAS7f,CAAC,EAAE;UACvCw1C,MAAM,CAAC+B,QAAQ,CAAC,IAAI,CAACF,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;QAC1C,CAAC,CAAC;QACF/B,MAAM,CAACjmC,WAAW,CAAC+nC,IAAI,CAAC;MAC5B;IACJ;IAEA,OAAO/D,MAAM;EACjB,CAAC;EAEDx+B,YAAY,CAACnT,SAAS,CAACmwC,qBAAqB,GAAG,UAAUtkC,IAAI,EAAE6T,QAAQ,EAAE9T,OAAO,EAAG;IAC/E,IAAI,CAACC,IAAI,IAAIA,IAAI,CAACnB,UAAU,CAACgV,QAAQ,CAAC,KAAK3H,SAAS,EAAE;MAClD;IACJ;IAEAnM,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;IACvB,IAAIoD,IAAI,GAAG,IAAI;IAEf,IAAIqN,IAAI,GAAGxQ,IAAI,CAACsY,eAAe,CAACzE,QAAQ,CAAC;IAC/C,IAAI/X,IAAI,GAAG0U,IAAI,CAAC1U,IAAI;IAEd,IAAI+pC,UAAU,GAAG,EAAE;IAEnB,IAAI/pC,IAAI,IAAI,QAAQ,IAAIA,IAAI,IAAI,QAAQ,IAAIA,IAAI,IAAI,OAAO,IAAIA,IAAI,IAAI,QAAQ,EAAE;MAC7E+pC,UAAU,GAAG,8CAA8C;IAC/D,CAAC,MAAM,IAAK,CAAC/pC,IAAI,IAAI,MAAM,IAAIA,IAAI,IAAI,OAAO,KAAK0U,IAAI,CAACmI,MAAM,EAAE;MAC5DktB,UAAU,GAAG,8CAA8C;MAC3D,KAAK,IAAI9xC,CAAC,IAAIyc,IAAI,CAACmI,MAAM,EAAE;QACvB,IAAI5b,CAAC,GAAGhJ,CAAC;QACrB,IAAIyc,IAAI,CAACmI,MAAM,CAACnb,WAAW,KAAK3J,KAAK,EACpCkJ,CAAC,GAAGyT,IAAI,CAACmI,MAAM,CAAC5kB,CAAC,CAAC;QAEP8xC,UAAU,IACN,iBAAiB,GACjB9oC,CAAC,GACD,IAAI,IACHA,CAAC,IAAIiD,IAAI,CAACnB,UAAU,CAACgV,QAAQ,CAAC,GAAG,UAAU,GAAG,EAAE,CAAC,GAClD,GAAG,GACHrD,IAAI,CAACmI,MAAM,CAAC5kB,CAAC,CAAC,GACd,WAAW;MACnB;MACA8xC,UAAU,IAAI,WAAW;IAC7B,CAAC,MAAM,IAAI/pC,IAAI,IAAI,SAAS,IAAIA,IAAI,IAAI,QAAQ,EAAE;MAC9C+pC,UAAU,GACN,iDAAiD,IAChD7lC,IAAI,CAACnB,UAAU,CAACgV,QAAQ,CAAC,GAAG,SAAS,GAAG,EAAE,CAAC,GAC5C,IAAI;IACZ,CAAC,MAAM;MACH7X,OAAO,CAACqB,IAAI,CAAC,gBAAgB,GAAGvB,IAAI,CAAC;MACrC;IACJ;IAEA,IAAIgqC,MAAM,GAAG,IAAI,CAACmE,YAAY,CAC1B,qBAAqB,IAChBz5B,IAAI,CAACuH,KAAK,GAAGvH,IAAI,CAACuH,KAAK,GAAGlE,QAAQ,CAAC,GACpC,SAAS,GACTgyB,UAAU,GACV,qBAAqB,EACzB9lC,OAAO,CACV;IAED,IAAIiL,KAAK,GAAG,KAAK;IACjB,IAAI,CAAClP,IAAI,IAAI,MAAM,IAAIA,IAAI,IAAI,OAAO,KAAK0U,IAAI,CAACmI,MAAM,EAAE;MACpD3N,KAAK,GAAG86B,MAAM,CAAC/jB,aAAa,CAAC,QAAQ,CAAC;MACtC/W,KAAK,CAACsH,gBAAgB,CAAC,QAAQ,EAAE,UAAS7f,CAAC,EAAE;QACzCqzC,MAAM,CAACoE,QAAQ,EAAE;QACjB9D,QAAQ,CAAC3zC,CAAC,CAACyP,MAAM,CAAC+M,KAAK,CAAC;QACxB;QACA;MACJ,CAAC,CAAC;IACN,CAAC,MAAM,IAAInT,IAAI,IAAI,SAAS,IAAIA,IAAI,IAAI,QAAQ,EAAE;MAC9CkP,KAAK,GAAG86B,MAAM,CAAC/jB,aAAa,CAAC,OAAO,CAAC;MACrC,IAAI/W,KAAK,EAAE;QACPA,KAAK,CAACsH,gBAAgB,CAAC,OAAO,EAAE,UAAS7f,CAAC,EAAE;UACxCqzC,MAAM,CAACoE,QAAQ,EAAE;UACjB9D,QAAQ,CAAC,CAAC,CAACp7B,KAAK,CAACm/B,OAAO,CAAC;QAC7B,CAAC,CAAC;MACN;IACJ,CAAC,MAAM;MACHn/B,KAAK,GAAG86B,MAAM,CAAC/jB,aAAa,CAAC,OAAO,CAAC;MACrC,IAAI/W,KAAK,EAAE;QACPA,KAAK,CAACsH,gBAAgB,CAAC,MAAM,EAAE,UAAS7f,CAAC,EAAE;UACvC,IAAI,CAACk5B,KAAK,EAAE;QAChB,CAAC,CAAC;QAEd,IAAI5uB,CAAC,GAAGiD,IAAI,CAACnB,UAAU,CAACgV,QAAQ,CAAC,KAAK3H,SAAS,GAAGlM,IAAI,CAACnB,UAAU,CAACgV,QAAQ,CAAC,GAAG,EAAE;QAChF,IAAI/X,IAAI,KAAK,QAAQ,EAAE;UACPiB,CAAC,GAAGmC,IAAI,CAACC,SAAS,CAACpC,CAAC,CAAC;QACzB;QAEAiO,KAAK,CAACiE,KAAK,GAAGlS,CAAC;QACfiO,KAAK,CAACsH,gBAAgB,CAAC,SAAS,EAAE,UAAS7f,CAAC,EAAE;UAC1C,IAAIA,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;YACjB;YACAwU,MAAM,CAACtU,KAAK,EAAE;UAClB,CAAC,MAAM,IAAI/+B,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;YACxB;YACA0U,KAAK,EAAE,CAAC,CAAC;UACb,CAAC,MAAM,IAAIvzC,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;YACxBwU,MAAM,CAACoE,QAAQ,EAAE;YACjB;UACJ;UACAz3C,CAAC,CAACsuB,cAAc,EAAE;UAClBtuB,CAAC,CAACuuB,eAAe,EAAE;QACvB,CAAC,CAAC;MACN;IACJ;IACA,IAAIhW,KAAK,EAAEA,KAAK,CAAC2gB,KAAK,EAAE;IAExB,IAAIua,MAAM,GAAGJ,MAAM,CAAC/jB,aAAa,CAAC,QAAQ,CAAC;IAC3CmkB,MAAM,CAAC5zB,gBAAgB,CAAC,OAAO,EAAE0zB,KAAK,CAAC;IAEvC,SAASA,KAAK,GAAG;MACbI,QAAQ,CAACp7B,KAAK,CAACiE,KAAK,CAAC;IACzB;IAEA,SAASm3B,QAAQ,CAACn3B,KAAK,EAAE;MAE9B,IAAGuB,IAAI,IAAIA,IAAI,CAACmI,MAAM,IAAInI,IAAI,CAACmI,MAAM,CAACnb,WAAW,KAAKb,MAAM,IAAI6T,IAAI,CAACmI,MAAM,CAAC1J,KAAK,CAAC,IAAI/C,SAAS,EAC9F+C,KAAK,GAAGuB,IAAI,CAACmI,MAAM,CAAC1J,KAAK,CAAC;MAElB,IAAI,OAAOjP,IAAI,CAACnB,UAAU,CAACgV,QAAQ,CAAC,IAAI,QAAQ,EAAE;QAC9C5E,KAAK,GAAG+L,MAAM,CAAC/L,KAAK,CAAC;MACzB;MACA,IAAInT,IAAI,IAAI,OAAO,IAAIA,IAAI,IAAI,QAAQ,EAAE;QACrCmT,KAAK,GAAG/P,IAAI,CAACiD,KAAK,CAAC8M,KAAK,CAAC;MAC7B;MACAjP,IAAI,CAACnB,UAAU,CAACgV,QAAQ,CAAC,GAAG5E,KAAK;MACjC,IAAIjP,IAAI,CAACuH,KAAK,EAAE;QACZvH,IAAI,CAACuH,KAAK,CAAC9B,QAAQ,EAAE;MACzB;MACA,IAAIzF,IAAI,CAACyT,iBAAiB,EAAE;QACxBzT,IAAI,CAACyT,iBAAiB,CAACI,QAAQ,EAAE5E,KAAK,CAAC;MAC3C;MACT,IAAGlP,OAAO,CAACqqC,OAAO,EACjBrqC,OAAO,CAACqqC,OAAO,EAAE;MACTtE,MAAM,CAACtU,KAAK,EAAE;MACdxxB,IAAI,CAAC6L,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;IACnC;IAEN,OAAOi6B,MAAM;EACX,CAAC;;EAED;EACAx+B,YAAY,CAACnT,SAAS,CAAC81C,YAAY,GAAG,UAASI,IAAI,EAAEtqC,OAAO,EAAE;IAC1DinC,WAAW,GAAG;MAAEsD,aAAa,EAAE,KAAK;MAAEC,YAAY,EAAE,IAAI;MAAEC,0BAA0B,EAAE;IAAK,CAAC;IAC5FzqC,OAAO,GAAGpD,MAAM,CAACmd,MAAM,CAACktB,WAAW,EAAEjnC,OAAO,IAAI,CAAC,CAAC,CAAC;IAEnD,IAAI+lC,MAAM,GAAGzkC,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;IAC1CikC,MAAM,CAAC1d,SAAS,GAAG,aAAa;IAChC0d,MAAM,CAACrB,SAAS,GAAG4F,IAAI;IACvBvE,MAAM,CAACC,WAAW,GAAG,KAAK;IAE1B,IAAItmB,IAAI,GAAG,IAAI,CAACtS,MAAM,CAACuS,qBAAqB,EAAE;IAC9C,IAAIumB,OAAO,GAAG,CAAC,EAAE;IACjB,IAAIxI,OAAO,GAAG,CAAC,EAAE;IACjB,IAAIhe,IAAI,EAAE;MACNwmB,OAAO,IAAIxmB,IAAI,CAACG,IAAI;MACpB6d,OAAO,IAAIhe,IAAI,CAACK,GAAG;IACvB;IAEA,IAAI/f,OAAO,CAAC2uB,QAAQ,EAAE;MAClBuX,OAAO,IAAIlmC,OAAO,CAAC2uB,QAAQ,CAAC,CAAC,CAAC;MAC9B+O,OAAO,IAAI19B,OAAO,CAAC2uB,QAAQ,CAAC,CAAC,CAAC;IAClC,CAAC,MAAM,IAAI3uB,OAAO,CAACwS,KAAK,EAAE;MACtB0zB,OAAO,IAAIlmC,OAAO,CAACwS,KAAK,CAACoN,OAAO;MAChC8d,OAAO,IAAI19B,OAAO,CAACwS,KAAK,CAACsN,OAAO;IACpC,CAAC,CAAC;IAAA,KACG;MACDomB,OAAO,IAAI,IAAI,CAAC94B,MAAM,CAACgS,KAAK,GAAG,GAAG;MAClCse,OAAO,IAAI,IAAI,CAACtwB,MAAM,CAACiS,MAAM,GAAG,GAAG;IACvC;IAEA0mB,MAAM,CAACtZ,KAAK,CAAC5M,IAAI,GAAGqmB,OAAO,GAAG,IAAI;IAClCH,MAAM,CAACtZ,KAAK,CAAC1M,GAAG,GAAG2d,OAAO,GAAG,IAAI;IAEjC,IAAI,CAACtwB,MAAM,CAACi0B,UAAU,CAACt/B,WAAW,CAACgkC,MAAM,CAAC;;IAE1C;IACA,IAAI/lC,OAAO,CAACuqC,aAAa,EAAC;MACtB,IAAIG,EAAE,GAAG,EAAE;MACX,IAAIC,OAAO,GAAG,KAAK;MACnB,IAAID,EAAE,GAAG3E,MAAM,CAACW,gBAAgB,CAAC,OAAO,CAAC,EAAC;QACtCgE,EAAE,CAAC/D,OAAO,CAAC,UAASiE,EAAE,EAAE;UACpBA,EAAE,CAACr4B,gBAAgB,CAAC,SAAS,EAAC,UAAS7f,CAAC,EAAC;YACrCqzC,MAAM,CAACoE,QAAQ,EAAE;YACjB,IAAIz3C,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;cACjBwU,MAAM,CAACtU,KAAK,EAAE;YAClB,CAAC,MAAM,IAAI/+B,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;cACxB;YACJ;YACA;YACA7+B,CAAC,CAACsuB,cAAc,EAAE;YAClBtuB,CAAC,CAACuuB,eAAe,EAAE;UACvB,CAAC,CAAC;UACF,IAAI,CAAC0pB,OAAO,EAAEC,EAAE,CAAChf,KAAK,EAAE;QAC5B,CAAC,CAAC;MACN;IACJ;IAEAma,MAAM,CAACoE,QAAQ,GAAG,YAAU;MACxBpE,MAAM,CAACC,WAAW,GAAG,IAAI;IAC7B,CAAC;IACDD,MAAM,CAACtU,KAAK,GAAG,YAAW;MACtB,IAAIsU,MAAM,CAAC1E,UAAU,EAAE;QACnB0E,MAAM,CAAC1E,UAAU,CAACr/B,WAAW,CAAC+jC,MAAM,CAAC;MACzC;IACJ,CAAC;IAED,IAAIK,gBAAgB,GAAG,IAAI;IAC3B,IAAII,eAAe,GAAG,KAAK;IAC3BT,MAAM,CAACxzB,gBAAgB,CAAC,YAAY,EAAE,UAAS7f,CAAC,EAAE;MAC9C,IAAI8zC,eAAe,EACf;MACJ,IAAGxmC,OAAO,CAACwqC,YAAY,IAAI30C,SAAS,CAAC6E,2BAA2B,EAC5D,IAAI,CAACqrC,MAAM,CAACC,WAAW,IAAInwC,SAAS,CAAC6E,2BAA2B,EAC5D0rC,gBAAgB,GAAG3zC,UAAU,CAACszC,MAAM,CAACtU,KAAK,EAAE57B,SAAS,CAAC8E,iCAAiC,CAAC,CAAC,CAAC;IACtG,CAAC,CAAC;;IACForC,MAAM,CAACxzB,gBAAgB,CAAC,YAAY,EAAE,UAAS7f,CAAC,EAAE;MAC9C,IAAGsN,OAAO,CAACwqC,YAAY,IAAI30C,SAAS,CAAC6E,2BAA2B,EAC5D,IAAG0rC,gBAAgB,EAAEzzC,YAAY,CAACyzC,gBAAgB,CAAC;IAC3D,CAAC,CAAC;IACF,IAAIK,QAAQ,GAAGV,MAAM,CAACW,gBAAgB,CAAC,QAAQ,CAAC;IAChD,IAAID,QAAQ,EAAC;MACT;MACAA,QAAQ,CAACE,OAAO,CAAC,UAASC,KAAK,EAAE;QAC7BA,KAAK,CAACr0B,gBAAgB,CAAC,OAAO,EAAE,UAAS7f,CAAC,EAAE;UACxC8zC,eAAe,EAAE;QACrB,CAAC,CAAC;QACFI,KAAK,CAACr0B,gBAAgB,CAAC,MAAM,EAAE,UAAS7f,CAAC,EAAE;UACxC8zC,eAAe,GAAG,CAAC;QACtB,CAAC,CAAC;QACFI,KAAK,CAACr0B,gBAAgB,CAAC,QAAQ,EAAE,UAAS7f,CAAC,EAAE;UACzC8zC,eAAe,GAAG,CAAC,CAAC;QACxB,CAAC,CAAC;MACN,CAAC,CAAC;IACN;IAEA,OAAOT,MAAM;EACjB,CAAC;EAEJx+B,YAAY,CAACnT,SAAS,CAACy2C,WAAW,GAAG,UAASv2C,KAAK,EAAE0L,OAAO,EAAE;IAC7DA,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;IAEvB,IAAIgpB,UAAU,GAAGhpB,OAAO,CAAC+H,MAAM,IAAIA,MAAM;IACzC,IAAI+iC,IAAI,GAAGxpC,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;IACxCgpC,IAAI,CAACziB,SAAS,GAAG,kBAAkB;IACnCyiB,IAAI,CAACpG,SAAS,GAAG,oMAAoM;IACrNoG,IAAI,CAACC,MAAM,GAAGD,IAAI,CAAC9oB,aAAa,CAAC,gBAAgB,CAAC;IAElD,IAAGhiB,OAAO,CAACof,KAAK,EACf0rB,IAAI,CAACre,KAAK,CAACrN,KAAK,GAAGpf,OAAO,CAACof,KAAK,IAAIpf,OAAO,CAACof,KAAK,CAAC3hB,WAAW,KAAKwd,MAAM,GAAG,IAAI,GAAG,EAAE,CAAC;IACtF,IAAGjb,OAAO,CAACqf,MAAM,EAChByrB,IAAI,CAACre,KAAK,CAACpN,MAAM,GAAGrf,OAAO,CAACqf,MAAM,IAAIrf,OAAO,CAACqf,MAAM,CAAC5hB,WAAW,KAAKwd,MAAM,GAAG,IAAI,GAAG,EAAE,CAAC;IACzF,IAAGjb,OAAO,CAACgrC,QAAQ,EACnB;MACC,IAAIvZ,KAAK,GAAGnwB,QAAQ,CAACQ,aAAa,CAAC,MAAM,CAAC;MAC1C2vB,KAAK,CAACiT,SAAS,GAAG,UAAU;MAC5BjT,KAAK,CAACkX,SAAS,CAACr8B,GAAG,CAAC,OAAO,CAAC;MAC5BmlB,KAAK,CAAClf,gBAAgB,CAAC,OAAO,EAAC,YAAU;QACxCu4B,IAAI,CAACrZ,KAAK,EAAE;MACb,CAAC,CAAC;MACFqZ,IAAI,CAACC,MAAM,CAAChpC,WAAW,CAAC0vB,KAAK,CAAC;IAC/B;IACAqZ,IAAI,CAACG,aAAa,GAAGH,IAAI,CAAC9oB,aAAa,CAAC,eAAe,CAAC;IACxD8oB,IAAI,CAACG,aAAa,CAACxG,SAAS,GAAGnwC,KAAK;IACpCw2C,IAAI,CAAClI,OAAO,GAAGkI,IAAI,CAAC9oB,aAAa,CAAC,iBAAiB,CAAC;IAC9C8oB,IAAI,CAACI,WAAW,GAAGJ,IAAI,CAAC9oB,aAAa,CAAC,qBAAqB,CAAC;IAClE8oB,IAAI,CAACK,MAAM,GAAGL,IAAI,CAAC9oB,aAAa,CAAC,gBAAgB,CAAC;IAElD8oB,IAAI,CAACrZ,KAAK,GAAG,YACb;MACI,IAAIqZ,IAAI,CAACM,OAAO,IAAI,OAAON,IAAI,CAACM,OAAO,IAAI,UAAU,EAAC;QAClDN,IAAI,CAACM,OAAO,EAAE;MAClB;MACAN,IAAI,CAACzJ,UAAU,CAACr/B,WAAW,CAAC8oC,IAAI,CAAC;MACjC;MACA,IAAG,IAAI,CAACzJ,UAAU,EAAC;QAClB,IAAI,CAACA,UAAU,CAACr/B,WAAW,CAAC,IAAI,CAAC;MAClC;MACA;IACJ,CAAC;;IAEK;IACA8oC,IAAI,CAACO,gBAAgB,GAAG,UAASruB,KAAK,EAAC;MACnC,IAAI,OAAOA,KAAK,IAAI,WAAW,EAAC;QAC5B,IAAIsuB,GAAG,GAAGtuB,KAAK,GAAG,OAAO,GAAG,MAAM;QAClC,IAAIuuB,IAAI,GAAGvuB,KAAK,GAAG,MAAM,GAAG,OAAO;MACvC,CAAC,MAAI;QACD,IAAIsuB,GAAG,GAAGR,IAAI,CAACI,WAAW,CAACze,KAAK,CAAC+e,OAAO,IAAI,OAAO,GAAG,OAAO,GAAG,MAAM;QACtE,IAAID,IAAI,GAAGT,IAAI,CAACI,WAAW,CAACze,KAAK,CAAC+e,OAAO,IAAI,OAAO,GAAG,MAAM,GAAG,OAAO;MAC3E;MACAV,IAAI,CAACI,WAAW,CAACze,KAAK,CAAC+e,OAAO,GAAGF,GAAG;MACpCR,IAAI,CAAClI,OAAO,CAACnW,KAAK,CAAC+e,OAAO,GAAGD,IAAI;IACrC,CAAC;IAEDT,IAAI,CAACW,sBAAsB,GAAG,UAASzuB,KAAK,EAAC;MACzC,IAAI,OAAOA,KAAK,IAAI,WAAW,EAAC;QAC5B,IAAIsuB,GAAG,GAAGtuB,KAAK,GAAG,OAAO,GAAG,MAAM;MACtC,CAAC,MAAI;QACD,IAAIsuB,GAAG,GAAGR,IAAI,CAACK,MAAM,CAAC1e,KAAK,CAAC+e,OAAO,IAAI,OAAO,GAAG,OAAO,GAAG,MAAM;MACrE;MACAV,IAAI,CAACK,MAAM,CAAC1e,KAAK,CAAC+e,OAAO,GAAGF,GAAG;IACnC,CAAC;IAEPR,IAAI,CAAC9lC,KAAK,GAAG,YACb;MACC,IAAI,CAAC49B,OAAO,CAAC8B,SAAS,GAAG,EAAE;IAC5B,CAAC;IAEDoG,IAAI,CAACY,OAAO,GAAG,UAAS1sC,IAAI,EAAE3C,SAAS,EAAEsvC,SAAS,EAClD;MACC,IAAIC,IAAI,GAAGtqC,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;MACxC,IAAGzF,SAAS,EACXuvC,IAAI,CAACvjB,SAAS,GAAGhsB,SAAS;MAC3BuvC,IAAI,CAAClH,SAAS,GAAG1lC,IAAI;MACrB,IAAG2sC,SAAS,EACXb,IAAI,CAACK,MAAM,CAACppC,WAAW,CAAC6pC,IAAI,CAAC,CAAC,KAE9Bd,IAAI,CAAClI,OAAO,CAAC7gC,WAAW,CAAC6pC,IAAI,CAAC;MAC/B,OAAOA,IAAI;IACZ,CAAC;IAEDd,IAAI,CAACe,SAAS,GAAG,UAAUv2C,IAAI,EAAEgd,QAAQ,EAAEtS,OAAO,EAClD;MACC,IAAI4rC,IAAI,GAAGtqC,QAAQ,CAACQ,aAAa,CAAC,QAAQ,CAAC;MAC3C8pC,IAAI,CAACnH,SAAS,GAAGnvC,IAAI;MACrBs2C,IAAI,CAAC5rC,OAAO,GAAGA,OAAO;MACtB4rC,IAAI,CAACjD,SAAS,CAACr8B,GAAG,CAAC,KAAK,CAAC;MACzBs/B,IAAI,CAACr5B,gBAAgB,CAAC,OAAO,EAACD,QAAQ,CAAC;MACvCw4B,IAAI,CAACK,MAAM,CAACppC,WAAW,CAAC6pC,IAAI,CAAC;MAC7B,OAAOA,IAAI;IACZ,CAAC;IAEDd,IAAI,CAACgB,YAAY,GAAG,YACpB;MACC,IAAIF,IAAI,GAAGtqC,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;MACxC8pC,IAAI,CAACvjB,SAAS,GAAG,WAAW;MAC5ByiB,IAAI,CAAClI,OAAO,CAAC7gC,WAAW,CAAC6pC,IAAI,CAAC;IAC/B,CAAC;IAEDd,IAAI,CAACnyB,SAAS,GAAG,UAAU5c,IAAI,EAAEzG,IAAI,EAAE4Z,KAAK,EAAElP,OAAO,EAAEsS,QAAQ,EAC/D;MACCtS,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;MACvB,IAAI+rC,SAAS,GAAGruC,MAAM,CAACwR,KAAK,CAAC;MAC7BnT,IAAI,GAAGA,IAAI,CAAC4B,WAAW,EAAE;MACzB,IAAG5B,IAAI,IAAI,QAAQ,EAClBgwC,SAAS,GAAG78B,KAAK,CAAC2pB,OAAO,CAAC,CAAC,CAAC;MAE7B,IAAI+S,IAAI,GAAGtqC,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;MACxC8pC,IAAI,CAACvjB,SAAS,GAAG,UAAU;MAC3BujB,IAAI,CAAClH,SAAS,GAAG,yEAAyE;MAC1FkH,IAAI,CAAC5pB,aAAa,CAAC,gBAAgB,CAAC,CAACyiB,SAAS,GAAGzkC,OAAO,CAACgY,KAAK,IAAI1iB,IAAI;MACtE,IAAIyxC,aAAa,GAAG6E,IAAI,CAAC5pB,aAAa,CAAC,iBAAiB,CAAC;MACzD+kB,aAAa,CAACtC,SAAS,GAAGsH,SAAS;MACnCH,IAAI,CAAC7B,OAAO,CAAC,UAAU,CAAC,GAAGz0C,IAAI;MAC/Bs2C,IAAI,CAAC7B,OAAO,CAAC,MAAM,CAAC,GAAG/pC,OAAO,CAACjE,IAAI,IAAIA,IAAI;MAC3C6vC,IAAI,CAAC5rC,OAAO,GAAGA,OAAO;MACtB4rC,IAAI,CAAC18B,KAAK,GAAGA,KAAK;MAElB,IAAInT,IAAI,IAAI,MAAM,EACjB6vC,IAAI,CAACr5B,gBAAgB,CAAC,OAAO,EAAE,UAAS7f,CAAC,EAAC;QAAEo4C,IAAI,CAACkB,iBAAiB,CAAE,IAAI,CAACjC,OAAO,CAAC,UAAU,CAAC,CAAE;MAAE,CAAC,CAAC,CAAC,KAC/F,IAAIhuC,IAAI,IAAI,SAAS,EAC1B;QACC6vC,IAAI,CAACjD,SAAS,CAACr8B,GAAG,CAAC,SAAS,CAAC;QAC7B,IAAG4C,KAAK,EACP08B,IAAI,CAACjD,SAAS,CAACr8B,GAAG,CAAC,SAAS,CAAC;QAC9Bs/B,IAAI,CAACr5B,gBAAgB,CAAC,OAAO,EAAE,YAAU;UACxC;UACA;UACA,IAAI05B,QAAQ,GAAG,IAAI,CAAClC,OAAO,CAAC,UAAU,CAAC;UACvC,IAAI,CAAC76B,KAAK,GAAG,CAAC,IAAI,CAACA,KAAK;UACxB,IAAI,CAACy5B,SAAS,CAACuD,MAAM,CAAC,SAAS,CAAC;UAChC,IAAI,CAAClqB,aAAa,CAAC,iBAAiB,CAAC,CAACyiB,SAAS,GAAG,IAAI,CAACv1B,KAAK,GAAG,MAAM,GAAG,OAAO;UAC/Ei9B,WAAW,CAACF,QAAQ,EAAE,IAAI,CAAC/8B,KAAK,CAAE;QACnC,CAAC,CAAC;MACH,CAAC,MACI,IAAInT,IAAI,IAAI,QAAQ,IAAIA,IAAI,IAAI,QAAQ,EAC7C;QACCgrC,aAAa,CAACqF,YAAY,CAAC,iBAAiB,EAAC,IAAI,CAAC;QAClDrF,aAAa,CAACx0B,gBAAgB,CAAC,SAAS,EAAE,UAAS7f,CAAC,EAAC;UACpD,IAAGA,CAAC,CAACsM,IAAI,IAAI,OAAO,KAAKjD,IAAI,IAAI,QAAQ,IAAI,CAACrJ,CAAC,CAACq6B,QAAQ,CAAC;YAAE;YAC3D;cACCr6B,CAAC,CAACsuB,cAAc,EAAE;cAClB,IAAI,CAAC8mB,IAAI,EAAE;YACZ;QACD,CAAC,CAAC;QACFf,aAAa,CAACx0B,gBAAgB,CAAC,MAAM,EAAE,YAAU;UAChD,IAAIvV,CAAC,GAAG,IAAI,CAACynC,SAAS;UACtB,IAAIwH,QAAQ,GAAG,IAAI,CAAC5K,UAAU,CAAC0I,OAAO,CAAC,UAAU,CAAC;UAClD,IAAIsC,QAAQ,GAAG,IAAI,CAAChL,UAAU,CAAC0I,OAAO,CAAC,MAAM,CAAC;UAC9C,IAAIsC,QAAQ,IAAI,QAAQ,EACvBrvC,CAAC,GAAGie,MAAM,CAACje,CAAC,CAAC;UACdmvC,WAAW,CAACF,QAAQ,EAAEjvC,CAAC,CAAC;QACzB,CAAC,CAAC;MACH,CAAC,MACI,IAAIjB,IAAI,IAAI,MAAM,IAAIA,IAAI,IAAI,OAAO,EAAE;QAC3C,IAAIgwC,SAAS,GAAGxkC,YAAY,CAAC68B,yBAAyB,CAAEl1B,KAAK,EAAElP,OAAO,CAAC4Y,MAAM,CAAE;QAC/EmuB,aAAa,CAACtC,SAAS,GAAGsH,SAAS;QAEnChF,aAAa,CAACx0B,gBAAgB,CAAC,OAAO,EAAE,UAASC,KAAK,EAAC;UACtD,IAAIoG,MAAM,GAAG5Y,OAAO,CAAC4Y,MAAM,IAAI,EAAE;UACjC,IAAIqzB,QAAQ,GAAG,IAAI,CAAC5K,UAAU,CAAC0I,OAAO,CAAC,UAAU,CAAC;UAClD,IAAIuC,SAAS,GAAG,IAAI;UACpB,IAAIzL,IAAI,GAAG,IAAIhrC,SAAS,CAACirC,WAAW,CAACloB,MAAM,EAAC;YAC1CpG,KAAK,EAAEA,KAAK;YACZ6V,SAAS,EAAE,MAAM;YACjB/V,QAAQ,EAAEouB;UACX,CAAC,EACD1X,UAAU,CAAC;UACZ,SAAS0X,aAAa,CAAC1jC,CAAC,EAAE2jC,MAAM,EAAEnuB,KAAK,EAAE;YACxC;YACA;YACA85B,SAAS,CAAC7H,SAAS,GAAGznC,CAAC;YACvBmvC,WAAW,CAACF,QAAQ,EAACjvC,CAAC,CAAC;YACvB,OAAO,KAAK;UACb;QACD,CAAC,CAAC;MACM;MAET8tC,IAAI,CAAClI,OAAO,CAAC7gC,WAAW,CAAC6pC,IAAI,CAAC;MAE9B,SAASO,WAAW,CAAC72C,IAAI,EAAE4Z,KAAK,EAChC;QACC;QACA;QACA,IAAGlP,OAAO,CAACsS,QAAQ,EAClBtS,OAAO,CAACsS,QAAQ,CAAChd,IAAI,EAAC4Z,KAAK,EAAClP,OAAO,CAAC;QACrC,IAAGsS,QAAQ,EACVA,QAAQ,CAAChd,IAAI,EAAC4Z,KAAK,EAAClP,OAAO,CAAC;MAC9B;MAEA,OAAO4rC,IAAI;IACZ,CAAC;IAEK,IAAId,IAAI,CAACyB,MAAM,IAAI,OAAOzB,IAAI,CAACyB,MAAM,IAAI,UAAU,EAAEzB,IAAI,CAACyB,MAAM,EAAE;IAExE,OAAOzB,IAAI;EACZ,CAAC;EAEDvjC,YAAY,CAAC68B,yBAAyB,GAAG,UAASl1B,KAAK,EAAE0J,MAAM,EAC/D;IACC,IAAG,CAACA,MAAM,EACT,OAAOlb,MAAM,CAACwR,KAAK,CAAC;IAErB,IAAG0J,MAAM,CAACnb,WAAW,KAAK3J,KAAK,EAC/B;MACC,OAAO4J,MAAM,CAACwR,KAAK,CAAC;IACrB;IAEA,IAAG0J,MAAM,CAACnb,WAAW,KAAKb,MAAM,EAChC;MACC,IAAI4vC,UAAU,GAAG,EAAE;MACnB,KAAI,IAAI/4B,CAAC,IAAImF,MAAM,EACnB;QACC,IAAGA,MAAM,CAACnF,CAAC,CAAC,IAAIvE,KAAK,EACpB;QACDs9B,UAAU,GAAG/4B,CAAC;QACd;MACD;MACA,OAAO/V,MAAM,CAACwR,KAAK,CAAC,GAAG,IAAI,GAACs9B,UAAU,GAAC,GAAG;IAC3C;EACD,CAAC;EAEEjlC,YAAY,CAACnT,SAAS,CAACq4C,WAAW,GAAG,YAAU;IAC3C,IAAIC,KAAK,GAAGprC,QAAQ,CAAC0gB,aAAa,CAAC,aAAa,CAAC;IACvD,IAAG0qB,KAAK,EACPA,KAAK,CAACjb,KAAK,EAAE;IACR,IAAIib,KAAK,GAAGprC,QAAQ,CAAC0gB,aAAa,CAAC,eAAe,CAAC;IACzD,IAAG0qB,KAAK,EACPA,KAAK,CAACjb,KAAK,EAAE;EACZ,CAAC;EAEDlqB,YAAY,CAACnT,SAAS,CAACu4C,yBAAyB,GAAG,UAASC,OAAO,EAAEC,IAAI,EAAEC,OAAO,EAAEC,QAAQ,EAAC;IACzF,IAAG,IAAI,CAACtvC,WAAW,IAAI,IAAI,CAACA,WAAW,CAACnI,IAAI,IAAI,gBAAgB,EAAC;MAC7D;MACA,IAAI,CAACu3C,IAAI,IAAI,CAACA,IAAI,CAACr6B,KAAK,IAAI,CAACq6B,IAAI,CAACr6B,KAAK,CAACrQ,MAAM,IAAI,CAAC0qC,IAAI,CAACr6B,KAAK,CAACrQ,MAAM,CAAC6qC,YAAY,EAAC;QAC9E/wC,OAAO,CAACqB,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC;QAClC;AAChB;QACgB;MACJ;MACA,IAAIgK,WAAW,GAAGulC,IAAI,CAACr6B,KAAK,CAACrQ,MAAM,CAAC6qC,YAAY;IACpD,CAAC,MAAI;MACD;MACA,IAAI1lC,WAAW,GAAG,IAAI;IAC1B;IACAA,WAAW,CAACmlC,WAAW,EAAE;IACzB,IAAIzjB,UAAU,GAAG1hB,WAAW,CAAC2hB,eAAe,EAAE;IAC9CyjB,KAAK,GAAGplC,WAAW,CAACujC,WAAW,CAAC,SAAS,EAAC;MACNG,QAAQ,EAAE,IAAI;MACbjjC,MAAM,EAAEihB,UAAU;MAClBujB,MAAM,EAAE,kBAAU;QACfjlC,WAAW,CAAC2lC,mBAAmB,GAAG,IAAI;MAC1C,CAAC;MACA7B,OAAO,EAAE,mBAAU;QAChB9jC,WAAW,CAAC2lC,mBAAmB,GAAG,KAAK;QACvC3lC,WAAW,CAACoqB,aAAa,GAAG,IAAI;MACpC;IACJ,CAAC,CAAC;IAClCpqB,WAAW,CAACoqB,aAAa,GAAGgb,KAAK;IACjCA,KAAK,CAAC9iC,EAAE,GAAG,cAAc;IAC/B8iC,KAAK,CAAC/D,SAAS,CAACr8B,GAAG,CAAC,UAAU,CAAC;IAEzB,SAAS4gC,aAAa,GAAE;MAEpBR,KAAK,CAAC9J,OAAO,CAAC8B,SAAS,GAAG,EAAE,CAAC,CAAC;;MAE9B,IAAIyI,OAAO,GAAG,SAAVA,OAAO,CAAY73C,IAAI,EAAE4Z,KAAK,EAAElP,OAAO,EAAC;QACxC,QAAO1K,IAAI;UACP;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;UACoB;YACI;YACA,IAAI0K,OAAO,IAAIA,OAAO,CAACotC,GAAG,EAAC;cACvB93C,IAAI,GAAG0K,OAAO,CAACotC,GAAG;YACtB;YACA,IAAIptC,OAAO,CAAC4Y,MAAM,EAAC;cACf1J,KAAK,GAAGtS,MAAM,CAACgc,MAAM,CAAC5Y,OAAO,CAAC4Y,MAAM,CAAC,CAACpW,OAAO,CAAC0M,KAAK,CAAC;YACxD;YACA;YACA5H,WAAW,CAAChS,IAAI,CAAC,GAAG4Z,KAAK;YACzB;QAAM;MAElB,CAAC;;MAED;;MAEA,IAAIm+B,MAAM,GAAGx3C,SAAS,CAACy3C,sBAAsB;MAC7CD,MAAM,CAAC5uC,IAAI,EAAE;MACb,KAAI8uC,EAAE,IAAIF,MAAM,EAAC;QACb,IAAIG,EAAE,GAAGH,MAAM,CAACE,EAAE,CAAC;QACnBb,KAAK,CAAC/zB,SAAS,CAAE,SAAS,EAAE60B,EAAE,EAAElmC,WAAW,CAACkmC,EAAE,CAAC,EAAE;UAACJ,GAAG,EAAEI,EAAE;UAAE54C,EAAE,EAAE,MAAM;UAAEG,GAAG,EAAE;QAAO,CAAC,EAAEo4C,OAAO,CAAC;MAClG;MAEA,IAAIM,MAAM,GAAG,CAAEnmC,WAAW,CAACmd,iBAAiB,CAAE;MAC9CioB,KAAK,CAAC/zB,SAAS,CAAE,OAAO,EAAE,aAAa,EAAE9iB,SAAS,CAACsD,iBAAiB,CAACmO,WAAW,CAACmd,iBAAiB,CAAC,EAAE;QAAC2oB,GAAG,EAAE,mBAAmB;QAAEx0B,MAAM,EAAE/iB,SAAS,CAACsD;MAAiB,CAAC,EAAEg0C,OAAO,CAAC;MAE9KT,KAAK,CAACZ,YAAY,EAAE;MAEpBY,KAAK,CAACvB,MAAM,CAACzG,SAAS,GAAG,EAAE,CAAC,CAAC;IAEvC;;IACMwI,aAAa,EAAE;IAErB5lC,WAAW,CAAC8F,MAAM,CAACi0B,UAAU,CAACt/B,WAAW,CAAE2qC,KAAK,CAAE;EAChD,CAAC;EAEDnlC,YAAY,CAACnT,SAAS,CAACk/B,iBAAiB,GAAG,UAAUrzB,IAAI,EAC5D;IACC,IAAI,CAACytC,aAAa,GAAGztC,IAAI;IACzB,IAAI,CAACwsC,WAAW,EAAE;IAClB,IAAIzjB,UAAU,GAAG,IAAI,CAACC,eAAe,EAAE;IACjC,IAAI7lB,IAAI,GAAG,IAAI;IACrB,IAAIkE,WAAW,GAAG,IAAI;IACtBolC,KAAK,GAAG,IAAI,CAAC7B,WAAW,CAAC5qC,IAAI,CAAC3L,KAAK,IAAI,EAAE,EAAC;MACQ02C,QAAQ,EAAE,IAAI;MACbjjC,MAAM,EAAEihB,UAAU;MAClBujB,MAAM,EAAE,kBAAU;QACfjlC,WAAW,CAACqmC,iBAAiB,GAAG,IAAI;MACxC,CAAC;MACAvC,OAAO,EAAE,mBAAU;QAChB9jC,WAAW,CAACqmC,iBAAiB,GAAG,KAAK;QACrCrmC,WAAW,CAACkqB,UAAU,GAAG,IAAI;MACjC;IACJ,CAAC,CAAC;IAC1ClqB,WAAW,CAACkqB,UAAU,GAAGkb,KAAK;IACpCA,KAAK,CAAC9iC,EAAE,GAAG,YAAY;IACvB8iC,KAAK,CAACzsC,IAAI,GAAGA,IAAI;IACjBysC,KAAK,CAAC/D,SAAS,CAACr8B,GAAG,CAAC,UAAU,CAAC;IAE/B,SAAS4gC,aAAa,GACtB;MACCR,KAAK,CAAC9J,OAAO,CAAC8B,SAAS,GAAG,EAAE,CAAC,CAAC;MAC9BgI,KAAK,CAAChB,OAAO,CAAC,0BAA0B,GAACzrC,IAAI,CAAClE,IAAI,GAAC,iCAAiC,IAAEkE,IAAI,CAACxC,WAAW,CAAC+B,IAAI,IAAI,EAAE,CAAC,GAAC,wCAAwC,CAAC;MAE5JktC,KAAK,CAAChB,OAAO,CAAC,qBAAqB,CAAC;MAE3B,IAAIyB,OAAO,GAAG,SAAVA,OAAO,CAAY73C,IAAI,EAAC4Z,KAAK,EAAC;QAClB5H,WAAW,CAACE,KAAK,CAACwF,YAAY,CAAC/M,IAAI,CAAC;QACpC,QAAO3K,IAAI;UACP,KAAK,OAAO;YACR2K,IAAI,CAAC3L,KAAK,GAAG4a,KAAK;YAClB;UACJ,KAAK,MAAM;YACP,IAAI0+B,EAAE,GAAGhxC,MAAM,CAACgc,MAAM,CAAC/iB,SAAS,CAAC2C,UAAU,CAAC,CAACgK,OAAO,CAAC0M,KAAK,CAAC;YAC3D,IAAI0+B,EAAE,IAAE,CAAC,IAAI/3C,SAAS,CAAC2C,UAAU,CAACo1C,EAAE,CAAC,EAAC;cAClC3tC,IAAI,CAACkW,UAAU,CAACy3B,EAAE,CAAC;YACvB,CAAC,MAAI;cACD3xC,OAAO,CAACqB,IAAI,CAAC,mBAAmB,GAAC4R,KAAK,CAAC;YAC3C;YACA;UACJ,KAAK,OAAO;YACR,IAAI3H,YAAY,CAAC+V,WAAW,CAACpO,KAAK,CAAC,EAAC;cAChCjP,IAAI,CAACgT,KAAK,GAAG1L,YAAY,CAAC+V,WAAW,CAACpO,KAAK,CAAC,CAAC+D,KAAK;cAClDhT,IAAI,CAACgU,OAAO,GAAG1M,YAAY,CAAC+V,WAAW,CAACpO,KAAK,CAAC,CAAC+E,OAAO;YAC1D,CAAC,MAAI;cACDhY,OAAO,CAACqB,IAAI,CAAC,oBAAoB,GAAC4R,KAAK,CAAC;YAC5C;YACA;UACJ;YACIjP,IAAI,CAACsU,WAAW,CAACjf,IAAI,EAAC4Z,KAAK,CAAC;YAC5B;QAAM;QAEd5H,WAAW,CAACE,KAAK,CAACgG,WAAW,EAAE;QAC/BlG,WAAW,CAACwf,YAAY,GAAG,IAAI;MACnC,CAAC;MAEb4lB,KAAK,CAAC/zB,SAAS,CAAE,QAAQ,EAAE,OAAO,EAAE1Y,IAAI,CAAC3L,KAAK,EAAE,CAAC,CAAC,EAAE64C,OAAO,CAAC;MAE5DT,KAAK,CAAC/zB,SAAS,CAAE,OAAO,EAAE,MAAM,EAAE9iB,SAAS,CAAC2C,UAAU,CAACyH,IAAI,CAACO,IAAI,CAAC,EAAE;QAACoY,MAAM,EAAE/iB,SAAS,CAAC2C;MAAU,CAAC,EAAE20C,OAAO,CAAC;MAE3G,IAAIU,OAAO,GAAG,EAAE;MAChB,IAAI5tC,IAAI,CAACgT,KAAK,KAAK9G,SAAS,EAAC;QACzB0hC,OAAO,GAAGjxC,MAAM,CAACmyB,IAAI,CAACxnB,YAAY,CAAC+V,WAAW,CAAC,CAAC1c,MAAM,CAAC,UAASktC,EAAE,EAAC;UAAE,OAAOvmC,YAAY,CAAC+V,WAAW,CAACwwB,EAAE,CAAC,CAAC76B,KAAK,IAAIhT,IAAI,CAACgT,KAAK;QAAE,CAAC,CAAC;MACpI;MAEAy5B,KAAK,CAAC/zB,SAAS,CAAE,OAAO,EAAE,OAAO,EAAEk1B,OAAO,EAAE;QAACj1B,MAAM,EAAEhc,MAAM,CAACmyB,IAAI,CAACxnB,YAAY,CAAC+V,WAAW;MAAC,CAAC,EAAE6vB,OAAO,CAAC;MAErG,KAAI,IAAIY,KAAK,IAAI9tC,IAAI,CAACnB,UAAU,EACzC;QACC,IAAIoQ,KAAK,GAAGjP,IAAI,CAACnB,UAAU,CAACivC,KAAK,CAAC;QAClC,IAAIt9B,IAAI,GAAGxQ,IAAI,CAACsY,eAAe,CAACw1B,KAAK,CAAC;QACtC,IAAIhyC,IAAI,GAAG0U,IAAI,CAAC1U,IAAI,IAAI,QAAQ;;QAEhC;QACA,IAAIkE,IAAI,CAAC+tC,oBAAoB,IAAI/tC,IAAI,CAAC+tC,oBAAoB,CAACD,KAAK,EAACrB,KAAK,CAAC,EACtE;QAEDA,KAAK,CAAC/zB,SAAS,CAAElI,IAAI,CAACiI,MAAM,IAAIjI,IAAI,CAAC1U,IAAI,EAAEgyC,KAAK,EAAE7+B,KAAK,EAAEuB,IAAI,EAAE08B,OAAO,CAAC;MACxE;MAEAT,KAAK,CAACZ,YAAY,EAAE;MAEpB,IAAG7rC,IAAI,CAACguC,qBAAqB,EAC5BhuC,IAAI,CAACguC,qBAAqB,CAACvB,KAAK,CAAC;MAEzBA,KAAK,CAACvB,MAAM,CAACzG,SAAS,GAAG,EAAE,CAAC,CAAC;MACtCgI,KAAK,CAACb,SAAS,CAAC,QAAQ,EAAC,YAAU;QAClC,IAAG5rC,IAAI,CAAC+zB,YAAY,EACnB;QACD/zB,IAAI,CAACuH,KAAK,CAACqF,MAAM,CAAC5M,IAAI,CAAC;QACvBysC,KAAK,CAACjb,KAAK,EAAE;MACd,CAAC,CAAC,CAACkX,SAAS,CAACr8B,GAAG,CAAC,QAAQ,CAAC;IAC3B;IAEAogC,KAAK,CAACV,iBAAiB,GAAG,UAAUC,QAAQ,EAC5C;MACUS,KAAK,CAAC/D,SAAS,CAAC97B,MAAM,CAAC,UAAU,CAAC;MAClC6/B,KAAK,CAAC/D,SAAS,CAACr8B,GAAG,CAAC,UAAU,CAAC;;MAGxC;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACIogC,KAAK,CAACxB,WAAW,CAACxG,SAAS,GAAG,oCAAoC;MAClE,IAAIwJ,QAAQ,GAAGxB,KAAK,CAACxB,WAAW,CAAClpB,aAAa,CAAC,UAAU,CAAC;MAC9C,IAAImsB,SAAS,GAAG,SAAZA,SAAS,GAAa;QACtBzB,KAAK,CAACrB,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAAC;QAC/BqB,KAAK,CAACjB,sBAAsB,CAAC,IAAI,CAAC;QAClCyC,QAAQ,CAAC7M,UAAU,CAACr/B,WAAW,CAACksC,QAAQ,CAAC;QACzCxB,KAAK,CAAC/D,SAAS,CAACr8B,GAAG,CAAC,UAAU,CAAC;QAC/BogC,KAAK,CAAC/D,SAAS,CAAC97B,MAAM,CAAC,UAAU,CAAC;QAClCqgC,aAAa,EAAE;MACnB,CAAC;MACbgB,QAAQ,CAACh/B,KAAK,GAAGjP,IAAI,CAACnB,UAAU,CAACmtC,QAAQ,CAAC;MAC1CiC,QAAQ,CAAC37B,gBAAgB,CAAC,SAAS,EAAE,UAAS7f,CAAC,EAAC;QAC/C,IAAGA,CAAC,CAACsM,IAAI,IAAI,OAAO,IAAItM,CAAC,CAACq5B,OAAO,EACjC;UACC9rB,IAAI,CAACsU,WAAW,CAAC03B,QAAQ,EAAEiC,QAAQ,CAACh/B,KAAK,CAAC;UACxBi/B,SAAS,EAAE;QAC9B;MACD,CAAC,CAAC;MACUzB,KAAK,CAACrB,gBAAgB,CAAC,IAAI,CAAC;MAC5BqB,KAAK,CAACjB,sBAAsB,CAAC,KAAK,CAAC;MAC/CyC,QAAQ,CAACzhB,KAAK,CAACpN,MAAM,GAAG,mBAAmB;MAC5C;MACA,IAAItF,MAAM,GAAG2yB,KAAK,CAACb,SAAS,CAAE,QAAQ,EAAE,YAAU;QACjD5rC,IAAI,CAACsU,WAAW,CAAC03B,QAAQ,EAAEiC,QAAQ,CAACh/B,KAAK,CAAC;QAC9Bi/B,SAAS,EAAE;MACxB,CAAC,CAAC;MACFzB,KAAK,CAACxB,WAAW,CAACnpC,WAAW,CAACgY,MAAM,CAAC,CAAC,CAAC;MACvC,IAAIosB,MAAM,GAAGuG,KAAK,CAACb,SAAS,CAAE,OAAO,EAAEsC,SAAS,CAAC;MACjDhI,MAAM,CAAC1Z,KAAK,CAAC2hB,KAAK,GAAG,OAAO;MAC5B1B,KAAK,CAACxB,WAAW,CAACnpC,WAAW,CAACokC,MAAM,CAAC,CAAC,CAAC;IACxC,CAAC;;IAED+G,aAAa,EAAE;IAEf,IAAI,CAAC9/B,MAAM,CAACi0B,UAAU,CAACt/B,WAAW,CAAE2qC,KAAK,CAAE;EAC5C,CAAC;EAEDnlC,YAAY,CAACnT,SAAS,CAAC0jC,4BAA4B,GAAG,UAAS73B,IAAI,EACnE;IACChE,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC;IAEjD,IAAImyC,SAAS,GAAG,IAAI,CAACjhC,MAAM,CAACi0B,UAAU,CAACrf,aAAa,CAAC,kBAAkB,CAAC;IACxE,IAAGqsB,SAAS,EACXA,SAAS,CAAC5c,KAAK,EAAE;IAElB,IAAIib,KAAK,GAAG,IAAI,CAAC7B,WAAW,CAAC,iBAAiB,EAAC;MAACG,QAAQ,EAAC,IAAI;MAAE5rB,KAAK,EAAE;IAAG,CAAC,CAAC;IAC3EstB,KAAK,CAACzsC,IAAI,GAAGA,IAAI;IACjBysC,KAAK,CAAC/D,SAAS,CAACr8B,GAAG,CAAC,iBAAiB,CAAC;IAEtC,SAAS4gC,aAAa,GACtB;MACCR,KAAK,CAAC1nC,KAAK,EAAE;;MAEb;MACA,IAAG/E,IAAI,CAACgH,MAAM,EACb,KAAI,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAE,EAAEU,CAAC,EAC1C;QACC,IAAIiX,KAAK,GAAGhL,IAAI,CAACgH,MAAM,CAACjT,CAAC,CAAC;QAC1B,IAAGiX,KAAK,CAAC2sB,kBAAkB,EAC1B;QACD,IAAI0S,IAAI,GAAG,iHAAiH;QAC5H,IAAIsB,IAAI,GAAGc,KAAK,CAAChB,OAAO,CAACpB,IAAI,EAAC,mBAAmB,CAAC;QAClDsB,IAAI,CAAC7B,OAAO,CAAC,MAAM,CAAC,GAAG9+B,KAAK,CAAC3V,IAAI;QACjCs2C,IAAI,CAAC7B,OAAO,CAAC,MAAM,CAAC,GAAG/1C,CAAC;QACxB43C,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAACyiB,SAAS,GAAGx5B,KAAK,CAAC3V,IAAI;QAClDs2C,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAACyiB,SAAS,GAAGx5B,KAAK,CAAClP,IAAI;QAClD6vC,IAAI,CAAC5pB,aAAa,CAAC,QAAQ,CAAC,CAACzP,gBAAgB,CAAC,OAAO,EAAC,UAAS7f,CAAC,EAAC;UAChEuN,IAAI,CAAC0P,WAAW,CAAEsL,MAAM,CAAE,IAAI,CAAComB,UAAU,CAAC0I,OAAO,CAAC,MAAM,CAAC,CAAE,CAAE;UAC7DmD,aAAa,EAAE;QAChB,CAAC,CAAC;MACH;IACF;;IAEA;IACA,IAAI5C,IAAI,GAAG,sIAAsI;IACjJ,IAAIsB,IAAI,GAAGc,KAAK,CAAChB,OAAO,CAACpB,IAAI,EAAC,yBAAyB,EAAE,IAAI,CAAC;IAC9DsB,IAAI,CAAC5pB,aAAa,CAAC,QAAQ,CAAC,CAACzP,gBAAgB,CAAC,OAAO,EAAE,UAAS7f,CAAC,EAAC;MACjE,IAAIk5C,IAAI,GAAG,IAAI,CAACvK,UAAU;MAC1B,IAAI/rC,IAAI,GAAGs2C,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAAC9S,KAAK;MAC5C,IAAInT,IAAI,GAAG6vC,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAAC9S,KAAK;MAC5C,IAAG,CAAC5Z,IAAI,IAAI2K,IAAI,CAAC+U,aAAa,CAAC1f,IAAI,CAAC,IAAI,CAAC,CAAC,EACzC;MACD2K,IAAI,CAACgP,QAAQ,CAAC3Z,IAAI,EAACyG,IAAI,CAAC;MACxB6vC,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAAC9S,KAAK,GAAG,EAAE;MACtC08B,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAAC9S,KAAK,GAAG,EAAE;MACtCg+B,aAAa,EAAE;IAChB,CAAC,CAAC;IAEFA,aAAa,EAAE;IACZ,IAAI,CAAC9/B,MAAM,CAACi0B,UAAU,CAACt/B,WAAW,CAAC2qC,KAAK,CAAC;IAC5C,OAAOA,KAAK;EACb,CAAC;EACEnlC,YAAY,CAACnT,SAAS,CAACgkC,iCAAiC,GAAG,UAAUn4B,IAAI,EAAE;IAEvE;IACA,IAAImD,IAAI,GAAG,IAAI;IACf;IACA,IAAIirC,SAAS,GAAG,IAAI,CAACjhC,MAAM,CAACi0B,UAAU,CAACrf,aAAa,CAAC,kBAAkB,CAAC;IACxE,IAAIqsB,SAAS,EACTA,SAAS,CAAC5c,KAAK,EAAE;IACrB;IACA,IAAIib,KAAK,GAAG,IAAI,CAAC7B,WAAW,CAAC,kBAAkB,EAAE;MAAEG,QAAQ,EAAE,IAAI;MAAE5rB,KAAK,EAAE;IAAI,CAAC,CAAC;IAChFstB,KAAK,CAACzsC,IAAI,GAAGA,IAAI;IACjBysC,KAAK,CAAC/D,SAAS,CAACr8B,GAAG,CAAC,iBAAiB,CAAC;IAEtC,SAAS4gC,aAAa,GAAG;MACrBR,KAAK,CAAC1nC,KAAK,EAAE;MACb;MACA,IAAI/E,IAAI,CAACiH,OAAO,EACZ,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiM,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC1C,IAAIiX,KAAK,GAAGhL,IAAI,CAACiH,OAAO,CAAClT,CAAC,CAAC;QAC3B,IAAIiX,KAAK,CAACqjC,mBAAmB,EACzB;QACJ,IAAIhE,IAAI,GAAG,iHAAiH;QAC5H,IAAIsB,IAAI,GAAGc,KAAK,CAAChB,OAAO,CAACpB,IAAI,EAAE,mBAAmB,CAAC;QACnDsB,IAAI,CAAC7B,OAAO,CAAC,MAAM,CAAC,GAAG9+B,KAAK,CAAC3V,IAAI;QACjCs2C,IAAI,CAAC7B,OAAO,CAAC,MAAM,CAAC,GAAG/1C,CAAC;QACxB43C,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAACyiB,SAAS,GAAGx5B,KAAK,CAAC3V,IAAI;QAClDs2C,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAACyiB,SAAS,GAAGx5B,KAAK,CAAClP,IAAI;QAClD6vC,IAAI,CAAC5pB,aAAa,CAAC,QAAQ,CAAC,CAACzP,gBAAgB,CAAC,OAAO,EAAE,UAAU7f,CAAC,EAAE;UAChEuN,IAAI,CAACmQ,YAAY,CAAC6K,MAAM,CAAC,IAAI,CAAComB,UAAU,CAAC0I,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;UAC1DmD,aAAa,EAAE;QACnB,CAAC,CAAC;MACN;IACR;;IAEA;IACA,IAAI5C,IAAI,GAAG,sIAAsI;IACjJ,IAAIsB,IAAI,GAAGc,KAAK,CAAChB,OAAO,CAACpB,IAAI,EAAE,yBAAyB,EAAE,IAAI,CAAC;IAC/DsB,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAACzP,gBAAgB,CAAC,SAAS,EAAE,UAAU7f,CAAC,EAAE;MACjE,IAAIA,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;QACjB1hB,SAAS,CAACxb,KAAK,CAAC,IAAI,CAAC;MACzB;IACJ,CAAC,CAAC;IACFu3C,IAAI,CAAC5pB,aAAa,CAAC,QAAQ,CAAC,CAACzP,gBAAgB,CAAC,OAAO,EAAE,UAAU7f,CAAC,EAAE;MAChEmd,SAAS,CAACxb,KAAK,CAAC,IAAI,CAAC;IACzB,CAAC,CAAC;IACF,SAASwb,SAAS,GAAG;MACjB,IAAI+7B,IAAI,GAAG,IAAI,CAACvK,UAAU;MAC1B,IAAI/rC,IAAI,GAAGs2C,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAAC9S,KAAK;MAC5C,IAAInT,IAAI,GAAG6vC,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAAC9S,KAAK;MAC5C,IAAI,CAAC5Z,IAAI,IAAI2K,IAAI,CAAC+V,cAAc,CAAC1gB,IAAI,CAAC,IAAI,CAAC,CAAC,EACxC;MACJ2K,IAAI,CAAC4P,SAAS,CAACva,IAAI,EAAEyG,IAAI,CAAC;MAC1B6vC,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAAC9S,KAAK,GAAG,EAAE;MACtC08B,IAAI,CAAC5pB,aAAa,CAAC,OAAO,CAAC,CAAC9S,KAAK,GAAG,EAAE;MACtCg+B,aAAa,EAAE;IACnB;IAEAA,aAAa,EAAE;IACf,IAAI,CAAC9/B,MAAM,CAACi0B,UAAU,CAACt/B,WAAW,CAAC2qC,KAAK,CAAC;IACzC,OAAOA,KAAK;EAChB,CAAC;EACJnlC,YAAY,CAACnT,SAAS,CAACwzB,WAAW,GAAG,YACrC;IACC,IAAG,CAAC,IAAI,CAACxa,MAAM,EACd;IACD,IAAImhC,MAAM,GAAG,IAAI,CAACnhC,MAAM,CAACi0B,UAAU,CAACqF,gBAAgB,CAAC,mBAAmB,CAAC;IACzE,KAAI,IAAI1yC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGu6C,MAAM,CAACj7C,MAAM,EAAE,EAAEU,CAAC,EACrC;MACC,IAAI04C,KAAK,GAAG6B,MAAM,CAACv6C,CAAC,CAAC;MACrB,IAAI,CAAC04C,KAAK,CAACzsC,IAAI,EACd;MACD,IAAI,CAACysC,KAAK,CAACzsC,IAAI,CAACuH,KAAK,IAAIklC,KAAK,CAACllC,KAAK,IAAI,IAAI,CAACA,KAAK,EACjDklC,KAAK,CAACjb,KAAK,EAAE;IACf;EACD,CAAC;EAEElqB,YAAY,CAACinC,kBAAkB,GAAG,UAASt/B,KAAK,EAAElP,OAAO,EAAEtN,CAAC,EAAEmuC,IAAI,EAAE5gC,IAAI,EAAE;IAC5EA,IAAI,CAACuH,KAAK,CAACwF,YAAY,EAAC,MAAM;IAE9B,IAAI43B,eAAe,GAAG,SAAlBA,eAAe,CAAY3kC,IAAI,EAAC;MACnCA,IAAI,CAAC8c,QAAQ,EAAE;IAChB,CAAC;IAED,IAAIzV,WAAW,GAAGC,YAAY,CAAC4jB,aAAa;IAC5C,IAAI,CAAC7jB,WAAW,CAAC+F,cAAc,IAAIzQ,MAAM,CAACmyB,IAAI,CAACznB,WAAW,CAAC+F,cAAc,CAAC,CAAC/Z,MAAM,IAAI,CAAC,EAAC;MACtFsxC,eAAe,CAAC3kC,IAAI,CAAC;IACtB,CAAC,MAAI;MACJ,KAAK,IAAIjM,CAAC,IAAIsT,WAAW,CAAC+F,cAAc,EAAE;QACzCu3B,eAAe,CAACt9B,WAAW,CAAC+F,cAAc,CAACrZ,CAAC,CAAC,CAAC;MAC/C;IACD;IAEAiM,IAAI,CAACuH,KAAK,CAACgG,WAAW,EAAC,MAAM;EAC3B,CAAC;EAEDjG,YAAY,CAACknC,aAAa,GAAG,UAASv/B,KAAK,EAAElP,OAAO,EAAEtN,CAAC,EAAEmuC,IAAI,EAAE5gC,IAAI,EAAE;IACjEA,IAAI,CAACid,GAAG,EAAE;EACd,CAAC;EAED3V,YAAY,CAACmnC,cAAc,GAAG,UAASx/B,KAAK,EAAElP,OAAO,EAAEtN,CAAC,EAAEmuC,IAAI,EAAE5gC,IAAI,EAAE;IAClE,IAAIpK,SAAS,CAACirC,WAAW,CACrBjrC,SAAS,CAAC2C,UAAU,EACpB;MAAEga,KAAK,EAAE9f,CAAC;MAAE4f,QAAQ,EAAEouB,aAAa;MAAEyC,UAAU,EAAEtC,IAAI;MAAE5gC,IAAI,EAAEA;IAAK,CAAC,CACtE;IAED,SAASygC,aAAa,CAAC1jC,CAAC,EAAE;MACtB,IAAI,CAACiD,IAAI,EAAE;QACP;MACJ;MACA,IAAI2tC,EAAE,GAAGhxC,MAAM,CAACgc,MAAM,CAAC/iB,SAAS,CAAC2C,UAAU,CAAC,CAACgK,OAAO,CAACxF,CAAC,CAAC;MACvD,IAAI4nC,eAAe,GAAG,SAAlBA,eAAe,CAAY3kC,IAAI,EAAC;QAC5C,IAAI2tC,EAAE,IAAE,CAAC,IAAI/3C,SAAS,CAAC2C,UAAU,CAACo1C,EAAE,CAAC,EACpC3tC,IAAI,CAACkW,UAAU,CAACy3B,EAAE,CAAC,CAAC,KACjB;UACH3xC,OAAO,CAACqB,IAAI,CAAC,mBAAmB,GAACN,CAAC,CAAC;UACnCiD,IAAI,CAACkW,UAAU,CAACtgB,SAAS,CAAC6C,MAAM,CAAC;QAClC;MACD,CAAC;MAED,IAAI4O,WAAW,GAAGC,YAAY,CAAC4jB,aAAa;MAC5C,IAAI,CAAC7jB,WAAW,CAAC+F,cAAc,IAAIzQ,MAAM,CAACmyB,IAAI,CAACznB,WAAW,CAAC+F,cAAc,CAAC,CAAC/Z,MAAM,IAAI,CAAC,EAAC;QACtFsxC,eAAe,CAAC3kC,IAAI,CAAC;MACtB,CAAC,MAAI;QACJ,KAAK,IAAIjM,CAAC,IAAIsT,WAAW,CAAC+F,cAAc,EAAE;UACzCu3B,eAAe,CAACt9B,WAAW,CAAC+F,cAAc,CAACrZ,CAAC,CAAC,CAAC;QAC/C;MACD;IACK;IAEA,OAAO,KAAK;EAChB,CAAC;EAEDuT,YAAY,CAAConC,gBAAgB,GAAG,UAASz/B,KAAK,EAAElP,OAAO,EAAEtN,CAAC,EAAEmuC,IAAI,EAAE5gC,IAAI,EAAE;IACpE,IAAI,CAACA,IAAI,EAAE;MACP,MAAM,mBAAmB;IAC7B;IAEA,IAAI2Y,MAAM,GAAG,EAAE;IACfA,MAAM,CAAC3kB,IAAI,CAAC;MACRib,KAAK,EAAE,IAAI;MACX0zB,OAAO,EACH;IACR,CAAC,CAAC;IAEF,KAAK,IAAI5uC,CAAC,IAAIuT,YAAY,CAAC+V,WAAW,EAAE;MACpC,IAAIrK,KAAK,GAAG1L,YAAY,CAAC+V,WAAW,CAACtpB,CAAC,CAAC;MACvC,IAAIkb,KAAK,GAAG;QACRA,KAAK,EAAElb,CAAC;QACR4uC,OAAO,EACH,sFAAsF,GACtF3vB,KAAK,CAACA,KAAK,GACX,qBAAqB,GACrBA,KAAK,CAACgB,OAAO,GACb,IAAI,GACJjgB,CAAC,GACD;MACR,CAAC;MACD4kB,MAAM,CAAC3kB,IAAI,CAACib,KAAK,CAAC;IACtB;IACA,IAAIrZ,SAAS,CAACirC,WAAW,CAACloB,MAAM,EAAE;MAC9BpG,KAAK,EAAE9f,CAAC;MACR4f,QAAQ,EAAEouB,aAAa;MACvByC,UAAU,EAAEtC,IAAI;MAChB5gC,IAAI,EAAEA;IACV,CAAC,CAAC;IAEF,SAASygC,aAAa,CAAC1jC,CAAC,EAAE;MACtB,IAAI,CAACiD,IAAI,EAAE;QACP;MACJ;MAEA,IAAIgT,KAAK,GAAGjW,CAAC,CAACkS,KAAK,GAAG3H,YAAY,CAAC+V,WAAW,CAACtgB,CAAC,CAACkS,KAAK,CAAC,GAAG,IAAI;MAEvE,IAAI0/B,WAAW,GAAG,SAAdA,WAAW,CAAY3uC,IAAI,EAAC;QAC/B,IAAIgT,KAAK,EAAE;UACV,IAAIhT,IAAI,CAACxC,WAAW,KAAK5H,SAAS,CAAC2W,WAAW,EAAE;YAC/CvM,IAAI,CAACgT,KAAK,GAAGA,KAAK,CAACuK,UAAU;UAC9B,CAAC,MAAM;YACNvd,IAAI,CAACgT,KAAK,GAAGA,KAAK,CAACA,KAAK;YACxBhT,IAAI,CAACgU,OAAO,GAAGhB,KAAK,CAACgB,OAAO;UAC7B;QACD,CAAC,MAAM;UACN,OAAOhU,IAAI,CAACgT,KAAK;UACjB,OAAOhT,IAAI,CAACgU,OAAO;QACpB;MACD,CAAC;MAED,IAAI3M,WAAW,GAAGC,YAAY,CAAC4jB,aAAa;MAC5C,IAAI,CAAC7jB,WAAW,CAAC+F,cAAc,IAAIzQ,MAAM,CAACmyB,IAAI,CAACznB,WAAW,CAAC+F,cAAc,CAAC,CAAC/Z,MAAM,IAAI,CAAC,EAAC;QACtFs7C,WAAW,CAAC3uC,IAAI,CAAC;MAClB,CAAC,MAAI;QACJ,KAAK,IAAIjM,CAAC,IAAIsT,WAAW,CAAC+F,cAAc,EAAE;UACzCuhC,WAAW,CAACtnC,WAAW,CAAC+F,cAAc,CAACrZ,CAAC,CAAC,CAAC;QAC3C;MACD;MACSiM,IAAI,CAAC6L,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;IACnC;IAEA,OAAO,KAAK;EAChB,CAAC;EAEDvE,YAAY,CAACsnC,gBAAgB,GAAG,UAAS3/B,KAAK,EAAElP,OAAO,EAAEtN,CAAC,EAAEmuC,IAAI,EAAE5gC,IAAI,EAAE;IACpE,IAAI,CAACA,IAAI,EAAE;MACP,MAAM,gBAAgB;IAC1B;IAEA,IAAIpK,SAAS,CAACirC,WAAW,CAACjrC,SAAS,CAACgC,YAAY,EAAE;MAC9C2a,KAAK,EAAE9f,CAAC;MACR4f,QAAQ,EAAEouB,aAAa;MACvByC,UAAU,EAAEtC,IAAI;MAChB5gC,IAAI,EAAEA;IACV,CAAC,CAAC;IAEF,SAASygC,aAAa,CAAC1jC,CAAC,EAAE;MACtB,IAAI,CAACiD,IAAI,EAAE;QACP;MACJ;MACTA,IAAI,CAACuH,KAAK,CAACwF,YAAY,EAAC,MAAM,CAAC,CAAC;;MAEhC,IAAI43B,eAAe,GAAG,SAAlBA,eAAe,CAAY3kC,IAAI,EAAC;QACnCA,IAAI,CAACkU,KAAK,GAAGnX,CAAC;MACf,CAAC;MAED,IAAIsK,WAAW,GAAGC,YAAY,CAAC4jB,aAAa;MAC5C,IAAI,CAAC7jB,WAAW,CAAC+F,cAAc,IAAIzQ,MAAM,CAACmyB,IAAI,CAACznB,WAAW,CAAC+F,cAAc,CAAC,CAAC/Z,MAAM,IAAI,CAAC,EAAC;QACtFsxC,eAAe,CAAC3kC,IAAI,CAAC;MACtB,CAAC,MAAI;QACJ,KAAK,IAAIjM,CAAC,IAAIsT,WAAW,CAAC+F,cAAc,EAAE;UACzCu3B,eAAe,CAACt9B,WAAW,CAAC+F,cAAc,CAACrZ,CAAC,CAAC,CAAC;QAC/C;MACD;MAEAiM,IAAI,CAACuH,KAAK,CAACgG,WAAW,EAAC,MAAM,CAAC,CAAC;MACtBvN,IAAI,CAAC6L,cAAc,CAAC,IAAI,CAAC;IAC7B;IAEA,OAAO,KAAK;EAChB,CAAC;EAEDvE,YAAY,CAACunC,gBAAgB,GAAG,UAAS5/B,KAAK,EAAElP,OAAO,EAAEtN,CAAC,EAAEmuC,IAAI,EAAE5gC,IAAI,EAAE;IACpE,IAAI,CAACA,IAAI,EAAE;MACP,MAAM,gBAAgB;IAC1B;IAEN,IAAIuH,KAAK,GAAGvH,IAAI,CAACuH,KAAK;IACtBA,KAAK,CAACwF,YAAY,EAAE;IAGpB,IAAI43B,eAAe,GAAG,SAAlBA,eAAe,CAAY3kC,IAAI,EAAC;MACnC,IAAIA,IAAI,CAACwjC,SAAS,KAAK,KAAK,EAAE;QAC7B;MACD;MACAj8B,KAAK,CAACqF,MAAM,CAAC5M,IAAI,CAAC;IACnB,CAAC;IAED,IAAIqH,WAAW,GAAGC,YAAY,CAAC4jB,aAAa;IAC5C,IAAI,CAAC7jB,WAAW,CAAC+F,cAAc,IAAIzQ,MAAM,CAACmyB,IAAI,CAACznB,WAAW,CAAC+F,cAAc,CAAC,CAAC/Z,MAAM,IAAI,CAAC,EAAC;MACtFsxC,eAAe,CAAC3kC,IAAI,CAAC;IACtB,CAAC,MAAI;MACJ,KAAK,IAAIjM,CAAC,IAAIsT,WAAW,CAAC+F,cAAc,EAAE;QACzCu3B,eAAe,CAACt9B,WAAW,CAAC+F,cAAc,CAACrZ,CAAC,CAAC,CAAC;MAC/C;IACD;IAEAwT,KAAK,CAACgG,WAAW,EAAE;IACbvN,IAAI,CAAC6L,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;EACnC,CAAC;EAEDvE,YAAY,CAACwnC,oBAAoB,GAAG,UAAS7/B,KAAK,EAAElP,OAAO,EAAEtN,CAAC,EAAEmuC,IAAI,EAAE5gC,IAAI,EAAE;IAC9E,IAAIuH,KAAK,GAAGvH,IAAI,CAACuH,KAAK;IACtB,IAAIF,WAAW,GAAGC,YAAY,CAAC4jB,aAAa;IAC5C,IAAG,CAAC7jB,WAAW;MAAE;MAChB;IAED,IAAIyG,UAAU,GAAGnR,MAAM,CAACgc,MAAM,CAAEtR,WAAW,CAAC+F,cAAc,IAAI,CAAC,CAAC,CAAE;IAClE,IAAI,CAACU,UAAU,CAACza,MAAM,EACrBya,UAAU,GAAG,CAAE9N,IAAI,CAAE;IAEtB,IAAI6nB,aAAa,GAAGjyB,SAAS,CAACkK,UAAU,CAAC,gBAAgB,CAAC;IAC1D+nB,aAAa,CAACxrB,GAAG,GAAG2D,IAAI,CAAC3D,GAAG,CAAC/I,MAAM,EAAE;IACrCiU,KAAK,CAAC8E,GAAG,CAACwb,aAAa,CAAC;IAExBA,aAAa,CAACknB,cAAc,CAAEjhC,UAAU,CAAE;IAE1CzG,WAAW,CAAC4pB,gBAAgB,EAAE;IACxBjxB,IAAI,CAAC6L,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;EACnC,CAAC;EAEDvE,YAAY,CAAC0nC,eAAe,GAAG,UAAS//B,KAAK,EAAElP,OAAO,EAAEtN,CAAC,EAAEmuC,IAAI,EAAE5gC,IAAI,EAAE;IAEzEA,IAAI,CAACuH,KAAK,CAACwF,YAAY,EAAE;IAEzB,IAAIkiC,WAAW,GAAG,CAAC,CAAC;IAEpB,IAAItK,eAAe,GAAG,SAAlBA,eAAe,CAAY3kC,IAAI,EAAC;MACnC,IAAIA,IAAI,CAACkvC,QAAQ,IAAI,KAAK,EAAE;QAC3B;MACD;MACA,IAAI3gC,OAAO,GAAGvO,IAAI,CAACmU,KAAK,EAAE;MAC1B,IAAI,CAAC5F,OAAO,EAAE;QACb;MACD;MACAA,OAAO,CAAClS,GAAG,GAAG,CAAC2D,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE2D,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;MAChD2D,IAAI,CAACuH,KAAK,CAAC8E,GAAG,CAACkC,OAAO,CAAC;MACvB0gC,WAAW,CAAC1gC,OAAO,CAAC5E,EAAE,CAAC,GAAG4E,OAAO;IAClC,CAAC;IAED,IAAIlH,WAAW,GAAGC,YAAY,CAAC4jB,aAAa;IAC5C,IAAI,CAAC7jB,WAAW,CAAC+F,cAAc,IAAIzQ,MAAM,CAACmyB,IAAI,CAACznB,WAAW,CAAC+F,cAAc,CAAC,CAAC/Z,MAAM,IAAI,CAAC,EAAC;MACtFsxC,eAAe,CAAC3kC,IAAI,CAAC;IACtB,CAAC,MAAI;MACJ,KAAK,IAAIjM,CAAC,IAAIsT,WAAW,CAAC+F,cAAc,EAAE;QACzCu3B,eAAe,CAACt9B,WAAW,CAAC+F,cAAc,CAACrZ,CAAC,CAAC,CAAC;MAC/C;IACD;IAEA,IAAG4I,MAAM,CAACmyB,IAAI,CAACmgB,WAAW,CAAC,CAAC57C,MAAM,EAAC;MAClCgU,WAAW,CAAC2gB,WAAW,CAACinB,WAAW,CAAC;IACrC;IAEAjvC,IAAI,CAACuH,KAAK,CAACgG,WAAW,EAAE;IAElBvN,IAAI,CAAC6L,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;EACnC,CAAC;EAEDvE,YAAY,CAAC+V,WAAW,GAAG;IACvB8xB,GAAG,EAAE;MAAEn8B,KAAK,EAAE,MAAM;MAAEgB,OAAO,EAAE,MAAM;MAAEuJ,UAAU,EAAE;IAAO,CAAC;IAC3D6xB,KAAK,EAAE;MAAEp8B,KAAK,EAAE,SAAS;MAAEgB,OAAO,EAAE,SAAS;MAAEuJ,UAAU,EAAE;IAAU,CAAC;IACtE8xB,KAAK,EAAE;MAAEr8B,KAAK,EAAE,MAAM;MAAEgB,OAAO,EAAE,MAAM;MAAEuJ,UAAU,EAAE;IAAO,CAAC;IAC7D+xB,IAAI,EAAE;MAAEt8B,KAAK,EAAE,MAAM;MAAEgB,OAAO,EAAE,MAAM;MAAEuJ,UAAU,EAAE;IAAO,CAAC;IAC5DD,SAAS,EAAE;MACPtK,KAAK,EAAE,SAAS;MAChBgB,OAAO,EAAE,SAAS;MAClBuJ,UAAU,EAAE;IAChB,CAAC;IACDgyB,IAAI,EAAE;MAAEv8B,KAAK,EAAE,MAAM;MAAEgB,OAAO,EAAE,MAAM;MAAEuJ,UAAU,EAAE;IAAO,CAAC;IAC5DiyB,MAAM,EAAE;MAAEx8B,KAAK,EAAE,MAAM;MAAEgB,OAAO,EAAE,MAAM;MAAEuJ,UAAU,EAAE;IAAU,CAAC;IACjEkyB,MAAM,EAAE;MAAEz8B,KAAK,EAAE,MAAM;MAAEgB,OAAO,EAAE,MAAM;MAAEuJ,UAAU,EAAE;IAAU,CAAC;IACjEmyB,KAAK,EAAE;MAAE18B,KAAK,EAAE,MAAM;MAAEgB,OAAO,EAAE,MAAM;MAAEuJ,UAAU,EAAE;IAAO;EAChE,CAAC;EAEDjW,YAAY,CAACnT,SAAS,CAACw7C,oBAAoB,GAAG,YAAW;IACrD,IAAI5vC,OAAO,GAAG,IAAI;IACxB,IAAIoD,IAAI,GAAG,IAAI;IACT,IAAI,IAAI,CAACysC,cAAc,EAAE;MACrB7vC,OAAO,GAAG,IAAI,CAAC6vC,cAAc,EAAE;IACnC,CAAC,MAAM;MACH7vC,OAAO,GAAG,CACN;QACI4iC,OAAO,EAAE,UAAU;QACnBC,WAAW,EAAE,IAAI;QACjBvwB,QAAQ,EAAE/K,YAAY,CAACw6B;MAC3B,CAAC,EACD;QAAEa,OAAO,EAAE,WAAW;QAAEtwB,QAAQ,EAAE/K,YAAY,CAACq6B;MAAW;MACtE;MACY;MAAA,CACH;MACD;AACZ;AACA;;MAEY,IAAI,IAAI,CAACpa,YAAY,IAAI,IAAI,CAACA,YAAY,CAACl0B,MAAM,GAAG,CAAC,EAAE;QACnD0M,OAAO,CAAC/L,IAAI,CAAC,IAAI,EAAE;UACf2uC,OAAO,EAAE,gBAAgB;UACzBtwB,QAAQ,EAAE,IAAI,CAACuV,aAAa,CAACpjB,IAAI,CAAC,IAAI;QAC1C,CAAC,CAAC;MACN;IACJ;IAEA,IAAI,IAAI,CAACqrC,mBAAmB,EAAE;MAC1B,IAAIzpC,KAAK,GAAG,IAAI,CAACypC,mBAAmB,CAAC,IAAI,EAAE9vC,OAAO,CAAC;MACnD,IAAIqG,KAAK,EAAE;QACPrG,OAAO,GAAGA,OAAO,CAACzM,MAAM,CAAC8S,KAAK,CAAC;MACnC;IACJ;IAEA,OAAOrG,OAAO;EAClB,CAAC;;EAED;EACAuH,YAAY,CAACnT,SAAS,CAAC27C,kBAAkB,GAAG,UAAS9vC,IAAI,EAAE;IACvD,IAAID,OAAO,GAAG,IAAI;IAElB,IAAIC,IAAI,CAAC4vC,cAAc,EAAE;MACrB7vC,OAAO,GAAGC,IAAI,CAAC4vC,cAAc,CAAC,IAAI,CAAC;IACvC,CAAC,MAAM;MACH7vC,OAAO,GAAG,CACN;QACI4iC,OAAO,EAAE,QAAQ;QACjBC,WAAW,EAAE,IAAI;QACjB/C,QAAQ,EAAE,IAAI;QACdxtB,QAAQ,EAAE/K,YAAY,CAAC+7B;MAC3B,CAAC,EACD;QACIV,OAAO,EAAE,SAAS;QAClBC,WAAW,EAAE,IAAI;QACjB/C,QAAQ,EAAE,IAAI;QACdxtB,QAAQ,EAAE/K,YAAY,CAACs8B;MAC3B,CAAC,EACD,IAAI,EACJ;QACIjB,OAAO,EAAE,YAAY;QACrBC,WAAW,EAAE,IAAI;QACjBvwB,QAAQ,EAAE/K,YAAY,CAAC48B;MAC3B,CAAC,EACD,IAAI,EACJ;QACIvB,OAAO,EAAE,OAAO;QAChBtwB,QAAQ,EAAE/K,YAAY,CAACq+B;MAC3B,CAAC,EACD;QACIhD,OAAO,EAAE,MAAM;QACfC,WAAW,EAAE,IAAI;QACjBvwB,QAAQ,EAAE/K,YAAY,CAACmnC;MAC3B,CAAC,CAAC;MACN,IAAGzuC,IAAI,CAACssB,SAAS,KAAK,KAAK,EAAC;QACxBvsB,OAAO,CAAC/L,IAAI,CAAC;UACT2uC,OAAO,EAAE,QAAQ;UAAEtwB,QAAQ,EAAE/K,YAAY,CAACo9B;QAC9C,CAAC,CAAC;MACN;MACA3kC,OAAO,CAAC/L,IAAI,CACR;QACI2uC,OAAO,EAAE,UAAU;QACnBtwB,QAAQ,EAAE/K,YAAY,CAACinC;MAC3B,CAAC,EACD;QAAE5L,OAAO,EAAE,KAAK;QAAEtwB,QAAQ,EAAE/K,YAAY,CAACknC;MAAc,CAAC,EACxD;QACI7L,OAAO,EAAE,QAAQ;QACjBC,WAAW,EAAE,IAAI;QACjBvwB,QAAQ,EAAE/K,YAAY,CAAConC;MAC3B,CAAC,EACD;QACI/L,OAAO,EAAE,QAAQ;QACjBC,WAAW,EAAE,IAAI;QACjBvwB,QAAQ,EAAE/K,YAAY,CAACsnC;MAC3B,CAAC,EACD,IAAI,CACP;IACL;IAEA,IAAI5uC,IAAI,CAACujC,WAAW,EAAE;MAClB,IAAIv8B,MAAM,GAAGhH,IAAI,CAACujC,WAAW,EAAE;MAC/B,IAAIv8B,MAAM,IAAIA,MAAM,CAAC3T,MAAM,EAAE;QACzB0M,OAAO,CAAC,CAAC,CAAC,CAAC8/B,QAAQ,GAAG,KAAK;MAC/B;IACJ;IAEA,IAAI7/B,IAAI,CAAC8jC,YAAY,EAAE;MACnB,IAAI78B,OAAO,GAAGjH,IAAI,CAAC8jC,YAAY,EAAE;MACjC,IAAI78B,OAAO,IAAIA,OAAO,CAAC5T,MAAM,EAAE;QAC3B0M,OAAO,CAAC,CAAC,CAAC,CAAC8/B,QAAQ,GAAG,KAAK;MAC/B;IACJ;IAEA,IAAI7/B,IAAI,CAAC6vC,mBAAmB,EAAE;MAC1B,IAAIzpC,KAAK,GAAGpG,IAAI,CAAC6vC,mBAAmB,CAAC,IAAI,EAAE9vC,OAAO,CAAC;MACnD,IAAIqG,KAAK,EAAE;QACPA,KAAK,CAACpS,IAAI,CAAC,IAAI,CAAC;QAChB+L,OAAO,GAAGqG,KAAK,CAAC9S,MAAM,CAACyM,OAAO,CAAC;MACnC;IACJ;IAEA,IAAIC,IAAI,CAACkvC,QAAQ,KAAK,KAAK,EAAE;MACzBnvC,OAAO,CAAC/L,IAAI,CAAC;QACT2uC,OAAO,EAAE,OAAO;QAChBtwB,QAAQ,EAAE/K,YAAY,CAAC0nC;MAC3B,CAAC,CAAC;IACN;IAEN,IAAG,CAAC;MAAE;MACNjvC,OAAO,CAAC/L,IAAI,CAAC;QACZ2uC,OAAO,EAAE,aAAa;QACtBtwB,QAAQ,EAAE/K,YAAY,CAACwnC;MACxB,CAAC,CAAC;IAEF/uC,OAAO,CAAC/L,IAAI,CAAC,IAAI,EAAE;MAClB2uC,OAAO,EAAE,QAAQ;MACjB9C,QAAQ,EAAE,EAAE7/B,IAAI,CAACwjC,SAAS,KAAK,KAAK,IAAI,CAACxjC,IAAI,CAAC+zB,YAAY,CAAE;MAC5D1hB,QAAQ,EAAE/K,YAAY,CAACunC;IACxB,CAAC,CAAC;IAEI,IAAI7uC,IAAI,CAACuH,KAAK,IAAIvH,IAAI,CAACuH,KAAK,CAACwoC,oBAAoB,EAAE;MAC/C/vC,IAAI,CAACuH,KAAK,CAACwoC,oBAAoB,CAAChwC,OAAO,EAAEC,IAAI,CAAC;IAClD;IAEA,OAAOD,OAAO;EAClB,CAAC;EAEDuH,YAAY,CAACnT,SAAS,CAAC67C,mBAAmB,GAAG,UAAShwC,IAAI,EAAE;IACxD,IAAI6E,CAAC,GAAG,CACJ;MAAE89B,OAAO,EAAE,OAAO;MAAEtwB,QAAQ,EAAE/K,YAAY,CAACq+B;IAAqB,CAAC,EACjE;MACIhD,OAAO,EAAE,OAAO;MAChBC,WAAW,EAAE,IAAI;MACjBvwB,QAAQ,EAAE/K,YAAY,CAAConC;IAC3B,CAAC,EACD;MACI/L,OAAO,EAAE,WAAW;MACpB9uB,QAAQ,EAAE,WAAW;MACrB/X,IAAI,EAAE,QAAQ;MACduW,QAAQ,EAAE/K,YAAY,CAACq+B;IAC3B,CAAC,EACD,IAAI,EACJ;MAAEhD,OAAO,EAAE,QAAQ;MAAEtwB,QAAQ,EAAE/K,YAAY,CAACunC;IAAiB,CAAC,CACjE;IAED,OAAOhqC,CAAC;EACZ,CAAC;EAEDyC,YAAY,CAACnT,SAAS,CAAC66B,kBAAkB,GAAG,UAAShvB,IAAI,EAAEuS,KAAK,EAAE;IAC9D,IAAIpP,IAAI,GAAG,IAAI;IACf,IAAIgK,MAAM,GAAG7F,YAAY,CAAC4jB,aAAa;IACvC,IAAInC,UAAU,GAAG5b,MAAM,CAAC6b,eAAe,EAAE;IAEzC,IAAIinB,SAAS,GAAG,IAAI;IACpB,IAAIlwC,OAAO,GAAG;MACVwS,KAAK,EAAEA,KAAK;MACZF,QAAQ,EAAE69B,oBAAoB;MAC9B9pC,KAAK,EAAEpG;IACX,CAAC;IAEP,IAAGA,IAAI,EACND,OAAO,CAAC1L,KAAK,GAAG2L,IAAI,CAAClE,IAAI;;IAEpB;IACA,IAAIkR,IAAI,GAAG,IAAI;IACf,IAAIhN,IAAI,EAAE;MACNgN,IAAI,GAAGhN,IAAI,CAACqZ,iBAAiB,CAAC9G,KAAK,CAAC4Y,OAAO,EAAE5Y,KAAK,CAAC6Y,OAAO,CAAC;MAC3D9jB,YAAY,CAAC6oC,WAAW,GAAGnwC,IAAI;IACnC;IAEA,IAAIgN,IAAI,EAAE;MACN;MACAijC,SAAS,GAAG,EAAE;MACd,IAAIjwC,IAAI,CAACowC,kBAAkB,EAAE;QACzBH,SAAS,GAAGjwC,IAAI,CAACowC,kBAAkB,CAACpjC,IAAI,CAAC;MAC7C,CAAC,MAAM;QACH,IACIA,IAAI,IACJA,IAAI,CAAChD,MAAM,IACXgD,IAAI,CAAChD,MAAM,CAAChE,KAAK,IACjBgH,IAAI,CAAChD,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAC1B;UACE48C,SAAS,CAACj8C,IAAI,CAAC;YAAE2uC,OAAO,EAAE,kBAAkB;YAAE31B,IAAI,EAAEA;UAAK,CAAC,CAAC;QAC/D;QACA,IAAIqjC,KAAK,GAAGrjC,IAAI,CAAChC,KAAK,IAAIgC,IAAI,CAAChD,MAAM;QACrC,IAAIqmC,KAAK,CAAC7M,SAAS,EAAC;UACnByM,SAAS,CAACj8C,IAAI,CACVq8C,KAAK,CAACC,MAAM,GACN,eAAe,GACf;YAAE3N,OAAO,EAAE,aAAa;YAAE31B,IAAI,EAAEA;UAAK,CAAC,CAC/C;QACL;QACG,IAAI,CAACqjC,KAAK,CAACx6B,UAAU,EAAC;UACrBo6B,SAAS,CAACj8C,IAAI,CAAC;YAAE2uC,OAAO,EAAE,aAAa;YAAE31B,IAAI,EAAEA;UAAK,CAAC,CAAC;QACvD;MAEJ;MACAjN,OAAO,CAAC1L,KAAK,GACT,CAAC2Y,IAAI,CAAChC,KAAK,GAAGgC,IAAI,CAAChC,KAAK,CAAClP,IAAI,GAAGkR,IAAI,CAAChD,MAAM,CAAClO,IAAI,KAAK,GAAG;MAC5D,IAAIkR,IAAI,CAAChC,KAAK,IAAIgC,IAAI,CAAChC,KAAK,CAAClP,IAAI,IAAIlG,SAAS,CAAC0C,MAAM,EAAE;QACnDyH,OAAO,CAAC1L,KAAK,GAAG,QAAQ;MAC5B;MACA,IAAI2Y,IAAI,CAAChD,MAAM,IAAIgD,IAAI,CAAChD,MAAM,CAAClO,IAAI,IAAIlG,SAAS,CAACyC,KAAK,EAAE;QACpD0H,OAAO,CAAC1L,KAAK,GAAG,OAAO;MAC3B;IACJ,CAAC,MAAM;MACH,IAAI2L,IAAI,EAAE;QACN;QACAiwC,SAAS,GAAG,IAAI,CAACH,kBAAkB,CAAC9vC,IAAI,CAAC;MAC7C,CAAC,MAAM;QACHiwC,SAAS,GAAG,IAAI,CAACN,oBAAoB,EAAE;QACvC,IAAIz9B,KAAK,GAAG,IAAI,CAAC3K,KAAK,CAAC2G,aAAa,CAChCqE,KAAK,CAAC4Y,OAAO,EACb5Y,KAAK,CAAC6Y,OAAO,CAChB;QACD,IAAIlZ,KAAK,EAAE;UACP;UACA+9B,SAAS,CAACj8C,IAAI,CAAC,IAAI,EAAE;YACjB2uC,OAAO,EAAE,YAAY;YACrBC,WAAW,EAAE,IAAI;YACjB2N,OAAO,EAAE;cACLl8C,KAAK,EAAE,OAAO;cACd+R,KAAK,EAAE8L,KAAK;cACZnS,OAAO,EAAE,IAAI,CAACiwC,mBAAmB,CAAC99B,KAAK;YAC3C;UACJ,CAAC,CAAC;QACN;MACJ;IACJ;;IAEA;IACA,IAAI,CAAC+9B,SAAS,EAAE;MACZ;IACJ;IAEA,IAAIrP,IAAI,GAAG,IAAIhrC,SAAS,CAACirC,WAAW,CAACoP,SAAS,EAAElwC,OAAO,EAAEgpB,UAAU,CAAC;IAEpE,SAASmnB,oBAAoB,CAACnzC,CAAC,EAAEgD,OAAO,EAAEtN,CAAC,EAAE;MACzC,IAAI,CAACsK,CAAC,EAAE;QACJ;MACJ;MAEA,IAAIA,CAAC,CAAC4lC,OAAO,IAAI,aAAa,EAAE;QAC5B,IAAInyB,IAAI,GAAGzT,CAAC,CAACiQ,IAAI;QACjBhN,IAAI,CAACuH,KAAK,CAACwF,YAAY,EAAE;QACzB,IAAIyD,IAAI,CAACxF,KAAK,EAAE;UACZhL,IAAI,CAAC0P,WAAW,CAACc,IAAI,CAACxD,IAAI,CAAC;QAC/B,CAAC,MAAM,IAAIwD,IAAI,CAACxG,MAAM,EAAE;UACpBhK,IAAI,CAACmQ,YAAY,CAACK,IAAI,CAACxD,IAAI,CAAC;QAChC;QACAhN,IAAI,CAACuH,KAAK,CAACgG,WAAW,EAAE;QACxB;MACJ,CAAC,MAAM,IAAIxQ,CAAC,CAAC4lC,OAAO,IAAI,kBAAkB,EAAE;QACxC,IAAInyB,IAAI,GAAGzT,CAAC,CAACiQ,IAAI;QACjBhN,IAAI,CAACuH,KAAK,CAACwF,YAAY,EAAE;QACzB,IAAIyD,IAAI,CAACxG,MAAM,EAAE;UACbhK,IAAI,CAACkN,gBAAgB,CAACsD,IAAI,CAACxD,IAAI,CAAC;QACpC,CAAC,MAAM,IAAIwD,IAAI,CAACxF,KAAK,EAAE;UACnBhL,IAAI,CAACiN,eAAe,CAACuD,IAAI,CAACxD,IAAI,CAAC;QACnC;QACAhN,IAAI,CAACuH,KAAK,CAACgG,WAAW,EAAE;QACxB;MACJ,CAAC,MAAM,IAAIxQ,CAAC,CAAC4lC,OAAO,IAAI,aAAa,EAAE;QACnC,IAAInyB,IAAI,GAAGzT,CAAC,CAACiQ,IAAI;QACjB,IAAImI,SAAS,GAAG3E,IAAI,CAACxF,KAAK,GACpBhL,IAAI,CAACiV,YAAY,CAACzE,IAAI,CAACxD,IAAI,CAAC,GAC5BhN,IAAI,CAACsV,aAAa,CAAC9E,IAAI,CAACxD,IAAI,CAAC;QACnC,IAAI84B,MAAM,GAAG3iC,IAAI,CAAC8mC,YAAY,CAC1B,iFAAiF,EACjFlqC,OAAO,CACV;QACD,IAAIiL,KAAK,GAAG86B,MAAM,CAAC/jB,aAAa,CAAC,OAAO,CAAC;QACzC,IAAI/W,KAAK,IAAImK,SAAS,EAAE;UACpBnK,KAAK,CAACiE,KAAK,GAAGkG,SAAS,CAAC4C,KAAK,IAAI,EAAE;QACvC;QACA,IAAIiuB,KAAK,GAAG,SAARA,KAAK,GAAa;UACrBhmC,IAAI,CAACuH,KAAK,CAACwF,YAAY,EAAE;UACtB,IAAI/B,KAAK,CAACiE,KAAK,EAAE;YACb,IAAIkG,SAAS,EAAE;cACXA,SAAS,CAAC4C,KAAK,GAAG/M,KAAK,CAACiE,KAAK;YACjC;YACA9L,IAAI,CAACqkB,QAAQ,CAAC,IAAI,CAAC;UACvB;UACAse,MAAM,CAACtU,KAAK,EAAE;UACdxxB,IAAI,CAACuH,KAAK,CAACgG,WAAW,EAAE;QAC5B,CAAC;QACDu4B,MAAM,CAAC/jB,aAAa,CAAC,QAAQ,CAAC,CAACzP,gBAAgB,CAAC,OAAO,EAAE0zB,KAAK,CAAC;QAC/Dh7B,KAAK,CAACsH,gBAAgB,CAAC,SAAS,EAAE,UAAS7f,CAAC,EAAE;UAC1CqzC,MAAM,CAACC,WAAW,GAAG,IAAI;UACzB,IAAItzC,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;YACjB;YACAwU,MAAM,CAACtU,KAAK,EAAE;UAClB,CAAC,MAAM,IAAI/+B,CAAC,CAAC6+B,OAAO,IAAI,EAAE,EAAE;YACxB0U,KAAK,EAAE,CAAC,CAAC;UACb,CAAC,MAAM,IAAIvzC,CAAC,CAAC6+B,OAAO,IAAI,EAAE,IAAI7+B,CAAC,CAACyP,MAAM,CAACsmB,SAAS,IAAI,UAAU,EAAE;YAC5D;UACJ;UACA/1B,CAAC,CAACsuB,cAAc,EAAE;UAClBtuB,CAAC,CAACuuB,eAAe,EAAE;QACvB,CAAC,CAAC;QACFhW,KAAK,CAAC2gB,KAAK,EAAE;MACjB;;MAEA;MACA;IACJ;EACJ,CAAC;;EAED;EACA;EACA,IAAI,OAAO7jB,MAAO,IAAI,WAAW,IAAIA,MAAM,CAAC0oC,wBAAwB,IAAI,CAAC1oC,MAAM,CAAC0oC,wBAAwB,CAACr8C,SAAS,CAACojC,SAAS,EAAE;IAC1HzvB,MAAM,CAAC0oC,wBAAwB,CAACr8C,SAAS,CAACojC,SAAS,GAAG,UAC5DhsB,CAAC,EACDG,CAAC,EACDkI,CAAC,EACD0c,CAAC,EACDmgB,MAAM,EACNC,UAAU,EACT;MACD,IAAIC,eAAe,GAAG,CAAC;MACvB,IAAIC,gBAAgB,GAAG,CAAC;MACxB,IAAIC,kBAAkB,GAAG,CAAC;MAC1B,IAAIC,mBAAmB,GAAG,CAAC;MAE3B,IAAKL,MAAM,KAAK,CAAC,EACjB;QACC,IAAI,CAAChxB,IAAI,CAAClU,CAAC,EAACG,CAAC,EAACkI,CAAC,EAAC0c,CAAC,CAAC;QAClB;MACD;MAEA,IAAGogB,UAAU,KAAKxkC,SAAS,EAC1BwkC,UAAU,GAAGD,MAAM;;MAEpB;MACA,IAAGA,MAAM,IAAI,IAAI,IAAIA,MAAM,CAACjzC,WAAW,KAAK3J,KAAK,EACjD;QACC,IAAG48C,MAAM,CAACp9C,MAAM,IAAI,CAAC,EACpBs9C,eAAe,GAAGC,gBAAgB,GAAGC,kBAAkB,GAAGC,mBAAmB,GAAGL,MAAM,CAAC,CAAC,CAAC,CAAC,KACtF,IAAGA,MAAM,CAACp9C,MAAM,IAAI,CAAC,EAC1B;UACCs9C,eAAe,GAAGG,mBAAmB,GAAGL,MAAM,CAAC,CAAC,CAAC;UACjDG,gBAAgB,GAAGC,kBAAkB,GAAGJ,MAAM,CAAC,CAAC,CAAC;QAClD,CAAC,MACI,IAAGA,MAAM,CAACp9C,MAAM,IAAI,CAAC,EAC1B;UACCs9C,eAAe,GAAGF,MAAM,CAAC,CAAC,CAAC;UAC3BG,gBAAgB,GAAGH,MAAM,CAAC,CAAC,CAAC;UAC5BI,kBAAkB,GAAGJ,MAAM,CAAC,CAAC,CAAC;UAC9BK,mBAAmB,GAAGL,MAAM,CAAC,CAAC,CAAC;QAChC,CAAC,MAEA;MACF,CAAC;QACI;QACL;UACCE,eAAe,GAAGF,MAAM,IAAI,CAAC;UAC7BG,gBAAgB,GAAGH,MAAM,IAAI,CAAC;UAC9BI,kBAAkB,GAAGH,UAAU,IAAI,CAAC;UACpCI,mBAAmB,GAAGJ,UAAU,IAAI,CAAC;QACtC;;MAEA;MACA,IAAI,CAACna,MAAM,CAAChrB,CAAC,GAAGolC,eAAe,EAAEjlC,CAAC,CAAC;MACnC,IAAI,CAAC8qB,MAAM,CAACjrB,CAAC,GAAGqI,CAAC,GAAGg9B,gBAAgB,EAAEllC,CAAC,CAAC;MACxC,IAAI,CAACqlC,gBAAgB,CAACxlC,CAAC,GAAGqI,CAAC,EAAElI,CAAC,EAAEH,CAAC,GAAGqI,CAAC,EAAElI,CAAC,GAAGklC,gBAAgB,CAAC;;MAE5D;MACA,IAAI,CAACpa,MAAM,CAACjrB,CAAC,GAAGqI,CAAC,EAAElI,CAAC,GAAG4kB,CAAC,GAAGwgB,mBAAmB,CAAC;MAC/C,IAAI,CAACC,gBAAgB,CACpBxlC,CAAC,GAAGqI,CAAC,EACLlI,CAAC,GAAG4kB,CAAC,EACL/kB,CAAC,GAAGqI,CAAC,GAAGk9B,mBAAmB,EAC3BplC,CAAC,GAAG4kB,CAAC,CACL;;MAED;MACA,IAAI,CAACkG,MAAM,CAACjrB,CAAC,GAAGulC,mBAAmB,EAAEplC,CAAC,GAAG4kB,CAAC,CAAC;MAC3C,IAAI,CAACygB,gBAAgB,CAACxlC,CAAC,EAAEG,CAAC,GAAG4kB,CAAC,EAAE/kB,CAAC,EAAEG,CAAC,GAAG4kB,CAAC,GAAGugB,kBAAkB,CAAC;;MAE9D;MACA,IAAI,CAACra,MAAM,CAACjrB,CAAC,EAAEG,CAAC,GAAGmlC,kBAAkB,CAAC;MACtC,IAAI,CAACE,gBAAgB,CAACxlC,CAAC,EAAEG,CAAC,EAAEH,CAAC,GAAGolC,eAAe,EAAEjlC,CAAC,CAAC;IACpD,CAAC;EACD,CAAC;;EAEE,SAASslC,cAAc,CAACpwC,CAAC,EAAEC,CAAC,EAAE;IAC1B,KAAK,IAAI9M,CAAC,IAAI6M,CAAC,EAAE;MACb,IAAIA,CAAC,CAAC7M,CAAC,CAAC,IAAI8M,CAAC,CAAC9M,CAAC,CAAC,EAAE;QACd,OAAO,KAAK;MAChB;IACJ;IACA,OAAO,IAAI;EACf;EACA6B,SAAS,CAACo7C,cAAc,GAAGA,cAAc;EAEzC,SAASnjB,QAAQ,CAACjtB,CAAC,EAAEC,CAAC,EAAE;IACpB,OAAOyV,IAAI,CAAC26B,IAAI,CACZ,CAACpwC,CAAC,CAAC,CAAC,CAAC,GAAGD,CAAC,CAAC,CAAC,CAAC,KAAKC,CAAC,CAAC,CAAC,CAAC,GAAGD,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAACC,CAAC,CAAC,CAAC,CAAC,GAAGD,CAAC,CAAC,CAAC,CAAC,KAAKC,CAAC,CAAC,CAAC,CAAC,GAAGD,CAAC,CAAC,CAAC,CAAC,CAAC,CAChE;EACL;EACAhL,SAAS,CAACi4B,QAAQ,GAAGA,QAAQ;EAE7B,SAASqjB,aAAa,CAAC9kC,CAAC,EAAE;IACtB,OACI,OAAO,GACPkK,IAAI,CAAC4F,KAAK,CAAC9P,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAACwsB,OAAO,EAAE,GAChC,GAAG,GACHtiB,IAAI,CAAC4F,KAAK,CAAC9P,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAACwsB,OAAO,EAAE,GAChC,GAAG,GACHtiB,IAAI,CAAC4F,KAAK,CAAC9P,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAACwsB,OAAO,EAAE,GAChC,GAAG,IACFxsB,CAAC,CAAC/Y,MAAM,IAAI,CAAC,GAAG+Y,CAAC,CAAC,CAAC,CAAC,CAACwsB,OAAO,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,GACzC,GAAG;EAEX;EACAhjC,SAAS,CAACs7C,aAAa,GAAGA,aAAa;EAEvC,SAAS/3B,iBAAiB,CAAC5N,CAAC,EAAEG,CAAC,EAAEkU,IAAI,EAAEE,GAAG,EAAEX,KAAK,EAAEC,MAAM,EAAE;IACvD,IAAIQ,IAAI,GAAGrU,CAAC,IAAIqU,IAAI,GAAGT,KAAK,GAAG5T,CAAC,IAAIuU,GAAG,GAAGpU,CAAC,IAAIoU,GAAG,GAAGV,MAAM,GAAG1T,CAAC,EAAE;MAC7D,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB;EACA9V,SAAS,CAACujB,iBAAiB,GAAGA,iBAAiB;;EAE/C;EACA,SAASg4B,YAAY,CAACxzB,QAAQ,EAAEpS,CAAC,EAAEG,CAAC,EAAE;IAClC,IAAIH,CAAC,GAAGoS,QAAQ,CAAC,CAAC,CAAC,EAAE;MACjBA,QAAQ,CAAC,CAAC,CAAC,GAAGpS,CAAC;IACnB,CAAC,MAAM,IAAIA,CAAC,GAAGoS,QAAQ,CAAC,CAAC,CAAC,EAAE;MACxBA,QAAQ,CAAC,CAAC,CAAC,GAAGpS,CAAC;IACnB;IAEA,IAAIG,CAAC,GAAGiS,QAAQ,CAAC,CAAC,CAAC,EAAE;MACjBA,QAAQ,CAAC,CAAC,CAAC,GAAGjS,CAAC;IACnB,CAAC,MAAM,IAAIA,CAAC,GAAGiS,QAAQ,CAAC,CAAC,CAAC,EAAE;MACxBA,QAAQ,CAAC,CAAC,CAAC,GAAGjS,CAAC;IACnB;EACJ;EACA9V,SAAS,CAACu7C,YAAY,GAAGA,YAAY;;EAErC;EACA,SAASC,gBAAgB,CAACC,CAAC,EAAEC,EAAE,EAAE;IAC7B,IACID,CAAC,CAAC,CAAC,CAAC,GAAGC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IACfD,CAAC,CAAC,CAAC,CAAC,GAAGC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IACfD,CAAC,CAAC,CAAC,CAAC,GAAGC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IACfD,CAAC,CAAC,CAAC,CAAC,GAAGC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EACjB;MACE,OAAO,KAAK;IAChB;IACA,OAAO,IAAI;EACf;EACA17C,SAAS,CAACw7C,gBAAgB,GAAGA,gBAAgB;;EAE7C;EACA,SAASjzB,eAAe,CAACvd,CAAC,EAAEC,CAAC,EAAE;IAC3B,IAAI0wC,OAAO,GAAG3wC,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC;IACzB,IAAI4wC,OAAO,GAAG5wC,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC;IACzB,IAAI6wC,OAAO,GAAG5wC,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC;IACzB,IAAI6wC,OAAO,GAAG7wC,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC;IAEzB,IACID,CAAC,CAAC,CAAC,CAAC,GAAG6wC,OAAO,IACd7wC,CAAC,CAAC,CAAC,CAAC,GAAG8wC,OAAO,IACdH,OAAO,GAAG1wC,CAAC,CAAC,CAAC,CAAC,IACd2wC,OAAO,GAAG3wC,CAAC,CAAC,CAAC,CAAC,EAChB;MACE,OAAO,KAAK;IAChB;IACA,OAAO,IAAI;EACf;EACAjL,SAAS,CAACuoB,eAAe,GAAGA,eAAe;;EAE3C;EACA;EACA;EACA,SAASwzB,OAAO,CAACC,GAAG,EAAE;IAClB,IAAIA,GAAG,CAACC,MAAM,CAAC,CAAC,CAAC,IAAI,GAAG,EAAE;MACtBD,GAAG,GAAGA,GAAG,CAAC7O,KAAK,CAAC,CAAC,CAAC;IACtB,CAAC,CAAC;IACF6O,GAAG,GAAGA,GAAG,CAACE,WAAW,EAAE;IACvB,IAAIC,aAAa,GAAG,kBAAkB;IACtC,IAAI9iC,KAAK,GAAG,IAAIpb,KAAK,CAAC,CAAC,CAAC;IACxB,IAAI2f,CAAC,GAAG,CAAC;IACT,IAAIw+B,IAAI,EAAEC,IAAI;IACd,KAAK,IAAIl+C,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAI,CAAC,EAAE;MAC3Bi+C,IAAI,GAAGD,aAAa,CAACxvC,OAAO,CAACqvC,GAAG,CAACC,MAAM,CAAC99C,CAAC,CAAC,CAAC;MAC3Ck+C,IAAI,GAAGF,aAAa,CAACxvC,OAAO,CAACqvC,GAAG,CAACC,MAAM,CAAC99C,CAAC,GAAG,CAAC,CAAC,CAAC;MAC/Ckb,KAAK,CAACuE,CAAC,CAAC,GAAGw+B,IAAI,GAAG,EAAE,GAAGC,IAAI;MAC3Bz+B,CAAC,EAAE;IACP;IACA,OAAOvE,KAAK;EAChB;EAEArZ,SAAS,CAAC+7C,OAAO,GAAGA,OAAO;;EAE3B;EACA;EACA,SAASO,OAAO,CAACC,OAAO,EAAE;IACtB,IAAIJ,aAAa,GAAG,kBAAkB;IACtC,IAAIH,GAAG,GAAG,GAAG;IACb,IAAII,IAAI,EAAEC,IAAI;IACd,KAAK,IAAIl+C,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAEA,CAAC,EAAE,EAAE;MACxBi+C,IAAI,GAAGG,OAAO,CAACp+C,CAAC,CAAC,GAAG,EAAE;MACtBk+C,IAAI,GAAGE,OAAO,CAACp+C,CAAC,CAAC,GAAG,EAAE;MAEtB69C,GAAG,IAAIG,aAAa,CAACF,MAAM,CAACG,IAAI,CAAC,GAAGD,aAAa,CAACF,MAAM,CAACI,IAAI,CAAC;IAClE;IACA,OAAOL,GAAG;EACd;EAEAh8C,SAAS,CAACs8C,OAAO,GAAGA,OAAO;;EAE3B;;EAEA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,SAASrR,WAAW,CAACloB,MAAM,EAAE5Y,OAAO,EAAE;IAClCA,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;IACvB,IAAI,CAACA,OAAO,GAAGA,OAAO;IACtB,IAAIoD,IAAI,GAAG,IAAI;;IAEf;IACA,IAAIpD,OAAO,CAACmjC,UAAU,EAAE;MACpB,IAAInjC,OAAO,CAACmjC,UAAU,CAAC1lC,WAAW,KAAK,IAAI,CAACA,WAAW,EAAE;QACrDxB,OAAO,CAACkE,KAAK,CACT,sDAAsD,CACzD;QACDH,OAAO,CAACmjC,UAAU,GAAG,IAAI;MAC7B,CAAC,MAAM;QACH,IAAI,CAACA,UAAU,GAAGnjC,OAAO,CAACmjC,UAAU;QACpC,IAAI,CAACA,UAAU,CAACkP,IAAI,GAAG,IAAI;QAC3B,IAAI,CAAClP,UAAU,CAACmP,eAAe,GAAG,IAAI;MAC1C;IACJ;IAEN,IAAIC,UAAU,GAAG,IAAI;IACrB,IAAGvyC,OAAO,CAACwS,KAAK;MAAE;MACjB+/B,UAAU,GAAGvyC,OAAO,CAACwS,KAAK,CAAC/U,WAAW,CAACnI,IAAI;IACtC,IAAKi9C,UAAU,KAAK,YAAY,IAC5BA,UAAU,KAAK,aAAa,IACrCA,UAAU,KAAK,cAAc,EACtB;MACEt2C,OAAO,CAACkE,KAAK,CACT,sFAAsF,GAACoyC,UAAU,GAAC,GAAG,CACxG;MACDvyC,OAAO,CAACwS,KAAK,GAAG,IAAI;IACxB;IAEA,IAAIs4B,IAAI,GAAGxpC,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;IACxCgpC,IAAI,CAACziB,SAAS,GAAG,6CAA6C;IAC9D,IAAIroB,OAAO,CAACqoB,SAAS,EAAE;MACnByiB,IAAI,CAACziB,SAAS,IAAI,GAAG,GAAGroB,OAAO,CAACqoB,SAAS;IAC7C;IACAyiB,IAAI,CAACre,KAAK,CAAC+lB,QAAQ,GAAG,GAAG;IACzB1H,IAAI,CAACre,KAAK,CAACgmB,SAAS,GAAG,GAAG;IAC1B3H,IAAI,CAACre,KAAK,CAACimB,aAAa,GAAG,MAAM;IACjCjgD,UAAU,CAAC,YAAW;MAClBq4C,IAAI,CAACre,KAAK,CAACimB,aAAa,GAAG,MAAM;IACrC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;;IAET;IACN78C,SAAS,CAACopB,kBAAkB,CAAC6rB,IAAI,EAAC,IAAI,EAC5B,UAASp4C,CAAC,EAAE;MAClB;MACUA,CAAC,CAACsuB,cAAc,EAAE;MAClB,OAAO,IAAI;IACf,CAAC,EACD,IAAI,CACP;IACD8pB,IAAI,CAACv4B,gBAAgB,CACjB,aAAa,EACb,UAAS7f,CAAC,EAAE;MACR,IAAIA,CAAC,CAACyzC,MAAM,IAAI,CAAC,EAAE;QACf;QACA,OAAO,KAAK;MAChB;MACAzzC,CAAC,CAACsuB,cAAc,EAAE;MAClB,OAAO,KAAK;IAChB,CAAC,EACD,IAAI,CACP;IAEDnrB,SAAS,CAACopB,kBAAkB,CAAC6rB,IAAI,EAAC,MAAM,EACpC,UAASp4C,CAAC,EAAE;MAClB;MACU,IAAIA,CAAC,CAACyzC,MAAM,IAAI,CAAC,EAAE;QACf/iC,IAAI,CAACquB,KAAK,EAAE;QACZ/+B,CAAC,CAACsuB,cAAc,EAAE;QAClB,OAAO,IAAI;MACf;IACJ,CAAC,EACD,IAAI,CACP;IAED,SAAS2xB,cAAc,CAACjgD,CAAC,EAAE;MACvB,IAAI4J,GAAG,GAAGs2C,QAAQ,CAAC9H,IAAI,CAACre,KAAK,CAAC1M,GAAG,CAAC;MAClC+qB,IAAI,CAACre,KAAK,CAAC1M,GAAG,GACV,CAACzjB,GAAG,GAAG5J,CAAC,CAACguB,MAAM,GAAG1gB,OAAO,CAAC6yC,YAAY,EAAEha,OAAO,EAAE,GAAG,IAAI;MAC5DnmC,CAAC,CAACsuB,cAAc,EAAE;MAClB,OAAO,IAAI;IACf;IAEA,IAAI,CAAChhB,OAAO,CAAC6yC,YAAY,EAAE;MACvB7yC,OAAO,CAAC6yC,YAAY,GAAG,GAAG;IAC9B;IAEA/H,IAAI,CAACv4B,gBAAgB,CAAC,OAAO,EAAEogC,cAAc,EAAE,IAAI,CAAC;IACpD7H,IAAI,CAACv4B,gBAAgB,CAAC,YAAY,EAAEogC,cAAc,EAAE,IAAI,CAAC;IAEzD,IAAI,CAAC7H,IAAI,GAAGA,IAAI;;IAEhB;IACA,IAAI9qC,OAAO,CAAC1L,KAAK,EAAE;MACf,IAAIgqB,OAAO,GAAGhd,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;MAC3Cwc,OAAO,CAAC+J,SAAS,GAAG,gBAAgB;MACpC/J,OAAO,CAAComB,SAAS,GAAG1kC,OAAO,CAAC1L,KAAK;MACjCw2C,IAAI,CAAC/oC,WAAW,CAACuc,OAAO,CAAC;IAC7B;;IAEA;IACA,IAAI7V,GAAG,GAAG,CAAC;IACX,KAAK,IAAIzU,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAG4kB,MAAM,CAACtlB,MAAM,EAAEU,CAAC,EAAE,EAAE;MAClC,IAAIsB,IAAI,GAAGsjB,MAAM,CAACnb,WAAW,IAAI3J,KAAK,GAAG8kB,MAAM,CAAC5kB,CAAC,CAAC,GAAGA,CAAC;MACtD,IAAIsB,IAAI,IAAI,IAAI,IAAIA,IAAI,CAACmI,WAAW,KAAKC,MAAM,EAAE;QAC7CpI,IAAI,GAAGA,IAAI,CAACstC,OAAO,KAAKz2B,SAAS,GAAGzO,MAAM,CAACpI,IAAI,CAAC,GAAGA,IAAI,CAACstC,OAAO;MACnE;MACA,IAAI1zB,KAAK,GAAG0J,MAAM,CAAC5kB,CAAC,CAAC;MACrB,IAAI,CAAC8+C,OAAO,CAACx9C,IAAI,EAAE4Z,KAAK,EAAElP,OAAO,CAAC;MAClCyI,GAAG,EAAE;IACT;;IAEA;IACA;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAEE5S,SAAS,CAACopB,kBAAkB,CAAC6rB,IAAI,EAAC,OAAO,EAAE,UAASp4C,CAAC,EAAE;MACpD;MACO,IAAIo4C,IAAI,CAACiI,aAAa,EAAE;QACpBpgD,YAAY,CAACm4C,IAAI,CAACiI,aAAa,CAAC;MACpC;IACJ,CAAC,CAAC;;IAEF;IACA,IAAIvL,aAAa,GAAGlmC,QAAQ;IAC5B,IAAItB,OAAO,CAACwS,KAAK,EAAE;MACfg1B,aAAa,GAAGxnC,OAAO,CAACwS,KAAK,CAACrQ,MAAM,CAACsoB,aAAa;IACtD;IAEA,IAAI,CAAC+c,aAAa,EAAE;MAChBA,aAAa,GAAGlmC,QAAQ;IAC5B;IAEN,IAAIkmC,aAAa,CAACC,iBAAiB,EAC5BD,aAAa,CAACC,iBAAiB,CAAC1lC,WAAW,CAAC+oC,IAAI,CAAC,CAAC,KAErDtD,aAAa,CAACE,IAAI,CAAC3lC,WAAW,CAAC+oC,IAAI,CAAC;;IAElC;IACA,IAAIjrB,IAAI,GAAG7f,OAAO,CAAC6f,IAAI,IAAI,CAAC;IAC5B,IAAIE,GAAG,GAAG/f,OAAO,CAAC+f,GAAG,IAAI,CAAC;IAC1B,IAAI/f,OAAO,CAACwS,KAAK,EAAE;MACfqN,IAAI,GAAG7f,OAAO,CAACwS,KAAK,CAACoN,OAAO,GAAG,EAAE;MACjCG,GAAG,GAAG/f,OAAO,CAACwS,KAAK,CAACsN,OAAO,GAAG,EAAE;MAChC,IAAI9f,OAAO,CAAC1L,KAAK,EAAE;QACfyrB,GAAG,IAAI,EAAE;MACb;MAEA,IAAI/f,OAAO,CAACmjC,UAAU,EAAE;QACpB,IAAIzjB,IAAI,GAAG1f,OAAO,CAACmjC,UAAU,CAAC2H,IAAI,CAACnrB,qBAAqB,EAAE;QAC1DE,IAAI,GAAGH,IAAI,CAACG,IAAI,GAAGH,IAAI,CAACN,KAAK;MACjC;MAEA,IAAI4zB,SAAS,GAAG1xC,QAAQ,CAAComC,IAAI,CAAC/nB,qBAAqB,EAAE;MACrD,IAAIszB,SAAS,GAAGnI,IAAI,CAACnrB,qBAAqB,EAAE;MACrD,IAAGqzB,SAAS,CAAC3zB,MAAM,IAAI,CAAC,EACvBpjB,OAAO,CAACkE,KAAK,CAAC,+EAA+E,CAAC;MAEtF,IAAI6yC,SAAS,CAAC5zB,KAAK,IAAIS,IAAI,GAAGmzB,SAAS,CAAC5zB,KAAK,GAAG6zB,SAAS,CAAC7zB,KAAK,GAAG,EAAE,EAAE;QAClES,IAAI,GAAGmzB,SAAS,CAAC5zB,KAAK,GAAG6zB,SAAS,CAAC7zB,KAAK,GAAG,EAAE;MACjD;MACA,IAAI4zB,SAAS,CAAC3zB,MAAM,IAAIU,GAAG,GAAGizB,SAAS,CAAC3zB,MAAM,GAAG4zB,SAAS,CAAC5zB,MAAM,GAAG,EAAE,EAAE;QACpEU,GAAG,GAAGizB,SAAS,CAAC3zB,MAAM,GAAG4zB,SAAS,CAAC5zB,MAAM,GAAG,EAAE;MAClD;IACJ;IAEAyrB,IAAI,CAACre,KAAK,CAAC5M,IAAI,GAAGA,IAAI,GAAG,IAAI;IAC7BirB,IAAI,CAACre,KAAK,CAAC1M,GAAG,GAAGA,GAAG,GAAG,IAAI;IAE3B,IAAI/f,OAAO,CAACqd,KAAK,EAAE;MACfytB,IAAI,CAACre,KAAK,CAAC8Z,SAAS,GAAG,QAAQ,GAAGvmC,OAAO,CAACqd,KAAK,GAAG,GAAG;IACzD;EACJ;EAEAyjB,WAAW,CAAC1sC,SAAS,CAAC0+C,OAAO,GAAG,UAASx9C,IAAI,EAAE4Z,KAAK,EAAElP,OAAO,EAAE;IAC3D,IAAIoD,IAAI,GAAG,IAAI;IACfpD,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;IAEvB,IAAIse,OAAO,GAAGhd,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;IAC3Cwc,OAAO,CAAC+J,SAAS,GAAG,wBAAwB;IAE5C,IAAIyX,QAAQ,GAAG,KAAK;IAEpB,IAAI5wB,KAAK,KAAK,IAAI,EAAE;MAChBoP,OAAO,CAACqqB,SAAS,CAACr8B,GAAG,CAAC,WAAW,CAAC;MAClC;MACA;IACJ,CAAC,MAAM;MACHgS,OAAO,CAAComB,SAAS,GAAGx1B,KAAK,IAAIA,KAAK,CAAC5a,KAAK,GAAG4a,KAAK,CAAC5a,KAAK,GAAGgB,IAAI;MAC7DgpB,OAAO,CAACpP,KAAK,GAAGA,KAAK;MAErB,IAAIA,KAAK,EAAE;QACP,IAAIA,KAAK,CAAC4wB,QAAQ,EAAE;UAChBA,QAAQ,GAAG,IAAI;UACfxhB,OAAO,CAACqqB,SAAS,CAACr8B,GAAG,CAAC,UAAU,CAAC;QACrC;QACA,IAAI4C,KAAK,CAACshC,OAAO,IAAIthC,KAAK,CAAC2zB,WAAW,EAAE;UACpCvkB,OAAO,CAACqqB,SAAS,CAACr8B,GAAG,CAAC,aAAa,CAAC;QACxC;MACJ;MAEA,IAAI,OAAO4C,KAAK,IAAI,UAAU,EAAE;QAC5BoP,OAAO,CAACyrB,OAAO,CAAC,OAAO,CAAC,GAAGz0C,IAAI;QAC/BgpB,OAAO,CAAC40B,gBAAgB,GAAGhkC,KAAK;MACpC,CAAC,MAAM;QACHoP,OAAO,CAACyrB,OAAO,CAAC,OAAO,CAAC,GAAG76B,KAAK;MACpC;MAEA,IAAIA,KAAK,CAACmZ,SAAS,EAAE;QACjB/J,OAAO,CAAC+J,SAAS,IAAI,GAAG,GAAGnZ,KAAK,CAACmZ,SAAS;MAC9C;IACJ;IAEA,IAAI,CAACyiB,IAAI,CAAC/oC,WAAW,CAACuc,OAAO,CAAC;IAC9B,IAAI,CAACwhB,QAAQ,EAAE;MACXxhB,OAAO,CAAC/L,gBAAgB,CAAC,OAAO,EAAE4gC,aAAa,CAAC;IACpD;IACA,IAAInzC,OAAO,CAACozC,QAAQ,EAAE;MAC3Bv9C,SAAS,CAACopB,kBAAkB,CAACX,OAAO,EAAC,OAAO,EAAC+0B,UAAU,CAAC;IACnD;IAEA,SAASA,UAAU,CAAC3gD,CAAC,EAAE;MACnB,IAAIwc,KAAK,GAAG,IAAI,CAACA,KAAK;MACtB,IAAI,CAACA,KAAK,IAAI,CAACA,KAAK,CAAC2zB,WAAW,EAAE;QAC9B;MACJ;MACA;MACAsQ,aAAa,CAACrgD,IAAI,CAAC,IAAI,EAAEJ,CAAC,CAAC;IAC/B;;IAEA;IACA,SAASygD,aAAa,CAACzgD,CAAC,EAAE;MACtB,IAAIwc,KAAK,GAAG,IAAI,CAACA,KAAK;MACtB,IAAIokC,YAAY,GAAG,IAAI;MAEvB,IAAIlwC,IAAI,CAACkvC,eAAe,EAAE;QACtBlvC,IAAI,CAACkvC,eAAe,CAAC7gB,KAAK,CAAC/+B,CAAC,CAAC;MACjC;;MAEA;MACA,IAAIsN,OAAO,CAACsS,QAAQ,EAAE;QAClB,IAAI3S,CAAC,GAAGK,OAAO,CAACsS,QAAQ,CAACxf,IAAI,CACzB,IAAI,EACJoc,KAAK,EACLlP,OAAO,EACPtN,CAAC,EACD0Q,IAAI,EACJpD,OAAO,CAACC,IAAI,CACf;QACD,IAAIN,CAAC,KAAK,IAAI,EAAE;UACZ2zC,YAAY,GAAG,KAAK;QACxB;MACJ;;MAEA;MACA,IAAIpkC,KAAK,EAAE;QACP,IACIA,KAAK,CAACoD,QAAQ,IACd,CAACtS,OAAO,CAACuzC,qBAAqB,IAC9BrkC,KAAK,CAAC4wB,QAAQ,KAAK,IAAI,EACzB;UACE;UACA,IAAIngC,CAAC,GAAGuP,KAAK,CAACoD,QAAQ,CAACxf,IAAI,CACvB,IAAI,EACJoc,KAAK,EACLlP,OAAO,EACPtN,CAAC,EACD0Q,IAAI,EACJpD,OAAO,CAACqG,KAAK,CAChB;UACD,IAAI1G,CAAC,KAAK,IAAI,EAAE;YACZ2zC,YAAY,GAAG,KAAK;UACxB;QACJ;QACA,IAAIpkC,KAAK,CAACshC,OAAO,EAAE;UACf,IAAI,CAACthC,KAAK,CAACshC,OAAO,CAACxwC,OAAO,EAAE;YACxB,MAAM,mCAAmC;UAC7C;UACA,IAAIwwC,OAAO,GAAG,IAAIptC,IAAI,CAAC3F,WAAW,CAACyR,KAAK,CAACshC,OAAO,CAACxwC,OAAO,EAAE;YACtDsS,QAAQ,EAAEpD,KAAK,CAACshC,OAAO,CAACl+B,QAAQ;YAChCE,KAAK,EAAE9f,CAAC;YACRywC,UAAU,EAAE//B,IAAI;YAChBmwC,qBAAqB,EACjBrkC,KAAK,CAACshC,OAAO,CAAC+C,qBAAqB;YACvCj/C,KAAK,EAAE4a,KAAK,CAACshC,OAAO,CAACl8C,KAAK;YAC1B+R,KAAK,EAAE6I,KAAK,CAACshC,OAAO,CAACnqC,KAAK;YAC1B+sC,QAAQ,EAAEpzC,OAAO,CAACozC;UACtB,CAAC,CAAC;UACFE,YAAY,GAAG,KAAK;QACxB;MACJ;MAEA,IAAIA,YAAY,IAAI,CAAClwC,IAAI,CAACivC,IAAI,EAAE;QAC5BjvC,IAAI,CAACquB,KAAK,EAAE;MAChB;IACJ;IAEA,OAAOnT,OAAO;EAClB,CAAC;EAEDwiB,WAAW,CAAC1sC,SAAS,CAACq9B,KAAK,GAAG,UAAS/+B,CAAC,EAAE8gD,kBAAkB,EAAE;IAC1D,IAAI,IAAI,CAAC1I,IAAI,CAACzJ,UAAU,EAAE;MACtB,IAAI,CAACyJ,IAAI,CAACzJ,UAAU,CAACr/B,WAAW,CAAC,IAAI,CAAC8oC,IAAI,CAAC;IAC/C;IACA,IAAI,IAAI,CAAC3H,UAAU,IAAI,CAACqQ,kBAAkB,EAAE;MACxC,IAAI,CAACrQ,UAAU,CAACkP,IAAI,GAAG,KAAK;MAC5B,IAAI,CAAClP,UAAU,CAACmP,eAAe,GAAG,IAAI;MACtC,IAAI5/C,CAAC,KAAKyZ,SAAS,EAAE;QACjB,IAAI,CAACg3B,UAAU,CAAC1R,KAAK,EAAE;MAC3B,CAAC,MAAM,IACH/+B,CAAC,IACD,CAACouC,WAAW,CAAC2S,mBAAmB,CAAC/gD,CAAC,EAAE,IAAI,CAACywC,UAAU,CAAC2H,IAAI,CAAC,EAC3D;QACEhK,WAAW,CAAC/xB,OAAO,CAAC,IAAI,CAACo0B,UAAU,CAAC2H,IAAI,EAAEj1C,SAAS,CAACgG,oBAAoB,GAAC,OAAO,EAAEnJ,CAAC,CAAC;MACxF;IACJ;IACA,IAAI,IAAI,CAAC4/C,eAAe,EAAE;MACtB,IAAI,CAACA,eAAe,CAAC7gB,KAAK,CAAC/+B,CAAC,EAAE,IAAI,CAAC;IACvC;IAEA,IAAI,IAAI,CAACo4C,IAAI,CAACiI,aAAa,EAAE;MACzBpgD,YAAY,CAAC,IAAI,CAACm4C,IAAI,CAACiI,aAAa,CAAC;IACzC;;IAEA;IACA;EACJ,CAAC;;EAED;EACAjS,WAAW,CAAC/xB,OAAO,GAAG,UAASuP,OAAO,EAAEo1B,UAAU,EAAE30C,MAAM,EAAE40C,MAAM,EAAE;IAChE,IAAIC,GAAG,GAAGtyC,QAAQ,CAACuyC,WAAW,CAAC,aAAa,CAAC;IAC7CD,GAAG,CAACE,eAAe,CAACJ,UAAU,EAAE,IAAI,EAAE,IAAI,EAAE30C,MAAM,CAAC,CAAC,CAAC;IACrD60C,GAAG,CAACG,UAAU,GAAGJ,MAAM;IACvB,IAAIr1B,OAAO,CAAC01B,aAAa,EAAE;MACvB11B,OAAO,CAAC01B,aAAa,CAACJ,GAAG,CAAC;IAC9B,CAAC,MAAM,IAAIt1B,OAAO,CAAC21B,QAAQ,EAAE;MACzB31B,OAAO,CAAC21B,QAAQ,CAACD,aAAa,CAACJ,GAAG,CAAC;IACvC;IACA;IACA,OAAOA,GAAG;EACd,CAAC;;EAED;EACA9S,WAAW,CAAC1sC,SAAS,CAAC8/C,UAAU,GAAG,YAAW;IAC1C,IAAI,IAAI,CAACl0C,OAAO,CAACmjC,UAAU,EAAE;MACzB,OAAO,IAAI,CAACnjC,OAAO,CAACmjC,UAAU,CAAC+Q,UAAU,EAAE;IAC/C;IACA,OAAO,IAAI;EACf,CAAC;EAEDpT,WAAW,CAAC1sC,SAAS,CAAC8uC,aAAa,GAAG,YAAW;IAC7C,IAAI,IAAI,CAACljC,OAAO,CAACmjC,UAAU,EAAE;MACzB,OAAO,IAAI,CAACnjC,OAAO,CAACmjC,UAAU,CAACD,aAAa,EAAE;IAClD;IACA,OAAO,IAAI,CAACljC,OAAO,CAACwS,KAAK;EAC7B,CAAC;EAEDsuB,WAAW,CAAC2S,mBAAmB,GAAG,UAASjhC,KAAK,EAAE8L,OAAO,EAAE;IACvD,IAAIuB,IAAI,GAAGrN,KAAK,CAACoN,OAAO;IACxB,IAAIG,GAAG,GAAGvN,KAAK,CAACsN,OAAO;IACvB,IAAIJ,IAAI,GAAGpB,OAAO,CAACqB,qBAAqB,EAAE;IAC1C,IAAI,CAACD,IAAI,EAAE;MACP,OAAO,KAAK;IAChB;IACA,IACIK,GAAG,GAAGL,IAAI,CAACK,GAAG,IACdA,GAAG,GAAGL,IAAI,CAACK,GAAG,GAAGL,IAAI,CAACL,MAAM,IAC5BQ,IAAI,GAAGH,IAAI,CAACG,IAAI,IAChBA,IAAI,GAAGH,IAAI,CAACG,IAAI,GAAGH,IAAI,CAACN,KAAK,EAC/B;MACE,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB,CAAC;EAEDvpB,SAAS,CAACirC,WAAW,GAAGA,WAAW;EAEnCjrC,SAAS,CAACg2B,oBAAoB,GAAG,UAAS7C,UAAU,EAAE;IAClDA,UAAU,GAAGA,UAAU,IAAIjhB,MAAM;IAEjC,IAAIosC,QAAQ,GAAGnrB,UAAU,CAAC1nB,QAAQ,CAAColC,gBAAgB,CAAC,kBAAkB,CAAC;IACvE,IAAI,CAACyN,QAAQ,CAAC7gD,MAAM,EAAE;MAClB;IACJ;IAEA,IAAI4N,MAAM,GAAG,EAAE;IACf,KAAK,IAAIlN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGmgD,QAAQ,CAAC7gD,MAAM,EAAEU,CAAC,EAAE,EAAE;MACtCkN,MAAM,CAACjN,IAAI,CAACkgD,QAAQ,CAACngD,CAAC,CAAC,CAAC;IAC5B;IAEA,KAAK,IAAIA,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAGkN,MAAM,CAAC5N,MAAM,EAAEU,CAAC,EAAE,EAAE;MAClC,IAAIkN,MAAM,CAAClN,CAAC,CAAC,CAACy9B,KAAK,EAAE;QACjBvwB,MAAM,CAAClN,CAAC,CAAC,CAACy9B,KAAK,EAAE;MACrB,CAAC,MAAM,IAAIvwB,MAAM,CAAClN,CAAC,CAAC,CAACqtC,UAAU,EAAE;QAC7BngC,MAAM,CAAClN,CAAC,CAAC,CAACqtC,UAAU,CAACr/B,WAAW,CAACd,MAAM,CAAClN,CAAC,CAAC,CAAC;MAC/C;IACJ;EACJ,CAAC;EAED6B,SAAS,CAACu+C,WAAW,GAAG,UAASjyC,MAAM,EAAEwxC,MAAM,EAAE;IAC7C,KAAK,IAAI3/C,CAAC,IAAI2/C,MAAM,EAAE;MAClB;MACA,IAAIxxC,MAAM,CAACtF,cAAc,CAAC7I,CAAC,CAAC,EAAE;QAC1B;MACJ;MACAmO,MAAM,CAACnO,CAAC,CAAC,GAAG2/C,MAAM,CAAC3/C,CAAC,CAAC;IACzB;IAEA,IAAI2/C,MAAM,CAACv/C,SAAS,EAAE;MAClB;MACA,KAAK,IAAIJ,CAAC,IAAI2/C,MAAM,CAACv/C,SAAS,EAAE;QAC5B;QACA,IAAI,CAACu/C,MAAM,CAACv/C,SAAS,CAACyI,cAAc,CAAC7I,CAAC,CAAC,EAAE;UACrC;QACJ;QAEA,IAAImO,MAAM,CAAC/N,SAAS,CAACyI,cAAc,CAAC7I,CAAC,CAAC,EAAE;UACpC;UACA;QACJ;;QAEA;QACA,IAAI2/C,MAAM,CAACv/C,SAAS,CAACigD,gBAAgB,CAACrgD,CAAC,CAAC,EAAE;UACtCmO,MAAM,CAAC/N,SAAS,CAACkgD,gBAAgB,CAC7BtgD,CAAC,EACD2/C,MAAM,CAACv/C,SAAS,CAACigD,gBAAgB,CAACrgD,CAAC,CAAC,CACvC;QACL,CAAC,MAAM;UACHmO,MAAM,CAAC/N,SAAS,CAACJ,CAAC,CAAC,GAAG2/C,MAAM,CAACv/C,SAAS,CAACJ,CAAC,CAAC;QAC7C;;QAEA;QACA,IAAI2/C,MAAM,CAACv/C,SAAS,CAACmgD,gBAAgB,CAACvgD,CAAC,CAAC,EAAE;UACtCmO,MAAM,CAAC/N,SAAS,CAACogD,gBAAgB,CAC7BxgD,CAAC,EACD2/C,MAAM,CAACv/C,SAAS,CAACmgD,gBAAgB,CAACvgD,CAAC,CAAC,CACvC;QACL;MACJ;IACJ;EACJ,CAAC;;EAEJ;EACA,SAASygD,WAAW,CAAEC,MAAM,EAC5B;IACC,IAAI,CAACA,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACnZ,QAAQ,GAAG,CAAC,CAAC;IAClB,IAAI,CAACoZ,OAAO,GAAG,CAAC,CAAC;IACjB,IAAI,CAACr0C,IAAI,GAAG,IAAI,CAAC,CAAC;IAClB,IAAI,CAACs0C,WAAW,GAAG,IAAI;IACvB,IAAI,CAACxpC,MAAM,GAAG,CAAC;EAChB;EAEAqpC,WAAW,CAACI,WAAW,GAAG,UAASxX,CAAC,EAACqX,MAAM,EAC3C;IACC,IAAG,CAACA,MAAM,EACT;IACD,KAAI,IAAI1gD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG0gD,MAAM,CAACphD,MAAM,GAAG,CAAC,EAAE,EAAEU,CAAC,EACzC;MACC,IAAIs9C,CAAC,GAAGoD,MAAM,CAAC1gD,CAAC,CAAC;MACjB,IAAI8gD,EAAE,GAAGJ,MAAM,CAAC1gD,CAAC,GAAC,CAAC,CAAC;MACpB,IAAG8gD,EAAE,CAAC,CAAC,CAAC,GAAGzX,CAAC,EACX;MACD,IAAI19B,CAAC,GAAIm1C,EAAE,CAAC,CAAC,CAAC,GAAGxD,CAAC,CAAC,CAAC,CAAE;MACtB,IAAI/6B,IAAI,CAACmL,GAAG,CAAC/hB,CAAC,CAAC,GAAG,OAAO,EACxB,OAAO2xC,CAAC,CAAC,CAAC,CAAC;MACZ,IAAIyD,OAAO,GAAG,CAAC1X,CAAC,GAAGiU,CAAC,CAAC,CAAC,CAAC,IAAI3xC,CAAC;MAC5B,OAAO2xC,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,GAAGyD,OAAO,CAAC,GAAGD,EAAE,CAAC,CAAC,CAAC,GAAGC,OAAO;IAChD;IACA,OAAO,CAAC;EACT,CAAC;EAEDN,WAAW,CAACrgD,SAAS,CAAC02B,IAAI,GAAG,UAAU3J,GAAG,EAAE7gB,IAAI,EAAEgH,WAAW,EAAEo4B,gBAAgB,EAAEsV,UAAU,EAAEC,QAAQ,EACrG;IACC,IAAIP,MAAM,GAAG,IAAI,CAACA,MAAM;IACxB,IAAG,CAACA,MAAM,EACT;IACD,IAAI,CAACp0C,IAAI,GAAGA,IAAI;IAChB,IAAIuT,CAAC,GAAGvT,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8K,MAAM,GAAG,CAAC;IACjC,IAAImlB,CAAC,GAAGjwB,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8K,MAAM,GAAG,CAAC;IAEjC4pC,UAAU,GAAGA,UAAU,IAAI,MAAM;IAEjC7zB,GAAG,CAACmU,IAAI,EAAE;IACVnU,GAAG,CAACC,SAAS,CAAC,IAAI,CAAChW,MAAM,EAAC,IAAI,CAACA,MAAM,CAAC;IAEtC,IAAGs0B,gBAAgB,EACnB;MACCve,GAAG,CAAC0V,SAAS,GAAG,MAAM;MACtB1V,GAAG,CAACoY,QAAQ,CAAC,CAAC,EAAC,CAAC,EAAC1lB,CAAC,EAAC0c,CAAC,CAAC;MACrBpP,GAAG,CAAC0V,SAAS,GAAG,MAAM;MACtB1V,GAAG,CAACoY,QAAQ,CAAC1lB,CAAC,GAAC,GAAG,EAAC,CAAC,EAAC,CAAC,EAAC0c,CAAC,CAAC;MACzBpP,GAAG,CAAC2V,WAAW,GAAG,MAAM;MACxB3V,GAAG,CAAC4V,UAAU,CAAC,CAAC,EAAC,CAAC,EAACljB,CAAC,EAAC0c,CAAC,CAAC;IACxB;IACApP,GAAG,CAAC2V,WAAW,GAAGke,UAAU;IAC5B,IAAGC,QAAQ,EACV9zB,GAAG,CAACoW,WAAW,GAAG,GAAG;IACtBpW,GAAG,CAACoU,SAAS,EAAE;IACf,KAAI,IAAIvhC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG0gD,MAAM,CAACphD,MAAM,EAAE,EAAEU,CAAC,EACrC;MACC,IAAIs9C,CAAC,GAAGoD,MAAM,CAAC1gD,CAAC,CAAC;MACjBmtB,GAAG,CAACsV,MAAM,CAAE6a,CAAC,CAAC,CAAC,CAAC,GAAGz9B,CAAC,EAAE,CAAC,GAAG,GAAGy9B,CAAC,CAAC,CAAC,CAAC,IAAI/gB,CAAC,CAAE;IACzC;IACApP,GAAG,CAAC2Z,MAAM,EAAE;IACZ3Z,GAAG,CAACoW,WAAW,GAAG,CAAC;IACnB,IAAG,CAAC0d,QAAQ,EACX,KAAI,IAAIjhD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG0gD,MAAM,CAACphD,MAAM,EAAE,EAAEU,CAAC,EACrC;MACC,IAAIs9C,CAAC,GAAGoD,MAAM,CAAC1gD,CAAC,CAAC;MACjBmtB,GAAG,CAAC0V,SAAS,GAAG,IAAI,CAAC0E,QAAQ,IAAIvnC,CAAC,GAAG,MAAM,GAAI,IAAI,CAAC2gD,OAAO,IAAI3gD,CAAC,GAAG,MAAM,GAAG,MAAO;MACnFmtB,GAAG,CAACoU,SAAS,EAAE;MACfpU,GAAG,CAACwV,GAAG,CAAE2a,CAAC,CAAC,CAAC,CAAC,GAAGz9B,CAAC,EAAE,CAAC,GAAG,GAAGy9B,CAAC,CAAC,CAAC,CAAC,IAAI/gB,CAAC,EAAE,CAAC,EAAE,CAAC,EAAEha,IAAI,CAACqgB,EAAE,GAAG,CAAC,CAAE;MACxDzV,GAAG,CAACoV,IAAI,EAAE;IACX;IACDpV,GAAG,CAACgU,OAAO,EAAE;EACd,CAAC;;EAED;EACAsf,WAAW,CAACrgD,SAAS,CAACo5B,WAAW,GAAG,UAAU0nB,QAAQ,EAAE5tC,WAAW,EACnE;IACC,IAAIotC,MAAM,GAAG,IAAI,CAACA,MAAM;IACxB,IAAG,CAACA,MAAM,EACT;IACD,IAAIQ,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,EAClB;;IAED;IACA,IAAIrhC,CAAC,GAAG,IAAI,CAACvT,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8K,MAAM,GAAG,CAAC;IACtC,IAAImlB,CAAC,GAAG,IAAI,CAACjwB,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8K,MAAM,GAAG,CAAC;IACtC,IAAII,CAAC,GAAG0pC,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9pC,MAAM;IACjC,IAAIO,CAAC,GAAGupC,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9pC,MAAM;IACjC,IAAI9O,GAAG,GAAG,CAACkP,CAAC,EAACG,CAAC,CAAC;IACf,IAAIwpC,QAAQ,GAAG,EAAE,GAAG7tC,WAAW,CAAC2a,EAAE,CAAC5E,KAAK;IACxC;IACA,IAAI,CAACke,QAAQ,GAAG,IAAI,CAAC6Z,cAAc,CAAC94C,GAAG,EAAE64C,QAAQ,CAAC;IAClD;IACA,IAAG,IAAI,CAAC5Z,QAAQ,IAAI,CAAC,CAAC,EACtB;MACC,IAAItR,KAAK,GAAG,CAACze,CAAC,GAAGqI,CAAC,EAAE,CAAC,GAAGlI,CAAC,GAAG4kB,CAAC,CAAC;MAC9BmkB,MAAM,CAACzgD,IAAI,CAACg2B,KAAK,CAAC;MAClByqB,MAAM,CAACj2C,IAAI,CAAC,UAASoC,CAAC,EAACC,CAAC,EAAC;QAAE,OAAOD,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC;MAAE,CAAC,CAAC;MACjD,IAAI,CAACy6B,QAAQ,GAAGmZ,MAAM,CAAClyC,OAAO,CAACynB,KAAK,CAAC;MACrC,IAAI,CAAC2qB,WAAW,GAAG,IAAI;IACxB;IACA,IAAG,IAAI,CAACrZ,QAAQ,IAAI,CAAC,CAAC,EACrB,OAAO,IAAI;EACb,CAAC;EAEDkZ,WAAW,CAACrgD,SAAS,CAACs7B,WAAW,GAAG,UAAUwlB,QAAQ,EAAE5tC,WAAW,EACnE;IACC,IAAIotC,MAAM,GAAG,IAAI,CAACA,MAAM;IACxB,IAAG,CAACA,MAAM,EACT;IACD,IAAIW,CAAC,GAAG,IAAI,CAAC9Z,QAAQ;IACrB,IAAG8Z,CAAC,GAAG,CAAC,EACP;IACD,IAAI7pC,CAAC,GAAG,CAAC0pC,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9pC,MAAM,KAAK,IAAI,CAAC9K,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8K,MAAM,GAAG,CAAC,CAAE;IACvE,IAAIO,CAAC,GAAG,CAACupC,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9pC,MAAM,KAAK,IAAI,CAAC9K,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8K,MAAM,GAAG,CAAC,CAAE;IACvE,IAAIkqC,QAAQ,GAAG,CAAEJ,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9pC,MAAM,EAAG8pC,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9pC,MAAM,CAAE;IACxE,IAAI+pC,QAAQ,GAAG,EAAE,GAAG7tC,WAAW,CAAC2a,EAAE,CAAC5E,KAAK;IACxC,IAAI,CAACk4B,QAAQ,GAAG,IAAI,CAACH,cAAc,CAACE,QAAQ,EAAEH,QAAQ,CAAC;IACvD,IAAIlrB,KAAK,GAAGyqB,MAAM,CAACW,CAAC,CAAC;IACrB,IAAGprB,KAAK,EACR;MACC,IAAIurB,aAAa,GAAGH,CAAC,IAAI,CAAC,IAAIA,CAAC,IAAIX,MAAM,CAACphD,MAAM,GAAG,CAAC;MACpD,IAAI,CAACkiD,aAAa,KAAKN,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAIA,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC50C,IAAI,CAAC,CAAC,CAAC,GAAG,EAAE,IAAI40C,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAIA,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC50C,IAAI,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EACpI;QACCo0C,MAAM,CAAChtC,MAAM,CAAC2tC,CAAC,EAAC,CAAC,CAAC;QAClB,IAAI,CAAC9Z,QAAQ,GAAG,CAAC,CAAC;QAClB;MACD;MACA,IAAI,CAACia,aAAa;QAAG;QACpBvrB,KAAK,CAAC,CAAC,CAAC,GAAG1T,IAAI,CAAC+pB,KAAK,CAAC90B,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC,CAAC,KAE7Bye,KAAK,CAAC,CAAC,CAAC,GAAGorB,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC;MAC1BprB,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG1T,IAAI,CAAC+pB,KAAK,CAAC30B,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;MAClC+oC,MAAM,CAACj2C,IAAI,CAAC,UAASoC,CAAC,EAACC,CAAC,EAAC;QAAE,OAAOD,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC;MAAE,CAAC,CAAC;MACjD,IAAI,CAACy6B,QAAQ,GAAGmZ,MAAM,CAAClyC,OAAO,CAACynB,KAAK,CAAC;MACrC,IAAI,CAAC2qB,WAAW,GAAG,IAAI;IACxB;EACD,CAAC;EAEDH,WAAW,CAACrgD,SAAS,CAAC+8B,SAAS,GAAG,UAAU+jB,QAAQ,EAAE5tC,WAAW,EACjE;IACC,IAAI,CAACi0B,QAAQ,GAAG,CAAC,CAAC;IAClB,OAAO,KAAK;EACb,CAAC;EAEDkZ,WAAW,CAACrgD,SAAS,CAACghD,cAAc,GAAG,UAAS94C,GAAG,EAAE64C,QAAQ,EAC7D;IACC,IAAIT,MAAM,GAAG,IAAI,CAACA,MAAM;IACxB,IAAG,CAACA,MAAM,EACT,OAAO,CAAC,CAAC;IACVS,QAAQ,GAAGA,QAAQ,IAAI,EAAE;IACzB,IAAIthC,CAAC,GAAI,IAAI,CAACvT,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8K,MAAM,GAAG,CAAE;IACxC,IAAImlB,CAAC,GAAI,IAAI,CAACjwB,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8K,MAAM,GAAG,CAAE;IACxC,IAAI3C,GAAG,GAAGisC,MAAM,CAACphD,MAAM;IACvB,IAAIyrC,EAAE,GAAG,CAAC,CAAC,EAAC,CAAC,CAAC;IACd,IAAI0W,QAAQ,GAAG,OAAO;IACtB,IAAIC,OAAO,GAAG,CAAC,CAAC;IAChB,IAAIC,UAAU,GAAG,CAAC,CAAC;IACnB,KAAI,IAAI3hD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGyU,GAAG,EAAE,EAAEzU,CAAC,EAC3B;MACC,IAAIs9C,CAAC,GAAGoD,MAAM,CAAC1gD,CAAC,CAAC;MACjB+qC,EAAE,CAAC,CAAC,CAAC,GAAGuS,CAAC,CAAC,CAAC,CAAC,GAAGz9B,CAAC;MAChBkrB,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,GAAGuS,CAAC,CAAC,CAAC,CAAC,IAAI/gB,CAAC;MACxB,IAAGwO,EAAE,CAAC,CAAC,CAAC,GAAGziC,GAAG,CAAC,CAAC,CAAC,EAChBq5C,UAAU,GAAG3hD,CAAC;MACf,IAAI65B,IAAI,GAAG+nB,IAAI,CAAC9nB,QAAQ,CAACxxB,GAAG,EAACyiC,EAAE,CAAC;MAChC,IAAGlR,IAAI,GAAG4nB,QAAQ,IAAI5nB,IAAI,GAAGsnB,QAAQ,EACpC;MACDO,OAAO,GAAG1hD,CAAC;MACXyhD,QAAQ,GAAG5nB,IAAI;IAChB;IACA,OAAO6nB,OAAO;EACf,CAAC;EAED7/C,SAAS,CAAC4+C,WAAW,GAAGA,WAAW;;EAEhC;EACA5+C,SAAS,CAACqJ,iBAAiB,GAAG,UAASP,IAAI,EAAE;IACzC,OAAO,CAACA,IAAI,GAAG,EAAE,EACZ8jC,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC;IAAA,CAC3BA,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;IAAA,CACpBA,OAAO,CAAC,qBAAqB,EAAE,EAAE,CAAC,CAAC;IAAA,CACnCrmC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CACjBqmC,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;IAAA,CACzBA,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;IAAA,CACvBrmC,KAAK,CAAC,GAAG,CAAC,CACVwE,MAAM,CAACu6B,OAAO,CAAC,CAAC,CAAC;EAC1B,CAAC;;EAEJ;AACD;EACCtlC,SAAS,CAACopB,kBAAkB,GAAG,UAAS42B,IAAI,EAAEC,KAAK,EAAEC,KAAK,EAAiB;IAAA,IAAfC,OAAO,uEAAC,KAAK;IACxE,IAAI,CAACH,IAAI,IAAI,CAACA,IAAI,CAACtjC,gBAAgB,IAAI,CAACujC,KAAK,IAAI,OAAOC,KAAK,KAAG,UAAU,EAAC;MAC1E;MACA,OAAO,CAAC;IACT;;IAEA,IAAIE,OAAO,GAAGpgD,SAAS,CAACgG,oBAAoB;IAC5C,IAAIq6C,MAAM,GAAGJ,KAAK;;IAElB;IACA;IACA,IAAIG,OAAO,IAAE,SAAS,IAAI,CAACluC,MAAM,CAACouC,YAAY,EAAC;MAC9Cl6C,OAAO,CAACqB,IAAI,CAAC,4CAA4C,CAAC;MAC1DrB,OAAO,CAACC,GAAG,CAAC,qBAAqB,GAACg6C,MAAM,GAAC,wEAAwE,CAAC;MAClH,QAAOA,MAAM;QACZ,KAAK,MAAM;UAAC;YACXD,OAAO,GAAG,OAAO;YACjBC,MAAM,GAAG,OAAO;YAChB;UACD;QACA,KAAK,MAAM;UAAC;YACXD,OAAO,GAAG,OAAO;YACjB;YACA;UACD;QACA,KAAK,IAAI;UAAC;YACTA,OAAO,GAAG,OAAO;YACjBC,MAAM,GAAG,KAAK;YACd;UACD;QACA,KAAK,QAAQ;UAAC;YACbD,OAAO,GAAG,OAAO;YACjB;YACA;UACD;QACA,KAAK,OAAO;UAAC;YACZh6C,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC,CAAC,CAAC;YACnD;UACD;QACA;QACA;UAAQ;YACPD,OAAO,CAACqB,IAAI,CAAC,yDAAyD,GAAC44C,MAAM,GAAC,sBAAsB,CAAC;UACtG;MAAC;IAEH;IAEA,QAAOA,MAAM;MACZ;MACA,KAAK,MAAM;MAAE,KAAK,IAAI;MAAE,KAAK,MAAM;MAAE,KAAK,MAAM;MAAE,KAAK,KAAK;MAAE,KAAK,OAAO;QAC1E;UACCL,IAAI,CAACtjC,gBAAgB,CAAC0jC,OAAO,GAACC,MAAM,EAAEH,KAAK,EAAEC,OAAO,CAAC;QACtD;MACA;MACA,KAAK,OAAO;MAAE,KAAK,QAAQ;MAAE,KAAK,mBAAmB;MAAE,KAAK,oBAAoB;QAChF;UACC,IAAIC,OAAO,IAAE,OAAO,EAAC;YACpB,OAAOJ,IAAI,CAACtjC,gBAAgB,CAAC0jC,OAAO,GAACC,MAAM,EAAEH,KAAK,EAAEC,OAAO,CAAC;UAC7D;QACD;MACA;MACA;QACC,OAAOH,IAAI,CAACtjC,gBAAgB,CAAC2jC,MAAM,EAAEH,KAAK,EAAEC,OAAO,CAAC;IAAC;EAExD,CAAC;EACDngD,SAAS,CAACyqB,qBAAqB,GAAG,UAASu1B,IAAI,EAAEK,MAAM,EAAEH,KAAK,EAAiB;IAAA,IAAfC,OAAO,uEAAC,KAAK;IAC5E,IAAI,CAACH,IAAI,IAAI,CAACA,IAAI,CAAC/rB,mBAAmB,IAAI,CAACosB,MAAM,IAAI,OAAOH,KAAK,KAAG,UAAU,EAAC;MAC9E;MACA,OAAO,CAAC;IACT;;IACA,QAAOG,MAAM;MACZ;MACA,KAAK,MAAM;MAAE,KAAK,IAAI;MAAE,KAAK,MAAM;MAAE,KAAK,MAAM;MAAE,KAAK,KAAK;MAAE,KAAK,OAAO;QAC1E;UACC,IAAIrgD,SAAS,CAACgG,oBAAoB,IAAE,SAAS,IAAIhG,SAAS,CAACgG,oBAAoB,IAAE,OAAO,EAAC;YACxFg6C,IAAI,CAAC/rB,mBAAmB,CAACj0B,SAAS,CAACgG,oBAAoB,GAACq6C,MAAM,EAAEH,KAAK,EAAEC,OAAO,CAAC;UAChF;QACD;MACA;MACA,KAAK,OAAO;MAAE,KAAK,QAAQ;MAAE,KAAK,mBAAmB;MAAE,KAAK,oBAAoB;QAChF;UACC,IAAIngD,SAAS,CAACgG,oBAAoB,IAAE,SAAS,EAAC;YAC7C,OAAOg6C,IAAI,CAAC/rB,mBAAmB,CAACj0B,SAAS,CAACgG,oBAAoB,GAACq6C,MAAM,EAAEH,KAAK,EAAEC,OAAO,CAAC;UACvF;QACD;MACA;MACA;QACC,OAAOH,IAAI,CAAC/rB,mBAAmB,CAACosB,MAAM,EAAEH,KAAK,EAAEC,OAAO,CAAC;IAAC;EAE3D,CAAC;EAEEz/B,IAAI,CAAC+pB,KAAK,GAAG,UAAStjC,CAAC,EAAE6D,CAAC,EAAEC,CAAC,EAAE;IAC3B,OAAOD,CAAC,GAAG7D,CAAC,GAAG6D,CAAC,GAAGC,CAAC,GAAG9D,CAAC,GAAG8D,CAAC,GAAG9D,CAAC;EACpC,CAAC;EAED,IAAI,OAAO+K,MAAM,IAAI,WAAW,IAAI,CAACA,MAAM,CAAC,uBAAuB,CAAC,EAAE;IAClEA,MAAM,CAACC,qBAAqB,GACxBD,MAAM,CAACquC,2BAA2B,IAClCruC,MAAM,CAACsuC,wBAAwB,IAC/B,UAAS/jC,QAAQ,EAAE;MACfvK,MAAM,CAACtV,UAAU,CAAC6f,QAAQ,EAAE,IAAI,GAAG,EAAE,CAAC;IAC1C,CAAC;EACT;AACJ,CAAC,EAAE,IAAI,CAAC;AAER,IAAI,OAAOngB,OAAO,IAAI,WAAW,EAAE;EAC/BA,OAAO,CAAC0D,SAAS,GAAG,IAAI,CAACA,SAAS;AACtC;;AAGA;AACA,CAAC,UAASD,MAAM,EAAE;EACd,IAAIC,SAAS,GAAGD,MAAM,CAACC,SAAS;;EAEhC;EACA,SAASygD,IAAI,GAAG;IACZ,IAAI,CAACzmC,SAAS,CAAC,OAAO,EAAE,QAAQ,CAAC;IACjC,IAAI,CAACA,SAAS,CAAC,QAAQ,EAAE,QAAQ,CAAC;EACtC;EAEAymC,IAAI,CAAChiD,KAAK,GAAG,MAAM;EACnBgiD,IAAI,CAAC92C,IAAI,GAAG,MAAM;EAElB82C,IAAI,CAACliD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAClC,IAAI,CAACG,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC4H,KAAK,CAAClB,UAAU,GAAG,IAAI,CAAC;IACnD,IAAI,CAAC1G,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC4H,KAAK,CAAClB,UAAU,CAAC;EAChD,CAAC;EAEDzQ,SAAS,CAACiG,gBAAgB,CAAC,YAAY,EAAEw6C,IAAI,CAAC;;EAE9C;EACA,SAASpqC,QAAQ,GAAG;IAChB,IAAI9I,IAAI,GAAG,IAAI;IACf,IAAI,CAAC9C,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;IACrB,IAAI,CAACxB,UAAU,GAAG;MAAE6f,OAAO,EAAE;IAAK,CAAC;IACnC,IAAI,CAACA,OAAO,GAAG,IAAI;;IAEnB;IACA,IAAI,CAAC8O,QAAQ,GAAG,IAAI53B,SAAS,CAACgP,MAAM,EAAE;IACtC,IAAI,CAAC4oB,QAAQ,CAAC1F,cAAc,GAAG,IAAI;IACnC,IAAI,CAAC0F,QAAQ,CAAC8oB,YAAY,GAAG,IAAI;IAEjC,IAAI,CAAC9oB,QAAQ,CAACze,SAAS,GAAG,IAAI,CAACwnC,iBAAiB,CAAC/xC,IAAI,CAAC,IAAI,CAAC;;IAEjE;IACM,IAAI,CAACgpB,QAAQ,CAACte,YAAY,GAAG,IAAI,CAACsnC,kBAAkB,CAAChyC,IAAI,CAAC,IAAI,CAAC;IAC/D,IAAI,CAACgpB,QAAQ,CAACje,cAAc,GAAG,IAAI,CAACknC,sBAAsB,CAACjyC,IAAI,CAAC,IAAI,CAAC;IACrE,IAAI,CAACgpB,QAAQ,CAAC/d,kBAAkB,GAAG,IAAI,CAACinC,yBAAyB,CAAClyC,IAAI,CAAC,IAAI,CAAC;IAC5E,IAAI,CAACgpB,QAAQ,CAAC7d,cAAc,GAAG,IAAI,CAACgnC,sBAAsB,CAACnyC,IAAI,CAAC,IAAI,CAAC;IAErE,IAAI,CAACgpB,QAAQ,CAAC3d,aAAa,GAAG,IAAI,CAAC+mC,mBAAmB,CAACpyC,IAAI,CAAC,IAAI,CAAC;IACjE,IAAI,CAACgpB,QAAQ,CAACxd,eAAe,GAAG,IAAI,CAAC6mC,uBAAuB,CAACryC,IAAI,CAAC,IAAI,CAAC;IACvE,IAAI,CAACgpB,QAAQ,CAACtd,mBAAmB,GAAG,IAAI,CAAC4mC,0BAA0B,CAACtyC,IAAI,CAAC,IAAI,CAAC;IAC9E,IAAI,CAACgpB,QAAQ,CAACpd,eAAe,GAAG,IAAI,CAAC2mC,uBAAuB,CAACvyC,IAAI,CAAC,IAAI,CAAC;EAC3E;EAEAyH,QAAQ,CAAC5X,KAAK,GAAG,UAAU;EAC3B4X,QAAQ,CAAC1M,IAAI,GAAG,qBAAqB;EACrC0M,QAAQ,CAAC2vB,WAAW,GAAG,MAAM;EAE7B3vB,QAAQ,CAAC9X,SAAS,CAACovC,WAAW,GAAG,YAAW;IACxC,OAAO,CAAC,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;EACnC,CAAC;;EAEJ;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAGIt3B,QAAQ,CAAC9X,SAAS,CAACk5B,UAAU,GAAG,UAAS56B,CAAC,EAAE4J,GAAG,EAAEgL,WAAW,EAAE;IAC1D,IAAIlE,IAAI,GAAG,IAAI;IACf3Q,UAAU,CAAC,YAAW;MAClB6U,WAAW,CAACqgB,YAAY,CAACvkB,IAAI,CAACqqB,QAAQ,CAAC;IAC3C,CAAC,EAAE,EAAE,CAAC;EACV,CAAC;;EAEJ;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEIvhB,QAAQ,CAAC9X,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE;IAClD,IAAI,CAAC8e,QAAQ,CAAC/e,QAAQ,CAACtC,MAAM,EAAEuC,KAAK,CAAC;EACzC,CAAC;EAEDzC,QAAQ,CAAC9X,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtC,IAAI,CAACkf,OAAO,GAAG,IAAI,CAACtJ,kBAAkB,CAAC,SAAS,CAAC;IACjD,IAAI,CAAC,IAAI,CAACsJ,OAAO,EAAE;MACf;IACJ;;IAEA;IACA,IAAI,IAAI,CAAC1X,MAAM,EAAE;MACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACiT,MAAM,CAAC3T,MAAM,EAAEU,CAAC,EAAE,EAAE;QACzC,IAAIiX,KAAK,GAAG,IAAI,CAAChE,MAAM,CAACjT,CAAC,CAAC;QAC1B,IAAIkb,KAAK,GAAG,IAAI,CAACxP,YAAY,CAAC1L,CAAC,CAAC;QAChC,IAAI,CAACy5B,QAAQ,CAACpe,YAAY,CAACpE,KAAK,CAAC3V,IAAI,EAAE4Z,KAAK,CAAC;MACjD;IACJ;;IAEA;IACA,IAAI,CAACue,QAAQ,CAACrlB,OAAO,EAAE;;IAEvB;IACA,IAAI,IAAI,CAAClB,OAAO,EAAE;MACd,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC5T,MAAM,EAAEU,CAAC,EAAE,EAAE;QAC1C,IAAIiW,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAClT,CAAC,CAAC;QAC5B,IAAIkb,KAAK,GAAG,IAAI,CAACue,QAAQ,CAAC1d,aAAa,CAAC9F,MAAM,CAAC3U,IAAI,CAAC;QACpD,IAAI,CAACsK,aAAa,CAAC5L,CAAC,EAAEkb,KAAK,CAAC;MAChC;IACJ;EACJ,CAAC;EAEDhD,QAAQ,CAAC9X,SAAS,CAAC0T,mBAAmB,GAAG,UAASmE,SAAS,EAAE0C,KAAK,EAAEnO,IAAI,EAAE;IACtE,IAAI,IAAI,CAACme,OAAO,EAAE;MACd,IAAI,CAAC8O,QAAQ,CAAC3lB,mBAAmB,CAACmE,SAAS,EAAE0C,KAAK,EAAEnO,IAAI,CAAC;IAC7D;EACJ,CAAC;EAED0L,QAAQ,CAAC9X,SAAS,CAAC2wB,gBAAgB,GAAG,UAAU5D,GAAG,EAAE7Z,WAAW,EAAE8F,MAAM,EAAE9Q,GAAG,EAAE;IAC3E,IAAI,IAAI,CAAC+D,KAAK,CAAC2Y,SAAS,EACpB;IACJ,IAAIrN,CAAC,GAAG,IAAI,CAACrL,IAAI,CAAC,CAAC,CAAC,GAAGzK,SAAS,CAACG,iBAAiB,GAAG,GAAG;IACxD;IACA,IAAIumC,IAAI,GAAG1mC,SAAS,CAACujB,iBAAiB,CAAC9c,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,GAAG,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,GAAG,CAAC,CAAC,CAAC,GAAGqP,CAAC,EAAE,IAAI,CAACrL,IAAI,CAAC,CAAC,CAAC,EAAEzK,SAAS,CAACG,iBAAiB,CAAC;IAC/H,IAAIihD,QAAQ,GAAGphD,SAAS,CAACujB,iBAAiB,CAAC9c,GAAG,CAAC,CAAC,CAAC,EAAEA,GAAG,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,GAAG,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,GAAG,CAAC,CAAC,CAAC,GAAGqP,CAAC,EAAE,IAAI,CAACrL,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEzK,SAAS,CAACG,iBAAiB,CAAC;IACvImrB,GAAG,CAAC0V,SAAS,GAAG0F,IAAI,GAAG,MAAM,GAAG,MAAM;IACtCpb,GAAG,CAACoU,SAAS,EAAE;IACf,IAAI,IAAI,CAACt4B,MAAM,IAAIpH,SAAS,CAACiC,SAAS,EAAE;MACpC,IAAIm/C,QAAQ,EAAE;QACV91B,GAAG,CAACzB,IAAI,CAAC,CAAC,EAAE/T,CAAC,EAAE,IAAI,CAACrL,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAEzK,SAAS,CAACG,iBAAiB,CAAC;MACrE,CAAC,MAAM;QACHmrB,GAAG,CAACzB,IAAI,CAAC,IAAI,CAACpf,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEqL,CAAC,EAAE,IAAI,CAACrL,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAEzK,SAAS,CAACG,iBAAiB,CAAC;MACpF;IACJ,CAAC,MACI;MACD,IAAIihD,QAAQ,EAAE;QACV91B,GAAG,CAACqW,SAAS,CAAC,CAAC,EAAE7rB,CAAC,EAAE,IAAI,CAACrL,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAEzK,SAAS,CAACG,iBAAiB,EAAE,CAAC,CAAC,EAAC,CAAC,EAAE,CAAC,EAAC,CAAC,CAAC,CAAC;MACtF,CAAC,MAAM;QACHmrB,GAAG,CAACqW,SAAS,CAAC,IAAI,CAACl3B,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEqL,CAAC,EAAE,IAAI,CAACrL,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAEzK,SAAS,CAACG,iBAAiB,EAAE,CAAC,CAAC,EAAC,CAAC,EAAE,CAAC,EAAC,CAAC,CAAC,CAAC;MACrG;IACJ;IACA,IAAIumC,IAAI,EAAE;MACNpb,GAAG,CAACoV,IAAI,EAAE;IACd,CAAC,MAAM;MACHpV,GAAG,CAACoY,QAAQ,CAAC,CAAC,EAAE5tB,CAAC,EAAE,IAAI,CAACrL,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEzK,SAAS,CAACG,iBAAiB,CAAC;IACrE;IACA;IACAmrB,GAAG,CAACsW,SAAS,GAAG,QAAQ;IACxBtW,GAAG,CAACtD,IAAI,GAAG,YAAY;IACvBsD,GAAG,CAAC0V,SAAS,GAAG0F,IAAI,GAAG,MAAM,GAAG,MAAM;IACtCpb,GAAG,CAACuW,QAAQ,CAAC,GAAG,EAAE,IAAI,CAACp3B,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,EAAEqL,CAAC,GAAG,EAAE,CAAC;IAC9CwV,GAAG,CAACuW,QAAQ,CAAC,GAAG,EAAE,IAAI,CAACp3B,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,EAAEqL,CAAC,GAAG,EAAE,CAAC;EAClD,CAAC;;EAED;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACAO,QAAQ,CAAC9X,SAAS,CAACo5B,WAAW,GAAG,UAAU96B,CAAC,EAAEwiD,QAAQ,EAAE5tC,WAAW,EAAE;IACjE,IAAIqE,CAAC,GAAG,IAAI,CAACrL,IAAI,CAAC,CAAC,CAAC,GAAGzK,SAAS,CAACG,iBAAiB,GAAG,GAAG;IACxDiG,OAAO,CAACC,GAAG,CAAC,CAAC,CAAC;IACd,IAAIg5C,QAAQ,CAAC,CAAC,CAAC,GAAGvpC,CAAC,EAAE;MACjB,IAAIupC,QAAQ,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC50C,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;QAChCrE,OAAO,CAACC,GAAG,CAAC,CAAC,CAAC;QACdoL,WAAW,CAACwwB,4BAA4B,CAAC,IAAI,CAAC;MAClD,CAAC,MAAM;QACH77B,OAAO,CAACC,GAAG,CAAC,CAAC,CAAC;QACdoL,WAAW,CAAC8wB,iCAAiC,CAAC,IAAI,CAAC;MACvD;IACJ;EACJ,CAAC;EACJlsB,QAAQ,CAAC9X,SAAS,CAACmM,WAAW,GAAG,YACjC;IACC,IAAI22C,UAAU,GAAG,IAAI,CAACjwC,MAAM,GAAG,IAAI,CAACA,MAAM,CAAC3T,MAAM,GAAG,CAAC;IACrD,IAAI6jD,WAAW,GAAG,IAAI,CAACjwC,OAAO,GAAG,IAAI,CAACA,OAAO,CAAC5T,MAAM,GAAG,CAAC;IACxD,OAAO,CAAE,GAAG,EAAEijB,IAAI,CAACmB,GAAG,CAACw/B,UAAU,EAACC,WAAW,CAAC,GAAGthD,SAAS,CAACK,gBAAgB,GAAGL,SAAS,CAACG,iBAAiB,CAAE;EAC5G,CAAC;;EAEE;EACAkW,QAAQ,CAAC9X,SAAS,CAACoiD,iBAAiB,GAAG,UAAShkC,KAAK,EAAE7D,KAAK,EAAE;IAC1D,IAAI1B,IAAI,GAAG,IAAI,CAAC+I,cAAc,CAACxD,KAAK,CAAC;IACrC,IAAIvF,IAAI,IAAI,CAAC,CAAC,EAAE;MACZ,IAAI,CAACiJ,WAAW,CAACjJ,IAAI,CAAC;IAC1B;EACJ,CAAC;EAEDf,QAAQ,CAAC9X,SAAS,CAACqiD,kBAAkB,GAAG,UAASnhD,IAAI,EAAEyG,IAAI,EAAE;IACzD,IAAIkR,IAAI,GAAG,IAAI,CAAC+H,aAAa,CAAC1f,IAAI,CAAC;IACnC,IAAI2X,IAAI,IAAI,CAAC,CAAC,EAAE;MACZ;MACA,IAAI,CAACgC,QAAQ,CAAC3Z,IAAI,EAAEyG,IAAI,CAAC;IAC7B;EACJ,CAAC;EAEDmQ,QAAQ,CAAC9X,SAAS,CAACsiD,sBAAsB,GAAG,UAASU,OAAO,EAAE9hD,IAAI,EAAE;IAChE,IAAI2X,IAAI,GAAG,IAAI,CAAC+H,aAAa,CAACoiC,OAAO,CAAC;IACtC,IAAInqC,IAAI,IAAI,CAAC,CAAC,EAAE;MACZ;IACJ;IACA,IAAIwD,IAAI,GAAG,IAAI,CAACyE,YAAY,CAACjI,IAAI,CAAC;IAClCwD,IAAI,CAACnb,IAAI,GAAGA,IAAI;EACpB,CAAC;EAED4W,QAAQ,CAAC9X,SAAS,CAACuiD,yBAAyB,GAAG,UAASrhD,IAAI,EAAEyG,IAAI,EAAE;IAChE,IAAIkR,IAAI,GAAG,IAAI,CAAC+H,aAAa,CAAC1f,IAAI,CAAC;IACnC,IAAI2X,IAAI,IAAI,CAAC,CAAC,EAAE;MACZ;IACJ;IACA,IAAIwD,IAAI,GAAG,IAAI,CAACyE,YAAY,CAACjI,IAAI,CAAC;IAClCwD,IAAI,CAAC1U,IAAI,GAAGA,IAAI;EACpB,CAAC;EAEDmQ,QAAQ,CAAC9X,SAAS,CAACwiD,sBAAsB,GAAG,UAASthD,IAAI,EAAE;IACvD,IAAI2X,IAAI,GAAG,IAAI,CAAC+H,aAAa,CAAC1f,IAAI,CAAC;IACnC,IAAI2X,IAAI,IAAI,CAAC,CAAC,EAAE;MACZ;IACJ;IACA,IAAI,CAAC0C,WAAW,CAAC1C,IAAI,CAAC;EAC1B,CAAC;;EAED;EACAf,QAAQ,CAAC9X,SAAS,CAACyiD,mBAAmB,GAAG,UAASvhD,IAAI,EAAEyG,IAAI,EAAE;IAC1D,IAAIkR,IAAI,GAAG,IAAI,CAAC+I,cAAc,CAAC1gB,IAAI,CAAC;IACpC,IAAI2X,IAAI,IAAI,CAAC,CAAC,EAAE;MACZ,IAAI,CAAC4C,SAAS,CAACva,IAAI,EAAEyG,IAAI,CAAC;IAC9B;EACJ,CAAC;EAEDmQ,QAAQ,CAAC9X,SAAS,CAAC0iD,uBAAuB,GAAG,UAASM,OAAO,EAAE9hD,IAAI,EAAE;IACjE,IAAI2X,IAAI,GAAG,IAAI,CAAC+I,cAAc,CAACohC,OAAO,CAAC;IACvC,IAAInqC,IAAI,IAAI,CAAC,CAAC,EAAE;MACZ;IACJ;IACA,IAAIwD,IAAI,GAAG,IAAI,CAAC8E,aAAa,CAACtI,IAAI,CAAC;IACnCwD,IAAI,CAACnb,IAAI,GAAGA,IAAI;EACpB,CAAC;EAED4W,QAAQ,CAAC9X,SAAS,CAAC2iD,0BAA0B,GAAG,UAASzhD,IAAI,EAAEyG,IAAI,EAAE;IACjE,IAAIkR,IAAI,GAAG,IAAI,CAAC+I,cAAc,CAAC1gB,IAAI,CAAC;IACpC,IAAI2X,IAAI,IAAI,CAAC,CAAC,EAAE;MACZ;IACJ;IACA,IAAIwD,IAAI,GAAG,IAAI,CAAC8E,aAAa,CAACtI,IAAI,CAAC;IACnCwD,IAAI,CAAC1U,IAAI,GAAGA,IAAI;EACpB,CAAC;EAEDmQ,QAAQ,CAAC9X,SAAS,CAAC4iD,uBAAuB,GAAG,UAAS1hD,IAAI,EAAE;IACxD,IAAI2X,IAAI,GAAG,IAAI,CAAC+H,aAAa,CAAC1f,IAAI,CAAC;IACnC,IAAI2X,IAAI,IAAI,CAAC,CAAC,EAAE;MACZ;IACJ;IACA,IAAI,CAACmD,YAAY,CAACnD,IAAI,CAAC;EAC3B,CAAC;EACD;;EAEAf,QAAQ,CAAC9X,SAAS,CAAC07C,mBAAmB,GAAG,UAASxoC,WAAW,EAAE;IAC3D,IAAIlE,IAAI,GAAG,IAAI;IACf,OAAO,CACH;MACIw/B,OAAO,EAAE,MAAM;MACftwB,QAAQ,EAAE,oBAAW;QACjBhL,WAAW,CAACqgB,YAAY,CAACvkB,IAAI,CAACqqB,QAAQ,CAAC;MAC3C;IACJ,CAAC,CACJ;EACL,CAAC;EAEDvhB,QAAQ,CAAC9X,SAAS,CAAC6iB,QAAQ,GAAG,UAAS3W,IAAI,EAAE;IACzCA,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE;EACjB,CAAC;EAED4L,QAAQ,CAAC9X,SAAS,CAACqa,SAAS,GAAG,YAAW;IACtC,IAAI1L,IAAI,GAAGlN,SAAS,CAAC6G,UAAU,CAACtI,SAAS,CAACqa,SAAS,CAAC3b,IAAI,CAAC,IAAI,CAAC;IAC9DiQ,IAAI,CAAC0qB,QAAQ,GAAG,IAAI,CAACA,QAAQ,CAAChf,SAAS,EAAE;IACzC,OAAO1L,IAAI;EACf,CAAC;EACD;;EAEAmJ,QAAQ,CAAC9X,SAAS,CAACggB,KAAK,GAAG,YAAW;IAClC,IAAInU,IAAI,GAAGpK,SAAS,CAACkK,UAAU,CAAC,IAAI,CAAChE,IAAI,CAAC;IAC1C,IAAIgH,IAAI,GAAG,IAAI,CAAC0L,SAAS,EAAE;IAC3B,OAAO1L,IAAI,CAAC,IAAI,CAAC;IACjB,OAAOA,IAAI,CAAC,QAAQ,CAAC;IACrB,OAAOA,IAAI,CAAC,SAAS,CAAC;IACtB9C,IAAI,CAACgF,SAAS,CAAClC,IAAI,CAAC;IACpB,OAAO9C,IAAI;EACf,CAAC;EAEJiM,QAAQ,CAAC9X,SAAS,CAAC46C,cAAc,GAAG,UAASzwC,KAAK,EAClD;IACC;IACA;;IAEA;IACA,IAAI84C,eAAe,GAAG,EAAE;IACxB,IAAIC,gBAAgB,GAAG,EAAE;;IAEzB;IACA,IAAIC,GAAG,GAAG,CAAC,CAAC;IACZ,IAAIC,KAAK,GAAG,CAAC;IACb,IAAIC,KAAK,GAAG,CAAC;IACb,KAAI,IAAIzjD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuK,KAAK,CAACjL,MAAM,EAAE,EAAEU,CAAC,EACpC;MACC,IAAIiM,IAAI,GAAG1B,KAAK,CAACvK,CAAC,CAAC;MACnBujD,GAAG,CAAEt3C,IAAI,CAAC2J,EAAE,CAAE,GAAG3J,IAAI;MACrBu3C,KAAK,GAAGjhC,IAAI,CAAC4jB,GAAG,CAAEl6B,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,EAAEk7C,KAAK,CAAE;MACtCC,KAAK,GAAGlhC,IAAI,CAACmB,GAAG,CAAEzX,IAAI,CAAC3D,GAAG,CAAC,CAAC,CAAC,EAAEk7C,KAAK,CAAE;IACvC;IAEA,IAAIE,YAAY,GAAG,CAAC;IACpB,IAAIC,aAAa,GAAG,CAAC;IAErB,KAAI,IAAI3jD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuK,KAAK,CAACjL,MAAM,EAAE,EAAEU,CAAC,EACpC;MACC,IAAIiM,IAAI,GAAG1B,KAAK,CAACvK,CAAC,CAAC;MACnB;MACA,IAAIiM,IAAI,CAACgH,MAAM,EACd,KAAI,IAAItE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG1C,IAAI,CAACgH,MAAM,CAAC3T,MAAM,EAAE,EAAEqP,CAAC,EAC1C;QACC,IAAIsI,KAAK,GAAGhL,IAAI,CAACgH,MAAM,CAACtE,CAAC,CAAC;QAC1B,IAAI,CAACsI,KAAK,IAAI,CAACA,KAAK,CAACnB,IAAI,EACxB;QACD,IAAIA,IAAI,GAAG7J,IAAI,CAACuH,KAAK,CAACvB,KAAK,CAAEgF,KAAK,CAACnB,IAAI,CAAE;QACzC,IAAG,CAACA,IAAI,EACP;QACD,IAAIytC,GAAG,CAAEztC,IAAI,CAACoJ,SAAS,CAAE,EACxB;QACD;QACA,IAAI,CAACua,QAAQ,CAACxe,QAAQ,CAAChE,KAAK,CAAC3V,IAAI,EAACwU,IAAI,CAAC/N,IAAI,CAAC;QAC5C;AACL;AACA;AACA;AACA;AACA;MACI;;MAED;MACA,IAAIkE,IAAI,CAACiH,OAAO,EACf,KAAI,IAAIvE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG1C,IAAI,CAACiH,OAAO,CAAC5T,MAAM,EAAE,EAAEqP,CAAC,EAC3C;QACC,IAAIsH,MAAM,GAAGhK,IAAI,CAACiH,OAAO,CAACvE,CAAC,CAAC;QAC5B,IAAI,CAACsH,MAAM,IAAI,CAACA,MAAM,CAAChE,KAAK,IAAI,CAACgE,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EACnD;QACD,IAAIskD,WAAW,GAAG,KAAK;QACvB,KAAI,IAAInkC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGxJ,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAAE,EAAEmgB,CAAC,EAC3C;UACC,IAAI3J,IAAI,GAAG7J,IAAI,CAACuH,KAAK,CAACvB,KAAK,CAAEgE,MAAM,CAAChE,KAAK,CAACwN,CAAC,CAAC,CAAE;UAC9C,IAAG,CAAC3J,IAAI,EACP;UACD,IAAIytC,GAAG,CAAEztC,IAAI,CAACO,SAAS,CAAE,EACxB;UACDutC,WAAW,GAAG,IAAI;UAClB;QACD;QACA,IAAG,CAACA,WAAW,EACd;QACD;QACA;AACL;AACA;AACA;AACA;AACA;MACI;IACF;;IAEA;IACC;IACA;IACA;;IAED;;IAEA;EACD,CAAC;;EAEE/hD,SAAS,CAACqW,QAAQ,GAAGA,QAAQ;EAC7BrW,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAEoQ,QAAQ,CAAC;;EAEtD;EACA,SAAS2C,UAAU,GAAG;IAClB,IAAI,CAACgB,SAAS,CAAC,EAAE,EAAE,QAAQ,CAAC;IAE5B,IAAI,CAACgoC,aAAa,GAAG,EAAE;IACvB,IAAI,CAAC/4C,UAAU,GAAG;MACvBxJ,IAAI,EAAE,EAAE;MACRyG,IAAI,EAAE,QAAQ;MACdmT,KAAK,EAAE;IACR,CAAC;IAEK,IAAI9L,IAAI,GAAG,IAAI;IAEf,IAAI,CAAC00C,WAAW,GAAG,IAAI,CAACn/B,SAAS,CAC7B,MAAM,EACN,MAAM,EACN,IAAI,CAAC7Z,UAAU,CAACxJ,IAAI,EACpB,UAAS0H,CAAC,EAAE;MACR,IAAI,CAACA,CAAC,EAAE;QACJ;MACJ;MACAoG,IAAI,CAACmR,WAAW,CAAC,MAAM,EAACvX,CAAC,CAAC;IAC9B,CAAC,CACJ;IACD,IAAI,CAAC+6C,WAAW,GAAG,IAAI,CAACp/B,SAAS,CAC7B,MAAM,EACN,MAAM,EACN,IAAI,CAAC7Z,UAAU,CAAC/C,IAAI,EACpB,UAASiB,CAAC,EAAE;MACpBoG,IAAI,CAACmR,WAAW,CAAC,MAAM,EAACvX,CAAC,CAAC;IAClB,CAAC,CACJ;IAED,IAAI,CAACg7C,YAAY,GAAG,IAAI,CAACr/B,SAAS,CAC9B,QAAQ,EACR,OAAO,EACP,IAAI,CAAC7Z,UAAU,CAACoQ,KAAK,EACrB,UAASlS,CAAC,EAAE;MACRoG,IAAI,CAACmR,WAAW,CAAC,OAAO,EAACvX,CAAC,CAAC;IAC/B,CAAC,CACJ;IAED,IAAI,CAACob,UAAU,GAAG,IAAI;IACtB,IAAI,CAAC9X,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EACzB;EAEAuO,UAAU,CAACva,KAAK,GAAG,OAAO;EAC1Bua,UAAU,CAACrP,IAAI,GAAG,oBAAoB;EAEzCqP,UAAU,CAACza,SAAS,CAACge,WAAW,GAAG,YACnC;IACC,IAAI,CAAC6lC,UAAU,EAAE;EAClB,CAAC;;EAED;EACAppC,UAAU,CAACza,SAAS,CAAC6jD,UAAU,GAAG,YAClC;IACC,IAAIl8C,IAAI,GAAG,IAAI,CAAC+C,UAAU,CAAC/C,IAAI;IAC/B,IAAI,CAACg8C,WAAW,CAAC7oC,KAAK,GAAGnT,IAAI;;IAE7B;IACA,IAAG,IAAI,CAACmL,OAAO,CAAC,CAAC,CAAC,CAACnL,IAAI,IAAIA,IAAI,EAC/B;MACO,IAAI,CAAClG,SAAS,CAACwM,iBAAiB,CAAC,IAAI,CAAC6E,OAAO,CAAC,CAAC,CAAC,CAACnL,IAAI,EAACA,IAAI,CAAC,EAChE,IAAI,CAACoR,gBAAgB,CAAC,CAAC,CAAC;MACzB,IAAI,CAACjG,OAAO,CAAC,CAAC,CAAC,CAACnL,IAAI,GAAGA,IAAI;IAC5B;;IAEA;IACA,IAAGA,IAAI,IAAI,QAAQ,EACnB;MACC,IAAI,CAACi8C,YAAY,CAACj8C,IAAI,GAAG,QAAQ;MACjC,IAAI,CAACi8C,YAAY,CAAC9oC,KAAK,GAAG,CAAC;IAC5B,CAAC,MACI,IAAGnT,IAAI,IAAI,SAAS,EACzB;MACC,IAAI,CAACi8C,YAAY,CAACj8C,IAAI,GAAG,QAAQ;MACjC,IAAI,CAACi8C,YAAY,CAAC9oC,KAAK,GAAG,IAAI;IAC/B,CAAC,MACI,IAAGnT,IAAI,IAAI,QAAQ,EACxB;MACC,IAAI,CAACi8C,YAAY,CAACj8C,IAAI,GAAG,MAAM;MAC/B,IAAI,CAACi8C,YAAY,CAAC9oC,KAAK,GAAG,EAAE;IAC7B,CAAC,MAED;MACC,IAAI,CAAC8oC,YAAY,CAACj8C,IAAI,GAAG,IAAI;MAC7B,IAAI,CAACi8C,YAAY,CAAC9oC,KAAK,GAAG,IAAI;IAC/B;IACA,IAAI,CAACpQ,UAAU,CAACoQ,KAAK,GAAG,IAAI,CAAC8oC,YAAY,CAAC9oC,KAAK;;IAE/C;IACA,IAAI,IAAI,CAAC1H,KAAK,IAAI,IAAI,CAACqwC,aAAa,EAAE;MACrC,IAAI,CAACrwC,KAAK,CAACiI,eAAe,CAAC,IAAI,CAACooC,aAAa,EAAE97C,IAAI,CAAC;IACrD;EACD,CAAC;;EAED;EACA8S,UAAU,CAACza,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAC0H,CAAC,EACxD;IACC,IAAI1H,IAAI,IAAI,MAAM,EAClB;MACC,IAAI0H,CAAC,IAAI,EAAE,IAAIA,CAAC,IAAI,IAAI,CAAC66C,aAAa,IAAI76C,CAAC,IAAI,SAAS,EAAE;QACzD,OAAO,KAAK;MACb;MACA,IAAG,IAAI,CAACwK,KAAK,EACb;QACC,IAAI,IAAI,CAACqwC,aAAa,EAAE;UACvB;UACA,IAAI,CAACrwC,KAAK,CAAC8H,WAAW,CAAE,IAAI,CAACuoC,aAAa,EAAE76C,CAAC,CAAE;QAChD,CAAC,MAAM;UACN,IAAI,CAACwK,KAAK,CAACyH,QAAQ,CAAEjS,CAAC,EAAE,IAAI,CAAC8B,UAAU,CAAC/C,IAAI,CAAE;QAC/C;MACD,CAAC,CAAC;MACF,IAAI,CAAC+7C,WAAW,CAAC5oC,KAAK,GAAGlS,CAAC;MAC1B,IAAI,CAAC66C,aAAa,GAAG76C,CAAC;IACvB,CAAC,MACI,IAAI1H,IAAI,IAAI,MAAM,EACvB;MACC,IAAI,CAAC2iD,UAAU,EAAE;IAClB,CAAC,MACI,IAAI3iD,IAAI,IAAI,OAAO,EACxB,CACA;EACD,CAAC;EAEEuZ,UAAU,CAACza,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IACvC,IAAI,IAAI,CAACjU,KAAK,CAAC2Y,SAAS,EAAE;MACtB,OAAO,IAAI,CAACla,UAAU,CAACxJ,IAAI;IAC/B;IACA,OAAO,IAAI,CAAChB,KAAK;EACrB,CAAC;EAEDua,UAAU,CAACza,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE;IACpD,IAAI,IAAI,CAAC7P,UAAU,CAAC/C,IAAI,IAAIlG,SAAS,CAACyC,KAAK,EAAE;MACzC,IAAI,CAAC4d,WAAW,CAAC,CAAC,EAAEvH,KAAK,CAAC;IAC9B;EACJ,CAAC;EAEDE,UAAU,CAACza,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAInK,IAAI,GAAG,IAAI,CAACwJ,UAAU,CAACxJ,IAAI;IAC/B;IACA,IAAIyN,IAAI,GAAG,IAAI,CAACyE,KAAK,CAACP,MAAM,CAAC3R,IAAI,CAAC;IAClC,IAAI,CAACyN,IAAI,EAAE;MACP,IAAI,CAACnD,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAACoQ,KAAK,CAAE;MACtD;IACK;IAEA,IAAI,CAACtP,aAAa,CAAC,CAAC,EAAEmD,IAAI,CAACmM,KAAK,KAAK/C,SAAS,GAAGpJ,IAAI,CAACmM,KAAK,GAAG,IAAI,CAACpQ,UAAU,CAACoQ,KAAK,CAAE;EACzF,CAAC;EAEDL,UAAU,CAACza,SAAS,CAACwR,SAAS,GAAG,YAAW;IACxC,IAAI,IAAI,CAACiyC,aAAa,EAAE;MACpB,IAAI,CAACrwC,KAAK,CAACmI,WAAW,CAAC,IAAI,CAACkoC,aAAa,CAAC;IAC9C;EACJ,CAAC;EAEDhiD,SAAS,CAACgZ,UAAU,GAAGA,UAAU;EACjChZ,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAE+S,UAAU,CAAC;;EAErD;EACA,SAASqpC,WAAW,GAAG;IACnB,IAAI,CAACjpC,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC;IAErB,IAAI,CAAC4oC,aAAa,GAAG,EAAE;IACvB,IAAI,CAAC/4C,UAAU,GAAG;MAAExJ,IAAI,EAAE,EAAE;MAAEyG,IAAI,EAAE;IAAG,CAAC;IACxC,IAAIqH,IAAI,GAAG,IAAI;;IAEf;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACN;IACA;IACM;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA,IAAI,CAAC00C,WAAW,GAAG,IAAI,CAACn/B,SAAS,CAAC,MAAM,EAAC,MAAM,EAAC,IAAI,CAAC7Z,UAAU,CAACxJ,IAAI,EAAC,MAAM,CAAC;IAC5E,IAAI,CAACyiD,WAAW,GAAG,IAAI,CAACp/B,SAAS,CAAC,MAAM,EAAC,MAAM,EAAC,IAAI,CAAC7Z,UAAU,CAAC/C,IAAI,EAAC,MAAM,CAAC;IAC5E,IAAI,CAACqc,UAAU,GAAG,IAAI;IACtB,IAAI,CAAC9X,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EACzB;EAEA43C,WAAW,CAAC5jD,KAAK,GAAG,QAAQ;EAC5B4jD,WAAW,CAAC14C,IAAI,GAAG,qBAAqB;EAExC04C,WAAW,CAAC9jD,SAAS,CAACsf,iBAAiB,GAAG,UAAUpe,IAAI,EAAE0H,CAAC,EAAE;IACzD,IAAI1H,IAAI,IAAI,MAAM,EAAE;MAChB,IAAI0H,CAAC,IAAI,EAAE,IAAIA,CAAC,IAAI,IAAI,CAAC66C,aAAa,IAAI76C,CAAC,IAAI,SAAS,EAAE;QACtD,OAAO,KAAK;MAChB;MACA,IAAI,IAAI,CAACwK,KAAK,EAAE;QACZ,IAAI,IAAI,CAACqwC,aAAa,EAAE;UACpB;UACA,IAAI,CAACrwC,KAAK,CAACwI,YAAY,CAAC,IAAI,CAAC6nC,aAAa,EAAE76C,CAAC,CAAC;QAClD,CAAC,MAAM;UACH,IAAI,CAACwK,KAAK,CAACqI,SAAS,CAAC7S,CAAC,EAAE,IAAI,CAAC8B,UAAU,CAAC/C,IAAI,CAAC;QACjD;MACJ,CAAC,CAAC;MACF,IAAI,CAAC+7C,WAAW,CAAC5oC,KAAK,GAAGlS,CAAC;MAC1B,IAAI,CAAC66C,aAAa,GAAG76C,CAAC;IAC1B,CAAC,MACI,IAAI1H,IAAI,IAAI,MAAM,EAAE;MACrB,IAAI,CAAC2iD,UAAU,EAAE;IACrB,CAAC,MACI,IAAI3iD,IAAI,IAAI,OAAO,EAAE,CAC1B;EACJ,CAAC;EAED4iD,WAAW,CAAC9jD,SAAS,CAAC6jD,UAAU,GAAG,YAAY;IAC3C,IAAIl8C,IAAI,GAAG,IAAI,CAAC+C,UAAU,CAAC/C,IAAI;IAC/B,IAAI,IAAI,CAACg8C,WAAW,EAChB,IAAI,CAACA,WAAW,CAAC7oC,KAAK,GAAGnT,IAAI;;IAEjC;IACA,IAAI,IAAI,CAACkL,MAAM,CAAC,CAAC,CAAC,CAAClL,IAAI,IAAIA,IAAI,EAAE;MAEtC,IAAKA,IAAI,IAAI,QAAQ,IAAIA,IAAI,IAAI,OAAO,EAC9BA,IAAI,GAAGlG,SAAS,CAACyC,KAAK;MAChC,IAAI,CAACzC,SAAS,CAACwM,iBAAiB,CAAC,IAAI,CAAC4E,MAAM,CAAC,CAAC,CAAC,CAAClL,IAAI,EAAEA,IAAI,CAAC,EAC1D,IAAI,CAACmR,eAAe,CAAC,CAAC,CAAC;MACxB,IAAI,CAACjG,MAAM,CAAC,CAAC,CAAC,CAAClL,IAAI,GAAGA,IAAI;IACrB;;IAEA;IACA,IAAI,IAAI,CAACyL,KAAK,IAAI,IAAI,CAACqwC,aAAa,EAAE;MAClC,IAAI,CAACrwC,KAAK,CAAC0I,gBAAgB,CAAC,IAAI,CAAC2nC,aAAa,EAAE97C,IAAI,CAAC;IACzD;EACJ,CAAC;EAIDm8C,WAAW,CAAC9jD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACzC,IAAI,CAAC04C,MAAM,GAAG,IAAI,CAACz4C,YAAY,CAAC,CAAC,CAAC;IAClC,IAAI,CAAC8H,KAAK,CAAC5H,aAAa,CAAC,IAAI,CAACd,UAAU,CAACxJ,IAAI,EAAE,IAAI,CAAC6iD,MAAM,CAAC;EAC/D,CAAC;EAEDD,WAAW,CAAC9jD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE;IACrD,IAAI,IAAI,CAAC7P,UAAU,CAAC/C,IAAI,IAAIlG,SAAS,CAAC0C,MAAM,EAAE;MAC1C,IAAI,CAACiP,KAAK,CAACuH,OAAO,CAAE,IAAI,CAACjQ,UAAU,CAACxJ,IAAI,EAAEqZ,KAAK,CAAE;IACrD;EACJ,CAAC;EAEDupC,WAAW,CAAC9jD,SAAS,CAACwR,SAAS,GAAG,YAAW;IACzC,IAAI,IAAI,CAACiyC,aAAa,EAAE;MACpB,IAAI,CAACrwC,KAAK,CAAC4I,YAAY,CAAC,IAAI,CAACynC,aAAa,CAAC;IAC/C;EACJ,CAAC;EAEDK,WAAW,CAAC9jD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IACxC,IAAI,IAAI,CAACjU,KAAK,CAAC2Y,SAAS,EAAE;MACtB,OAAO,IAAI,CAACla,UAAU,CAACxJ,IAAI;IAC/B;IACA,OAAO,IAAI,CAAChB,KAAK;EACrB,CAAC;EAEDuB,SAAS,CAACqiD,WAAW,GAAGA,WAAW;EACnCriD,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAEo8C,WAAW,CAAC;;EAEvD;EACA,SAASE,cAAc,GAAG;IACtB,IAAI,CAACvoC,SAAS,CAAC,OAAO,EAAE,QAAQ,CAAC;IACjC,IAAI,CAACqH,WAAW,CAAC,OAAO,EAAE,GAAG,CAAC;IAC9B,IAAI,CAACwB,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,QAAQ,EAAC,OAAO,EAAC,CAAC,EAAC,OAAO,CAAC;IACxD,IAAI,CAACP,UAAU,GAAG,IAAI;IACtB,IAAI,CAAC9X,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EACzB;EAEA83C,cAAc,CAAC9jD,KAAK,GAAG,cAAc;EACrC8jD,cAAc,CAAC54C,IAAI,GAAG,iBAAiB;EAEvC44C,cAAc,CAAChkD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAI,CAACG,aAAa,CAAC,CAAC,EAAEy4C,UAAU,CAAC,IAAI,CAACv5C,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC;EAC/D,CAAC;EAEDs5C,cAAc,CAAChkD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IAC3C,IAAI,IAAI,CAACjU,KAAK,CAAC2Y,SAAS,EAAE;MACtB,OAAO,IAAI,CAACla,UAAU,CAACoQ,KAAK;IAChC;IACA,OAAO,IAAI,CAAC5a,KAAK;EACrB,CAAC;EAEJ8jD,cAAc,CAAChkD,SAAS,CAACiyC,QAAQ,GAAG,UAASrpC,CAAC,EAC9C;IACC,IAAI,CAACuX,WAAW,CAAC,OAAO,EAACvX,CAAC,CAAC;EAC5B,CAAC;EAEEo7C,cAAc,CAAChkD,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACtD;IACA,IAAI,CAACja,OAAO,CAAC,CAAC,CAAC,CAAC8Q,KAAK,GAAG,IAAI,CAAClZ,UAAU,CAAC,OAAO,CAAC,CAAC+5B,OAAO,CAAC,CAAC,CAAC;EAC/D,CAAC;EAEDhjC,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAEs8C,cAAc,CAAC;EAEzD,SAASE,eAAe,GAAG;IACvB,IAAI,CAACzoC,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC;IACjC,IAAI,CAACqH,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC;IAC/B,IAAI,CAACwB,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,QAAQ,EAAC,OAAO,EAAC,IAAI,EAAC,OAAO,CAAC;IAC3D,IAAI,CAAC3E,iBAAiB,GAAG,IAAI;IAC7B,IAAI,CAACoE,UAAU,GAAG,IAAI;IACtB,IAAI,CAAC9X,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EACzB;EAEAg4C,eAAe,CAAChkD,KAAK,GAAG,eAAe;EACvCgkD,eAAe,CAAC94C,IAAI,GAAG,kBAAkB;EACzC84C,eAAe,CAAClkD,SAAS,CAACkgB,QAAQ,GAAG8jC,cAAc,CAAChkD,SAAS,CAACkgB,QAAQ;EAEtEgkC,eAAe,CAAClkD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC7C,IAAI,CAACG,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAAC,OAAO,CAAC,CAAC;EACnD,CAAC;EAEJw5C,eAAe,CAAClkD,SAAS,CAACiyC,QAAQ,GAAG+R,cAAc,CAAChkD,SAAS,CAACiyC,QAAQ;EAEtEiS,eAAe,CAAClkD,SAAS,CAACovC,WAAW,GAAG,YAAW;IAClD,OAAO,CAAC,CAAC,QAAQ,EAAE3tC,SAAS,CAAC0C,MAAM,CAAC,CAAC;EACtC,CAAC;EAED+/C,eAAe,CAAClkD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EACpD;IACC,IAAI,CAACi6B,QAAQ,CAAE,CAAC,IAAI,CAACvnC,UAAU,CAACoQ,KAAK,CAAE;EACxC,CAAC;EAEErZ,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAEw8C,eAAe,CAAC;EAE5D,SAASC,cAAc,GAAG;IACtB,IAAI,CAAC1oC,SAAS,CAAC,QAAQ,EAAE,QAAQ,CAAC;IAClC,IAAI,CAACqH,WAAW,CAAC,OAAO,EAAE,EAAE,CAAC;IAC7B,IAAI,CAACwB,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,MAAM,EAAC,OAAO,EAAC,EAAE,EAAC,OAAO,CAAC,CAAC,CAAE;IAC1D,IAAI,CAACP,UAAU,GAAG,IAAI;IACtB,IAAI,CAAC9X,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EACzB;EAEAi4C,cAAc,CAACjkD,KAAK,GAAG,cAAc;EACrCikD,cAAc,CAAC/4C,IAAI,GAAG,iBAAiB;EAEvC+4C,cAAc,CAACnkD,SAAS,CAACkgB,QAAQ,GAAG8jC,cAAc,CAAChkD,SAAS,CAACkgB,QAAQ;EAErEikC,cAAc,CAACnkD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAI,CAACG,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAAC,OAAO,CAAC,CAAC;EACnD,CAAC;EAEJy5C,cAAc,CAACnkD,SAAS,CAACiyC,QAAQ,GAAG+R,cAAc,CAAChkD,SAAS,CAACiyC,QAAQ;EAErEkS,cAAc,CAACnkD,SAAS,CAACy+B,UAAU,GAAG,UAASI,IAAI,EACnD;IACC,IAAI7vB,IAAI,GAAG,IAAI;IACf,IAAIY,MAAM,GAAG,IAAIC,UAAU,EAAE;IAC7BD,MAAM,CAACE,MAAM,GAAG,UAASxR,CAAC,EAC1B;MACC0Q,IAAI,CAACmR,WAAW,CAAC,OAAO,EAAC7hB,CAAC,CAACyP,MAAM,CAACjB,MAAM,CAAC;IAC1C,CAAC;IACD8C,MAAM,CAACI,UAAU,CAAC6uB,IAAI,CAAC;EACxB,CAAC;EAEEp9B,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAEy8C,cAAc,CAAC;EAE1D,SAASC,cAAc,GAAG;IACtB,IAAI,CAAC3oC,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAACvP,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;IAC3B,IAAI,CAACm4C,OAAO,GAAG,CAAC,CAAC;EACf;EAEAD,cAAc,CAAClkD,KAAK,GAAG,cAAc;EACrCkkD,cAAc,CAACh5C,IAAI,GAAG,iBAAiB;EAEvCg5C,cAAc,CAACpkD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAI,CAACG,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC64C,OAAO,CAAC;EACvC,CAAC;EAED5iD,SAAS,CAACiG,gBAAgB,CAAE,cAAc,EAAE08C,cAAc,CAAE;EAE5D,SAASE,YAAY,GAAG;IACpB,IAAI,CAACzpC,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC9B,IAAI,CAACY,SAAS,CAAC,MAAM,EAAE,QAAQ,CAAC;IAChC,IAAI,CAACqH,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC;IAC3B,IAAI,CAACA,WAAW,CAAC,MAAM,EAAE,MAAM,CAAC;IAChC,IAAI,CAACwB,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,MAAM,EAAC,KAAK,EAAC,EAAE,EAAC,KAAK,CAAC;IACnD,IAAI,CAACvF,KAAK,GAAG,IAAI;EACrB;EAEAslC,YAAY,CAACpkD,KAAK,GAAG,YAAY;EACjCokD,YAAY,CAACl5C,IAAI,GAAG,4BAA4B;EAChDk5C,YAAY,CAAC,OAAO,CAAC,GAAG;IAAE38C,IAAI,EAAE,MAAM;IAAE6c,MAAM,EAAE,CAAC,MAAM,EAAC,aAAa,EAAC,MAAM,EAAC,MAAM;EAAE,CAAC;EAEtF8/B,YAAY,CAACtkD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC7D,IAAI5Z,IAAI,IAAI,KAAK,EACvB;MACC,IAAI4Z,KAAK,IAAI,IAAI,IAAIA,KAAK,IAAI,EAAE,EAC/B,IAAI,CAACkE,KAAK,GAAG,IAAI,CAAC,KAEnB;QACC,IAAI,CAACpQ,SAAS,CAACkM,KAAK,CAAC;MACtB;IACD;EACD,CAAC;EAEEwpC,YAAY,CAACtkD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAChD,IAAIwD,GAAG,GAAG,IAAI,CAACvD,YAAY,CAAC,CAAC,CAAC,IAAI,IAAI,CAACZ,UAAU,CAACmE,GAAG;IACrD,IAAGA,GAAG,KAAKA,GAAG,IAAI,IAAI,CAAC01C,IAAI,IAAI,IAAI,CAACC,KAAK,IAAI,IAAI,CAAC95C,UAAU,CAAC/C,IAAI,CAAC,EACjE,IAAI,CAACiH,SAAS,CAACC,GAAG,CAAC;IACd,IAAI,CAACrD,aAAa,CAAC,CAAC,EAAE,IAAI,CAACwT,KAAK,CAAE;EACtC,CAAC;EAEJslC,YAAY,CAACtkD,SAAS,CAACiyC,QAAQ,GAAG+R,cAAc,CAAChkD,SAAS,CAACiyC,QAAQ;EAEhEqS,YAAY,CAACtkD,SAAS,CAAC4O,SAAS,GAAG,UAASC,GAAG,EAAE;IACnD,IAAIG,IAAI,GAAG,IAAI;IACf,IAAG,CAACH,GAAG,IAAIA,GAAG,CAACxF,WAAW,KAAKC,MAAM,EACrC;MACC0F,IAAI,CAACgQ,KAAK,GAAG,IAAI;MACRhQ,IAAI,CAAC8Q,QAAQ,GAAG,IAAI;MAC7B;IACD;IAEA,IAAI,CAACykC,IAAI,GAAG11C,GAAG;IACf,IAAI,CAAC21C,KAAK,GAAG,IAAI,CAAC95C,UAAU,CAAC/C,IAAI;IAC3B,IAAIkH,GAAG,CAACxG,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,MAAM,IAAI5G,SAAS,CAAC+D,KAAK,EAAE;MAC/CqJ,GAAG,GAAGpN,SAAS,CAAC+D,KAAK,GAAGqJ,GAAG,CAACxG,MAAM,CAACwG,GAAG,CAACT,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;IAC5D;IACNa,KAAK,CAACJ,GAAG,CAAC,CACTK,IAAI,CAAC,UAASC,QAAQ,EAAE;MACxB,IAAG,CAACA,QAAQ,CAACC,EAAE,EACb,MAAM,IAAIjR,KAAK,CAAC,gBAAgB,CAAC;MAEnC,IAAG6Q,IAAI,CAACtE,UAAU,CAAC/C,IAAI,IAAI,aAAa,EACvC,OAAOwH,QAAQ,CAACE,WAAW,EAAE,CAAC,KAC1B,IAAGL,IAAI,CAACtE,UAAU,CAAC/C,IAAI,IAAI,MAAM,EACrC,OAAOwH,QAAQ,CAACG,IAAI,EAAE,CAAC,KACnB,IAAGN,IAAI,CAACtE,UAAU,CAAC/C,IAAI,IAAI,MAAM,EACrC,OAAOwH,QAAQ,CAACI,IAAI,EAAE,CAAC,KACnB,IAAGP,IAAI,CAACtE,UAAU,CAAC/C,IAAI,IAAI,MAAM,EACrC,OAAOwH,QAAQ,CAACK,IAAI,EAAE;IACxB,CAAC,CAAC,CACDN,IAAI,CAAC,UAASP,IAAI,EAAE;MACpBK,IAAI,CAACgQ,KAAK,GAAGrQ,IAAI;MACRK,IAAI,CAAC8Q,QAAQ,GAAG,MAAM;IAChC,CAAC,CAAC,CACDrQ,KAAK,CAAC,UAAS1D,KAAK,EAAE;MACtBiD,IAAI,CAACgQ,KAAK,GAAG,IAAI;MACRhQ,IAAI,CAAC8Q,QAAQ,GAAG,KAAK;MAC9BjY,OAAO,CAACkE,KAAK,CAAC,sBAAsB,EAAC8C,GAAG,CAAC;IAC1C,CAAC,CAAC;EACA,CAAC;EAEJy1C,YAAY,CAACtkD,SAAS,CAACy+B,UAAU,GAAG,UAASI,IAAI,EACjD;IACC,IAAI7vB,IAAI,GAAG,IAAI;IACf,IAAI,CAACu1C,IAAI,GAAG1lB,IAAI,CAAC39B,IAAI;IACrB,IAAI,CAACsjD,KAAK,GAAG,IAAI,CAAC95C,UAAU,CAAC/C,IAAI;IACjC,IAAI,CAAC+C,UAAU,CAACmE,GAAG,GAAGgwB,IAAI,CAAC39B,IAAI;IAC/B,IAAI0O,MAAM,GAAG,IAAIC,UAAU,EAAE;IAC7BD,MAAM,CAACE,MAAM,GAAG,UAASxR,CAAC,EAC1B;MACU0Q,IAAI,CAAC8Q,QAAQ,GAAG,MAAM;MAC/B,IAAIlX,CAAC,GAAGtK,CAAC,CAACyP,MAAM,CAACjB,MAAM;MACvB,IAAIkC,IAAI,CAACtE,UAAU,CAAC/C,IAAI,IAAI,MAAM,EACjCiB,CAAC,GAAGmC,IAAI,CAACiD,KAAK,CAACpF,CAAC,CAAC;MAClBoG,IAAI,CAACgQ,KAAK,GAAGpW,CAAC;IACf,CAAC;IACD,IAAGoG,IAAI,CAACtE,UAAU,CAAC/C,IAAI,IAAI,aAAa,EACvCiI,MAAM,CAACG,iBAAiB,CAAC8uB,IAAI,CAAC,CAAC,KAC3B,IAAG7vB,IAAI,CAACtE,UAAU,CAAC/C,IAAI,IAAI,MAAM,IAAIqH,IAAI,CAACtE,UAAU,CAAC/C,IAAI,IAAI,MAAM,EACvEiI,MAAM,CAACI,UAAU,CAAC6uB,IAAI,CAAC,CAAC,KACpB,IAAG7vB,IAAI,CAACtE,UAAU,CAAC/C,IAAI,IAAI,MAAM,EACrC,OAAOiI,MAAM,CAACK,kBAAkB,CAAC4uB,IAAI,CAAC;EACxC,CAAC;EAEEp9B,SAAS,CAACiG,gBAAgB,CAAC,YAAY,EAAE48C,YAAY,CAAC;;EAEzD;EACG,SAASG,YAAY,GAAG;IACpB,IAAI,CAAChpC,SAAS,CAAC,MAAM,EAAE,QAAQ,CAAC;IAChC,IAAI,CAACqH,WAAW,CAAC,OAAO,EAAE,EAAE,CAAC;IAC7B,IAAI,CAACwB,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,MAAM,EAAC,MAAM,EAAC,EAAE,EAAC,OAAO,CAAC;IACtD,IAAI,CAACP,UAAU,GAAG,IAAI;IACtB,IAAI,CAAC9X,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;IACrB,IAAI,CAAC63C,MAAM,GAAG,IAAI;EACtB;EAEAU,YAAY,CAACvkD,KAAK,GAAG,YAAY;EACjCukD,YAAY,CAACr5C,IAAI,GAAG,eAAe;EAEnCq5C,YAAY,CAACzkD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC7D,IAAI,CAACwJ,MAAM,CAACxJ,KAAK,GAAGA,KAAK;IACzB,IAAIA,KAAK,IAAI,IAAI,IAAIA,KAAK,IAAI,EAAE,EAAE;MAC9B;IACJ;IAEA,IAAI;MACA,IAAI,CAACipC,MAAM,GAAGh5C,IAAI,CAACiD,KAAK,CAAC8M,KAAK,CAAC;MAC/B,IAAI,CAACgF,QAAQ,GAAG,MAAM;IAC1B,CAAC,CAAC,OAAOhU,GAAG,EAAE;MACV,IAAI,CAACgU,QAAQ,GAAG,KAAK;IACzB;EACJ,CAAC;EAED2kC,YAAY,CAACzkD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1C,IAAI,CAACG,aAAa,CAAC,CAAC,EAAE,IAAI,CAACu4C,MAAM,CAAC;EACtC,CAAC;EAEJU,YAAY,CAACzkD,SAAS,CAACiyC,QAAQ,GAAG+R,cAAc,CAAChkD,SAAS,CAACiyC,QAAQ;EAEhExwC,SAAS,CAACiG,gBAAgB,CAAC,YAAY,EAAE+8C,YAAY,CAAC;;EAEzD;EACG,SAASC,aAAa,GAAG;IAC3B,IAAI,CAACX,MAAM,GAAG,EAAE;IACV,IAAI,CAAClpC,QAAQ,CAAC,MAAM,EAAE,EAAE,CAAC;IACzB,IAAI,CAACY,SAAS,CAAC,UAAU,EAAE,OAAO,CAAC;IACzC,IAAI,CAACA,SAAS,CAAC,QAAQ,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACqH,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC;IAC/B,IAAI,CAACwB,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,MAAM,EAAC,OAAO,EAAC,IAAI,CAAC7Z,UAAU,CAACoQ,KAAK,EAAC,OAAO,CAAC;IAC1E,IAAI,CAACkJ,UAAU,GAAG,IAAI;IACtB,IAAI,CAAC9X,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EACzB;EAEAw4C,aAAa,CAACxkD,KAAK,GAAG,aAAa;EACnCwkD,aAAa,CAACt5C,IAAI,GAAG,gBAAgB;EAErCs5C,aAAa,CAAC1kD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC9D,IAAI,CAACwJ,MAAM,CAACxJ,KAAK,GAAGA,KAAK;IACzB,IAAIA,KAAK,IAAI,IAAI,IAAIA,KAAK,IAAI,EAAE,EAAE;MAC9B;IACJ;IAEA,IAAI;MACT,IAAGA,KAAK,CAAC,CAAC,CAAC,IAAI,GAAG,EACR,IAAI,CAACipC,MAAM,GAAGh5C,IAAI,CAACiD,KAAK,CAAC,GAAG,GAAG8M,KAAK,GAAG,GAAG,CAAC,CAAC,KAE5C,IAAI,CAACipC,MAAM,GAAGh5C,IAAI,CAACiD,KAAK,CAAC8M,KAAK,CAAC;MAChC,IAAI,CAACgF,QAAQ,GAAG,MAAM;IAC1B,CAAC,CAAC,OAAOhU,GAAG,EAAE;MACV,IAAI,CAACgU,QAAQ,GAAG,KAAK;IACzB;EACJ,CAAC;EAED4kC,aAAa,CAAC1kD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC3C,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAClC,IAAG1C,CAAC,IAAIA,CAAC,CAAC1J,MAAM;MAAE;MAClB;QACC,IAAG,CAAC,IAAI,CAAC6kD,MAAM,EACd,IAAI,CAACA,MAAM,GAAG,IAAIrkD,KAAK,EAAE;QAC1B,IAAI,CAACqkD,MAAM,CAAC7kD,MAAM,GAAG0J,CAAC,CAAC1J,MAAM;QAC7B,KAAI,IAAIU,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGgJ,CAAC,CAAC1J,MAAM,EAAE,EAAEU,CAAC,EAC/B,IAAI,CAACmkD,MAAM,CAACnkD,CAAC,CAAC,GAAGgJ,CAAC,CAAChJ,CAAC,CAAC;MACvB;IACA,IAAI,CAAC4L,aAAa,CAAC,CAAC,EAAE,IAAI,CAACu4C,MAAM,CAAC;IAClC,IAAI,CAACv4C,aAAa,CAAC,CAAC,EAAE,IAAI,CAACu4C,MAAM,GAAK,IAAI,CAACA,MAAM,CAAC7kD,MAAM,IAAI,CAAC,GAAI,CAAC,CAAE;EAClE,CAAC;EAEJwlD,aAAa,CAAC1kD,SAAS,CAACiyC,QAAQ,GAAG+R,cAAc,CAAChkD,SAAS,CAACiyC,QAAQ;EAEjExwC,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAEg9C,aAAa,CAAC;EAE3D,SAASC,QAAQ,GACjB;IACO,IAAI,CAAC9pC,QAAQ,CAAC,KAAK,EAAE,OAAO,CAAC;IAC7B,IAAI,CAACA,QAAQ,CAAC,OAAO,EAAE,EAAE,CAAC;IAC1B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,OAAO,CAAC;IACpC,IAAI,CAAC/Q,UAAU,GAAG;MAAEgO,KAAK,EAAE;IAAE,CAAC;IACxB,IAAI,CAAC4L,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,QAAQ,EAAC,GAAG,EAAC,IAAI,CAAC7Z,UAAU,CAACgO,KAAK,EAAC,OAAO,EAAC;MAACqzB,SAAS,EAAE,CAAC;MAAEK,IAAI,EAAE,EAAE;MAAErG,GAAG,EAAE;IAAC,CAAC,CAAC;EAChH;EAEG4e,QAAQ,CAACzkD,KAAK,GAAG,WAAW;EAC5BykD,QAAQ,CAACv5C,IAAI,GAAG,qBAAqB;EAErCu5C,QAAQ,CAAC3kD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtC,IAAIu5C,GAAG,GAAG,IAAI,CAACt5C,YAAY,CAAC,CAAC,CAAC;IACpC,IAAG,CAACs5C,GAAG,EACN;IACK,IAAIh8C,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAClC,IAAG1C,CAAC,KAAKmP,SAAS,EACjB;IACD,IAAG,IAAI,CAACrN,UAAU,CAACgO,KAAK,EACvBksC,GAAG,CAAEziC,IAAI,CAACC,KAAK,CAAC,IAAI,CAAC1X,UAAU,CAACgO,KAAK,CAAC,CAAE,GAAG9P,CAAC;IAC7C,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAACo5C,GAAG,CAAC;EACvB,CAAC;EAEDnjD,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAEi9C,QAAQ,CAAE;EAExD,SAASE,YAAY,GAAG;IACpB,IAAI,CAAChqC,QAAQ,CAAC,OAAO,EAAE,oBAAoB,CAAC;IAC5C,IAAI,CAACA,QAAQ,CAAC,OAAO,EAAE,QAAQ,CAAC;IAChC,IAAI,CAACY,SAAS,CAAC,OAAO,EAAE,EAAE,CAAC;IACjC,IAAI,CAACqH,WAAW,CAAC,OAAO,EAAC,CAAC,CAAC;EACzB;EAEA+hC,YAAY,CAAC3kD,KAAK,GAAG,UAAU;EAC/B2kD,YAAY,CAACz5C,IAAI,GAAG,kCAAkC;EAEtDy5C,YAAY,CAAC7kD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1C,IAAItL,KAAK,GAAG,IAAI,CAACuL,YAAY,CAAC,CAAC,CAAC;IAChC,IAAIoN,KAAK,GAAG,IAAI,CAACpN,YAAY,CAAC,CAAC,CAAC;IACtC,IAAGoN,KAAK,IAAI,IAAI,EACfA,KAAK,GAAG,IAAI,CAAChO,UAAU,CAACgO,KAAK;IAC9B,IAAG3Y,KAAK,IAAI,IAAI,IAAI2Y,KAAK,IAAI,IAAI,EAChC;IACK,IAAI,CAAClN,aAAa,CAAC,CAAC,EAAEzL,KAAK,CAACoiB,IAAI,CAACC,KAAK,CAACyE,MAAM,CAACnO,KAAK,CAAC,CAAC,CAAC,CAAE;EAC5D,CAAC;EAEDjX,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAEm9C,YAAY,CAAC;EAEzD,SAASC,YAAY,GAAG;IACpB,IAAI,CAACjqC,QAAQ,CAAC,OAAO,EAAE,OAAO,CAAC;IAC/B,IAAI,CAACA,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC9B,IAAI,CAACA,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC9B,IAAI,CAACY,SAAS,CAAC,OAAO,EAAE,EAAE,CAAC;IACjC,IAAI,CAACqH,WAAW,CAAC,KAAK,EAAC,CAAC,CAAC;IACzB,IAAI,CAACA,WAAW,CAAC,QAAQ,EAAC,CAAC,CAAC;EAC1B;EAEAgiC,YAAY,CAAC5kD,KAAK,GAAG,iBAAiB;EACtC4kD,YAAY,CAAC15C,IAAI,GAAG,iCAAiC;EAErD05C,YAAY,CAAC9kD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1C,IAAI05C,KAAK,GAAG,IAAI,CAACz5C,YAAY,CAAC,CAAC,CAAC;IAChC,IAAI05C,GAAG,GAAG,IAAI,CAAC15C,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI6L,GAAG,GAAG,IAAI,CAAC7L,YAAY,CAAC,CAAC,CAAC;IACpC,IAAG05C,GAAG,IAAI,IAAI,EACbA,GAAG,GAAG,IAAI,CAACt6C,UAAU,CAACs6C,GAAG;IAC1B,IAAG7tC,GAAG,IAAI,IAAI,EACbA,GAAG,GAAG,IAAI,CAACzM,UAAU,CAAC2M,MAAM;IAC7B,IAAG0tC,KAAK,IAAI,IAAI,IAAIC,GAAG,IAAI,IAAI,IAAI7tC,GAAG,IAAI,IAAI,EAC7C;IACD,IAAI6tC,GAAG,GAAGD,KAAK,CAAC5iC,IAAI,CAACC,KAAK,CAACyE,MAAM,CAACm+B,GAAG,CAAC,CAAC,CAAC;IACxC,IAAGA,GAAG,EACC,IAAI,CAACx5C,aAAa,CAAC,CAAC,EAAEw5C,GAAG,CAAC7iC,IAAI,CAACC,KAAK,CAACyE,MAAM,CAAC1P,GAAG,CAAC,CAAC,CAAC,CAAE,CAAC,KAErD,IAAI,CAAC3L,aAAa,CAAC,CAAC,EAAE,IAAI,CAAE;EACjC,CAAC;EAED/J,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAEo9C,YAAY,CAAC;EAE3D,SAASG,cAAc,GAAG;IACtB,IAAI,CAACpqC,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC9B,IAAI,CAACY,SAAS,CAAC,UAAU,EAAE,CAAC,CAAC;IAC7B,IAAI,CAACqH,WAAW,CAAC,OAAO,EAAE,CAAC,CAAC;IAC5B,IAAI,CAACwB,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,MAAM,EAAC,OAAO,EAAC,EAAE,EAAC,IAAI,CAAC0tB,QAAQ,CAAC5hC,IAAI,CAAC,IAAI,CAAC,CAAE;IACzE,IAAI,CAAC2T,UAAU,GAAG,IAAI;IACtB,IAAI,CAAC9X,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;IACrB,IAAI,CAAC63C,MAAM,GAAG,IAAI;EACtB;EAEAkB,cAAc,CAAC/kD,KAAK,GAAG,iBAAiB;EACxC+kD,cAAc,CAAC75C,IAAI,GAAG,mCAAmC;EAEzD65C,cAAc,CAACjlD,SAAS,CAACiyC,QAAQ,GAAG,UAASrpC,CAAC,EAAE;IAC5C,IAAI,CAAC8B,UAAU,CAACoQ,KAAK,GAAGlS,CAAC;IACzB,IAAI,CAAC0b,MAAM,CAACxJ,KAAK,GAAGlS,CAAC;EACzB,CAAC;EAEDq8C,cAAc,CAACjlD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IAC3C,IAAI,IAAI,CAACjU,KAAK,CAAC2Y,SAAS,EAAE;MACtB,OAAO,KAAK,GAAG,IAAI,CAACla,UAAU,CAACoQ,KAAK;IACxC;IACA,OAAO,IAAI,CAAC5a,KAAK;EACrB,CAAC;EAED+kD,cAAc,CAACjlD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC/D,IAAI,CAACwJ,MAAM,CAACxJ,KAAK,GAAGA,KAAK;EAC7B,CAAC;EAEDmqC,cAAc,CAACjlD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAIsD,IAAI,GAAG,IAAI,CAACrD,YAAY,CAAC,CAAC,CAAC;IAC/B,IAAIqD,IAAI,IAAI,IAAI,EAAE;MACd,IAAI,CAACnD,aAAa,CAAC,CAAC,EAAEmD,IAAI,CAAC,IAAI,CAACjE,UAAU,CAACoQ,KAAK,CAAC,CAAC;IACtD;EACJ,CAAC;EAEDrZ,SAAS,CAACiG,gBAAgB,CAAC,uBAAuB,EAAEu9C,cAAc,CAAC;EAEnE,SAASC,UAAU,GAAG;IAClB,IAAI,CAACrqC,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC;IACxB,IAAI,CAACY,SAAS,CAAC,MAAM,EAAE,OAAO,CAAC;IAC/B,IAAI,CAACvP,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EACzB;EAEAg5C,UAAU,CAAChlD,KAAK,GAAG,aAAa;EAChCglD,UAAU,CAAC95C,IAAI,GAAG,6CAA6C;EAE/D85C,UAAU,CAACllD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAIsD,IAAI,GAAG,IAAI,CAACrD,YAAY,CAAC,CAAC,CAAC;IAC/B,IAAIqD,IAAI,IAAI,IAAI,EAAE;MACd,IAAI,CAACnD,aAAa,CAAC,CAAC,EAAEhD,MAAM,CAACmyB,IAAI,CAAChsB,IAAI,CAAC,CAAE;IAC7C;EACJ,CAAC;EAEDlN,SAAS,CAACiG,gBAAgB,CAAC,mBAAmB,EAAEw9C,UAAU,CAAC;EAG9D,SAASC,SAAS,GAClB;IACO,IAAI,CAACtqC,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC;IACxB,IAAI,CAACA,QAAQ,CAAC,OAAO,EAAE,EAAE,CAAC;IAC1B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,EAAE,CAAC;IAC/B,IAAI,CAAC/Q,UAAU,GAAG;MAAEgV,QAAQ,EAAE;IAAG,CAAC;IAC5B,IAAI,CAACgkC,WAAW,GAAG,IAAI,CAACn/B,SAAS,CAAC,MAAM,EAAC,OAAO,EAAC,IAAI,CAAC7Z,UAAU,CAACgV,QAAQ,EAAC,UAAU,CAAC;EAC5F;EAEGylC,SAAS,CAACjlD,KAAK,GAAG,YAAY;EAC9BilD,SAAS,CAAC/5C,IAAI,GAAG,8BAA8B;EAE/C+5C,SAAS,CAACnlD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACvC,IAAIyC,GAAG,GAAG,IAAI,CAACxC,YAAY,CAAC,CAAC,CAAC;IACpC,IAAG,CAACwC,GAAG,EACN;IACK,IAAIlF,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAClC,IAAG1C,CAAC,KAAKmP,SAAS,EACjB;IACD,IAAG,IAAI,CAACrN,UAAU,CAACgV,QAAQ,EAC1B5R,GAAG,CAAE,IAAI,CAACpD,UAAU,CAACgV,QAAQ,CAAE,GAAG9W,CAAC;IACpC,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAACsC,GAAG,CAAC;EACvB,CAAC;EAEDrM,SAAS,CAACiG,gBAAgB,CAAC,kBAAkB,EAAEy9C,SAAS,CAAE;EAG1D,SAASC,YAAY,GAAG;IACpB,IAAI,CAACvqC,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IACrC,IAAI,CAAC4pC,OAAO,GAAG,CAAC,CAAC;IACjB,IAAIr2C,IAAI,GAAG,IAAI;IACf,IAAI,CAACuV,SAAS,CAAC,QAAQ,EAAC,OAAO,EAAC,EAAE,EAAC,YAAU;MAC5CvV,IAAI,CAACq2C,OAAO,GAAG,CAAC,CAAC;IAClB,CAAC,CAAC;IACF,IAAI,CAACn5C,IAAI,GAAG,IAAI,CAACC,WAAW,EAAE;EAC5B;EAEAi5C,YAAY,CAACllD,KAAK,GAAG,eAAe;EACpCklD,YAAY,CAACh6C,IAAI,GAAG,kDAAkD;EAEtEg6C,YAAY,CAACplD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1C,IAAI8K,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8K,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;IAClC,IAAIg6C,CAAC,GAAG,IAAI,CAACD,OAAO;IACpB,IAAGlvC,CAAC,EACH,KAAI,IAAIvW,CAAC,IAAIuW,CAAC,EACbmvC,CAAC,CAAC1lD,CAAC,CAAC,GAAGuW,CAAC,CAACvW,CAAC,CAAC;IACb,IAAGwW,CAAC,EACH,KAAI,IAAIxW,CAAC,IAAIwW,CAAC,EACbkvC,CAAC,CAAC1lD,CAAC,CAAC,GAAGwW,CAAC,CAACxW,CAAC,CAAC;IACb,IAAI,CAAC4L,aAAa,CAAC,CAAC,EAAC85C,CAAC,CAAC;EACrB,CAAC;EAED7jD,SAAS,CAACiG,gBAAgB,CAAC,qBAAqB,EAAE09C,YAAY,CAAE;;EAEhE;EACA,SAASG,QAAQ,GAAG;IAChB,IAAI,CAACr5C,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC2O,QAAQ,CAAC,IAAI,CAAC;IACnB,IAAI,CAACY,SAAS,CAAC,KAAK,CAAC;IAC3B,IAAI,CAAC/Q,UAAU,GAAG;MAAE86C,OAAO,EAAE,QAAQ;MAAEC,SAAS,EAAEF,QAAQ,CAACG;IAAU,CAAC;IAChE,IAAI,CAAC5qC,KAAK,GAAG,IAAI;EACrB;EAEAyqC,QAAQ,CAACrlD,KAAK,GAAG,UAAU;EAC3BqlD,QAAQ,CAACn6C,IAAI,GAAG,2BAA2B;EAE9Cm6C,QAAQ,CAACG,SAAS,GAAG,CAAC,CAAC,CAAC;EACxBH,QAAQ,CAACI,KAAK,GAAG,CAAC,CAAC,CAAC;EACpBJ,QAAQ,CAACK,WAAW,GAAG,CAAC,CAAC,CAAC;;EAEvBL,QAAQ,CAAC,YAAY,CAAC,GAAG;IAAE59C,IAAI,EAAE,MAAM;IAAE6c,MAAM,EAAE;MAAC,WAAW,EAAC+gC,QAAQ,CAACG,SAAS;MAAE,OAAO,EAACH,QAAQ,CAACI,KAAK;MAAC,QAAQ,EAAEJ,QAAQ,CAACK;IAAW;EAAE,CAAC;EAE1IL,QAAQ,CAACvlD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAIo6C,SAAS,GAAG,IAAI,CAACI,YAAY,EAAE;IAEnC,IAAG,IAAI,CAAChlC,gBAAgB,CAAC,CAAC,CAAC,EAC3B;MACC,IAAI,CAAC/F,KAAK,GAAG,IAAI,CAACxP,YAAY,CAAC,CAAC,CAAC;MACjCm6C,SAAS,CAAE,IAAI,CAAC/6C,UAAU,CAAC86C,OAAO,CAAE,GAAG,IAAI,CAAC1qC,KAAK;MACjD,IAAI,CAACtP,aAAa,CAAC,CAAC,EAAE,IAAI,CAACsP,KAAK,CAAE;MAClC;IACD;IAEA,IAAI,CAACtP,aAAa,CAAE,CAAC,EAAEi6C,SAAS,CAAE,IAAI,CAAC/6C,UAAU,CAAC86C,OAAO,CAAE,CAAE;EAC3D,CAAC;EAEJD,QAAQ,CAACvlD,SAAS,CAAC6lD,YAAY,GAAG,YAClC;IACC,QAAO,IAAI,CAACn7C,UAAU,CAAC+6C,SAAS;MAE/B,KAAKF,QAAQ,CAACI,KAAK;QAClB,IAAG,IAAI,CAACvyC,KAAK,EACZ,OAAO,IAAI,CAACA,KAAK,CAACpB,IAAI;QACvB,OAAO,CAAC,CAAC;QACT;MACD,KAAKuzC,QAAQ,CAACK,WAAW;QACxB,OAAOpkD,MAAM;QACb;MACD,KAAK+jD,QAAQ,CAACG,SAAS;MACvB;QACC,OAAOjkD,SAAS,CAACwE,OAAO;QACxB;IAAM;EAET,CAAC;EAEEs/C,QAAQ,CAACvlD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IACrC,OAAO,IAAI,CAACxV,UAAU,CAAC86C,OAAO;EAClC,CAAC;EAED/jD,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAE69C,QAAQ,CAAC;EAEtD,SAASrmD,MAAM,CAAC0J,CAAC,EAAE;IACf,IAAGA,CAAC,IAAIA,CAAC,CAAC1J,MAAM,IAAI,IAAI,EAC7B,OAAO2nB,MAAM,CAACje,CAAC,CAAC1J,MAAM,CAAC;IACxB,OAAO,CAAC;EACN;EAEAuC,SAAS,CAAC6I,kBAAkB,CACxB,cAAc,EACdpL,MAAM,EACN,CAAC,EAAE,CAAC,EACJ,QAAQ,CACX;EAED,SAASA,MAAM,CAAC0J,CAAC,EAAE;IACf,IAAGA,CAAC,IAAIA,CAAC,CAAC1J,MAAM,IAAI,IAAI,EAC7B,OAAO2nB,MAAM,CAACje,CAAC,CAAC1J,MAAM,CAAC;IACxB,OAAO,CAAC;EACN;EAEAuC,SAAS,CAAC6I,kBAAkB,CACxB,WAAW,EACX,UAASmC,CAAC,EAAC;IAAE,OAAO,CAACA,CAAC;EAAE,CAAC,EACzB,CAAC,EAAE,CAAC,EACJ,SAAS,CACZ;EAEJ,SAASq5C,YAAY,GAAG;IACjB,IAAI,CAAC55C,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC2O,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAE;IACzB,IAAI,CAACA,QAAQ,CAAC,UAAU,EAAEpZ,SAAS,CAAC0C,MAAM,CAAE;IAClD,IAAI,CAACuG,UAAU,GAAG;MAAEo0B,QAAQ,EAAE;IAAY,CAAC;IACrC,IAAI,CAAChkB,KAAK,GAAG,IAAI;IACvB,IAAI9L,IAAI,GAAG,IAAI;IACf,IAAI,CAACuV,SAAS,CAAC,QAAQ,EAAC,UAAU,EAAC,EAAE,EAAE,UAAS3b,CAAC,EAAC;MACjD,IAAG,CAACoG,IAAI,CAAC8L,KAAK,EACb;MACD9L,IAAI,CAAC+2C,cAAc,EAAE;IACtB,CAAC,CAAC;EACA;EAEAD,YAAY,CAAC5lD,KAAK,GAAG,UAAU;EAC/B4lD,YAAY,CAAC16C,IAAI,GAAG,oBAAoB;EAE3C06C,YAAY,CAAC9lD,SAAS,CAAC+lD,cAAc,GAAG,YACxC;IACC,IAAG,IAAI,CAACjrC,KAAK,IAAI,IAAI,EACpB;IAED,IAAIs1B,GAAG,GAAG,IAAI;IACd,IAAG,IAAI,CAACt1B,KAAK,CAACzR,WAAW,KAAKC,MAAM,EACnC8mC,GAAG,GAAG,IAAI,CAACt1B,KAAK,CAAC,KAEjBs1B,GAAG,GAAGrlC,IAAI,CAACC,SAAS,CAAC,IAAI,CAAC8P,KAAK,CAAC;IAEjC,IAAI+jB,IAAI,GAAG,IAAIlvB,IAAI,CAAC,CAACygC,GAAG,CAAC,CAAC;IAC1B,IAAIvhC,GAAG,GAAGm3C,GAAG,CAACC,eAAe,CAAEpnB,IAAI,CAAE;IACrC,IAAI3U,OAAO,GAAGhd,QAAQ,CAACQ,aAAa,CAAC,GAAG,CAAC;IACzCwc,OAAO,CAAC8tB,YAAY,CAAC,MAAM,EAAEnpC,GAAG,CAAC;IACjCqb,OAAO,CAAC8tB,YAAY,CAAC,UAAU,EAAE,IAAI,CAACttC,UAAU,CAACo0B,QAAQ,CAAE;IAC3D5U,OAAO,CAACmO,KAAK,CAAC+e,OAAO,GAAG,MAAM;IAC9BlqC,QAAQ,CAAComC,IAAI,CAAC3lC,WAAW,CAACuc,OAAO,CAAC;IAClCA,OAAO,CAACg8B,KAAK,EAAE;IACfh5C,QAAQ,CAAComC,IAAI,CAAC1lC,WAAW,CAACsc,OAAO,CAAC;IAClC7rB,UAAU,CAAE,YAAU;MAAE2nD,GAAG,CAACG,eAAe,CAAEt3C,GAAG,CAAE;IAAE,CAAC,EAAE,IAAI,GAAC,EAAE,CAAE,CAAC,CAAC;EACnE,CAAC;;EAEEi3C,YAAY,CAAC9lD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE;IAC5D,IAAIvL,IAAI,GAAG,IAAI;IACf3Q,UAAU,CAAE,YAAU;MAAE2Q,IAAI,CAAC+2C,cAAc,EAAE;IAAE,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;EACzD,CAAC;;EAEED,YAAY,CAAC9lD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1C,IAAI,IAAI,CAACwH,MAAM,CAAC,CAAC,CAAC,EAAE;MAChB,IAAI,CAACiI,KAAK,GAAG,IAAI,CAACxP,YAAY,CAAC,CAAC,CAAC;IACrC;EACJ,CAAC;EAEDw6C,YAAY,CAAC9lD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IACzC,IAAI,IAAI,CAACjU,KAAK,CAAC2Y,SAAS,EAAE;MACtB,OAAO,IAAI,CAACla,UAAU,CAACo0B,QAAQ;IACnC;IACA,OAAO,IAAI,CAAC5+B,KAAK;EACrB,CAAC;EAEDuB,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAEo+C,YAAY,CAAC;;EAI1D;EACA,SAASM,KAAK,GAAG;IACb,IAAI,CAACl6C,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC2O,QAAQ,CAAC,OAAO,EAAE,CAAC,EAAE;MAAE+I,KAAK,EAAE;IAAG,CAAC,CAAC;IACxC,IAAI,CAAC9I,KAAK,GAAG,CAAC;EAClB;EAEAsrC,KAAK,CAAClmD,KAAK,GAAG,OAAO;EACrBkmD,KAAK,CAACh7C,IAAI,GAAG,qBAAqB;EAElCg7C,KAAK,CAACpmD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACnC,IAAI,IAAI,CAACwH,MAAM,CAAC,CAAC,CAAC,EAAE;MAChB,IAAI,CAACiI,KAAK,GAAG,IAAI,CAACxP,YAAY,CAAC,CAAC,CAAC;IACrC;EACJ,CAAC;EAED86C,KAAK,CAACpmD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IAClC,IAAI,IAAI,CAACjU,KAAK,CAAC2Y,SAAS,EAAE;MACtB,OAAO,IAAI,CAAC/R,MAAM,CAAC,CAAC,CAAC,CAAC+Q,KAAK;IAC/B;IACA,OAAO,IAAI,CAAC1jB,KAAK;EACrB,CAAC;EAEDkmD,KAAK,CAACnmC,QAAQ,GAAG,UAASvP,CAAC,EAAE;IACzB,IAAIA,CAAC,IAAI,IAAI,EAAE;MACX,OAAO,MAAM;IACjB,CAAC,MAAM,IAAIA,CAAC,CAACrH,WAAW,KAAKwd,MAAM,EAAE;MACjC,OAAOnW,CAAC,CAAC+zB,OAAO,CAAC,CAAC,CAAC;IACvB,CAAC,MAAM,IAAI/zB,CAAC,CAACrH,WAAW,KAAK3J,KAAK,EAAE;MAChC,IAAI0wC,GAAG,GAAG,GAAG;MACb,KAAK,IAAIxwC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG8Q,CAAC,CAACxR,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC/BwwC,GAAG,IAAIgW,KAAK,CAACnmC,QAAQ,CAACvP,CAAC,CAAC9Q,CAAC,CAAC,CAAC,IAAIA,CAAC,GAAG,CAAC,IAAI8Q,CAAC,CAACxR,MAAM,GAAG,GAAG,GAAG,EAAE,CAAC;MAChE;MACAkxC,GAAG,IAAI,GAAG;MACV,OAAOA,GAAG;IACd,CAAC,MAAM;MACH,OAAO9mC,MAAM,CAACoH,CAAC,CAAC;IACpB;EACJ,CAAC;EAED01C,KAAK,CAACpmD,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IAC7C;IACA,IAAI,CAACla,MAAM,CAAC,CAAC,CAAC,CAAC+Q,KAAK,GAAGwiC,KAAK,CAACnmC,QAAQ,CAAC,IAAI,CAACnF,KAAK,CAAC;EACrD,CAAC;EAEDrZ,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAE0+C,KAAK,CAAC;;EAEhD;EACA,SAASC,IAAI,GAAG;IACZ,IAAI,CAACxrC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC;IACtB,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC;IACxB,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEAm6C,IAAI,CAACnmD,KAAK,GAAG,MAAM;EACnBmmD,IAAI,CAACj7C,IAAI,GAAG,mCAAmC;EAE/Ci7C,IAAI,CAACrmD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAClC,IAAI,CAACG,aAAa,CAAC,CAAC,EAAE,IAAI,CAACF,YAAY,CAAC,CAAC,CAAC,CAAC;EAC/C,CAAC;EAED7J,SAAS,CAACiG,gBAAgB,CAAC,YAAY,EAAE2+C,IAAI,CAAC;;EAE9C;EACA,SAASC,OAAO,GAAG;IACf,IAAI,CAACl6C,IAAI,GAAG3K,SAAS,CAAC8C,QAAQ;IAC9B,IAAI,CAAC2H,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC4W,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC;IAC3B,IAAI,CAACjI,QAAQ,CAAC,KAAK,EAAEpZ,SAAS,CAACyC,KAAK,CAAC;IACrC,IAAI,CAAC2W,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;EAC3B;EAEAyrC,OAAO,CAACpmD,KAAK,GAAG,SAAS;EACzBomD,OAAO,CAACl7C,IAAI,GAAG,+BAA+B;EAE9Ck7C,OAAO,CAACtmD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE;IACjD;IACA,IAAIqE,GAAG,GAAG,IAAI,CAACtT,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;IAChC;IACA,IAAI,CAACsT,GAAG,EAAEA,GAAG,GAAG,IAAI,CAAClU,UAAU,CAACkU,GAAG;IACnC,IAAI,CAACA,GAAG,EAAEA,GAAG,GAAG,SAAS,GAACrE,KAAK,CAAC,CAAC;IACjC,IAAIvC,MAAM,IAAI,KAAK,EAAE;MACjBnQ,OAAO,CAACC,GAAG,CAAC8W,GAAG,CAAC;IACpB,CAAC,MAAM,IAAI5G,MAAM,IAAI,MAAM,EAAE;MACzBnQ,OAAO,CAACqB,IAAI,CAAC0V,GAAG,CAAC;IACrB,CAAC,MAAM,IAAI5G,MAAM,IAAI,OAAO,EAAE;MAC1BnQ,OAAO,CAACkE,KAAK,CAAC6S,GAAG,CAAC;IACtB;EACJ,CAAC;EAED0nC,OAAO,CAACtmD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACrC,IAAIuT,GAAG,GAAG,IAAI,CAACtT,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;IAChC,IAAI,CAACsT,GAAG,EAAEA,GAAG,GAAG,IAAI,CAAClU,UAAU,CAACkU,GAAG;IACnC,IAAIA,GAAG,IAAI,IAAI,IAAI,OAAOA,GAAG,IAAI,WAAW,EAAE;MAC1C,IAAI,CAAClU,UAAU,CAACkU,GAAG,GAAGA,GAAG;MACzB/W,OAAO,CAACC,GAAG,CAAC8W,GAAG,CAAC;IACpB;EACJ,CAAC;EAED0nC,OAAO,CAACtmD,SAAS,CAACovC,WAAW,GAAG,YAAW;IACvC,OAAO,CACH,CAAC,KAAK,EAAE3tC,SAAS,CAAC0C,MAAM,CAAC,EACzB,CAAC,MAAM,EAAE1C,SAAS,CAAC0C,MAAM,CAAC,EAC1B,CAAC,OAAO,EAAE1C,SAAS,CAAC0C,MAAM,CAAC,CAC9B;EACL,CAAC;EAED1C,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAE4+C,OAAO,CAAC;;EAEpD;EACA,SAASC,KAAK,GAAG;IACb,IAAI,CAACn6C,IAAI,GAAG3K,SAAS,CAAC8C,QAAQ;IAC9B,IAAI,CAACue,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC;IAC3B,IAAI,CAACjI,QAAQ,CAAC,EAAE,EAAEpZ,SAAS,CAACyC,KAAK,CAAC;IAClC,IAAI8K,IAAI,GAAG,IAAI;IACf,IAAI,CAACsV,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,MAAM,EAAE,MAAM,EAAE,EAAE,EAAE,KAAK,CAAC;IACvD,IAAI,CAACP,UAAU,GAAG,IAAI;IACtB,IAAI,CAAC9X,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EACzB;EAEAq6C,KAAK,CAACrmD,KAAK,GAAG,OAAO;EACrBqmD,KAAK,CAACn7C,IAAI,GAAG,sBAAsB;EACnCm7C,KAAK,CAAC1nC,KAAK,GAAG,MAAM;EAEpB0nC,KAAK,CAACvmD,SAAS,CAACge,WAAW,GAAG,UAAStN,CAAC,EAAE;IACtC,IAAI,CAAC4T,MAAM,CAACxJ,KAAK,GAAGpK,CAAC,CAAChG,UAAU,CAACkU,GAAG;EACxC,CAAC;EAED2nC,KAAK,CAACvmD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE;IAC/C,IAAIqE,GAAG,GAAG,IAAI,CAAClU,UAAU,CAACkU,GAAG;IAC7BvgB,UAAU,CAAC,YAAW;MAClBmoD,KAAK,CAAC5nC,GAAG,CAAC;IACd,CAAC,EAAE,EAAE,CAAC;EACV,CAAC;EAEDnd,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAE6+C,KAAK,CAAC;;EAEhD;EACA,SAASE,UAAU,GAAG;IAClB,IAAI,CAACv6C,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC4W,WAAW,CAAC,WAAW,EAAE,WAAW,CAAC;IAC1C,IAAI,CAACjI,QAAQ,CAAC,GAAG,EAAE,CAAC,CAAC;IACrB,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,CAAC,CAAC;IACrB,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC;IAExB,IAAI,CAACirC,KAAK,GAAG,IAAI;IACjB,IAAI,CAAC/3C,IAAI,GAAG,CAAC,CAAC;EAClB;EAEA83C,UAAU,CAACzmD,SAAS,CAACge,WAAW,GAAG,UAAStN,CAAC,EAAE;IAC3C,IAAIA,CAAC,CAAChG,UAAU,CAACW,SAAS,IAAI5J,SAAS,CAACoE,aAAa,EACjD,IAAI,CAAC8gD,WAAW,CAACj2C,CAAC,CAAChG,UAAU,CAACW,SAAS,CAAC,CAAC,KAElDxD,OAAO,CAACqB,IAAI,CAAC,uDAAuD,CAAC;EACpE,CAAC;EAEDu9C,UAAU,CAACvmD,KAAK,GAAG,QAAQ;EAC3BumD,UAAU,CAACr7C,IAAI,GAAG,sCAAsC;EAExDq7C,UAAU,CAACriC,YAAY,GAAG;IACtB/Y,SAAS,EAAE;MAAE1D,IAAI,EAAE;IAAO;EAC9B,CAAC;EAED8+C,UAAU,CAACzmD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC3D,IAAI5Z,IAAI,IAAI,WAAW,IAAIO,SAAS,CAACoE,aAAa,EAC9C,IAAI,CAAC8gD,WAAW,CAAC7rC,KAAK,CAAC,CAAC,KAEjCjT,OAAO,CAACqB,IAAI,CAAC,uDAAuD,CAAC;EACpE,CAAC;EAEDu9C,UAAU,CAACzmD,SAAS,CAAC2mD,WAAW,GAAG,UAAS/7C,IAAI,EAAE;IAC9C,IAAI,CAAC87C,KAAK,GAAG,IAAI;IACjB,IAAI97C,IAAI,CAAC1L,MAAM,GAAG,GAAG,EAAE;MACnB2I,OAAO,CAACqB,IAAI,CAAC,gCAAgC,CAAC;IAClD,CAAC,MAAM;MACH,IAAI09C,QAAQ,GAAGh8C,IAAI,CAACrB,WAAW,EAAE;MACjC,IAAIs9C,eAAe,GAAG,CAClB,QAAQ,EACR,MAAM,EACN,UAAU,EACV,MAAM,EACN,YAAY,EACZ,UAAU,CACb,CAAC,CAAC;MACH,KAAK,IAAIjnD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGinD,eAAe,CAAC3nD,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC7C,IAAIgnD,QAAQ,CAACx4C,OAAO,CAACy4C,eAAe,CAACjnD,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE;UAC5CiI,OAAO,CAACqB,IAAI,CAAC,gBAAgB,CAAC;UAC9B;QACJ;MACJ;MACA,IAAI;QACA,IAAI,CAACw9C,KAAK,GAAG,IAAIx7C,QAAQ,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,MAAM,EAAEN,IAAI,CAAC;MAClE,CAAC,CAAC,OAAOkB,GAAG,EAAE;QACVjE,OAAO,CAACkE,KAAK,CAAC,sBAAsB,CAAC;QACrClE,OAAO,CAACkE,KAAK,CAACD,GAAG,CAAC;MACtB;IACJ;EACJ,CAAC;EAED26C,UAAU,CAACzmD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAI,CAAC,IAAI,CAACq7C,KAAK,EAAE;MACb;IACJ;IAEA,IAAI;MACA,IAAIvwC,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;MAC5B,IAAI8K,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;MAC5B,IAAIg6C,CAAC,GAAG,IAAI,CAACh6C,YAAY,CAAC,CAAC,CAAC;MAC5B,IAAI,CAACE,aAAa,CAAC,CAAC,EAAE,IAAI,CAACk7C,KAAK,CAACvwC,CAAC,EAAEC,CAAC,EAAEkvC,CAAC,EAAE,IAAI,CAAC32C,IAAI,EAAE,IAAI,CAAC,CAAC;IAC/D,CAAC,CAAC,OAAO7C,GAAG,EAAE;MACVjE,OAAO,CAACkE,KAAK,CAAC,iBAAiB,CAAC;MAChClE,OAAO,CAACkE,KAAK,CAACD,GAAG,CAAC;IACtB;EACJ,CAAC;EAED26C,UAAU,CAACzmD,SAAS,CAAC2vC,YAAY,GAAG,YAAW;IAC3C,OAAO,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;EACtB,CAAC;EAEDluC,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAE++C,UAAU,CAAC;EAGtD,SAASK,cAAc,GAAG;IACtB,IAAI,CAACjsC,QAAQ,CAAC,GAAG,EAAE,CAAC,CAAC;IACrB,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,CAAC,CAAC;IACrB,IAAI,CAACY,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC;IACjC,IAAI,CAACA,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC;IAClC,IAAI,CAACqH,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC;IACxB,IAAI,CAACA,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC;IACxB,IAAI,CAACA,WAAW,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE;MAAE0B,MAAM,EAAEsiC,cAAc,CAACtiC;IAAO,CAAC,CAAC;IAC7E,IAAI,CAACD,SAAS,CAAC,OAAO,EAAC,KAAK,EAAC,IAAI,CAAC7Z,UAAU,CAACq8C,EAAE,EAAC;MAAErnC,QAAQ,EAAE,IAAI;MAAE8E,MAAM,EAAEsiC,cAAc,CAACtiC;IAAO,CAAC,CAAE;IAE7F,IAAI,CAACtY,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEA46C,cAAc,CAACtiC,MAAM,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC;EACtCsiC,cAAc,CAAC,KAAK,CAAC,GAAG;IACpBn/C,IAAI,EAAE,MAAM;IACZzH,KAAK,EAAE,WAAW;IAClBskB,MAAM,EAAEsiC,cAAc,CAACtiC;EAC3B,CAAC;EAEDsiC,cAAc,CAAC5mD,KAAK,GAAG,WAAW;EAClC4mD,cAAc,CAAC17C,IAAI,GAAG,qCAAqC;EAE3D07C,cAAc,CAAC9mD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IAC3C,OAAO,KAAK,GAAG,IAAI,CAACxV,UAAU,CAACq8C,EAAE,GAAG,KAAK;EAC7C,CAAC;EAEDD,cAAc,CAAC9mD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAI8K,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI6K,CAAC,KAAK4B,SAAS,EAAE;MACjB5B,CAAC,GAAG,IAAI,CAACzL,UAAU,CAACyL,CAAC;IACzB,CAAC,MAAM;MACH,IAAI,CAACzL,UAAU,CAACyL,CAAC,GAAGA,CAAC;IACzB;IAEA,IAAIC,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8K,CAAC,KAAK2B,SAAS,EAAE;MACjB3B,CAAC,GAAG,IAAI,CAAC1L,UAAU,CAAC0L,CAAC;IACzB,CAAC,MAAM;MACH,IAAI,CAAC1L,UAAU,CAAC0L,CAAC,GAAGA,CAAC;IACzB;IAEA,IAAItJ,MAAM,GAAG,KAAK;IAClB,IAAI,QAAOqJ,CAAC,aAAWC,CAAC,GAAC;MACrB,QAAQ,IAAI,CAAC1L,UAAU,CAACq8C,EAAE;QACtB,KAAK,IAAI;QACT,KAAK,IAAI;UACL;UACAj6C,MAAM,GAAG,IAAI;UACb,gBAAcqJ,CAAC;YACX,KAAK,QAAQ;cACT,IAAI8iC,MAAM,GAAGzwC,MAAM,CAACw+C,mBAAmB,CAAC7wC,CAAC,CAAC;cAC1C,IAAI8wC,MAAM,GAAGz+C,MAAM,CAACw+C,mBAAmB,CAAC5wC,CAAC,CAAC;cAC1C,IAAI6iC,MAAM,CAAC/5C,MAAM,IAAI+nD,MAAM,CAAC/nD,MAAM,EAAC;gBAC/B4N,MAAM,GAAG,KAAK;gBACd;cACJ;cACA,KAAK,IAAIlN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGq5C,MAAM,CAAC/5C,MAAM,EAAEU,CAAC,EAAE,EAAE;gBACpC,IAAIsnD,QAAQ,GAAGjO,MAAM,CAACr5C,CAAC,CAAC;gBACxB,IAAIuW,CAAC,CAAC+wC,QAAQ,CAAC,KAAK9wC,CAAC,CAAC8wC,QAAQ,CAAC,EAAE;kBAC7Bp6C,MAAM,GAAG,KAAK;kBACd;gBACJ;cACJ;cACJ;YACA;cACIA,MAAM,GAAGqJ,CAAC,IAAIC,CAAC;UAAC;UAExB,IAAI,IAAI,CAAC1L,UAAU,CAACq8C,EAAE,IAAI,IAAI,EAAEj6C,MAAM,GAAG,CAACA,MAAM;UAChD;QACJ;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MAjBgB;IAmBR;;IACA,IAAI,CAACtB,aAAa,CAAC,CAAC,EAAEsB,MAAM,CAAC;IAC7B,IAAI,CAACtB,aAAa,CAAC,CAAC,EAAE,CAACsB,MAAM,CAAC;EAClC,CAAC;EAEDrL,SAAS,CAACiG,gBAAgB,CAAC,qBAAqB,EAAEo/C,cAAc,CAAC;AAErE,CAAC,EAAE,IAAI,CAAC;;AAER;AACA,CAAC,UAAStlD,MAAM,EAAE;EACd,IAAIC,SAAS,GAAGD,MAAM,CAACC,SAAS;;EAEhC;EACA,SAAS0lD,QAAQ,GAAG;IAChB,IAAI,CAACj7C,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC2O,QAAQ,CAAC,OAAO,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;EAC5C;EAEAgjD,QAAQ,CAACjnD,KAAK,GAAG,WAAW;EAC5BinD,QAAQ,CAAC/7C,IAAI,GAAG,sBAAsB;EAEtC+7C,QAAQ,CAACnnD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,EAAE;IAC3D/D,OAAO,CAACC,GAAG,CAACkQ,MAAM,EAAEuC,KAAK,CAAC;EAC9B,CAAC;EAED9Y,SAAS,CAACiG,gBAAgB,CAAC,YAAY,EAAEy/C,QAAQ,CAAC;;EAElD;EACA,SAASC,YAAY,GAAG;IACpB,IAAI,CAACl7C,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC2O,QAAQ,CAAC,IAAI,EAAE,EAAE,CAAC;IACvB,IAAI,CAACY,SAAS,CAAC,MAAM,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACvC,IAAI,CAACuX,SAAS,CAAC,QAAQ,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACzC,IAAI,CAACuX,SAAS,CAAC,OAAO,EAAEha,SAAS,CAACyC,KAAK,CAAC;IAC9C,IAAI,CAACwG,UAAU,GAAG;MAAE28C,cAAc,EAAE;IAAK,CAAC;IAC1C,IAAI,CAAC9+C,IAAI,GAAG,CAAC;EACX;EAEA6+C,YAAY,CAAClnD,KAAK,GAAG,cAAc;EACnCknD,YAAY,CAACh8C,IAAI,GAAG,2CAA2C;EAE/Dg8C,YAAY,CAACpnD,SAAS,CAACqL,SAAS,GAAG,UAAUkP,KAAK,EAAE3O,OAAO,EAAE;IAC/D,IAAIhD,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8b,OAAO,GAAIxe,CAAC,IAAI,IAAI,CAACL,IAAK;IAC9B,IAAG,IAAI,CAACA,IAAI,KAAK,CAAC,EACjB6e,OAAO,GAAG,KAAK;IAChB,IAAIkgC,WAAW,GAAIlgC,OAAO,IAAI,IAAI,CAAC1c,UAAU,CAAC28C,cAAc,IAAM,CAACjgC,OAAO,IAAI,CAAC,IAAI,CAAC1c,UAAU,CAAC28C,cAAe;IAC9G,IAAGz+C,CAAC,IAAI0+C,WAAW,EACZ,IAAI,CAACxlC,WAAW,CAAC,CAAC,EAAEvH,KAAK,EAAE,IAAI,EAAE3O,OAAO,CAAC;IAChD,IAAG,CAAChD,CAAC,IAAI0+C,WAAW,EACb,IAAI,CAACxlC,WAAW,CAAC,CAAC,EAAEvH,KAAK,EAAE,IAAI,EAAE3O,OAAO,CAAC;IAChD,IAAGwb,OAAO,EACH,IAAI,CAACtF,WAAW,CAAC,CAAC,EAAEvH,KAAK,EAAE,IAAI,EAAE3O,OAAO,CAAC;IAChD,IAAI,CAACrD,IAAI,GAAGK,CAAC;EACX,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAE0/C,YAAY,CAAC;;EAE1D;EACA,SAASG,QAAQ,GAAG;IACtB,IAAIv4C,IAAI,GAAG,IAAI;IACT,IAAI,CAAC6L,QAAQ,CAAC,EAAE,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACnC,IAAI,CAAC0W,QAAQ,CAAC,EAAE,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACnC,IAAI,CAAC0W,QAAQ,CAAC,EAAE,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACnC,IAAI,CAACsX,SAAS,CAAC,EAAE,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACnC,IAAI,CAACuX,SAAS,CAAC,EAAE,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACnC,IAAI,CAACuX,SAAS,CAAC,EAAE,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACnC,IAAI,CAACqgB,SAAS,CAAC,QAAQ,EAAC,GAAG,EAAC,IAAI,EAAC,YAAU;MAC1CvV,IAAI,CAAC6L,QAAQ,CAAC,EAAE,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;MACnC6K,IAAI,CAACyM,SAAS,CAAC,EAAE,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACpC,CAAC,CAAC;IACF,IAAI,CAACgI,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAACD,KAAK,GAAG;MAAE6b,UAAU,EAAE,IAAI;MAAE0/B,UAAU,EAAE;IAAM,CAAC;EACxD;EAEAD,QAAQ,CAACrnD,KAAK,GAAG,UAAU;EAC3BqnD,QAAQ,CAACn8C,IAAI,GAAG,qDAAqD;EAErEm8C,QAAQ,CAACvnD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IACrC,OAAO,EAAE;EACb,CAAC;EAEDqnC,QAAQ,CAACvnD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,EAAE;IAC3D,IAAI,IAAI,CAACkH,OAAO,EAAE;MACdlH,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;MACvB,KAAK,IAAIhM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC5T,MAAM,EAAE,EAAEU,CAAC,EAAE;QACtD,IAAIiW,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAClT,CAAC,CAAC;QAC5B;QACA,IAAIgM,OAAO,CAACsW,WAAW;UAAG;UACbtW,OAAO,CAACsW,WAAW,GAAGtW,OAAO,CAACsW,WAAW,GAAG,OAAO,GAAGtiB,CAAC,CAAC,KAEpEgM,OAAO,CAACsW,WAAW,GAAG,IAAI,CAAC1M,EAAE,GAAG,GAAG,IAAIwC,MAAM,GAAGA,MAAM,GAAG,QAAQ,CAAC,GAAC,OAAO,GAACpY,CAAC,GAAC,GAAG,GAACuiB,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAC,IAAI,CAAC;QACpG,IAAI,CAACP,WAAW,CAACliB,CAAC,EAAE2a,KAAK,EAAE,IAAI,EAAE3O,OAAO,CAAC;MAC7C;IACJ;EACJ,CAAC;EAEDnK,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAE6/C,QAAQ,CAAC;;EAGvD;EACA,SAASE,OAAO,GAAG;IACrB,IAAIz4C,IAAI,GAAG,IAAI;IACf,IAAI,CAACtE,UAAU,GAAG;MAAEgO,KAAK,EAAE;IAAE,CAAC;IACxB,IAAI,CAACmC,QAAQ,CAAC,OAAO,EAAE,QAAQ,CAAC;IAChC,IAAI,CAACA,QAAQ,CAAC,MAAM,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACvC,IAAI,CAAC0W,QAAQ,CAAC,OAAO,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACxC,IAAI,CAACsX,SAAS,CAAC,OAAO,EAAE,QAAQ,CAAC;IACjC,IAAI,CAACA,SAAS,CAAC,EAAE,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACnC,IAAI,CAACuX,SAAS,CAAC,EAAE,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACnC,IAAI,CAACuX,SAAS,CAAC,EAAE,EAAEha,SAAS,CAACyC,KAAK,EAAC;MAACmrC,SAAS,EAAC;IAAI,CAAC,CAAC;IACpD,IAAI,CAAC9qB,SAAS,CAAC,QAAQ,EAAC,GAAG,EAAC,IAAI,EAAC,YAAU;MAC1CvV,IAAI,CAACyM,SAAS,CAAC,EAAE,EAAEha,SAAS,CAACyC,KAAK,EAAE;QAACmrC,SAAS,EAAC;MAAI,CAAC,CAAC;IACtD,CAAC,CAAC;IACF,IAAI,CAACnjC,IAAI,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC;IACtB,IAAI,CAACD,KAAK,GAAG;MAAEu7C,UAAU,EAAE;IAAM,CAAC;EACtC;EAEAC,OAAO,CAACvnD,KAAK,GAAG,SAAS;EACzBunD,OAAO,CAACr8C,IAAI,GAAG,kDAAkD;EAEpEq8C,OAAO,CAACznD,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EACjD;IACO,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IACN,IAAIlM,KAAK,GAAG,IAAI,CAAChO,UAAU,CAACgO,KAAK,IAAI,CAAC;IAChCqU,GAAG,CAAC0V,SAAS,GAAG,MAAM;IAC5B,IAAIhjB,CAAC,GAAG,IAAI,CAACvT,IAAI,CAAC,CAAC,CAAC;IACd,IAAIqL,CAAC,GAAG,CAACmB,KAAK,GAAG,CAAC,IAAGjX,SAAS,CAACK,gBAAgB,GAAG,CAAC;IACnDirB,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACqV,MAAM,CAAC3iB,CAAC,GAAG,EAAE,EAAElI,CAAC,CAAC;IACrBwV,GAAG,CAACsV,MAAM,CAAC5iB,CAAC,GAAG,EAAE,EAAElI,CAAC,GAAG9V,SAAS,CAACK,gBAAgB,CAAC;IAClDirB,GAAG,CAACsV,MAAM,CAAC5iB,CAAC,GAAG,EAAE,EAAElI,CAAC,GAAG9V,SAAS,CAACK,gBAAgB,GAAG,GAAG,CAAC;IACxDirB,GAAG,CAACoV,IAAI,EAAE;EACjB,CAAC;EAEDslB,OAAO,CAACznD,SAAS,CAACqL,SAAS,GAAG,YAC9B;IACC,IAAIqN,KAAK,GAAG,IAAI,CAACpN,YAAY,CAAC,CAAC,CAAC;IAChC,IAAGoN,KAAK,IAAI,IAAI,EAChB;MACCA,KAAK,GAAGyJ,IAAI,CAACC,KAAK,CAAC1J,KAAK,CAAC;MACzBA,KAAK,GAAGyJ,IAAI,CAAC+pB,KAAK,CAAExzB,KAAK,EAAE,CAAC,EAAE,IAAI,CAAC5F,OAAO,GAAI,IAAI,CAACA,OAAO,CAAC5T,MAAM,GAAG,CAAC,GAAI,CAAC,CAAE;MAC5E,IAAIwZ,KAAK,IAAI,IAAI,CAAChO,UAAU,CAACgO,KAAK,EAClC;QACC,IAAI,CAAChO,UAAU,CAACgO,KAAK,GAAGA,KAAK;QAC1B,IAAI,CAACoJ,WAAW,CAAEpJ,KAAK,GAAC,CAAC,CAAE;MAC/B;IACD;IAEA,IAAI,CAAClN,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAACgO,KAAK,CAAE;EAC9C,CAAC;EAEE+uC,OAAO,CAACznD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE;IACvD,IAAGvC,MAAM,IAAI,OAAO,EACnB,IAAI,CAACtN,UAAU,CAACgO,KAAK,GAAG,CAAC,CAAC,KACtB,IAAGV,MAAM,IAAI,MAAM,EACxB;MACU,IAAI,CAAC8J,WAAW,CAAC,IAAI,CAACpX,UAAU,CAACgO,KAAK,GAAC,CAAC,EAAE6B,KAAK,CAAC;MACzD,IAAIV,CAAC,GAAG,IAAI,CAAC/G,OAAO,GAAG,IAAI,CAACA,OAAO,CAAC5T,MAAM,GAAG,CAAC,GAAG,CAAC;MAClD,IAAI,CAACwL,UAAU,CAACgO,KAAK,GAAG,CAAC,IAAI,CAAChO,UAAU,CAACgO,KAAK,GAAG,CAAC,IAAImB,CAAC;IAClD;EACJ,CAAC;EAEDpY,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAE+/C,OAAO,CAAC;;EAErD;EACA,SAASC,WAAW,GAAG;IACnB,IAAI,CAACx7C,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC2O,QAAQ,CAAC,OAAO,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACxC,IAAI,CAACsX,SAAS,CAAC,OAAO,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACxC,IAAI,CAACwG,UAAU,GAAG;MACdi9C,QAAQ,EAAE,EAAE;MACZC,YAAY,EAAE,EAAE;MAChBC,iBAAiB,EAAE;IACvB,CAAC;EACL;EAEAH,WAAW,CAACxnD,KAAK,GAAG,cAAc;EAClCwnD,WAAW,CAACt8C,IAAI,GAAG,4CAA4C;EAE/Ds8C,WAAW,CAAC1nD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,EAAE;IAC9D,IAAI2O,KAAK,IAAI,IAAI,EAAE;MACf;IACJ;IAEA,IAAI,IAAI,CAAC7P,UAAU,CAACi9C,QAAQ,IAAI,IAAI,CAACj9C,UAAU,CAACi9C,QAAQ,IAAIptC,KAAK,EAAE;MAC/D;IACJ;IAEA,IAAI,IAAI,CAAC7P,UAAU,CAACk9C,YAAY,EAAE;MAC9B,IAAIE,IAAI,GAAGvtC,KAAK,CAAC,IAAI,CAAC7P,UAAU,CAACk9C,YAAY,CAAC;MAC9C,IAAIE,IAAI,IAAI,IAAI,EAAE;QACd;MACJ;MAEA,IACI,IAAI,CAACp9C,UAAU,CAACm9C,iBAAiB,IACjC,IAAI,CAACn9C,UAAU,CAACm9C,iBAAiB,IAAIC,IAAI,EAC3C;QACE;MACJ;IACJ;IAEA,IAAI,CAAChmC,WAAW,CAAC,CAAC,EAAEvH,KAAK,EAAE,IAAI,EAAE3O,OAAO,CAAC;EAC7C,CAAC;EAEDnK,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAEggD,WAAW,CAAC;EAGxD,SAASK,WAAW,GAAG;IACnB,IAAI,CAACltC,QAAQ,CAAC,IAAI,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACrC,IAAI,CAAC0W,QAAQ,CAAC,MAAM,EAAE,SAAS,CAAC;IAChC,IAAI,CAACY,SAAS,CAAC,MAAM,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACvC,IAAI,CAACuX,SAAS,CAAC,OAAO,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACxC,IAAI,CAACgI,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;IAC3B,IAAI,CAAC63C,MAAM,GAAG,KAAK;EACjB;EAEAgE,WAAW,CAAC7nD,KAAK,GAAG,QAAQ;EAC5B6nD,WAAW,CAAC38C,IAAI,GAAG,8DAA8D;EAEjF28C,WAAW,CAAC/nD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC/C,IAAI,CAAC04C,MAAM,GAAG,IAAI,CAACz4C,YAAY,CAAC,CAAC,CAAC;EACnC,CAAC;EAEEy8C,WAAW,CAAC/nD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,EAAE;IAC9D,IAAI,CAACm4C,MAAM,GAAG,IAAI,CAACz4C,YAAY,CAAC,CAAC,CAAC;IACxC,IAAI,CAACwW,WAAW,CAAC,IAAI,CAACiiC,MAAM,GAAG,CAAC,GAAG,CAAC,EAAExpC,KAAK,EAAE,IAAI,EAAE3O,OAAO,CAAC;EAC5D,CAAC;EAEEnK,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAEqgD,WAAW,CAAC;;EAExD;EACA,SAASC,YAAY,GAAG;IACpB,IAAI,CAACntC,QAAQ,CAAC,KAAK,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACtC,IAAI,CAAC0W,QAAQ,CAAC,KAAK,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACtC,IAAI,CAAC0W,QAAQ,CAAC,OAAO,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACxC,IAAI,CAACsX,SAAS,CAAC,QAAQ,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACzC,IAAI,CAACuX,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAACqH,WAAW,CAAC,kBAAkB,EAAE,KAAK,EAAE,SAAS,EAAE;MAAC5hB,IAAI,EAAE;IAAkB,CAAC,CAAC;IAClF,IAAI,CAACqjB,SAAS,CAAC,QAAQ,EAAC,aAAa,EAAC,IAAI,CAAC7Z,UAAU,CAACu9C,gBAAgB,EAAC,kBAAkB,CAAC;IAC1F,IAAI,CAAC5zC,GAAG,GAAG,CAAC;EAChB;EAEA2zC,YAAY,CAAC9nD,KAAK,GAAG,SAAS;EAC9B8nD,YAAY,CAAC58C,IAAI,GAAG,eAAe;EAEnC48C,YAAY,CAAChoD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IACzC,IAAI,IAAI,CAACjU,KAAK,CAAC2Y,SAAS,EAAE;MACtB,OAAOtb,MAAM,CAAC,IAAI,CAAC+K,GAAG,CAAC;IAC3B;IACA,OAAO,IAAI,CAACnU,KAAK;EACrB,CAAC;EAED8nD,YAAY,CAAChoD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,EAAE;IAC/D,IAAIhD,CAAC,GAAG,IAAI,CAACyL,GAAG;IAChB,IAAI2D,MAAM,IAAI,KAAK,EAAE;MACjB,IAAI,CAAC3D,GAAG,IAAI,CAAC;IACjB,CAAC,MAAM,IAAI2D,MAAM,IAAI,KAAK,EAAE;MACxB,IAAI,CAAC3D,GAAG,IAAI,CAAC;IACjB,CAAC,MAAM,IAAI2D,MAAM,IAAI,OAAO,EAAE;MAC1B,IAAI,CAAC3D,GAAG,GAAG,CAAC;IAChB;IACA,IAAI,IAAI,CAACA,GAAG,IAAIzL,CAAC,EAAE;MACf,IAAI,CAAC+R,OAAO,CAAC,QAAQ,EAAE,IAAI,CAACtG,GAAG,CAAC;IACpC;EACJ,CAAC;EAED2zC,YAAY,CAAChoD,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACpD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IACAmI,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACtD,IAAI,GAAG,YAAY;IACvBsD,GAAG,CAACsW,SAAS,GAAG,QAAQ;IACxBtW,GAAG,CAACuW,QAAQ,CAAC,IAAI,CAACjvB,GAAG,EAAE,IAAI,CAACnI,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;EAClE,CAAC;EAED87C,YAAY,CAAChoD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1C,IAAG,IAAI,CAACX,UAAU,CAACu9C,gBAAgB,EAAC;MAChC,IAAI,CAAC5zC,GAAG,IAAI,CAAC;IACjB;IACA,IAAI,CAAC7I,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC6I,GAAG,CAAC;EACnC,CAAC;EAED5S,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAEsgD,YAAY,CAAC;;EAE1D;EACA,SAASE,UAAU,GAAG;IAClB,IAAI,CAACh8C,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC4W,WAAW,CAAC,YAAY,EAAE,IAAI,CAAC;IACpC,IAAI,CAACjI,QAAQ,CAAC,OAAO,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACxC,IAAI,CAACsX,SAAS,CAAC,SAAS,EAAEha,SAAS,CAACyC,KAAK,CAAC;IAE1C,IAAI,CAACikD,QAAQ,GAAG,EAAE;EACtB;EAEAD,UAAU,CAAChoD,KAAK,GAAG,OAAO;EAC1BgoD,UAAU,CAAC98C,IAAI,GAAG,kBAAkB;EAEpC88C,UAAU,CAACloD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,EAAE;IAC7D,IAAIw8C,IAAI,GAAG,IAAI,CAAC19C,UAAU,CAAC29C,UAAU;IACrC,IAAID,IAAI,IAAI,CAAC,EAAE;MACX,IAAI,CAACztC,OAAO,CAAC,IAAI,EAAEJ,KAAK,EAAE3O,OAAO,CAAC;IACtC,CAAC,MAAM;MACH,IAAI,CAACu8C,QAAQ,CAACtoD,IAAI,CAAC,CAACuoD,IAAI,EAAE7tC,KAAK,CAAC,CAAC;IACrC;EACJ,CAAC;EAED2tC,UAAU,CAACloD,SAAS,CAACqL,SAAS,GAAG,UAASkP,KAAK,EAAE3O,OAAO,EAAE;IACtD,IAAI08C,EAAE,GAAG,IAAI,CAACl1C,KAAK,CAACd,YAAY,GAAG,IAAI,CAAC,CAAC;;IAEzC,IAAI,IAAI,CAACuO,gBAAgB,CAAC,CAAC,CAAC,EAAE;MAC1B,IAAI,CAACnW,UAAU,CAAC29C,UAAU,GAAG,IAAI,CAAC/8C,YAAY,CAAC,CAAC,CAAC;IACrD;IAEA,KAAK,IAAI1L,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACuoD,QAAQ,CAACjpD,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC3C,IAAI2oD,UAAU,GAAG,IAAI,CAACJ,QAAQ,CAACvoD,CAAC,CAAC;MACjC2oD,UAAU,CAAC,CAAC,CAAC,IAAID,EAAE;MACnB,IAAIC,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;QACnB;MACJ;;MAEA;MACA,IAAI,CAACJ,QAAQ,CAAC70C,MAAM,CAAC1T,CAAC,EAAE,CAAC,CAAC;MAC1B,EAAEA,CAAC;;MAEH;MACA,IAAI,CAAC+a,OAAO,CAAC,IAAI,EAAE4tC,UAAU,CAAC,CAAC,CAAC,EAAE38C,OAAO,CAAC;IAC9C;EACJ,CAAC;EAEDs8C,UAAU,CAACloD,SAAS,CAACovC,WAAW,GAAG,YAAW;IAC1C,OAAO,CAAC,CAAC,OAAO,EAAE3tC,SAAS,CAAC0C,MAAM,CAAC,EAAE,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;EAClE,CAAC;EAED1C,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAEwgD,UAAU,CAAC;;EAEtD;EACA,SAASM,UAAU,GAAG;IAClB,IAAI,CAAC1lC,WAAW,CAAC,UAAU,EAAE,IAAI,CAAC;IAClC,IAAI,CAACA,WAAW,CAAC,OAAO,EAAE,MAAM,CAAC;IACjC,IAAI,CAACrH,SAAS,CAAC,SAAS,EAAEha,SAAS,CAACyC,KAAK,CAAC;IAC1C,IAAI,CAACkkD,IAAI,GAAG,CAAC;IACb,IAAI,CAACK,aAAa,GAAG,IAAI;IACzB,IAAI,CAACC,SAAS,GAAG,KAAK;EAC1B;EAEAF,UAAU,CAACtoD,KAAK,GAAG,OAAO;EAC1BsoD,UAAU,CAACp9C,IAAI,GAAG,qCAAqC;EAEvDo9C,UAAU,CAACxoD,SAAS,CAAC2oD,OAAO,GAAG,YAAW;IACtC,IAAI,CAACP,IAAI,GAAG,CAAC;EACjB,CAAC;EAEDI,UAAU,CAACxoD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IACvC,OAAO,SAAS,GAAG,IAAI,CAACuoC,aAAa,CAACxoC,QAAQ,EAAE,GAAG,IAAI;EAC3D,CAAC;EAEDuoC,UAAU,CAACI,QAAQ,GAAG,MAAM;EAC5BJ,UAAU,CAACK,SAAS,GAAG,MAAM;EAE7BL,UAAU,CAACxoD,SAAS,CAAC2wB,gBAAgB,GAAG,YAAW;IAC/C,IAAI,CAAC7Q,QAAQ,GAAG,IAAI,CAAC4oC,SAAS,GACxBF,UAAU,CAACI,QAAQ,GACnBJ,UAAU,CAACK,SAAS;IAC1B,IAAI,CAACH,SAAS,GAAG,KAAK;EAC1B,CAAC;EAEDF,UAAU,CAACxoD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAIi9C,EAAE,GAAG,IAAI,CAACl1C,KAAK,CAACd,YAAY,GAAG,IAAI,CAAC,CAAC;;IAEzC,IAAIqI,OAAO,GAAG,IAAI,CAACytC,IAAI,IAAI,CAAC;IAE5B,IAAI,CAACA,IAAI,IAAIE,EAAE;IACf,IAAI,CAACG,aAAa,GAAGtmC,IAAI,CAACmB,GAAG,CACzB,CAAC,EACD,IAAI,CAACrC,kBAAkB,CAAC,UAAU,CAAC,GAAG,CAAC,CAC1C;IAED,IACI,CAACtG,OAAO,KACP,IAAI,CAACytC,IAAI,GAAG,IAAI,CAACK,aAAa,IAAIK,KAAK,CAAC,IAAI,CAACL,aAAa,CAAC,CAAC,EAC/D;MACE,IAAI,IAAI,CAAC51C,MAAM,IAAI,IAAI,CAACA,MAAM,CAAC3T,MAAM,GAAG,CAAC,IAAI,IAAI,CAAC2T,MAAM,CAAC,CAAC,CAAC,EAAE;QACzD,IAAI,CAACrH,aAAa,CAAC,CAAC,EAAE,KAAK,CAAC;MAChC;MACA;IACJ;IAEA,IAAI,CAACk9C,SAAS,GAAG,IAAI;IACrB,IAAI,CAACN,IAAI,GAAG,IAAI,CAACA,IAAI,GAAG,IAAI,CAACK,aAAa;IAC1C,IAAI,CAAC9tC,OAAO,CAAC,SAAS,EAAE,IAAI,CAACjQ,UAAU,CAAC0T,KAAK,CAAC;IAC9C,IAAI,IAAI,CAACvL,MAAM,IAAI,IAAI,CAACA,MAAM,CAAC3T,MAAM,GAAG,CAAC,IAAI,IAAI,CAAC2T,MAAM,CAAC,CAAC,CAAC,EAAE;MACzD,IAAI,CAACrH,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC;IAC/B;EACJ,CAAC;EAEDg9C,UAAU,CAACxoD,SAAS,CAACovC,WAAW,GAAG,YAAW;IAC1C,OAAO,CAAC,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;EACnC,CAAC;EAEDoZ,UAAU,CAACxoD,SAAS,CAAC2vC,YAAY,GAAG,YAAW;IAC3C,OAAO,CAAC,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;EAChC,CAAC;EAEDluC,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAE8gD,UAAU,CAAC;EAItD,SAASO,cAAc,GAAG;IACtB,IAAI,CAACluC,QAAQ,CAAC,IAAI,EAAEpZ,SAAS,CAAC0C,MAAM,CAAE;IACtC,IAAI,CAAC0W,QAAQ,CAAC,OAAO,EAAEpZ,SAAS,CAAC0C,MAAM,CAAE;IACzC,IAAI,CAAC0W,QAAQ,CAAC,KAAK,EAAEpZ,SAAS,CAAC0C,MAAM,CAAE;IACvC,IAAI,CAACsX,SAAS,CAAC,UAAU,EAAEha,SAAS,CAACyC,KAAK,CAAE;IAC5C,IAAI,CAACuX,SAAS,CAAC,SAAS,EAAEha,SAAS,CAACyC,KAAK,CAAE;IAC3C,IAAI,CAACuX,SAAS,CAAC,UAAU,EAAE,SAAS,CAAE;IAC5C,IAAI,CAACutC,MAAM,GAAG,KAAK;IACnB,IAAI,CAACt+C,UAAU,GAAG,CAAC,CAAC;IACpB,IAAIsE,IAAI,GAAG,IAAI;IACf,IAAI,CAACuV,SAAS,CAAC,QAAQ,EAAC,OAAO,EAAC,EAAE,EAAC,YAAU;MAC5CvV,IAAI,CAACg6C,MAAM,GAAG,KAAK;IACpB,CAAC,CAAC;EACA;EAEAD,cAAc,CAAC7oD,KAAK,GAAG,iBAAiB;EACxC6oD,cAAc,CAAC39C,IAAI,GAAG,0DAA0D;EAEnF29C,cAAc,CAAC/oD,SAAS,CAACqL,SAAS,GAAG,YACrC;IACC,IAAI,CAACG,aAAa,CAAC,CAAC,EAAC,IAAI,CAACw9C,MAAM,CAAC;IACjC,IAAI,CAAClpC,QAAQ,GAAG,IAAI,CAACkpC,MAAM,GAAG,MAAM,GAAG,MAAM;EAC9C,CAAC;EAEED,cAAc,CAAC/oD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE;IAC9D,IAAIvC,MAAM,IAAI,IAAI,EACjB,IAAI,CAAC8J,WAAW,CAAE,IAAI,CAACknC,MAAM,GAAG,CAAC,GAAG,CAAC,CAAE,CAAC,KACpC,IAAIhxC,MAAM,IAAI,OAAO,EACzB,IAAI,CAACgxC,MAAM,GAAG,IAAI,CAAC,KACf,IAAIhxC,MAAM,IAAI,KAAK,EACvB,IAAI,CAACgxC,MAAM,GAAG,KAAK;EAClB,CAAC;EAEDvnD,SAAS,CAACiG,gBAAgB,CAAC,kBAAkB,EAAEqhD,cAAc,CAAC;EAI9D,SAASE,SAAS,GAAG;IACjB,IAAI,CAACpuC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC;IACxB,IAAI,CAACA,QAAQ,CAAC,QAAQ,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACzC,IAAI,CAACsX,SAAS,CAAC,MAAM,EAAE,CAAC,CAAC;IAC/B,IAAI,CAACytC,WAAW,GAAG,IAAI;IACvB,IAAI,CAACx+C,UAAU,GAAG;MAAEiE,IAAI,EAAE,IAAI;MAAE0L,SAAS,EAAE;IAAK,CAAC;IACjD,IAAIrL,IAAI,GAAG,IAAI;IACf,IAAI,CAACuV,SAAS,CAAC,QAAQ,EAAC,OAAO,EAAC,EAAE,EAAC,YAAU;MAC5CvV,IAAI,CAACtE,UAAU,CAACiE,IAAI,GAAGK,IAAI,CAACk6C,WAAW;IACxC,CAAC,CAAC;EACA;EAEAD,SAAS,CAAC/oD,KAAK,GAAG,YAAY;EAC9B+oD,SAAS,CAAC79C,IAAI,GAAG,qDAAqD;EAEzE69C,SAAS,CAACjpD,SAAS,CAACqL,SAAS,GAAG,YAChC;IACC,IAAI,CAAC69C,WAAW,GAAG,IAAI,CAAC59C,YAAY,CAAC,CAAC,CAAC;IACvC,IAAI,CAACE,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAACiE,IAAI,CAAE;EAC7C,CAAC;EAEEs6C,SAAS,CAACjpD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE3O,OAAO,EAAE;IAClE,IAAI,CAAClB,UAAU,CAACiE,IAAI,GAAG,IAAI,CAACu6C,WAAW;EACrC,CAAC;EAEJD,SAAS,CAACjpD,SAAS,CAACyd,WAAW,GAAG,UAAS/M,CAAC,EAC5C;IACC,IAAGA,CAAC,CAAC/B,IAAI,IAAI,IAAI,EAChB;IACD,IAAG,IAAI,CAACjE,UAAU,CAAC2P,SAAS,IAAI,KAAK,IAAK3J,CAAC,CAAC/B,IAAI,CAACtF,WAAW,KAAKC,MAAM,IAAIoH,CAAC,CAAC/B,IAAI,CAACtF,WAAW,KAAKwd,MAAM,IAAInW,CAAC,CAAC/B,IAAI,CAACtF,WAAW,KAAK09B,OAAO,IAAIr2B,CAAC,CAAC/B,IAAI,CAACtF,WAAW,KAAK3J,KAAK,IAAIgR,CAAC,CAAC/B,IAAI,CAACtF,WAAW,KAAKb,MAAQ,EAC5MkI,CAAC,CAAC/B,IAAI,GAAG,IAAI;EACf,CAAC;EAEElN,SAAS,CAACiG,gBAAgB,CAAC,kBAAkB,EAAEuhD,SAAS,CAAC;AAI7D,CAAC,EAAE,IAAI,CAAC;;AAER;AACA,CAAC,UAASznD,MAAM,EAAE;EACd,IAAIC,SAAS,GAAGD,MAAM,CAACC,SAAS;;EAEhC;;EAEA,SAAS0nD,YAAY,GAAG;IACpB,IAAI,CAAC1tC,SAAS,CAAC,EAAE,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACnC,IAAI,CAACuX,SAAS,CAAC,EAAE,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACqH,WAAW,CAAC,MAAM,EAAE,UAAU,CAAC;IACpC,IAAI,CAACA,WAAW,CAAC,WAAW,EAAE,EAAE,CAAC;IACjC,IAAI,CAACA,WAAW,CAAC,SAAS,EAAE,EAAE,CAAC;IAC/B,IAAI,CAAC5W,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;IACrB,IAAI,CAACm4B,OAAO,GAAG,KAAK;EACxB;EAEA8kB,YAAY,CAACjpD,KAAK,GAAG,QAAQ;EAC7BipD,YAAY,CAAC/9C,IAAI,GAAG,mBAAmB;EAEvC+9C,YAAY,CAAC1/B,IAAI,GAAG,OAAO;EAC3B0/B,YAAY,CAACnpD,SAAS,CAAC4wB,gBAAgB,GAAG,UAAS7D,GAAG,EAAE;IACpD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IACA,IAAI5N,MAAM,GAAG,EAAE;IACf+V,GAAG,CAAC0V,SAAS,GAAG,OAAO;IACvB1V,GAAG,CAACoY,QAAQ,CACRnuB,MAAM,GAAG,CAAC,EACVA,MAAM,GAAG,CAAC,EACV,IAAI,CAAC9K,IAAI,CAAC,CAAC,CAAC,GAAG8K,MAAM,GAAG,CAAC,EACzB,IAAI,CAAC9K,IAAI,CAAC,CAAC,CAAC,GAAG8K,MAAM,GAAG,CAAC,CAC5B;IACD+V,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACoY,QAAQ,CACRnuB,MAAM,GAAG,CAAC,EACVA,MAAM,GAAG,CAAC,EACV,IAAI,CAAC9K,IAAI,CAAC,CAAC,CAAC,GAAG8K,MAAM,GAAG,CAAC,EACzB,IAAI,CAAC9K,IAAI,CAAC,CAAC,CAAC,GAAG8K,MAAM,GAAG,CAAC,CAC5B;IACD+V,GAAG,CAAC0V,SAAS,GAAG,IAAI,CAAC4B,OAAO,GACtB,OAAO,GACP,IAAI,CAACnJ,SAAS,GACd,MAAM,GACN,MAAM;IACZnO,GAAG,CAACoY,QAAQ,CACRnuB,MAAM,EACNA,MAAM,EACN,IAAI,CAAC9K,IAAI,CAAC,CAAC,CAAC,GAAG8K,MAAM,GAAG,CAAC,EACzB,IAAI,CAAC9K,IAAI,CAAC,CAAC,CAAC,GAAG8K,MAAM,GAAG,CAAC,CAC5B;IAED,IAAI,IAAI,CAACtM,UAAU,CAAC4E,IAAI,IAAI,IAAI,CAAC5E,UAAU,CAAC4E,IAAI,KAAK,CAAC,EAAE;MACpD,IAAIiU,SAAS,GAAG,IAAI,CAAC7Y,UAAU,CAAC6Y,SAAS,IAAI,EAAE;MAC/CwJ,GAAG,CAACsW,SAAS,GAAG,QAAQ;MACxBtW,GAAG,CAAC0V,SAAS,GAAG,IAAI,CAAC4B,OAAO,GAAG,OAAO,GAAG,OAAO;MAChDtX,GAAG,CAACtD,IAAI,GAAGlG,SAAS,GAAG,KAAK,GAAG4lC,YAAY,CAAC1/B,IAAI;MAChDsD,GAAG,CAACuW,QAAQ,CACR,IAAI,CAAC54B,UAAU,CAAC4E,IAAI,EACpB,IAAI,CAACpD,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EAClB,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGqX,SAAS,GAAG,GAAG,CACvC;MACDwJ,GAAG,CAACsW,SAAS,GAAG,MAAM;IAC1B;EACJ,CAAC;EAED8lB,YAAY,CAACnpD,SAAS,CAACo5B,WAAW,GAAG,UAAS96B,CAAC,EAAE8qD,SAAS,EAAE;IACxD,IACIA,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,IAChBA,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,IAChBA,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAACl9C,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAC/Bk9C,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAACl9C,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EACjC;MACE,IAAI,CAACm4B,OAAO,GAAG,IAAI;MACnB,IAAI,CAAC74B,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC64B,OAAO,CAAC;MACnC,IAAI,CAACviB,WAAW,CAAC,CAAC,EAAE,IAAI,CAACpX,UAAU,CAAC2+C,OAAO,CAAC;MAC5C,OAAO,IAAI;IACf;EACJ,CAAC;EAEDF,YAAY,CAACnpD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1C,IAAI,CAACG,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC64B,OAAO,CAAC;EACvC,CAAC;EAED8kB,YAAY,CAACnpD,SAAS,CAAC+8B,SAAS,GAAG,UAASz+B,CAAC,EAAE;IAC3C,IAAI,CAAC+lC,OAAO,GAAG,KAAK;EACxB,CAAC;EAED5iC,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAEyhD,YAAY,CAAC;EAEzD,SAASG,YAAY,GAAG;IACpB,IAAI,CAACzuC,QAAQ,CAAC,EAAE,EAAE,SAAS,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACpC,IAAI,CAACsX,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC;IAC9B,IAAI,CAACA,SAAS,CAAC,GAAG,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACpC,IAAI,CAACwG,UAAU,GAAG;MAAE+e,IAAI,EAAE,EAAE;MAAE3O,KAAK,EAAE;IAAM,CAAC;IAC5C,IAAI,CAAC5O,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EACzB;EAEAo9C,YAAY,CAACppD,KAAK,GAAG,QAAQ;EAC7BopD,YAAY,CAACl+C,IAAI,GAAG,+BAA+B;EAEnDk+C,YAAY,CAACtpD,SAAS,CAAC4wB,gBAAgB,GAAG,UAAS7D,GAAG,EAAE;IACpD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IAEA,IAAI1Y,IAAI,GAAG,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG;IAC7B,IAAI8K,MAAM,GAAG,IAAI;IACjB,IAAImlB,CAAC,GAAG,IAAI,CAACjwB,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG;IAC1B6gB,GAAG,CAACtD,IAAI,GAAG,IAAI,CAAC/e,UAAU,CAAC+e,IAAI,IAAI,CAACvd,IAAI,GAAG,GAAG,EAAEu4B,OAAO,CAAC,CAAC,CAAC,GAAG,UAAU;IACvE,IAAIhlB,CAAC,GAAGsN,GAAG,CAAC+W,WAAW,CAAC,IAAI,CAAC5jC,KAAK,CAAC,CAAC8qB,KAAK;IACzC,IAAI5T,CAAC,GAAG,CAAC,IAAI,CAAClL,IAAI,CAAC,CAAC,CAAC,IAAIuT,CAAC,GAAGvT,IAAI,CAAC,IAAI,GAAG;IAEzC6gB,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACoY,QAAQ,CAAC/tB,CAAC,EAAE+kB,CAAC,GAAGjwB,IAAI,EAAEA,IAAI,EAAEA,IAAI,CAAC;IAErC6gB,GAAG,CAAC0V,SAAS,GAAG,IAAI,CAAC/3B,UAAU,CAACoQ,KAAK,GAAG,MAAM,GAAG,MAAM;IACvDiS,GAAG,CAACoY,QAAQ,CACR/tB,CAAC,GAAGlL,IAAI,GAAG8K,MAAM,EACjBmlB,CAAC,GAAGjwB,IAAI,GAAGA,IAAI,GAAG8K,MAAM,EACxB9K,IAAI,IAAI,CAAC,GAAG8K,MAAM,GAAG,CAAC,CAAC,EACvB9K,IAAI,IAAI,CAAC,GAAG8K,MAAM,GAAG,CAAC,CAAC,CAC1B;IAED+V,GAAG,CAACsW,SAAS,GAAG,MAAM;IACtBtW,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACuW,QAAQ,CAAC,IAAI,CAACpjC,KAAK,EAAEgM,IAAI,GAAG,GAAG,GAAGkL,CAAC,EAAE+kB,CAAC,GAAG,IAAI,CAAC;IAClDpP,GAAG,CAACsW,SAAS,GAAG,MAAM;EAC1B,CAAC;EAEDimB,YAAY,CAACtpD,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAE;IAC/C,IAAI,CAACtN,UAAU,CAACoQ,KAAK,GAAG,CAAC,IAAI,CAACpQ,UAAU,CAACoQ,KAAK;IAC9C,IAAI,CAACH,OAAO,CAAC,GAAG,EAAE,IAAI,CAACjQ,UAAU,CAACoQ,KAAK,CAAC;EAC5C,CAAC;EAEDwuC,YAAY,CAACtpD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1C,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX,IAAI,CAAC8B,UAAU,CAACoQ,KAAK,GAAGlS,CAAC;IAC7B;IACA,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAACoQ,KAAK,CAAC;EAChD,CAAC;EAEDwuC,YAAY,CAACtpD,SAAS,CAACo5B,WAAW,GAAG,UAAS96B,CAAC,EAAE8qD,SAAS,EAAE;IACxD,IACIA,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,IAChBA,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,IAChBA,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAACl9C,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAC/Bk9C,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAACl9C,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EACjC;MACE,IAAI,CAACxB,UAAU,CAACoQ,KAAK,GAAG,CAAC,IAAI,CAACpQ,UAAU,CAACoQ,KAAK;MAC9C,IAAI,CAAC1H,KAAK,CAAC9B,QAAQ,EAAE;MACrB,IAAI,CAACqJ,OAAO,CAAC,GAAG,EAAE,IAAI,CAACjQ,UAAU,CAACoQ,KAAK,CAAC;MACxC,OAAO,IAAI;IACf;EACJ,CAAC;EAEDrZ,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAE4hD,YAAY,CAAC;;EAEzD;;EAEA,SAASC,YAAY,GAAG;IACpB,IAAI,CAAC9tC,SAAS,CAAC,EAAE,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAACxB,UAAU,GAAG;MAAEq7B,GAAG,EAAE,CAAC,IAAI;MAAEziB,GAAG,EAAE,IAAI;MAAExI,KAAK,EAAE,CAAC;MAAEsxB,IAAI,EAAE;IAAE,CAAC;IAC9D,IAAI,CAACod,KAAK,GAAG,CAAC,CAAC;IACf,IAAI,CAACC,UAAU,GAAG,CAAC;IACnB,IAAI,CAACC,UAAU,GAAG,CAAC;IACnB,IAAI,CAACC,cAAc,GAAG,KAAK;EAC/B;EAEAJ,YAAY,CAACrpD,KAAK,GAAG,QAAQ;EAC7BqpD,YAAY,CAACn+C,IAAI,GAAG,+BAA+B;EAEnDm+C,YAAY,CAACK,gBAAgB,GAAG,EAAE;EAClCL,YAAY,CAACM,aAAa,GAAG,MAAM;EAEnCN,YAAY,CAACvpD,SAAS,CAAC4wB,gBAAgB,GAAG,UAAS7D,GAAG,EAAE;IACpD,IAAI3V,CAAC,GAAG,IAAI,CAAClL,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG;IAC1B,IAAIiwB,CAAC,GAAG,IAAI,CAACjwB,IAAI,CAAC,CAAC,CAAC;IACpB,IAAIiwB,CAAC,GAAG,EAAE,EAAE;MACRpP,GAAG,CAAC0V,SAAS,GAAG8mB,YAAY,CAACM,aAAa;MAC1C98B,GAAG,CAACoU,SAAS,EAAE;MACfpU,GAAG,CAACqV,MAAM,CAAChrB,CAAC,EAAE+kB,CAAC,GAAG,GAAG,CAAC;MACtBpP,GAAG,CAACsV,MAAM,CAACjrB,CAAC,GAAG+kB,CAAC,GAAG,GAAG,EAAEA,CAAC,GAAG,GAAG,CAAC;MAChCpP,GAAG,CAACsV,MAAM,CAACjrB,CAAC,GAAG+kB,CAAC,GAAG,CAAC,GAAG,EAAEA,CAAC,GAAG,GAAG,CAAC;MACjCpP,GAAG,CAACoV,IAAI,EAAE;MACVpV,GAAG,CAACoU,SAAS,EAAE;MACfpU,GAAG,CAACqV,MAAM,CAAChrB,CAAC,EAAE+kB,CAAC,GAAG,GAAG,CAAC;MACtBpP,GAAG,CAACsV,MAAM,CAACjrB,CAAC,GAAG+kB,CAAC,GAAG,GAAG,EAAEA,CAAC,GAAG,GAAG,CAAC;MAChCpP,GAAG,CAACsV,MAAM,CAACjrB,CAAC,GAAG+kB,CAAC,GAAG,CAAC,GAAG,EAAEA,CAAC,GAAG,GAAG,CAAC;MACjCpP,GAAG,CAACoV,IAAI,EAAE;MACVpV,GAAG,CAACtD,IAAI,GAAG,CAAC0S,CAAC,GAAG,GAAG,EAAEsI,OAAO,CAAC,CAAC,CAAC,GAAG,UAAU;IAChD,CAAC,MAAM;MACH1X,GAAG,CAACtD,IAAI,GAAG,CAAC0S,CAAC,GAAG,GAAG,EAAEsI,OAAO,CAAC,CAAC,CAAC,GAAG,UAAU;IAChD;IAEA1X,GAAG,CAACsW,SAAS,GAAG,QAAQ;IACxBtW,GAAG,CAACtD,IAAI,GAAG,CAAC0S,CAAC,GAAG,GAAG,EAAEsI,OAAO,CAAC,CAAC,CAAC,GAAG,UAAU;IAC5C1X,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACuW,QAAQ,CACR,IAAI,CAAC54B,UAAU,CAACoQ,KAAK,CAAC2pB,OAAO,CAAC,IAAI,CAACilB,UAAU,CAAC,EAC9CtyC,CAAC,EACD+kB,CAAC,GAAG,IAAI,CACX;EACL,CAAC;EAEDotB,YAAY,CAACvpD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1C,IAAI,CAACG,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAACoQ,KAAK,CAAC;EAChD,CAAC;EAEDyuC,YAAY,CAACvpD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC7D,IAAIvK,CAAC,GAAG,CAAC,IAAI,CAAC7F,UAAU,CAAC0hC,IAAI,GAAG,EAAE,EAAEpkC,KAAK,CAAC,GAAG,CAAC;IAC9C,IAAI,CAAC0hD,UAAU,GAAGn5C,CAAC,CAACrR,MAAM,GAAG,CAAC,GAAGqR,CAAC,CAAC,CAAC,CAAC,CAACrR,MAAM,GAAG,CAAC;EACpD,CAAC;EAEDqqD,YAAY,CAACvpD,SAAS,CAACo5B,WAAW,GAAG,UAAS96B,CAAC,EAAE4J,GAAG,EAAE;IAClD,IAAIA,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;MACZ;IACJ;IAEA,IAAI,CAACshD,KAAK,GAAGlrD,CAAC,CAAC24B,OAAO;IACtB,IAAI,CAACzO,YAAY,CAAC,IAAI,CAAC;IACvB,IAAI,CAACmhC,cAAc,GAAG,IAAI;IAE1B,OAAO,IAAI;EACf,CAAC;EAEDJ,YAAY,CAACvpD,SAAS,CAACs7B,WAAW,GAAG,UAASh9B,CAAC,EAAE;IAC7C,IAAI,CAAC,IAAI,CAACqrD,cAAc,EAAE;MACtB;IACJ;IAEA,IAAIl9B,KAAK,GAAG,IAAI,CAAC+8B,KAAK,GAAGlrD,CAAC,CAAC24B,OAAO;IAClC,IAAI34B,CAAC,CAACq6B,QAAQ,EAAE;MACZlM,KAAK,IAAI,EAAE;IACf;IACA,IAAInuB,CAAC,CAACs8B,OAAO,IAAIt8B,CAAC,CAACs5B,MAAM,EAAE;MACvBnL,KAAK,IAAI,GAAG;IAChB;IACA,IAAI,CAAC+8B,KAAK,GAAGlrD,CAAC,CAAC24B,OAAO;IAEtB,IAAI6yB,KAAK,GAAG,IAAI,CAACL,UAAU,GAAGh9B,KAAK,GAAG88B,YAAY,CAACK,gBAAgB;IACnE,IAAI,CAACH,UAAU,GAAGK,KAAK,GAAG,CAAC;IAC3BA,KAAK,GAAGA,KAAK,GAAG,CAAC;IAEjB,IAAIlhD,CAAC,GAAGuZ,IAAI,CAAC+pB,KAAK,CACd,IAAI,CAACxhC,UAAU,CAACoQ,KAAK,GAAGgvC,KAAK,GAAG,IAAI,CAACp/C,UAAU,CAAC0hC,IAAI,EACpD,IAAI,CAAC1hC,UAAU,CAACq7B,GAAG,EACnB,IAAI,CAACr7B,UAAU,CAAC4Y,GAAG,CACtB;IACD,IAAI,CAAC5Y,UAAU,CAACoQ,KAAK,GAAGlS,CAAC;IACzB,IAAI,CAACwK,KAAK,CAAC9B,QAAQ,EAAE;IACrB,IAAI,CAACoG,cAAc,CAAC,IAAI,CAAC;EAC7B,CAAC;EAED6xC,YAAY,CAACvpD,SAAS,CAAC+8B,SAAS,GAAG,UAASz+B,CAAC,EAAE4J,GAAG,EAAE;IAChD,IAAI5J,CAAC,CAAC09B,UAAU,GAAG,GAAG,EAAE;MACpB,IAAI8tB,KAAK,GAAG5hD,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACgE,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC;MAChD,IAAI,CAACxB,UAAU,CAACoQ,KAAK,GAAGqH,IAAI,CAAC+pB,KAAK,CAC9B,IAAI,CAACxhC,UAAU,CAACoQ,KAAK,GAAGgvC,KAAK,GAAG,IAAI,CAACp/C,UAAU,CAAC0hC,IAAI,EACpD,IAAI,CAAC1hC,UAAU,CAACq7B,GAAG,EACnB,IAAI,CAACr7B,UAAU,CAAC4Y,GAAG,CACtB;MACD,IAAI,CAAClQ,KAAK,CAAC9B,QAAQ,EAAE;MACrB,IAAI,CAACoG,cAAc,CAAC,IAAI,CAAC;IAC7B;IAEA,IAAI,IAAI,CAACiyC,cAAc,EAAE;MACrB,IAAI,CAACA,cAAc,GAAG,KAAK;MAC3B,IAAI,CAACnhC,YAAY,CAAC,KAAK,CAAC;IAC5B;EACJ,CAAC;EAED/mB,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAE6hD,YAAY,CAAC;;EAGzD;;EAEA,SAASQ,WAAW,GAAG;IACnB,IAAI,CAACtuC,SAAS,CAAC,EAAE,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,SAAS,CAAC,QAAQ,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACzC,IAAI,CAACgI,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAACxB,UAAU,GAAG;MAAEoQ,KAAK,EAAE,GAAG;MAAE0J,MAAM,EAAC;IAAQ,CAAC;IAChD,IAAI,CAACglC,KAAK,GAAG,CAAC,CAAC;IACf,IAAI,CAACG,cAAc,GAAG,KAAK;IACjC,IAAI,CAACK,OAAO,GAAG,IAAI,CAACt/C,UAAU,CAAC8Z,MAAM,CAACxc,KAAK,CAAC,GAAG,CAAC;IAChD,IAAIgH,IAAI,GAAG,IAAI;IACT,IAAI,CAACgV,UAAU,GAAG,IAAI;IAC5B,IAAI,CAACM,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,OAAO,EAAC,EAAE,EAAE,IAAI,CAAC7Z,UAAU,CAACoQ,KAAK,EAAE,UAASlS,CAAC,EAAC;MAC1EoG,IAAI,CAACtE,UAAU,CAACoQ,KAAK,GAAGlS,CAAC;MAChBoG,IAAI,CAAC8S,WAAW,CAAC,CAAC,EAAElZ,CAAC,CAAC;IAChC,CAAC,EAAE;MAAE8W,QAAQ,EAAE,OAAO;MAAE8E,MAAM,EAAE,IAAI,CAACwlC;IAAQ,CAAC,CAAE;EAC9C;EAEAD,WAAW,CAAC7pD,KAAK,GAAG,OAAO;EAC3B6pD,WAAW,CAAC3+C,IAAI,GAAG,8BAA8B;EAEjD2+C,WAAW,CAAC/pD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACzC,IAAI,CAACG,aAAa,CAAE,CAAC,EAAE,IAAI,CAACd,UAAU,CAACoQ,KAAK,CAAE;EAClD,CAAC;EAEDivC,WAAW,CAAC/pD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAClE,IAAG5Z,IAAI,IAAI,QAAQ,EACnB;MACC,IAAI,CAAC8oD,OAAO,GAAGlvC,KAAK,CAAC9S,KAAK,CAAC,GAAG,CAAC;MAC/B,IAAI,CAACsc,MAAM,CAAC1Y,OAAO,CAAC4Y,MAAM,GAAG,IAAI,CAACwlC,OAAO;IAC1C,CAAC,MACI,IAAG9oD,IAAI,IAAI,OAAO,EACvB;MACC,IAAI,CAACojB,MAAM,CAACxJ,KAAK,GAAGA,KAAK;IAC1B;EACD,CAAC;EAEErZ,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAEqiD,WAAW,CAAC;;EAGvD;;EAEA,SAASE,UAAU,GAAG;IAClB,IAAI,CAACxuC,SAAS,CAAC,EAAE,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAACxB,UAAU,GAAG;MACdq7B,GAAG,EAAE,CAAC;MACNziB,GAAG,EAAE,CAAC;MACNxI,KAAK,EAAE,GAAG;MACV+D,KAAK,EAAE,MAAM;MACbktB,SAAS,EAAE;IACf,CAAC;IACD,IAAI,CAACjxB,KAAK,GAAG,CAAC,CAAC;EACnB;EAEAmvC,UAAU,CAAC/pD,KAAK,GAAG,MAAM;EACzB+pD,UAAU,CAAC7+C,IAAI,GAAG,qBAAqB;EACvC6+C,UAAU,CAAC/9C,IAAI,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC;EAE3B+9C,UAAU,CAACjqD,SAAS,CAAC4wB,gBAAgB,GAAG,UAAS7D,GAAG,EAAE;IAClD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IAEA,IAAI,IAAI,CAAC9J,KAAK,IAAI,CAAC,CAAC,EAAE;MAClB,IAAI,CAACA,KAAK,GACN,CAAC,IAAI,CAACpQ,UAAU,CAACoQ,KAAK,GAAG,IAAI,CAACpQ,UAAU,CAACq7B,GAAG,KAC3C,IAAI,CAACr7B,UAAU,CAAC4Y,GAAG,GAAG,IAAI,CAAC5Y,UAAU,CAACq7B,GAAG,CAAC;IACnD;IAEA,IAAImkB,QAAQ,GAAG,IAAI,CAACh+C,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG;IACjC,IAAIi+C,QAAQ,GAAG,IAAI,CAACj+C,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG;IACjC,IAAIowC,MAAM,GAAGn6B,IAAI,CAAC4jB,GAAG,CAAC,IAAI,CAAC75B,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,CAAC;IAC3D,IAAIuT,CAAC,GAAG0C,IAAI,CAACC,KAAK,CAACk6B,MAAM,GAAG,IAAI,CAAC;IAEjCvvB,GAAG,CAACoW,WAAW,GAAG,CAAC;IACnBpW,GAAG,CAACmU,IAAI,EAAE;IACVnU,GAAG,CAACC,SAAS,CAACk9B,QAAQ,EAAEC,QAAQ,CAAC;IACjCp9B,GAAG,CAACyd,MAAM,CAACroB,IAAI,CAACqgB,EAAE,GAAG,IAAI,CAAC;;IAE1B;IACAzV,GAAG,CAAC0V,SAAS,GAAG,iBAAiB;IACjC1V,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACqV,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;IAChBrV,GAAG,CAACwV,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE+Z,MAAM,EAAE,CAAC,EAAEn6B,IAAI,CAACqgB,EAAE,GAAG,GAAG,CAAC;IACvCzV,GAAG,CAACoV,IAAI,EAAE;;IAEV;IACApV,GAAG,CAAC2V,WAAW,GAAG,OAAO;IACzB3V,GAAG,CAAC0V,SAAS,GAAG,IAAI,CAAC/3B,UAAU,CAACmU,KAAK;IACrCkO,GAAG,CAAC+U,SAAS,GAAG,CAAC;IACjB/U,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACqV,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;IAChBrV,GAAG,CAACwV,GAAG,CACH,CAAC,EACD,CAAC,EACD+Z,MAAM,GAAG,CAAC,EACV,CAAC,EACDn6B,IAAI,CAACqgB,EAAE,GAAG,GAAG,GAAGrgB,IAAI,CAACmB,GAAG,CAAC,IAAI,EAAE,IAAI,CAACxI,KAAK,CAAC,CAC7C;IACDiS,GAAG,CAACuV,SAAS,EAAE;IACfvV,GAAG,CAACoV,IAAI,EAAE;IACV;IACApV,GAAG,CAAC+U,SAAS,GAAG,CAAC;IACjB/U,GAAG,CAACoW,WAAW,GAAG,CAAC;IACnBpW,GAAG,CAACgU,OAAO,EAAE;;IAEb;IACAhU,GAAG,CAAC0V,SAAS,GAAG,OAAO;IACvB1V,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACwV,GAAG,CAAC2nB,QAAQ,EAAEC,QAAQ,EAAE7N,MAAM,GAAG,IAAI,EAAE,CAAC,EAAEn6B,IAAI,CAACqgB,EAAE,GAAG,CAAC,EAAE,IAAI,CAAC;IAChEzV,GAAG,CAACoV,IAAI,EAAE;;IAEV;IACApV,GAAG,CAAC0V,SAAS,GAAG,IAAI,CAACvH,SAAS,GAAG,OAAO,GAAG,IAAI,CAACxwB,UAAU,CAACmU,KAAK;IAChEkO,GAAG,CAACoU,SAAS,EAAE;IACf,IAAIipB,KAAK,GAAG,IAAI,CAACtvC,KAAK,GAAGqH,IAAI,CAACqgB,EAAE,GAAG,GAAG,GAAGrgB,IAAI,CAACqgB,EAAE,GAAG,IAAI;IACvDzV,GAAG,CAACwV,GAAG,CACH2nB,QAAQ,GAAG/nC,IAAI,CAACkoC,GAAG,CAACD,KAAK,CAAC,GAAG9N,MAAM,GAAG,IAAI,EAC1C6N,QAAQ,GAAGhoC,IAAI,CAACmoC,GAAG,CAACF,KAAK,CAAC,GAAG9N,MAAM,GAAG,IAAI,EAC1CA,MAAM,GAAG,IAAI,EACb,CAAC,EACDn6B,IAAI,CAACqgB,EAAE,GAAG,CAAC,EACX,IAAI,CACP;IACDzV,GAAG,CAACoV,IAAI,EAAE;;IAEV;IACApV,GAAG,CAAC0V,SAAS,GAAG,IAAI,CAACvH,SAAS,GAAG,OAAO,GAAG,MAAM;IACjDnO,GAAG,CAACtD,IAAI,GAAGtH,IAAI,CAACC,KAAK,CAACk6B,MAAM,GAAG,GAAG,CAAC,GAAG,UAAU;IAChDvvB,GAAG,CAACsW,SAAS,GAAG,QAAQ;IACxBtW,GAAG,CAACuW,QAAQ,CACR,IAAI,CAAC54B,UAAU,CAACoQ,KAAK,CAAC2pB,OAAO,CAAC,IAAI,CAAC/5B,UAAU,CAACqhC,SAAS,CAAC,EACxDme,QAAQ,EACRC,QAAQ,GAAG7N,MAAM,GAAG,IAAI,CAC3B;EACL,CAAC;EAED2N,UAAU,CAACjqD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAI,CAACG,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAACoQ,KAAK,CAAC;IAC5C,IAAI,CAACgF,QAAQ,GAAGre,SAAS,CAACs7C,aAAa,CAAC,CACpC,IAAI,CAACjiC,KAAK,EACV,IAAI,CAACA,KAAK,EACV,IAAI,CAACA,KAAK,CACb,CAAC;EACN,CAAC;EAEDmvC,UAAU,CAACjqD,SAAS,CAACo5B,WAAW,GAAG,UAAS96B,CAAC,EAAE;IAC3C,IAAI,CAAC+uB,MAAM,GAAG,CAAC,IAAI,CAACnhB,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC;IAC3D,IAAI,CAACowC,MAAM,GAAG,IAAI,CAACpwC,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG;IAChC,IACI5N,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAAC/uB,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,IAC5BzG,SAAS,CAACi4B,QAAQ,CACd,CAACp7B,CAAC,CAAC04B,OAAO,EAAE14B,CAAC,CAAC24B,OAAO,CAAC,EACtB,CAAC,IAAI,CAAC/uB,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACmlB,MAAM,CAAC,CAAC,CAAC,EAAE,IAAI,CAACnlB,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAACmlB,MAAM,CAAC,CAAC,CAAC,CAAC,CAC/D,GAAG,IAAI,CAACivB,MAAM,EACjB;MACE,OAAO,KAAK;IAChB;IACA,IAAI,CAACiO,QAAQ,GAAG,CAACjsD,CAAC,CAAC04B,OAAO,GAAG,IAAI,CAAC9uB,GAAG,CAAC,CAAC,CAAC,EAAE5J,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAAC/uB,GAAG,CAAC,CAAC,CAAC,CAAC;IAClE,IAAI,CAACsgB,YAAY,CAAC,IAAI,CAAC;IACvB,OAAO,IAAI;EACf,CAAC;EAEDyhC,UAAU,CAACjqD,SAAS,CAACs7B,WAAW,GAAG,UAASh9B,CAAC,EAAE;IAC3C,IAAI,CAAC,IAAI,CAACisD,QAAQ,EAAE;MAChB;IACJ;IAEA,IAAIC,CAAC,GAAG,CAAClsD,CAAC,CAAC04B,OAAO,GAAG,IAAI,CAAC9uB,GAAG,CAAC,CAAC,CAAC,EAAE5J,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAAC/uB,GAAG,CAAC,CAAC,CAAC,CAAC;IAE1D,IAAIU,CAAC,GAAG,IAAI,CAACkS,KAAK;IAClBlS,CAAC,IAAI,CAAC4hD,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAACD,QAAQ,CAAC,CAAC,CAAC,IAAI,IAAI;IACrC,IAAI3hD,CAAC,GAAG,GAAG,EAAE;MACTA,CAAC,GAAG,GAAG;IACX,CAAC,MAAM,IAAIA,CAAC,GAAG,GAAG,EAAE;MAChBA,CAAC,GAAG,GAAG;IACX;IACA,IAAI,CAACkS,KAAK,GAAGlS,CAAC;IACd,IAAI,CAAC8B,UAAU,CAACoQ,KAAK,GACjB,IAAI,CAACpQ,UAAU,CAACq7B,GAAG,GACnB,CAAC,IAAI,CAACr7B,UAAU,CAAC4Y,GAAG,GAAG,IAAI,CAAC5Y,UAAU,CAACq7B,GAAG,IAAI,IAAI,CAACjrB,KAAK;IAC5D,IAAI,CAACyvC,QAAQ,GAAGC,CAAC;IACjB,IAAI,CAAC9yC,cAAc,CAAC,IAAI,CAAC;EAC7B,CAAC;EAEDuyC,UAAU,CAACjqD,SAAS,CAAC+8B,SAAS,GAAG,UAASz+B,CAAC,EAAE;IACzC,IAAI,IAAI,CAACisD,QAAQ,EAAE;MACf,IAAI,CAACA,QAAQ,GAAG,IAAI;MACpB,IAAI,CAAC/hC,YAAY,CAAC,KAAK,CAAC;IAC5B;EACJ,CAAC;EAEDyhC,UAAU,CAACjqD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC3D,IAAI5Z,IAAI,IAAI,KAAK,IAAIA,IAAI,IAAI,KAAK,IAAIA,IAAI,IAAI,OAAO,EAAE;MACnD,IAAI,CAACwJ,UAAU,CAACxJ,IAAI,CAAC,GAAG+iD,UAAU,CAACnpC,KAAK,CAAC;MACzC,OAAO,IAAI,CAAC,CAAC;IACjB;EACJ,CAAC;;EAEDrZ,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAEuiD,UAAU,CAAC;;EAErD;EACA,SAASQ,eAAe,GAAG;IACvB,IAAI,CAAChvC,SAAS,CAAC,EAAE,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAAC/Q,UAAU,GAAG;MACdoQ,KAAK,EAAE,GAAG;MACVirB,GAAG,EAAE,CAAC;MACNziB,GAAG,EAAE,CAAC;MACNhU,IAAI,EAAE;IACV,CAAC;IACD,IAAIN,IAAI,GAAG,IAAI;IACf,IAAI,CAAC9C,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;IACrB,IAAI,CAACw+C,MAAM,GAAG,IAAI,CAACnmC,SAAS,CACxB,QAAQ,EACR,GAAG,EACH,IAAI,CAAC7Z,UAAU,CAACoQ,KAAK,EACrB,UAASlS,CAAC,EAAE;MACRoG,IAAI,CAACtE,UAAU,CAACoQ,KAAK,GAAGlS,CAAC;IAC7B,CAAC,EACD,IAAI,CAAC8B,UAAU,CAClB;IACD,IAAI,CAACsZ,UAAU,GAAG,IAAI;EAC1B;EAEAymC,eAAe,CAACvqD,KAAK,GAAG,cAAc;EAEtCuqD,eAAe,CAACzqD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAChE,IAAI5Z,IAAI,IAAI,OAAO,EAAE;MACjB,IAAI,CAACwpD,MAAM,CAAC5vC,KAAK,GAAGA,KAAK;IAC7B;EACJ,CAAC;EAED2vC,eAAe,CAACzqD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC7C,IAAI,CAACG,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAACoQ,KAAK,CAAC;EAChD,CAAC;EAEDrZ,SAAS,CAACiG,gBAAgB,CAAC,wBAAwB,EAAE+iD,eAAe,CAAC;;EAErE;EACA,SAASE,aAAa,GAAG;IACrB,IAAI,CAACz+C,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;IACrB,IAAI,CAACuP,SAAS,CAAC,EAAE,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAAC/Q,UAAU,GAAG;MAAEmU,KAAK,EAAE,MAAM;MAAEknB,GAAG,EAAE,CAAC;MAAEziB,GAAG,EAAE,CAAC;MAAExI,KAAK,EAAE;IAAI,CAAC;IAC/D,IAAI,CAACA,KAAK,GAAG,CAAC,CAAC;EACnB;EAEA6vC,aAAa,CAACzqD,KAAK,GAAG,UAAU;EAChCyqD,aAAa,CAACv/C,IAAI,GAAG,0BAA0B;EAE/Cu/C,aAAa,CAAC3qD,SAAS,CAAC4wB,gBAAgB,GAAG,UAAS7D,GAAG,EAAE;IACrD,IAAI,IAAI,CAACjS,KAAK,IAAI,CAAC,CAAC,EAAE;MAClB,IAAI,CAACA,KAAK,GACN,CAAC,IAAI,CAACpQ,UAAU,CAACoQ,KAAK,GAAG,IAAI,CAACpQ,UAAU,CAACq7B,GAAG,KAC3C,IAAI,CAACr7B,UAAU,CAAC4Y,GAAG,GAAG,IAAI,CAAC5Y,UAAU,CAACq7B,GAAG,CAAC;IACnD;;IAEA;IACAhZ,GAAG,CAACoW,WAAW,GAAG,CAAC;IACnBpW,GAAG,CAAC+U,SAAS,GAAG,CAAC;IACjB/U,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACoY,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAACj5B,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;IAEtD6gB,GAAG,CAAC0V,SAAS,GAAG,IAAI,CAAC/3B,UAAU,CAACmU,KAAK;IACrCkO,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACzB,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAACpf,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC4O,KAAK,EAAE,IAAI,CAAC5O,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;IACjE6gB,GAAG,CAACoV,IAAI,EAAE;EACd,CAAC;EAEDwoB,aAAa,CAAC3qD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC3C,IAAI,CAACX,UAAU,CAACoQ,KAAK,GACjB,IAAI,CAACpQ,UAAU,CAACq7B,GAAG,GACnB,CAAC,IAAI,CAACr7B,UAAU,CAAC4Y,GAAG,GAAG,IAAI,CAAC5Y,UAAU,CAACq7B,GAAG,IAAI,IAAI,CAACjrB,KAAK;IAC5D,IAAI,CAACtP,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAACoQ,KAAK,CAAC;IAC5C,IAAI,CAACgF,QAAQ,GAAGre,SAAS,CAACs7C,aAAa,CAAC,CACpC,IAAI,CAACjiC,KAAK,EACV,IAAI,CAACA,KAAK,EACV,IAAI,CAACA,KAAK,CACb,CAAC;EACN,CAAC;EAED6vC,aAAa,CAAC3qD,SAAS,CAACo5B,WAAW,GAAG,UAAS96B,CAAC,EAAE;IAC9C,IAAIA,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAAC/uB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;MAC7B,OAAO,KAAK;IAChB;IAEA,IAAI,CAACqiD,QAAQ,GAAG,CAACjsD,CAAC,CAAC04B,OAAO,GAAG,IAAI,CAAC9uB,GAAG,CAAC,CAAC,CAAC,EAAE5J,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAAC/uB,GAAG,CAAC,CAAC,CAAC,CAAC;IAClE,IAAI,CAACsgB,YAAY,CAAC,IAAI,CAAC;IACvB,OAAO,IAAI;EACf,CAAC;EAEDmiC,aAAa,CAAC3qD,SAAS,CAACs7B,WAAW,GAAG,UAASh9B,CAAC,EAAE;IAC9C,IAAI,CAAC,IAAI,CAACisD,QAAQ,EAAE;MAChB;IACJ;IAEA,IAAIC,CAAC,GAAG,CAAClsD,CAAC,CAAC04B,OAAO,GAAG,IAAI,CAAC9uB,GAAG,CAAC,CAAC,CAAC,EAAE5J,CAAC,CAAC24B,OAAO,GAAG,IAAI,CAAC/uB,GAAG,CAAC,CAAC,CAAC,CAAC;IAE1D,IAAIU,CAAC,GAAG,IAAI,CAACkS,KAAK;IAClB,IAAI2R,KAAK,GAAG+9B,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAACD,QAAQ,CAAC,CAAC,CAAC;IACnC3hD,CAAC,IAAI6jB,KAAK,GAAG,IAAI,CAACvgB,IAAI,CAAC,CAAC,CAAC;IACzB,IAAItD,CAAC,GAAG,GAAG,EAAE;MACTA,CAAC,GAAG,GAAG;IACX,CAAC,MAAM,IAAIA,CAAC,GAAG,GAAG,EAAE;MAChBA,CAAC,GAAG,GAAG;IACX;IAEA,IAAI,CAACkS,KAAK,GAAGlS,CAAC;IAEd,IAAI,CAAC2hD,QAAQ,GAAGC,CAAC;IACjB,IAAI,CAAC9yC,cAAc,CAAC,IAAI,CAAC;EAC7B,CAAC;EAEDizC,aAAa,CAAC3qD,SAAS,CAAC+8B,SAAS,GAAG,UAASz+B,CAAC,EAAE;IAC5C,IAAI,CAACisD,QAAQ,GAAG,IAAI;IACpB,IAAI,CAAC/hC,YAAY,CAAC,KAAK,CAAC;EAC5B,CAAC;EAEDmiC,aAAa,CAAC3qD,SAAS,CAACm7B,YAAY,GAAG,UAAS78B,CAAC,EAAE;IAC/C;EAAA,CACH;EAEDmD,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAEijD,aAAa,CAAC;EAE3D,SAASC,cAAc,GAAG;IACtB,IAAI,CAAC1+C,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;IACrB,IAAI,CAAC2O,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC;IAC3B,IAAI,CAACnQ,UAAU,GAAG;MAAEq7B,GAAG,EAAE,CAAC;MAAEziB,GAAG,EAAE,CAAC;MAAExI,KAAK,EAAE,CAAC;MAAE+D,KAAK,EAAE;IAAO,CAAC;EACjE;EAEA+rC,cAAc,CAAC1qD,KAAK,GAAG,UAAU;EACjC0qD,cAAc,CAACx/C,IAAI,GAAG,+BAA+B;EAErDw/C,cAAc,CAAC5qD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAImP,SAAS,EAAE;MAChB,IAAI,CAACrN,UAAU,CAAC,OAAO,CAAC,GAAG9B,CAAC;IAChC;EACJ,CAAC;EAEDgiD,cAAc,CAAC5qD,SAAS,CAAC4wB,gBAAgB,GAAG,UAAS7D,GAAG,EAAE;IACtD;IACAA,GAAG,CAAC+U,SAAS,GAAG,CAAC;IACjB/U,GAAG,CAAC0V,SAAS,GAAG,IAAI,CAAC/3B,UAAU,CAACmU,KAAK;IACrC,IAAIjW,CAAC,GACD,CAAC,IAAI,CAAC8B,UAAU,CAACoQ,KAAK,GAAG,IAAI,CAACpQ,UAAU,CAACq7B,GAAG,KAC3C,IAAI,CAACr7B,UAAU,CAAC4Y,GAAG,GAAG,IAAI,CAAC5Y,UAAU,CAACq7B,GAAG,CAAC;IAC/Cn9B,CAAC,GAAGuZ,IAAI,CAAC4jB,GAAG,CAAC,CAAC,EAAEn9B,CAAC,CAAC;IAClBA,CAAC,GAAGuZ,IAAI,CAACmB,GAAG,CAAC,CAAC,EAAE1a,CAAC,CAAC;IAClBmkB,GAAG,CAACoY,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAACj5B,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAItD,CAAC,EAAE,IAAI,CAACsD,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;EAChE,CAAC;EAEDzK,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAEkjD,cAAc,CAAC;EAE7D,SAASC,UAAU,GAAG;IAClB,IAAI,CAAC3nC,SAAS,CAAC,EAAE,EAAE,CAAC,CAAC;IACrB,IAAI,CAACxY,UAAU,GAAG;MACdoQ,KAAK,EAAE,KAAK;MACZ2O,IAAI,EAAE,OAAO;MACbqhC,QAAQ,EAAE,EAAE;MACZjsC,KAAK,EAAE,MAAM;MACbksC,KAAK,EAAE,MAAM;MACbC,QAAQ,EAAE,CAAC;MACXC,QAAQ,EAAE;IACd,CAAC;EACL;EAEAJ,UAAU,CAAC3qD,KAAK,GAAG,MAAM;EACzB2qD,UAAU,CAACz/C,IAAI,GAAG,uBAAuB;EACzCy/C,UAAU,CAACrrC,OAAO,GAAG,CACjB;IAAEte,IAAI,EAAE,QAAQ;IAAEoO,IAAI,EAAE,YAAY;IAAE3H,IAAI,EAAE;EAAS,CAAC,EACtD;IAAEzG,IAAI,EAAE,UAAU;IAAEoO,IAAI,EAAE,KAAK;IAAE3H,IAAI,EAAE;EAAa,CAAC,EACrD;IAAEzG,IAAI,EAAE,aAAa;IAAEoO,IAAI,EAAE,QAAQ;IAAE3H,IAAI,EAAE;EAAa,CAAC,CAC9D;EAEDkjD,UAAU,CAAC7qD,SAAS,CAAC4wB,gBAAgB,GAAG,UAAS7D,GAAG,EAAE;IAClD;IACA;IACAA,GAAG,CAAC0V,SAAS,GAAG,IAAI,CAAC/3B,UAAU,CAAC,OAAO,CAAC;IACxC,IAAI9B,CAAC,GAAG,IAAI,CAAC8B,UAAU,CAAC,OAAO,CAAC;IAEhC,IAAI,IAAI,CAACA,UAAU,CAAC,UAAU,CAAC,EAAE;MAC7BqiB,GAAG,CAACuY,WAAW,GAAG,IAAI,CAAC56B,UAAU,CAACmU,KAAK;MACvCkO,GAAG,CAACwY,aAAa,GAAG,CAAC;MACrBxY,GAAG,CAACyY,aAAa,GAAG,CAAC;MACrBzY,GAAG,CAAC0Y,UAAU,GAAG,IAAI,CAAC/6B,UAAU,CAAC,UAAU,CAAC;IAChD,CAAC,MAAM;MACHqiB,GAAG,CAACuY,WAAW,GAAG,aAAa;IACnC;IAEA,IAAIwlB,QAAQ,GAAG,IAAI,CAACpgD,UAAU,CAAC,UAAU,CAAC;IAE1CqiB,GAAG,CAACsW,SAAS,GAAG,IAAI,CAAC34B,UAAU,CAAC,OAAO,CAAC;IACxCqiB,GAAG,CAACtD,IAAI,GAAGqhC,QAAQ,CAAC7qC,QAAQ,EAAE,GAAG,KAAK,GAAG,IAAI,CAACvV,UAAU,CAAC,MAAM,CAAC;IAChE,IAAI,CAAC0lC,GAAG,GACJ,OAAOxnC,CAAC,IAAI,QAAQ,GAAGA,CAAC,CAAC67B,OAAO,CAAC,IAAI,CAAC/5B,UAAU,CAAC,UAAU,CAAC,CAAC,GAAG9B,CAAC;IAErE,IAAI,OAAO,IAAI,CAACwnC,GAAG,IAAI,QAAQ,EAAE;MAC7B,IAAI8a,KAAK,GAAG,IAAI,CAAC9a,GAAG,CAAC/B,OAAO,CAAC,SAAS,EAAE,KAAK,CAAC,CAACrmC,KAAK,CAAC,KAAK,CAAC;MAC3D,KAAK,IAAIpI,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAGsrD,KAAK,CAAChsD,MAAM,EAAEU,CAAC,EAAE,EAAE;QACjCmtB,GAAG,CAACuW,QAAQ,CACR4nB,KAAK,CAACtrD,CAAC,CAAC,EACR,IAAI,CAAC8K,UAAU,CAAC,OAAO,CAAC,IAAI,MAAM,GAAG,EAAE,GAAG,IAAI,CAACwB,IAAI,CAAC,CAAC,CAAC,GAAG,EAAE,EAC3D4+C,QAAQ,GAAG,CAAC,IAAI,GAAGA,QAAQ,IAAItM,QAAQ,CAAC5+C,CAAC,CAAC,GAAG,CAAC,CAAC,CAClD;MACL;IACJ;IAEAmtB,GAAG,CAACuY,WAAW,GAAG,aAAa;IAC/B,IAAI,CAAC6lB,QAAQ,GAAGp+B,GAAG;IACnBA,GAAG,CAACsW,SAAS,GAAG,MAAM;EAC1B,CAAC;EAEDwnB,UAAU,CAAC7qD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX,IAAI,CAAC8B,UAAU,CAAC,OAAO,CAAC,GAAG9B,CAAC;IAChC;IACA;EACJ,CAAC;;EAEDiiD,UAAU,CAAC7qD,SAAS,CAACi7B,MAAM,GAAG,YAAW;IACrC,IAAI,CAAC,IAAI,CAACkwB,QAAQ,EAAE;MAChB;IACJ;IAEA,IAAID,KAAK,GAAG,IAAI,CAAC9a,GAAG,CAACpoC,KAAK,CAAC,KAAK,CAAC;IACjC,IAAI,CAACmjD,QAAQ,CAAC1hC,IAAI,GACd,IAAI,CAAC/e,UAAU,CAAC,UAAU,CAAC,GAAG,KAAK,GAAG,IAAI,CAACA,UAAU,CAAC,MAAM,CAAC;IACjE,IAAI4Y,GAAG,GAAG,CAAC;IACX,KAAK,IAAI1jB,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAGsrD,KAAK,CAAChsD,MAAM,EAAEU,CAAC,EAAE,EAAE;MACjC,IAAI6f,CAAC,GAAG,IAAI,CAAC0rC,QAAQ,CAACrnB,WAAW,CAAConB,KAAK,CAACtrD,CAAC,CAAC,CAAC,CAACorB,KAAK;MACjD,IAAI1H,GAAG,GAAG7D,CAAC,EAAE;QACT6D,GAAG,GAAG7D,CAAC;MACX;IACJ;IACA,IAAI,CAACvT,IAAI,CAAC,CAAC,CAAC,GAAGoX,GAAG,GAAG,EAAE;IACvB,IAAI,CAACpX,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAGg/C,KAAK,CAAChsD,MAAM,GAAG,IAAI,CAACwL,UAAU,CAAC,UAAU,CAAC;IAE7D,IAAI,CAACgN,cAAc,CAAC,IAAI,CAAC;EAC7B,CAAC;EAEDmzC,UAAU,CAAC7qD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC3D,IAAI,CAACpQ,UAAU,CAACxJ,IAAI,CAAC,GAAG4Z,KAAK;IAC7B,IAAI,CAACs1B,GAAG,GAAG,OAAOt1B,KAAK,IAAI,QAAQ,GAAGA,KAAK,CAAC2pB,OAAO,CAAC,CAAC,CAAC,GAAG3pB,KAAK;IAC9D;IACA,OAAO,IAAI;EACf,CAAC;EAEDrZ,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAEmjD,UAAU,CAAC;EAErD,SAASO,WAAW,GAAG;IACnB,IAAI,CAACl/C,IAAI,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC;IACtB,IAAI,CAACxB,UAAU,GAAG;MACd2gD,WAAW,EAAE,SAAS;MACtBC,UAAU,EAAE,SAAS;MACrBC,aAAa,EAAE,SAAS;MACxBC,UAAU,EAAE,CAAC;MACbC,YAAY,EAAE;IAClB,CAAC;EACL;EAEAL,WAAW,CAAClrD,KAAK,GAAG,OAAO;EAC3BkrD,WAAW,CAAChgD,IAAI,GAAG,uBAAuB;EAC1CggD,WAAW,CAAC5rC,OAAO,GAAG,CAAC;IAAEte,IAAI,EAAE,QAAQ;IAAEoO,IAAI,EAAE,QAAQ;IAAE3H,IAAI,EAAE;EAAS,CAAC,CAAC;EAE1EyjD,WAAW,CAACprD,SAAS,CAAC0rD,cAAc,GAAG,UAAS3+B,GAAG,EAAE;IACjD,IACI,IAAI,CAACriB,UAAU,CAAC,YAAY,CAAC,IAAI,EAAE,IACnC,IAAI,CAACA,UAAU,CAAC,eAAe,CAAC,IAAI,EAAE,EACxC;MACE,IAAI,CAACihD,cAAc,GAAG,CAAC;MACvB;IACJ;IAEA,IAAI,CAACA,cAAc,GAAG5+B,GAAG,CAAC4a,oBAAoB,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAACz7B,IAAI,CAAC,CAAC,CAAC,CAAC;IACrE,IAAI,CAACy/C,cAAc,CAAC/jB,YAAY,CAAC,CAAC,EAAE,IAAI,CAACl9B,UAAU,CAAC,YAAY,CAAC,CAAC;IAClE,IAAI,CAACihD,cAAc,CAAC/jB,YAAY,CAAC,CAAC,EAAE,IAAI,CAACl9B,UAAU,CAAC,eAAe,CAAC,CAAC;EACzE,CAAC;EAED0gD,WAAW,CAACprD,SAAS,CAAC4wB,gBAAgB,GAAG,UAAS7D,GAAG,EAAE;IACnD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IAEA,IAAI,IAAI,CAAC+mC,cAAc,IAAI,IAAI,EAAE;MAC7B,IAAI,CAACD,cAAc,CAAC3+B,GAAG,CAAC;IAC5B;IAEA,IAAI,CAAC,IAAI,CAAC4+B,cAAc,EAAE;MACtB;IACJ;IAEA5+B,GAAG,CAAC+U,SAAS,GAAG,CAAC;IACjB/U,GAAG,CAAC2V,WAAW,GAAG,IAAI,CAACh4B,UAAU,CAAC,aAAa,CAAC;IAChD;IACAqiB,GAAG,CAAC0V,SAAS,GAAG,IAAI,CAACkpB,cAAc;IAEnC,IAAI,IAAI,CAACjhD,UAAU,CAAC,YAAY,CAAC,EAAE;MAC/BqiB,GAAG,CAACuY,WAAW,GAAG,MAAM;MACxBvY,GAAG,CAACwY,aAAa,GAAG,CAAC;MACrBxY,GAAG,CAACyY,aAAa,GAAG,CAAC;MACrBzY,GAAG,CAAC0Y,UAAU,GAAG,IAAI,CAAC/6B,UAAU,CAAC,YAAY,CAAC;IAClD,CAAC,MAAM;MACHqiB,GAAG,CAACuY,WAAW,GAAG,aAAa;IACnC;IAEAvY,GAAG,CAACqW,SAAS,CACT,CAAC,EACD,CAAC,EACD,IAAI,CAACl3B,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAChB,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EAChB,IAAI,CAACxB,UAAU,CAAC,YAAY,CAAC,CAChC;IACDqiB,GAAG,CAACoV,IAAI,EAAE;IACVpV,GAAG,CAACuY,WAAW,GAAG,aAAa;IAC/BvY,GAAG,CAAC2Z,MAAM,EAAE;EAChB,CAAC;EAEDjlC,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAE0jD,WAAW,CAAC;AAC3D,CAAC,EAAE,IAAI,CAAC;AAER,CAAC,UAAS5pD,MAAM,EAAE;EACd,IAAIC,SAAS,GAAGD,MAAM,CAACC,SAAS;EAEhC,SAASmqD,YAAY,GAAG;IACpB,IAAI,CAACnwC,SAAS,CAAC,aAAa,EAAE,QAAQ,CAAC;IACvC,IAAI,CAACA,SAAS,CAAC,aAAa,EAAE,QAAQ,CAAC;IACvC,IAAI,CAACA,SAAS,CAAC,gBAAgB,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACjD,IAAI,CAACwG,UAAU,GAAG;MAAEmhD,aAAa,EAAE,CAAC;MAAEC,SAAS,EAAE;IAAI,CAAC;IAEtD,IAAI,CAACC,UAAU,GAAG,IAAI7sC,YAAY,CAAC,CAAC,CAAC;IACrC,IAAI,CAAC8sC,WAAW,GAAG,IAAI9sC,YAAY,CAAC,CAAC,CAAC;IACtC,IAAI,CAAC+sC,SAAS,GAAG,IAAI/sC,YAAY,CAAC,CAAC,CAAC;IACpC,IAAI,CAACgtC,iBAAiB,GAAG,IAAIC,UAAU,CAAC,EAAE,CAAC;IAC3C,IAAI,CAACC,gBAAgB,GAAG,IAAID,UAAU,CAAC,EAAE,CAAC;EAC9C;EAEAP,YAAY,CAAC1rD,KAAK,GAAG,SAAS;EAC9B0rD,YAAY,CAACxgD,IAAI,GAAG,+BAA+B;EAEnDwgD,YAAY,CAAC9mD,MAAM,GAAG,CAAC;EACvB8mD,YAAY,CAAChnD,IAAI,GAAG,CAAC;EACrBgnD,YAAY,CAAC/mD,KAAK,GAAG,CAAC;EACtB+mD,YAAY,CAAClnD,EAAE,GAAG,CAAC;EACnBknD,YAAY,CAACjnD,IAAI,GAAG,CAAC;EAErBinD,YAAY,CAACS,IAAI,GAAG,IAAIntC,YAAY,CAAC,CAAC,CAAC;EACvC0sC,YAAY,CAACU,OAAO,GAAG,CACnB,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,MAAM,EACN,OAAO,EACP,IAAI,EACJ,IAAI,EACJ,MAAM,CACT;EAEDV,YAAY,CAAC5rD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1C;IACA,IAAIkhD,OAAO,GAAG,IAAI,CAACC,UAAU,EAAE;IAC/B,IAAIV,SAAS,GAAG,IAAI,CAACphD,UAAU,CAACohD,SAAS,IAAI,GAAG;IAEhD,IAAIS,OAAO,EAAE;MACT,IAAI,CAACR,UAAU,CAAC,CAAC,CAAC,GACd5pC,IAAI,CAACmL,GAAG,CAACi/B,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,GAAGZ,SAAS,GACvCS,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,GACvB,CAAC;MACX,IAAI,CAACX,UAAU,CAAC,CAAC,CAAC,GACd5pC,IAAI,CAACmL,GAAG,CAACi/B,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,GAAGZ,SAAS,GACvCS,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,GACvB,CAAC;MACX,IAAI,CAACV,WAAW,CAAC,CAAC,CAAC,GACf7pC,IAAI,CAACmL,GAAG,CAACi/B,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,GAAGZ,SAAS,GACvCS,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,GACvB,CAAC;MACX,IAAI,CAACV,WAAW,CAAC,CAAC,CAAC,GACf7pC,IAAI,CAACmL,GAAG,CAACi/B,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,GAAGZ,SAAS,GACvCS,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,GACvB,CAAC;MACX,IAAI,CAACT,SAAS,CAAC,CAAC,CAAC,GACb9pC,IAAI,CAACmL,GAAG,CAACi/B,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,UAAU,CAAC,CAAC,GAAGZ,SAAS,GAC7CS,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,UAAU,CAAC,GAC7B,CAAC;MACX,IAAI,CAACT,SAAS,CAAC,CAAC,CAAC,GACb9pC,IAAI,CAACmL,GAAG,CAACi/B,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,UAAU,CAAC,CAAC,GAAGZ,SAAS,GAC7CS,OAAO,CAACE,IAAI,CAACC,IAAI,CAAC,UAAU,CAAC,GAC7B,CAAC;IACf;IAEA,IAAI,IAAI,CAAC55C,OAAO,EAAE;MACd,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC5T,MAAM,EAAEU,CAAC,EAAE,EAAE;QAC1C,IAAIiW,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAClT,CAAC,CAAC;QAC5B,IAAI,CAACiW,MAAM,CAAChE,KAAK,IAAI,CAACgE,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAAE;UACvC;QACJ;QACA,IAAI0J,CAAC,GAAG,IAAI;QAEZ,IAAI2jD,OAAO,EAAE;UACT,QAAQ12C,MAAM,CAAC3U,IAAI;YACf,KAAK,WAAW;cACZ0H,CAAC,GAAG,IAAI,CAACmjD,UAAU;cACnB;YACJ,KAAK,YAAY;cACbnjD,CAAC,GAAG,IAAI,CAACojD,WAAW;cACpB;YACJ,KAAK,aAAa;cACdpjD,CAAC,GAAG,IAAI,CAACmjD,UAAU,CAAC,CAAC,CAAC;cACtB;YACJ,KAAK,aAAa;cACdnjD,CAAC,GAAG,IAAI,CAACmjD,UAAU,CAAC,CAAC,CAAC;cACtB;YACJ,KAAK,cAAc;cACfnjD,CAAC,GAAG,IAAI,CAACojD,WAAW,CAAC,CAAC,CAAC;cACvB;YACJ,KAAK,cAAc;cACfpjD,CAAC,GAAG,IAAI,CAACojD,WAAW,CAAC,CAAC,CAAC;cACvB;YACJ,KAAK,cAAc;cACfpjD,CAAC,GAAG,IAAI,CAACqjD,SAAS,CAAC,CAAC,CAAC;cACrB;YACJ,KAAK,eAAe;cAChBrjD,CAAC,GAAG,IAAI,CAACqjD,SAAS,CAAC,CAAC,CAAC;cACrB;YACJ,KAAK,UAAU;cACXrjD,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACH,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;cACrC;YACJ,KAAK,UAAU;cACX1jD,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACH,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;cACrC;YACJ,KAAK,UAAU;cACX1jD,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACH,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;cACrC;YACJ,KAAK,UAAU;cACX1jD,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACH,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;cACrC;YACJ,KAAK,WAAW;cACZ1jD,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACH,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC;cACtC;YACJ,KAAK,WAAW;cACZ1jD,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACH,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC;cACtC;YACJ,KAAK,WAAW;cACZ1jD,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACH,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC;cACtC;YACJ,KAAK,WAAW;cACZ1jD,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACH,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC;cACtC;YACJ,KAAK,UAAU;cACX1jD,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACE,MAAM,GAAGf,YAAY,CAAChnD,IAAI;cAC3C;YACJ,KAAK,WAAW;cACZgE,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACE,MAAM,GAAGf,YAAY,CAAC/mD,KAAK;cAC5C;YACJ,KAAK,QAAQ;cACT+D,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACE,MAAM,GAAGf,YAAY,CAAClnD,EAAE;cACzC;YACJ,KAAK,UAAU;cACXkE,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACE,MAAM,GAAGf,YAAY,CAACjnD,IAAI;cAC3C;YACJ,KAAK,KAAK;cACNiE,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACE,MAAM;cACvB;YACJ,KAAK,cAAc;cACf/jD,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACH,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC;cACzC;YACJ,KAAK,aAAa;cACd1jD,CAAC,GAAG2jD,OAAO,CAACE,IAAI,CAACH,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC;cACxC;YACJ,KAAK,gBAAgB;cACjB,KACI,IAAI/9C,CAAC,GAAG,CAAC,EACTA,CAAC,GAAG,IAAI,CAAC69C,gBAAgB,CAACltD,MAAM,EAChC,EAAEqP,CAAC,EACL;gBACE,IACI,IAAI,CAAC69C,gBAAgB,CAAC79C,CAAC,CAAC,IACxB,CAAC,IAAI,CAAC29C,iBAAiB,CAAC39C,CAAC,CAAC,EAC5B;kBACE,IAAI,CAACuT,WAAW,CACZliB,CAAC,EACDgsD,YAAY,CAACU,OAAO,CAAC/9C,CAAC,CAAC,CAC1B;gBACL;cACJ;cACA;YACJ;cACI;UAAM;QAElB,CAAC,MAAM;UACH;UACA,QAAQsH,MAAM,CAAC3U,IAAI;YACf,KAAK,gBAAgB;cACjB;YACJ,KAAK,WAAW;YAChB,KAAK,YAAY;cACb0H,CAAC,GAAGgjD,YAAY,CAACS,IAAI;cACrB;YACJ;cACIzjD,CAAC,GAAG,CAAC;UAAC;QAElB;QACA,IAAI,CAAC4C,aAAa,CAAC5L,CAAC,EAAEgJ,CAAC,CAAC;MAC5B;IACJ;EACJ,CAAC;EAEJgjD,YAAY,CAACgB,OAAO,GAAG;IAACngD,CAAC,EAAC,CAAC;IAACC,CAAC,EAAC,CAAC;IAAC0K,CAAC,EAAC,CAAC;IAACG,CAAC,EAAC,CAAC;IAACs1C,EAAE,EAAC,CAAC;IAACC,EAAE,EAAC,CAAC;IAACC,EAAE,EAAC,CAAC;IAACC,EAAE,EAAC,CAAC;IAACC,IAAI,EAAC,CAAC;IAAC15C,KAAK,EAAC,CAAC;IAAC25C,EAAE,EAAC,EAAE;IAACC,EAAE,EAAC;EAAG,CAAC;EACxFvB,YAAY,CAACwB,aAAa,GAAG,CAAC,GAAG,EAAC,GAAG,EAAC,GAAG,EAAC,GAAG,EAAC,IAAI,EAAC,IAAI,EAAC,IAAI,EAAC,IAAI,EAAC,MAAM,EAAC,OAAO,EAAC,IAAI,EAAC,IAAI,CAAC;EAExFxB,YAAY,CAAC5rD,SAAS,CAACwsD,UAAU,GAAG,YAAW;IAC3C,IAAIa,WAAW,GACXC,SAAS,CAACD,WAAW,IACrBC,SAAS,CAACC,iBAAiB,IAC3BD,SAAS,CAACE,cAAc;IAC5B,IAAI,CAACH,WAAW,EAAE;MACd,OAAO,IAAI;IACf;IACA,IAAII,QAAQ,GAAGJ,WAAW,CAAC3uD,IAAI,CAAC4uD,SAAS,CAAC;IAC1C,IAAIf,OAAO,GAAG,IAAI;IAElB,IAAI,CAACL,iBAAiB,CAACvjD,GAAG,CAAC,IAAI,CAACyjD,gBAAgB,CAAC;;IAEjD;IACA,KAAK,IAAIxsD,CAAC,GAAG,IAAI,CAAC8K,UAAU,CAACmhD,aAAa,EAAEjsD,CAAC,GAAG,CAAC,EAAEA,CAAC,EAAE,EAAE;MACpD,IAAI,CAAC6tD,QAAQ,CAAC7tD,CAAC,CAAC,EAAE;QACd;MACJ;MACA2sD,OAAO,GAAGkB,QAAQ,CAAC7tD,CAAC,CAAC;;MAErB;MACA,IAAI6sD,IAAI,GAAG,IAAI,CAACiB,YAAY;MAC5B,IAAI,CAACjB,IAAI,EAAE;QACPA,IAAI,GAAG,IAAI,CAACiB,YAAY,GAAG;UACvBhB,IAAI,EAAE,EAAE;UACRJ,OAAO,EAAE,CAAC,CAAC;UACXqB,GAAG,EAAE,EAAE;UACPhB,MAAM,EAAEf,YAAY,CAAC9mD;QACzB,CAAC;MACL;MAEA2nD,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,GAAGH,OAAO,CAACG,IAAI,CAAC,CAAC,CAAC;MACjCD,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,GAAGH,OAAO,CAACG,IAAI,CAAC,CAAC,CAAC;MACjCD,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,GAAGH,OAAO,CAACG,IAAI,CAAC,CAAC,CAAC;MACjCD,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC,GAAGH,OAAO,CAACG,IAAI,CAAC,CAAC,CAAC;MACjCD,IAAI,CAACC,IAAI,CAAC,UAAU,CAAC,GAAGH,OAAO,CAACD,OAAO,CAAC,CAAC,CAAC,CAACxxC,KAAK;MAChD2xC,IAAI,CAACC,IAAI,CAAC,UAAU,CAAC,GAAGH,OAAO,CAACD,OAAO,CAAC,CAAC,CAAC,CAACxxC,KAAK;MAChD2xC,IAAI,CAACkB,GAAG,GAAG,EAAE;MACblB,IAAI,CAACE,MAAM,GAAGf,YAAY,CAAC9mD,MAAM;MAEjC,KAAK,IAAIyJ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGg+C,OAAO,CAACD,OAAO,CAACptD,MAAM,EAAEqP,CAAC,EAAE,EAAE;QAC7C,IAAI,CAAC69C,gBAAgB,CAAC79C,CAAC,CAAC,GAAGg+C,OAAO,CAACD,OAAO,CAAC/9C,CAAC,CAAC,CAACq/C,OAAO;QAEjE,IAAGr/C,CAAC,GAAG,EAAE,EACT;UACCk+C,IAAI,CAACH,OAAO,CAAEV,YAAY,CAACwB,aAAa,CAAC7+C,CAAC,CAAC,CAAE,GAAGg+C,OAAO,CAACD,OAAO,CAAC/9C,CAAC,CAAC,CAACq/C,OAAO;UAC1E,IAAGrB,OAAO,CAACD,OAAO,CAAC/9C,CAAC,CAAC,CAACs/C,WAAW,EAChC,IAAI,CAAClzC,OAAO,CAAEixC,YAAY,CAACwB,aAAa,CAAC7+C,CAAC,CAAC,GAAG,eAAe,CAAE;QACjE,CAAC;UACI;UACJ,OAAa;UAAA,CAAJA,CAAC;YAET,KAAK,EAAE;cACN,IAAIg+C,OAAO,CAACD,OAAO,CAAC/9C,CAAC,CAAC,CAACq/C,OAAO,EAAE;gBAC/BnB,IAAI,CAACkB,GAAG,IAAI,IAAI;gBAChBlB,IAAI,CAACE,MAAM,IAAIf,YAAY,CAAClnD,EAAE;cAC/B;cACA;YACD,KAAK,EAAE;cACN,IAAI6nD,OAAO,CAACD,OAAO,CAAC/9C,CAAC,CAAC,CAACq/C,OAAO,EAAE;gBAC/BnB,IAAI,CAACkB,GAAG,IAAI,MAAM;gBAClBlB,IAAI,CAACE,MAAM,IAAIf,YAAY,CAACjnD,IAAI;cACjC;cACA;YACD,KAAK,EAAE;cACN,IAAI4nD,OAAO,CAACD,OAAO,CAAC/9C,CAAC,CAAC,CAACq/C,OAAO,EAAE;gBAC/BnB,IAAI,CAACkB,GAAG,IAAI,MAAM;gBAClBlB,IAAI,CAACE,MAAM,IAAIf,YAAY,CAAChnD,IAAI;cACjC;cACA;YACD,KAAK,EAAE;cACN,IAAI2nD,OAAO,CAACD,OAAO,CAAC/9C,CAAC,CAAC,CAACq/C,OAAO,EAAE;gBAC/BnB,IAAI,CAACkB,GAAG,IAAI,OAAO;gBACnBlB,IAAI,CAACE,MAAM,IAAIf,YAAY,CAAC/mD,KAAK;cAClC;cACA;YACD,KAAK,EAAE;cACN4nD,IAAI,CAACH,OAAO,CAAC,MAAM,CAAC,GAAGC,OAAO,CAACD,OAAO,CAAC/9C,CAAC,CAAC,CAACq/C,OAAO;cACjD;YACD;UAAQ;MAEF;MACArB,OAAO,CAACE,IAAI,GAAGA,IAAI;MACnB,OAAOF,OAAO;IAClB;EACJ,CAAC;EAEDX,YAAY,CAAC5rD,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACpD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;;IAEA;IACA,IAAIkpC,EAAE,GAAG,IAAI,CAAC/B,UAAU;IACxB,IAAIgC,EAAE,GAAG,IAAI,CAAC/B,WAAW;IACzBj/B,GAAG,CAAC2V,WAAW,GAAG,MAAM;IACxB3V,GAAG,CAAC4V,UAAU,CACV,CAACmrB,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,GAAG,GAAG,IAAI,CAAC5hD,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EACpC,CAAC4hD,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,GAAG,GAAG,IAAI,CAAC5hD,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EACpC,CAAC,EACD,CAAC,CACJ;IACD6gB,GAAG,CAAC2V,WAAW,GAAG,MAAM;IACxB3V,GAAG,CAAC4V,UAAU,CACV,CAACorB,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,GAAG,GAAG,IAAI,CAAC7hD,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EACpC,CAAC6hD,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,GAAG,GAAG,IAAI,CAAC7hD,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,EACpC,CAAC,EACD,CAAC,CACJ;IACD,IAAIiwB,CAAC,GAAG,IAAI,CAACjwB,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAACkgD,gBAAgB,CAACltD,MAAM;IACnD6tB,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB,KAAK,IAAI7iC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACwsD,gBAAgB,CAACltD,MAAM,EAAE,EAAEU,CAAC,EAAE;MACnD,IAAI,IAAI,CAACwsD,gBAAgB,CAACxsD,CAAC,CAAC,EAAE;QAC1BmtB,GAAG,CAACoY,QAAQ,CAAC,CAAC,EAAEhJ,CAAC,GAAGv8B,CAAC,EAAE,CAAC,EAAEu8B,CAAC,CAAC;MAChC;IACJ;EACJ,CAAC;EAEDyvB,YAAY,CAAC5rD,SAAS,CAAC2vC,YAAY,GAAG,YAAW;IAC7C,OAAO,CACH,CAAC,WAAW,EAAE,MAAM,CAAC,EACrB,CAAC,YAAY,EAAE,MAAM,CAAC,EACtB,CAAC,aAAa,EAAE,QAAQ,CAAC,EACzB,CAAC,aAAa,EAAE,QAAQ,CAAC,EACzB,CAAC,cAAc,EAAE,QAAQ,CAAC,EAC1B,CAAC,cAAc,EAAE,QAAQ,CAAC,EAC1B,CAAC,cAAc,EAAE,QAAQ,CAAC,EAC1B,CAAC,eAAe,EAAE,QAAQ,CAAC,EAC3B,CAAC,UAAU,EAAE,QAAQ,CAAC,EACtB,CAAC,UAAU,EAAE,QAAQ,CAAC,EACtB,CAAC,UAAU,EAAE,QAAQ,CAAC,EACtB,CAAC,UAAU,EAAE,QAAQ,CAAC,EACtB,CAAC,WAAW,EAAE,QAAQ,CAAC,EACvB,CAAC,WAAW,EAAE,QAAQ,CAAC,EACvB,CAAC,WAAW,EAAE,QAAQ,CAAC,EACvB,CAAC,WAAW,EAAE,QAAQ,CAAC,EACvB,CAAC,cAAc,EAAE,QAAQ,CAAC,EAC1B,CAAC,aAAa,EAAE,QAAQ,CAAC,EACzB,CAAC,gBAAgB,EAAEluC,SAAS,CAACyC,KAAK,CAAE,EACpC,CAAC,gBAAgB,EAAEzC,SAAS,CAACyC,KAAK,CAAE,EACpC,CAAC,gBAAgB,EAAEzC,SAAS,CAACyC,KAAK,CAAE,EACpC,CAAC,gBAAgB,EAAEzC,SAAS,CAACyC,KAAK,CAAE,EACpC,CAAC,iBAAiB,EAAEzC,SAAS,CAACyC,KAAK,CAAE,EACrC,CAAC,iBAAiB,EAAEzC,SAAS,CAACyC,KAAK,CAAE,EACrC,CAAC,iBAAiB,EAAEzC,SAAS,CAACyC,KAAK,CAAE,EACrC,CAAC,iBAAiB,EAAEzC,SAAS,CAACyC,KAAK,CAAE,EACrC,CAAC,oBAAoB,EAAEzC,SAAS,CAACyC,KAAK,CAAE,EACxC,CAAC,mBAAmB,EAAEzC,SAAS,CAACyC,KAAK,CAAE,EACvC,CAAC,UAAU,EAAE,QAAQ,CAAC,EACtB,CAAC,WAAW,EAAE,QAAQ,CAAC,EACvB,CAAC,QAAQ,EAAE,QAAQ,CAAC,EACpB,CAAC,UAAU,EAAE,QAAQ,CAAC,EACtB,CAAC,KAAK,EAAE,QAAQ,CAAC,EACjB,CAAC,gBAAgB,EAAEzC,SAAS,CAACyC,KAAK,CAAC,CACtC;EACL,CAAC;EAEDzC,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAEkkD,YAAY,CAAC;AAE7D,CAAC,EAAE,IAAI,CAAC;AAER,CAAC,UAASpqD,MAAM,EAAE;EACd,IAAIC,SAAS,GAAGD,MAAM,CAACC,SAAS;;EAEhC;EACA,SAASusD,SAAS,GAAG;IACjB,IAAI,CAACnzC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC;IAC5B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC;IAClB,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEA8hD,SAAS,CAAC9tD,KAAK,GAAG,WAAW;EAC7B8tD,SAAS,CAAC5iD,IAAI,GAAG,kBAAkB;EAEnC4iD,SAAS,CAAChuD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACvC,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IAEA,IAAI,IAAI,CAACkK,OAAO,EAAE;MACd,KAAK,IAAIlT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC5T,MAAM,EAAEU,CAAC,EAAE,EAAE;QAC1C,IAAIiW,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAClT,CAAC,CAAC;QAC5B,IAAI,CAACiW,MAAM,CAAChE,KAAK,IAAI,CAACgE,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAAE;UACvC;QACJ;QAEA,IAAI4N,MAAM,GAAG,IAAI;QACjB,QAAQ+I,MAAM,CAAC3U,IAAI;UACf,KAAK,QAAQ;YACT4L,MAAM,GAAGlE,CAAC,CAAC1J,MAAM,GAAG0J,CAAC,CAAC,CAAC,CAAC,GAAGq7C,UAAU,CAACr7C,CAAC,CAAC;YACxC;UACJ,KAAK,MAAM;UACX,KAAK,MAAM;UACX,KAAK,MAAM;YACP,IAAIkE,MAAM,GAAG,IAAI;YACjB,IAAImhD,KAAK,GAAG,CAAC;YACb,QAAQp4C,MAAM,CAAC3U,IAAI;cACf,KAAK,MAAM;gBACP+sD,KAAK,GAAG,CAAC;gBACT;cACJ,KAAK,MAAM;gBACPA,KAAK,GAAG,CAAC;gBACT;cACJ,KAAK,MAAM;gBACPA,KAAK,GAAG,CAAC;gBACT;YAAM;YAGd,IAAInhD,MAAM,GAAG,IAAIoS,YAAY,CAAC+uC,KAAK,CAAC;YACpC,IAAIrlD,CAAC,CAAC1J,MAAM,EAAE;cACV,KACI,IAAIqP,CAAC,GAAG,CAAC,EACTA,CAAC,GAAG3F,CAAC,CAAC1J,MAAM,IAAIqP,CAAC,GAAGzB,MAAM,CAAC5N,MAAM,EACjCqP,CAAC,EAAE,EACL;gBACEzB,MAAM,CAACyB,CAAC,CAAC,GAAG3F,CAAC,CAAC2F,CAAC,CAAC;cACpB;YACJ,CAAC,MAAM;cACHzB,MAAM,CAAC,CAAC,CAAC,GAAGm3C,UAAU,CAACr7C,CAAC,CAAC;YAC7B;YACA;QAAM;QAEd,IAAI,CAAC4C,aAAa,CAAC5L,CAAC,EAAEkN,MAAM,CAAC;MACjC;IACJ;EACJ,CAAC;EAEDkhD,SAAS,CAAChuD,SAAS,CAAC2vC,YAAY,GAAG,YAAW;IAC1C,OAAO,CACH,CAAC,QAAQ,EAAE,QAAQ,CAAC,EACpB,CAAC,MAAM,EAAE,MAAM,CAAC,EAChB,CAAC,MAAM,EAAE,MAAM,CAAC,EAChB,CAAC,MAAM,EAAE,MAAM,CAAC,CACnB;EACL,CAAC;EAEDluC,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAEsmD,SAAS,CAAC;;EAEvD;EACA,SAASE,MAAM,GAAG;IACd,IAAI,CAACrzC,QAAQ,CAAC,IAAI,CAAC;IACnB,IAAI,CAACY,SAAS,CAAC,KAAK,CAAC;IACrB,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEAgiD,MAAM,CAAChuD,KAAK,GAAG,QAAQ;EACvBguD,MAAM,CAAC9iD,IAAI,GAAG,kBAAkB;EAEhC8iD,MAAM,CAACluD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACpC,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI,CAACE,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC;EAC5B,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAEwmD,MAAM,CAAC;EAEjD,SAASC,QAAQ,GAAG;IAChB,IAAI,CAACtzC,QAAQ,CAAC,IAAI,CAAC;IACnB,IAAI,CAACY,SAAS,CAAC,KAAK,CAAC;EACzB;EAEA0yC,QAAQ,CAACjuD,KAAK,GAAG,WAAW;EAC5BiuD,QAAQ,CAAC/iD,IAAI,GAAG,gBAAgB;EAEhC+iD,QAAQ,CAACnuD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtC,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI,CAACE,aAAa,CAAC,CAAC,EAAEqb,MAAM,CAACje,CAAC,CAAC,CAAC;EACpC,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAEymD,QAAQ,CAAC;EAEtD,SAASC,SAAS,GAAG;IACjB,IAAI,CAACvzC,QAAQ,CAAC,IAAI,EAAE,QAAQ,EAAE;MAAEshC,MAAM,EAAE;IAAK,CAAC,CAAC;IAC/C,IAAI,CAAC1gC,SAAS,CAAC,KAAK,EAAE,QAAQ,EAAE;MAAE0gC,MAAM,EAAE;IAAK,CAAC,CAAC;IACjD,IAAI,CAAC1gC,SAAS,CAAC,SAAS,EAAE,QAAQ,EAAE;MAAE0gC,MAAM,EAAE;IAAK,CAAC,CAAC;IAErD,IAAI,CAACr5B,WAAW,CAAC,IAAI,EAAE,CAAC,CAAC;IACzB,IAAI,CAACA,WAAW,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC7B,IAAI,CAACA,WAAW,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC7B,IAAI,CAACA,WAAW,CAAC,SAAS,EAAE,CAAC,CAAC;IAC9B,IAAI,CAACA,WAAW,CAAC,SAAS,EAAE,CAAC,CAAC;IAE9B,IAAI,CAAC5W,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EACzB;EAEAkiD,SAAS,CAACluD,KAAK,GAAG,OAAO;EACzBkuD,SAAS,CAAChjD,IAAI,GAAG,4CAA4C;EAE7DgjD,SAAS,CAACpuD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IACtC,IAAI,IAAI,CAACjU,KAAK,CAAC2Y,SAAS,EAAE;MACtB,OAAO,CAAC,IAAI,CAACypC,OAAO,IAAI,CAAC,EAAE5pB,OAAO,CAAC,CAAC,CAAC;IACzC;IACA,OAAO,IAAI,CAACvkC,KAAK;EACrB,CAAC;EAEDkuD,SAAS,CAACpuD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACvC,IAAI,IAAI,CAACwH,MAAM,EAAE;MACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACiT,MAAM,CAAC3T,MAAM,EAAEU,CAAC,EAAE,EAAE;QACzC,IAAIiX,KAAK,GAAG,IAAI,CAAChE,MAAM,CAACjT,CAAC,CAAC;QAC1B,IAAIgJ,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC1L,CAAC,CAAC;QAC5B,IAAIgJ,CAAC,KAAKmP,SAAS,EAAE;UACjB;QACJ;QACA,IAAI,CAACrN,UAAU,CAACmM,KAAK,CAAC3V,IAAI,CAAC,GAAG0H,CAAC;MACnC;IACJ;IAEA,IAAIA,CAAC,GAAG,IAAI,CAAC8B,UAAU,CAAC,IAAI,CAAC;IAC7B,IAAI9B,CAAC,KAAKmP,SAAS,IAAInP,CAAC,KAAK,IAAI,IAAIA,CAAC,CAACS,WAAW,KAAKwd,MAAM,EAAE;MAC3Dje,CAAC,GAAG,CAAC;IACT;IAEA,IAAI0lD,MAAM,GAAG,IAAI,CAAC5jD,UAAU,CAAC4jD,MAAM;IACnC,IAAIC,MAAM,GAAG,IAAI,CAAC7jD,UAAU,CAAC6jD,MAAM;IACnC,IAAIC,OAAO,GAAG,IAAI,CAAC9jD,UAAU,CAAC8jD,OAAO;IACrC,IAAIC,OAAO,GAAG,IAAI,CAAC/jD,UAAU,CAAC+jD,OAAO;IAC3C;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAEQ,IAAI,CAACJ,OAAO,GAAI,CAACzlD,CAAC,GAAG0lD,MAAM,KAAKC,MAAM,GAAGD,MAAM,CAAC,IAAKG,OAAO,GAAGD,OAAO,CAAC,GAAGA,OAAO;IACjF,IAAI,CAAChjD,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC6iD,OAAO,CAAC;IACnC,IAAI,CAAC7iD,aAAa,CAAC,CAAC,EAAE2W,IAAI,CAAC+pB,KAAK,CAAE,IAAI,CAACmiB,OAAO,EAAEG,OAAO,EAAEC,OAAO,CAAE,CAAC;EACvE,CAAC;EAEDL,SAAS,CAACpuD,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACjD;IACA,IAAI,IAAI,CAACshC,OAAO,EAAE;MACd,IAAI,CAACv7C,OAAO,CAAC,CAAC,CAAC,CAAC8Q,KAAK,GAAG,IAAI,CAACyqC,OAAO,CAAC5pB,OAAO,CAAC,CAAC,CAAC;IACnD,CAAC,MAAM;MACH,IAAI,CAAC3xB,OAAO,CAAC,CAAC,CAAC,CAAC8Q,KAAK,GAAG,GAAG;IAC/B;EACJ,CAAC;EAEDwqC,SAAS,CAACpuD,SAAS,CAACovC,WAAW,GAAG,YAAW;IACzC,OAAO,CACH,CAAC,QAAQ,EAAE,QAAQ,CAAC,EACpB,CAAC,QAAQ,EAAE,QAAQ,CAAC,EACpB,CAAC,SAAS,EAAE,QAAQ,CAAC,EACrB,CAAC,SAAS,EAAE,QAAQ,CAAC,CACxB;EACL,CAAC;EAED3tC,SAAS,CAACiG,gBAAgB,CAAC,YAAY,EAAE0mD,SAAS,CAAC;EAEnD,SAASM,QAAQ,GAAG;IAChB,IAAI,CAACjzC,SAAS,CAAC,OAAO,EAAE,QAAQ,CAAC;IACjC,IAAI,CAACqH,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;IAC1B,IAAI,CAACA,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;IAC1B,IAAI,CAAC5W,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEAwiD,QAAQ,CAACxuD,KAAK,GAAG,MAAM;EACvBwuD,QAAQ,CAACtjD,IAAI,GAAG,eAAe;EAE/BsjD,QAAQ,CAAC1uD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtC,IAAI,IAAI,CAACwH,MAAM,EAAE;MACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACiT,MAAM,CAAC3T,MAAM,EAAEU,CAAC,EAAE,EAAE;QACzC,IAAIiX,KAAK,GAAG,IAAI,CAAChE,MAAM,CAACjT,CAAC,CAAC;QAC1B,IAAIgJ,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC1L,CAAC,CAAC;QAC5B,IAAIgJ,CAAC,KAAKmP,SAAS,EAAE;UACjB;QACJ;QACA,IAAI,CAACrN,UAAU,CAACmM,KAAK,CAAC3V,IAAI,CAAC,GAAG0H,CAAC;MACnC;IACJ;IAEA,IAAIm9B,GAAG,GAAG,IAAI,CAACr7B,UAAU,CAACq7B,GAAG;IAC7B,IAAIziB,GAAG,GAAG,IAAI,CAAC5Y,UAAU,CAAC4Y,GAAG;IAC7B,IAAI,CAAC+qC,OAAO,GAAGlsC,IAAI,CAACE,MAAM,EAAE,IAAIiB,GAAG,GAAGyiB,GAAG,CAAC,GAAGA,GAAG;IAChD,IAAI,CAACv6B,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC6iD,OAAO,CAAC;EACvC,CAAC;EAEDK,QAAQ,CAAC1uD,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IAChD;IACA,IAAI,CAACja,OAAO,CAAC,CAAC,CAAC,CAAC8Q,KAAK,GAAG,CAAC,IAAI,CAACyqC,OAAO,IAAI,CAAC,EAAE5pB,OAAO,CAAC,CAAC,CAAC;EAC1D,CAAC;EAEDiqB,QAAQ,CAAC1uD,SAAS,CAACovC,WAAW,GAAG,YAAW;IACxC,OAAO,CAAC,CAAC,KAAK,EAAE,QAAQ,CAAC,EAAE,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EACjD,CAAC;EAED3tC,SAAS,CAACiG,gBAAgB,CAAC,WAAW,EAAEgnD,QAAQ,CAAC;;EAEjD;EACA,SAASC,SAAS,GAAG;IACjB,IAAI,CAAC9zC,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAACqH,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;IAC1B,IAAI,CAACA,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;IAC1B,IAAI,CAACA,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC;IAChC,IAAI,CAACA,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC;IAC3B,IAAI,CAACA,WAAW,CAAC,SAAS,EAAE,CAAC,CAAC;IAC9B,IAAI,CAACA,WAAW,CAAC,aAAa,EAAE,GAAG,CAAC;IACpC,IAAI,CAACA,WAAW,CAAC,OAAO,EAAE,CAAC,CAAC;IAC5B,IAAI,CAAC5W,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEAyiD,SAAS,CAACzuD,KAAK,GAAG,OAAO;EACzByuD,SAAS,CAACvjD,IAAI,GAAG,wCAAwC;EACzDujD,SAAS,CAAChgD,IAAI,GAAG,IAAI;EAErBggD,SAAS,CAACC,QAAQ,GAAG,UAAS3lB,CAAC,EAAE4lB,MAAM,EAAE;IACrC,IAAI,CAACF,SAAS,CAAChgD,IAAI,EAAE;MACjBggD,SAAS,CAAChgD,IAAI,GAAG,IAAIuQ,YAAY,CAAC,IAAI,CAAC;MACvC,KAAK,IAAItf,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+uD,SAAS,CAAChgD,IAAI,CAACzP,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC5C+uD,SAAS,CAAChgD,IAAI,CAAC/O,CAAC,CAAC,GAAGuiB,IAAI,CAACE,MAAM,EAAE;MACrC;IACJ;IACA4mB,CAAC,GAAGA,CAAC,GAAG,IAAI;IACZ,IAAIA,CAAC,GAAG,CAAC,EAAE;MACPA,CAAC,IAAI,IAAI;IACb;IACA,IAAI6lB,KAAK,GAAG3sC,IAAI,CAACC,KAAK,CAAC6mB,CAAC,CAAC;IACzB,IAAIA,CAAC,GAAGA,CAAC,GAAG6lB,KAAK;IACjB,IAAIC,EAAE,GAAGJ,SAAS,CAAChgD,IAAI,CAACmgD,KAAK,CAAC;IAC9B,IAAIE,EAAE,GAAGL,SAAS,CAAChgD,IAAI,CAACmgD,KAAK,IAAI,IAAI,GAAG,CAAC,GAAGA,KAAK,GAAG,CAAC,CAAC;IACtD,IAAID,MAAM,EAAE;MACR5lB,CAAC,GAAGA,CAAC,GAAGA,CAAC,GAAGA,CAAC,IAAIA,CAAC,IAAIA,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC;IACjD;IACA,OAAO8lB,EAAE,IAAI,CAAC,GAAG9lB,CAAC,CAAC,GAAG+lB,EAAE,GAAG/lB,CAAC;EAChC,CAAC;EAED0lB,SAAS,CAAC3uD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACvC,IAAI49B,CAAC,GAAG,IAAI,CAAC39B,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC;IACvC,IAAI2jD,UAAU,GAAG,IAAI,CAACvkD,UAAU,CAACwkD,OAAO,IAAI,CAAC;IAC7C,IAAI3jD,CAAC,GAAG,CAAC;IACT,IAAI4jD,GAAG,GAAG,CAAC;IACX,IAAIC,IAAI,GAAG,IAAI,CAAC1kD,UAAU,CAAC0kD,IAAI,IAAI,CAAC;IACpCnmB,CAAC,IAAImmB,IAAI;IACT,IAAIC,KAAK,GAAG,IAAI,CAAC3kD,UAAU,CAAC2kD,KAAK,IAAI,CAAC;IACtC,IAAIC,SAAS,GAAG,CAAC;IACjB,KAAI,IAAI1vD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGqvD,UAAU,EAAE,EAAErvD,CAAC,EAClC;MACC2L,CAAC,IAAIojD,SAAS,CAACC,QAAQ,CAAC3lB,CAAC,IAAI,CAAC,GAACrpC,CAAC,CAAC,GAAGyvD,KAAK,EAAE,IAAI,CAAC3kD,UAAU,CAACmkD,MAAM,CAAC,GAAGM,GAAG;MACxEG,SAAS,IAAIH,GAAG;MAChBA,GAAG,IAAI,IAAI,CAACzkD,UAAU,CAAC6kD,WAAW;MAClC,IAAGJ,GAAG,GAAG,KAAK,EACb;IACF;IACA5jD,CAAC,IAAI+jD,SAAS;IACR,IAAIvpB,GAAG,GAAG,IAAI,CAACr7B,UAAU,CAACq7B,GAAG;IAC7B,IAAIziB,GAAG,GAAG,IAAI,CAAC5Y,UAAU,CAAC4Y,GAAG;IAC7B,IAAI,CAAC+qC,OAAO,GAAG9iD,CAAC,IAAI+X,GAAG,GAAGyiB,GAAG,CAAC,GAAGA,GAAG;IACpC,IAAI,CAACv6B,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC6iD,OAAO,CAAC;EACvC,CAAC;EAEDM,SAAS,CAAC3uD,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACjD;IACA,IAAI,CAACja,OAAO,CAAC,CAAC,CAAC,CAAC8Q,KAAK,GAAG,CAAC,IAAI,CAACyqC,OAAO,IAAI,CAAC,EAAE5pB,OAAO,CAAC,CAAC,CAAC;EAC1D,CAAC;EAEDhjC,SAAS,CAACiG,gBAAgB,CAAC,YAAY,EAAEinD,SAAS,CAAC;;EAEnD;EACA,SAASa,UAAU,GAAG;IAClB,IAAI,CAAC/zC,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAACqH,WAAW,CAAC,UAAU,EAAE,CAAC,CAAC;IAC/B,IAAI,CAACA,WAAW,CAAC,UAAU,EAAE,CAAC,CAAC;IAC/B,IAAI,CAACA,WAAW,CAAC,UAAU,EAAE,GAAG,CAAC;IACjC,IAAI,CAAC5W,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAACujD,eAAe,GAAG,CAAC;IACxB,IAAI,CAACC,WAAW,GAAG,CAAC;EACxB;EAEAF,UAAU,CAACtvD,KAAK,GAAG,QAAQ;EAC3BsvD,UAAU,CAACpkD,IAAI,GAAG,yBAAyB;EAE3CokD,UAAU,CAACxvD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAIi9C,EAAE,GAAG,IAAI,CAACl1C,KAAK,CAACd,YAAY,CAAC,CAAC;;IAElC,IAAI,CAACm9C,eAAe,IAAInH,EAAE;IAC1B,IAAI,CAACoH,WAAW,IAAIpH,EAAE;IAEtB,IAAI1/C,CAAC,GAAG,CAAC;IACT,IAAI,IAAI,CAAC8mD,WAAW,GAAG,CAAC,EAAE;MACtB,IAAIzmB,CAAC,GAAG,IAAI,CAACymB,WAAW,GAAG,IAAI,CAAChlD,UAAU,CAACilD,QAAQ;MACnD/mD,CAAC,GAAG,CAAC,IAAIuZ,IAAI,CAACytC,GAAG,CAAC3mB,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;IACxC;IAEA,IAAI,IAAI,CAACwmB,eAAe,GAAG,CAAC,EAAE;MAC1B,IAAI,CAACA,eAAe,GAChBttC,IAAI,CAACE,MAAM,EAAE,IACR,IAAI,CAAC3X,UAAU,CAACmlD,QAAQ,GAAG,IAAI,CAACnlD,UAAU,CAAColD,QAAQ,CAAC,GACzD,IAAI,CAACplD,UAAU,CAAColD,QAAQ;MAC5B,IAAI,CAACJ,WAAW,GAAG,IAAI,CAAChlD,UAAU,CAACilD,QAAQ;MAC3C,IAAI,CAAC7vC,QAAQ,GAAG,MAAM;IAC1B,CAAC,MAAM;MACH,IAAI,CAACA,QAAQ,GAAG,MAAM;IAC1B;IACA,IAAI,CAACtU,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC;EAC5B,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAE8nD,UAAU,CAAC;;EAErD;EACA,SAASO,SAAS,GAAG;IACjB,IAAI,CAACl1C,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC4W,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;IAC1B,IAAI,CAACA,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;EAC9B;EAEAitC,SAAS,CAAC7vD,KAAK,GAAG,OAAO;EACzB6vD,SAAS,CAAC3kD,IAAI,GAAG,kCAAkC;EACnD;;EAEA2kD,SAAS,CAAC/vD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACvC,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IACAA,CAAC,GAAGuZ,IAAI,CAACmB,GAAG,CAAC,IAAI,CAAC5Y,UAAU,CAACq7B,GAAG,EAAEn9B,CAAC,CAAC;IACpCA,CAAC,GAAGuZ,IAAI,CAAC4jB,GAAG,CAAC,IAAI,CAACr7B,UAAU,CAAC4Y,GAAG,EAAE1a,CAAC,CAAC;IACpC,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC;EAC5B,CAAC;EAEDmnD,SAAS,CAAC/vD,SAAS,CAACgwD,OAAO,GAAG,UAASC,IAAI,EAAE;IACzC,IAAIrlD,IAAI,GAAG,EAAE;IACb,IAAI,IAAI,CAACiW,gBAAgB,CAAC,CAAC,CAAC,EAAE;MAC1BjW,IAAI,IACA,cAAc,GACd,IAAI,CAACF,UAAU,CAACq7B,GAAG,GACnB,GAAG,GACH,IAAI,CAACr7B,UAAU,CAAC4Y,GAAG,GACnB,GAAG;IACX;IACA,OAAO1Y,IAAI;EACf,CAAC;EAEDnJ,SAAS,CAACiG,gBAAgB,CAAC,YAAY,EAAEqoD,SAAS,CAAC;;EAEnD;EACA,SAASG,QAAQ,GAAG;IAChB,IAAI,CAACxlD,UAAU,GAAG;MAAEu+B,CAAC,EAAE;IAAI,CAAC;IAC5B,IAAI,CAACpuB,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAE5B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;EACnC;EAEAy0C,QAAQ,CAAChwD,KAAK,GAAG,MAAM;EACvBgwD,QAAQ,CAAC9kD,IAAI,GAAG,sBAAsB;EAEtC8kD,QAAQ,CAAClwD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtC,IAAI8kD,EAAE,GAAG,IAAI,CAAC7kD,YAAY,CAAC,CAAC,CAAC;IAC7B,IAAI6kD,EAAE,IAAI,IAAI,EAAE;MACZA,EAAE,GAAG,CAAC;IACV;IACA,IAAIC,EAAE,GAAG,IAAI,CAAC9kD,YAAY,CAAC,CAAC,CAAC;IAC7B,IAAI8kD,EAAE,IAAI,IAAI,EAAE;MACZA,EAAE,GAAG,CAAC;IACV;IAEA,IAAInnB,CAAC,GAAG,IAAI,CAACv+B,UAAU,CAACu+B,CAAC;IAEzB,IAAIonB,EAAE,GAAG,IAAI,CAAC/kD,YAAY,CAAC,CAAC,CAAC;IAC7B,IAAI+kD,EAAE,KAAKt4C,SAAS,EAAE;MAClBkxB,CAAC,GAAGonB,EAAE;IACV;IAEA,IAAI,CAAC7kD,aAAa,CAAC,CAAC,EAAE2kD,EAAE,IAAI,CAAC,GAAGlnB,CAAC,CAAC,GAAGmnB,EAAE,GAAGnnB,CAAC,CAAC;EAChD,CAAC;EAEDinB,QAAQ,CAAClwD,SAAS,CAACovC,WAAW,GAAG,YAAW;IACxC,OAAO,CAAC,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;EAC5B,CAAC;EAED3tC,SAAS,CAACiG,gBAAgB,CAAC,WAAW,EAAEwoD,QAAQ,CAAC;;EAEjD;EACA,SAASI,OAAO,GAAG;IACf,IAAI,CAACz1C,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEAokD,OAAO,CAACpwD,KAAK,GAAG,KAAK;EACrBowD,OAAO,CAACllD,IAAI,GAAG,UAAU;EAEzBklD,OAAO,CAACtwD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACrC,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IACA,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE2W,IAAI,CAACmL,GAAG,CAAC1kB,CAAC,CAAC,CAAC;EACtC,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,UAAU,EAAE4oD,OAAO,CAAC;;EAE/C;EACA,SAASC,SAAS,GAAG;IACjB,IAAI,CAAC11C,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEAqkD,SAAS,CAACrwD,KAAK,GAAG,OAAO;EACzBqwD,SAAS,CAACnlD,IAAI,GAAG,wCAAwC;EAEzDmlD,SAAS,CAACvwD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACvC,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IACA,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE2W,IAAI,CAACC,KAAK,CAACxZ,CAAC,CAAC,CAAC;EACxC,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,YAAY,EAAE6oD,SAAS,CAAC;;EAEnD;EACA,SAASC,QAAQ,GAAG;IAChB,IAAI,CAAC31C,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEAskD,QAAQ,CAACtwD,KAAK,GAAG,MAAM;EACvBswD,QAAQ,CAACplD,IAAI,GAAG,yBAAyB;EAEzColD,QAAQ,CAACxwD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtC,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IACA,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,GAAG,CAAC,CAAC;EAChC,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,WAAW,EAAE8oD,QAAQ,CAAC;;EAEjD;EACA,SAASC,cAAc,GAAG;IACtB,IAAI,CAAC51C,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAACxB,UAAU,GAAG;MAAEyL,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAE,CAAC;EACpC;EAEAq6C,cAAc,CAACvwD,KAAK,GAAG,YAAY;EACnCuwD,cAAc,CAACrlD,IAAI,GAAG,YAAY;EAElCqlD,cAAc,CAACzwD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,KAAKmP,SAAS,EAAE;MACjB;IACJ;IAEA,IAAI24C,KAAK,GAAG,IAAI,CAAChmD,UAAU,CAACyL,CAAC;IAC7B,IAAIw6C,KAAK,GAAG,IAAI,CAACjmD,UAAU,CAAC0L,CAAC;;IAE7B;IACAxN,CAAC,GAAGuZ,IAAI,CAAC+pB,KAAK,CAAC,CAACtjC,CAAC,GAAG8nD,KAAK,KAAKC,KAAK,GAAGD,KAAK,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC;IACvD;IACA9nD,CAAC,GAAGA,CAAC,GAAGA,CAAC,IAAI,CAAC,GAAG,CAAC,GAAGA,CAAC,CAAC;IAEvB,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC;EAC5B,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAE+oD,cAAc,CAAC;;EAE7D;EACA,SAASG,SAAS,GAAG;IACjB,IAAI,CAAC/1C,QAAQ,CAAC,IAAI,EAAE,QAAQ,EAAE;MAAE+I,KAAK,EAAE;IAAG,CAAC,CAAC;IAC5C,IAAI,CAACnI,SAAS,CAAC,KAAK,EAAE,QAAQ,EAAE;MAAEmI,KAAK,EAAE;IAAG,CAAC,CAAC;IAC9C,IAAI,CAAC1X,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC4W,WAAW,CAAC,QAAQ,EAAE,CAAC,CAAC;EACjC;EAEA8tC,SAAS,CAAC1wD,KAAK,GAAG,OAAO;EACzB0wD,SAAS,CAACxlD,IAAI,GAAG,YAAY;EAE7BwlD,SAAS,CAAC5wD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACvC,IAAIyP,KAAK,GAAG,IAAI,CAACxP,YAAY,CAAC,CAAC,CAAC;IAChC,IAAIwP,KAAK,IAAI,IAAI,EAAE;MACf,IAAI,CAACtP,aAAa,CAAC,CAAC,EAAEsP,KAAK,GAAG,IAAI,CAACpQ,UAAU,CAACmmD,MAAM,CAAC;IACzD;EACJ,CAAC;EAEDpvD,SAAS,CAACiG,gBAAgB,CAAC,YAAY,EAAEkpD,SAAS,CAAC;;EAEtD;EACA,SAASE,IAAI,GAAG;IACf,IAAI,CAACj2C,QAAQ,CAAC,GAAG,EAAC,SAAS,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,CAAC;IAClB,IAAI,CAACA,QAAQ,CAAC,GAAG,CAAC;IAClB,IAAI,CAACY,SAAS,CAAC,KAAK,CAAC;EACtB;EAEAq1C,IAAI,CAAC5wD,KAAK,GAAG,MAAM;EACnB4wD,IAAI,CAAC1lD,IAAI,GAAG,2CAA2C;EAEvD0lD,IAAI,CAAC9wD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACrC,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI,CAACE,aAAa,CAAC,CAAC,EAAE,IAAI,CAACF,YAAY,CAAE1C,CAAC,GAAG,CAAC,GAAG,CAAC,CAAE,CAAC;EACtD,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,WAAW,EAAEopD,IAAI,CAAC;;EAG1C;EACA,SAASC,iBAAiB,GAAG;IACzB,IAAI,CAACl2C,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC4W,WAAW,CAAC,SAAS,EAAE,EAAE,CAAC;IAC/B,IAAI,CAACknC,OAAO,GAAG,IAAI9qC,YAAY,CAAC,EAAE,CAAC;IACnC,IAAI,CAAC8xC,QAAQ,GAAG,CAAC;EACrB;EAEAD,iBAAiB,CAAC7wD,KAAK,GAAG,SAAS;EACnC6wD,iBAAiB,CAAC3lD,IAAI,GAAG,gBAAgB;EAEzC2lD,iBAAiB,CAAC/wD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC/C,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,CAAC;IACT;IAEA,IAAIqoD,WAAW,GAAG,IAAI,CAACjH,OAAO,CAAC9qD,MAAM;IAErC,IAAI,CAAC8qD,OAAO,CAAC,IAAI,CAACgH,QAAQ,GAAGC,WAAW,CAAC,GAAGroD,CAAC;IAC7C,IAAI,CAACooD,QAAQ,IAAI,CAAC;IAClB,IAAI,IAAI,CAACA,QAAQ,GAAGC,WAAW,EAAE;MAC7B,IAAI,CAACD,QAAQ,GAAG,CAAC;IACrB;IAEA,IAAIE,GAAG,GAAG,CAAC;IACX,KAAK,IAAItxD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGqxD,WAAW,EAAE,EAAErxD,CAAC,EAAE;MAClCsxD,GAAG,IAAI,IAAI,CAAClH,OAAO,CAACpqD,CAAC,CAAC;IAC1B;IAEA,IAAI,CAAC4L,aAAa,CAAC,CAAC,EAAE0lD,GAAG,GAAGD,WAAW,CAAC;EAC5C,CAAC;EAEDF,iBAAiB,CAAC/wD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAClE,IAAIA,KAAK,GAAG,CAAC,EAAE;MACXA,KAAK,GAAG,CAAC;IACb;IACA,IAAI,CAACpQ,UAAU,CAACymD,OAAO,GAAGhvC,IAAI,CAAC4F,KAAK,CAACjN,KAAK,CAAC;IAC3C,IAAIs2C,GAAG,GAAG,IAAI,CAACpH,OAAO;IAEtB,IAAI,CAACA,OAAO,GAAG,IAAI9qC,YAAY,CAAC,IAAI,CAACxU,UAAU,CAACymD,OAAO,CAAC;IACxD,IAAIC,GAAG,CAAClyD,MAAM,IAAI,IAAI,CAAC8qD,OAAO,CAAC9qD,MAAM,EAAE;MACnC,IAAI,CAAC8qD,OAAO,CAACrhD,GAAG,CAACyoD,GAAG,CAAC;IACzB,CAAC,MAAM;MACH,IAAI,CAACpH,OAAO,CAACrhD,GAAG,CAACyoD,GAAG,CAAC9nC,QAAQ,CAAC,CAAC,EAAE,IAAI,CAAC0gC,OAAO,CAAC9qD,MAAM,CAAC,CAAC;IAC1D;EACJ,CAAC;EAEDuC,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAEqpD,iBAAiB,CAAC;;EAE7D;EACA,SAASM,UAAU,GAAG;IAClB,IAAI,CAACx2C,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAACqH,WAAW,CAAC,QAAQ,EAAE,GAAG,CAAC;IAC/B,IAAI,CAAC5W,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpB,IAAI,CAAC63C,MAAM,GAAG,IAAI;EACtB;EAEAsN,UAAU,CAACnxD,KAAK,GAAG,QAAQ;EAC3BmxD,UAAU,CAACjmD,IAAI,GAAG,mDAAmD;EAErEimD,UAAU,CAACrxD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,CAAC;IACT;IACA,IAAIqgC,CAAC,GAAG,IAAI,CAACv+B,UAAU,CAACmmD,MAAM;IAC9B,IAAI,IAAI,CAAC9M,MAAM,IAAI,IAAI,EAAE;MACrB,IAAI,CAACA,MAAM,GAAGn7C,CAAC;IACnB,CAAC,MAAM;MACH,IAAI,CAACm7C,MAAM,GAAG,IAAI,CAACA,MAAM,IAAI,CAAC,GAAG9a,CAAC,CAAC,GAAGrgC,CAAC,GAAGqgC,CAAC;IAC/C;IACA,IAAI,CAACz9B,aAAa,CAAC,CAAC,EAAE,IAAI,CAACu4C,MAAM,CAAC;EACtC,CAAC;EAEDtiD,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAE2pD,UAAU,CAAC;;EAErD;EACA,SAASC,aAAa,GAAG;IACrB,IAAI,CAACz2C,QAAQ,CAAC,GAAG,EAAE,qBAAqB,CAAC;IACzC,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACY,SAAS,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACqH,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC;IACxB,IAAI,CAACA,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC;IACxB,IAAI,CAACA,WAAW,CAAC,IAAI,EAAE,GAAG,EAAE,MAAM,EAAE;MAAE0B,MAAM,EAAE8sC,aAAa,CAAC9sC;IAAO,CAAC,CAAC;IAC3E,IAAI,CAACkiC,KAAK,GAAG,UAASvwC,CAAC,EAACC,CAAC,EAAE;MAAE,OAAOD,CAAC,GAAGC,CAAC;IAAE,CAAC;IAC5C,IAAI,CAACivC,OAAO,GAAG,EAAE,CAAC,CAAC;EACjB;;EAEAiM,aAAa,CAAC9sC,MAAM,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,CAAC;EAEtE8sC,aAAa,CAACpxD,KAAK,GAAG,WAAW;EAC9BoxD,aAAa,CAAClmD,IAAI,GAAG,qBAAqB;EAC1CkmD,aAAa,CAAC,KAAK,CAAC,GAAG;IACnB3pD,IAAI,EAAE,MAAM;IACZzH,KAAK,EAAE,WAAW;IAClBskB,MAAM,EAAE8sC,aAAa,CAAC9sC;EAC1B,CAAC;EACD8sC,aAAa,CAACplD,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EAE9BolD,aAAa,CAACtxD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IAChD,IAAG,IAAI,CAACxV,UAAU,CAACq8C,EAAE,IAAI,KAAK,IAAI,IAAI,CAACr8C,UAAU,CAACq8C,EAAE,IAAI,KAAK,EAC5D,OAAO,IAAI,CAACr8C,UAAU,CAACq8C,EAAE,GAAG,OAAO;IAC9B,OAAO,IAAI,GAAG,IAAI,CAACr8C,UAAU,CAACq8C,EAAE,GAAG,IAAI;EAC3C,CAAC;EAEDuK,aAAa,CAACtxD,SAAS,CAACiyC,QAAQ,GAAG,UAASrpC,CAAC,EAAE;IAC3C,IAAI,OAAOA,CAAC,IAAI,QAAQ,EAAE;MACtBA,CAAC,GAAGq7C,UAAU,CAACr7C,CAAC,CAAC;IACrB;IACA,IAAI,CAAC8B,UAAU,CAAC,OAAO,CAAC,GAAG9B,CAAC;EAChC,CAAC;EAED0oD,aAAa,CAACtxD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EACnE;IACC,IAAI5Z,IAAI,IAAI,IAAI,EACf;IACK,QAAQ,IAAI,CAACwJ,UAAU,CAACq8C,EAAE;MACtB,KAAK,GAAG;QAAE,IAAI,CAACL,KAAK,GAAG,UAASvwC,CAAC,EAACC,CAAC,EAAE;UAAE,OAAOD,CAAC,GAAGC,CAAC;QAAE,CAAC;QAAE;MACxD,KAAK,GAAG;QAAE,IAAI,CAACswC,KAAK,GAAG,UAASvwC,CAAC,EAACC,CAAC,EAAE;UAAE,OAAOD,CAAC,GAAGC,CAAC;QAAE,CAAC;QAAE;MACxD,KAAK,GAAG;MACR,KAAK,GAAG;MACR,KAAK,GAAG;QAAE,IAAI,CAACswC,KAAK,GAAG,UAASvwC,CAAC,EAACC,CAAC,EAAE;UAAE,OAAOD,CAAC,GAAGC,CAAC;QAAE,CAAC;QAAE;MACxD,KAAK,GAAG;QAAE,IAAI,CAACswC,KAAK,GAAG,UAASvwC,CAAC,EAACC,CAAC,EAAE;UAAE,OAAOD,CAAC,GAAGC,CAAC;QAAE,CAAC;QAAE;MACxD,KAAK,GAAG;QAAE,IAAI,CAACswC,KAAK,GAAG,UAASvwC,CAAC,EAACC,CAAC,EAAE;UAAE,OAAOD,CAAC,GAAGC,CAAC;QAAE,CAAC;QAAE;MACxD,KAAK,GAAG;QAAE,IAAI,CAACswC,KAAK,GAAG,UAASvwC,CAAC,EAACC,CAAC,EAAE;UAAE,OAAO+L,IAAI,CAACytC,GAAG,CAACz5C,CAAC,EAAEC,CAAC,CAAC;QAAE,CAAC;QAAE;MACjE,KAAK,KAAK;QAAE,IAAI,CAACswC,KAAK,GAAG,UAASvwC,CAAC,EAACC,CAAC,EAAE;UAAE,OAAO+L,IAAI,CAACmB,GAAG,CAACnN,CAAC,EAAEC,CAAC,CAAC;QAAE,CAAC;QAAE;MACnE,KAAK,KAAK;QAAE,IAAI,CAACswC,KAAK,GAAG,UAASvwC,CAAC,EAACC,CAAC,EAAE;UAAE,OAAO+L,IAAI,CAAC4jB,GAAG,CAAC5vB,CAAC,EAAEC,CAAC,CAAC;QAAE,CAAC;QAAE;MAC5E;QACCvO,OAAO,CAACqB,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAACwB,UAAU,CAACq8C,EAAE,CAAC;QACxD,IAAI,CAACL,KAAK,GAAG,UAASvwC,CAAC,EAAE;UAAE,OAAOA,CAAC;QAAE,CAAC;QACtC;IAAM;EAET,CAAC;EAEEm7C,aAAa,CAACtxD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC3C,IAAI8K,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8K,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAK6K,CAAC,IAAI,IAAI,EAAG;MACtB,IAAIA,CAAC,CAAC9M,WAAW,KAAKwd,MAAM,EAClB,IAAI,CAACnc,UAAU,CAAC,GAAG,CAAC,GAAGyL,CAAC;IAC7B,CAAC,MAAM;MACHA,CAAC,GAAG,IAAI,CAACzL,UAAU,CAAC,GAAG,CAAC;IAC5B;IAEA,IAAI0L,CAAC,IAAI,IAAI,EAAE;MACX,IAAI,CAAC1L,UAAU,CAAC,GAAG,CAAC,GAAG0L,CAAC;IAC5B,CAAC,MAAM;MACHA,CAAC,GAAG,IAAI,CAAC1L,UAAU,CAAC,GAAG,CAAC;IAC5B;IAEN,IAAIoC,MAAM;IACV,IAAGqJ,CAAC,CAAC9M,WAAW,KAAKwd,MAAM,EAC3B;MACO/Z,MAAM,GAAG,CAAC;MAChBA,MAAM,GAAG,IAAI,CAAC45C,KAAK,CAACvwC,CAAC,EAACC,CAAC,CAAC;IACzB,CAAC,MACI,IAAGD,CAAC,CAAC9M,WAAW,KAAK3J,KAAK,EAC/B;MACCoN,MAAM,GAAG,IAAI,CAACu4C,OAAO;MACrBv4C,MAAM,CAAC5N,MAAM,GAAGiX,CAAC,CAACjX,MAAM;MACxB,KAAI,IAAIU,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuW,CAAC,CAACjX,MAAM,EAAE,EAAEU,CAAC,EAC/BkN,MAAM,CAAClN,CAAC,CAAC,GAAG,IAAI,CAAC8mD,KAAK,CAACvwC,CAAC,CAACvW,CAAC,CAAC,EAACwW,CAAC,CAAC;IAChC,CAAC,MAED;MACCtJ,MAAM,GAAG,CAAC,CAAC;MACX,KAAI,IAAIlN,CAAC,IAAIuW,CAAC,EACbrJ,MAAM,CAAClN,CAAC,CAAC,GAAG,IAAI,CAAC8mD,KAAK,CAACvwC,CAAC,CAACvW,CAAC,CAAC,EAACwW,CAAC,CAAC;IAChC;IACG,IAAI,CAAC5K,aAAa,CAAC,CAAC,EAAEsB,MAAM,CAAC;EAC9B,CAAC;EAEDwkD,aAAa,CAACtxD,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACrD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IAEAmI,GAAG,CAACtD,IAAI,GAAG,YAAY;IACvBsD,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACsW,SAAS,GAAG,QAAQ;IACxBtW,GAAG,CAACuW,QAAQ,CACR,IAAI,CAAC54B,UAAU,CAACq8C,EAAE,EAClB,IAAI,CAAC76C,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EAClB,CAAC,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,GAAGzK,SAAS,CAACG,iBAAiB,IAAI,GAAG,CACrD;IACDmrB,GAAG,CAACsW,SAAS,GAAG,MAAM;EAC1B,CAAC;EAED5hC,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAE4pD,aAAa,CAAC;EAE3D7vD,SAAS,CAAC+M,sBAAsB,CAAC,gBAAgB,EAAE,KAAK,EAAE;IACtD9D,UAAU,EAAE;MAACq8C,EAAE,EAAC;IAAK,CAAC;IACtB7mD,KAAK,EAAE;EACX,CAAC,CAAC;EAEFuB,SAAS,CAAC+M,sBAAsB,CAAC,gBAAgB,EAAE,KAAK,EAAE;IACtD9D,UAAU,EAAE;MAACq8C,EAAE,EAAC;IAAK,CAAC;IACtB7mD,KAAK,EAAE;EACX,CAAC,CAAC;;EAGF;EACA,SAASqxD,WAAW,GAAG;IACnB,IAAI,CAAC12C,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACY,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC;IACjC,IAAI,CAACA,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC;IACjC,IAAI,CAACqH,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC;IACxB,IAAI,CAACA,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC;EAC5B;EAEAyuC,WAAW,CAACrxD,KAAK,GAAG,SAAS;EAC7BqxD,WAAW,CAACnmD,IAAI,GAAG,6BAA6B;EAEhDmmD,WAAW,CAACvxD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACzC,IAAI8K,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8K,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI6K,CAAC,KAAK4B,SAAS,EAAE;MACjB,IAAI,CAACrN,UAAU,CAAC,GAAG,CAAC,GAAGyL,CAAC;IAC5B,CAAC,MAAM;MACHA,CAAC,GAAG,IAAI,CAACzL,UAAU,CAAC,GAAG,CAAC;IAC5B;IAEA,IAAI0L,CAAC,KAAK2B,SAAS,EAAE;MACjB,IAAI,CAACrN,UAAU,CAAC,GAAG,CAAC,GAAG0L,CAAC;IAC5B,CAAC,MAAM;MACHA,CAAC,GAAG,IAAI,CAAC1L,UAAU,CAAC,GAAG,CAAC;IAC5B;IAEA,KAAK,IAAI9K,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAACzC,OAAO,CAAC5T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MACjD,IAAIiW,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAClT,CAAC,CAAC;MAC5B,IAAI,CAACiW,MAAM,CAAChE,KAAK,IAAI,CAACgE,MAAM,CAAChE,KAAK,CAAC3S,MAAM,EAAE;QACvC;MACJ;MACA,IAAI4b,KAAK;MACT,QAAQjF,MAAM,CAAC3U,IAAI;QACf,KAAK,MAAM;UACP4Z,KAAK,GAAG3E,CAAC,IAAIC,CAAC;UACd;QACJ,KAAK,MAAM;UACP0E,KAAK,GAAG3E,CAAC,IAAIC,CAAC;UACd;QACJ,KAAK,KAAK;UACN0E,KAAK,GAAG3E,CAAC,GAAGC,CAAC;UACb;QACJ,KAAK,KAAK;UACN0E,KAAK,GAAG3E,CAAC,GAAGC,CAAC;UACb;QACJ,KAAK,MAAM;UACP0E,KAAK,GAAG3E,CAAC,IAAIC,CAAC;UACd;QACJ,KAAK,MAAM;UACP0E,KAAK,GAAG3E,CAAC,IAAIC,CAAC;UACd;MAAM;MAEd,IAAI,CAAC5K,aAAa,CAAC5L,CAAC,EAAEkb,KAAK,CAAC;IAChC;EACJ,CAAC;EAEDy2C,WAAW,CAACvxD,SAAS,CAAC2vC,YAAY,GAAG,YAAW;IAC5C,OAAO,CACH,CAAC,MAAM,EAAE,SAAS,CAAC,EACnB,CAAC,MAAM,EAAE,SAAS,CAAC,EACnB,CAAC,KAAK,EAAE,SAAS,CAAC,EAClB,CAAC,KAAK,EAAE,SAAS,CAAC,EAClB,CAAC,MAAM,EAAE,SAAS,CAAC,EACnB,CAAC,MAAM,EAAE,SAAS,CAAC,CACtB;EACL,CAAC;EAEDluC,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAE6pD,WAAW,CAAC;EAEvD9vD,SAAS,CAAC+M,sBAAsB,CAAC,cAAc,EAAE,IAAI,EAAE;IACnDsE,OAAO,EAAE,CAAC,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IAC9B5S,KAAK,EAAE;EACX,CAAC,CAAC;EACFuB,SAAS,CAAC+M,sBAAsB,CAAC,cAAc,EAAE,IAAI,EAAE;IACnDsE,OAAO,EAAE,CAAC,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IAC9B5S,KAAK,EAAE;EACX,CAAC,CAAC;EACFuB,SAAS,CAAC+M,sBAAsB,CAAC,cAAc,EAAE,GAAG,EAAE;IAClDsE,OAAO,EAAE,CAAC,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;IAC7B5S,KAAK,EAAE;EACX,CAAC,CAAC;EACFuB,SAAS,CAAC+M,sBAAsB,CAAC,cAAc,EAAE,GAAG,EAAE;IAClDsE,OAAO,EAAE,CAAC,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;IAC7B5S,KAAK,EAAE;EACX,CAAC,CAAC;EACFuB,SAAS,CAAC+M,sBAAsB,CAAC,cAAc,EAAE,IAAI,EAAE;IACnDsE,OAAO,EAAE,CAAC,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IAC9B5S,KAAK,EAAE;EACX,CAAC,CAAC;EACFuB,SAAS,CAAC+M,sBAAsB,CAAC,cAAc,EAAE,IAAI,EAAE;IACnDsE,OAAO,EAAE,CAAC,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IAC9B5S,KAAK,EAAE;EACX,CAAC,CAAC;EAEF,SAASsxD,aAAa,GAAG;IACrB,IAAI,CAAC32C,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACY,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC;IACjC,IAAI,CAACA,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC;IAClC,IAAI,CAACqH,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC;IACxB,IAAI,CAACA,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC;IACxB,IAAI,CAACA,WAAW,CAAC,IAAI,EAAE,GAAG,EAAE,MAAM,EAAE;MAAE0B,MAAM,EAAEgtC,aAAa,CAAChtC;IAAO,CAAC,CAAC;IAC3E,IAAI,CAACD,SAAS,CAAC,OAAO,EAAC,OAAO,EAAC,IAAI,CAAC7Z,UAAU,CAACq8C,EAAE,EAAC;MAAErnC,QAAQ,EAAE,IAAI;MAAE8E,MAAM,EAAEgtC,aAAa,CAAChtC;IAAO,CAAC,CAAE;IAE9F,IAAI,CAACtY,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEAslD,aAAa,CAAChtC,MAAM,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAE;EACtEgtC,aAAa,CAAC,KAAK,CAAC,GAAG;IACnB7pD,IAAI,EAAE,MAAM;IACZzH,KAAK,EAAE,WAAW;IAClBskB,MAAM,EAAEgtC,aAAa,CAAChtC;EAC1B,CAAC;EAEDgtC,aAAa,CAACtxD,KAAK,GAAG,WAAW;EACjCsxD,aAAa,CAACpmD,IAAI,GAAG,qCAAqC;EAE1DomD,aAAa,CAACxxD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IAC1C,OAAO,IAAI,GAAG,IAAI,CAACxV,UAAU,CAACq8C,EAAE,GAAG,IAAI;EAC3C,CAAC;EAEDyK,aAAa,CAACxxD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC3C,IAAI8K,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI6K,CAAC,KAAK4B,SAAS,EAAE;MACjB5B,CAAC,GAAG,IAAI,CAACzL,UAAU,CAACyL,CAAC;IACzB,CAAC,MAAM;MACH,IAAI,CAACzL,UAAU,CAACyL,CAAC,GAAGA,CAAC;IACzB;IAEA,IAAIC,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8K,CAAC,KAAK2B,SAAS,EAAE;MACjB3B,CAAC,GAAG,IAAI,CAAC1L,UAAU,CAAC0L,CAAC;IACzB,CAAC,MAAM;MACH,IAAI,CAAC1L,UAAU,CAAC0L,CAAC,GAAGA,CAAC;IACzB;IAEA,IAAItJ,MAAM,GAAG,IAAI;IACjB,QAAQ,IAAI,CAACpC,UAAU,CAACq8C,EAAE;MACtB,KAAK,GAAG;QACJj6C,MAAM,GAAGqJ,CAAC,GAAGC,CAAC;QACd;MACJ,KAAK,GAAG;QACJtJ,MAAM,GAAGqJ,CAAC,GAAGC,CAAC;QACd;MACJ,KAAK,IAAI;QACLtJ,MAAM,GAAGqJ,CAAC,IAAIC,CAAC;QACf;MACJ,KAAK,IAAI;QACLtJ,MAAM,GAAGqJ,CAAC,IAAIC,CAAC;QACf;MACJ,KAAK,IAAI;QACLtJ,MAAM,GAAGqJ,CAAC,IAAIC,CAAC;QACf;MACJ,KAAK,IAAI;QACLtJ,MAAM,GAAGqJ,CAAC,IAAIC,CAAC;QACf;MACJ,KAAK,IAAI;QACLtJ,MAAM,GAAGqJ,CAAC,IAAIC,CAAC;QACf;MACJ,KAAK,IAAI;QACLtJ,MAAM,GAAGqJ,CAAC,IAAIC,CAAC;QACf;IAAM;IAGd,IAAI,CAAC5K,aAAa,CAAC,CAAC,EAAEsB,MAAM,CAAC;IAC7B,IAAI,CAACtB,aAAa,CAAC,CAAC,EAAE,CAACsB,MAAM,CAAC;EAClC,CAAC;EAEDrL,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAE8pD,aAAa,CAAC;EAG3D,SAASC,UAAU,GAAG;IAClB,IAAI,CAAC52C,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC;IACtB,IAAI,CAACA,QAAQ,CAAC,MAAM,EAAE,SAAS,CAAC;IAChC,IAAI,CAACY,SAAS,CAAC,MAAM,EAAE,CAAC,CAAC;IACzB,IAAI,CAACA,SAAS,CAAC,OAAO,EAAE,CAAC,CAAC;IAC1B,IAAI,CAACvP,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEAulD,UAAU,CAACvxD,KAAK,GAAG,QAAQ;EAC3BuxD,UAAU,CAACrmD,IAAI,GAAG,8DAA8D;EAEhFqmD,UAAU,CAACzxD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAIqmD,CAAC,GAAG,IAAI,CAACpmD,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAIqmD,IAAI,GAAG,IAAI,CAACrmD,YAAY,CAAC,CAAC,CAAC;IAErC,IAAGqmD,IAAI,EACP;MACC,IAAI,CAACnmD,aAAa,CAAC,CAAC,EAAEkmD,CAAC,CAAC;MACxB,IAAI,CAAClmD,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC;IAC5B,CAAC,MAED;MACC,IAAI,CAACA,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC;MAC3B,IAAI,CAACA,aAAa,CAAC,CAAC,EAAEkmD,CAAC,CAAC;IACzB;EACD,CAAC;EAEEjwD,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAE+pD,UAAU,CAAC;EAGrD,SAASG,cAAc,GAAG;IACtB,IAAI,CAAC/2C,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC9B,IAAI,CAACY,SAAS,CAAC,OAAO,EAAE,QAAQ,CAAC;IACjC,IAAI,CAACqH,WAAW,CAAC,WAAW,EAAE,CAAC,CAAC;IAChC,IAAI,CAACA,WAAW,CAAC,OAAO,EAAE,CAAC,CAAC;EAChC;EAEA8uC,cAAc,CAAC1xD,KAAK,GAAG,YAAY;EACnC0xD,cAAc,CAACxmD,IAAI,GAAG,+BAA+B;EAErDwmD,cAAc,CAAC5xD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAI,IAAI,CAACX,UAAU,CAACoQ,KAAK,KAAK,IAAI,EAAE;MAChC,IAAI,CAACpQ,UAAU,CAACoQ,KAAK,GAAG,CAAC;IAC7B;IAEA,IAAI+2C,GAAG,GAAG,IAAI,CAACvmD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAIumD,GAAG,KAAK,IAAI,EAAE;MACd,IAAI,CAACnnD,UAAU,CAACoQ,KAAK,IAAI+2C,GAAG;IAChC,CAAC,MAAM;MACH,IAAI,CAACnnD,UAAU,CAACoQ,KAAK,IAAI,IAAI,CAACpQ,UAAU,CAAConD,SAAS;IACtD;IACA,IAAI,CAACtmD,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAACoQ,KAAK,CAAC;EAChD,CAAC;EAEDrZ,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAEkqD,cAAc,CAAC;;EAE7D;EACA,SAASG,gBAAgB,GAAG;IACxB,IAAI,CAACl3C,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAE/B,IAAI,CAACqH,WAAW,CAAC,WAAW,EAAE,CAAC,CAAC;IAChC,IAAI,CAACA,WAAW,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC7B,IAAI,CAACkvC,UAAU,GAAG,yBAAyB;EAC/C;EAEAD,gBAAgB,CAAC7xD,KAAK,GAAG,cAAc;EACvC6xD,gBAAgB,CAAC3mD,IAAI,GAAG,aAAa;EACrC;;EAEA2mD,gBAAgB,CAAC/xD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC9C,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,CAAC;IACT;IACA,IAAIqpD,SAAS,GAAG,IAAI,CAACvnD,UAAU,CAAC,WAAW,CAAC;IAC5C,IAAImO,IAAI,GAAG,IAAI,CAAC+H,aAAa,CAAC,WAAW,CAAC;IAC1C,IAAI/H,IAAI,IAAI,CAAC,CAAC,EAAE;MACZo5C,SAAS,GAAG,IAAI,CAAC3mD,YAAY,CAACuN,IAAI,CAAC;IACvC;IACA,IAAIgP,MAAM,GAAG,IAAI,CAACnd,UAAU,CAAC,QAAQ,CAAC;IACtCmO,IAAI,GAAG,IAAI,CAAC+H,aAAa,CAAC,QAAQ,CAAC;IACnC,IAAI/H,IAAI,IAAI,CAAC,CAAC,EAAE;MACZgP,MAAM,GAAG,IAAI,CAACvc,YAAY,CAACuN,IAAI,CAAC;IACpC;IAEA,KAAK,IAAIjZ,CAAC,GAAG,CAAC,EAAE2V,CAAC,GAAG,IAAI,CAACzC,OAAO,CAAC5T,MAAM,EAAEU,CAAC,GAAG2V,CAAC,EAAE,EAAE3V,CAAC,EAAE;MACjD,IAAIiW,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAClT,CAAC,CAAC;MAC5B,IAAIkb,KAAK;MACT,QAAQjF,MAAM,CAAC3U,IAAI;QACf,KAAK,KAAK;UACN4Z,KAAK,GAAGqH,IAAI,CAACmoC,GAAG,CAAC1hD,CAAC,CAAC;UACnB;QACJ,KAAK,KAAK;UACNkS,KAAK,GAAGqH,IAAI,CAACkoC,GAAG,CAACzhD,CAAC,CAAC;UACnB;QACJ,KAAK,KAAK;UACNkS,KAAK,GAAGqH,IAAI,CAAC+vC,GAAG,CAACtpD,CAAC,CAAC;UACnB;QACJ,KAAK,MAAM;UACPkS,KAAK,GAAGqH,IAAI,CAACgwC,IAAI,CAACvpD,CAAC,CAAC;UACpB;QACJ,KAAK,MAAM;UACPkS,KAAK,GAAGqH,IAAI,CAACiwC,IAAI,CAACxpD,CAAC,CAAC;UACpB;QACJ,KAAK,MAAM;UACPkS,KAAK,GAAGqH,IAAI,CAACkwC,IAAI,CAACzpD,CAAC,CAAC;UACpB;MAAM;MAEd,IAAI,CAAC4C,aAAa,CAAC5L,CAAC,EAAEqyD,SAAS,GAAGn3C,KAAK,GAAG+M,MAAM,CAAC;IACrD;EACJ,CAAC;EAEDkqC,gBAAgB,CAAC/xD,SAAS,CAACovC,WAAW,GAAG,YAAW;IAChD,OAAO,CAAC,CAAC,GAAG,EAAE,QAAQ,CAAC,EAAE,CAAC,WAAW,EAAE,QAAQ,CAAC,EAAE,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;EAC3E,CAAC;EAED2iB,gBAAgB,CAAC/xD,SAAS,CAAC2vC,YAAY,GAAG,YAAW;IACjD,OAAO,CACH,CAAC,KAAK,EAAE,QAAQ,CAAC,EACjB,CAAC,KAAK,EAAE,QAAQ,CAAC,EACjB,CAAC,KAAK,EAAE,QAAQ,CAAC,EACjB,CAAC,MAAM,EAAE,QAAQ,CAAC,EAClB,CAAC,MAAM,EAAE,QAAQ,CAAC,EAClB,CAAC,MAAM,EAAE,QAAQ,CAAC,CACrB;EACL,CAAC;EAEDluC,SAAS,CAACiG,gBAAgB,CAAC,mBAAmB,EAAEqqD,gBAAgB,CAAC;EAEjEtwD,SAAS,CAAC+M,sBAAsB,CAAC,mBAAmB,EAAE,OAAO,EAAE;IAC3DsE,OAAO,EAAE,CAAC,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;IAC5B5S,KAAK,EAAE;EACX,CAAC,CAAC;EACFuB,SAAS,CAAC+M,sBAAsB,CAAC,mBAAmB,EAAE,OAAO,EAAE;IAC3DsE,OAAO,EAAE,CAAC,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;IAC5B5S,KAAK,EAAE;EACX,CAAC,CAAC;EACFuB,SAAS,CAAC+M,sBAAsB,CAAC,mBAAmB,EAAE,OAAO,EAAE;IAC3DsE,OAAO,EAAE,CAAC,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;IAC5B5S,KAAK,EAAE;EACX,CAAC,CAAC;;EAEF;EACA,SAASoyD,WAAW,GAAG;IACnB,IAAI,CAACz3C,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACY,SAAS,CAAC,EAAE,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAAC/Q,UAAU,GAAG;MAAE0M,CAAC,EAAE,GAAG;MAAEG,CAAC,EAAE,GAAG;MAAEg7C,OAAO,EAAE;IAAM,CAAC;IACpD,IAAI,CAACC,WAAW,GAAG,IAAI,CAACjuC,SAAS,CAC7B,MAAM,EACN,QAAQ,EACR,IAAI,CAAC7Z,UAAU,CAAC6nD,OAAO,EACvB,UAAS3pD,CAAC,EAAEoQ,MAAM,EAAEnN,IAAI,EAAE;MACtBA,IAAI,CAACnB,UAAU,CAAC6nD,OAAO,GAAG3pD,CAAC;IAC/B,CAAC,CACJ;IACD,IAAI,CAAC2b,SAAS,CAAC,QAAQ,EAAE,OAAO,EAAE9iB,SAAS,CAACoE,aAAa,EAAE,UAAS+C,CAAC,EAAE;MACnEnH,SAAS,CAACoE,aAAa,GAAG+C,CAAC;IAC/B,CAAC,CAAC;IACF,IAAI,CAAC89C,KAAK,GAAG,IAAI;EACrB;EAEA4L,WAAW,CAACpyD,KAAK,GAAG,SAAS;EAC7BoyD,WAAW,CAAClnD,IAAI,GAAG,iBAAiB;EACpCknD,WAAW,CAACpmD,IAAI,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC;EAE7B6kD,iBAAiB,CAAC/wD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAClE,IAAI5Z,IAAI,IAAI,SAAS,EAAE;MACnB,IAAI,CAACsxD,WAAW,CAAC13C,KAAK,GAAGA,KAAK;IAClC;EACJ,CAAC;EAEDw3C,WAAW,CAACtyD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACzC,IAAI,CAAC5J,SAAS,CAACoE,aAAa,EAAE;MAC1B;IACJ;IAEA,IAAIuR,CAAC,GAAG,IAAI,CAAC9L,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAIiM,CAAC,GAAG,IAAI,CAACjM,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8L,CAAC,IAAI,IAAI,EAAE;MACX,IAAI,CAAC1M,UAAU,CAAC,GAAG,CAAC,GAAG0M,CAAC;IAC5B,CAAC,MAAM;MACHA,CAAC,GAAG,IAAI,CAAC1M,UAAU,CAAC,GAAG,CAAC;IAC5B;IAEA,IAAI6M,CAAC,IAAI,IAAI,EAAE;MACX,IAAI,CAAC7M,UAAU,CAAC,GAAG,CAAC,GAAG6M,CAAC;IAC5B,CAAC,MAAM;MACHA,CAAC,GAAG,IAAI,CAAC7M,UAAU,CAAC,GAAG,CAAC;IAC5B;IAEA,IAAIu+B,CAAC,GAAG,IAAI,CAACv+B,UAAU,CAAC,SAAS,CAAC;IAElC,IAAIoQ,KAAK;IACT,IAAI;MACA,IAAI,CAAC,IAAI,CAAC4rC,KAAK,IAAI,IAAI,CAAC+L,UAAU,IAAI,IAAI,CAAC/nD,UAAU,CAAC6nD,OAAO,EAAE;QAC3D,IAAI,CAAC7L,KAAK,GAAG,IAAIx7C,QAAQ,CACrB,GAAG,EACH,GAAG,EACH,MAAM,EACN,SAAS,GAAG,IAAI,CAACR,UAAU,CAAC6nD,OAAO,CACtC;QACD,IAAI,CAACE,UAAU,GAAG,IAAI,CAAC/nD,UAAU,CAAC6nD,OAAO;MAC7C;MACAz3C,KAAK,GAAG,IAAI,CAAC4rC,KAAK,CAACtvC,CAAC,EAAEG,CAAC,EAAE,IAAI,CAACnE,KAAK,CAAClB,UAAU,CAAC;MAC/C,IAAI,CAAC4N,QAAQ,GAAG,IAAI;IACxB,CAAC,CAAC,OAAOhU,GAAG,EAAE;MACV,IAAI,CAACgU,QAAQ,GAAG,KAAK;IACzB;IACA,IAAI,CAACtU,aAAa,CAAC,CAAC,EAAEsP,KAAK,CAAC;EAChC,CAAC;EAEDw3C,WAAW,CAACtyD,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IACxC,OAAO,IAAI,CAACuyC,UAAU,IAAI,SAAS;EACvC,CAAC;EAEDH,WAAW,CAACtyD,SAAS,CAAC2wB,gBAAgB,GAAG,YAAW;IAChD,IAAIsY,CAAC,GAAG,IAAI,CAACv+B,UAAU,CAAC,SAAS,CAAC;IAClC,IAAI,IAAI,CAACoI,OAAO,IAAI,IAAI,CAACA,OAAO,CAAC5T,MAAM,EAAE;MACrC,IAAI,CAAC4T,OAAO,CAAC,CAAC,CAAC,CAAC8Q,KAAK,GAAGqlB,CAAC;IAC7B;EACJ,CAAC;EAEDxnC,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAE4qD,WAAW,CAAC;EAEvD,SAASI,cAAc,GAAG;IACtB,IAAI,CAAC73C,QAAQ,CAAC,MAAM,EAAE,MAAM,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACA,SAAS,CAAC,GAAG,EAAE,QAAQ,CAAC;EACjC;EAEAi3C,cAAc,CAACxyD,KAAK,GAAG,UAAU;EACjCwyD,cAAc,CAACtnD,IAAI,GAAG,wBAAwB;EAE9CsnD,cAAc,CAAC1yD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IAEA,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC,CAAC,CAAC,CAAC;EAC/B,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,mBAAmB,EAAEgrD,cAAc,CAAC;EAE/D,SAASC,cAAc,GAAG;IACtB,IAAI,CAACzvC,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE,QAAQ,CAAC,EAAE,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC,CAAC;IAClD,IAAI,CAACzH,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC;IAC9B,IAAI,CAAC/Q,UAAU,GAAG;MAAE0M,CAAC,EAAE,CAAC;MAAEG,CAAC,EAAE;IAAE,CAAC;IAChC,IAAI,CAACyH,KAAK,GAAG,IAAIE,YAAY,CAAC,CAAC,CAAC;EACpC;EAEAyzC,cAAc,CAACzyD,KAAK,GAAG,UAAU;EACjCyyD,cAAc,CAACvnD,IAAI,GAAG,uBAAuB;EAE7CunD,cAAc,CAAC3yD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAI+L,CAAC,GAAG,IAAI,CAAC9L,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8L,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,IAAI,CAAC1M,UAAU,CAAC0M,CAAC;IACzB;IACA,IAAIG,CAAC,GAAG,IAAI,CAACjM,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAIiM,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,IAAI,CAAC7M,UAAU,CAAC6M,CAAC;IACzB;IAEA,IAAI5I,IAAI,GAAG,IAAI,CAACqQ,KAAK;IACrBrQ,IAAI,CAAC,CAAC,CAAC,GAAGyI,CAAC;IACXzI,IAAI,CAAC,CAAC,CAAC,GAAG4I,CAAC;IAEX,IAAI,CAAC/L,aAAa,CAAC,CAAC,EAAEmD,IAAI,CAAC;EAC/B,CAAC;EAEDlN,SAAS,CAACiG,gBAAgB,CAAC,mBAAmB,EAAEirD,cAAc,CAAC;EAE/D,SAASC,eAAe,GAAG;IACvB,IAAI,CAAC/3C,QAAQ,CAAC,MAAM,EAAE,MAAM,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACA,SAAS,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACA,SAAS,CAAC,GAAG,EAAE,QAAQ,CAAC;EACjC;EAEAm3C,eAAe,CAAC1yD,KAAK,GAAG,WAAW;EACnC0yD,eAAe,CAACxnD,IAAI,GAAG,wBAAwB;EAE/CwnD,eAAe,CAAC5yD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC7C,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IAEA,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC,CAAC,CAAC,CAAC;EAC/B,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,oBAAoB,EAAEkrD,eAAe,CAAC;EAEjE,SAASC,eAAe,GAAG;IACvB,IAAI,CAAC3vC,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE,QAAQ,CAAC,EAAE,CAAC,GAAG,EAAE,QAAQ,CAAC,EAAE,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC,CAAC;IACnE,IAAI,CAACzH,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC;IAC9B,IAAI,CAAC/Q,UAAU,GAAG;MAAE0M,CAAC,EAAE,CAAC;MAAEG,CAAC,EAAE,CAAC;MAAEu7C,CAAC,EAAE;IAAE,CAAC;IACtC,IAAI,CAAC9zC,KAAK,GAAG,IAAIE,YAAY,CAAC,CAAC,CAAC;EACpC;EAEA2zC,eAAe,CAAC3yD,KAAK,GAAG,WAAW;EACnC2yD,eAAe,CAACznD,IAAI,GAAG,uBAAuB;EAE9CynD,eAAe,CAAC7yD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC7C,IAAI+L,CAAC,GAAG,IAAI,CAAC9L,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8L,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,IAAI,CAAC1M,UAAU,CAAC0M,CAAC;IACzB;IACA,IAAIG,CAAC,GAAG,IAAI,CAACjM,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAIiM,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,IAAI,CAAC7M,UAAU,CAAC6M,CAAC;IACzB;IACA,IAAIu7C,CAAC,GAAG,IAAI,CAACxnD,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAIwnD,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,IAAI,CAACpoD,UAAU,CAACooD,CAAC;IACzB;IAEA,IAAInkD,IAAI,GAAG,IAAI,CAACqQ,KAAK;IACrBrQ,IAAI,CAAC,CAAC,CAAC,GAAGyI,CAAC;IACXzI,IAAI,CAAC,CAAC,CAAC,GAAG4I,CAAC;IACX5I,IAAI,CAAC,CAAC,CAAC,GAAGmkD,CAAC;IAEX,IAAI,CAACtnD,aAAa,CAAC,CAAC,EAAEmD,IAAI,CAAC;EAC/B,CAAC;EAEDlN,SAAS,CAACiG,gBAAgB,CAAC,oBAAoB,EAAEmrD,eAAe,CAAC;EAEjE,SAASE,gBAAgB,GAAG;IACxB,IAAI,CAACl4C,QAAQ,CAAC,MAAM,EAAE,MAAM,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACA,SAAS,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACA,SAAS,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC7B,IAAI,CAACA,SAAS,CAAC,GAAG,EAAE,QAAQ,CAAC;EACjC;EAEAs3C,gBAAgB,CAAC7yD,KAAK,GAAG,YAAY;EACrC6yD,gBAAgB,CAAC3nD,IAAI,GAAG,wBAAwB;EAEhD2nD,gBAAgB,CAAC/yD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC9C,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IAEA,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC,CAAC,CAAC,CAAC;EAC/B,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,qBAAqB,EAAEqrD,gBAAgB,CAAC;EAEnE,SAASC,gBAAgB,GAAG;IACxB,IAAI,CAAC9vC,SAAS,CAAC,CACX,CAAC,GAAG,EAAE,QAAQ,CAAC,EACf,CAAC,GAAG,EAAE,QAAQ,CAAC,EACf,CAAC,GAAG,EAAE,QAAQ,CAAC,EACf,CAAC,GAAG,EAAE,QAAQ,CAAC,CAClB,CAAC;IACF,IAAI,CAACzH,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC;IAC9B,IAAI,CAAC/Q,UAAU,GAAG;MAAE0M,CAAC,EAAE,CAAC;MAAEG,CAAC,EAAE,CAAC;MAAEu7C,CAAC,EAAE,CAAC;MAAErzC,CAAC,EAAE;IAAE,CAAC;IAC5C,IAAI,CAACT,KAAK,GAAG,IAAIE,YAAY,CAAC,CAAC,CAAC;EACpC;EAEA8zC,gBAAgB,CAAC9yD,KAAK,GAAG,YAAY;EACrC8yD,gBAAgB,CAAC5nD,IAAI,GAAG,uBAAuB;EAE/C4nD,gBAAgB,CAAChzD,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC9C,IAAI+L,CAAC,GAAG,IAAI,CAAC9L,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8L,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,IAAI,CAAC1M,UAAU,CAAC0M,CAAC;IACzB;IACA,IAAIG,CAAC,GAAG,IAAI,CAACjM,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAIiM,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,IAAI,CAAC7M,UAAU,CAAC6M,CAAC;IACzB;IACA,IAAIu7C,CAAC,GAAG,IAAI,CAACxnD,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAIwnD,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,IAAI,CAACpoD,UAAU,CAACooD,CAAC;IACzB;IACA,IAAIrzC,CAAC,GAAG,IAAI,CAACnU,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAImU,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,IAAI,CAAC/U,UAAU,CAAC+U,CAAC;IACzB;IAEA,IAAI9Q,IAAI,GAAG,IAAI,CAACqQ,KAAK;IACrBrQ,IAAI,CAAC,CAAC,CAAC,GAAGyI,CAAC;IACXzI,IAAI,CAAC,CAAC,CAAC,GAAG4I,CAAC;IACX5I,IAAI,CAAC,CAAC,CAAC,GAAGmkD,CAAC;IACXnkD,IAAI,CAAC,CAAC,CAAC,GAAG8Q,CAAC;IAEX,IAAI,CAACjU,aAAa,CAAC,CAAC,EAAEmD,IAAI,CAAC;EAC/B,CAAC;EAEDlN,SAAS,CAACiG,gBAAgB,CAAC,qBAAqB,EAAEsrD,gBAAgB,CAAC;AAEvE,CAAC,EAAE,IAAI,CAAC;AAER,CAAC,UAASxxD,MAAM,EAAE;EACd,IAAIC,SAAS,GAAGD,MAAM,CAACC,SAAS;EAGnC,SAASwxD,UAAU,GACnB;IACO,IAAI,CAACp4C,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC;IAC1B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC;IAC1B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC;IAC1B,IAAI,CAACY,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC;IACpC,IAAI,CAAC/Q,UAAU,GAAG;MACjB,GAAG,EAAC,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;MACX,GAAG,EAAC,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;MACX,GAAG,EAAC,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;MACXwoD,YAAY,EAAE;IACf,CAAC;IACD,IAAI,CAAC7N,OAAO,GAAG8N,IAAI,CAACC,MAAM,EAAE;IAC5B,IAAI,CAACC,YAAY,GAAG,IAAI;EACzB;EAEAJ,UAAU,CAAC/yD,KAAK,GAAG,MAAM;EACzB+yD,UAAU,CAACK,SAAS,GAAG,IAAIp0C,YAAY,CAAC,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC,CAAC;EAClD+zC,UAAU,CAACM,SAAS,GAAG,IAAIr0C,YAAY,CAAC,EAAE,CAAC;EAC3C+zC,UAAU,CAACO,SAAS,GAAG,IAAIt0C,YAAY,CAAC,CAAC,CAAC;EAE1C+zC,UAAU,CAACjzD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAC7D;IACC,IAAI,CAACu4C,YAAY,GAAG,IAAI;EACzB,CAAC;EAEDJ,UAAU,CAACjzD,SAAS,CAACqL,SAAS,GAAG,YACjC;IACC,IAAI+J,CAAC,GAAG,IAAI,CAACiwC,OAAO;IACpB,IAAIoO,CAAC,GAAGR,UAAU,CAACK,SAAS;IAC5B,IAAIC,SAAS,GAAGN,UAAU,CAACM,SAAS;IACpC,IAAIC,SAAS,GAAGP,UAAU,CAACO,SAAS;IAEpC,IAAIE,CAAC,GAAG,IAAI,CAACpoD,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAIqoD,CAAC,GAAG,IAAI,CAACroD,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI6J,CAAC,GAAG,IAAI,CAAC7J,YAAY,CAAC,CAAC,CAAC;IAE5B,IAAI,IAAI,CAAC+nD,YAAY,IAAIK,CAAC,IAAIC,CAAC,IAAIx+C,CAAC,EACpC;MACCu+C,CAAC,GAAGA,CAAC,IAAI,IAAI,CAAChpD,UAAU,CAACgpD,CAAC;MAC1BC,CAAC,GAAGA,CAAC,IAAI,IAAI,CAACjpD,UAAU,CAACipD,CAAC;MAC1Bx+C,CAAC,GAAGA,CAAC,IAAI,IAAI,CAACzK,UAAU,CAACyK,CAAC;MAC1Bg+C,IAAI,CAACS,QAAQ,CAAEx+C,CAAC,CAAE;MAClB+9C,IAAI,CAACnmC,SAAS,CAAE5X,CAAC,EAAEA,CAAC,EAAEs+C,CAAC,CAAE;MACzB,IAAG,IAAI,CAAChpD,UAAU,CAACwoD,YAAY,EAC/B;QACCM,SAAS,CAAC7qD,GAAG,CAAEgrD,CAAC,CAAE;QAClBE,IAAI,CAAC5qC,KAAK,CAACuqC,SAAS,EAACA,SAAS,EAACM,OAAO,CAAC;QACvCC,IAAI,CAACC,SAAS,CAAEP,CAAC,EAAED,SAAS,CAAE;MAC/B,CAAC,MAEAO,IAAI,CAACC,SAAS,CAAEP,CAAC,EAAEE,CAAC,CAAE;MACvBR,IAAI,CAACc,QAAQ,CAAEV,SAAS,EAAEE,CAAC,CAAE;MAC7BN,IAAI,CAACe,QAAQ,CAAE9+C,CAAC,EAAEA,CAAC,EAAEm+C,SAAS,CAAE;MAChCJ,IAAI,CAAClqC,KAAK,CAAE7T,CAAC,EAAEA,CAAC,EAAED,CAAC,CAAE;IACtB;IAEA,IAAI,CAAC3J,aAAa,CAAC,CAAC,EAAE4J,CAAC,CAAC;EACzB,CAAC;EAEE3T,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAEurD,UAAU,CAAC;;EAErD;EACA,SAASkB,eAAe,GAAG;IACvB,IAAI,CAACt5C,QAAQ,CAAC,GAAG,EAAE,aAAa,CAAC;IACjC,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,aAAa,CAAC;IACjC,IAAI,CAACY,SAAS,CAAC,GAAG,EAAE,aAAa,CAAC;IAClC,IAAI,CAACqH,WAAW,CAAC,IAAI,EAAE,GAAG,EAAE,MAAM,EAAE;MAAE0B,MAAM,EAAE2vC,eAAe,CAAC3vC;IAAO,CAAC,CAAC;IAC7E,IAAI,CAAC6gC,OAAO,GAAGwO,IAAI,CAACT,MAAM,EAAE;EAC1B;EAEAe,eAAe,CAAC3vC,MAAM,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAC,KAAK,EAAC,OAAO,CAAC;EAEnF/iB,SAAS,CAAC+M,sBAAsB,CAAC,kBAAkB,EAAE,SAAS,EAAE;IAC5D9D,UAAU,EAAE;MAAC,IAAI,EAAC;IAAO,CAAC;IAC1BxK,KAAK,EAAE;EACX,CAAC,CAAC;EAEFuB,SAAS,CAAC+M,sBAAsB,CAAC,kBAAkB,EAAE,OAAO,EAAE;IAC1D9D,UAAU,EAAE;MAAC,IAAI,EAAC;IAAK,CAAC;IACxBxK,KAAK,EAAE;EACX,CAAC,CAAC;EAELi0D,eAAe,CAACj0D,KAAK,GAAG,WAAW;EAChCi0D,eAAe,CAAC/oD,IAAI,GAAG,wBAAwB;EAC/C+oD,eAAe,CAAC,KAAK,CAAC,GAAG;IACrBxsD,IAAI,EAAE,MAAM;IACZzH,KAAK,EAAE,WAAW;IAClBskB,MAAM,EAAE2vC,eAAe,CAAC3vC;EAC5B,CAAC;EACD2vC,eAAe,CAACjoD,IAAI,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC;EAEhCioD,eAAe,CAACn0D,SAAS,CAACkgB,QAAQ,GAAG,YAAW;IAClD,IAAG,IAAI,CAACxV,UAAU,CAACq8C,EAAE,IAAI,KAAK,IAAI,IAAI,CAACr8C,UAAU,CAACq8C,EAAE,IAAI,KAAK,EAC5D,OAAO,IAAI,CAACr8C,UAAU,CAACq8C,EAAE,GAAG,OAAO;IAC9B,OAAO,IAAI,GAAG,IAAI,CAACr8C,UAAU,CAACq8C,EAAE,GAAG,IAAI;EAC3C,CAAC;EAEDoN,eAAe,CAACn0D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC7C,IAAI8K,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8K,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;IAClC,IAAG6K,CAAC,IAAI,IAAI,IAAIC,CAAC,IAAI,IAAI,EACxB;IACD,IAAGD,CAAC,CAAC9M,WAAW,KAAKwd,MAAM,EAC1B1Q,CAAC,GAAG,CAACA,CAAC,EAACA,CAAC,EAACA,CAAC,CAAC;IACZ,IAAGC,CAAC,CAAC/M,WAAW,KAAKwd,MAAM,EAC1BzQ,CAAC,GAAG,CAACA,CAAC,EAACA,CAAC,EAACA,CAAC,CAAC;IAEN,IAAItJ,MAAM,GAAG,IAAI,CAACu4C,OAAO;IACzB,QAAQ,IAAI,CAAC36C,UAAU,CAACq8C,EAAE;MACtB,KAAK,GAAG;QACJj6C,MAAM,GAAG+mD,IAAI,CAAC37C,GAAG,CAACpL,MAAM,EAACqJ,CAAC,EAACC,CAAC,CAAC;QAC7B;MACJ,KAAK,GAAG;QACJtJ,MAAM,GAAG+mD,IAAI,CAACO,GAAG,CAACtnD,MAAM,EAACqJ,CAAC,EAACC,CAAC,CAAC;QAC7B;MACJ,KAAK,GAAG;MACR,KAAK,GAAG;MACR,KAAK,GAAG;QACJtJ,MAAM,GAAG+mD,IAAI,CAACQ,GAAG,CAACvnD,MAAM,EAACqJ,CAAC,EAACC,CAAC,CAAC;QAC7B;MACJ,KAAK,GAAG;QACJtJ,MAAM,GAAG+mD,IAAI,CAACS,GAAG,CAACxnD,MAAM,EAACqJ,CAAC,EAACC,CAAC,CAAC;QAC7B;MACJ,KAAK,GAAG;QACJtJ,MAAM,CAAC,CAAC,CAAC,GAAGqJ,CAAC,CAAC,CAAC,CAAC,GAACC,CAAC,CAAC,CAAC,CAAC;QACrBtJ,MAAM,CAAC,CAAC,CAAC,GAAGqJ,CAAC,CAAC,CAAC,CAAC,GAACC,CAAC,CAAC,CAAC,CAAC;QACrBtJ,MAAM,CAAC,CAAC,CAAC,GAAGqJ,CAAC,CAAC,CAAC,CAAC,GAACC,CAAC,CAAC,CAAC,CAAC;QACrB;MACJ,KAAK,GAAG;QACJtJ,MAAM,CAAC,CAAC,CAAC,GAAGqV,IAAI,CAACytC,GAAG,CAACz5C,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/BtJ,MAAM,CAAC,CAAC,CAAC,GAAGqV,IAAI,CAACytC,GAAG,CAACz5C,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/BtJ,MAAM,CAAC,CAAC,CAAC,GAAGqV,IAAI,CAACytC,GAAG,CAACz5C,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/B;MACJ,KAAK,KAAK;QACNtJ,MAAM,CAAC,CAAC,CAAC,GAAGqV,IAAI,CAACmB,GAAG,CAACnN,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/BtJ,MAAM,CAAC,CAAC,CAAC,GAAGqV,IAAI,CAACmB,GAAG,CAACnN,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/BtJ,MAAM,CAAC,CAAC,CAAC,GAAGqV,IAAI,CAACmB,GAAG,CAACnN,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/B;MACJ,KAAK,KAAK;QACNtJ,MAAM,CAAC,CAAC,CAAC,GAAGqV,IAAI,CAAC4jB,GAAG,CAAC5vB,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/BtJ,MAAM,CAAC,CAAC,CAAC,GAAGqV,IAAI,CAAC4jB,GAAG,CAAC5vB,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/BtJ,MAAM,CAAC,CAAC,CAAC,GAAGqV,IAAI,CAAC4jB,GAAG,CAAC5vB,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC;MACnC,KAAK,KAAK;QACNtJ,MAAM,GAAG+mD,IAAI,CAACU,GAAG,CAACp+C,CAAC,EAACC,CAAC,CAAC;QACtB;MACJ,KAAK,OAAO;QACRy9C,IAAI,CAACW,KAAK,CAAC1nD,MAAM,EAACqJ,CAAC,EAACC,CAAC,CAAC;QACtB;MACJ;QACIvO,OAAO,CAACqB,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAACwB,UAAU,CAACq8C,EAAE,CAAC;IAAC;IAEjE,IAAI,CAACv7C,aAAa,CAAC,CAAC,EAAEsB,MAAM,CAAC;EACjC,CAAC;EAEDqnD,eAAe,CAACn0D,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACvD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IAEAmI,GAAG,CAACtD,IAAI,GAAG,YAAY;IACvBsD,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACsW,SAAS,GAAG,QAAQ;IACxBtW,GAAG,CAACuW,QAAQ,CACR,IAAI,CAAC54B,UAAU,CAACq8C,EAAE,EAClB,IAAI,CAAC76C,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,EAClB,CAAC,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,GAAGzK,SAAS,CAACG,iBAAiB,IAAI,GAAG,CACrD;IACDmrB,GAAG,CAACsW,SAAS,GAAG,MAAM;EAC1B,CAAC;EAED5hC,SAAS,CAACiG,gBAAgB,CAAC,kBAAkB,EAAEysD,eAAe,CAAC;EAE/D,SAASM,eAAe,GAAG;IACvB,IAAI,CAAC55C,QAAQ,CAAC,IAAI,EAAE,MAAM,CAAC;IAC3B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC;IAC7B,IAAI,CAAC/Q,UAAU,GAAG;MAAEu+B,CAAC,EAAE;IAAE,CAAC;IAC1B,IAAI,CAACjqB,KAAK,GAAG,IAAIE,YAAY,CAAC,CAAC,CAAC;EACpC;EAEAu1C,eAAe,CAACv0D,KAAK,GAAG,YAAY;EACpCu0D,eAAe,CAACrpD,IAAI,GAAG,iCAAiC;EAExDqpD,eAAe,CAACz0D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC7C,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IACA,IAAIqgC,CAAC,GAAG,IAAI,CAAC39B,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI29B,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,IAAI,CAACv+B,UAAU,CAACu+B,CAAC;IACzB;IAEA,IAAIt6B,IAAI,GAAG,IAAI,CAACqQ,KAAK;IACrBrQ,IAAI,CAAC,CAAC,CAAC,GAAG/F,CAAC,CAAC,CAAC,CAAC,GAAGqgC,CAAC;IAClBt6B,IAAI,CAAC,CAAC,CAAC,GAAG/F,CAAC,CAAC,CAAC,CAAC,GAAGqgC,CAAC;IAClBt6B,IAAI,CAAC,CAAC,CAAC,GAAG/F,CAAC,CAAC,CAAC,CAAC,GAAGqgC,CAAC;IAClB,IAAI,CAACz9B,aAAa,CAAC,CAAC,EAAEmD,IAAI,CAAC;EAC/B,CAAC;EAEDlN,SAAS,CAACiG,gBAAgB,CAAC,mBAAmB,EAAE+sD,eAAe,CAAC;EAEhE,SAASC,gBAAgB,GAAG;IACxB,IAAI,CAAC75C,QAAQ,CAAC,IAAI,EAAE,MAAM,CAAC;IAC3B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;EACnC;EAEAi5C,gBAAgB,CAACx0D,KAAK,GAAG,aAAa;EACtCw0D,gBAAgB,CAACtpD,IAAI,GAAG,gCAAgC;EAExDspD,gBAAgB,CAAC10D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC9C,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IACA,IAAI6wB,IAAI,GAAGtX,IAAI,CAAC26B,IAAI,CAACl0C,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7D,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAEiuB,IAAI,CAAC;EAC/B,CAAC;EAEDh4B,SAAS,CAACiG,gBAAgB,CAAC,oBAAoB,EAAEgtD,gBAAgB,CAAC;EAElE,SAASC,mBAAmB,GAAG;IAC3B,IAAI,CAAC95C,QAAQ,CAAC,IAAI,EAAE,MAAM,CAAC;IAC3B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC;IAC7B,IAAI,CAACuD,KAAK,GAAG,IAAIE,YAAY,CAAC,CAAC,CAAC;EACpC;EAEAy1C,mBAAmB,CAACz0D,KAAK,GAAG,gBAAgB;EAC5Cy0D,mBAAmB,CAACvpD,IAAI,GAAG,+BAA+B;EAE1DupD,mBAAmB,CAAC30D,SAAS,CAACqL,SAAS,GAAG,YAAW;IACjD,IAAIzC,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI1C,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IACA,IAAI6wB,IAAI,GAAGtX,IAAI,CAAC26B,IAAI,CAACl0C,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7D,IAAI+F,IAAI,GAAG,IAAI,CAACqQ,KAAK;IACrBrQ,IAAI,CAAC,CAAC,CAAC,GAAG/F,CAAC,CAAC,CAAC,CAAC,GAAG6wB,IAAI;IACrB9qB,IAAI,CAAC,CAAC,CAAC,GAAG/F,CAAC,CAAC,CAAC,CAAC,GAAG6wB,IAAI;IACrB9qB,IAAI,CAAC,CAAC,CAAC,GAAG/F,CAAC,CAAC,CAAC,CAAC,GAAG6wB,IAAI;IAErB,IAAI,CAACjuB,aAAa,CAAC,CAAC,EAAEmD,IAAI,CAAC;EAC/B,CAAC;EAEDlN,SAAS,CAACiG,gBAAgB,CAAC,uBAAuB,EAAEitD,mBAAmB,CAAC;EAExE,SAASC,cAAc,GAAG;IACtB,IAAI,CAAC/5C,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC;IAC1B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC;IAC1B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC;IAC1B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC;IAC7B,IAAI,CAAC/Q,UAAU,GAAG;MAAEu+B,CAAC,EAAE;IAAI,CAAC;IAC5B,IAAI,CAACjqB,KAAK,GAAG,IAAIE,YAAY,CAAC,CAAC,CAAC;EACpC;EAEA01C,cAAc,CAAC10D,KAAK,GAAG,WAAW;EAClC00D,cAAc,CAACxpD,IAAI,GAAG,iCAAiC;EAEvDwpD,cAAc,CAAC50D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5C,IAAI8K,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI6K,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IACA,IAAIC,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8K,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IACA,IAAI6yB,CAAC,GAAG,IAAI,CAAChoB,kBAAkB,CAAC,GAAG,CAAC;IAEpC,IAAItS,IAAI,GAAG,IAAI,CAACqQ,KAAK;IACrBrQ,IAAI,CAAC,CAAC,CAAC,GAAGwH,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG8yB,CAAC,CAAC,GAAG7yB,CAAC,CAAC,CAAC,CAAC,GAAG6yB,CAAC;IACnCt6B,IAAI,CAAC,CAAC,CAAC,GAAGwH,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG8yB,CAAC,CAAC,GAAG7yB,CAAC,CAAC,CAAC,CAAC,GAAG6yB,CAAC;IACnCt6B,IAAI,CAAC,CAAC,CAAC,GAAGwH,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG8yB,CAAC,CAAC,GAAG7yB,CAAC,CAAC,CAAC,CAAC,GAAG6yB,CAAC;IAEnC,IAAI,CAACz9B,aAAa,CAAC,CAAC,EAAEmD,IAAI,CAAC;EAC/B,CAAC;EAEDlN,SAAS,CAACiG,gBAAgB,CAAC,kBAAkB,EAAEktD,cAAc,CAAC;EAE9D,SAASC,aAAa,GAAG;IACrB,IAAI,CAACh6C,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC;IAC1B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC;IAC1B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;EACnC;EAEAo5C,aAAa,CAAC30D,KAAK,GAAG,UAAU;EAChC20D,aAAa,CAACzpD,IAAI,GAAG,yBAAyB;EAE9CypD,aAAa,CAAC70D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC3C,IAAI8K,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI6K,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IACA,IAAIC,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8K,CAAC,IAAI,IAAI,EAAE;MACX;IACJ;IAEA,IAAIm+C,GAAG,GAAGp+C,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,GAAGD,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,GAAGD,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC;IACjD,IAAI,CAAC5K,aAAa,CAAC,CAAC,EAAE+oD,GAAG,CAAC;EAC9B,CAAC;EAED9yD,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAEmtD,aAAa,CAAC;;EAE5D;EACA,IAAIrzD,MAAM,CAACszD,QAAQ,EAAE;IAAA,IACRC,gBAAgB,GAAzB,SAASA,gBAAgB,GAAG;MACxB,IAAI,CAACt5C,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC;MAC9B,IAAI,CAAC/Q,UAAU,GAAG;QAAE0M,CAAC,EAAE,CAAC;QAAEG,CAAC,EAAE,CAAC;QAAEu7C,CAAC,EAAE,CAAC;QAAErzC,CAAC,EAAE,CAAC;QAAEu1C,SAAS,EAAE;MAAM,CAAC;MAC9D,IAAI,CAACjR,MAAM,GAAGgQ,IAAI,CAACX,MAAM,EAAE;IAC/B,CAAC;IAAA,IA2BQ6B,cAAc,GAAvB,SAASA,cAAc,GAAG;MACtB,IAAI,CAAC/xC,SAAS,CAAC,CAAC,CAAC,SAAS,EAAE,QAAQ,CAAC,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;MACzD,IAAI,CAACzH,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC;MAC9B,IAAI,CAAC/Q,UAAU,GAAG;QAAE0/C,KAAK,EAAE,IAAI;QAAE8K,IAAI,EAAErB,IAAI,CAACsB,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;MAAE,CAAC;MAEjE,IAAI,CAACpR,MAAM,GAAGgQ,IAAI,CAACX,MAAM,EAAE;IAC/B,CAAC;IAAA,IAsBQgC,eAAe,GAAxB,SAASA,eAAe,GAAG;MACvB,IAAI,CAACv6C,QAAQ,CAAC,OAAO,EAAE,MAAM,CAAC;MAC9B,IAAI,CAACY,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC;MAC9B,IAAI,CAAC/Q,UAAU,GAAG;QAAE2qD,KAAK,EAAC,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;QAAEC,kBAAkB,EAAE;MAAM,CAAC;MACvE,IAAI,CAACC,KAAK,GAAG1B,IAAI,CAACT,MAAM,EAAE;MACjB,IAAI,CAACrP,MAAM,GAAGgQ,IAAI,CAACX,MAAM,EAAE;IAC/B,CAAC;IAAA,IAmBQoC,eAAe,GAAxB,SAASA,eAAe,GAAG;MACvB,IAAI,CAAC36C,QAAQ,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;MAC/B,IAAI,CAACY,SAAS,CAAC,OAAO,EAAE,MAAM,CAAC;MACxC,IAAI,CAACsoC,MAAM,GAAG8P,IAAI,CAACT,MAAM,EAAE;IACtB,CAAC;IAiBD;IAAA,IACSqC,gBAAgB,GAAzB,SAASA,gBAAgB,GAAG;MACxB,IAAI,CAACvyC,SAAS,CAAC,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;MACpD,IAAI,CAACzH,SAAS,CAAC,QAAQ,EAAE,MAAM,CAAC;MAChC,IAAI,CAAC/Q,UAAU,GAAG;QAAEgrD,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;MAAE,CAAC;IACxC,CAAC;IAAA,IAuBQC,cAAc,GAAvB,SAASA,cAAc,GAAG;MACtB,IAAI,CAACzyC,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,EAAE,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC;MAC9C,IAAI,CAACzH,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC;MAE7B,IAAI,CAACsoC,MAAM,GAAGgQ,IAAI,CAACX,MAAM,EAAE;IAC/B,CAAC;IAAA,IAqBQwC,eAAe,GAAxB,SAASA,eAAe,GAAG;MACvB,IAAI,CAAC1yC,SAAS,CAAC,CACX,CAAC,GAAG,EAAE,MAAM,CAAC,EACb,CAAC,GAAG,EAAE,MAAM,CAAC,EACb,CAAC,QAAQ,EAAE,QAAQ,CAAC,CACvB,CAAC;MACF,IAAI,CAACzH,SAAS,CAAC,OAAO,EAAE,MAAM,CAAC;MAC/B,IAAI,CAACqH,WAAW,CAAC,QAAQ,EAAE,GAAG,CAAC;MAE/B,IAAI,CAACihC,MAAM,GAAGgQ,IAAI,CAACX,MAAM,EAAE;IAC/B,CAAC;IA0BD;IAAA,IACSyC,gBAAgB,GAAzB,SAASA,gBAAgB,GAAG;MACxB,IAAI,CAACh7C,QAAQ,CAAC,MAAM,EAAE,MAAM,CAAC;MAC7B,IAAI,CAACY,SAAS,CAAC,OAAO,EAAE,MAAM,CAAC;MACxC,IAAI,CAACA,SAAS,CAAC,SAAS,EAAE,MAAM,CAAC;MACxB,IAAI,CAAC/Q,UAAU,GAAG;QAAEwhC,KAAK,EAAE,IAAI;QAAE4pB,SAAS,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;QAAEC,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QAAEC,UAAU,EAAE,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC,EAAC,CAAC,CAAC;QAAEC,UAAU,EAAC,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC;MAAE,CAAC;MACnI,IAAI,CAAClS,MAAM,GAAG8P,IAAI,CAACT,MAAM,EAAE;MAC3B,IAAI,CAAC8C,QAAQ,GAAGrC,IAAI,CAACT,MAAM,EAAE;IACxB,CAAC;IArMD2B,gBAAgB,CAAC70D,KAAK,GAAG,YAAY;IACrC60D,gBAAgB,CAAC3pD,IAAI,GAAG,YAAY;IAEpC2pD,gBAAgB,CAAC/0D,SAAS,CAACqL,SAAS,GAAG,YAAW;MAC9C,IAAI,CAAC04C,MAAM,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9iC,kBAAkB,CAAC,GAAG,CAAC;MAC7C,IAAI,CAAC8iC,MAAM,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9iC,kBAAkB,CAAC,GAAG,CAAC;MAC7C,IAAI,CAAC8iC,MAAM,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9iC,kBAAkB,CAAC,GAAG,CAAC;MAC7C,IAAI,CAAC8iC,MAAM,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9iC,kBAAkB,CAAC,GAAG,CAAC;MAC7C,IAAI,IAAI,CAACvW,UAAU,CAACsqD,SAAS,EAAE;QAC3BjB,IAAI,CAACiB,SAAS,CAAC,IAAI,CAACjR,MAAM,EAAE,IAAI,CAACA,MAAM,CAAC;MAC5C;MACA,IAAI,CAACv4C,aAAa,CAAC,CAAC,EAAE,IAAI,CAACu4C,MAAM,CAAC;IACtC,CAAC;IAEDgR,gBAAgB,CAAC/0D,SAAS,CAACovC,WAAW,GAAG,YAAW;MAChD,OAAO,CACH,CAAC,GAAG,EAAE,QAAQ,CAAC,EACf,CAAC,GAAG,EAAE,QAAQ,CAAC,EACf,CAAC,GAAG,EAAE,QAAQ,CAAC,EACf,CAAC,GAAG,EAAE,QAAQ,CAAC,CAClB;IACL,CAAC;IAED3tC,SAAS,CAACiG,gBAAgB,CAAC,mBAAmB,EAAEqtD,gBAAgB,CAAC;IAUjEE,cAAc,CAAC/0D,KAAK,GAAG,UAAU;IACjC+0D,cAAc,CAAC7pD,IAAI,GAAG,qBAAqB;IAE3C6pD,cAAc,CAACj1D,SAAS,CAACqL,SAAS,GAAG,YAAW;MAC5C,IAAI++C,KAAK,GAAG,IAAI,CAAC9+C,YAAY,CAAC,CAAC,CAAC;MAChC,IAAI8+C,KAAK,IAAI,IAAI,EAAE;QACfA,KAAK,GAAG,IAAI,CAAC1/C,UAAU,CAAC0/C,KAAK;MACjC;MACA,IAAI8K,IAAI,GAAG,IAAI,CAAC5pD,YAAY,CAAC,CAAC,CAAC;MAC/B,IAAI4pD,IAAI,IAAI,IAAI,EAAE;QACdA,IAAI,GAAG,IAAI,CAACxqD,UAAU,CAACwqD,IAAI;MAC/B;MAEA,IAAIvB,CAAC,GAAGI,IAAI,CAACoC,YAAY,CAAC,IAAI,CAACpS,MAAM,EAAEmR,IAAI,EAAE9K,KAAK,GAAG,YAAY,CAAC;MAClE,IAAI,CAAC5+C,aAAa,CAAC,CAAC,EAAEmoD,CAAC,CAAC;IAC5B,CAAC;IAEDlyD,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAEutD,cAAc,CAAC;IAW7DG,eAAe,CAACl1D,KAAK,GAAG,aAAa;IACrCk1D,eAAe,CAAChqD,IAAI,GAAG,kDAAkD;IAEzEgqD,eAAe,CAACp1D,SAAS,CAACqL,SAAS,GAAG,YAAW;MAC7C,IAAIgqD,KAAK,GAAG,IAAI,CAAC/pD,YAAY,CAAC,CAAC,CAAC;MAChC,IAAI+pD,KAAK,IAAI,IAAI,EAAE;QACfA,KAAK,GAAG,IAAI,CAAC3qD,UAAU,CAAC2qD,KAAK;MACjC;MACTxB,IAAI,CAAC5qC,KAAK,CAAE,IAAI,CAACssC,KAAK,EAAEF,KAAK,EAAEvB,OAAO,CAAE;MACxC,IAAG,IAAI,CAACppD,UAAU,CAAC4qD,kBAAkB,EACpC,IAAI,CAACC,KAAK,GAAG,CAAC,IAAI,CAACA,KAAK,CAAC,CAAC,CAAC,EAAC,IAAI,CAACA,KAAK,CAAC,CAAC,CAAC,EAAC,IAAI,CAACA,KAAK,CAAC,CAAC,CAAC,CAAC;MAChD,IAAI5B,CAAC,GAAGI,IAAI,CAACC,SAAS,CAAC,IAAI,CAACjQ,MAAM,EAAE,IAAI,CAACwR,KAAK,CAAC;MAC/C,IAAI,CAAC/pD,aAAa,CAAC,CAAC,EAAEmoD,CAAC,CAAC;IAC5B,CAAC;IAEDlyD,SAAS,CAACiG,gBAAgB,CAAC,sBAAsB,EAAE0tD,eAAe,CAAC;IAQnEI,eAAe,CAACt1D,KAAK,GAAG,aAAa;IACrCs1D,eAAe,CAACpqD,IAAI,GAAG,4CAA4C;IAEnEoqD,eAAe,CAACx1D,SAAS,CAACqL,SAAS,GAAG,YAAW;MAC7C,IAAI+qD,CAAC,GAAG,IAAI,CAAC9qD,YAAY,CAAC,CAAC,CAAC;MACrC,IAAG,CAAC8qD,CAAC,EACJ;MACQ,IAAIzC,CAAC,GAAGI,IAAI,CAACsC,OAAO,CAAC,IAAI,CAACtS,MAAM,EAAEqS,CAAC,CAAC;MAC7CvC,IAAI,CAAC5qC,KAAK,CAAE,IAAI,CAAC86B,MAAM,EAAE,IAAI,CAACA,MAAM,EAAE+P,OAAO,CAAE;MACtC,IAAI,CAACtoD,aAAa,CAAC,CAAC,EAAE,IAAI,CAACu4C,MAAM,CAAC;IACtC,CAAC;IAEDtiD,SAAS,CAACiG,gBAAgB,CAAC,sBAAsB,EAAE8tD,eAAe,CAAC;IAUnEC,gBAAgB,CAACv1D,KAAK,GAAG,WAAW;IACpCu1D,gBAAgB,CAACrqD,IAAI,GAAG,gBAAgB;IAExCqqD,gBAAgB,CAACz1D,SAAS,CAACqL,SAAS,GAAG,YAAW;MAC9C,IAAIqqD,GAAG,GAAG,IAAI,CAACpqD,YAAY,CAAC,CAAC,CAAC;MAC9B,IAAIoqD,GAAG,IAAI,IAAI,EAAE;QACbA,GAAG,GAAG,IAAI,CAAChrD,UAAU,CAACgrD,GAAG;MAC7B;MACA,IAAI3B,IAAI,GAAG,IAAI,CAACzoD,YAAY,CAAC,CAAC,CAAC;MAC/B,IAAIyoD,IAAI,IAAI,IAAI,EAAE;QACd,IAAI,CAACvoD,aAAa,CAACkqD,GAAG,CAAC;MAC3B,CAAC,MAAM;QACH,IAAI,CAAClqD,aAAa,CACd,CAAC,EACDqoD,IAAI,CAACyC,aAAa,CAACzC,IAAI,CAACT,MAAM,EAAE,EAAEsC,GAAG,EAAE3B,IAAI,CAAC,CAC/C;MACL;IACJ,CAAC;IAEDtyD,SAAS,CAACiG,gBAAgB,CAAC,oBAAoB,EAAE+tD,gBAAgB,CAAC;IASlEE,cAAc,CAACz1D,KAAK,GAAG,YAAY;IACnCy1D,cAAc,CAACvqD,IAAI,GAAG,mBAAmB;IAEzCuqD,cAAc,CAAC31D,SAAS,CAACqL,SAAS,GAAG,YAAW;MAC5C,IAAI8K,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;MAC5B,IAAI6K,CAAC,IAAI,IAAI,EAAE;QACX;MACJ;MACA,IAAIC,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;MAC5B,IAAI8K,CAAC,IAAI,IAAI,EAAE;QACX;MACJ;MAEA,IAAIu9C,CAAC,GAAGI,IAAI,CAACG,QAAQ,CAAC,IAAI,CAACnQ,MAAM,EAAE5tC,CAAC,EAAEC,CAAC,CAAC;MACxC,IAAI,CAAC5K,aAAa,CAAC,CAAC,EAAEmoD,CAAC,CAAC;IAC5B,CAAC;IAEDlyD,SAAS,CAACiG,gBAAgB,CAAC,kBAAkB,EAAEiuD,cAAc,CAAC;IAc9DC,eAAe,CAAC11D,KAAK,GAAG,YAAY;IACpC01D,eAAe,CAACxqD,IAAI,GAAG,oCAAoC;IAE3DwqD,eAAe,CAAC51D,SAAS,CAACqL,SAAS,GAAG,YAAW;MAC7C,IAAI8K,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;MAC5B,IAAI6K,CAAC,IAAI,IAAI,EAAE;QACX;MACJ;MACA,IAAIC,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;MAC5B,IAAI8K,CAAC,IAAI,IAAI,EAAE;QACX;MACJ;MACA,IAAIy6C,MAAM,GAAG,IAAI,CAACnmD,UAAU,CAACmmD,MAAM;MACnC,IAAI,IAAI,CAACvlD,YAAY,CAAC,CAAC,CAAC,IAAI,IAAI,EAAE;QAC9BulD,MAAM,GAAG,IAAI,CAACvlD,YAAY,CAAC,CAAC,CAAC;MACjC;MAEA,IAAIqoD,CAAC,GAAGI,IAAI,CAACwC,KAAK,CAAC,IAAI,CAACxS,MAAM,EAAE5tC,CAAC,EAAEC,CAAC,EAAEy6C,MAAM,CAAC;MAC7C,IAAI,CAACrlD,aAAa,CAAC,CAAC,EAAEmoD,CAAC,CAAC;IAC5B,CAAC;IAEDlyD,SAAS,CAACiG,gBAAgB,CAAC,mBAAmB,EAAEkuD,eAAe,CAAC;IAahEC,gBAAgB,CAAC31D,KAAK,GAAG,aAAa;IACtC21D,gBAAgB,CAACzqD,IAAI,GAAG,kBAAkB;IAE1CyqD,gBAAgB,CAAC71D,SAAS,CAACqL,SAAS,GAAG,YAAW;MAC9C,IAAIqqD,GAAG,GAAG,IAAI,CAACpqD,YAAY,CAAC,CAAC,CAAC;MACvC,IAAGoqD,GAAG,EACL,IAAI,CAAC3R,MAAM,CAACp7C,GAAG,CAAC+sD,GAAG,CAAC;MACrB,IAAII,SAAS,GAAG,IAAI,CAACprD,UAAU,CAACorD,SAAS;MACzC,IAAIC,SAAS,GAAG,IAAI,CAACrrD,UAAU,CAACqrD,SAAS;MACzC,IAAIC,UAAU,GAAG,IAAI,CAACtrD,UAAU,CAACsrD,UAAU;MAC3C,IAAIC,UAAU,GAAG,IAAI,CAACvrD,UAAU,CAACurD,UAAU;;MAE3C;MACA;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;MAGG,KAAI,IAAIr2D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAE,EAAEA,CAAC,EACzB;QACC,IAAI2L,CAAC,GAAGwqD,SAAS,CAACn2D,CAAC,CAAC,GAAGk2D,SAAS,CAACl2D,CAAC,CAAC;QACnC,IAAI,CAACs2D,QAAQ,CAACt2D,CAAC,CAAC,GAAGuiB,IAAI,CAAC+pB,KAAK,CAAE,IAAI,CAAC6X,MAAM,CAACnkD,CAAC,CAAC,EAAEk2D,SAAS,CAACl2D,CAAC,CAAC,EAAEm2D,SAAS,CAACn2D,CAAC,CAAC,CAAE;QAC3E,IAAG2L,CAAC,IAAI,CAAC,EACT;UACC,IAAI,CAACw4C,MAAM,CAACnkD,CAAC,CAAC,GAAG,CAACo2D,UAAU,CAACp2D,CAAC,CAAC,GAAGq2D,UAAU,CAACr2D,CAAC,CAAC,IAAI,GAAG;UACtD;QACD;QAEA,IAAIia,CAAC,GAAG,CAAC,IAAI,CAACkqC,MAAM,CAACnkD,CAAC,CAAC,GAAGk2D,SAAS,CAACl2D,CAAC,CAAC,IAAI2L,CAAC;QAC3C,IAAG,IAAI,CAACb,UAAU,CAACwhC,KAAK,EACvBryB,CAAC,GAAGsI,IAAI,CAAC+pB,KAAK,CAACryB,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;QACtB,IAAItJ,CAAC,GAAG0lD,UAAU,CAACr2D,CAAC,CAAC,GAAGo2D,UAAU,CAACp2D,CAAC,CAAC;QACrC,IAAI,CAACmkD,MAAM,CAACnkD,CAAC,CAAC,GAAGo2D,UAAU,CAACp2D,CAAC,CAAC,GAAGia,CAAC,GAAGtJ,CAAC;MACvC;MAEA,IAAI,CAAC/E,aAAa,CAAC,CAAC,EAAC,IAAI,CAACu4C,MAAM,CAAC;MACjC,IAAI,CAACv4C,aAAa,CAAC,CAAC,EAAC,IAAI,CAAC0qD,QAAQ,CAAC;IAC9B,CAAC;IAEDz0D,SAAS,CAACiG,gBAAgB,CAAC,oBAAoB,EAAEmuD,gBAAgB,CAAC;EAItE,CAAC,CAAC;EAAA,KACA,IAAIp0D,SAAS,CAACiE,KAAK,EACvBmC,OAAO,CAACqB,IAAI,CAAC,mDAAmD,CAAC;AAEnE,CAAC,EAAE,IAAI,CAAC;;AAER;AACA,CAAC,UAAS1H,MAAM,EAAE;EACd,IAAIC,SAAS,GAAGD,MAAM,CAACC,SAAS;EAEhC,SAASwe,QAAQ,CAACxT,CAAC,EAAE;IACvB,IAAGA,CAAC,IAAIA,CAAC,CAACpD,WAAW,KAAKb,MAAM,EAChC;MACC,IACA;QACC,OAAOuC,IAAI,CAACC,SAAS,CAACyB,CAAC,CAAC;MACzB,CAAC,CACD,OAAOX,GAAG,EACV;QACC,OAAOxC,MAAM,CAACmD,CAAC,CAAC;MACjB;IACD;IACM,OAAOnD,MAAM,CAACmD,CAAC,CAAC;EACpB;EAEAhL,SAAS,CAAC6I,kBAAkB,CAAC,iBAAiB,EAAE2V,QAAQ,EAAE,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC;EAEzE,SAASu2C,OAAO,CAAC/pD,CAAC,EAAEC,CAAC,EAAE;IACnB,OAAOD,CAAC,IAAIC,CAAC;EACjB;EAEAjL,SAAS,CAAC6I,kBAAkB,CACxB,gBAAgB,EAChBksD,OAAO,EACP,CAAC,QAAQ,EAAE,QAAQ,CAAC,EACpB,SAAS,CACZ;EAED,SAASC,WAAW,CAAChqD,CAAC,EAAEC,CAAC,EAAE;IACvB,IAAID,CAAC,KAAKsL,SAAS,EAAE;MACjB,OAAOrL,CAAC;IACZ;IACA,IAAIA,CAAC,KAAKqL,SAAS,EAAE;MACjB,OAAOtL,CAAC;IACZ;IACA,OAAOA,CAAC,GAAGC,CAAC;EAChB;EAEAjL,SAAS,CAAC6I,kBAAkB,CACxB,oBAAoB,EACpBmsD,WAAW,EACX,CAAC,QAAQ,EAAE,QAAQ,CAAC,EACpB,QAAQ,CACX;EAED,SAASC,QAAQ,CAACjqD,CAAC,EAAEC,CAAC,EAAE;IACpB,IAAID,CAAC,KAAKsL,SAAS,IAAIrL,CAAC,KAAKqL,SAAS,EAAE;MACpC,OAAO,KAAK;IAChB;IACA,OAAOtL,CAAC,CAAC2B,OAAO,CAAC1B,CAAC,CAAC,IAAI,CAAC,CAAC;EAC7B;EAEAjL,SAAS,CAAC6I,kBAAkB,CACxB,iBAAiB,EACjBosD,QAAQ,EACR,CAAC,QAAQ,EAAE,QAAQ,CAAC,EACpB,SAAS,CACZ;EAED,SAAS/Y,WAAW,CAAClxC,CAAC,EAAE;IACpB,IAAIA,CAAC,IAAI,IAAI,IAAIA,CAAC,CAACpD,WAAW,KAAKC,MAAM,EAAE;MACvC,OAAOmD,CAAC,CAACkxC,WAAW,EAAE;IAC1B;IACA,OAAOlxC,CAAC;EACZ;EAEAhL,SAAS,CAAC6I,kBAAkB,CACxB,oBAAoB,EACpBqzC,WAAW,EACX,CAAC,QAAQ,CAAC,EACV,QAAQ,CACX;EAED,SAAS31C,KAAK,CAACooC,GAAG,EAAEumB,SAAS,EAAE;IACjC,IAAGA,SAAS,IAAI,IAAI,EACnBA,SAAS,GAAG,IAAI,CAACjsD,UAAU,CAACisD,SAAS;IAChC,IAAIvmB,GAAG,IAAI,IAAI,EACd,OAAO,EAAE;IAChB,IAAIA,GAAG,CAAC/mC,WAAW,KAAKC,MAAM,EAC7B,OAAO8mC,GAAG,CAACpoC,KAAK,CAAC2uD,SAAS,IAAI,GAAG,CAAC,CAAC,KAC/B,IAAIvmB,GAAG,CAAC/mC,WAAW,KAAK3J,KAAK,EAClC;MACC,IAAI6L,CAAC,GAAG,EAAE;MACV,KAAI,IAAI3L,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGwwC,GAAG,CAAClxC,MAAM,EAAE,EAAEU,CAAC,EAAC;QACtB,IAAI,OAAOwwC,GAAG,CAACxwC,CAAC,CAAC,IAAI,QAAQ,EACrC2L,CAAC,CAAC3L,CAAC,CAAC,GAAGwwC,GAAG,CAACxwC,CAAC,CAAC,CAACoI,KAAK,CAAC2uD,SAAS,IAAI,GAAG,CAAC;MACjC;MACT,OAAOprD,CAAC;IACT;IACM,OAAO,IAAI;EACf;EAEA9J,SAAS,CAAC6I,kBAAkB,CACxB,cAAc,EACdtC,KAAK,EACL,CAAC,cAAc,EAAE,QAAQ,CAAC,EAC1B,OAAO,EACb;IAAE2uD,SAAS,EAAE;EAAI,CAAC,CACf;EAED,SAASlyB,OAAO,CAACh4B,CAAC,EAAE;IAChB,IAAIA,CAAC,IAAI,IAAI,IAAIA,CAAC,CAACpD,WAAW,KAAKwd,MAAM,EAAE;MACvC,OAAOpa,CAAC,CAACg4B,OAAO,CAAC,IAAI,CAAC/5B,UAAU,CAACqhC,SAAS,CAAC;IAC/C;IACA,OAAOt/B,CAAC;EACZ;EAEAhL,SAAS,CAAC6I,kBAAkB,CACxB,gBAAgB,EAChBm6B,OAAO,EACP,CAAC,QAAQ,CAAC,EACV,QAAQ,EACR;IAAEsH,SAAS,EAAE;EAAE,CAAC,CACnB;EAGD,SAAS6qB,aAAa,GAAG;IACrB,IAAI,CAAC/7C,QAAQ,CAAC,EAAE,EAAE,QAAQ,CAAC;IAC3B,IAAI,CAACY,SAAS,CAAC,OAAO,EAAE,OAAO,CAAC;IAChC,IAAI,CAACA,SAAS,CAAC,MAAM,EAAE,QAAQ,CAAC;IAChC,IAAI,CAACqH,WAAW,CAAC,OAAO,EAAE,EAAE,CAAC;IAC7B,IAAI,CAACA,WAAW,CAAC,WAAW,EAAE,GAAG,CAAC;IACxC,IAAI,CAAC+zC,MAAM,GAAG,IAAI;EAChB;EAEAD,aAAa,CAAC12D,KAAK,GAAG,SAAS;EAC/B02D,aAAa,CAACxrD,IAAI,GAAG,0BAA0B;EAE/CwrD,aAAa,CAAC52D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC3C,IAAIwL,KAAK,GAAG,IAAI,CAACvL,YAAY,CAAC,CAAC,CAAC;IACtC,IAAG,CAACuL,KAAK,EACR;IACD,IAAI8/C,SAAS,GAAG,IAAI,CAACjsD,UAAU,CAACisD,SAAS,IAAI,GAAG;IAChD,IAAG9/C,KAAK,IAAI,IAAI,CAACigD,IAAI,IAAIH,SAAS,IAAI,IAAI,CAACI,eAAe,EAC1D;MACC,IAAI,CAACA,eAAe,GAAGJ,SAAS;MAChC,IAAI,CAACG,IAAI,GAAGjgD,KAAK;MACjB,IAAI,CAACggD,MAAM,GAAGhgD,KAAK,CAAC7O,KAAK,CAAC,IAAI,CAAC,CAACimC,GAAG,CAAC,UAASxhC,CAAC,EAAC;QAAE,OAAOA,CAAC,CAACuqD,IAAI,EAAE,CAAChvD,KAAK,CAAC2uD,SAAS,CAAC;MAAA,CAAC,CAAC;IACpF;IACM,IAAI,CAACnrD,aAAa,CAAC,CAAC,EAAE,IAAI,CAACqrD,MAAM,CAAE;IACnC,IAAI,CAACrrD,aAAa,CAAC,CAAC,EAAE,IAAI,CAACqrD,MAAM,GAAG,IAAI,CAACA,MAAM,CAAC33D,MAAM,GAAG,CAAC,CAAE;EAChE,CAAC;EAEDuC,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAEkvD,aAAa,CAAC;AAE/D,CAAC,EAAE,IAAI,CAAC;AAER,CAAC,UAASp1D,MAAM,EAAE;EACd,IAAIC,SAAS,GAAGD,MAAM,CAACC,SAAS;EAEhC,SAASw1D,QAAQ,GAAG;IAChB,IAAI,CAACp8C,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC9B,IAAI,CAACA,QAAQ,CAAC,GAAG,CAAC;IAClB,IAAI,CAACA,QAAQ,CAAC,GAAG,CAAC;IAClB,IAAI,CAACA,QAAQ,CAAC,GAAG,CAAC;IAClB,IAAI,CAACA,QAAQ,CAAC,GAAG,CAAC;IAClB,IAAI,CAACY,SAAS,CAAC,KAAK,CAAC;IAErB,IAAI,CAAC0rB,QAAQ,GAAG,CAAC;EACrB;EAEA8vB,QAAQ,CAAC/2D,KAAK,GAAG,UAAU;EAC3B+2D,QAAQ,CAAC7rD,IAAI,GAAG,mBAAmB;EAEnC6rD,QAAQ,CAACj3D,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IAChD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IACAmI,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB,IAAIlrB,CAAC,GAAG,CAAC,IAAI,CAAC4vB,QAAQ,GAAG,CAAC,IAAI1lC,SAAS,CAACK,gBAAgB,GAAG,CAAC;IAC5DirB,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACqV,MAAM,CAAC,EAAE,EAAE7qB,CAAC,CAAC;IACjBwV,GAAG,CAACsV,MAAM,CAAC,EAAE,EAAE9qB,CAAC,GAAG9V,SAAS,CAACK,gBAAgB,CAAC;IAC9CirB,GAAG,CAACsV,MAAM,CAAC,EAAE,EAAE9qB,CAAC,GAAG9V,SAAS,CAACK,gBAAgB,GAAG,GAAG,CAAC;IACpDirB,GAAG,CAACoV,IAAI,EAAE;EACd,CAAC;EAED80B,QAAQ,CAACj3D,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtC,IAAI6rD,GAAG,GAAG,IAAI,CAAC5rD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI4rD,GAAG,IAAI,IAAI,IAAIA,GAAG,CAAC7tD,WAAW,KAAKwd,MAAM,EACzCqwC,GAAG,GAAG,CAAC;IACX,IAAI,CAAC/vB,QAAQ,GAAG+vB,GAAG,GAAG/0C,IAAI,CAAC4F,KAAK,CAACmvC,GAAG,CAAC,IAAI,IAAI,CAACrkD,MAAM,CAAC3T,MAAM,GAAG,CAAC,CAAC;IAChE,IAAI0J,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC4rD,GAAG,GAAG,CAAC,CAAC;IAClC,IAAItuD,CAAC,KAAKmP,SAAS,EAAE;MACjB,IAAI,CAACvM,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC;IAC5B;EACJ,CAAC;EAEDquD,QAAQ,CAACj3D,SAAS,CAACovC,WAAW,GAAG,YAAW;IACxC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;EACnD,CAAC;EAED3tC,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAEuvD,QAAQ,CAAC;EAEtD,SAAS1P,QAAQ,GAAG;IAChB,IAAI,CAAC78C,UAAU,GAAG;MACdysD,QAAQ,EAAE;IACd,CAAC;IACD,IAAI,CAACt8C,QAAQ,CAAC,OAAO,EAAE,QAAQ,CAAC;IAChC,IAAI,CAACA,QAAQ,CAAC,KAAK,CAAC;IACpB,IAAI,CAACY,SAAS,CAAC,KAAK,CAAC;IAErB,IAAI,CAAC/C,KAAK,GAAG,CAAC;IACd,IAAI,CAAC8L,MAAM,GAAG,IAAI,CAAC9Z,UAAU,CAACysD,QAAQ,CAACnvD,KAAK,CAAC,GAAG,CAAC;EACrD;EAEAu/C,QAAQ,CAACrnD,KAAK,GAAG,UAAU;EAC3BqnD,QAAQ,CAACn8C,IAAI,GAAG,kDAAkD;EAElEm8C,QAAQ,CAACvnD,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IACzD,IAAI5Z,IAAI,IAAI,UAAU,EAAE;MACpB,IAAI,CAACsjB,MAAM,GAAG1J,KAAK,CAAC9S,KAAK,CAAC,GAAG,CAAC;IAClC;EACJ,CAAC;EAEDu/C,QAAQ,CAACvnD,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtC,IAAI+rD,GAAG,GAAG,IAAI,CAAC9rD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI8rD,GAAG,IAAIA,GAAG,IAAI,IAAI,CAACC,gBAAgB,EAAE;MACrC,IAAI,CAAC7yC,MAAM,GAAG4yC,GAAG,CAACpvD,KAAK,CAAC,GAAG,CAAC;MAC5B,IAAI,CAACqvD,gBAAgB,GAAGD,GAAG;IAC/B;IACA,IAAI1+C,KAAK,GAAG,IAAI,CAACpN,YAAY,CAAC,CAAC,CAAC;IAChC,IAAIoN,KAAK,IAAI,IAAI,EAAE;MACfA,KAAK,GAAG,CAAC;IACb;IACA,IAAI,CAACA,KAAK,GAAGA,KAAK,GAAGyJ,IAAI,CAAC4F,KAAK,CAACrP,KAAK,CAAC,GAAG,IAAI,CAAC8L,MAAM,CAACtlB,MAAM;IAE3D,IAAI,CAACsM,aAAa,CAAC,CAAC,EAAE,IAAI,CAACgZ,MAAM,CAAC9L,KAAK,CAAC,CAAC;EAC7C,CAAC;EAEDjX,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAE6/C,QAAQ,CAAC;EAGtD,SAAS+P,QAAQ,GAAE;IACf,IAAI,CAAC5sD,UAAU,GAAG,CAAE,CAAC;IACrB,IAAI,CAACmQ,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;EACpC;EACA67C,QAAQ,CAACp3D,KAAK,GAAG,KAAK;EACtBo3D,QAAQ,CAAClsD,IAAI,GAAG,oCAAoC;EACpDksD,QAAQ,CAACt3D,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtCksD,GAAG,GAAG,IAAI;IACV,KAAKC,GAAG,IAAI,IAAI,CAAC3kD,MAAM,EAAC;MACpB,IAAI,CAAC,IAAI,CAACvH,YAAY,CAACksD,GAAG,CAAC,EAAC;QACxBD,GAAG,GAAG,KAAK;QACX;MACJ;IACJ;IACA,IAAI,CAAC/rD,aAAa,CAAC,CAAC,EAAE+rD,GAAG,CAAC;EAC9B,CAAC;EACDD,QAAQ,CAACt3D,SAAS,CAACovC,WAAW,GAAG,YAAW;IACxC,OAAO,CACH,CAAC,KAAK,EAAE,SAAS,CAAC,CACrB;EACL,CAAC;EACD3tC,SAAS,CAACiG,gBAAgB,CAAC,WAAW,EAAE4vD,QAAQ,CAAC;EAGjD,SAASG,OAAO,GAAE;IACd,IAAI,CAAC/sD,UAAU,GAAG,CAAE,CAAC;IACrB,IAAI,CAACmQ,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;EACpC;EACAg8C,OAAO,CAACv3D,KAAK,GAAG,IAAI;EACpBu3D,OAAO,CAACrsD,IAAI,GAAG,2CAA2C;EAC1DqsD,OAAO,CAACz3D,SAAS,CAACqL,SAAS,GAAG,YAAW;IACrCksD,GAAG,GAAG,KAAK;IACX,KAAKC,GAAG,IAAI,IAAI,CAAC3kD,MAAM,EAAC;MACpB,IAAI,IAAI,CAACvH,YAAY,CAACksD,GAAG,CAAC,EAAC;QACvBD,GAAG,GAAG,IAAI;QACV;MACJ;IACJ;IACA,IAAI,CAAC/rD,aAAa,CAAC,CAAC,EAAE+rD,GAAG,CAAC;EAC9B,CAAC;EACDE,OAAO,CAACz3D,SAAS,CAACovC,WAAW,GAAG,YAAW;IACvC,OAAO,CACH,CAAC,IAAI,EAAE,SAAS,CAAC,CACpB;EACL,CAAC;EACD3tC,SAAS,CAACiG,gBAAgB,CAAC,UAAU,EAAE+vD,OAAO,CAAC;EAG/C,SAASC,QAAQ,GAAE;IACf,IAAI,CAAChtD,UAAU,GAAG,CAAE,CAAC;IACrB,IAAI,CAACmQ,QAAQ,CAAC,IAAI,EAAE,SAAS,CAAC;IAC9B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;EACpC;EACAi8C,QAAQ,CAACx3D,KAAK,GAAG,KAAK;EACtBw3D,QAAQ,CAACtsD,IAAI,GAAG,6BAA6B;EAC7CssD,QAAQ,CAAC13D,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtC,IAAIksD,GAAG,GAAG,CAAC,IAAI,CAACjsD,YAAY,CAAC,CAAC,CAAC;IAC/B,IAAI,CAACE,aAAa,CAAC,CAAC,EAAE+rD,GAAG,CAAC;EAC9B,CAAC;EACD91D,SAAS,CAACiG,gBAAgB,CAAC,WAAW,EAAEgwD,QAAQ,CAAC;EAGjD,SAASC,YAAY,GAAE;IACnB,IAAI,CAACjtD,UAAU,GAAG,CAAE,CAAC;IACrB,IAAI,CAACmQ,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;EACpC;EACAk8C,YAAY,CAACz3D,KAAK,GAAG,cAAc;EACnCy3D,YAAY,CAACvsD,IAAI,GAAG,8BAA8B;EAClDusD,YAAY,CAAC33D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1CusD,IAAI,GAAG,IAAI;IACXL,GAAG,GAAG,IAAI;IACV,KAAKC,GAAG,IAAI,IAAI,CAAC3kD,MAAM,EAAC;MACpB,IAAI+kD,IAAI,KAAK,IAAI,EAAEA,IAAI,GAAG,IAAI,CAACtsD,YAAY,CAACksD,GAAG,CAAC,CAAC,KAE7C,IAAII,IAAI,IAAI,IAAI,CAACtsD,YAAY,CAACksD,GAAG,CAAC,EAAC;QAC/BD,GAAG,GAAG,KAAK;QACX;MACJ;IACR;IACA,IAAI,CAAC/rD,aAAa,CAAC,CAAC,EAAE+rD,GAAG,CAAC;EAC9B,CAAC;EACDI,YAAY,CAAC33D,SAAS,CAACovC,WAAW,GAAG,YAAW;IAC5C,OAAO,CACH,CAAC,MAAM,EAAE,SAAS,CAAC,CACtB;EACL,CAAC;EACD3tC,SAAS,CAACiG,gBAAgB,CAAC,mBAAmB,EAAEiwD,YAAY,CAAC;EAG7D,SAASE,WAAW,GAAE;IAClB,IAAI,CAACntD,UAAU,GAAG,CAAE,CAAC;IACrB,IAAI,CAACmQ,QAAQ,CAAC,WAAW,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IAC5C,IAAI,CAAC0W,QAAQ,CAAC,WAAW,EAAE,SAAS,CAAC;IACrC,IAAI,CAACY,SAAS,CAAC,MAAM,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACvC,IAAI,CAACuX,SAAS,CAAC,OAAO,EAAEha,SAAS,CAACyC,KAAK,CAAC;IACxC,IAAI,CAACkI,IAAI,GAAG3K,SAAS,CAACgD,UAAU;EACpC;EACAozD,WAAW,CAAC33D,KAAK,GAAG,QAAQ;EAC5B23D,WAAW,CAACzsD,IAAI,GAAG,+BAA+B;EAClDysD,WAAW,CAAC73D,SAAS,CAACqL,SAAS,GAAG,UAASkP,KAAK,EAAE3O,OAAO,EAAE;IACvD,IAAIksD,UAAU,GAAG,IAAI,CAACxsD,YAAY,CAAC,CAAC,CAAC;IACrC,IAAIwsD,UAAU,EAAC;MACX,IAAI,CAACh2C,WAAW,CAAC,CAAC,CAAC;IACvB,CAAC,MAAI;MACD,IAAI,CAACA,WAAW,CAAC,CAAC,CAAC;IACvB;EACJ,CAAC;EACDrgB,SAAS,CAACiG,gBAAgB,CAAC,UAAU,EAAEmwD,WAAW,CAAC;AACvD,CAAC,EAAE,IAAI,CAAC;AAER,CAAC,UAASr2D,MAAM,EAAE;EACd,IAAIC,SAAS,GAAGD,MAAM,CAACC,SAAS;EAEhC,SAASs2D,YAAY,GAAG;IACpB,IAAI,CAACl9C,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAE5B,IAAI,CAAC2J,MAAM,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;IAC9B,IAAI,CAAC9Z,UAAU,GAAG;MAAEue,KAAK,EAAE;IAAE,CAAC;EAClC;EAEA8uC,YAAY,CAAC73D,KAAK,GAAG,MAAM;EAC3B63D,YAAY,CAAC3sD,IAAI,GAAG,sBAAsB;EAC1C2sD,YAAY,CAACC,MAAM,GAAG,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC;EAEtDD,YAAY,CAAC/3D,SAAS,CAACqL,SAAS,GAAG,UAAS0hB,GAAG,EAAE;IAC7C,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IAEA,IAAI1Y,IAAI,GAAG,IAAI,CAACA,IAAI;IAEpB,KAAK,IAAItM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAE,EAAEA,CAAC,EAAE;MACxB,IAAIgJ,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC1L,CAAC,CAAC;MAC5B,IAAIgJ,CAAC,IAAI,IAAI,EAAE;QACX;MACJ;MACA,IAAI4b,MAAM,GAAG,IAAI,CAACA,MAAM,CAAC5kB,CAAC,CAAC;MAC3B4kB,MAAM,CAAC3kB,IAAI,CAAC+I,CAAC,CAAC;MACd,IAAI4b,MAAM,CAACtlB,MAAM,GAAGgN,IAAI,CAAC,CAAC,CAAC,EAAE;QACzBsY,MAAM,CAAC5O,KAAK,EAAE;MAClB;IACJ;EACJ,CAAC;EAEDmiD,YAAY,CAAC/3D,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACpD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IAEA,IAAI1Y,IAAI,GAAG,IAAI,CAACA,IAAI;IAEpB,IAAI+c,KAAK,GAAI,GAAG,GAAG/c,IAAI,CAAC,CAAC,CAAC,GAAI,IAAI,CAACxB,UAAU,CAACue,KAAK;IACnD,IAAI+uC,MAAM,GAAGD,YAAY,CAACC,MAAM;IAChC,IAAInwC,MAAM,GAAG3b,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG;IAE1B6gB,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACoY,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAEj5B,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,CAAC;IACpC6gB,GAAG,CAAC2V,WAAW,GAAG,MAAM;IACxB3V,GAAG,CAACoU,SAAS,EAAE;IACfpU,GAAG,CAACqV,MAAM,CAAC,CAAC,EAAEva,MAAM,CAAC;IACrBkF,GAAG,CAACsV,MAAM,CAACn2B,IAAI,CAAC,CAAC,CAAC,EAAE2b,MAAM,CAAC;IAC3BkF,GAAG,CAAC2Z,MAAM,EAAE;IAEZ,IAAI,IAAI,CAAC7zB,MAAM,EAAE;MACb,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAE,EAAEA,CAAC,EAAE;QACxB,IAAI4kB,MAAM,GAAG,IAAI,CAACA,MAAM,CAAC5kB,CAAC,CAAC;QAC3B,IAAI,CAAC,IAAI,CAACiT,MAAM,CAACjT,CAAC,CAAC,IAAI,CAAC,IAAI,CAACiT,MAAM,CAACjT,CAAC,CAAC,CAAC8V,IAAI,EAAE;UACzC;QACJ;QACAqX,GAAG,CAAC2V,WAAW,GAAGs1B,MAAM,CAACp4D,CAAC,CAAC;QAC3BmtB,GAAG,CAACoU,SAAS,EAAE;QACf,IAAIv4B,CAAC,GAAG4b,MAAM,CAAC,CAAC,CAAC,GAAGyE,KAAK,GAAG,CAAC,CAAC,GAAGpB,MAAM;QACvCkF,GAAG,CAACqV,MAAM,CAAC,CAAC,EAAEjgB,IAAI,CAAC+pB,KAAK,CAACtjC,CAAC,EAAE,CAAC,EAAEsD,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QACxC,KAAK,IAAIqC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiW,MAAM,CAACtlB,MAAM,IAAIqP,CAAC,GAAGrC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAEqC,CAAC,EAAE;UACnD,IAAI3F,CAAC,GAAG4b,MAAM,CAACjW,CAAC,CAAC,GAAG0a,KAAK,GAAG,CAAC,CAAC,GAAGpB,MAAM;UACvCkF,GAAG,CAACsV,MAAM,CAAC9zB,CAAC,EAAE4T,IAAI,CAAC+pB,KAAK,CAACtjC,CAAC,EAAE,CAAC,EAAEsD,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QAC5C;QACA6gB,GAAG,CAAC2Z,MAAM,EAAE;MAChB;IACJ;EACJ,CAAC;EAEDjlC,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAEqwD,YAAY,CAAC;EAEzD,SAASE,aAAa,GAAG;IACrB,IAAI,CAACx8C,SAAS,CAAC,OAAO,EAAE,OAAO,CAAC;IAChC,IAAI,CAAC/Q,UAAU,GAAG;MAAEmE,GAAG,EAAE;IAAG,CAAC;EACjC;EAEAopD,aAAa,CAAC/3D,KAAK,GAAG,OAAO;EAC7B+3D,aAAa,CAAC7sD,IAAI,GAAG,cAAc;EACnC6sD,aAAa,CAACz4C,OAAO,GAAG,CAAC;IAAEte,IAAI,EAAE,MAAM;IAAEoO,IAAI,EAAE,MAAM;IAAE3H,IAAI,EAAE;EAAS,CAAC,CAAC;EAExEswD,aAAa,CAAC9uD,oBAAoB,GAAG,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,CAAC;EAElE8uD,aAAa,CAACj4D,SAAS,CAACqY,OAAO,GAAG,YAAW;IACzC,IAAI,IAAI,CAAC3N,UAAU,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,IAAI,CAAC2d,GAAG,IAAI,IAAI,EAAE;MAClD,IAAI,CAACD,SAAS,CAAC,IAAI,CAAC1d,UAAU,CAAC,KAAK,CAAC,CAAC;IAC1C;EACJ,CAAC;EAEDutD,aAAa,CAACj4D,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACrD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IACA,IAAI,IAAI,CAACyD,GAAG,IAAI,IAAI,CAACnc,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,IAAI,CAACmc,GAAG,CAAC2C,KAAK,EAAE;MACpE+B,GAAG,CAACuU,SAAS,CAAC,IAAI,CAACjZ,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAACnc,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC;IAC7D;EACJ,CAAC;EAED+rD,aAAa,CAACj4D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC3C,IAAI,CAAC,IAAI,CAACgd,GAAG,EAAE;MACX,IAAI,CAACvI,QAAQ,GAAG,MAAM;IAC1B;IACA,IAAI,IAAI,CAACuI,GAAG,IAAI,IAAI,CAACA,GAAG,CAAC2C,KAAK,EAAE;MAC5B,IAAI,CAACxf,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC6c,GAAG,CAAC;IACnC,CAAC,MAAM;MACH,IAAI,CAAC7c,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC;IAC/B;IACA,IAAI,IAAI,CAAC6c,GAAG,IAAI,IAAI,CAACA,GAAG,CAAC6vC,KAAK,EAAE;MAC5B,IAAI,CAAC7vC,GAAG,CAAC6vC,KAAK,GAAG,KAAK;IAC1B;EACJ,CAAC;EAEDD,aAAa,CAACj4D,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC9D,IAAI,CAACpQ,UAAU,CAACxJ,IAAI,CAAC,GAAG4Z,KAAK;IAC7B,IAAI5Z,IAAI,IAAI,KAAK,IAAI4Z,KAAK,IAAI,EAAE,EAAE;MAC9B,IAAI,CAACsN,SAAS,CAACtN,KAAK,CAAC;IACzB;IAEA,OAAO,IAAI;EACf,CAAC;EAEDm9C,aAAa,CAACj4D,SAAS,CAACooB,SAAS,GAAG,UAASvZ,GAAG,EAAEqP,QAAQ,EAAE;IACxD,IAAIrP,GAAG,IAAI,EAAE,EAAE;MACX,IAAI,CAACwZ,GAAG,GAAG,IAAI;MACf;IACJ;IAEA,IAAI,CAACA,GAAG,GAAGnb,QAAQ,CAACQ,aAAa,CAAC,KAAK,CAAC;IAExC,IAAImB,GAAG,CAACxG,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,MAAM,IAAI5G,SAAS,CAAC+D,KAAK,EAAE;MAC/CqJ,GAAG,GAAGpN,SAAS,CAAC+D,KAAK,GAAGqJ,GAAG,CAACxG,MAAM,CAACwG,GAAG,CAACT,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;IAC5D;IAEA,IAAI,CAACia,GAAG,CAAC7a,GAAG,GAAGqB,GAAG;IAClB,IAAI,CAACiR,QAAQ,GAAG,MAAM;IACtB,IAAI9Q,IAAI,GAAG,IAAI;IACf,IAAI,CAACqZ,GAAG,CAACvY,MAAM,GAAG,YAAW;MACzB,IAAIoO,QAAQ,EAAE;QACVA,QAAQ,CAAC,IAAI,CAAC;MAClB;MACArW,OAAO,CAACC,GAAG,CAAE,sBAAsB,GAAGkH,IAAI,CAACqZ,GAAG,CAAC2C,KAAK,GAAG,GAAG,GAAGhc,IAAI,CAACqZ,GAAG,CAAC4C,MAAM,CAAE;MAC9E,IAAI,CAACitC,KAAK,GAAG,IAAI;MACjBlpD,IAAI,CAAC8Q,QAAQ,GAAG,MAAM;MACtB9Q,IAAI,CAAC0I,cAAc,CAAC,IAAI,CAAC;IAC7B,CAAC;IACD,IAAI,CAAC2Q,GAAG,CAAC3J,OAAO,GAAG,YAAW;MACnC7W,OAAO,CAACC,GAAG,CAAC,0BAA0B,GAAG+G,GAAG,CAAC;IAC9C,CAAC;EACC,CAAC;EAEDopD,aAAa,CAACj4D,SAAS,CAACm4D,QAAQ,GAAG,UAAS75D,CAAC,EAAEgmB,MAAM,EAAE;IACnD,IAAIA,MAAM,CAACpjB,IAAI,IAAI,MAAM,EAAE;MACvB,IAAI,CAACknB,SAAS,CAAC,IAAI,CAAC1d,UAAU,CAAC,KAAK,CAAC,CAAC;IAC1C;EACJ,CAAC;EAEDutD,aAAa,CAACj4D,SAAS,CAACy+B,UAAU,GAAG,UAASI,IAAI,EAAE;IAChD,IAAI7vB,IAAI,GAAG,IAAI;IACf,IAAI,IAAI,CAACu1C,IAAI,EAAE;MACXyB,GAAG,CAACG,eAAe,CAAC,IAAI,CAAC5B,IAAI,CAAC;IAClC;IACA,IAAI,CAACA,IAAI,GAAGyB,GAAG,CAACC,eAAe,CAACpnB,IAAI,CAAC;IACrC,IAAI,CAACn0B,UAAU,CAACmE,GAAG,GAAG,IAAI,CAAC01C,IAAI;IAC/B,IAAI,CAACn8B,SAAS,CAAC,IAAI,CAACm8B,IAAI,EAAE,UAASl8B,GAAG,EAAE;MACpCrZ,IAAI,CAAC9C,IAAI,CAAC,CAAC,CAAC,GAAImc,GAAG,CAAC4C,MAAM,GAAG5C,GAAG,CAAC2C,KAAK,GAAIhc,IAAI,CAAC9C,IAAI,CAAC,CAAC,CAAC;IAC1D,CAAC,CAAC;EACN,CAAC;EAEDzK,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAEuwD,aAAa,CAAC;EAE3D,SAASG,YAAY,GAAG;IACpB,IAAI,CAACv9C,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACY,SAAS,CAAC,OAAO,EAAE,OAAO,CAAC;IAChC,IAAI,CAAC/Q,UAAU,GAAG;MACd2tD,MAAM,EAAE,SAAS;MACjBC,MAAM,EAAE,SAAS;MACjBC,MAAM,EAAE,SAAS;MACjBC,MAAM,EAAE;IACZ,CAAC;EACL;EAEAJ,YAAY,CAACl4D,KAAK,GAAG,SAAS;EAC9Bk4D,YAAY,CAAChtD,IAAI,GAAG,mBAAmB;EAEvCgtD,YAAY,CAACp4D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC1C,IAAI4M,CAAC,GAAG,EAAE;IAEV,IAAI,IAAI,CAACvN,UAAU,CAAC2tD,MAAM,IAAI,IAAI,EAAE;MAChCpgD,CAAC,CAACpY,IAAI,CAAC29C,OAAO,CAAC,IAAI,CAAC9yC,UAAU,CAAC2tD,MAAM,CAAC,CAAC;IAC3C;IACA,IAAI,IAAI,CAAC3tD,UAAU,CAAC4tD,MAAM,IAAI,IAAI,EAAE;MAChCrgD,CAAC,CAACpY,IAAI,CAAC29C,OAAO,CAAC,IAAI,CAAC9yC,UAAU,CAAC4tD,MAAM,CAAC,CAAC;IAC3C;IACA,IAAI,IAAI,CAAC5tD,UAAU,CAAC6tD,MAAM,IAAI,IAAI,EAAE;MAChCtgD,CAAC,CAACpY,IAAI,CAAC29C,OAAO,CAAC,IAAI,CAAC9yC,UAAU,CAAC6tD,MAAM,CAAC,CAAC;IAC3C;IACA,IAAI,IAAI,CAAC7tD,UAAU,CAAC8tD,MAAM,IAAI,IAAI,EAAE;MAChCvgD,CAAC,CAACpY,IAAI,CAAC29C,OAAO,CAAC,IAAI,CAAC9yC,UAAU,CAAC8tD,MAAM,CAAC,CAAC;IAC3C;IAEA,IAAIvvB,CAAC,GAAG,IAAI,CAAC39B,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI29B,CAAC,IAAI,IAAI,EAAE;MACXA,CAAC,GAAG,GAAG;IACX;IACA,IAAIA,CAAC,GAAG,GAAG,EAAE;MACTA,CAAC,GAAG,GAAG;IACX,CAAC,MAAM,IAAIA,CAAC,GAAG,GAAG,EAAE;MAChBA,CAAC,GAAG,GAAG;IACX;IAEA,IAAIhxB,CAAC,CAAC/Y,MAAM,IAAI,CAAC,EAAE;MACf;IACJ;IAEA,IAAI4N,MAAM,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACtB,IAAIm8B,CAAC,IAAI,CAAC,EAAE;MACRn8B,MAAM,GAAGmL,CAAC,CAAC,CAAC,CAAC;IACjB,CAAC,MAAM,IAAIgxB,CAAC,IAAI,CAAC,EAAE;MACfn8B,MAAM,GAAGmL,CAAC,CAACA,CAAC,CAAC/Y,MAAM,GAAG,CAAC,CAAC;IAC5B,CAAC,MAAM;MACH,IAAIgJ,GAAG,GAAG,CAAC+P,CAAC,CAAC/Y,MAAM,GAAG,CAAC,IAAI+pC,CAAC;MAC5B,IAAI4B,EAAE,GAAG5yB,CAAC,CAACkK,IAAI,CAACC,KAAK,CAACla,GAAG,CAAC,CAAC;MAC3B,IAAI4iC,EAAE,GAAG7yB,CAAC,CAACkK,IAAI,CAACC,KAAK,CAACla,GAAG,CAAC,GAAG,CAAC,CAAC;MAC/B,IAAIqI,CAAC,GAAGrI,GAAG,GAAGia,IAAI,CAACC,KAAK,CAACla,GAAG,CAAC;MAC7B4E,MAAM,CAAC,CAAC,CAAC,GAAG+9B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,GAAGt6B,CAAC,CAAC,GAAGu6B,EAAE,CAAC,CAAC,CAAC,GAAGv6B,CAAC;MACvCzD,MAAM,CAAC,CAAC,CAAC,GAAG+9B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,GAAGt6B,CAAC,CAAC,GAAGu6B,EAAE,CAAC,CAAC,CAAC,GAAGv6B,CAAC;MACvCzD,MAAM,CAAC,CAAC,CAAC,GAAG+9B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,GAAGt6B,CAAC,CAAC,GAAGu6B,EAAE,CAAC,CAAC,CAAC,GAAGv6B,CAAC;IAC3C;;IAEA;AACR;AACA;AACA;AACA;;IAEQ,KAAK,IAAI3Q,CAAC,GAAC,CAAC,EAAEA,CAAC,GAAGkN,MAAM,CAAC5N,MAAM,EAAEU,CAAC,EAAE,EAAE;MAClCkN,MAAM,CAAClN,CAAC,CAAC,IAAI,GAAG;IACpB;IAEA,IAAI,CAACkgB,QAAQ,GAAGi9B,aAAa,CAACjwC,MAAM,CAAC;IACrC,IAAI,CAACtB,aAAa,CAAC,CAAC,EAAEsB,MAAM,CAAC;EACjC,CAAC;EAEDrL,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAE0wD,YAAY,CAAC;EAEzD,SAASK,UAAU,GAAG;IAClB,IAAI,CAAC59C,QAAQ,CAAC,EAAE,EAAE,cAAc,CAAC;IACjC,IAAI,CAAC3O,IAAI,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC;EAC1B;EAEAusD,UAAU,CAACv4D,KAAK,GAAG,OAAO;EAC1Bu4D,UAAU,CAACrtD,IAAI,GAAG,gBAAgB;EAClCqtD,UAAU,CAACj5C,OAAO,GAAG,CACjB;IAAEte,IAAI,EAAE,QAAQ;IAAEoO,IAAI,EAAE,YAAY;IAAE3H,IAAI,EAAE;EAAS,CAAC,EACtD;IAAEzG,IAAI,EAAE,MAAM;IAAEoO,IAAI,EAAE,YAAY;IAAE3H,IAAI,EAAE;EAAS,CAAC,CACvD;EAED8wD,UAAU,CAACz4D,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IAClD,IAAI,IAAI,CAACiF,KAAK,IAAI,CAAC,IAAI,CAAC/lB,KAAK,CAAC2Y,SAAS,EAAE;MACrCmI,GAAG,CAACuU,SAAS,CAAC,IAAI,CAACtP,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC9lB,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC;IAC/D;EACJ,CAAC;EAEDusD,UAAU,CAACz4D,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAI,CAAC2mB,KAAK,GAAG,IAAI,CAAC1mB,YAAY,CAAC,CAAC,CAAC;IACjC,IAAI,CAACoM,cAAc,CAAC,IAAI,CAAC;EAC7B,CAAC;EAED+gD,UAAU,CAACz4D,SAAS,CAACm4D,QAAQ,GAAG,UAAS75D,CAAC,EAAEgmB,MAAM,EAAE;IAChD,IAAIA,MAAM,CAACpjB,IAAI,IAAI,QAAQ,IAAI,IAAI,CAAC8wB,KAAK,EAAE;MACvC,IAAIhH,KAAK,GAAG,IAAI,CAACgH,KAAK,CAAChH,KAAK;MAC5B,IAAIC,MAAM,GAAG,IAAI,CAAC+G,KAAK,CAAC/G,MAAM;MAE9B,IAAI,CAACD,KAAK,IAAI,IAAI,CAACgH,KAAK,CAAC0mC,UAAU,IAAI,IAAI,EAAE;QACzC1tC,KAAK,GAAG,IAAI,CAACgH,KAAK,CAAC0mC,UAAU;QAC7BztC,MAAM,GAAG,IAAI,CAAC+G,KAAK,CAAC2mC,WAAW;MACnC;MAEA,IAAI3tC,KAAK,IAAIC,MAAM,EAAE;QACjB,IAAI,CAAC/e,IAAI,GAAG,CAAC8e,KAAK,EAAEC,MAAM,CAAC;MAC/B;MACA,IAAI,CAACvT,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;IACnC,CAAC,MAAM,IAAI4M,MAAM,CAACpjB,IAAI,IAAI,MAAM,EAAE;MAC9B,IAAI,CAAC03D,IAAI,EAAE;IACf;EACJ,CAAC;EAEDH,UAAU,CAACz4D,SAAS,CAAC44D,IAAI,GAAG,YAAW;IACnC;IACA,IAAIC,WAAW,IAAI,IAAI,CAAC7mC,KAAK,EAAE;MAC3B6mC,WAAW,CAAC,IAAI,CAAC7mC,KAAK,CAAC;IAC3B;EACJ,CAAC;EAEDvwB,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAE+wD,UAAU,CAAC;EAExD,SAASK,SAAS,GAAG;IACjB,IAAI,CAAC51C,SAAS,CAAC,CACX,CAAC,MAAM,EAAE,OAAO,CAAC,EACjB,CAAC,MAAM,EAAE,OAAO,CAAC,EACjB,CAAC,MAAM,EAAE,QAAQ,CAAC,CACrB,CAAC;IACF,IAAI,CAACzH,SAAS,CAAC,EAAE,EAAE,OAAO,CAAC;IAC3B,IAAI,CAAC/Q,UAAU,GAAG;MAAEquD,IAAI,EAAE,GAAG;MAAE/tC,KAAK,EAAE,GAAG;MAAEC,MAAM,EAAE;IAAI,CAAC;EAC5D;EAEA6tC,SAAS,CAAC54D,KAAK,GAAG,YAAY;EAC9B44D,SAAS,CAAC1tD,IAAI,GAAG,sBAAsB;EACvC0tD,SAAS,CAACt5C,OAAO,GAAG,CAChB;IAAEte,IAAI,EAAE,SAAS;IAAEoO,IAAI,EAAE,aAAa;IAAE3H,IAAI,EAAE;EAAS,CAAC,EACxD;IAAEzG,IAAI,EAAE,SAAS;IAAEoO,IAAI,EAAE,aAAa;IAAE3H,IAAI,EAAE;EAAS,CAAC,CAC3D;EAEDmxD,SAAS,CAAC94D,SAAS,CAACqY,OAAO,GAAG,YAAW;IACrC,IAAI,CAAC2gD,YAAY,EAAE;IACnB,IAAIjsC,GAAG,GAAG,IAAI,CAAC/T,MAAM,CAACob,UAAU,CAAC,IAAI,CAAC;IACtCrH,GAAG,CAAC0V,SAAS,GAAG,MAAM;IACtB1V,GAAG,CAACoY,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAACz6B,UAAU,CAAC,OAAO,CAAC,EAAE,IAAI,CAACA,UAAU,CAAC,QAAQ,CAAC,CAAC;EAC3E,CAAC;EAEDouD,SAAS,CAAC94D,SAAS,CAACg5D,YAAY,GAAG,YAAW;IAC1C,IAAI,CAAChgD,MAAM,GAAG9L,QAAQ,CAACQ,aAAa,CAAC,QAAQ,CAAC;IAC9C,IAAI,CAACsL,MAAM,CAACgS,KAAK,GAAG,IAAI,CAACtgB,UAAU,CAAC,OAAO,CAAC;IAC5C,IAAI,CAACsO,MAAM,CAACiS,MAAM,GAAG,IAAI,CAACvgB,UAAU,CAAC,QAAQ,CAAC;EAClD,CAAC;EAEDouD,SAAS,CAAC94D,SAAS,CAACqL,SAAS,GAAG,YAAW;IACvC,IAAI0hB,GAAG,GAAG,IAAI,CAAC/T,MAAM,CAACob,UAAU,CAAC,IAAI,CAAC;IACtC,IAAI,CAACpb,MAAM,CAACgS,KAAK,GAAG,IAAI,CAAChS,MAAM,CAACgS,KAAK;IAErC,IAAI7U,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI6K,CAAC,IAAI,IAAI,EAAE;MACX4W,GAAG,CAACuU,SAAS,CAACnrB,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC6C,MAAM,CAACgS,KAAK,EAAE,IAAI,CAAChS,MAAM,CAACiS,MAAM,CAAC;IACjE;IAEA,IAAI8tC,IAAI,GAAG,IAAI,CAACztD,YAAY,CAAC,CAAC,CAAC;IAC/B,IAAIytD,IAAI,IAAI,IAAI,EAAE;MACdA,IAAI,GAAG,IAAI,CAACruD,UAAU,CAAC,MAAM,CAAC;IAClC,CAAC,MAAM;MACH,IAAI,CAACA,UAAU,CAAC,MAAM,CAAC,GAAGquD,IAAI;IAClC;IAEAhsC,GAAG,CAACoW,WAAW,GAAG41B,IAAI;IACtB,IAAI3iD,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI8K,CAAC,IAAI,IAAI,EAAE;MACX2W,GAAG,CAACuU,SAAS,CAAClrB,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC4C,MAAM,CAACgS,KAAK,EAAE,IAAI,CAAChS,MAAM,CAACiS,MAAM,CAAC;IACjE;IACA8B,GAAG,CAACoW,WAAW,GAAG,GAAG;IAErB,IAAI,CAAC33B,aAAa,CAAC,CAAC,EAAE,IAAI,CAACwN,MAAM,CAAC;IAClC,IAAI,CAACtB,cAAc,CAAC,IAAI,CAAC;EAC7B,CAAC;EAEDjW,SAAS,CAACiG,gBAAgB,CAAC,oBAAoB,EAAEoxD,SAAS,CAAC;EAE3D,SAASG,SAAS,GAAG;IACjB,IAAI,CAACp+C,QAAQ,CAAC,EAAE,EAAE,OAAO,CAAC;IAC1B,IAAI,CAACY,SAAS,CAAC,EAAE,EAAE,OAAO,CAAC;IAC3B,IAAI,CAAC/Q,UAAU,GAAG;MAAEsgB,KAAK,EAAE,GAAG;MAAEC,MAAM,EAAE,GAAG;MAAE7T,CAAC,EAAE,CAAC;MAAEG,CAAC,EAAE,CAAC;MAAE0R,KAAK,EAAE;IAAI,CAAC;IACrE,IAAI,CAAC/c,IAAI,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACxB;EAEA+sD,SAAS,CAAC/4D,KAAK,GAAG,MAAM;EACxB+4D,SAAS,CAAC7tD,IAAI,GAAG,YAAY;EAE7B6tD,SAAS,CAACj5D,SAAS,CAACqY,OAAO,GAAG,YAAW;IACrC,IAAI,CAAC2gD,YAAY,EAAE;EACvB,CAAC;EAEDC,SAAS,CAACj5D,SAAS,CAACg5D,YAAY,GAAG,YAAW;IAC1C,IAAI,CAAChgD,MAAM,GAAG9L,QAAQ,CAACQ,aAAa,CAAC,QAAQ,CAAC;IAC9C,IAAI,CAACsL,MAAM,CAACgS,KAAK,GAAG,IAAI,CAACtgB,UAAU,CAAC,OAAO,CAAC;IAC5C,IAAI,CAACsO,MAAM,CAACiS,MAAM,GAAG,IAAI,CAACvgB,UAAU,CAAC,QAAQ,CAAC;EAClD,CAAC;EAEDuuD,SAAS,CAACj5D,SAAS,CAACqL,SAAS,GAAG,YAAW;IACvC,IAAIwL,KAAK,GAAG,IAAI,CAACvL,YAAY,CAAC,CAAC,CAAC;IAChC,IAAI,CAACuL,KAAK,EAAE;MACR;IACJ;IAEA,IAAIA,KAAK,CAACmU,KAAK,EAAE;MACb,IAAI+B,GAAG,GAAG,IAAI,CAAC/T,MAAM,CAACob,UAAU,CAAC,IAAI,CAAC;MAEtCrH,GAAG,CAACuU,SAAS,CACTzqB,KAAK,EACL,CAAC,IAAI,CAACnM,UAAU,CAAC,GAAG,CAAC,EACrB,CAAC,IAAI,CAACA,UAAU,CAAC,GAAG,CAAC,EACrBmM,KAAK,CAACmU,KAAK,GAAG,IAAI,CAACtgB,UAAU,CAAC,OAAO,CAAC,EACtCmM,KAAK,CAACoU,MAAM,GAAG,IAAI,CAACvgB,UAAU,CAAC,OAAO,CAAC,CAC1C;MACD,IAAI,CAACc,aAAa,CAAC,CAAC,EAAE,IAAI,CAACwN,MAAM,CAAC;IACtC,CAAC,MAAM;MACH,IAAI,CAACxN,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC;IAC/B;EACJ,CAAC;EAEDytD,SAAS,CAACj5D,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACjD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACtB;IACJ;IACA,IAAI,IAAI,CAAC5L,MAAM,EAAE;MACb+T,GAAG,CAACuU,SAAS,CACT,IAAI,CAACtoB,MAAM,EACX,CAAC,EACD,CAAC,EACD,IAAI,CAACA,MAAM,CAACgS,KAAK,EACjB,IAAI,CAAChS,MAAM,CAACiS,MAAM,EAClB,CAAC,EACD,CAAC,EACD,IAAI,CAAC/e,IAAI,CAAC,CAAC,CAAC,EACZ,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CACf;IACL;EACJ,CAAC;EAED+sD,SAAS,CAACj5D,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC1D,IAAI,CAACpQ,UAAU,CAACxJ,IAAI,CAAC,GAAG4Z,KAAK;IAE7B,IAAI5Z,IAAI,IAAI,OAAO,EAAE;MACjB,IAAI,CAACwJ,UAAU,CAACxJ,IAAI,CAAC,GAAG+iD,UAAU,CAACnpC,KAAK,CAAC;MACzC,IAAI,IAAI,CAACpQ,UAAU,CAACxJ,IAAI,CAAC,IAAI,CAAC,EAAE;QAC5B2G,OAAO,CAACkE,KAAK,CAAC,gBAAgB,CAAC;QAC/B,IAAI,CAACrB,UAAU,CAACxJ,IAAI,CAAC,GAAG,GAAG;MAC/B;IACJ,CAAC,MAAM;MACH,IAAI,CAACwJ,UAAU,CAACxJ,IAAI,CAAC,GAAGs9C,QAAQ,CAAC1jC,KAAK,CAAC;IAC3C;IAEA,IAAI,CAACk+C,YAAY,EAAE;IAEnB,OAAO,IAAI;EACf,CAAC;EAEDv3D,SAAS,CAACiG,gBAAgB,CAAC,oBAAoB,EAAEuxD,SAAS,CAAC;;EAE3D;;EAEA,SAASC,UAAU,GAAG;IAClB,IAAI,CAACr+C,QAAQ,CAAC,OAAO,EAAEpZ,SAAS,CAAC0C,MAAM,CAAC;IACxC,IAAI,CAACsX,SAAS,CAAC,EAAE,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAAC/Q,UAAU,GAAG;MAAEsgB,KAAK,EAAE,GAAG;MAAEC,MAAM,EAAE,GAAG;MAAEkuC,SAAS,EAAE;IAAK,CAAC;IAE9D,IAAI,CAACngD,MAAM,GAAG9L,QAAQ,CAACQ,aAAa,CAAC,QAAQ,CAAC;IAC9C,IAAI,CAACqf,GAAG,GAAG,IAAI,CAAC/T,MAAM,CAACob,UAAU,CAAC,IAAI,CAAC;EAC3C;EAEA8kC,UAAU,CAACh5D,KAAK,GAAG,QAAQ;EAC3Bg5D,UAAU,CAAC9tD,IAAI,GAAG,wBAAwB;EAE1C8tD,UAAU,CAACl5D,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAI2N,MAAM,GAAG,IAAI,CAACA,MAAM;IACxB,IAAIyG,CAAC,GAAG,IAAI,CAAC/U,UAAU,CAACsgB,KAAK,GAAG,CAAC;IACjC,IAAImR,CAAC,GAAG,IAAI,CAACzxB,UAAU,CAACugB,MAAM,GAAG,CAAC;IAClC,IAAIjS,MAAM,CAACgS,KAAK,IAAIvL,CAAC,EAAE;MACnBzG,MAAM,CAACgS,KAAK,GAAGvL,CAAC;IACpB;IACA,IAAIzG,MAAM,CAACiS,MAAM,IAAIkR,CAAC,EAAE;MACpBnjB,MAAM,CAACiS,MAAM,GAAGkR,CAAC;IACrB;IAEA,IAAI,IAAI,CAACzxB,UAAU,CAACyuD,SAAS,EAAE;MAC3B,IAAI,CAACpsC,GAAG,CAACsU,SAAS,CAAC,CAAC,EAAE,CAAC,EAAEroB,MAAM,CAACgS,KAAK,EAAEhS,MAAM,CAACiS,MAAM,CAAC;IACzD;IACA,IAAI,CAACzf,aAAa,CAAC,CAAC,EAAEwN,MAAM,CAAC;EACjC,CAAC;EAEDkgD,UAAU,CAACl5D,SAAS,CAACsa,QAAQ,GAAG,UAAStC,MAAM,EAAEuC,KAAK,EAAE;IACpD,IAAIvC,MAAM,IAAI,OAAO,EAAE;MACnB,IAAI,CAAC+U,GAAG,CAACsU,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAACroB,MAAM,CAACgS,KAAK,EAAE,IAAI,CAAChS,MAAM,CAACiS,MAAM,CAAC;IACnE;EACJ,CAAC;EAEDxpB,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAEwxD,UAAU,CAAC;EAEzD,SAASE,aAAa,GAAG;IACrB,IAAI,CAACv+C,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC;IACjC,IAAI,CAACA,QAAQ,CAAC,KAAK,EAAE,cAAc,CAAC;IACpC,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACnQ,UAAU,GAAG;MAAE0M,CAAC,EAAE,CAAC;MAAEG,CAAC,EAAE,CAAC;MAAE8hD,OAAO,EAAE;IAAE,CAAC;EAChD;EAEAD,aAAa,CAACl5D,KAAK,GAAG,WAAW;EACjCk5D,aAAa,CAAChuD,IAAI,GAAG,2BAA2B;EAEhDguD,aAAa,CAACp5D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC3C,IAAI2N,MAAM,GAAG,IAAI,CAAC1N,YAAY,CAAC,CAAC,CAAC;IACjC,IAAI,CAAC0N,MAAM,EAAE;MACT;IACJ;IAEA,IAAIqP,GAAG,GAAG,IAAI,CAACpH,kBAAkB,CAAC,KAAK,CAAC;IACxC,IAAI,CAACoH,GAAG,EAAE;MACN;IACJ;IAEA,IAAIjR,CAAC,GAAG,IAAI,CAAC6J,kBAAkB,CAAC,GAAG,CAAC;IACpC,IAAI1J,CAAC,GAAG,IAAI,CAAC0J,kBAAkB,CAAC,GAAG,CAAC;IACpC,IAAI8L,GAAG,GAAG/T,MAAM,CAACob,UAAU,CAAC,IAAI,CAAC;IACjCrH,GAAG,CAACuU,SAAS,CAACjZ,GAAG,EAAEjR,CAAC,EAAEG,CAAC,CAAC;EAC5B,CAAC;EAED9V,SAAS,CAACiG,gBAAgB,CAAC,oBAAoB,EAAE0xD,aAAa,CAAC;EAE/D,SAASE,iBAAiB,GAAG;IACzB,IAAI,CAACz+C,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC;IACjC,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACnQ,UAAU,GAAG;MACd0M,CAAC,EAAE,CAAC;MACJG,CAAC,EAAE,CAAC;MACJkI,CAAC,EAAE,EAAE;MACL0c,CAAC,EAAE,EAAE;MACLtd,KAAK,EAAE,OAAO;MACdw6C,OAAO,EAAE;IACb,CAAC;EACL;EAEAC,iBAAiB,CAACp5D,KAAK,GAAG,eAAe;EACzCo5D,iBAAiB,CAACluD,IAAI,GAAG,2BAA2B;EAEpDkuD,iBAAiB,CAACt5D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC/C,IAAI2N,MAAM,GAAG,IAAI,CAAC1N,YAAY,CAAC,CAAC,CAAC;IACjC,IAAI,CAAC0N,MAAM,EAAE;MACT;IACJ;IAEA,IAAI5B,CAAC,GAAG,IAAI,CAAC6J,kBAAkB,CAAC,GAAG,CAAC;IACpC,IAAI1J,CAAC,GAAG,IAAI,CAAC0J,kBAAkB,CAAC,GAAG,CAAC;IACpC,IAAIxB,CAAC,GAAG,IAAI,CAACwB,kBAAkB,CAAC,GAAG,CAAC;IACpC,IAAIkb,CAAC,GAAG,IAAI,CAAClb,kBAAkB,CAAC,GAAG,CAAC;IACpC,IAAI8L,GAAG,GAAG/T,MAAM,CAACob,UAAU,CAAC,IAAI,CAAC;IACjCrH,GAAG,CAACoY,QAAQ,CAAC/tB,CAAC,EAAEG,CAAC,EAAEkI,CAAC,EAAE0c,CAAC,CAAC;EAC5B,CAAC;EAED16B,SAAS,CAACiG,gBAAgB,CAAC,wBAAwB,EAAE4xD,iBAAiB,CAAC;EAEvE,SAASC,UAAU,GAAG;IAClB,IAAI,CAAC1+C,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC5B,IAAI,CAACoI,UAAU,CAAC,CAAC,CAAC,OAAO,EAAE,OAAO,CAAC,EAAE,CAAC,GAAG,EAAE,QAAQ,CAAC,EAAE,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC,CAAC;IACvE,IAAI,CAACvY,UAAU,GAAG;MAAEmE,GAAG,EAAE,EAAE;MAAE2qD,SAAS,EAAE;IAAK,CAAC;EAClD;EAEAD,UAAU,CAACr5D,KAAK,GAAG,OAAO;EAC1Bq5D,UAAU,CAACnuD,IAAI,GAAG,gBAAgB;EAClCmuD,UAAU,CAAC/5C,OAAO,GAAG,CACjB;IAAEte,IAAI,EAAE,MAAM;IAAEoO,IAAI,EAAE,MAAM;IAAE3H,IAAI,EAAE;EAAa,CAAC,EAClD;IAAEzG,IAAI,EAAE,MAAM;IAAEoO,IAAI,EAAE,MAAM;IAAE3H,IAAI,EAAE;EAAa,CAAC,EAClD;IAAEzG,IAAI,EAAE,MAAM;IAAEoO,IAAI,EAAE,YAAY;IAAE3H,IAAI,EAAE;EAAS,CAAC,EACpD;IAAEzG,IAAI,EAAE,MAAM;IAAEoO,IAAI,EAAE,YAAY;IAAE3H,IAAI,EAAE;EAAS,CAAC,CACvD;EAED4xD,UAAU,CAACv5D,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxC,IAAI,CAAC,IAAI,CAACX,UAAU,CAACmE,GAAG,EAAE;MACtB;IACJ;IAEA,IAAI,IAAI,CAACnE,UAAU,CAACmE,GAAG,IAAI,IAAI,CAAC4qD,UAAU,EAAE;MACxC,IAAI,CAACC,SAAS,CAAC,IAAI,CAAChvD,UAAU,CAACmE,GAAG,CAAC;IACvC;IAEA,IAAI,CAAC,IAAI,CAAC8qD,MAAM,IAAI,IAAI,CAACA,MAAM,CAAC3uC,KAAK,IAAI,CAAC,EAAE;MACxC;IACJ;IAEA,IAAIza,CAAC,GAAG,IAAI,CAACjF,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAIiF,CAAC,IAAIA,CAAC,IAAI,CAAC,IAAIA,CAAC,IAAI,GAAG,EAAE;MACzB,IAAI,CAACopD,MAAM,CAACC,WAAW,GAAGrpD,CAAC,GAAG,IAAI,CAACopD,MAAM,CAAChK,QAAQ;MAClD,IAAI,CAACgK,MAAM,CAACE,KAAK,EAAE;IACvB;IAEA,IAAI,CAACF,MAAM,CAACzB,KAAK,GAAG,IAAI;IACxB,IAAI,CAAC1sD,aAAa,CAAC,CAAC,EAAE,IAAI,CAACmuD,MAAM,CAAC;IAClC,IAAI,CAACnuD,aAAa,CAAC,CAAC,EAAE,IAAI,CAACmuD,MAAM,CAACC,WAAW,CAAC;IAC9C,IAAI,CAACpuD,aAAa,CAAC,CAAC,EAAE,IAAI,CAACmuD,MAAM,CAAChK,QAAQ,CAAC;IAC3C,IAAI,CAACj4C,cAAc,CAAC,IAAI,CAAC;EAC7B,CAAC;EAED6hD,UAAU,CAACv5D,SAAS,CAAC2oD,OAAO,GAAG,YAAW;IACtC,IAAI,CAACmR,IAAI,EAAE;EACf,CAAC;EAEDP,UAAU,CAACv5D,SAAS,CAAC+5D,MAAM,GAAG,YAAW;IACrC,IAAI,CAAC7oD,IAAI,EAAE;EACf,CAAC;EAEDqoD,UAAU,CAACv5D,SAAS,CAAC05D,SAAS,GAAG,UAAS7qD,GAAG,EAAE;IAC3C,IAAI,CAAC4qD,UAAU,GAAG5qD,GAAG;IAE3B,IAAI3G,GAAG,GAAG2G,GAAG,CAACxG,MAAM,CAAC,CAAC,EAAC,EAAE,CAAC,CAAC+F,OAAO,CAAC,GAAG,CAAC;IACvC,IAAI4rD,QAAQ,GAAG,EAAE;IACjB,IAAG9xD,GAAG,IAAI,CAAC,CAAC,EACX8xD,QAAQ,GAAGnrD,GAAG,CAACxG,MAAM,CAAC,CAAC,EAACH,GAAG,CAAC;IAE7B,IAAI+xD,IAAI,GAAG,EAAE;IACb,IAAGD,QAAQ,EACX;MACCC,IAAI,GAAGprD,GAAG,CAACxG,MAAM,CAAC,CAAC,EAACwG,GAAG,CAACT,OAAO,CAAC,GAAG,EAAC4rD,QAAQ,CAAC96D,MAAM,GAAG,CAAC,CAAC,CAAC;MACzD+6D,IAAI,GAAGA,IAAI,CAAC5xD,MAAM,CAAC2xD,QAAQ,CAAC96D,MAAM,GAAC,CAAC,CAAC;IACtC;IAEM,IACI,IAAI,CAACwL,UAAU,CAAC8uD,SAAS,IACzBQ,QAAQ,IACRv4D,SAAS,CAAC+D,KAAK,IACxBy0D,IAAI,IAAI3sD,QAAQ,CAAC2sD,IAAI,EACd;MACEprD,GAAG,GAAGpN,SAAS,CAAC+D,KAAK,GAAGqJ,GAAG,CAACxG,MAAM,CAACwG,GAAG,CAACT,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;IAC5D;IAEA,IAAI,CAACurD,MAAM,GAAGzsD,QAAQ,CAACQ,aAAa,CAAC,OAAO,CAAC;IAC7C,IAAI,CAACisD,MAAM,CAACnsD,GAAG,GAAGqB,GAAG;IACrB,IAAI,CAAC8qD,MAAM,CAAChyD,IAAI,GAAG,gBAAgB;IAEnC,IAAI,CAACgyD,MAAM,CAACO,KAAK,GAAG,IAAI;IACxB,IAAI,CAACP,MAAM,CAACQ,QAAQ,GAAG,IAAI;IAE3B,IAAInrD,IAAI,GAAG,IAAI;IACf,IAAI,CAAC2qD,MAAM,CAACx7C,gBAAgB,CAAC,gBAAgB,EAAE,UAAS7f,CAAC,EAAE;MACvD;MACAuJ,OAAO,CAACC,GAAG,CAAC,YAAY,GAAG,IAAI,CAAC6nD,QAAQ,GAAG,UAAU,CAAC;MACtD9nD,OAAO,CAACC,GAAG,CAAC,QAAQ,GAAG,IAAI,CAAC4wD,UAAU,GAAG,GAAG,GAAG,IAAI,CAACC,WAAW,CAAC;MAChE3pD,IAAI,CAAC0I,cAAc,CAAC,IAAI,CAAC;MACzB,IAAI,CAACsT,KAAK,GAAG,IAAI,CAAC0tC,UAAU;MAC5B,IAAI,CAACztC,MAAM,GAAG,IAAI,CAAC0tC,WAAW;IAClC,CAAC,CAAC;IACF,IAAI,CAACgB,MAAM,CAACx7C,gBAAgB,CAAC,UAAU,EAAE,UAAS7f,CAAC,EAAE;MACjD;MACAuJ,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;IACnC,CAAC,CAAC;IACF,IAAI,CAAC6xD,MAAM,CAACx7C,gBAAgB,CAAC,OAAO,EAAE,UAAS7f,CAAC,EAAE;MAC9CuJ,OAAO,CAACkE,KAAK,CAAC,uBAAuB,GAAG,IAAI,CAACyB,GAAG,CAAC;MACjD,IAAI,IAAI,CAACzB,KAAK,EAAE;QACZ,QAAQ,IAAI,CAACA,KAAK,CAACnB,IAAI;UACnB,KAAK,IAAI,CAACmB,KAAK,CAACquD,iBAAiB;YAC7BvyD,OAAO,CAACkE,KAAK,CAAC,wBAAwB,CAAC;YACvC;UACJ,KAAK,IAAI,CAACA,KAAK,CAACsuD,iBAAiB;YAC7BxyD,OAAO,CAACkE,KAAK,CAAC,yCAAyC,CAAC;YACxD;UACJ,KAAK,IAAI,CAACA,KAAK,CAACuuD,gBAAgB;YAC5BzyD,OAAO,CAACkE,KAAK,CAAC,mBAAmB,CAAC;YAClC;UACJ,KAAK,IAAI,CAACA,KAAK,CAACwuD,2BAA2B;YACvC1yD,OAAO,CAACkE,KAAK,CAAC,4CAA4C,CAAC;YAC3D;QAAM;MAElB;IACJ,CAAC,CAAC;IAEF,IAAI,CAAC4tD,MAAM,CAACx7C,gBAAgB,CAAC,OAAO,EAAE,UAAS7f,CAAC,EAAE;MAC9CuJ,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;MAC3B,IAAI,CAACgyD,IAAI,EAAE,CAAC,CAAC;IACjB,CAAC,CAAC;;IAEF;EACJ,CAAC;;EAEDP,UAAU,CAACv5D,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC3D,IAAI,CAACpQ,UAAU,CAACxJ,IAAI,CAAC,GAAG4Z,KAAK;IAC7B,IAAI5Z,IAAI,IAAI,KAAK,IAAI4Z,KAAK,IAAI,EAAE,EAAE;MAC9B,IAAI,CAAC4+C,SAAS,CAAC5+C,KAAK,CAAC;IACzB;IAEA,OAAO,IAAI;EACf,CAAC;EAEDy+C,UAAU,CAACv5D,SAAS,CAAC85D,IAAI,GAAG,YAAW;IACnC,IAAI,IAAI,CAACH,MAAM,IAAI,IAAI,CAACA,MAAM,CAACjB,UAAU,EAAG;MAAE;MAC1C,IAAI,CAACiB,MAAM,CAACG,IAAI,EAAE;IACtB;EACJ,CAAC;EAEDP,UAAU,CAACv5D,SAAS,CAACw6D,SAAS,GAAG,YAAW;IACxC,IAAI,CAAC,IAAI,CAACb,MAAM,EAAE;MACd;IACJ;IACA,IAAI,IAAI,CAACA,MAAM,CAACc,MAAM,EAAE;MACpB,IAAI,CAACX,IAAI,EAAE;IACf,CAAC,MAAM;MACH,IAAI,CAACD,KAAK,EAAE;IAChB;EACJ,CAAC;EAEDN,UAAU,CAACv5D,SAAS,CAACkR,IAAI,GAAG,YAAW;IACnC,IAAI,CAAC,IAAI,CAACyoD,MAAM,EAAE;MACd;IACJ;IACA,IAAI,CAACA,MAAM,CAACE,KAAK,EAAE;IACnB,IAAI,CAACF,MAAM,CAACC,WAAW,GAAG,CAAC;EAC/B,CAAC;EAEDL,UAAU,CAACv5D,SAAS,CAAC65D,KAAK,GAAG,YAAW;IACpC,IAAI,CAAC,IAAI,CAACF,MAAM,EAAE;MACd;IACJ;IACA9xD,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;IAC3B,IAAI,CAAC6xD,MAAM,CAACE,KAAK,EAAE;EACvB,CAAC;EAEDN,UAAU,CAACv5D,SAAS,CAACm4D,QAAQ,GAAG,UAAS75D,CAAC,EAAEgmB,MAAM,EAAE;IAChD;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EAnBQ,CAoBH;EAED7iB,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAE6xD,UAAU,CAAC;;EAExD;EACA,SAASmB,WAAW,GAAG;IACnB,IAAI,CAACj/C,SAAS,CAAC,QAAQ,EAAE,OAAO,CAAC;IACjC,IAAI,CAAC/Q,UAAU,GAAG;MAAEiwD,gBAAgB,EAAE,KAAK;MAAEC,UAAU,EAAE;IAAO,CAAC;IACjE,IAAI,CAAC96C,QAAQ,GAAG,OAAO;IACvB,IAAI,CAACkS,KAAK,GAAG,CAAC;EAClB;EAEA0oC,WAAW,CAACx6D,KAAK,GAAG,QAAQ;EAC5Bw6D,WAAW,CAACtvD,IAAI,GAAG,cAAc;EACjCsvD,WAAW,CAACG,cAAc,GAAG,KAAK;EAElCH,WAAW,CAAC16D,SAAS,CAAC86D,UAAU,GAAG,YAAW;IAC1C,IAAI,CAACxN,SAAS,CAACyN,YAAY,CAACC,YAAY,EAAE;MACtCnzD,OAAO,CAACC,GAAG,CAAC,kGAAkG,CAAC;MAC/G;IACJ;IAEA,IAAI,CAACmzD,qBAAqB,GAAG,IAAI;;IAEjC;IACA,IAAIC,WAAW,GAAG;MACdC,KAAK,EAAE,KAAK;MACZC,KAAK,EAAE,CAAC,IAAI,CAAC1wD,UAAU,CAACiwD,gBAAgB,GAAG,IAAI,GAAG;QAAEC,UAAU,EAAE,IAAI,CAAClwD,UAAU,CAACkwD;MAAW;IAC/F,CAAC;IACDtN,SAAS,CAACyN,YAAY,CACjBC,YAAY,CAACE,WAAW,CAAC,CACzBhsD,IAAI,CAAC,IAAI,CAACmsD,WAAW,CAAChrD,IAAI,CAAC,IAAI,CAAC,CAAC,CACjCZ,KAAK,CAAC6rD,YAAY,CAAC;IAExB,IAAItsD,IAAI,GAAG,IAAI;IACf,SAASssD,YAAY,CAACh9D,CAAC,EAAE;MACrBuJ,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAExJ,CAAC,CAAC;MACjC0Q,IAAI,CAACusD,cAAc,GAAG,KAAK;MAC3Bb,WAAW,CAACG,cAAc,GAAG,KAAK;MAClC7rD,IAAI,CAAC8Q,QAAQ,GAAG,KAAK;MACrB9Q,IAAI,CAAC2L,OAAO,CAAC,cAAc,CAAC;IAChC;EACJ,CAAC;EAED+/C,WAAW,CAAC16D,SAAS,CAACw7D,WAAW,GAAG,YAAW;IAC3C,IAAI,IAAI,CAACD,cAAc,EAAE;MACrB,IAAIE,MAAM,GAAG,IAAI,CAACF,cAAc,CAACG,SAAS,EAAE;MAC5C,IAAID,MAAM,CAACv8D,MAAM,EAAE;QACf,KAAK,IAAIU,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG67D,MAAM,CAACv8D,MAAM,EAAE,EAAEU,CAAC,EAAE;UACpC67D,MAAM,CAAC77D,CAAC,CAAC,CAACsR,IAAI,EAAE;QACpB;MACJ;MACAwpD,WAAW,CAACG,cAAc,GAAG,KAAK;MAClC,IAAI,CAACU,cAAc,GAAG,IAAI;MAC1B,IAAI,CAAC5B,MAAM,GAAG,IAAI;MAClB,IAAI,CAAC75C,QAAQ,GAAG,OAAO;MACvB,IAAI,CAACnF,OAAO,CAAC,eAAe,CAAC;IACjC;EACJ,CAAC;EAED+/C,WAAW,CAAC16D,SAAS,CAACsf,iBAAiB,GAAG,UAASpe,IAAI,EAAE4Z,KAAK,EAAE;IAC5D,IAAI5Z,IAAI,IAAI,YAAY,EAAE;MACtB,IAAI,CAACwJ,UAAU,CAACkwD,UAAU,GAAG9/C,KAAK;MAClC,IAAI,CAAC0gD,WAAW,EAAE;MAClB,IAAI,CAACV,UAAU,EAAE;IACrB;EACJ,CAAC;EAEDJ,WAAW,CAAC16D,SAAS,CAACwR,SAAS,GAAG,YAAW;IACzC,IAAI,CAACgqD,WAAW,EAAE;EACtB,CAAC;EAEDd,WAAW,CAAC16D,SAAS,CAACq7D,WAAW,GAAG,UAASM,gBAAgB,EAAE;IAC3D,IAAI,CAACJ,cAAc,GAAGI,gBAAgB;IACtC;IACA,IAAI,CAAC77C,QAAQ,GAAG,OAAO;IAEvB,IAAIs7C,KAAK,GAAG,IAAI,CAACzB,MAAM;IACvB,IAAI,CAACyB,KAAK,EAAE;MACRA,KAAK,GAAGluD,QAAQ,CAACQ,aAAa,CAAC,OAAO,CAAC;MACvC0tD,KAAK,CAACjB,QAAQ,GAAG,IAAI;MACrBiB,KAAK,CAACQ,SAAS,GAAGD,gBAAgB;MAClC,IAAI,CAAChC,MAAM,GAAGyB,KAAK;MACnB;MACA;MACAA,KAAK,CAACS,gBAAgB,GAAG,UAASv9D,CAAC,EAAE;QACjC;QACAuJ,OAAO,CAACC,GAAG,CAACxJ,CAAC,CAAC;QACdo8D,WAAW,CAACG,cAAc,GAAG,IAAI;MACrC,CAAC;IACL;IAEA,IAAI,CAAClgD,OAAO,CAAC,cAAc,EAAEygD,KAAK,CAAC;EACvC,CAAC;EAEDV,WAAW,CAAC16D,SAAS,CAACqL,SAAS,GAAG,YAAW;IACzC,IAAI,IAAI,CAACkwD,cAAc,IAAI,IAAI,IAAI,CAAC,IAAI,CAACN,qBAAqB,EAAE;MAC5D,IAAI,CAACH,UAAU,EAAE;IACrB;IAEA,IAAI,CAAC,IAAI,CAACnB,MAAM,IAAI,CAAC,IAAI,CAACA,MAAM,CAACjB,UAAU,EAAE;MACzC;IACJ;IAEA,IAAI,CAACiB,MAAM,CAAC3nC,KAAK,GAAG,EAAE,IAAI,CAACA,KAAK;IAChC,IAAI,CAAC2nC,MAAM,CAAC3uC,KAAK,GAAG,IAAI,CAAC2uC,MAAM,CAACjB,UAAU;IAC1C,IAAI,CAACiB,MAAM,CAAC1uC,MAAM,GAAG,IAAI,CAAC0uC,MAAM,CAAChB,WAAW;IAC5C,IAAI,CAACntD,aAAa,CAAC,CAAC,EAAE,IAAI,CAACmuD,MAAM,CAAC;IAClC,KAAK,IAAI/5D,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC5T,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC1C,IAAI,CAAC,IAAI,CAACkT,OAAO,CAAClT,CAAC,CAAC,EAAE;QAClB;MACJ;MACA,QAAQ,IAAI,CAACkT,OAAO,CAAClT,CAAC,CAAC,CAACsB,IAAI;QACxB,KAAK,OAAO;UACR,IAAI,CAACsK,aAAa,CAAC5L,CAAC,EAAE,IAAI,CAAC+5D,MAAM,CAACjB,UAAU,CAAC;UAC7C;QACJ,KAAK,QAAQ;UACT,IAAI,CAACltD,aAAa,CAAC5L,CAAC,EAAE,IAAI,CAAC+5D,MAAM,CAAChB,WAAW,CAAC;UAC9C;MAAM;IAElB;EACJ,CAAC;EAED+B,WAAW,CAAC16D,SAAS,CAAC07C,mBAAmB,GAAG,UAASxoC,WAAW,EAAE;IAC9D,IAAIlE,IAAI,GAAG,IAAI;IACf,IAAI8sD,GAAG,GAAG,CAAC9sD,IAAI,CAACtE,UAAU,CAACkuD,IAAI,GAAG,YAAY,GAAG,YAAY;IAC7D,OAAO,CACH;MACIpqB,OAAO,EAAEstB,GAAG;MACZ59C,QAAQ,EAAE,oBAAW;QACjBlP,IAAI,CAACtE,UAAU,CAACkuD,IAAI,GAAG,CAAC5pD,IAAI,CAACtE,UAAU,CAACkuD,IAAI;MAChD;IACJ,CAAC,CACJ;EACL,CAAC;EAED8B,WAAW,CAAC16D,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACnD,IACI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,IACpB,IAAI,CAAC1Y,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,IAClB,CAAC,IAAI,CAACxB,UAAU,CAACkuD,IAAI,EACvB;MACE;IACJ;IAEA,IAAI,CAAC,IAAI,CAACe,MAAM,EAAE;MACd;IACJ;;IAEA;IACA5sC,GAAG,CAACmU,IAAI,EAAE;IACVnU,GAAG,CAACuU,SAAS,CAAC,IAAI,CAACq4B,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAACztD,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC;IAC5D6gB,GAAG,CAACgU,OAAO,EAAE;EACjB,CAAC;EAED25B,WAAW,CAAC16D,SAAS,CAAC2vC,YAAY,GAAG,YAAW;IAC5C,OAAO,CACH,CAAC,OAAO,EAAE,QAAQ,CAAC,EACnB,CAAC,QAAQ,EAAE,QAAQ,CAAC,EACpB,CAAC,cAAc,EAAEluC,SAAS,CAACyC,KAAK,CAAC,EACjC,CAAC,eAAe,EAAEzC,SAAS,CAACyC,KAAK,CAAC,EAClC,CAAC,cAAc,EAAEzC,SAAS,CAACyC,KAAK,CAAC,CACpC;EACL,CAAC;EAEDzC,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAEgzD,WAAW,CAAC;AAC9D,CAAC,EAAE,IAAI,CAAC;AAER,CAAC,UAASl5D,MAAM,EAAE;EACd,IAAIC,SAAS,GAAGD,MAAM,CAACC,SAAS;EACnC,IAAI0R,YAAY,GAAG3R,MAAM,CAAC2R,YAAY;;EAEnC;EACA3R,MAAM,CAACu6D,aAAa,GAAG,IAAI;EAE3B,IAAI,OAAOjmC,EAAE,IAAI,WAAW,EAC9B;EAED3iB,YAAY,CAAC0e,gBAAgB,CAAC,SAAS,CAAC,GAAG,MAAM;EAEjD,SAASkqC,aAAa,GAAG;IACxB,IAAI,CAACtgD,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;IAChC,IAAI,CAACA,SAAS,CAAC,MAAM,EAAE,QAAQ,CAAC;IAChC,IAAI,CAAC/Q,UAAU,GAAG;MAAExJ,IAAI,EAAE,EAAE;MAAEsL,MAAM,EAAE;IAAK,CAAC;IAC5C,IAAI,CAACN,IAAI,GAAG,CACX6vD,aAAa,CAACC,kBAAkB,EAChCD,aAAa,CAACC,kBAAkB,CAChC;EACF;EAEAx6D,MAAM,CAACu6D,aAAa,GAAGA,aAAa;EAEpCA,aAAa,CAAC77D,KAAK,GAAG,SAAS;EAC/B67D,aAAa,CAAC3wD,IAAI,GAAG,SAAS;EAC9B2wD,aAAa,CAAC33C,YAAY,GAAG;IAC5BljB,IAAI,EAAE;MAAEojB,MAAM,EAAE;IAAU,CAAC;IAC3B9X,MAAM,EAAE;MAAE8X,MAAM,EAAE;IAAW;EAC9B,CAAC;;EAED;EACAy3C,aAAa,CAACE,mBAAmB,GAAG,IAAI,CAAC,CAAC;EAC1CF,aAAa,CAACC,kBAAkB,GAAG,GAAG;;EAEtC;EACAD,aAAa,CAACG,SAAS,GAAG,CAAC,CAAC,CAAC;EAC7BH,aAAa,CAACI,YAAY,GAAG,CAAC,CAAC,CAAC;EAChCJ,aAAa,CAACK,IAAI,GAAG,CAAC,CAAC,CAAC;EACxBL,aAAa,CAACM,GAAG,GAAG,CAAC,CAAC,CAAC;EACvBN,aAAa,CAACO,IAAI,GAAG,CAAC,CAAC,CAAC;EACxBP,aAAa,CAACQ,KAAK,GAAG,CAAC,CAAC,CAAC;EACzBR,aAAa,CAACS,OAAO,GAAG,CAAC,CAAC,CAAC;;EAE3BT,aAAa,CAACU,WAAW,GAAG;IAC3B,WAAW,EAAEV,aAAa,CAACG,SAAS;IACpC,cAAc,EAAEH,aAAa,CAACI,YAAY;IAC1CO,IAAI,EAAEX,aAAa,CAACK,IAAI;IACxBO,GAAG,EAAEZ,aAAa,CAACM,GAAG;IACtBO,IAAI,EAAEb,aAAa,CAACO,IAAI;IACxBO,KAAK,EAAEd,aAAa,CAACQ,KAAK;IAC1BO,OAAO,EAAEf,aAAa,CAACS;EACxB,CAAC;;EAED;EACAT,aAAa,CAACgB,oBAAoB,GAAG,YAAW;IAC/C,OAAO/mC,EAAE,CAACgnC,QAAQ;EACnB,CAAC;;EAED;EACAjB,aAAa,CAACkB,WAAW,GAAG,UAAS/7D,IAAI,EAAE0K,OAAO,EAAE;IACnDA,OAAO,GAAGA,OAAO,IAAI,CAAC,CAAC;IACvB,IAAIiD,GAAG,GAAG3N,IAAI;IACd,IAAI2N,GAAG,CAACxG,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,SAAS,EAAE;MAClC,IAAI5G,SAAS,CAAC+D,KAAK,EAAE;QACpB;QACAqJ,GAAG,GAAGpN,SAAS,CAAC+D,KAAK,GAAGqJ,GAAG,CAACxG,MAAM,CAAC,CAAC,CAAC;MACtC;IACD;IAEA,IAAIo9C,SAAS,GAAGsW,aAAa,CAACgB,oBAAoB,EAAE;IACpD,IAAIG,GAAG,GAAIzX,SAAS,CAACvkD,IAAI,CAAC,GAAG40B,EAAE,CAACqnC,OAAO,CAACC,OAAO,CAACvuD,GAAG,EAAEjD,OAAO,CAAE;IAC9D,OAAOsxD,GAAG;EACX,CAAC;EAEDnB,aAAa,CAACsB,UAAU,GAAG,UAASn8D,IAAI,EAAE;IACzC,IAAIukD,SAAS,GAAG,IAAI,CAACsX,oBAAoB,EAAE;IAE3C,IAAI,CAACtX,SAAS,EAAE;MACf,MAAM,sDAAsD;IAC7D;IAEA,IAAIyX,GAAG,GAAGzX,SAAS,CAACvkD,IAAI,CAAC;IACzB,IAAI,CAACg8D,GAAG,IAAIh8D,IAAI,IAAIA,IAAI,CAAC,CAAC,CAAC,IAAI,GAAG,EAAE;MACnC,OAAO,IAAI,CAAC+7D,WAAW,CAAC/7D,IAAI,CAAC;IAC9B;IAEA,OAAOg8D,GAAG;EACX,CAAC;;EAED;EACAnB,aAAa,CAACuB,gBAAgB,GAAG,UAAS/d,MAAM,EAAExxC,MAAM,EAAE3B,IAAI,EAAE;IAC/D,IAAI,CAACmzC,MAAM,EAAE;MACZ,MAAM,4DAA4D;IACnE;IAEA,IAAIge,QAAQ,GAAG,IAAI;IAEnB,QAAQnxD,IAAI;MACX,KAAK2vD,aAAa,CAACM,GAAG;QACrBkB,QAAQ,GAAGvnC,EAAE,CAACwnC,aAAa;QAC3B;MACD,KAAKzB,aAAa,CAACO,IAAI;QACtBiB,QAAQ,GAAGvnC,EAAE,CAACynC,qBAAqB;QACnC;MACD,KAAK1B,aAAa,CAACQ,KAAK;QACvB,OAAOhd,MAAM;QACb;MACD,KAAKwc,aAAa,CAACK,IAAI;MACvB;QACCmB,QAAQ,GAAGhe,MAAM,GAAGA,MAAM,CAAC53C,IAAI,GAAGquB,EAAE,CAACwnC,aAAa;QAClD;IAAM;IAGR,IACC,CAACzvD,MAAM,IACPA,MAAM,CAACid,KAAK,IAAIu0B,MAAM,CAACv0B,KAAK,IAC5Bjd,MAAM,CAACkd,MAAM,IAAIs0B,MAAM,CAACt0B,MAAM,IAC9Bld,MAAM,CAACpG,IAAI,IAAI41D,QAAQ,IACvBxvD,MAAM,CAAC2vD,MAAM,IAAIne,MAAM,CAACme,MAAM,EAC7B;MACD3vD,MAAM,GAAG,IAAI+nB,EAAE,CAACqnC,OAAO,CAAC5d,MAAM,CAACv0B,KAAK,EAAEu0B,MAAM,CAACt0B,MAAM,EAAE;QACpDtjB,IAAI,EAAE41D,QAAQ;QACdG,MAAM,EAAEne,MAAM,CAACme,MAAM;QACrBlxD,MAAM,EAAEwpB,EAAE,CAAC2nC;MACZ,CAAC,CAAC;IACH;IAEA,OAAO5vD,MAAM;EACd,CAAC;EAEDguD,aAAa,CAAC6B,cAAc,GAAG,UAAS7xB,SAAS,EAAE8xB,WAAW,EAAE;IAC/D,IAAIl2D,IAAI,GAAGk2D,WAAW,GAAGA,WAAW,CAACl2D,IAAI,GAAGquB,EAAE,CAACwnC,aAAa;IAC5D,QAAQzxB,SAAS;MAChB,KAAKgwB,aAAa,CAACO,IAAI;QACtB30D,IAAI,GAAGquB,EAAE,CAACynC,qBAAqB;QAC/B;MACD,KAAK1B,aAAa,CAACM,GAAG;QACrB10D,IAAI,GAAGquB,EAAE,CAACwnC,aAAa;QACvB;MACD;IAAA;;IAED,OAAO71D,IAAI;EACZ,CAAC;EAEDo0D,aAAa,CAAC+B,eAAe,GAAG,YAAW;IAC1C,IAAI,IAAI,CAACC,cAAc,EAAE;MACxB,OAAO,IAAI,CAACA,cAAc;IAC3B;IACA,IAAIC,OAAO,GAAI,IAAI,CAACD,cAAc,GAAGjoC,EAAE,CAACqnC,OAAO,CAACc,UAAU,CACzD,CAAC,EACD,CAAC,EACD,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,EACpB;MAAEP,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;MAAEC,IAAI,EAAEnoC,EAAE,CAACooC,MAAM;MAAE5xD,MAAM,EAAEwpB,EAAE,CAACqoC;IAAQ,CAAC,CACvD;IACF,OAAOL,OAAO;EACf,CAAC;EAEDjC,aAAa,CAACuC,eAAe,GAAG,YAAW;IAC1C,IAAI,IAAI,CAACC,cAAc,EAAE;MACxB,OAAO,IAAI,CAACA,cAAc;IAC3B;IAEA,IAAIC,KAAK,GAAG,IAAIrS,UAAU,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;IACzC,KAAK,IAAIvsD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,EAAE,EAAEA,CAAC,EAAE;MACvC4+D,KAAK,CAAC5+D,CAAC,CAAC,GAAGuiB,IAAI,CAACE,MAAM,EAAE,GAAG,GAAG;IAC/B;IAEA,IAAI27C,OAAO,GAAGloC,EAAE,CAACqnC,OAAO,CAACc,UAAU,CAAC,GAAG,EAAE,GAAG,EAAEO,KAAK,EAAE;MACpDd,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;MACfC,IAAI,EAAEnoC,EAAE,CAACooC,MAAM;MACf5xD,MAAM,EAAEwpB,EAAE,CAACqoC;IACZ,CAAC,CAAC;IACF,IAAI,CAACE,cAAc,GAAGP,OAAO;IAC7B,OAAOA,OAAO;EACf,CAAC;EAEDjC,aAAa,CAAC/7D,SAAS,CAACy+B,UAAU,GAAG,UAAS9vB,IAAI,EAAEmwB,QAAQ,EAAED,IAAI,EAAE;IACnE,IAAI,CAAClwB,IAAI,EAAE;MACV,IAAI,CAAC8vD,aAAa,GAAG,IAAI;MACzB,IAAI,CAAC/zD,UAAU,CAACxJ,IAAI,GAAG,EAAE;IAC1B,CAAC,MAAM;MACN,IAAI88D,OAAO,GAAG,IAAI;MAClB,IAAI,OAAOrvD,IAAI,IAAI,QAAQ,EAAE;QAC5BqvD,OAAO,GAAGloC,EAAE,CAACqnC,OAAO,CAACC,OAAO,CAACzuD,IAAI,CAAC;MACnC,CAAC,MAAM,IAAImwB,QAAQ,CAACv1B,WAAW,EAAE,CAAC6E,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE;QACxD4vD,OAAO,GAAGloC,EAAE,CAACqnC,OAAO,CAACuB,eAAe,CAAC/vD,IAAI,CAAC;MAC3C,CAAC,MAAM;QACN,IAAIa,IAAI,GAAG,IAAIG,IAAI,CAAC,CAACkvB,IAAI,CAAC,CAAC;QAC3B,IAAIhwB,GAAG,GAAGm3C,GAAG,CAACC,eAAe,CAACz2C,IAAI,CAAC;QACnCwuD,OAAO,GAAGloC,EAAE,CAACqnC,OAAO,CAACC,OAAO,CAACvuD,GAAG,CAAC;MAClC;MAEA,IAAI,CAAC4vD,aAAa,GAAGT,OAAO;MAC5B,IAAI,CAACtzD,UAAU,CAACxJ,IAAI,GAAG49B,QAAQ;IAChC;EACD,CAAC;EAEDi9B,aAAa,CAAC/7D,SAAS,CAAC07C,mBAAmB,GAAG,UAASxoC,WAAW,EAAE;IACnE,IAAIlE,IAAI,GAAG,IAAI;IACf,IAAI,CAAC,IAAI,CAACyvD,aAAa,EAAE;MACxB;IACD;IACA,OAAO,CACN;MACCjwB,OAAO,EAAE,OAAO;MAChBtwB,QAAQ,EAAE,oBAAW;QACpBlP,IAAI,CAACyvD,aAAa,GAAG,IAAI;QACzBzvD,IAAI,CAACtE,UAAU,CAACxJ,IAAI,GAAG,EAAE;MAC1B;IACD,CAAC,CACD;EACF,CAAC;EAED66D,aAAa,CAAC/7D,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC9C,IAAI6xD,GAAG,GAAG,IAAI;IACd,IAAI,IAAI,CAAC97C,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC9B87C,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC3B;IAEA,IAAI,CAAC4xD,GAAG,IAAI,IAAI,CAACuB,aAAa,EAAE;MAC/BvB,GAAG,GAAG,IAAI,CAACuB,aAAa;IACzB;IAEA,IAAI,CAACvB,GAAG,IAAI,IAAI,CAACxyD,UAAU,CAACxJ,IAAI,EAAE;MACjCg8D,GAAG,GAAGnB,aAAa,CAACsB,UAAU,CAAC,IAAI,CAAC3yD,UAAU,CAACxJ,IAAI,CAAC;IACrD;IAEA,IAAI,CAACg8D,GAAG,EAAE;MACT,IAAI,CAAC1xD,aAAa,CAAE,CAAC,EAAE,IAAI,CAAE;MAC7B,IAAI,CAACA,aAAa,CAAE,CAAC,EAAE,EAAE,CAAE;MAC3B;IACD;IAEA,IAAI,CAACmzD,SAAS,GAAGzB,GAAG;IAEpB,IAAI,IAAI,CAACxyD,UAAU,CAAC8B,MAAM,KAAK,KAAK,EAAE;MACrC0wD,GAAG,CAAC0B,YAAY,CAAC5oC,EAAE,CAAC6oC,kBAAkB,EAAE7oC,EAAE,CAACqoC,OAAO,CAAC;IACpD,CAAC,MAAM;MACNnB,GAAG,CAAC0B,YAAY,CAAC5oC,EAAE,CAAC6oC,kBAAkB,EAAE7oC,EAAE,CAAC2nC,MAAM,CAAC;IACnD;IAEA,IAAI,CAACnyD,aAAa,CAAE,CAAC,EAAE0xD,GAAG,CAAE;IAC5B,IAAI,CAAC1xD,aAAa,CAAE,CAAC,EAAE0xD,GAAG,CAAC4B,QAAQ,IAAI5B,GAAG,CAACp+B,QAAQ,CAAE;IAErD,KAAK,IAAIl/B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACkT,OAAO,CAAC5T,MAAM,EAAEU,CAAC,EAAE,EAAE;MAC7C,IAAIiW,MAAM,GAAG,IAAI,CAAC/C,OAAO,CAAClT,CAAC,CAAC;MAC5B,IAAI,CAACiW,MAAM,EAAE;QACZ;MACD;MACA,IAAIjN,CAAC,GAAG,IAAI;MACZ,IAAIiN,MAAM,CAAC3U,IAAI,IAAI,OAAO,EAAE;QAC3B0H,CAAC,GAAGs0D,GAAG,CAAClyC,KAAK;MACd,CAAC,MAAM,IAAInV,MAAM,CAAC3U,IAAI,IAAI,QAAQ,EAAE;QACnC0H,CAAC,GAAGs0D,GAAG,CAACjyC,MAAM;MACf,CAAC,MAAM,IAAIpV,MAAM,CAAC3U,IAAI,IAAI,QAAQ,EAAE;QACnC0H,CAAC,GAAGs0D,GAAG,CAAClyC,KAAK,GAAGkyC,GAAG,CAACjyC,MAAM;MAC3B;MACA,IAAI,CAACzf,aAAa,CAAC5L,CAAC,EAAEgJ,CAAC,CAAC;IACzB;EACD,CAAC;EAEDmzD,aAAa,CAAC/7D,SAAS,CAAC++D,iBAAiB,GAAG,UAC3C5jD,QAAQ,EACR6jD,QAAQ,EACP;IACD,IAAI,IAAI,CAACt0D,UAAU,CAACxJ,IAAI,IAAIia,QAAQ,EAAE;MACrC,IAAI,CAACzQ,UAAU,CAACxJ,IAAI,GAAG89D,QAAQ;IAChC;EACD,CAAC;EAEDjD,aAAa,CAAC/7D,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACxD,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,IAAI,IAAI,CAAC1Y,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,EAAE;MAC/C;IACD;IAEA,IAAI,IAAI,CAACuyD,aAAa,IAAI1xC,GAAG,CAACkJ,KAAK,EAAE;MACpClJ,GAAG,CAACuU,SAAS,CACZ,IAAI,CAACm9B,aAAa,EAClB,CAAC,EACD,CAAC,EACD,IAAI,CAACvyD,IAAI,CAAC,CAAC,CAAC,EACZ,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CACZ;MACD;MACA;IACD;;IAEA;IACA,IAAI,IAAI,CAAC+yD,iBAAiB,IAAI,IAAI,CAACN,SAAS,EAAE;MAC7C,IAAI5xC,GAAG,CAACkJ,KAAK,EAAE;QACd,IAAI,CAACipC,OAAO,GAAG,IAAI,CAACP,SAAS;MAC9B,CAAC,MAAM;QACN,IAAIQ,UAAU,GAAGpD,aAAa,CAACqD,4BAA4B,CAC1D,IAAI,CAACT,SAAS,CACd;QACD,IAAI,CAACQ,UAAU,EAAE;UAChB;QACD;QAEA,IAAI,CAACF,iBAAiB,GAAG,IAAI,CAACN,SAAS;QACvC,IAAI,CAACO,OAAO,GAAGG,WAAW,CAACF,UAAU,CAAC;MACvC;IACD;IAEA,IAAI,CAAC,IAAI,CAACD,OAAO,EAAE;MAClB;IACD;;IAEA;IACAnyC,GAAG,CAACmU,IAAI,EAAE;IACV,IAAI,CAACnU,GAAG,CAACkJ,KAAK,EAAE;MACf;MACAlJ,GAAG,CAACC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC9gB,IAAI,CAAC,CAAC,CAAC,CAAC;MAC9B6gB,GAAG,CAAC9D,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACjB;IACA8D,GAAG,CAACuU,SAAS,CAAC,IAAI,CAAC49B,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAAChzD,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC;IAC7D6gB,GAAG,CAACgU,OAAO,EAAE;EACd,CAAC;;EAED;EACAg7B,aAAa,CAACqD,4BAA4B,GAAG,UAASlC,GAAG,EAAE;IAC1D,IAAI,CAACA,GAAG,EAAE;MACT,OAAO,IAAI;IACZ;IAEA,IAAIhxD,IAAI,GAAG6vD,aAAa,CAACC,kBAAkB;IAC3C,IAAIsD,QAAQ,GAAGpC,GAAG;IAElB,IAAIA,GAAG,CAACQ,MAAM,IAAI1nC,EAAE,CAACupC,eAAe,EAAE;MACrC,OAAO,IAAI;IACZ,CAAC,CAAC;;IAEF;IACA,IAAIrC,GAAG,CAAClyC,KAAK,GAAG9e,IAAI,IAAIgxD,GAAG,CAACjyC,MAAM,GAAG/e,IAAI,EAAE;MAC1CozD,QAAQ,GAAG,IAAI,CAACE,iBAAiB;MACjC,IAAI,CAAC,IAAI,CAACA,iBAAiB,EAAE;QAC5BF,QAAQ,GAAG,IAAIxpC,EAAE,CAACqnC,OAAO,CAACjxD,IAAI,EAAEA,IAAI,EAAE;UACrCuzD,SAAS,EAAEzpC,EAAE,CAACqoC;QACf,CAAC,CAAC;QACF,IAAI,CAACmB,iBAAiB,GAAGF,QAAQ;MAClC;;MAEA;MACApC,GAAG,CAACwC,MAAM,CAACJ,QAAQ,CAAC;MACpBpC,GAAG,GAAGoC,QAAQ;IACf;;IAEA;IACA,IAAIH,UAAU,GAAG,IAAI,CAACQ,eAAe;IACrC,IAAI,CAACR,UAAU,EAAE;MAChBA,UAAU,GAAGnG,YAAY,CAAC9sD,IAAI,EAAEA,IAAI,CAAC;MACrC,IAAI,CAACyzD,eAAe,GAAGR,UAAU;IAClC;IAEA,IAAIG,QAAQ,EAAE;MACbA,QAAQ,CAACM,QAAQ,CAACT,UAAU,CAAC;IAC9B;IACA,OAAOA,UAAU;EAClB,CAAC;EAEDpD,aAAa,CAAC/7D,SAAS,CAAC6/D,YAAY,GAAG,UAASC,GAAG,EAAE;IACpD,IAAG,IAAI,CAACp1D,UAAU,CAACxJ,IAAI,EACtB4+D,GAAG,CAAC,IAAI,CAACp1D,UAAU,CAACxJ,IAAI,CAAC,GAAG40B,EAAE,CAACqnC,OAAO;IACvC,OAAO2C,GAAG;EACX,CAAC;EAED/D,aAAa,CAAC/7D,SAAS,CAACovC,WAAW,GAAG,YAAW;IAChD,OAAO,CAAC,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;EAC3B,CAAC;EAED2sB,aAAa,CAAC/7D,SAAS,CAAC2vC,YAAY,GAAG,YAAW;IACjD,OAAO,CACN,CAAC,OAAO,EAAE,QAAQ,CAAC,EACnB,CAAC,QAAQ,EAAE,QAAQ,CAAC,EACpB,CAAC,QAAQ,EAAE,QAAQ,CAAC,CACpB;EACF,CAAC;;EAED;EACAosB,aAAa,CAACgE,WAAW,GAAG,UAAUn1D,IAAI,EAAEo1D,OAAO,EACnD;IACC,OAAOp1D,IAAI,CAACyjC,OAAO,CAAC,wBAAwB,EAAE,UAASzlC,CAAC,EAAC;MACxDA,CAAC,GAAGA,CAAC,CAACylC,OAAO,CAAE,SAAS,EAAE,EAAE,CAAE;MAC9B,OAAO2xB,OAAO,CAACp3D,CAAC,CAAC,IAAI,EAAE;IACxB,CAAC,CAAC;EACH,CAAC;EAEDnH,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAEq0D,aAAa,CAAC;;EAE5D;EACA,SAASkE,oBAAoB,GAAG;IAC/B,IAAI,CAACplD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACnQ,UAAU,GAAG;MAAEw1D,KAAK,EAAE;IAAM,CAAC;IAClC,IAAI,CAACh0D,IAAI,GAAG,CACX6vD,aAAa,CAACC,kBAAkB,EAChCD,aAAa,CAACC,kBAAkB,CAChC;EACF;EAEAiE,oBAAoB,CAAC//D,KAAK,GAAG,SAAS;EACtC+/D,oBAAoB,CAAC70D,IAAI,GAAG,oCAAoC;EAChE60D,oBAAoB,CAACE,aAAa,GAAG,KAAK;EAE1CF,oBAAoB,CAACjgE,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IAC/D,IAAI,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,EAAE;MACzB;IACD;IAEA,IAAI,CAACmI,GAAG,CAACkJ,KAAK,IAAI,CAACgqC,oBAAoB,CAACE,aAAa,EAAE;MACtD;IACD,CAAC,CAAC;;IAEF,IAAIjD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,EAAE;MACT;IACD;IAEA,IAAIiC,UAAU,GAAG,IAAI;IAErB,IAAI,CAACjC,GAAG,CAACkD,MAAM,IAAIrzC,GAAG,CAACkJ,KAAK,EAAE;MAC7BkpC,UAAU,GAAGjC,GAAG;IACjB,CAAC,MAAM;MACNiC,UAAU,GAAGpD,aAAa,CAACqD,4BAA4B,CAAClC,GAAG,CAAC;IAC7D;;IAEA;IACAnwC,GAAG,CAACmU,IAAI,EAAE;IACV,IAAI,IAAI,CAACx2B,UAAU,CAACw1D,KAAK,EAAE;MAC1BnzC,GAAG,CAACC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC9gB,IAAI,CAAC,CAAC,CAAC,CAAC;MAC9B6gB,GAAG,CAAC9D,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACjB;IACA8D,GAAG,CAACuU,SAAS,CAAC69B,UAAU,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAACjzD,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC;IAC3D6gB,GAAG,CAACgU,OAAO,EAAE;EACd,CAAC;EAEDt/B,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAEu4D,oBAAoB,CAAC;;EAEnE;;EAEA,SAASI,iBAAiB,GAAG;IAC5B,IAAI,CAACxlD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;IAChC,IAAI,CAACA,SAAS,CAAC,MAAM,EAAE,QAAQ,CAAC;IAChC,IAAI,CAAC/Q,UAAU,GAAG;MAAExJ,IAAI,EAAE,EAAE;MAAEo/D,gBAAgB,EAAE;IAAM,CAAC;EACxD;EAEAD,iBAAiB,CAACngE,KAAK,GAAG,MAAM;EAChCmgE,iBAAiB,CAACj1D,IAAI,GAAG,kCAAkC;EAE3Di1D,iBAAiB,CAACrgE,SAAS,CAACugE,iBAAiB,GAAG,YAChD;IACC,OAAO,IAAI,CAACC,QAAQ;EACrB,CAAC;EAEDH,iBAAiB,CAACrgE,SAAS,CAACqL,SAAS,GAAG,YAAW;IAClD,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,EAAE;MACT;IACD;IAEA,IAAI,IAAI,CAACxyD,UAAU,CAAC41D,gBAAgB,EAAE;MACrCpD,GAAG,CAAC7sD,IAAI,CAAC,CAAC,CAAC;MACX6sD,GAAG,CAAC0B,YAAY,CAAE5oC,EAAE,CAACyqC,kBAAkB,EAAEzqC,EAAE,CAAC0qC,oBAAoB,CAAE;MAClE1qC,EAAE,CAAC2qC,cAAc,CAACzD,GAAG,CAAC0D,YAAY,CAAC;MACnC1D,GAAG,CAAC2D,MAAM,CAAC,CAAC,CAAC;IACd;IAEA,IAAI,IAAI,CAACn2D,UAAU,CAACxJ,IAAI,EAAE;MACzB;MACA,IAAI66D,aAAa,CAAC+E,YAAY,EAAE;QAC/B/E,aAAa,CAAC+E,YAAY,CAAC,IAAI,CAACp2D,UAAU,CAACxJ,IAAI,EAAEg8D,GAAG,CAAC;MACtD,CAAC,MAAM;QACN,IAAIzX,SAAS,GAAGsW,aAAa,CAACgB,oBAAoB,EAAE;QACpDtX,SAAS,CAAC,IAAI,CAAC/6C,UAAU,CAACxJ,IAAI,CAAC,GAAGg8D,GAAG;MACtC;IACD;IAEA,IAAI,CAACsD,QAAQ,GAAGtD,GAAG;IACnB,IAAI,CAAC1xD,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;IAC1B,IAAI,CAAC1xD,aAAa,CAAC,CAAC,EAAE,IAAI,CAACd,UAAU,CAACxJ,IAAI,CAAC;EAC5C,CAAC;EAEDO,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAE24D,iBAAiB,CAAC;;EAE7D;;EAEA,SAASU,sBAAsB,GAAG;IACjC,IAAI,CAAClmD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACA,QAAQ,CAAC,UAAU,EAAE,SAAS,CAAC;IACpC,IAAI,CAACA,QAAQ,CAAC,OAAO,EAAE,QAAQ,CAAC;IAChC,IAAI,CAACY,SAAS,CAAC,SAAS,EAAE,SAAS,CAAC;IACpC,IAAI,CAACi6B,IAAI,GAAG;AACd,8OAA8O;IAE5O,IAAI,CAAChrC,UAAU,GAAG;MACjBoQ,KAAK,EAAE,CAAC;MACRkmD,SAAS,EAAE,wBAAwB;MACnCC,MAAM,EAAE,EAAE;MACVl1B,SAAS,EAAEgwB,aAAa,CAACS;IAC1B,CAAC;IAED,IAAI,CAAC0E,SAAS,GAAG,KAAK;EACvB;EAEAH,sBAAsB,CAAC38C,YAAY,GAAG;IACrC68C,MAAM,EAAE;MAAE38C,MAAM,EAAE;IAAO,CAAC;IAC1B08C,SAAS,EAAE;MAAE18C,MAAM,EAAE;IAAO,CAAC;IAC7BynB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDsE,sBAAsB,CAAC7gE,KAAK,GAAG,WAAW;EAC1C6gE,sBAAsB,CAAC31D,IAAI,GAAG,0BAA0B;EAExD21D,sBAAsB,CAACI,OAAO,GAAG,CAAC,CAAC;EAEnCJ,sBAAsB,CAAC/gE,SAAS,CAAC07C,mBAAmB,GAAG,UACtDxoC,WAAW,EACV;IACD,IAAIlE,IAAI,GAAG,IAAI;IACf,IAAI8sD,GAAG,GAAG,CAAC9sD,IAAI,CAACtE,UAAU,CAACkuD,IAAI,GAAG,cAAc,GAAG,cAAc;IACjE,OAAO,CACN;MACCpqB,OAAO,EAAEstB,GAAG;MACZ59C,QAAQ,EAAE,oBAAW;QACpBlP,IAAI,CAACtE,UAAU,CAACkuD,IAAI,GAAG,CAAC5pD,IAAI,CAACtE,UAAU,CAACkuD,IAAI;MAC7C;IACD,CAAC,CACD;EACF,CAAC;EAEDmI,sBAAsB,CAAC/gE,SAAS,CAACsf,iBAAiB,GAAG,YACrD;IACC,IAAI,CAAC4hD,SAAS,GAAG,KAAK;EACvB,CAAC;EAEDH,sBAAsB,CAAC/gE,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IACjE,IACC,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,IACpB,IAAI,CAAC1Y,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,IAClB,CAAC,IAAI,CAACxB,UAAU,CAACkuD,IAAI,EACpB;MACD;IACD;IAEA,IAAI,CAAC,IAAI,CAACwI,IAAI,EAAE;MACf;IACD;;IAEA;IACA,IAAI,IAAI,CAACA,IAAI,CAACprC,EAAE,IAAIjJ,GAAG,EAAE;MACxB;IACD;;IAEA;IACAA,GAAG,CAACmU,IAAI,EAAE;IACVnU,GAAG,CAACuU,SAAS,CAAC,IAAI,CAAC8/B,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE,IAAI,CAACl1D,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC;IAC1D6gB,GAAG,CAACgU,OAAO,EAAE;EACd,CAAC;EAEDggC,sBAAsB,CAAC/gE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACvD,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAE9B,IAAI,CAAC,IAAI,CAAC8V,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF,IAAI,IAAI,CAAC1W,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACI,YAAY,EAAE;MAC7D,IAAI,CAAC3wD,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEA,IAAImE,IAAI,GAAG,IAAI,CAAC/1D,YAAY,CAAC,CAAC,CAAC;IAE/B,IAAI,CAAC,IAAI,CAACZ,UAAU,CAACu2D,MAAM,IAAI,CAAC,IAAI,CAACv2D,UAAU,CAACs2D,SAAS,EAAE;MAC1D;IACD;IAEA,IAAIh2C,KAAK,GAAG,GAAG;IACf,IAAIC,MAAM,GAAG,GAAG;IAChB,IAAIiyC,GAAG,EAAE;MACRlyC,KAAK,GAAGkyC,GAAG,CAAClyC,KAAK;MACjBC,MAAM,GAAGiyC,GAAG,CAACjyC,MAAM;IACpB,CAAC,MAAM,IAAIo2C,IAAI,EAAE;MAChBr2C,KAAK,GAAGq2C,IAAI,CAACr2C,KAAK;MAClBC,MAAM,GAAGo2C,IAAI,CAACp2C,MAAM;IACrB;IAEA,IAAG,CAACo2C,IAAI,EACPA,IAAI,GAAGvrC,EAAE,CAACqnC,OAAO,CAACW,eAAe,EAAE;IAEpC,IAAIn2D,IAAI,GAAGo0D,aAAa,CAAC6B,cAAc,CAAE,IAAI,CAAClzD,UAAU,CAACqhC,SAAS,EAAEmxB,GAAG,CAAE;IAEzE,IAAI,CAACA,GAAG,IAAI,CAAC,IAAI,CAACkE,IAAI,EAAE;MACvB,IAAI,CAACA,IAAI,GAAG,IAAItrC,EAAE,CAACqnC,OAAO,CAACnyC,KAAK,EAAEC,MAAM,EAAE;QAAEtjB,IAAI,EAAEA,IAAI;QAAE+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QAAE1xD,MAAM,EAAEwpB,EAAE,CAAC2nC;MAAO,CAAC,CAAC;IAC9F,CAAC,MAAM;MACN,IAAI,CAACyD,IAAI,GAAGrF,aAAa,CAACuB,gBAAgB,CAAEJ,GAAG,IAAI,IAAI,CAACkE,IAAI,EAAE,IAAI,CAACA,IAAI,EAAE,IAAI,CAAC12D,UAAU,CAACqhC,SAAS,CAAE;IACrG;IAEA,IAAIk1B,MAAM,GAAG,EAAE;IACf,IAAI,IAAI,CAACv2D,UAAU,CAACu2D,MAAM,EAAE;MAC3BA,MAAM,GAAG,OAAO,GAAG,IAAI,CAACv2D,UAAU,CAACu2D,MAAM;MACzC,IAAI,IAAI,CAACv2D,UAAU,CAACu2D,MAAM,CAAC7yD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE;QAC9C;QACA6yD,MAAM,GAAG,IAAI,CAACv2D,UAAU,CAACu2D,MAAM;MAChC;IACD;IAEA,IAAID,SAAS,GAAG,EAAE;IAClB,IAAI,IAAI,CAACt2D,UAAU,CAACs2D,SAAS,EAAE;MAC9BA,SAAS,GAAG,WAAW,GAAG,IAAI,CAACt2D,UAAU,CAACs2D,SAAS;MACnD,IAAI,IAAI,CAACt2D,UAAU,CAACs2D,SAAS,CAAC5yD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE;QACjD;QACA4yD,SAAS,GAAG,IAAI,CAACt2D,UAAU,CAACs2D,SAAS;MACtC;IACD;IAEA,IAAIM,MAAM,GAAG,IAAI,CAACC,OAAO;IAEzB,IAAK,CAAC,IAAI,CAACL,SAAS,KAAK,CAACI,MAAM,IAAI,IAAI,CAACE,YAAY,IAAIP,MAAM,GAAG,GAAG,GAAGD,SAAS,CAAC,EAAG;MAEpF,IAAIS,gBAAgB,GAAG1F,aAAa,CAACgE,WAAW,CAAEgB,sBAAsB,CAACW,YAAY,EAAE;QAAEC,OAAO,EAACV,MAAM;QAAEW,UAAU,EAACZ;MAAU,CAAC,CAAC;MAEhI,IAAI;QACHM,MAAM,GAAG,IAAIxrC,EAAE,CAAC+rC,MAAM,CAAEA,MAAM,CAACC,oBAAoB,EAAEL,gBAAgB,CAAE;QACvE,IAAI,CAAC3hD,QAAQ,GAAG,SAAS;MAC1B,CAAC,CAAC,OAAOhU,GAAG,EAAE;QACb;QACAgqB,EAAE,CAAC+rC,MAAM,CAACE,kBAAkB,CAACj2D,GAAG,EAAC+1D,MAAM,CAACC,oBAAoB,EAAEL,gBAAgB,CAAC;QAC/E,IAAI,CAAC3hD,QAAQ,GAAG,SAAS;QACzB,IAAI,CAACohD,SAAS,GAAG,IAAI;QACrB;MACD;MACA,IAAI,CAACK,OAAO,GAAGD,MAAM;MACrB,IAAI,CAACE,YAAY,GAAGP,MAAM,GAAG,GAAG,GAAGD,SAAS;IAC7C;IAEA,IAAG,CAAC,IAAI,CAACO,OAAO,EACf;IAED,IAAIzmD,KAAK,GAAG,IAAI,CAACxP,YAAY,CAAC,CAAC,CAAC;IAChC,IAAIwP,KAAK,IAAI,IAAI,EAAE;MAClB,IAAI,CAACpQ,UAAU,CAACoQ,KAAK,GAAGA,KAAK;IAC9B,CAAC,MAAM;MACNA,KAAK,GAAGmpC,UAAU,CAAC,IAAI,CAACv5C,UAAU,CAACoQ,KAAK,CAAC;IAC1C;IAEA,IAAIstC,IAAI,GAAG,IAAI,CAACh1C,KAAK,CAACjD,OAAO,EAAE;IAE/B,IAAI,CAACixD,IAAI,CAACY,MAAM,CAAC,YAAW;MAC3BhsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;MACzBlsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACmsC,SAAS,CAAC;MACxBnsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;MACpB,IAAIlF,GAAG,EAAE;QACRA,GAAG,CAAC7sD,IAAI,CAAC,CAAC,CAAC;MACZ;MACA,IAAIgxD,IAAI,EAAE;QACTA,IAAI,CAAChxD,IAAI,CAAC,CAAC,CAAC;MACb;MACA,IAAIgyD,IAAI,GAAGC,IAAI,CAACC,aAAa,EAAE;MAC/BjB,MAAM,CACJkB,QAAQ,CAAC;QACTC,SAAS,EAAE,CAAC;QACZC,UAAU,EAAE,CAAC;QACb5nD,KAAK,EAAEA,KAAK;QACZ6nD,OAAO,EAAE,CAAC33C,KAAK,EAAEC,MAAM,EAAC,CAAC,GAACD,KAAK,EAAC,CAAC,GAACC,MAAM,CAAC;QACzCm9B,IAAI,EAAEA;MACP,CAAC,CAAC,CACD1xB,IAAI,CAAC2rC,IAAI,CAAC;IACb,CAAC,CAAC;IAEF,IAAI,CAAC72D,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC41D,IAAI,CAAC;EACjC,CAAC;EAEDL,sBAAsB,CAACW,YAAY,GAClC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFX,sBAAsB,CAAC6B,cAAc,GAAG,UAAW1hE,IAAI,EAAE0J,IAAI,EAC7D;IACCm2D,sBAAsB,CAACI,OAAO,CAACjgE,IAAI,CAAC,GAAG0J,IAAI;EAC5C,CAAC;EAEDm2D,sBAAsB,CAAC6B,cAAc,CAAC,EAAE,EAAC,EAAE,CAAC;EAC5C7B,sBAAsB,CAAC6B,cAAc,CAAC,QAAQ,EAAC,OAAO,CAAC;EACvD7B,sBAAsB,CAAC6B,cAAc,CAAC,KAAK,EAAC,wBAAwB,CAAC;EACrE7B,sBAAsB,CAAC6B,cAAc,CAAC,WAAW,EAAC,0BAA0B,CAAC;EAC7E7B,sBAAsB,CAAC6B,cAAc,CAAC,MAAM,EAAC,wCAAwC,CAAC;EACtF7B,sBAAsB,CAAC6B,cAAc,CAAC,QAAQ,EAAC,mBAAmB,CAAC;EACnE7B,sBAAsB,CAAC6B,cAAc,CAAC,UAAU,EAAC,wBAAwB,CAAC;EAC1E7B,sBAAsB,CAAC6B,cAAc,CAAC,QAAQ,EAAC,0BAA0B,CAAC;EAC1E7B,sBAAsB,CAAC6B,cAAc,CAAC,YAAY,EAAC,6BAA6B,CAAC;EACjF7B,sBAAsB,CAAC6B,cAAc,CAAC,KAAK,EAAC,4BAA4B,CAAC;EACzE7B,sBAAsB,CAAC6B,cAAc,CAAC,KAAK,EAAC,4BAA4B,CAAC;EACzE7B,sBAAsB,CAAC6B,cAAc,CAAC,UAAU,EAAC,gEAAgE,CAAC;EAClH7B,sBAAsB,CAAC6B,cAAc,CAAC,WAAW,EAAC,iDAAiD,CAAC;EACpG7B,sBAAsB,CAAC6B,cAAc,CAAC,YAAY,EAAC,8DAA8D,CAAC;EAClH7B,sBAAsB,CAAC6B,cAAc,CAAC,WAAW,EAAC;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,CAAC;EACF7B,sBAAsB,CAAC6B,cAAc,CAAC,WAAW,EAAC,4HAA4H,CAAC;;EAE/K;EACA7B,sBAAsB,CAAC/gE,SAAS,CAAC6iE,SAAS,GAAG,UAASrjD,OAAO,EAC7D;IACC,IAAIxQ,IAAI,GAAG,IAAI;IACfwQ,OAAO,CAACsjD,QAAQ,CAAC,SAAS,EAAC,EAAE,EAAC;MAAEt+C,MAAM,EAAEhc,MAAM,CAACmyB,IAAI,CAAComC,sBAAsB,CAACI,OAAO,CAAC;MAAEjjD,QAAQ,EAAE,kBAAStV,CAAC,EAAC;QACzG,IAAIgC,IAAI,GAAGm2D,sBAAsB,CAACI,OAAO,CAACv4D,CAAC,CAAC;QAC5C,IAAG,CAACgC,IAAI,EACP;QACDoE,IAAI,CAACmR,WAAW,CAAC,WAAW,EAACvV,IAAI,CAAC;QAClCoE,IAAI,CAAC9O,KAAK,GAAG0I,CAAC;QACd4W,OAAO,CAACujD,OAAO,EAAE;MAClB;IAAC,CAAC,CAAC;EACJ,CAAC;EAEDthE,SAAS,CAACiG,gBAAgB,CAAC,mBAAmB,EAAEq5D,sBAAsB,CAAC;;EAEvE;;EAEA,SAASiC,mBAAmB,GAAG;IAC9B,IAAI,CAACvnD,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;IAChC,IAAI,CAAC/Q,UAAU,GAAG;MACjBE,IAAI,EAAE,EAAE;MACRq4D,OAAO,EAAE,CAAC;MACVC,OAAO,EAAE,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;MAClBl4C,KAAK,EAAE,GAAG;MACVC,MAAM,EAAE,GAAG;MACX8gB,SAAS,EAAEgwB,aAAa,CAACS;IAC1B,CAAC;IAED,IAAI,CAAC9xD,UAAU,CAACE,IAAI,GAAGo4D,mBAAmB,CAACtB,YAAY;IACvD,IAAI,CAACyB,SAAS,GAAG;MAAEF,OAAO,EAAE,CAAC;MAAEC,OAAO,EAAEE,IAAI,CAAChQ,MAAM,EAAE;MAAEiQ,UAAU,EAAE,CAAC;MAAEV,OAAO,EAAES,IAAI,CAAChQ,MAAM,EAAE;MAAEhL,IAAI,EAAE;IAAE,CAAC;EACxG;EAEA4a,mBAAmB,CAAC9iE,KAAK,GAAG,QAAQ;EACpC8iE,mBAAmB,CAAC53D,IAAI,GAAG,gBAAgB;EAC3C43D,mBAAmB,CAAC5+C,YAAY,GAAG;IAClCxZ,IAAI,EAAE;MAAEjD,IAAI,EAAE,MAAM;MAAEsoD,IAAI,EAAE;IAAO,CAAC;IACpClkB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDuG,mBAAmB,CAAChjE,SAAS,CAACsf,iBAAiB,GAAG,UACjDpe,IAAI,EACJ4Z,KAAK,EACJ;IACD,IAAI5Z,IAAI,IAAI,MAAM,EAAE;MACnB;IACD;IAEA,IAAIogE,MAAM,GAAG,IAAI,CAACgC,SAAS,EAAE;IAC7B,IAAI,CAAChC,MAAM,EAAE;MACZ;IACD;;IAEA;IACA,IAAIkB,QAAQ,GAAGlB,MAAM,CAACiC,WAAW;;IAEjC;IACA,IAAI,IAAI,CAAC1wD,MAAM,EAAE;MAChB,IAAI2wD,OAAO,GAAG,CAAC,CAAC;MAChB,KAAK,IAAI5jE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACiT,MAAM,CAAC3T,MAAM,EAAE,EAAEU,CAAC,EAAE;QAC5C,IAAIyc,IAAI,GAAG,IAAI,CAACyE,YAAY,CAAClhB,CAAC,CAAC;QAC/B,IAAI,CAACyc,IAAI,EAAE;UACV;QACD;QAEA,IAAImmD,QAAQ,CAACnmD,IAAI,CAACnb,IAAI,CAAC,IAAI,CAACsiE,OAAO,CAACnnD,IAAI,CAACnb,IAAI,CAAC,EAAE;UAC/CsiE,OAAO,CAACnnD,IAAI,CAACnb,IAAI,CAAC,GAAG,IAAI;UACzB;QACD;QACA,IAAI,CAACqa,WAAW,CAAC3b,CAAC,CAAC;QACnBA,CAAC,EAAE;MACJ;IACD;;IAEA;IACA,KAAK,IAAIA,CAAC,IAAI4iE,QAAQ,EAAE;MACvB,IAAInmD,IAAI,GAAGilD,MAAM,CAACiC,WAAW,CAAC3jE,CAAC,CAAC;MAChC,IAAIyc,IAAI,CAAConD,GAAG,KAAK,IAAI,EAAE;QACtB;MACD,CAAC,CAAC;MACF,IAAI7jE,CAAC,IAAI,MAAM,EAAE;QAChB;QACA;MACD;MAEA,IAAI+H,IAAI,GAAG,QAAQ;MACnB,IAAI,IAAI,CAAC45D,OAAO,CAACmC,QAAQ,CAAC9jE,CAAC,CAAC,EAAE;QAC7B+H,IAAI,GAAG,SAAS;MACjB,CAAC,MAAM;QACN,QAAQ0U,IAAI,CAACnQ,IAAI;UAChB,KAAK,CAAC;YACLvE,IAAI,GAAG,QAAQ;YACf;UACD,KAAK,CAAC;YACLA,IAAI,GAAG,MAAM;YACb;UACD,KAAK,CAAC;YACLA,IAAI,GAAG,MAAM;YACb;UACD,KAAK,CAAC;YACLA,IAAI,GAAG,MAAM;YACb;UACD,KAAK,CAAC;YACLA,IAAI,GAAG,MAAM;YACb;UACD,KAAK,EAAE;YACNA,IAAI,GAAG,MAAM;YACb;UACD;YACC;QAAS;MAEZ;MAEA,IAAIkR,IAAI,GAAG,IAAI,CAAC+H,aAAa,CAAChhB,CAAC,CAAC;MAChC,IAAIiZ,IAAI,IAAI,CAAC,CAAC,EAAE;QACf,IAAI,CAACgC,QAAQ,CAACjb,CAAC,EAAE+H,IAAI,CAAC;QACtB;MACD;MAEA,IAAIuZ,UAAU,GAAG,IAAI,CAACJ,YAAY,CAACjI,IAAI,CAAC;MACxC,IAAI,CAACqI,UAAU,EAAE;QAChB,IAAI,CAACrG,QAAQ,CAACjb,CAAC,EAAE+H,IAAI,CAAC;MACvB,CAAC,MAAM;QACN,IAAIuZ,UAAU,CAACvZ,IAAI,IAAIA,IAAI,EAAE;UAC5B;QACD;QACA,IAAI,CAAC4T,WAAW,CAAC1C,IAAI,EAAElR,IAAI,CAAC;QAC5B,IAAI,CAACkT,QAAQ,CAACjb,CAAC,EAAE+H,IAAI,CAAC;MACvB;IACD;EACD,CAAC;EAEDq7D,mBAAmB,CAAChjE,SAAS,CAACsjE,SAAS,GAAG,YAAW;IACpD;IACA,IAAI,IAAI,CAAC/B,OAAO,IAAI,IAAI,CAACC,YAAY,IAAI,IAAI,CAAC92D,UAAU,CAACE,IAAI,EAAE;MAC9D,OAAO,IAAI,CAAC22D,OAAO;IACpB;IAEA,IAAI,CAACC,YAAY,GAAG,IAAI,CAAC92D,UAAU,CAACE,IAAI;IACxC,IAAI,CAAC22D,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAAEA,MAAM,CAACC,oBAAoB,EAAE,IAAI,CAACp3D,UAAU,CAACE,IAAI,CAAE;IACjF,IAAI,CAAC,IAAI,CAAC22D,OAAO,EAAE;MAClB,IAAI,CAACzhD,QAAQ,GAAG,KAAK;MACrB,OAAO,IAAI;IACZ,CAAC,MAAM;MACN,IAAI,CAACA,QAAQ,GAAG,OAAO;IACxB;IACA,OAAO,IAAI,CAACyhD,OAAO;EACpB,CAAC;EAEDyB,mBAAmB,CAAChjE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACpD,IAAI,CAAC,IAAI,CAAC+V,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF,IAAIkgD,MAAM,GAAG,IAAI,CAACgC,SAAS,EAAE;IAC7B,IAAI,CAAChC,MAAM,EAAE;MACZ;IACD;IAEA,IAAIqC,QAAQ,GAAG,CAAC;IAChB,IAAIC,MAAM,GAAG,IAAI;;IAEjB;IACA,IAAG,IAAI,CAAC/wD,MAAM,EACd,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACiT,MAAM,CAAC3T,MAAM,EAAE,EAAEU,CAAC,EAAE;MAC5C,IAAIyc,IAAI,GAAG,IAAI,CAACyE,YAAY,CAAClhB,CAAC,CAAC;MAC/B,IAAI+O,IAAI,GAAG,IAAI,CAACrD,YAAY,CAAC1L,CAAC,CAAC;MAC/B,IAAI+O,IAAI,IAAI,IAAI,EAAE;QACjB;MACD;MAEA,IAAIA,IAAI,CAACtF,WAAW,KAAKysB,EAAE,CAACqnC,OAAO,EAAE;QACpCxuD,IAAI,CAAC0B,IAAI,CAACszD,QAAQ,CAAC;QACnB,IAAI,CAACC,MAAM,EAAE;UACZA,MAAM,GAAGj1D,IAAI;QACd;QACAA,IAAI,GAAGg1D,QAAQ;QACfA,QAAQ,EAAE;MACX;MACArC,MAAM,CAACuC,UAAU,CAACxnD,IAAI,CAACnb,IAAI,EAAEyN,IAAI,CAAC,CAAC,CAAC;IACrC;;IAEA,IAAI6zD,QAAQ,GAAG,IAAI,CAACW,SAAS;IAC7B,IAAIx7D,IAAI,GAAGo0D,aAAa,CAAC6B,cAAc,CAAE,IAAI,CAAClzD,UAAU,CAACqhC,SAAS,EAAE63B,MAAM,CAAE;;IAE5E;IACA,IAAInkD,CAAC,GAAG,IAAI,CAAC/U,UAAU,CAACsgB,KAAK,GAAG,CAAC;IACjC,IAAImR,CAAC,GAAG,IAAI,CAACzxB,UAAU,CAACugB,MAAM,GAAG,CAAC;IAClC,IAAIxL,CAAC,IAAI,CAAC,EAAE;MACXA,CAAC,GAAGmkD,MAAM,GAAGA,MAAM,CAAC54C,KAAK,GAAGgL,EAAE,CAAChd,MAAM,CAACgS,KAAK;IAC5C;IACA,IAAImR,CAAC,IAAI,CAAC,EAAE;MACXA,CAAC,GAAGynC,MAAM,GAAGA,MAAM,CAAC34C,MAAM,GAAG+K,EAAE,CAAChd,MAAM,CAACiS,MAAM;IAC9C;IACAu3C,QAAQ,CAACG,OAAO,CAAC,CAAC,CAAC,GAAGljD,CAAC;IACvB+iD,QAAQ,CAACG,OAAO,CAAC,CAAC,CAAC,GAAGxmC,CAAC;IACvBqmC,QAAQ,CAACG,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,GAACljD,CAAC;IACzB+iD,QAAQ,CAACG,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,GAACxmC,CAAC;IACzBqmC,QAAQ,CAACpa,IAAI,GAAG,IAAI,CAACh1C,KAAK,CAACjD,OAAO,EAAE;IACpCqyD,QAAQ,CAACS,OAAO,GAAG,IAAI,CAACv4D,UAAU,CAACu4D,OAAO;IAC1CT,QAAQ,CAACU,OAAO,CAACv6D,GAAG,CAAE,IAAI,CAAC+B,UAAU,CAACw4D,OAAO,CAAE;IAE/C,IAAK,CAAC,IAAI,CAAC9B,IAAI,IAAI,IAAI,CAACA,IAAI,CAACz5D,IAAI,IAAIA,IAAI,IAAK,IAAI,CAACy5D,IAAI,CAACp2C,KAAK,IAAIvL,CAAC,IAAI,IAAI,CAAC2hD,IAAI,CAACn2C,MAAM,IAAIkR,CAAC,EAAG;MAC7F,IAAI,CAACilC,IAAI,GAAG,IAAItrC,EAAE,CAACqnC,OAAO,CAAC19C,CAAC,EAAE0c,CAAC,EAAE;QAAGx0B,IAAI,EAAEA,IAAI;QAAE+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QAAE1xD,MAAM,EAAEwpB,EAAE,CAAC2nC;MAAO,CAAC,CAAC;IACtF;IACA,IAAIT,GAAG,GAAG,IAAI,CAACkE,IAAI;IACnBlE,GAAG,CAAC8E,MAAM,CAAC,YAAW;MACrBV,MAAM,CAACkB,QAAQ,CAACA,QAAQ,CAAC,CAAC9rC,IAAI,CAACZ,EAAE,CAACwsC,IAAI,CAACC,aAAa,EAAE,CAAC;IACxD,CAAC,CAAC;IAEF,IAAI,CAAC/2D,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC41D,IAAI,CAAC;EACjC,CAAC;EAED4B,mBAAmB,CAACtB,YAAY,GACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EAEAjgE,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAEs7D,mBAAmB,CAAC;;EAEjE;;EAEA,SAASc,wBAAwB,GAAG;IACnC,IAAI,CAACjpD,QAAQ,CAAC,IAAI,EAAE,SAAS,CAAC;IAC9B,IAAI,CAACA,QAAQ,CAAC,OAAO,EAAE,MAAM,CAAC;IAC9B,IAAI,CAACA,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAAC;IAC/B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;IAChC,IAAI,CAAC/Q,UAAU,GAAG;MACjBmd,MAAM,EAAE25B,IAAI,CAAC2T,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC;MAC7BlsC,KAAK,EAAEu4B,IAAI,CAAC2T,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC;MAC5BppB,SAAS,EAAEgwB,aAAa,CAACS;IAC1B,CAAC;EACF;EAEAsH,wBAAwB,CAAC1/C,YAAY,GAAG;IACvC2nB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDqH,wBAAwB,CAAC5jE,KAAK,GAAG,cAAc;EAC/C4jE,wBAAwB,CAAC14D,IAAI,GAAG,kCAAkC;EAElE04D,wBAAwB,CAAC9jE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACzD,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAE9B,IAAI,CAAC,IAAI,CAAC8V,iBAAiB,CAAC,CAAC,CAAC,IAAI,CAAC87C,GAAG,EAAE;MACvC;IACD,CAAC,CAAC;;IAEF,IAAI,IAAI,CAACxyD,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACI,YAAY,EAAE;MAC7D,IAAI,CAAC3wD,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEA,IAAIlyC,KAAK,GAAGkyC,GAAG,CAAClyC,KAAK;IACrB,IAAIC,MAAM,GAAGiyC,GAAG,CAACjyC,MAAM;IACvB,IAAItjB,IAAI,GAAI,IAAI,CAACokC,SAAS,KAAKgwB,aAAa,CAACM,GAAG,GAAGrmC,EAAE,CAACwnC,aAAa,GAAGxnC,EAAE,CAACynC,qBAAqB;IAC9F,IAAI,IAAI,CAAC1xB,SAAS,KAAKgwB,aAAa,CAACS,OAAO,EAAE;MAC7C70D,IAAI,GAAGu1D,GAAG,CAACv1D,IAAI;IAChB;IAEA,IACC,CAAC,IAAI,CAACy5D,IAAI,IACV,IAAI,CAACA,IAAI,CAACp2C,KAAK,IAAIA,KAAK,IACxB,IAAI,CAACo2C,IAAI,CAACn2C,MAAM,IAAIA,MAAM,IAC1B,IAAI,CAACm2C,IAAI,CAACz5D,IAAI,IAAIA,IAAI,EACrB;MACD,IAAI,CAACy5D,IAAI,GAAG,IAAItrC,EAAE,CAACqnC,OAAO,CAACnyC,KAAK,EAAEC,MAAM,EAAE;QACzCtjB,IAAI,EAAEA,IAAI;QACV+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QACf1xD,MAAM,EAAEwpB,EAAE,CAAC2nC;MACZ,CAAC,CAAC;IACH;IAEA,IAAI2D,MAAM,GAAG,IAAI,CAACC,OAAO;IAEzB,IAAI,CAACD,MAAM,EAAE;MACZA,MAAM,GAAG,IAAIxrC,EAAE,CAAC+rC,MAAM,CACrB/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAC9BgC,wBAAwB,CAACpC,YAAY,CACrC;IACF;IAEA,IAAIz4C,KAAK,GAAG,IAAI,CAAC3d,YAAY,CAAC,CAAC,CAAC;IAChC,IAAI2d,KAAK,EAAE;MACV,IAAI,CAACve,UAAU,CAACue,KAAK,CAAC,CAAC,CAAC,GAAGA,KAAK,CAAC,CAAC,CAAC;MACnC,IAAI,CAACve,UAAU,CAACue,KAAK,CAAC,CAAC,CAAC,GAAGA,KAAK,CAAC,CAAC,CAAC;IACpC,CAAC,MAAM;MACNA,KAAK,GAAG,IAAI,CAACve,UAAU,CAACue,KAAK;IAC9B;IAEA,IAAIpB,MAAM,GAAG,IAAI,CAACvc,YAAY,CAAC,CAAC,CAAC;IACjC,IAAIuc,MAAM,EAAE;MACX,IAAI,CAACnd,UAAU,CAACmd,MAAM,CAAC,CAAC,CAAC,GAAGA,MAAM,CAAC,CAAC,CAAC;MACrC,IAAI,CAACnd,UAAU,CAACmd,MAAM,CAAC,CAAC,CAAC,GAAGA,MAAM,CAAC,CAAC,CAAC;IACtC,CAAC,MAAM;MACNA,MAAM,GAAG,IAAI,CAACnd,UAAU,CAACmd,MAAM;IAChC;IAEA,IAAI,CAACu5C,IAAI,CAACY,MAAM,CAAC,YAAW;MAC3BhsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;MACzBlsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACmsC,SAAS,CAAC;MACxBnsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;MACpBlF,GAAG,CAAC7sD,IAAI,CAAC,CAAC,CAAC;MACX,IAAIgyD,IAAI,GAAGC,IAAI,CAACC,aAAa,EAAE;MAC/BjB,MAAM,CACJkB,QAAQ,CAAC;QACTC,SAAS,EAAE,CAAC;QACZsB,OAAO,EAAE96C,KAAK;QACd+6C,QAAQ,EAAEn8C;MACX,CAAC,CAAC,CACD6O,IAAI,CAAC2rC,IAAI,CAAC;IACb,CAAC,CAAC;IAEF,IAAI,CAAC72D,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC41D,IAAI,CAAC;EACjC,CAAC;EAED0C,wBAAwB,CAACpC,YAAY,GACpC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CACzB,qBAAqB,EACrBo8D,wBAAwB,CACxB;;EAED;;EAEA,SAASG,iBAAiB,GAAG;IAC5B,IAAI,CAACppD,QAAQ,CAAC,IAAI,EAAE,SAAS,CAAC;IAC9B,IAAI,CAACA,QAAQ,CAAC,MAAM,EAAE,SAAS,CAAC;IAChC,IAAI,CAACA,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC;IACjC,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;IAChC,IAAI,CAAC/Q,UAAU,GAAG;MACjBmmD,MAAM,EAAE,IAAI;MACZ5nC,KAAK,EAAE,CAAC,CAAC,EAAC,CAAC,CAAC;MACZpB,MAAM,EAAE,CAAC,CAAC,EAAC,CAAC,CAAC;MACbkkB,SAAS,EAAEgwB,aAAa,CAACS;IAC1B,CAAC;IAED,IAAI,CAAC2G,SAAS,GAAG;MAChBV,SAAS,EAAE,CAAC;MACZC,UAAU,EAAE,CAAC;MACbwB,QAAQ,EAAE,CAAC;MACXH,OAAO,EAAEviB,IAAI,CAAC4R,MAAM,EAAE;MACtB4Q,QAAQ,EAAExiB,IAAI,CAAC4R,MAAM;IACtB,CAAC;EACF;EAEA6Q,iBAAiB,CAAC7/C,YAAY,GAAG;IAChC2nB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDwH,iBAAiB,CAAC/jE,KAAK,GAAG,MAAM;EAChC+jE,iBAAiB,CAAC74D,IAAI,GAAG,wBAAwB;EAEjD64D,iBAAiB,CAACjkE,SAAS,CAACqL,SAAS,GAAG,YAAW;IAClD,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAE9B,IAAI,CAAC,IAAI,CAAC8V,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF,IAAI,IAAI,CAAC1W,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACI,YAAY,EAAE;MAC7D,IAAI,CAAC3wD,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEA,IAAImE,IAAI,GAAG,IAAI,CAAC/1D,YAAY,CAAC,CAAC,CAAC;IAE/B,IAAI0f,KAAK,GAAG,GAAG;IACf,IAAIC,MAAM,GAAG,GAAG;IAChB,IAAItjB,IAAI,GAAGquB,EAAE,CAACwnC,aAAa;IAC3B,IAAIN,GAAG,EAAE;MACRlyC,KAAK,GAAGkyC,GAAG,CAAClyC,KAAK;MACjBC,MAAM,GAAGiyC,GAAG,CAACjyC,MAAM;MACnBtjB,IAAI,GAAGu1D,GAAG,CAACv1D,IAAI;IAChB,CAAC,MAAM,IAAI05D,IAAI,EAAE;MAChBr2C,KAAK,GAAGq2C,IAAI,CAACr2C,KAAK;MAClBC,MAAM,GAAGo2C,IAAI,CAACp2C,MAAM;MACpBtjB,IAAI,GAAG05D,IAAI,CAAC15D,IAAI;IACjB;IAEA,IAAI,CAACu1D,GAAG,IAAI,CAAC,IAAI,CAACkE,IAAI,EAAE;MACvB,IAAI,CAACA,IAAI,GAAG,IAAItrC,EAAE,CAACqnC,OAAO,CAACnyC,KAAK,EAAEC,MAAM,EAAE;QACzCtjB,IAAI,EACH,IAAI,CAACokC,SAAS,KAAKgwB,aAAa,CAACM,GAAG,GACjCrmC,EAAE,CAACwnC,aAAa,GAChBxnC,EAAE,CAACynC,qBAAqB;QAC5BC,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QACf1xD,MAAM,EAAEwpB,EAAE,CAAC2nC;MACZ,CAAC,CAAC;IACH,CAAC,MAAM;MACN,IAAI,CAACyD,IAAI,GAAGrF,aAAa,CAACuB,gBAAgB,CACzCJ,GAAG,IAAI,IAAI,CAACkE,IAAI,EAChB,IAAI,CAACA,IAAI,EACT,IAAI,CAAC12D,UAAU,CAACqhC,SAAS,CACzB;IACF;IAEA,IAAIu1B,MAAM,GAAG,IAAI,CAACC,OAAO;IAEzB,IAAI,CAACD,MAAM,EAAE;MACZA,MAAM,GAAG,IAAIxrC,EAAE,CAAC+rC,MAAM,CACrB/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAC9BmC,iBAAiB,CAACvC,YAAY,CAC9B;IACF;IAEA,IAAI7Q,MAAM,GAAG,IAAI,CAACvlD,YAAY,CAAC,CAAC,CAAC;IACjC,IAAIulD,MAAM,IAAI,IAAI,EAAE;MACnB,IAAI,CAACnmD,UAAU,CAACmmD,MAAM,GAAGA,MAAM;IAChC,CAAC,MAAM;MACNA,MAAM,GAAG5M,UAAU,CAAC,IAAI,CAACv5C,UAAU,CAACmmD,MAAM,CAAC;IAC5C;IACA,IAAI2R,QAAQ,GAAG,IAAI,CAACW,SAAS;IAC7BX,QAAQ,CAAC0B,QAAQ,GAAGrT,MAAM;IAC1B2R,QAAQ,CAACuB,OAAO,CAACp7D,GAAG,CAAE,IAAI,CAAC+B,UAAU,CAACue,KAAK,CAAE;IAC7Cu5C,QAAQ,CAACwB,QAAQ,CAACr7D,GAAG,CAAE,IAAI,CAAC+B,UAAU,CAACmd,MAAM,CAAE;IAE/C,IAAI,CAACu5C,IAAI,CAACY,MAAM,CAAC,YAAW;MAC3BhsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;MACzBlsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACmsC,SAAS,CAAC;MACxBnsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;MACpB,IAAIlF,GAAG,EAAE;QACRA,GAAG,CAAC7sD,IAAI,CAAC,CAAC,CAAC;MACZ;MACA,IAAIgxD,IAAI,EAAE;QACTA,IAAI,CAAChxD,IAAI,CAAC,CAAC,CAAC;MACb;MACA,IAAIgyD,IAAI,GAAGC,IAAI,CAACC,aAAa,EAAE;MAC/BjB,MAAM,CACJkB,QAAQ,CAAEA,QAAQ,CAAE,CACpB9rC,IAAI,CAAC2rC,IAAI,CAAC;IACb,CAAC,CAAC;IAEF,IAAI,CAAC72D,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC41D,IAAI,CAAC;EACjC,CAAC;EAED6C,iBAAiB,CAACvC,YAAY,GAC7B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAEu8D,iBAAiB,CAAC;;EAE7D;;EAEA;EACA,SAASE,uBAAuB,GAAG;IAClC,IAAI,CAACtpD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACnQ,UAAU,GAAG;MACjB05D,QAAQ,EAAE,KAAK;MACfC,YAAY,EAAE,KAAK;MACnB73D,MAAM,EAAE,IAAI;MACZ83D,aAAa,EAAE,KAAK;MACpBC,KAAK,EAAE,GAAG;MACVx5C,QAAQ,EAAE,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC;IACnB,CAAC;IACD,IAAI,CAAC7e,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG;EACnB;EAEAi4D,uBAAuB,CAACjkE,KAAK,GAAG,aAAa;EAC7CikE,uBAAuB,CAAC/4D,IAAI,GAAG,qBAAqB;EAEpD+4D,uBAAuB,CAACK,cAAc,GAAG,IAAItlD,YAAY,CAAC,CAAC,CAAC;EAE5DilD,uBAAuB,CAACnkE,SAAS,CAAC2wB,gBAAgB,GAAG,UAAU5D,GAAG,EAClE;IACC,IAAK,IAAI,CAAC9gB,KAAK,CAAC2Y,SAAS,IAAI,IAAI,CAAC1Y,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,EAC9C;IAED,IAAIgxD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,EAAE;MACT;IACD;IAEAnwC,GAAG,CAACuU,SAAS,CAAEvU,GAAG,IAAIiJ,EAAE,GAAGknC,GAAG,GAAGlnC,EAAE,CAAChd,MAAM,EAAE,EAAE,EAAC,EAAE,EAAE,IAAI,CAAC9M,IAAI,CAAC,CAAC,CAAC,GAAE,EAAE,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,GAAE,EAAE,CAAC;EACvF,CAAC;EAEDi4D,uBAAuB,CAACnkE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxD,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,EAAE;MACT;IACD;IAEA,IAAI,IAAI,CAACxyD,UAAU,CAAC45D,aAAa,EAAE;MAClCtuC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IACrB,CAAC,MAAM;MACNpsC,EAAE,CAACyuC,MAAM,CAACzuC,EAAE,CAACosC,KAAK,CAAC;MACnB,IAAI,IAAI,CAAC13D,UAAU,CAAC05D,QAAQ,EAAE;QAC7BpuC,EAAE,CAAC0uC,SAAS,CAAC1uC,EAAE,CAAC2uC,SAAS,EAAE3uC,EAAE,CAAC4uC,GAAG,CAAC;MACnC,CAAC,MAAM;QACN5uC,EAAE,CAAC0uC,SAAS,CAAC1uC,EAAE,CAAC2uC,SAAS,EAAE3uC,EAAE,CAAC6uC,mBAAmB,CAAC;MACnD;IACD;IAEA7uC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IACzB,IAAIqC,KAAK,GAAG,IAAI,CAAC75D,UAAU,CAAC65D,KAAK,IAAI,GAAG;IACxC,IAAI,IAAI,CAAC1jD,gBAAgB,CAAC,CAAC,CAAC,EAAE;MAC7B0jD,KAAK,GAAG,IAAI,CAACj5D,YAAY,CAAC,CAAC,CAAC;IAC7B;IAEA4xD,GAAG,CAAC0B,YAAY,CACf5oC,EAAE,CAAC6oC,kBAAkB,EACrB,IAAI,CAACn0D,UAAU,CAAC8B,MAAM,GAAGwpB,EAAE,CAAC2nC,MAAM,GAAG3nC,EAAE,CAACqoC,OAAO,CAC/C;IAED,IAAIyG,YAAY,GAAGX,uBAAuB,CAACK,cAAc;IACzDM,YAAY,CAACn8D,GAAG,CAAEqtB,EAAE,CAAC+uC,aAAa,CAAE;IACpC,IAAIC,QAAQ,GAAG,IAAI,CAACt6D,UAAU,CAACqgB,QAAQ;IACvCiL,EAAE,CAACjL,QAAQ,CAAE+5C,YAAY,CAAC,CAAC,CAAC,GAAGA,YAAY,CAAC,CAAC,CAAC,GAAGE,QAAQ,CAAC,CAAC,CAAC,EAAEF,YAAY,CAAC,CAAC,CAAC,GAAGA,YAAY,CAAC,CAAC,CAAC,GAAGE,QAAQ,CAAC,CAAC,CAAC,EAAEF,YAAY,CAAC,CAAC,CAAC,GAAGE,QAAQ,CAAC,CAAC,CAAC,EAAEF,YAAY,CAAC,CAAC,CAAC,GAAGE,QAAQ,CAAC,CAAC,CAAC,CAAE;IAC7K,IAAIj6C,QAAQ,GAAGiL,EAAE,CAACivC,WAAW,EAAE,CAAC,CAAC;;IAEjC,IAAI,IAAI,CAACv6D,UAAU,CAAC25D,YAAY,EAAE;MACjC,IAAI,CAACF,uBAAuB,CAAC5C,OAAO,EAAE;QACrC4C,uBAAuB,CAAC5C,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAC9C/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAC9BqC,uBAAuB,CAACe,eAAe,CACvC;MACF;MAEA,IAAI7C,IAAI,GAAGC,IAAI,CAACC,aAAa,EAAE;MAC/BrF,GAAG,CAAC7sD,IAAI,CAAC,CAAC,CAAC;MACX8zD,uBAAuB,CAAC5C,OAAO,CAC7BiB,QAAQ,CAAC;QACTC,SAAS,EAAE,CAAC;QACZ0C,aAAa,EAAE,CAACjI,GAAG,CAAClyC,KAAK,EAAEkyC,GAAG,CAACjyC,MAAM,CAAC;QACtCm6C,QAAQ,EAAE,CAAC,GAAGb,KAAK;QACnBc,SAAS,EAAE,CAAC,CAAC,GAAGnI,GAAG,CAAClyC,KAAK,EAAE,CAAC,GAAGkyC,GAAG,CAACjyC,MAAM;MAC1C,CAAC,CAAC,CACDyL,IAAI,CAAC2rC,IAAI,CAAC;IACb,CAAC,MAAM;MACN,IAAIkC,KAAK,IAAI,GAAG,EAAE;QACjB,IAAI,CAACJ,uBAAuB,CAACmB,aAAa,EAAE;UAC3CnB,uBAAuB,CAACmB,aAAa,GAAG,IAAIxvC,EAAE,CAAC+rC,MAAM,CACpDA,MAAM,CAACC,oBAAoB,EAC3BqC,uBAAuB,CAACoB,kBAAkB,CAC1C;QACF;QACArI,GAAG,CAACsI,UAAU,CAACrB,uBAAuB,CAACmB,aAAa,EAAE;UACrD7C,SAAS,EAAE,CAAC;UACZ2C,QAAQ,EAAE,CAAC,GAAGb;QACf,CAAC,CAAC;MACH,CAAC,MAAM;QACNrH,GAAG,CAACsI,UAAU,EAAE;MACjB;IACD;IAEAxvC,EAAE,CAACjL,QAAQ,CAAE+5C,YAAY,CAAC,CAAC,CAAC,EAAEA,YAAY,CAAC,CAAC,CAAC,EAAEA,YAAY,CAAC,CAAC,CAAC,EAAEA,YAAY,CAAC,CAAC,CAAC,CAAE;EAClF,CAAC;EAEDX,uBAAuB,CAACnkE,SAAS,CAACovC,WAAW,GAAG,YAAW;IAC1D,OAAO,CAAC,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;EAC7B,CAAC;EAED+0B,uBAAuB,CAACe,eAAe,GACtC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFf,uBAAuB,CAACoB,kBAAkB,GACzC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEF9jE,SAAS,CAACiG,gBAAgB,CACzB,oBAAoB,EACpBy8D,uBAAuB,CACvB;;EAED;EACA,SAASsB,iBAAiB,GAAG;IAC5B,IAAI,CAAC5qD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACY,SAAS,CAAC,EAAE,EAAE,SAAS,CAAC;IAC7B,IAAI,CAAC/Q,UAAU,GAAG;MACjBwB,IAAI,EAAE,CAAC;MACPo0D,gBAAgB,EAAE,KAAK;MACvBv0B,SAAS,EAAEgwB,aAAa,CAACS;IAC1B,CAAC;EACF;EAEAiJ,iBAAiB,CAACvlE,KAAK,GAAG,MAAM;EAChCulE,iBAAiB,CAACr6D,IAAI,GAAG,cAAc;EACvCq6D,iBAAiB,CAACrhD,YAAY,GAAG;IAChClY,IAAI,EAAE;MACLoY,MAAM,EAAE,OAAO;MACfE,MAAM,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI;IAC9C,CAAC;IACDunB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDgJ,iBAAiB,CAACzlE,SAAS,CAACqL,SAAS,GAAG,YAAW;IAClD,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,IAAI,CAAC,IAAI,CAACwI,aAAa,EAAE;MAChC;IACD;IAEA,IAAI,CAAC,IAAI,CAACtkD,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF;IACA,IAAI87C,GAAG,EAAE;MACR,IAAIlyC,KAAK,GAAGkyC,GAAG,CAAClyC,KAAK;MACrB,IAAIC,MAAM,GAAGiyC,GAAG,CAACjyC,MAAM;MAEvB,IAAI,IAAI,CAACvgB,UAAU,CAACwB,IAAI,IAAI,CAAC,EAAE;QAC9B8e,KAAK,GAAG,IAAI,CAACtgB,UAAU,CAACwB,IAAI;QAC5B+e,MAAM,GAAG,IAAI,CAACvgB,UAAU,CAACwB,IAAI;MAC9B;MAEA,IAAIs0B,IAAI,GAAG,IAAI,CAACklC,aAAa;MAE7B,IAAI/9D,IAAI,GAAGu1D,GAAG,CAACv1D,IAAI;MACnB,IAAI,IAAI,CAAC+C,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACM,GAAG,EAAE;QACpD10D,IAAI,GAAGquB,EAAE,CAACwnC,aAAa;MACxB,CAAC,MAAM,IAAI,IAAI,CAAC9yD,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACO,IAAI,EAAE;QAC5D30D,IAAI,GAAGquB,EAAE,CAACynC,qBAAqB;MAChC;MAEA,IACC,CAACj9B,IAAI,IACLA,IAAI,CAACxV,KAAK,IAAIA,KAAK,IACnBwV,IAAI,CAACvV,MAAM,IAAIA,MAAM,IACrBuV,IAAI,CAAC74B,IAAI,IAAIA,IAAI,EAChB;QACD,IAAI83D,SAAS,GAAGzpC,EAAE,CAAC2nC,MAAM;QACzB,IACC,IAAI,CAACjzD,UAAU,CAAC41D,gBAAgB,IAChCqF,YAAY,CAAC36C,KAAK,CAAC,IACnB26C,YAAY,CAAC16C,MAAM,CAAC,EACnB;UACDw0C,SAAS,GAAGzpC,EAAE,CAAC0qC,oBAAoB;QACpC;QACA,IAAI,CAACgF,aAAa,GAAG,IAAI5vC,EAAE,CAACqnC,OAAO,CAACnyC,KAAK,EAAEC,MAAM,EAAE;UAClDtjB,IAAI,EAAEA,IAAI;UACV+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;UACfuB,SAAS,EAAEA,SAAS;UACpBmG,SAAS,EAAE5vC,EAAE,CAAC2nC;QACf,CAAC,CAAC;MACH;MACAT,GAAG,CAACwC,MAAM,CAAC,IAAI,CAACgG,aAAa,CAAC;MAE9B,IAAI,IAAI,CAACh7D,UAAU,CAAC41D,gBAAgB,EAAE;QACrC,IAAI,CAACoF,aAAa,CAACr1D,IAAI,CAAC,CAAC,CAAC;QAC1B2lB,EAAE,CAAC2qC,cAAc,CAAC,IAAI,CAAC+E,aAAa,CAAC9E,YAAY,CAAC;QAClD,IAAI,CAAC8E,aAAa,CAAC7E,MAAM,CAAC,CAAC,CAAC;MAC7B;IACD;IAEA,IAAI,CAACr1D,aAAa,CAAC,CAAC,EAAE,IAAI,CAACk6D,aAAa,CAAC;EAC1C,CAAC;EAEDjkE,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAE+9D,iBAAiB,CAAC;;EAE7D;EACA,SAASI,uBAAuB,GAAG;IAClC,IAAI,CAAChrD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACY,SAAS,CAAC,EAAE,EAAE,SAAS,CAAC;IAC7B,IAAI,CAAC/Q,UAAU,GAAG;MACjBukD,UAAU,EAAE,CAAC;MACbqR,gBAAgB,EAAE,KAAK;MACvBv0B,SAAS,EAAEgwB,aAAa,CAACS;IAC1B,CAAC;EACF;EAEAqJ,uBAAuB,CAAC3lE,KAAK,GAAG,YAAY;EAC5C2lE,uBAAuB,CAACz6D,IAAI,GAAG,oBAAoB;EACnDy6D,uBAAuB,CAACzhD,YAAY,GAAG;IACtC6qC,UAAU,EAAE;MAAEtnD,IAAI,EAAE,QAAQ;MAAEykC,IAAI,EAAE,CAAC;MAAEL,SAAS,EAAE,CAAC;MAAEhG,GAAG,EAAE;IAAE,CAAC;IAC7DgG,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDoJ,uBAAuB,CAAC7lE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxD,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,IAAI,CAAC,IAAI,CAACwI,aAAa,EAAE;MAChC;IACD;IAEA,IAAI,CAAC,IAAI,CAACtkD,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF;IACA,IAAI,CAAC87C,GAAG,IAAIA,GAAG,CAAC0D,YAAY,KAAK9qC,EAAE,CAACgwC,UAAU,EAAE;MAC/C;IACD;IAEA,IAAI,IAAI,CAACp7D,UAAU,CAACukD,UAAU,GAAG,CAAC,EAAE;MACnC,IAAI,CAACzjD,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEA,IAAIoE,MAAM,GAAGuE,uBAAuB,CAACtE,OAAO;IAC5C,IAAI,CAACD,MAAM,EAAE;MACZuE,uBAAuB,CAACtE,OAAO,GAAGD,MAAM,GAAG,IAAIxrC,EAAE,CAAC+rC,MAAM,CACvD/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAC9B+D,uBAAuB,CAACnE,YAAY,CACpC;IACF;IAEA,IAAI12C,KAAK,GAAGkyC,GAAG,CAAClyC,KAAK,GAAG,CAAC;IACzB,IAAIC,MAAM,GAAGiyC,GAAG,CAACjyC,MAAM,GAAG,CAAC;IAC3B,IAAItjB,IAAI,GAAGu1D,GAAG,CAACv1D,IAAI;IACnB,IAAI,IAAI,CAAC+C,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACM,GAAG,EAAE;MACpD10D,IAAI,GAAGquB,EAAE,CAACwnC,aAAa;IACxB,CAAC,MAAM,IAAI,IAAI,CAAC9yD,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACO,IAAI,EAAE;MAC5D30D,IAAI,GAAGquB,EAAE,CAACynC,qBAAqB;IAChC;IACA,IAAIxO,UAAU,GAAG,IAAI,CAACvkD,UAAU,CAACukD,UAAU,IAAI,CAAC;IAEhD,IAAI1P,MAAM,GAAG2d,GAAG;IAChB,IAAInvD,MAAM,GAAG,IAAI;IAEjB,IAAIyyB,IAAI,GAAG,EAAE;IACb,IAAI50B,OAAO,GAAG;MACbjE,IAAI,EAAEA,IAAI;MACV+1D,MAAM,EAAER,GAAG,CAACQ;IACb,CAAC;IAED,IAAI71C,MAAM,GAAG25B,IAAI,CAAC4R,MAAM,EAAE;IAC1B,IAAIoP,QAAQ,GAAG;MACdwB,QAAQ,EAAEn8C;IACX,CAAC;IAED,IAAI,IAAI,CAAC24C,QAAQ,EAAE;MAClB1qC,EAAE,CAACqnC,OAAO,CAAC4I,gBAAgB,CAAC,IAAI,CAACvF,QAAQ,CAAC;IAC3C;IAEA,KAAK,IAAI5gE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGqvD,UAAU,EAAE,EAAErvD,CAAC,EAAE;MACpCioB,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,GAAGmD,KAAK;MACrBnD,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,GAAGoD,MAAM;MACtBD,KAAK,GAAGA,KAAK,IAAI,CAAC,IAAI,CAAC;MACvBC,MAAM,GAAGA,MAAM,IAAI,CAAC,IAAI,CAAC;MACzBld,MAAM,GAAG+nB,EAAE,CAACqnC,OAAO,CAAC6I,YAAY,CAACh7C,KAAK,EAAEC,MAAM,EAAErf,OAAO,CAAC;MACxD40B,IAAI,CAAC3gC,IAAI,CAACkO,MAAM,CAAC;MACjBwxC,MAAM,CAACqf,YAAY,CAAC9oC,EAAE,CAAC+oC,kBAAkB,EAAE/oC,EAAE,CAACuoC,OAAO,CAAC;MACtD9e,MAAM,CAACmgB,MAAM,CAAC3xD,MAAM,EAAEuzD,MAAM,EAAEkB,QAAQ,CAAC;MACvC,IAAIx3C,KAAK,IAAI,CAAC,IAAIC,MAAM,IAAI,CAAC,EAAE;QAC9B;MACD,CAAC,CAAC;MACFs0B,MAAM,GAAGxxC,MAAM;IAChB;;IAEA;IACA,IAAI,CAACyyD,QAAQ,GAAGhgC,IAAI,CAACr1B,GAAG,EAAE;;IAE1B;IACA,KAAK,IAAIvL,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG4gC,IAAI,CAACthC,MAAM,EAAE,EAAEU,CAAC,EAAE;MACrCk2B,EAAE,CAACqnC,OAAO,CAAC4I,gBAAgB,CAACvlC,IAAI,CAAC5gC,CAAC,CAAC,CAAC;IACrC;IAEA,IAAI,IAAI,CAAC8K,UAAU,CAAC41D,gBAAgB,EAAE;MACrC,IAAI,CAACE,QAAQ,CAACnwD,IAAI,CAAC,CAAC,CAAC;MACrB2lB,EAAE,CAAC2qC,cAAc,CAAC,IAAI,CAACH,QAAQ,CAACI,YAAY,CAAC;MAC7C,IAAI,CAACJ,QAAQ,CAACK,MAAM,CAAC,CAAC,CAAC;IACxB;IAEA,IAAI,CAACr1D,aAAa,CAAC,CAAC,EAAE,IAAI,CAACg1D,QAAQ,CAAC;EACrC,CAAC;EAEDqF,uBAAuB,CAACnE,YAAY,GACnC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CACzB,oBAAoB,EACpBm+D,uBAAuB,CACvB;EAID,SAASI,mBAAmB,GAAG;IAC9B,IAAI,CAACprD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACY,SAAS,CAAC,EAAE,EAAE,SAAS,CAAC;IAC7B,IAAI,CAAC/Q,UAAU,GAAG;MACjBwB,IAAI,EAAE,CAAC,GAAG,EAAC,GAAG,CAAC;MACfo0D,gBAAgB,EAAE,KAAK;MACvBv0B,SAAS,EAAEgwB,aAAa,CAACS;IAC1B,CAAC;EACF;EAEAyJ,mBAAmB,CAAC/lE,KAAK,GAAG,QAAQ;EACpC+lE,mBAAmB,CAAC76D,IAAI,GAAG,gBAAgB;EAC3C66D,mBAAmB,CAAC7hD,YAAY,GAAG;IAClC6qC,UAAU,EAAE;MAAEtnD,IAAI,EAAE,QAAQ;MAAEykC,IAAI,EAAE,CAAC;MAAEL,SAAS,EAAE,CAAC;MAAEhG,GAAG,EAAE;IAAE,CAAC;IAC7DgG,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDwJ,mBAAmB,CAACjmE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACpD,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,IAAI,CAAC,IAAI,CAACwI,aAAa,EAAE;MAChC;IACD;IAEA,IAAI,CAAC,IAAI,CAACtkD,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF;IACA,IAAI,CAAC87C,GAAG,IAAIA,GAAG,CAAC0D,YAAY,KAAK9qC,EAAE,CAACgwC,UAAU,EAAE;MAC/C;IACD;IAEA,IAAI96C,KAAK,GAAG,IAAI,CAACtgB,UAAU,CAACwB,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC;IACvC,IAAI+e,MAAM,GAAG,IAAI,CAACvgB,UAAU,CAACwB,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC;IACxC,IAAG8e,KAAK,IAAI,CAAC,EACZA,KAAK,GAAGkyC,GAAG,CAAClyC,KAAK;IAClB,IAAGC,MAAM,IAAI,CAAC,EACbA,MAAM,GAAGiyC,GAAG,CAACjyC,MAAM;IACpB,IAAItjB,IAAI,GAAGu1D,GAAG,CAACv1D,IAAI;IACnB,IAAI,IAAI,CAAC+C,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACM,GAAG,EAAE;MACpD10D,IAAI,GAAGquB,EAAE,CAACwnC,aAAa;IACxB,CAAC,MAAM,IAAI,IAAI,CAAC9yD,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACO,IAAI,EAAE;MAC5D30D,IAAI,GAAGquB,EAAE,CAACynC,qBAAqB;IAChC;IAEA,IAAI,CAAC,IAAI,CAAC+C,QAAQ,IAAI,IAAI,CAACA,QAAQ,CAACx1C,KAAK,IAAIA,KAAK,IAAI,IAAI,CAACw1C,QAAQ,CAACv1C,MAAM,IAAIA,MAAM,IAAI,IAAI,CAACu1C,QAAQ,CAAC74D,IAAI,IAAIA,IAAI,EACjH,IAAI,CAAC64D,QAAQ,GAAG,IAAI1qC,EAAE,CAACqnC,OAAO,CAAEnyC,KAAK,EAAEC,MAAM,EAAE;MAAEtjB,IAAI,EAAEA;IAAK,CAAC,CAAE;IAEhEu1D,GAAG,CAACwC,MAAM,CAAE,IAAI,CAACc,QAAQ,CAAE;IAE3B,IAAI,IAAI,CAAC91D,UAAU,CAAC41D,gBAAgB,EAAE;MACrC,IAAI,CAACE,QAAQ,CAACnwD,IAAI,CAAC,CAAC,CAAC;MACrB2lB,EAAE,CAAC2qC,cAAc,CAAC,IAAI,CAACH,QAAQ,CAACI,YAAY,CAAC;MAC7C,IAAI,CAACJ,QAAQ,CAACK,MAAM,CAAC,CAAC,CAAC;IACxB;IAEA,IAAI,CAACr1D,aAAa,CAAC,CAAC,EAAE,IAAI,CAACg1D,QAAQ,CAAC;EACrC,CAAC;EAED/+D,SAAS,CAACiG,gBAAgB,CAAE,gBAAgB,EAAEu+D,mBAAmB,CAAE;;EAEnE;EACA,SAASC,oBAAoB,GAAG;IAC/B,IAAI,CAACrrD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;IAChC,IAAI,CAACA,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC;IAC7B,IAAI,CAACA,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC;IAC/B,IAAI,CAAC/Q,UAAU,GAAG;MACjBy7D,kBAAkB,EAAE,IAAI;MAAE;MAC1BC,YAAY,EAAE,KAAK,CAAC;IACrB,CAAC;;IAED,IAAI,CAACjD,SAAS,GAAG;MAChBV,SAAS,EAAE,CAAC;MACZ4D,eAAe,EAAE;IAClB,CAAC;IACD,IAAI,CAACC,UAAU,GAAG,IAAIpnD,YAAY,CAAC,CAAC,CAAC;EACtC;EAEAgnD,oBAAoB,CAAChmE,KAAK,GAAG,SAAS;EACtCgmE,oBAAoB,CAAC96D,IAAI,GACxB,+LAA+L;EAEhM86D,oBAAoB,CAAClmE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACrD,IAAI,CAAC,IAAI,CAACX,UAAU,CAACy7D,kBAAkB,EAAE;MACxC,IAAI,CAACI,aAAa,EAAE;IACrB;IAEA,IAAI39D,CAAC,GAAG,IAAI,CAAC09D,UAAU;IACvB,IAAI,CAAC96D,aAAa,CAAC,CAAC,EAAE,IAAI,CAACk6D,aAAa,CAAC;IACzC,IAAI,CAACl6D,aAAa,CAAC,CAAC,EAAE5C,CAAC,CAAC;IACxB,IAAI,CAAC4C,aAAa,CAAC,CAAC,EAAE,CAAC5C,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;EAChD,CAAC;;EAED;EACAs9D,oBAAoB,CAAClmE,SAAS,CAACwmE,kBAAkB,GAAG,YAAW;IAC9D,IAAI,CAACD,aAAa,EAAE;EACrB,CAAC;EAEDL,oBAAoB,CAAClmE,SAAS,CAACumE,aAAa,GAAG,YAAW;IACzD,IAAIrJ,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,EAAE;MACT;IACD;IAEA,IACC,CAAC,IAAI,CAAC97C,iBAAiB,CAAC,CAAC,CAAC,IAC1B,CAAC,IAAI,CAACA,iBAAiB,CAAC,CAAC,CAAC,IAC1B,CAAC,IAAI,CAACA,iBAAiB,CAAC,CAAC,CAAC,EACzB;MACD;IACD,CAAC,CAAC;;IAEF,IAAI,CAAC8kD,oBAAoB,CAAC3E,OAAO,EAAE;MAClC2E,oBAAoB,CAAC3E,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAC3C/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAC9BoE,oBAAoB,CAACxE,YAAY,CACjC;MACD;MACA,IAAIvQ,OAAO,GAAG,IAAIjyC,YAAY,CAAC,EAAE,CAAC;MAClC,KAAK,IAAItf,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuxD,OAAO,CAACjyD,MAAM,EAAE,EAAEU,CAAC,EAAE;QACxCuxD,OAAO,CAACvxD,CAAC,CAAC,GAAGuiB,IAAI,CAACE,MAAM,EAAE,CAAC,CAAC;MAC7B;MACA;MACA6jD,oBAAoB,CAAC3E,OAAO,CAACiB,QAAQ,CAAC;QACrCiE,WAAW,EAAEtV,OAAO,CAAC7nC,QAAQ,CAAC,CAAC,EAAE,EAAE,CAAC;QACpCo9C,WAAW,EAAEvV,OAAO,CAAC7nC,QAAQ,CAAC,EAAE,EAAE,EAAE;MACrC,CAAC,CAAC;IACH;IAEA,IAAIkX,IAAI,GAAG,IAAI,CAACklC,aAAa;IAC7B,IAAI/9D,IAAI,GAAGquB,EAAE,CAACwnC,aAAa;IAC3B,IAAIN,GAAG,CAACv1D,IAAI,IAAIA,IAAI,EAAE;MACrB;MACAA,IAAI,GAAGquB,EAAE,CAAC2wC,KAAK;IAChB;IAEA,IAAI,CAACnmC,IAAI,IAAIA,IAAI,CAAC74B,IAAI,IAAIA,IAAI,EAAE;MAC/B,IAAI,CAAC+9D,aAAa,GAAG,IAAI5vC,EAAE,CAACqnC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE;QACzCx1D,IAAI,EAAEA,IAAI;QACV+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QACf1xD,MAAM,EAAEwpB,EAAE,CAACqoC;MACZ,CAAC,CAAC;IACH;IAEA,IAAI,CAAC8E,SAAS,CAACkD,eAAe,GAAG,CAAC;IAElC,IAAG,IAAI,CAAC37D,UAAU,CAAC07D,YAAY,EAC/B;MACC,IAAI,CAAC,IAAI,CAACQ,kBAAkB,IAAI,IAAI,CAACA,kBAAkB,CAACj/D,IAAI,IAAIA,IAAI,EACnE,IAAI,CAACi/D,kBAAkB,GAAG,IAAI9wC,EAAE,CAACqnC,OAAO,CAAC,GAAG,EAAE,GAAG,EAAE;QAClDx1D,IAAI,EAAEA,IAAI;QACV+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QACfuB,SAAS,EAAEzpC,EAAE,CAAC0qC,oBAAoB;QAClCkF,SAAS,EAAE5vC,EAAE,CAAC2nC;MACf,CAAC,CAAC;MAEHT,GAAG,CAACwC,MAAM,CAAE,IAAI,CAACkH,kBAAkB,CAAE;MACrC1J,GAAG,GAAG,IAAI,CAAC0J,kBAAkB;MAC7B1J,GAAG,CAAC7sD,IAAI,CAAC,CAAC,CAAC;MACX2lB,EAAE,CAAC2qC,cAAc,CAAC7qC,EAAE,CAACgwC,UAAU,CAAC;MAChC,IAAI,CAAC3C,SAAS,CAACkD,eAAe,GAAG,CAAC;IACnC;IAEA,IAAI/E,MAAM,GAAG4E,oBAAoB,CAAC3E,OAAO;IACzC,IAAIiB,QAAQ,GAAG,IAAI,CAACW,SAAS;IAC7BX,QAAQ,CAAC6D,eAAe,GAAG,IAAI,CAAC37D,UAAU,CAACm8D,aAAa;IACxD7wC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IACzBlsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IACpB,IAAI,CAACsD,aAAa,CAAC1D,MAAM,CAAC,YAAW;MACpC9E,GAAG,CAACsI,UAAU,CAAClE,MAAM,EAAEkB,QAAQ,CAAC;IACjC,CAAC,CAAC;IAEF,IAAI,IAAI,CAACphD,iBAAiB,CAAC,CAAC,CAAC,IAAI,IAAI,CAACA,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC3D,IAAI0lD,KAAK,GAAG,IAAI,CAACpB,aAAa,CAACqB,SAAS,EAAE;MAC1C,IAAID,KAAK,EAAE;QACV,IAAIl+D,CAAC,GAAG,IAAI,CAAC09D,UAAU;QACvB,IAAI3+D,IAAI,GAAG,IAAI,CAAC+9D,aAAa,CAAC/9D,IAAI;QAClCiB,CAAC,CAACD,GAAG,CAACm+D,KAAK,CAAC;QACZ,IAAIn/D,IAAI,IAAIquB,EAAE,CAACwnC,aAAa,EAAE;UAC7B4F,IAAI,CAACn6C,KAAK,CAACrgB,CAAC,EAAEA,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC;QAC1B,CAAC,MAAM,IACNjB,IAAI,IAAImuB,EAAE,CAACkxC,UAAU,IACrBr/D,IAAI,IAAImuB,EAAE,CAACmxC,cAAc,EACxB;UACD;QAAA;MAEF;IACD;EACD,CAAC;EAEDf,oBAAoB,CAACxE,YAAY,GAChC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CAAC,iBAAiB,EAAEw+D,oBAAoB,CAAC;;EAInE;EACA,SAASgB,mBAAmB,GAAG;IAC9B,IAAI,CAACrsD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACY,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC;IAClC,IAAI,CAACA,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC;IAClC,IAAI,CAACA,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC;IAC7B,IAAI,CAACA,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC;IAC7B,IAAI,CAAC/Q,UAAU,GAAG;MACjB0B,IAAI,EAAE,KAAK;MACX+5D,kBAAkB,EAAE,IAAI,CAAC;IAC1B,CAAC;;IAED,IAAI,CAAChD,SAAS,GAAG;MAChBV,SAAS,EAAE;IACZ,CAAC;IAED,IAAI,CAAC0E,IAAI,GAAG,IAAIjoD,YAAY,CAAC,CAAC,CAAC;IAC/B,IAAI,CAACkoD,IAAI,GAAG,IAAIloD,YAAY,CAAC,CAAC,CAAC;IAE/B,IAAI,CAACmoD,eAAe,GAAG,EAAE;EAC1B;EAEAH,mBAAmB,CAAC9iD,YAAY,GAAG;IAClChY,IAAI,EAAE;MAAEkY,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAE,CAAC,KAAK,EAAC,KAAK,EAAC,KAAK;IAAE;EACtD,CAAC;EAED0iD,mBAAmB,CAAChnE,KAAK,GAAG,QAAQ;EACpCgnE,mBAAmB,CAAC97D,IAAI,GAAG,2BAA2B;EAEtD87D,mBAAmB,CAAClnE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACpD,IAAI,CAAC,IAAI,CAACX,UAAU,CAACy7D,kBAAkB,EAAE;MACxC,IAAI,CAACmB,MAAM,EAAE;IACd;IAEA,IAAI,CAAC97D,aAAa,CAAC,CAAC,EAAE,IAAI,CAACk6D,aAAa,CAAC;IACzC,IAAI,CAACl6D,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC86D,UAAU,CAAC;EACvC,CAAC;;EAED;EACAY,mBAAmB,CAAClnE,SAAS,CAACwmE,kBAAkB,GAAG,YAAW;IAC7D,IAAI,CAACc,MAAM,EAAE;EACd,CAAC;EAEDJ,mBAAmB,CAAClnE,SAAS,CAACsnE,MAAM,GAAG,YAAW;IACjD,IAAIpK,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,EAAE;MACT;IACD;IAEA,IAAK,CAAC,IAAI,CAAC97C,iBAAiB,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAACA,iBAAiB,CAAC,CAAC,CAAC,EAAG;MAC/D;IACD,CAAC,CAAC;;IAEF,IAAI,CAAC8lD,mBAAmB,CAAC3F,OAAO,EAAE;MACjC2F,mBAAmB,CAAC3F,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAAE/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAAEoF,mBAAmB,CAACxF,YAAY,CAAE;IAChH;IAEA,IAAIlhC,IAAI,GAAG,IAAI,CAACklC,aAAa;IAC7B,IAAI/9D,IAAI,GAAGquB,EAAE,CAACwnC,aAAa;IAC3B,IAAIN,GAAG,CAACv1D,IAAI,IAAIA,IAAI,EAAE;MACrB;MACAA,IAAI,GAAGquB,EAAE,CAAC2wC,KAAK;IAChB;IAEA,IAAIz6D,IAAI,GAAG,GAAG;IAEd,IAAI,CAAC,IAAI,CAACm7D,eAAe,CAACnoE,MAAM,IAAI,IAAI,CAACmoE,eAAe,CAAC,CAAC,CAAC,CAAC1/D,IAAI,IAAIA,IAAI,EACxE;MACC,IAAI+Q,KAAK,GAAG,CAAC;MACb,OAAM9Y,CAAC,EACP;QACC,IAAI,CAACynE,eAAe,CAACznE,CAAC,CAAC,GAAG,IAAIk2B,EAAE,CAACqnC,OAAO,CAAEjxD,IAAI,EAAEA,IAAI,EAAE;UACrDvE,IAAI,EAAEA,IAAI;UACV+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;UACf1xD,MAAM,EAAEwpB,EAAE,CAACqoC;QACZ,CAAC,CAAC;QACFnyD,IAAI,GAAGA,IAAI,IAAI,CAAC;QAChBtM,CAAC,EAAE;QACH,IAAGsM,IAAI,IAAI,CAAC,EACX;MACF;IACD;IAEAgxD,GAAG,CAACwC,MAAM,CAAE,IAAI,CAAC2H,eAAe,CAAC,CAAC,CAAC,CAAE;IACrC,IAAI9+D,IAAI,GAAG,IAAI,CAAC8+D,eAAe,CAAC,CAAC,CAAC;IAClC,KAAI,IAAIznE,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAI,IAAI,CAACynE,eAAe,CAACnoE,MAAM,EAAE,EAAEU,CAAC,EACpD;MACC,IAAIs9D,GAAG,GAAG,IAAI,CAACmK,eAAe,CAACznE,CAAC,CAAC;MAEjC2I,IAAI,GAAG20D,GAAG;IACX;IAEA,IAAIoE,MAAM,GAAG4F,mBAAmB,CAAC3F,OAAO;IACxC,IAAIiB,QAAQ,GAAG,IAAI,CAACW,SAAS;IAC7BX,QAAQ,CAAC6D,eAAe,GAAG,IAAI,CAAC37D,UAAU,CAACm8D,aAAa;IACxD7wC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IACzBlsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IACpB,IAAI,CAACsD,aAAa,CAAC1D,MAAM,CAAC,YAAW;MACpC9E,GAAG,CAACsI,UAAU,CAAClE,MAAM,EAAEkB,QAAQ,CAAC;IACjC,CAAC,CAAC;EACH,CAAC;EAED0E,mBAAmB,CAACxF,YAAY,GAC/B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;EAEF;;EAGA,SAAS6F,2BAA2B,GAAG;IACtC,IAAI,CAAC1sD,QAAQ,CAAC,IAAI,EAAE,SAAS,CAAC;IAC9B,IAAI,CAACA,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC;IACjC,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;IAChC,IAAI,CAAC/Q,UAAU,GAAG;MAAEmmD,MAAM,EAAE;IAAI,CAAC;IACjC,IAAI,CAACsS,SAAS,GAAG;MAChBV,SAAS,EAAE,CAAC;MACZC,UAAU,EAAE,CAAC;MACbwB,QAAQ,EAAE,IAAI,CAACx5D,UAAU,CAACmmD;IAC3B,CAAC;EACF;EAEA0W,2BAA2B,CAACrnE,KAAK,GAAG,QAAQ;EAC5CqnE,2BAA2B,CAACn8D,IAAI,GAAG,0BAA0B;EAE7Dm8D,2BAA2B,CAACvnE,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5D,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,IAAI,CAAC,IAAI,CAAC97C,iBAAiB,CAAC,CAAC,CAAC,EAAE;MACvC;IACD;IAEA,IAAI,CAACmmD,2BAA2B,CAAChG,OAAO,EAAE;MACzCgG,2BAA2B,CAAChG,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAClD/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAC9ByF,2BAA2B,CAAC7F,YAAY,CACxC;IACF;IAEA,IAAIlhC,IAAI,GAAG,IAAI,CAACklC,aAAa;IAC7B,IACC,CAACllC,IAAI,IACLA,IAAI,CAAC74B,IAAI,IAAIu1D,GAAG,CAACv1D,IAAI,IACrB64B,IAAI,CAACxV,KAAK,IAAIkyC,GAAG,CAAClyC,KAAK,IACvBwV,IAAI,CAACvV,MAAM,IAAIiyC,GAAG,CAACjyC,MAAM,EACxB;MACD,IAAIrf,OAAO,GAAG;QACbjE,IAAI,EAAEu1D,GAAG,CAACv1D,IAAI;QACd+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QACf1xD,MAAM,EAAEwpB,EAAE,CAACqoC;MACZ,CAAC;MACD,IAAI,CAACqH,aAAa,GAAG,IAAI5vC,EAAE,CAACqnC,OAAO,CAACD,GAAG,CAAClyC,KAAK,EAAEkyC,GAAG,CAACjyC,MAAM,EAAErf,OAAO,CAAE;MACpE,IAAI,CAAC47D,cAAc,GAAG,IAAI1xC,EAAE,CAACqnC,OAAO,CAACD,GAAG,CAAClyC,KAAK,EAAEkyC,GAAG,CAACjyC,MAAM,EAAErf,OAAO,CAAE;MACrEsxD,GAAG,CAACwC,MAAM,CAAC,IAAI,CAAC8H,cAAc,CAAC;IAChC;IAEA,IAAIj/B,KAAK,GAAG,IAAI,CAACm9B,aAAa;IAC9B,IAAIl9B,KAAK,GAAG,IAAI,CAACg/B,cAAc;IAE/B,IAAIlG,MAAM,GAAGiG,2BAA2B,CAAChG,OAAO;IAChD,IAAIiB,QAAQ,GAAG,IAAI,CAACW,SAAS;IAC7BX,QAAQ,CAAC0B,QAAQ,GAAG,GAAG,GAAG,IAAI,CAACjjD,kBAAkB,CAAC,QAAQ,CAAC;IAE3D+U,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IACpBpsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IACzB35B,KAAK,CAACy5B,MAAM,CAAC,YAAW;MACvBx5B,KAAK,CAACn4B,IAAI,CAAC,CAAC,CAAC;MACb6sD,GAAG,CAACsI,UAAU,CAAClE,MAAM,EAAEkB,QAAQ,CAAC;IACjC,CAAC,CAAC;IAEF,IAAI,CAACh3D,aAAa,CAAC,CAAC,EAAE+8B,KAAK,CAAC;;IAE5B;IACA,IAAI,CAACm9B,aAAa,GAAGl9B,KAAK;IAC1B,IAAI,CAACg/B,cAAc,GAAGj/B,KAAK;EAC5B,CAAC;EAEDg/B,2BAA2B,CAAC7F,YAAY,GACvC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CAAE,yBAAyB,EAAE6/D,2BAA2B,CAAE;EAGpF,SAASE,4BAA4B,GAAG;IACvC,IAAI,CAAC5sD,QAAQ,CAAC,IAAI,EAAE,SAAS,CAAC;IAC9B,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;IAChC,IAAI,CAACA,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC;IAClC,IAAI,CAAC/Q,UAAU,GAAG;MAAEymD,OAAO,EAAE,EAAE;MAAEuW,eAAe,EAAE;IAAE,CAAC;IACrD,IAAI,CAACvE,SAAS,GAAG;MAChBV,SAAS,EAAE,CAAC;MACZC,UAAU,EAAE,CAAC;MACbiF,SAAS,EAAE,IAAI,CAACj9D,UAAU,CAACymD,OAAO;MAClCyW,UAAU,EAAE,CAAC,GAAC,IAAI,CAACl9D,UAAU,CAACymD;IAC/B,CAAC;IACD,IAAI,CAACn/B,KAAK,GAAG,CAAC;EACf;EAEAy1C,4BAA4B,CAACvnE,KAAK,GAAG,mBAAmB;EACxDunE,4BAA4B,CAACr8D,IAAI,GAAG,mCAAmC;EAEvEq8D,4BAA4B,CAAC,UAAU,CAAC,GAAG;IAAE9/D,IAAI,EAAE,QAAQ;IAAEo+B,GAAG,EAAE,CAAC;IAAEziB,GAAG,EAAE,EAAE;IAAE8oB,IAAI,EAAE,CAAC;IAAEL,SAAS,EAAE;EAAE,CAAC;EAErG07B,4BAA4B,CAACznE,SAAS,CAACugE,iBAAiB,GAAG,YAC3D;IACC,OAAO,IAAI,CAACiH,cAAc;EAC3B,CAAC;EAEDC,4BAA4B,CAACznE,SAAS,CAACqL,SAAS,GAAG,YAAW;IAE7D,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,IAAI,CAAC,IAAI,CAAC97C,iBAAiB,CAAC,CAAC,CAAC,EAAE;MACvC;IACD;IAEA,IAAI,CAACqmD,4BAA4B,CAAClG,OAAO,EAAE;MAC1CkG,4BAA4B,CAACI,YAAY,GAAG,IAAI/xC,EAAE,CAAC+rC,MAAM,CAAE/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAAE2F,4BAA4B,CAACK,iBAAiB,CAAE;MAC3IL,4BAA4B,CAACM,WAAW,GAAG,IAAIjyC,EAAE,CAAC+rC,MAAM,CAAE/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAAE2F,4BAA4B,CAACO,gBAAgB,CAAE;IAC1I;IAEA,IAAI7W,OAAO,GAAGhvC,IAAI,CAAC+pB,KAAK,CAAC,IAAI,CAACxhC,UAAU,CAACymD,OAAO,EAAC,CAAC,EAAC,EAAE,CAAC;IACtD,IAAIn/B,KAAK,GAAG,IAAI,CAACA,KAAK;IACtB,IAAIxe,QAAQ,GAAG,IAAI,CAAC9I,UAAU,CAACg9D,eAAe;IAE9C,IAAIl0D,QAAQ,IAAI,CAAC,IAAIwe,KAAK,GAAGxe,QAAQ,IAAI,CAAC,EAC1C;MACC,IAAIgtB,IAAI,GAAG,IAAI,CAACklC,aAAa;MAC7B,IAAK,CAACllC,IAAI,IAAIA,IAAI,CAAC74B,IAAI,IAAIu1D,GAAG,CAACv1D,IAAI,IAAI64B,IAAI,CAACxV,KAAK,IAAImmC,OAAO,EAAG;QAC9D,IAAIvlD,OAAO,GAAG;UACbjE,IAAI,EAAEu1D,GAAG,CAACv1D,IAAI;UACd+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;UACf1xD,MAAM,EAAEwpB,EAAE,CAACqoC;QACZ,CAAC;QACD,IAAI,CAACqH,aAAa,GAAG,IAAI5vC,EAAE,CAACqnC,OAAO,CAAEhM,OAAO,EAAE,CAAC,EAAEvlD,OAAO,CAAE;QAC1D,IAAI,CAAC47D,cAAc,GAAG,IAAI1xC,EAAE,CAACqnC,OAAO,CAAEhM,OAAO,EAAE,CAAC,EAAEvlD,OAAO,CAAE;QAC3D,IAAI,CAACq8D,iBAAiB,GAAG,IAAInyC,EAAE,CAACqnC,OAAO,CAAE,CAAC,EAAE,CAAC,EAAEvxD,OAAO,CAAE;MACzD;MAEA,IAAI28B,KAAK,GAAG,IAAI,CAACm9B,aAAa;MAC9B,IAAIl9B,KAAK,GAAG,IAAI,CAACg/B,cAAc;MAE/B,IAAIU,WAAW,GAAGT,4BAA4B,CAACI,YAAY;MAC3D,IAAIM,UAAU,GAAGV,4BAA4B,CAACM,WAAW;MACzD,IAAIvF,QAAQ,GAAG,IAAI,CAACW,SAAS;MAC7BX,QAAQ,CAACmF,SAAS,GAAGxW,OAAO;MAC5BqR,QAAQ,CAACoF,UAAU,GAAG,GAAG,GAAGzW,OAAO;MAEnCn7B,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;MACpBpsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;MACzB35B,KAAK,CAACy5B,MAAM,CAAC,YAAW;QACvBx5B,KAAK,CAACn4B,IAAI,CAAC,CAAC,CAAC;QACb6sD,GAAG,CAACsI,UAAU,CAAE0C,WAAW,EAAE1F,QAAQ,CAAE;MACxC,CAAC,CAAC;MAEF,IAAI,CAACyF,iBAAiB,CAACjG,MAAM,CAAC,YAAW;QACxCz5B,KAAK,CAACi9B,UAAU,CAAE2C,UAAU,EAAE3F,QAAQ,CAAE;MACzC,CAAC,CAAC;MAEF,IAAI,CAACh3D,aAAa,CAAE,CAAC,EAAE,IAAI,CAACy8D,iBAAiB,CAAE;;MAE/C;MACA,IAAI,CAACvC,aAAa,GAAGl9B,KAAK;MAC1B,IAAI,CAACg/B,cAAc,GAAGj/B,KAAK;IAC5B,CAAC,MAEA,IAAI,CAAC/8B,aAAa,CAAC,CAAC,EAAE,IAAI,CAACy8D,iBAAiB,CAAC;IAC9C,IAAI,CAACz8D,aAAa,CAAC,CAAC,EAAE,IAAI,CAACg8D,cAAc,CAAC;IAC1C,IAAI,CAACx1C,KAAK,EAAE;EACb,CAAC;EAEDy1C,4BAA4B,CAACK,iBAAiB,GAC7C;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFL,4BAA4B,CAACO,gBAAgB,GAC5C;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAGFvmE,SAAS,CAACiG,gBAAgB,CAAE,2BAA2B,EAAE+/D,4BAA4B,CAAE;;EAEvF;EACA,SAASW,oBAAoB,GAAG;IAC/B,IAAI,CAACvtD,QAAQ,CAAC,OAAO,EAAE,OAAO,CAAC;IAC/B,IAAI,CAACY,SAAS,CAAC,EAAE,EAAE,SAAS,CAAC;IAC7B,IAAI,CAAC/Q,UAAU,GAAG,CAAC,CAAC;EACrB;EAEA09D,oBAAoB,CAACloE,KAAK,GAAG,kBAAkB;EAC/CkoE,oBAAoB,CAACh9D,IAAI,GAAG,6BAA6B;EACzD;;EAEAg9D,oBAAoB,CAACpoE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACrD,IAAIgd,GAAG,GAAG,IAAI,CAAC/c,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC+c,GAAG,EAAE;MACT;IACD;IAEA,IAAI2C,KAAK,GAAG3C,GAAG,CAACqwC,UAAU,IAAIrwC,GAAG,CAAC2C,KAAK;IACvC,IAAIC,MAAM,GAAG5C,GAAG,CAACswC,WAAW,IAAItwC,GAAG,CAAC4C,MAAM;;IAE1C;IACA,IAAI5C,GAAG,CAACggD,SAAS,EAAE;MAClB,IAAI,CAAC78D,aAAa,CAAC,CAAC,EAAE6c,GAAG,CAACggD,SAAS,CAAC;MACpC;IACD;IAEA,IAAI7nC,IAAI,GAAG,IAAI,CAACklC,aAAa;IAC7B,IAAI,CAACllC,IAAI,IAAIA,IAAI,CAACxV,KAAK,IAAIA,KAAK,IAAIwV,IAAI,CAACvV,MAAM,IAAIA,MAAM,EAAE;MAC1D,IAAI,CAACy6C,aAAa,GAAG,IAAI5vC,EAAE,CAACqnC,OAAO,CAACnyC,KAAK,EAAEC,MAAM,EAAE;QAClDyyC,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QACf1xD,MAAM,EAAEwpB,EAAE,CAAC2nC;MACZ,CAAC,CAAC;IACH;IAEA,IAAI;MACH,IAAI,CAAC+H,aAAa,CAAC4C,WAAW,CAACjgD,GAAG,CAAC;IACpC,CAAC,CAAC,OAAOvc,GAAG,EAAE;MACbjE,OAAO,CAACkE,KAAK,CACZ,oEAAoE,GACnED,GAAG,CACJ;MACD;IACD;IAEA,IAAI,CAACN,aAAa,CAAC,CAAC,EAAE,IAAI,CAACk6D,aAAa,CAAC;EAC1C,CAAC;EAEDjkE,SAAS,CAACiG,gBAAgB,CACzB,wBAAwB,EACxB0gE,oBAAoB,CACpB;;EAED;EACA,SAASG,gBAAgB,GAAG;IAC3B,IAAI,CAAC1tD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACA,QAAQ,CAAC,KAAK,EAAE,SAAS,CAAC;IAC/B,IAAI,CAACA,QAAQ,CAAC,WAAW,EAAE,QAAQ,CAAC;IACpC,IAAI,CAACY,SAAS,CAAC,EAAE,EAAE,SAAS,CAAC;IAC7B,IAAI,CAAC/Q,UAAU,GAAG;MAAE6f,OAAO,EAAE,IAAI;MAAEi+C,SAAS,EAAE,CAAC;MAAEz8B,SAAS,EAAEgwB,aAAa,CAACS,OAAO;MAAEwB,OAAO,EAAE;IAAK,CAAC;IAElG,IAAI,CAACuK,gBAAgB,CAAChH,OAAO,EAAE;MAC9BgH,gBAAgB,CAAChH,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAAEA,MAAM,CAACC,oBAAoB,EAAEyG,gBAAgB,CAAC7G,YAAY,CAAE;IACvG;EACD;EAEA6G,gBAAgB,CAACnkD,YAAY,GAAG;IAC/B45C,OAAO,EAAE;MAAE15C,MAAM,EAAE;IAAU,CAAC;IAC9BynB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAED8L,gBAAgB,CAACroE,KAAK,GAAG,KAAK;EAC9BqoE,gBAAgB,CAACn9D,IAAI,GAAG,sBAAsB;EAE9Cm9D,gBAAgB,CAACvoE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACjD,IAAI,CAAC,IAAI,CAAC+V,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF,IAAI87C,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAE9B,IAAI,IAAI,CAACZ,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACI,YAAY,IAAI,IAAI,CAACzxD,UAAU,CAAC6f,OAAO,KAAK,KAAK,EAAE;MAClG,IAAI,CAAC/e,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEA,IAAI,CAACA,GAAG,EAAE;MACT;IACD;IAEA,IAAIuL,OAAO,GAAG,IAAI,CAACn9D,YAAY,CAAC,CAAC,CAAC;IAElC,IAAI,CAACm9D,OAAO,EAAE;MACbA,OAAO,GAAG1M,aAAa,CAACsB,UAAU,CAAC,IAAI,CAAC3yD,UAAU,CAACszD,OAAO,CAAC;IAC5D;IAEA,IAAI,CAACyK,OAAO,EAAE;MACb,IAAI,CAACj9D,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEAuL,OAAO,CAACp4D,IAAI,CAAC,CAAC,CAAC;IACf2lB,EAAE,CAAC0yC,aAAa,CAAC1yC,EAAE,CAAC8vC,UAAU,EAAE9vC,EAAE,CAACyqC,kBAAkB,EAAEzqC,EAAE,CAAC2nC,MAAM,CAAC;IACjE3nC,EAAE,CAAC0yC,aAAa,CACf1yC,EAAE,CAAC8vC,UAAU,EACb9vC,EAAE,CAAC2yC,cAAc,EACjB3yC,EAAE,CAAC4yC,aAAa,CAChB;IACD5yC,EAAE,CAAC0yC,aAAa,CACf1yC,EAAE,CAAC8vC,UAAU,EACb9vC,EAAE,CAAC6yC,cAAc,EACjB7yC,EAAE,CAAC4yC,aAAa,CAChB;IACD5yC,EAAE,CAAC8yC,WAAW,CAAC9yC,EAAE,CAAC8vC,UAAU,EAAE,IAAI,CAAC;IAEnC,IAAI0C,SAAS,GAAG,IAAI,CAAC99D,UAAU,CAAC89D,SAAS;IACzC,IAAI,IAAI,CAAC3nD,gBAAgB,CAAC,CAAC,CAAC,EAAE;MAC7B,IAAI,CAACnW,UAAU,CAAC89D,SAAS,GAAGA,SAAS,GAAG,IAAI,CAACl9D,YAAY,CAAC,CAAC,CAAC;IAC7D;IAEA,IAAI,CAAC81D,IAAI,GAAGrF,aAAa,CAACuB,gBAAgB,CACzCJ,GAAG,EACH,IAAI,CAACkE,IAAI,EACT,IAAI,CAAC12D,UAAU,CAACqhC,SAAS,CACzB;;IAED;;IAEA,IAAI,CAACq1B,IAAI,CAACY,MAAM,CAAC,YAAW;MAC3ByG,OAAO,CAACp4D,IAAI,CAAC,CAAC,CAAC;MACf6sD,GAAG,CAACsI,UAAU,CAAC+C,gBAAgB,CAAChH,OAAO,EAAE;QACxCkB,SAAS,EAAE,CAAC;QACZC,UAAU,EAAE,CAAC;QACbqG,QAAQ,EAAEP;MACX,CAAC,CAAC;IACH,CAAC,CAAC;IAEF,IAAI,CAACh9D,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC41D,IAAI,CAAC;EACjC,CAAC;EAEDmH,gBAAgB,CAAC7G,YAAY,GAC5B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAE6gE,gBAAgB,CAAC;;EAG3D;EACA,SAASS,mBAAmB,GAAG;IAC9B,IAAI,CAACnuD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACA,QAAQ,CAAC,OAAO,EAAE,SAAS,CAAC;IACjC,IAAI,CAACY,SAAS,CAAC,EAAE,EAAE,SAAS,CAAC;IAC7B,IAAI,CAAC/Q,UAAU,GAAG;MAAE6f,OAAO,EAAE,IAAI;MAAE0+C,eAAe,EAAE,CAAC;MAAEC,WAAW,EAAE,EAAE;MAAEC,UAAU,EAAE,CAAC;MAAEC,QAAQ,EAAE,KAAK;MAAE58D,MAAM,EAAE,KAAK;MAAE68D,MAAM,EAAE,KAAK;MAAEt9B,SAAS,EAAEgwB,aAAa,CAACS,OAAO;MAAE8D,gBAAgB,EAAE,KAAK;MAAEtC,OAAO,EAAE;IAAK,CAAC;IAEhN,IAAI,CAACgL,mBAAmB,CAACzH,OAAO,EAAE;MACjCyH,mBAAmB,CAACzH,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAAEA,MAAM,CAACC,oBAAoB,EAAEkH,mBAAmB,CAACtH,YAAY,CAAE;IAC7G;IAEA,IAAI,CAACyB,SAAS,GAAG;MACfV,SAAS,EAAE,CAAC;MACZC,UAAU,EAAE,CAAC;MACb4G,aAAa,EAAE,CAAC;MAChBC,aAAa,EAAE,EAAE;MACjBC,KAAK,EAAEhoB,IAAI,CAAC4R,MAAM;IACpB,CAAC;EACF;EAEA4V,mBAAmB,CAAC5kD,YAAY,GAAG;IAClC45C,OAAO,EAAE;MAAE15C,MAAM,EAAE;IAAU,CAAC;IAC9BynB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDuM,mBAAmB,CAAC9oE,KAAK,GAAG,QAAQ;EACpC8oE,mBAAmB,CAAC59D,IAAI,GAAG,2CAA2C;EAEtE49D,mBAAmB,CAAChpE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACpD,IAAI,CAAC,IAAI,CAAC+V,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF,IAAI87C,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAE9B,IAAI,IAAI,CAACZ,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACI,YAAY,IAAI,IAAI,CAACzxD,UAAU,CAAC6f,OAAO,KAAK,KAAK,EAAE;MAClG,IAAI,CAAC/e,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEA,IAAI,CAACA,GAAG,EAAE;MACT;IACD;IAEA,IAAIuM,WAAW,GAAG,IAAI,CAACn+D,YAAY,CAAC,CAAC,CAAC;IAEtC,IAAI,CAACm+D,WAAW,EAAE;MACjBA,WAAW,GAAG1N,aAAa,CAACsB,UAAU,CAAC,IAAI,CAAC3yD,UAAU,CAACszD,OAAO,CAAC;IAChE;IAEA,IAAI,CAACyL,WAAW,EAAE;MACjB,IAAI,CAACj+D,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEAuM,WAAW,CAACp5D,IAAI,CAAC,CAAC,CAAC;IACnB2lB,EAAE,CAAC0yC,aAAa,CAAC1yC,EAAE,CAAC8vC,UAAU,EAAE9vC,EAAE,CAAC6oC,kBAAkB,EAAE,IAAI,CAACn0D,UAAU,CAAC8B,MAAM,GAAGwpB,EAAE,CAAC2nC,MAAM,GAAG3nC,EAAE,CAACqoC,OAAO,CAAE;IACxGroC,EAAE,CAAC0yC,aAAa,CAAC1yC,EAAE,CAAC8vC,UAAU,EAAE9vC,EAAE,CAACyqC,kBAAkB,EAAE,IAAI,CAAC/1D,UAAU,CAAC8B,MAAM,GAAGwpB,EAAE,CAAC2nC,MAAM,GAAG3nC,EAAE,CAACqoC,OAAO,CAAE;IACxGroC,EAAE,CAAC0yC,aAAa,CAAC1yC,EAAE,CAAC8vC,UAAU,EAAE9vC,EAAE,CAAC2yC,cAAc,EAAE3yC,EAAE,CAAC4yC,aAAa,CAAE;IACrE5yC,EAAE,CAAC0yC,aAAa,CAAC1yC,EAAE,CAAC8vC,UAAU,EAAE9vC,EAAE,CAAC6yC,cAAc,EAAE7yC,EAAE,CAAC4yC,aAAa,CAAE;IACrE5yC,EAAE,CAAC8yC,WAAW,CAAC9yC,EAAE,CAAC8vC,UAAU,EAAE,IAAI,CAAC;IAEnC,IAAItD,QAAQ,GAAG,IAAI,CAACW,SAAS;IAC7BX,QAAQ,CAAC8G,aAAa,GAAGnnD,IAAI,CAACC,KAAK,CAAC,IAAI,CAAC1X,UAAU,CAACu+D,eAAe,CAAC;IACpEzG,QAAQ,CAACkH,aAAa,GAAG,IAAI,CAACh/D,UAAU,CAACw+D,WAAW;IACpD1G,QAAQ,CAACmH,YAAY,GAAG,IAAI,CAACj/D,UAAU,CAACy+D,UAAU;IAClD3G,QAAQ,CAACoH,QAAQ,GAAG,IAAI,CAACl/D,UAAU,CAAC2+D,MAAM,GAAG,CAAC,GAAG,CAAC;IAClD7G,QAAQ,CAACqH,UAAU,GAAG,IAAI,CAACn/D,UAAU,CAAC0+D,QAAQ,GAAG,CAAC,GAAG,CAAC;IAEtD,IAAI,CAAChI,IAAI,GAAGrF,aAAa,CAACuB,gBAAgB,CAAEJ,GAAG,EAAE,IAAI,CAACkE,IAAI,EAAE,IAAI,CAAC12D,UAAU,CAACqhC,SAAS,CAAE;IACvFy2B,QAAQ,CAACgH,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACpI,IAAI,CAACp2C,KAAK;IACnCw3C,QAAQ,CAACgH,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACpI,IAAI,CAACn2C,MAAM;IACpC,IAAI,CAACm2C,IAAI,CAAC/wD,IAAI,CAAC,CAAC,CAAC;IACjB2lB,EAAE,CAAC0yC,aAAa,CAAC1yC,EAAE,CAAC8vC,UAAU,EAAE9vC,EAAE,CAAC6oC,kBAAkB,EAAE7oC,EAAE,CAACqoC,OAAO,CAAE;IACnEroC,EAAE,CAAC0yC,aAAa,CAAC1yC,EAAE,CAAC8vC,UAAU,EAAE9vC,EAAE,CAACyqC,kBAAkB,EAAEzqC,EAAE,CAACqoC,OAAO,CAAE;IAEnE,IAAI,CAAC+C,IAAI,CAACY,MAAM,CAAC,YAAW;MAC3ByH,WAAW,CAACp5D,IAAI,CAAC,CAAC,CAAC;MACnB6sD,GAAG,CAACsI,UAAU,CAACwD,mBAAmB,CAACzH,OAAO,EAAEiB,QAAQ,CAAC;IACtD,CAAC,CAAC;IAEF,IAAI,IAAI,CAAC93D,UAAU,CAAC41D,gBAAgB,EAAE;MACrC,IAAI,CAACc,IAAI,CAAC/wD,IAAI,CAAC,CAAC,CAAC;MACjB2lB,EAAE,CAAC2qC,cAAc,CAAC,IAAI,CAACS,IAAI,CAACR,YAAY,CAAC;MACzC,IAAI,CAACQ,IAAI,CAACP,MAAM,CAAC,CAAC,CAAC;IACpB;IAEA,IAAI,CAACr1D,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC41D,IAAI,CAAC;EACjC,CAAC;EAED4H,mBAAmB,CAACtH,YAAY,GAC/B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CAAC,gBAAgB,EAAEshE,mBAAmB,CAAC;;EAEjE;EACA,SAASc,qBAAqB,GAAG;IAChC,IAAI,CAACjvD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IAEnC,IAAI,CAACY,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC;IAC9B,IAAI,CAACA,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC;IAC9B,IAAI,CAACA,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC;IAC9B,IAAI,CAACA,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC;;IAE9B;IACA,IAAI,CAACquD,qBAAqB,CAACvI,OAAO,EAAE;MACnCuI,qBAAqB,CAACvI,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAC5CA,MAAM,CAACC,oBAAoB,EAC3BgI,qBAAqB,CAACpI,YAAY,CAClC;IACF;EACD;EAEAoI,qBAAqB,CAAC5pE,KAAK,GAAG,qBAAqB;EACnD4pE,qBAAqB,CAAC1+D,IAAI,GAAG,wBAAwB;EAErD0+D,qBAAqB,CAAC9pE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtD,IAAI0+D,IAAI,GAAG,IAAI,CAACz+D,YAAY,CAAC,CAAC,CAAC;IAC/B,IAAI,CAACy+D,IAAI,EAAE;MACV;IACD;IAEA,IAAI,CAAC,IAAI,CAACC,SAAS,EAAE;MACpB,IAAI,CAACA,SAAS,GAAGtqE,KAAK,CAAC,CAAC,CAAC;IAC1B;;IAEA;IACA,IAAIg+D,MAAM,GAAG1nC,EAAE,CAACi0C,GAAG;IACnB,IAAI7qD,WAAW,GAAG,CAAC;IACnB,KAAK,IAAIxf,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAEA,CAAC,EAAE,EAAE;MAC3B,IAAI,IAAI,CAACwhB,iBAAiB,CAACxhB,CAAC,CAAC,EAAE;QAC9B,IACC,CAAC,IAAI,CAACoqE,SAAS,CAACpqE,CAAC,CAAC,IAClB,IAAI,CAACoqE,SAAS,CAACpqE,CAAC,CAAC,CAACorB,KAAK,IAAI++C,IAAI,CAAC/+C,KAAK,IACrC,IAAI,CAACg/C,SAAS,CAACpqE,CAAC,CAAC,CAACqrB,MAAM,IAAI8+C,IAAI,CAAC9+C,MAAM,IACvC,IAAI,CAAC++C,SAAS,CAACpqE,CAAC,CAAC,CAAC+H,IAAI,IAAIoiE,IAAI,CAACpiE,IAAI,IACnC,IAAI,CAACqiE,SAAS,CAACpqE,CAAC,CAAC,CAAC89D,MAAM,IAAIA,MAAM,EACjC;UACD,IAAI,CAACsM,SAAS,CAACpqE,CAAC,CAAC,GAAG,IAAIk2B,EAAE,CAACqnC,OAAO,CACjC4M,IAAI,CAAC/+C,KAAK,EACV++C,IAAI,CAAC9+C,MAAM,EACX;YACCtjB,IAAI,EAAEoiE,IAAI,CAACpiE,IAAI;YACf+1D,MAAM,EAAEA,MAAM;YACdlxD,MAAM,EAAEwpB,EAAE,CAAC2nC;UACZ,CAAC,CACD;QACF;QACAv+C,WAAW,EAAE;MACd,CAAC,MAAM;QACN,IAAI,CAAC4qD,SAAS,CAACpqE,CAAC,CAAC,GAAG,IAAI;MACzB;IACD;IAEA,IAAI,CAACwf,WAAW,EAAE;MACjB;IACD;IAEA4W,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IACpBpsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IAEzB,IAAIG,IAAI,GAAGC,IAAI,CAACC,aAAa,EAAE;IAC/B,IAAIjB,MAAM,GAAGwI,qBAAqB,CAACvI,OAAO;IAC1C,IAAI2I,KAAK,GAAG,CACX,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACZ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACZ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EACZ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CACZ;IAED,KAAK,IAAItqE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAEA,CAAC,EAAE,EAAE;MAC3B,IAAI,CAAC,IAAI,CAACoqE,SAAS,CAACpqE,CAAC,CAAC,EAAE;QACvB;MACD;MAEA,IAAI,CAACoqE,SAAS,CAACpqE,CAAC,CAAC,CAACoiE,MAAM,CAAC,YAAW;QACnC+H,IAAI,CAAC15D,IAAI,CAAC,CAAC,CAAC;QACZixD,MAAM,CACJkB,QAAQ,CAAC;UAAEC,SAAS,EAAE,CAAC;UAAE0H,MAAM,EAAED,KAAK,CAACtqE,CAAC;QAAE,CAAC,CAAC,CAC5C82B,IAAI,CAAC2rC,IAAI,CAAC;MACb,CAAC,CAAC;MACF,IAAI,CAAC72D,aAAa,CAAC5L,CAAC,EAAE,IAAI,CAACoqE,SAAS,CAACpqE,CAAC,CAAC,CAAC;IACzC;EACD,CAAC;EAEDkqE,qBAAqB,CAACpI,YAAY,GACjC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CACzB,yBAAyB,EACzBoiE,qBAAqB,CACrB;;EAED;EACA,SAASM,qBAAqB,GAAG;IAChC,IAAI,CAACvvD,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAE7B,IAAI,CAACY,SAAS,CAAC,SAAS,EAAE,SAAS,CAAC;IAEpC,IAAI,CAAC/Q,UAAU,GAAG;MACjBqhC,SAAS,EAAEgwB,aAAa,CAACS,OAAO;MAChC7I,CAAC,EAAE,CAAC;MACJ0W,CAAC,EAAE,CAAC;MACJj0D,CAAC,EAAE,CAAC;MACJD,CAAC,EAAE;IACJ,CAAC;IACD,IAAI,CAACm0D,MAAM,GAAGlH,IAAI,CAAChQ,MAAM,EAAE;IAC3B,IAAI,CAAC+P,SAAS,GAAG;MAChBoH,UAAU,EAAE,CAAC;MACbC,UAAU,EAAE,CAAC;MACb9H,UAAU,EAAE,CAAC;MACb+H,UAAU,EAAE,CAAC;MACbvH,OAAO,EAAE,IAAI,CAACoH;IACf,CAAC;EACF;EAEAF,qBAAqB,CAAClqE,KAAK,GAAG,qBAAqB;EACnDkqE,qBAAqB,CAACh/D,IAAI,GAAG,wBAAwB;EACrDg/D,qBAAqB,CAAChmD,YAAY,GAAG;IACpC2nB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAED2N,qBAAqB,CAACpqE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtD,IAAIq/D,KAAK,GAAG3O,aAAa,CAAC+B,eAAe,EAAE;IAC3C,IAAI6M,IAAI,GAAG,IAAI,CAACr/D,YAAY,CAAC,CAAC,CAAC,IAAIo/D,KAAK;IACxC,IAAIE,IAAI,GAAG,IAAI,CAACt/D,YAAY,CAAC,CAAC,CAAC,IAAIo/D,KAAK;IACxC,IAAIrJ,IAAI,GAAG,IAAI,CAAC/1D,YAAY,CAAC,CAAC,CAAC,IAAIo/D,KAAK;IACxC,IAAIX,IAAI,GAAG,IAAI,CAACz+D,YAAY,CAAC,CAAC,CAAC,IAAIo/D,KAAK;IAExC10C,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IACpBpsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IAEzB,IAAIG,IAAI,GAAGC,IAAI,CAACC,aAAa,EAAE;IAC/B,IAAI,CAAC6H,qBAAqB,CAAC7I,OAAO,EAAE;MACnC6I,qBAAqB,CAAC7I,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAC5CA,MAAM,CAACC,oBAAoB,EAC3BsI,qBAAqB,CAAC1I,YAAY,CAClC;IACF;IACA,IAAIJ,MAAM,GAAG8I,qBAAqB,CAAC7I,OAAO;IAE1C,IAAI9hD,CAAC,GAAG0C,IAAI,CAACmB,GAAG,CAACqnD,IAAI,CAAC3/C,KAAK,EAAE4/C,IAAI,CAAC5/C,KAAK,EAAEq2C,IAAI,CAACr2C,KAAK,EAAE++C,IAAI,CAAC/+C,KAAK,CAAC;IAChE,IAAImR,CAAC,GAAGha,IAAI,CAACmB,GAAG,CACfqnD,IAAI,CAAC1/C,MAAM,EACX2/C,IAAI,CAAC3/C,MAAM,EACXo2C,IAAI,CAACp2C,MAAM,EACX8+C,IAAI,CAAC9+C,MAAM,CACX;IACD,IAAItjB,IAAI,GACP,IAAI,CAAC+C,UAAU,CAACqhC,SAAS,IAAIgwB,aAAa,CAACO,IAAI,GAC5CP,aAAa,CAAC0B,qBAAqB,GACnCznC,EAAE,CAACwnC,aAAa;IAEpB,IACC,CAAC,IAAI,CAACgD,QAAQ,IACd,IAAI,CAACA,QAAQ,CAACx1C,KAAK,IAAIvL,CAAC,IACxB,IAAI,CAAC+gD,QAAQ,CAACv1C,MAAM,IAAIkR,CAAC,IACzB,IAAI,CAACqkC,QAAQ,CAAC74D,IAAI,IAAIA,IAAI,EACzB;MACD,IAAI,CAAC64D,QAAQ,GAAG,IAAI1qC,EAAE,CAACqnC,OAAO,CAAC19C,CAAC,EAAE0c,CAAC,EAAE;QACpCx0B,IAAI,EAAEA,IAAI;QACV+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QACf1xD,MAAM,EAAEwpB,EAAE,CAAC2nC;MACZ,CAAC,CAAC;IACH;IAEA,IAAI9+C,KAAK,GAAG,IAAI,CAACyrD,MAAM;IACvBzrD,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACnU,UAAU,CAACipD,CAAC;IAC5B90C,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACnU,UAAU,CAAC2/D,CAAC;IAC5BxrD,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACnU,UAAU,CAAC0L,CAAC;IAC5ByI,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAACnU,UAAU,CAACyL,CAAC;IAC5B,IAAIqsD,QAAQ,GAAG,IAAI,CAACW,SAAS;IAE7B,IAAI,CAAC3C,QAAQ,CAACwB,MAAM,CAAC,YAAW;MAC/B2I,IAAI,CAACt6D,IAAI,CAAC,CAAC,CAAC;MACZu6D,IAAI,CAACv6D,IAAI,CAAC,CAAC,CAAC;MACZgxD,IAAI,CAAChxD,IAAI,CAAC,CAAC,CAAC;MACZ05D,IAAI,CAAC15D,IAAI,CAAC,CAAC,CAAC;MACZixD,MAAM,CAACkB,QAAQ,CAACA,QAAQ,CAAC,CAAC9rC,IAAI,CAAC2rC,IAAI,CAAC;IACrC,CAAC,CAAC;IACF,IAAI,CAAC72D,aAAa,CAAC,CAAC,EAAE,IAAI,CAACg1D,QAAQ,CAAC;EACrC,CAAC;EAED4J,qBAAqB,CAAC1I,YAAY,GACjC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CACzB,yBAAyB,EACzB0iE,qBAAqB,CACrB;;EAED;EACA,SAASS,kBAAkB,GAAG;IAC7B,IAAI,CAACpvD,SAAS,CAAC,SAAS,EAAE,SAAS,CAAC;IAEpC,IAAI,CAACqvD,UAAU,GAAG1H,IAAI,CAAChQ,MAAM,EAAE;IAC/B,IAAI,CAAC1oD,UAAU,GAAG;MACjBmU,KAAK,EAAEukD,IAAI,CAAChQ,MAAM,EAAE;MACpBrnB,SAAS,EAAEgwB,aAAa,CAACS;IAC1B,CAAC;EACF;EAEAqO,kBAAkB,CAAC3qE,KAAK,GAAG,OAAO;EAClC2qE,kBAAkB,CAACz/D,IAAI,GACtB,+CAA+C;EAEhDy/D,kBAAkB,CAACzmD,YAAY,GAAG;IACjC2nB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDoO,kBAAkB,CAAC7qE,SAAS,CAAC2wB,gBAAgB,GAAG,UAAS5D,GAAG,EAAE;IAC7D,IAAI9U,CAAC,GAAG,IAAI,CAACvN,UAAU,CAACmU,KAAK;IAC7BkO,GAAG,CAAC0V,SAAS,GACZ,MAAM,GACNtgB,IAAI,CAACC,KAAK,CAACD,IAAI,CAAC+pB,KAAK,CAACj0B,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,GACxC,GAAG,GACHkK,IAAI,CAACC,KAAK,CAACD,IAAI,CAAC+pB,KAAK,CAACj0B,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,GACxC,GAAG,GACHkK,IAAI,CAACC,KAAK,CAACD,IAAI,CAAC+pB,KAAK,CAACj0B,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,GACxC,GAAG;IACJ,IAAI,IAAI,CAAChM,KAAK,CAAC2Y,SAAS,EAAE;MACzB,IAAI,CAAC9E,QAAQ,GAAGiN,GAAG,CAAC0V,SAAS;IAC9B,CAAC,MAAM;MACN1V,GAAG,CAACoY,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAACj5B,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,IAAI,CAAC,CAAC,CAAC,CAAC;IAC/C;EACD,CAAC;EAED2+D,kBAAkB,CAAC7qE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACnD,IAAI1D,IAAI,GACP,IAAI,CAAC+C,UAAU,CAACqhC,SAAS,IAAIgwB,aAAa,CAACO,IAAI,GAC5CP,aAAa,CAAC0B,qBAAqB,GACnCznC,EAAE,CAACwnC,aAAa;IAEpB,IAAI,CAAC,IAAI,CAAC4D,IAAI,IAAI,IAAI,CAACA,IAAI,CAACz5D,IAAI,IAAIA,IAAI,EAAE;MACzC,IAAI,CAACy5D,IAAI,GAAG,IAAItrC,EAAE,CAACqnC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE;QAChCO,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QACfv2D,IAAI,EAAEA,IAAI;QACV83D,SAAS,EAAEzpC,EAAE,CAACqoC;MACf,CAAC,CAAC;IACH;IACA,IAAIx/C,KAAK,GAAG,IAAI,CAACnU,UAAU,CAACmU,KAAK;IAEjC,IAAI,IAAI,CAAChM,MAAM,EAAE;MAChB,KAAK,IAAIjT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACiT,MAAM,CAAC3T,MAAM,EAAEU,CAAC,EAAE,EAAE;QAC5C,IAAIiX,KAAK,GAAG,IAAI,CAAChE,MAAM,CAACjT,CAAC,CAAC;QAC1B,IAAIgJ,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC1L,CAAC,CAAC;QAC5B,IAAIgJ,CAAC,KAAKmP,SAAS,EAAE;UACpB;QACD;QACA,QAAQlB,KAAK,CAAC3V,IAAI;UACjB,KAAK,KAAK;UACV,KAAK,MAAM;YACV2d,KAAK,CAAClW,GAAG,CAACC,CAAC,CAAC;YACZ;UACD,KAAK,GAAG;YACPiW,KAAK,CAAC,CAAC,CAAC,GAAGjW,CAAC;YACZ;UACD,KAAK,GAAG;YACPiW,KAAK,CAAC,CAAC,CAAC,GAAGjW,CAAC;YACZ;UACD,KAAK,GAAG;YACPiW,KAAK,CAAC,CAAC,CAAC,GAAGjW,CAAC;YACZ;UACD,KAAK,GAAG;YACPiW,KAAK,CAAC,CAAC,CAAC,GAAGjW,CAAC;YACZ;QAAM;MAET;IACD;IAEA,IAAIw6D,IAAI,CAAC2H,OAAO,CAAC,IAAI,CAACD,UAAU,EAAEjsD,KAAK,CAAC,GAAG,KAAK,EAAE;MACjD,IAAI,CAACisD,UAAU,CAACniE,GAAG,CAACkW,KAAK,CAAC;MAC1B,IAAI,CAACuiD,IAAI,CAACj/B,IAAI,CAACtjB,KAAK,CAAC;IACtB;IACA,IAAI,CAACrT,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC41D,IAAI,CAAC;EACjC,CAAC;EAEDyJ,kBAAkB,CAAC7qE,SAAS,CAACovC,WAAW,GAAG,YAAW;IACrD,OAAO,CACN,CAAC,KAAK,EAAE,MAAM,CAAC,EACf,CAAC,MAAM,EAAE,MAAM,CAAC,EAChB,CAAC,GAAG,EAAE,QAAQ,CAAC,EACf,CAAC,GAAG,EAAE,QAAQ,CAAC,EACf,CAAC,GAAG,EAAE,QAAQ,CAAC,EACf,CAAC,GAAG,EAAE,QAAQ,CAAC,CACf;EACF,CAAC;EAED3tC,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAEmjE,kBAAkB,CAAC;;EAE/D;EACA,SAASG,qBAAqB,GAAG;IAChC,IAAI,CAACnwD,QAAQ,CAAC,GAAG,EAAE,OAAO,CAAC;IAC3B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,OAAO,CAAC;IAC3B,IAAI,CAACY,SAAS,CAAC,SAAS,EAAE,SAAS,CAAC;IAEpC,IAAI,CAAC/Q,UAAU,GAAG;MACjB0/C,KAAK,EAAE,CAAC;MACRnhC,KAAK,EAAE,CAAC;MACR9S,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MACZC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MACZ60D,YAAY,EAAE;IACf,CAAC;IACD,IAAI,CAACD,qBAAqB,CAACzJ,OAAO,EAAE;MACnCyJ,qBAAqB,CAACzJ,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAC5CA,MAAM,CAACC,oBAAoB,EAC3BkJ,qBAAqB,CAACtJ,YAAY,CAClC;IACF;IAEA,IAAI,CAACyB,SAAS,GAAG;MAChB+H,OAAO,EAAE,CAAC;MACVC,QAAQ,EAAEtX,IAAI,CAACT,MAAM,EAAE;MACvBgY,QAAQ,EAAEvX,IAAI,CAACT,MAAM;IACtB,CAAC;EACF;EAEA4X,qBAAqB,CAAC9qE,KAAK,GAAG,UAAU;EACxC8qE,qBAAqB,CAAC5/D,IAAI,GAAG,sBAAsB;EACnD4/D,qBAAqB,CAAC,IAAI,CAAC,GAAG;IAAErjE,IAAI,EAAE;EAAQ,CAAC;EAC/CqjE,qBAAqB,CAAC,IAAI,CAAC,GAAG;IAAErjE,IAAI,EAAE;EAAQ,CAAC;EAC/CqjE,qBAAqB,CAAC,eAAe,CAAC,GAAG;IACxCrjE,IAAI,EAAE,MAAM;IACZ6c,MAAM,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG;EAC/B,CAAC;EAEDwmD,qBAAqB,CAAChrE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACtD2qB,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IACpBpsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IAEzB,IAAIG,IAAI,GAAGvsC,EAAE,CAACwsC,IAAI,CAACC,aAAa,EAAE;IAClC,IAAIjB,MAAM,GAAG0J,qBAAqB,CAACzJ,OAAO;IAE1C,IAAIprD,CAAC,GAAG,IAAI,CAAC7K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI,CAAC6K,CAAC,EAAE;MACPA,CAAC,GAAG,IAAI,CAACzL,UAAU,CAACyL,CAAC;IACtB;IACA,IAAIC,CAAC,GAAG,IAAI,CAAC9K,YAAY,CAAC,CAAC,CAAC;IAC5B,IAAI,CAAC8K,CAAC,EAAE;MACPA,CAAC,GAAG,IAAI,CAAC1L,UAAU,CAAC0L,CAAC;IACtB;;IAEA;IACA,KAAK,IAAIxW,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACiT,MAAM,CAAC3T,MAAM,EAAEU,CAAC,EAAE,EAAE;MAC5C,IAAIiX,KAAK,GAAG,IAAI,CAAChE,MAAM,CAACjT,CAAC,CAAC;MAC1B,IAAIgJ,CAAC,GAAG,IAAI,CAAC0C,YAAY,CAAC1L,CAAC,CAAC;MAC5B,IAAIgJ,CAAC,KAAKmP,SAAS,EAAE;QACpB;MACD;MACA,IAAI,CAACrN,UAAU,CAACmM,KAAK,CAAC3V,IAAI,CAAC,GAAG0H,CAAC;IAChC;IAEA,IAAI45D,QAAQ,GAAG,IAAI,CAACW,SAAS;IAC7B,IAAI,CAACA,SAAS,CAAC+H,OAAO,GAAG,IAAI,CAACxgE,UAAU,CAAC0/C,KAAK,GAAG0J,OAAO;IACxD,IAAI,CAACqP,SAAS,CAACY,OAAO,GAAG,IAAI,CAACr5D,UAAU,CAACue,KAAK;IAC9C4qC,IAAI,CAAC6I,IAAI,CAAC8F,QAAQ,CAAC2I,QAAQ,EAAEh1D,CAAC,CAAC;IAC/B09C,IAAI,CAAC6I,IAAI,CAAC8F,QAAQ,CAAC4I,QAAQ,EAAEh1D,CAAC,CAAC;IAE/B,IAAIlK,IAAI,GAAGsyC,QAAQ,CAAC,IAAI,CAAC9zC,UAAU,CAACugE,YAAY,CAAC;IACjD,IAAI,CAAC,IAAI,CAAC7J,IAAI,IAAI,IAAI,CAACA,IAAI,CAACp2C,KAAK,IAAI9e,IAAI,EAAE;MAC1C,IAAI,CAACk1D,IAAI,GAAG,IAAItrC,EAAE,CAACqnC,OAAO,CAACjxD,IAAI,EAAEA,IAAI,EAAE;QACtCwxD,MAAM,EAAE1nC,EAAE,CAACi0C,GAAG;QACdz9D,MAAM,EAAEwpB,EAAE,CAAC2nC;MACZ,CAAC,CAAC;IACH;IAEA,IAAI,CAACyD,IAAI,CAACY,MAAM,CAAC,YAAW;MAC3BV,MAAM,CAACkB,QAAQ,CAACA,QAAQ,CAAC,CAAC9rC,IAAI,CAAC2rC,IAAI,CAAC;IACrC,CAAC,CAAC;IACF,IAAI,CAAC72D,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC41D,IAAI,CAAC;EACjC,CAAC;EAED4J,qBAAqB,CAAChrE,SAAS,CAACovC,WAAW,GAAG,YAAW;IACxD,OAAO,CAAC,CAAC,OAAO,EAAE,QAAQ,CAAC,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;EAClD,CAAC;EAED47B,qBAAqB,CAACtJ,YAAY,GACjC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CAAC,kBAAkB,EAAEsjE,qBAAqB,CAAC;;EAErE;EACA,SAASK,gBAAgB,GAAG;IAC3B,IAAI,CAACxwD,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACA,QAAQ,CAAC,GAAG,EAAE,SAAS,CAAC;IAC7B,IAAI,CAACA,QAAQ,CAAC,OAAO,EAAE,SAAS,CAAC;IAEjC,IAAI,CAACY,SAAS,CAAC,SAAS,EAAE,SAAS,CAAC;IACpC,IAAI,CAAC/Q,UAAU,GAAG;MAAEmmD,MAAM,EAAE,GAAG;MAAEya,iBAAiB,EAAE,IAAI;MAAEjC,MAAM,EAAE,KAAK;MAAEt9B,SAAS,EAAEgwB,aAAa,CAACS;IAAQ,CAAC;IAC3G,IAAI,CAAC2G,SAAS,GAAG;MAChBsH,UAAU,EAAE,CAAC;MACb/H,UAAU,EAAE,CAAC;MACb6I,YAAY,EAAE,CAAC;MACfC,KAAK,EAAEpI,IAAI,CAAChQ,MAAM;IACnB,CAAC;EACF;EAEAiY,gBAAgB,CAACnrE,KAAK,GAAG,KAAK;EAC9BmrE,gBAAgB,CAACjgE,IAAI,GAAG,yCAAyC;EAEjEigE,gBAAgB,CAACjnD,YAAY,GAAG;IAC/B2nB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAED4O,gBAAgB,CAACrrE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACjD,IAAI0+D,IAAI,GAAG,IAAI,CAACz+D,YAAY,CAAC,CAAC,CAAC;IAE/B,IAAI,CAAC,IAAI,CAAC8V,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF,IAAI,IAAI,CAAC1W,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACI,YAAY,EAAE;MAC7D,IAAI,CAAC3wD,aAAa,CAAC,CAAC,EAAEu+D,IAAI,CAAC;MAC3B;IACD;IAEA,IAAI1I,IAAI,GAAG,IAAI,CAAC/1D,YAAY,CAAC,CAAC,CAAC;IAC/B,IAAI,CAACy+D,IAAI,IAAI,CAAC1I,IAAI,EAAE;MACnB;IACD;IAEA,IAAIoK,MAAM,GAAG,IAAI,CAACngE,YAAY,CAAC,CAAC,CAAC;IAEjC,IAAIulD,MAAM,GAAG,IAAI,CAACvlD,YAAY,CAAC,CAAC,CAAC;IAEjC,IAAI,CAAC81D,IAAI,GAAGrF,aAAa,CAACuB,gBAAgB,CACzC,IAAI,CAAC5yD,UAAU,CAAC4gE,iBAAiB,IAAIjK,IAAI,CAACr2C,KAAK,GAAG++C,IAAI,CAAC/+C,KAAK,GAAGq2C,IAAI,GAAG0I,IAAI,EAC1E,IAAI,CAAC3I,IAAI,EACT,IAAI,CAAC12D,UAAU,CAACqhC,SAAS,CACzB;IAED/V,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IACpBpsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IAEzB,IAAIG,IAAI,GAAGC,IAAI,CAACC,aAAa,EAAE;IAC/B,IAAIjB,MAAM,GAAG,IAAI;IACjB,IAAIkB,QAAQ,GAAG,IAAI,CAACW,SAAS;IAC7B,IAAIsI,MAAM,EAAE;MACXnK,MAAM,GAAG+J,gBAAgB,CAACK,WAAW;MACrC,IAAI,CAACpK,MAAM,EAAE;QACZA,MAAM,GAAG+J,gBAAgB,CAACK,WAAW,GAAG,IAAI51C,EAAE,CAAC+rC,MAAM,CACpDA,MAAM,CAACC,oBAAoB,EAC3BuJ,gBAAgB,CAAC3J,YAAY,EAC7B;UAAEiK,OAAO,EAAE;QAAG,CAAC,CACf;MACF;IACD,CAAC,MAAM;MACNrK,MAAM,GAAG+J,gBAAgB,CAACO,cAAc;MACxC,IAAI,CAACtK,MAAM,EAAE;QACZA,MAAM,GAAG+J,gBAAgB,CAACO,cAAc,GAAG,IAAI91C,EAAE,CAAC+rC,MAAM,CACvDA,MAAM,CAACC,oBAAoB,EAC3BuJ,gBAAgB,CAAC3J,YAAY,CAC7B;MACF;MACA,IAAIz4B,CAAC,GAAG4nB,MAAM,IAAI,IAAI,GAAG,IAAI,CAACnmD,UAAU,CAACmmD,MAAM,GAAGA,MAAM;MACxD2R,QAAQ,CAACgJ,KAAK,CAAC7iE,GAAG,CAAC,CAACsgC,CAAC,EAAEA,CAAC,EAAEA,CAAC,EAAEA,CAAC,CAAC,CAAC;IACjC;IAEA,IAAIogC,MAAM,GAAG,IAAI,CAAC3+D,UAAU,CAAC2+D,MAAM;IAEnC,IAAI,CAACjI,IAAI,CAACY,MAAM,CAAC,YAAW;MAC3B+H,IAAI,CAAC15D,IAAI,CAAEg5D,MAAM,GAAG,CAAC,GAAG,CAAC,CAAE;MAC3BhI,IAAI,CAAChxD,IAAI,CAAEg5D,MAAM,GAAG,CAAC,GAAG,CAAC,CAAE;MAC3B,IAAIoC,MAAM,EAAE;QACXA,MAAM,CAACp7D,IAAI,CAAC,CAAC,CAAC;MACf;MACAixD,MAAM,CAACkB,QAAQ,CAACA,QAAQ,CAAC,CAAC9rC,IAAI,CAAC2rC,IAAI,CAAC;IACrC,CAAC,CAAC;IAEF,IAAI,CAAC72D,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC41D,IAAI,CAAC;EACjC,CAAC;EAEDiK,gBAAgB,CAACrrE,SAAS,CAACovC,WAAW,GAAG,YAAW;IACnD,OAAO,CAAC,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;EAC9B,CAAC;EAEDi8B,gBAAgB,CAAC3J,YAAY,GAC5B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CAAC,aAAa,EAAE2jE,gBAAgB,CAAC;;EAE3D;EACA,SAASQ,kBAAkB,GAAG;IAC7B,IAAI,CAAChxD,QAAQ,CAAC,MAAM,EAAE,SAAS,CAAC;IAEhC,IAAI,CAACY,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC;IAClC,IAAI,CAAC/Q,UAAU,GAAG;MACjB2+D,MAAM,EAAE,IAAI;MACZvd,SAAS,EAAE,KAAK;MAChB+E,MAAM,EAAE,CAAC;MACT9kB,SAAS,EAAEgwB,aAAa,CAACS;IAC1B,CAAC;IAED,IAAI,CAACqP,kBAAkB,CAACtK,OAAO,EAAE;MAChCsK,kBAAkB,CAACtK,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CACzCA,MAAM,CAACC,oBAAoB,EAC3B+J,kBAAkB,CAACnK,YAAY,CAC/B;IACF;EACD;EAEAmK,kBAAkB,CAAC3rE,KAAK,GAAG,OAAO;EAClC2rE,kBAAkB,CAACzgE,IAAI,GAAG,eAAe;EAEzCygE,kBAAkB,CAACznD,YAAY,GAAG;IACjC2nB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDoP,kBAAkB,CAAC7rE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACnD,IAAI,CAAC,IAAI,CAAC+V,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF,IAAI87C,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAE9B,IAAI,IAAI,CAACZ,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACI,YAAY,EAAE;MAC7D,IAAI,CAAC3wD,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEA,IAAI,CAACA,GAAG,EAAE;MACT;IACD;IAEA,IAAI,CAACkE,IAAI,GAAGrF,aAAa,CAACuB,gBAAgB,CACzCJ,GAAG,EACH,IAAI,CAACkE,IAAI,EACT,IAAI,CAAC12D,UAAU,CAACqhC,SAAS,CACzB;IAED/V,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IACpBpsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IAEzB,IAAIG,IAAI,GAAGC,IAAI,CAACC,aAAa,EAAE;IAC/B,IAAIjB,MAAM,GAAGuK,kBAAkB,CAACtK,OAAO;IACvC,IAAI8H,MAAM,GAAG,IAAI,CAAC3+D,UAAU,CAAC2+D,MAAM;IACnC,IAAIxY,MAAM,GAAG,IAAI,CAACnmD,UAAU,CAACmmD,MAAM;IACnC,IAAI/E,SAAS,GAAG,IAAI,CAACphD,UAAU,CAACohD,SAAS,GAAG,CAAC,GAAG,CAAC;IAEjD,IAAI,CAACsV,IAAI,CAACY,MAAM,CAAC,YAAW;MAC3B9E,GAAG,CAAC7sD,IAAI,CAAC,CAAC,CAAC;MACXixD,MAAM,CACJkB,QAAQ,CAAC;QACTC,SAAS,EAAE,CAAC;QACZqJ,OAAO,EAAE,CAAC,CAAC,GAAG5O,GAAG,CAAClyC,KAAK,EAAE,CAAC,GAAGkyC,GAAG,CAACjyC,MAAM,CAAC;QACxCi5C,QAAQ,EAAErT,MAAM;QAChBkb,WAAW,EAAEjgB,SAAS;QACtB8d,QAAQ,EAAEP,MAAM,GAAG,CAAC,GAAG;MACxB,CAAC,CAAC,CACD3yC,IAAI,CAAC2rC,IAAI,CAAC;IACb,CAAC,CAAC;IAEF,IAAI,CAAC72D,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC41D,IAAI,CAAC;EACjC,CAAC;EAEDyK,kBAAkB,CAACnK,YAAY,GAC9B;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CAAC,eAAe,EAAEmkE,kBAAkB,CAAC;;EAE/D;EACA,SAASG,uBAAuB,GAAG;IAClC,IAAI,CAACnxD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACA,QAAQ,CAAC,UAAU,EAAE,QAAQ,CAAC;IACnC,IAAI,CAACA,QAAQ,CAAC,OAAO,EAAE,QAAQ,CAAC;IAChC,IAAI,CAACY,SAAS,CAAC,SAAS,EAAE,SAAS,CAAC;IACpC,IAAI,CAAC/Q,UAAU,GAAG;MACjBgvB,QAAQ,EAAE,GAAG;MACbkS,KAAK,EAAE,EAAE;MACTqgC,UAAU,EAAE,KAAK;MACjBC,cAAc,EAAE;IACjB,CAAC;IACD,IAAI,CAAC/I,SAAS,GAAG;MAChBV,SAAS,EAAE,CAAC;MACZ0J,UAAU,EAAE,GAAG;MACfC,OAAO,EAAE,EAAE;MACXC,eAAe,EAAE;IAClB,CAAC;EACF;EAEAL,uBAAuB,CAAC9rE,KAAK,GAAG,aAAa;EAC7C8rE,uBAAuB,CAAC5gE,IAAI,GAAG,wCAAwC;EAEvE4gE,uBAAuB,CAAChsE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACxD,IAAI,CAAC,IAAI,CAAC+V,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF,IAAI87C,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,EAAE;MACT;IACD;IAEA,IAAInxB,SAAS,GAAG/V,EAAE,CAACwnC,aAAa;IAChC,IAAI,IAAI,CAAC9yD,UAAU,CAACwhE,cAAc,EAAE;MACnCngC,SAAS,GAAG/V,EAAE,CAACs2C,cAAc,GAAGt2C,EAAE,CAACixC,cAAc,GAAGjxC,EAAE,CAAC2wC,KAAK;IAC7D;IAEA,IACC,CAAC,IAAI,CAACjB,aAAa,IACnB,IAAI,CAACA,aAAa,CAAC/9D,IAAI,IAAIokC,SAAS,IACpC,IAAI,CAAC25B,aAAa,CAAC16C,KAAK,IAAIkyC,GAAG,CAAClyC,KAAK,IACrC,IAAI,CAAC06C,aAAa,CAACz6C,MAAM,IAAIiyC,GAAG,CAACjyC,MAAM,EACtC;MACD,IAAI,CAACy6C,aAAa,GAAG,IAAI5vC,EAAE,CAACqnC,OAAO,CAACD,GAAG,CAAClyC,KAAK,EAAEkyC,GAAG,CAACjyC,MAAM,EAAE;QAC1DtjB,IAAI,EAAEokC,SAAS;QACf2xB,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QACf1xD,MAAM,EAAEwpB,EAAE,CAAC2nC;MACZ,CAAC,CAAC;IACH;IAEA,IAAI6E,QAAQ,GAAG,IAAI,CAACW,SAAS;;IAE7B;IACA,IAAIzpC,QAAQ,GAAG,IAAI,CAAChvB,UAAU,CAACgvB,QAAQ;IACvC,IAAI,IAAI,CAAC7Y,gBAAgB,CAAC,CAAC,CAAC,EAAE;MAC7B6Y,QAAQ,GAAG,IAAI,CAACpuB,YAAY,CAAC,CAAC,CAAC;MAC/B,IAAI,CAACZ,UAAU,CAACgvB,QAAQ,GAAGA,QAAQ;IACpC;IAEA,IAAIkS,KAAK,GAAG,IAAI,CAAClhC,UAAU,CAACkhC,KAAK;IACjC,IAAI,IAAI,CAAC/qB,gBAAgB,CAAC,CAAC,CAAC,EAAE;MAC7B+qB,KAAK,GAAG,IAAI,CAACtgC,YAAY,CAAC,CAAC,CAAC;MAC5B,IAAI,CAACZ,UAAU,CAACkhC,KAAK,GAAGA,KAAK;IAC9B;IAEA42B,QAAQ,CAAC2J,UAAU,GAAGzyC,QAAQ;IAC9B8oC,QAAQ,CAAC4J,OAAO,GAAGxgC,KAAK;IAExB5V,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IACpBpsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IACzB,IAAIG,IAAI,GAAGC,IAAI,CAACC,aAAa,EAAE;IAC/B,IAAI,CAACyJ,uBAAuB,CAACzK,OAAO,EAAE;MACrCyK,uBAAuB,CAACzK,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAC9CA,MAAM,CAACC,oBAAoB,EAC3BkK,uBAAuB,CAACtK,YAAY,CACpC;MACDsK,uBAAuB,CAACO,iBAAiB,GAAG,IAAIz2C,EAAE,CAAC+rC,MAAM,CACxDA,MAAM,CAACC,oBAAoB,EAC3BkK,uBAAuB,CAACtK,YAAY,EACpC;QAAE8K,UAAU,EAAE;MAAG,CAAC,CAClB;IACF;IACA,IAAIlL,MAAM,GAAG,IAAI,CAAC52D,UAAU,CAACuhE,UAAU,GACpCD,uBAAuB,CAACO,iBAAiB,GACzCP,uBAAuB,CAACzK,OAAO;;IAElC;IACA,IAAIkL,MAAM,GAAG,IAAI;IACjB,IAAIvP,GAAG,CAACwP,eAAe,EAAE;MACxBD,MAAM,GAAGvP,GAAG,CAACwP,eAAe;IAC7B,CAAC,MAAM,IAAI/4D,MAAM,CAACg5D,EAAE,IAAIA,EAAE,CAACC,QAAQ,CAACC,YAAY,EAAE;MACjDJ,MAAM,GAAGE,EAAE,CAACC,QAAQ,CAACC,YAAY,CAAC1J,SAAS,CAACkJ,eAAe;IAC5D,CAAC,MAAM;MACNI,MAAM,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC;IACrB,CAAC,CAAC;IACFjK,QAAQ,CAAC6J,eAAe,GAAGI,MAAM;IAEjC,IAAI,CAAC/G,aAAa,CAAC1D,MAAM,CAAC,YAAW;MACpC9E,GAAG,CAAC7sD,IAAI,CAAC,CAAC,CAAC;MACXixD,MAAM,CAACkB,QAAQ,CAACA,QAAQ,CAAC,CAAC9rC,IAAI,CAAC2rC,IAAI,CAAC;IACrC,CAAC,CAAC;IAEF,IAAI,CAACqD,aAAa,CAACgH,eAAe,GAAGD,MAAM;IAC3C,IAAI,CAACjhE,aAAa,CAAC,CAAC,EAAE,IAAI,CAACk6D,aAAa,CAAC;EAC1C,CAAC;EAEDsG,uBAAuB,CAACtK,YAAY,GACnC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CAAE,qBAAqB,EAAEskE,uBAAuB,CAAE;;EAG5E;EACA,SAASc,wBAAwB,GAAG;IACnC,IAAI,CAACjyD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACY,SAAS,CAAC,SAAS,EAAE,SAAS,CAAC;IACpC,IAAI,CAAC/Q,UAAU,GAAG;MACjBqhC,SAAS,EAAEgwB,aAAa,CAACS,OAAO;MAChC6M,MAAM,EAAE;IACT,CAAC;IACD,IAAI,CAAClG,SAAS,GAAG;MAChBV,SAAS,EAAE,CAAC;MACZ4J,eAAe,EAAE,IAAI;MAAE;MACvBU,MAAM,EAAEvrB,IAAI,CAAC4R,MAAM;IACpB,CAAC;EACF;EAEA0Z,wBAAwB,CAAC1oD,YAAY,GAAG;IACvC2nB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDqQ,wBAAwB,CAAC5sE,KAAK,GAAG,cAAc;EAC/C4sE,wBAAwB,CAAC1hE,IAAI,GAAG,2CAA2C;EAE3E0hE,wBAAwB,CAAC9sE,SAAS,CAACqL,SAAS,GAAG,YAAW;IACzD,IAAI,CAAC,IAAI,CAAC+V,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF,IAAI87C,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,IAAKA,GAAG,CAACQ,MAAM,IAAI1nC,EAAE,CAACupC,eAAe,IAAIrC,GAAG,CAACQ,MAAM,IAAI1nC,EAAE,CAACg3C,aAAc,EAAG;MAClF;IACD;IAEA,IAAIjhC,SAAS,GAAG,IAAI,CAACrhC,UAAU,CAACqhC,SAAS,IAAIgwB,aAAa,CAACO,IAAI,GAAGtmC,EAAE,CAACynC,qBAAqB,GAAGznC,EAAE,CAACwnC,aAAa;IAE7G,IAAK,CAAC,IAAI,CAACkI,aAAa,IAAI,IAAI,CAACA,aAAa,CAAC/9D,IAAI,IAAIokC,SAAS,IAAI,IAAI,CAAC25B,aAAa,CAAC16C,KAAK,IAAIkyC,GAAG,CAAClyC,KAAK,IAAI,IAAI,CAAC06C,aAAa,CAACz6C,MAAM,IAAIiyC,GAAG,CAACjyC,MAAM,EAAG;MACtJ,IAAI,CAACy6C,aAAa,GAAG,IAAI5vC,EAAE,CAACqnC,OAAO,CAACD,GAAG,CAAClyC,KAAK,EAAEkyC,GAAG,CAACjyC,MAAM,EAAE;QAC1DtjB,IAAI,EAAEokC,SAAS;QACf2xB,MAAM,EAAE1nC,EAAE,CAACi0C,GAAG;QACdz9D,MAAM,EAAEwpB,EAAE,CAAC2nC;MACZ,CAAC,CAAC;IACH;IAEA,IAAI6E,QAAQ,GAAG,IAAI,CAACW,SAAS;IAC7BX,QAAQ,CAACoH,QAAQ,GAAG,IAAI,CAACl/D,UAAU,CAAC2+D,MAAM,GAAG,CAAC,GAAG,CAAC;IAElDrzC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IACpBpsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IACzB,IAAIG,IAAI,GAAGC,IAAI,CAACC,aAAa,EAAE;IAC/B,IAAG,CAACuK,wBAAwB,CAACvL,OAAO,EACnCuL,wBAAwB,CAACvL,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAAE/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAAEgL,wBAAwB,CAACpL,YAAY,CAAC;IACzH,IAAIJ,MAAM,GAAGwL,wBAAwB,CAACvL,OAAO;;IAE7C;IACA,IAAIkL,MAAM,GAAG,IAAI;IACjB,IAAIvP,GAAG,CAACwP,eAAe,EAAE;MACxBD,MAAM,GAAGvP,GAAG,CAACwP,eAAe;IAC7B,CAAC,MAAM,IAAI/4D,MAAM,CAACg5D,EAAE,IAAIA,EAAE,CAACC,QAAQ,CAACC,YAAY,EAAE;MACjDJ,MAAM,GAAGE,EAAE,CAACC,QAAQ,CAACC,YAAY,CAAC1J,SAAS,CAACkJ,eAAe;IAC5D,CAAC,MAAM;MACNI,MAAM,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC;IACrB,CAAC,CAAC;IACFjK,QAAQ,CAAC6J,eAAe,GAAGI,MAAM;IACjC;IACAjK,QAAQ,CAACuK,MAAM,CAACpkE,GAAG,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;IAE1B,IAAI,CAAC+8D,aAAa,CAAC1D,MAAM,CAAC,YAAW;MACpC9E,GAAG,CAAC7sD,IAAI,CAAC,CAAC,CAAC;MACXixD,MAAM,CAACkB,QAAQ,CAACA,QAAQ,CAAC,CAAC9rC,IAAI,CAAC2rC,IAAI,CAAC;IACrC,CAAC,CAAC;IAEF,IAAI,CAACqD,aAAa,CAACgH,eAAe,GAAGD,MAAM;IAC3C,IAAI,CAACjhE,aAAa,CAAC,CAAC,EAAE,IAAI,CAACk6D,aAAa,CAAC;EAC1C,CAAC;EAEDoH,wBAAwB,CAACpL,YAAY,GACpC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFjgE,SAAS,CAACiG,gBAAgB,CAAE,sBAAsB,EAAEolE,wBAAwB,CAAE;;EAE9E;EACA,SAASG,iBAAiB,GAAG;IAC5B,IAAI,CAACpyD,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACA,QAAQ,CAAC,YAAY,EAAE,QAAQ,CAAC;IACrC,IAAI,CAACA,QAAQ,CAAC,WAAW,EAAE,QAAQ,CAAC;IACpC,IAAI,CAACY,SAAS,CAAC,SAAS,EAAE,SAAS,CAAC;IACpC,IAAI,CAAC/Q,UAAU,GAAG;MACjB89D,SAAS,EAAE,CAAC;MACZvZ,UAAU,EAAE,CAAC;MACbie,eAAe,EAAE,KAAK;MACtBjkD,KAAK,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;MACb8iB,SAAS,EAAEgwB,aAAa,CAACS;IAC1B,CAAC;EACF;EAEAyQ,iBAAiB,CAAC/sE,KAAK,GAAG,MAAM;EAChC+sE,iBAAiB,CAAC7hE,IAAI,GAAG,gBAAgB;EAEzC6hE,iBAAiB,CAAC7oD,YAAY,GAAG;IAChC2nB,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDwQ,iBAAiB,CAACE,cAAc,GAAG,EAAE;EAErCF,iBAAiB,CAACjtE,SAAS,CAACqL,SAAS,GAAG,YAAW;IAClD,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,EAAE;MACT;IACD;IAEA,IAAI,CAAC,IAAI,CAAC97C,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF,IAAIof,IAAI,GAAG,IAAI,CAAC4sC,cAAc;IAE9B,IACC,CAAC5sC,IAAI,IACLA,IAAI,CAACxV,KAAK,IAAIkyC,GAAG,CAAClyC,KAAK,IACvBwV,IAAI,CAACvV,MAAM,IAAIiyC,GAAG,CAACjyC,MAAM,IACzBuV,IAAI,CAAC74B,IAAI,IAAIu1D,GAAG,CAACv1D,IAAI,EACpB;MACD;MACA;MACA64B,IAAI,GAAG,IAAI,CAAC4sC,cAAc,GAAG,IAAIt3C,EAAE,CAACqnC,OAAO,CAC1CD,GAAG,CAAClyC,KAAK,EACTkyC,GAAG,CAACjyC,MAAM,EACV;QAAEtjB,IAAI,EAAEu1D,GAAG,CAACv1D,IAAI;QAAE+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QAAE1xD,MAAM,EAAEwpB,EAAE,CAAC2nC;MAAO,CAAC,CACtD;IACF;;IAEA;IACA,IAAI1O,UAAU,GAAG,IAAI,CAACvkD,UAAU,CAACukD,UAAU;IAC3C,IAAI,IAAI,CAACpuC,gBAAgB,CAAC,CAAC,CAAC,EAAE;MAC7BouC,UAAU,GAAG,IAAI,CAAC3jD,YAAY,CAAC,CAAC,CAAC;MACjC,IAAI,CAACZ,UAAU,CAACukD,UAAU,GAAGA,UAAU;IACxC;IACAA,UAAU,GAAG9sC,IAAI,CAAC4jB,GAAG,CACpB5jB,IAAI,CAACC,KAAK,CAAC6sC,UAAU,CAAC,EACtBge,iBAAiB,CAACE,cAAc,CAChC;IACD,IAAIle,UAAU,IAAI,CAAC,EAAE;MACpB;MACA,IAAI,CAACzjD,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEA,IAAIsL,SAAS,GAAG,IAAI,CAAC99D,UAAU,CAAC89D,SAAS;IACzC,IAAI,IAAI,CAAC3nD,gBAAgB,CAAC,CAAC,CAAC,EAAE;MAC7B2nD,SAAS,GAAG,IAAI,CAACl9D,YAAY,CAAC,CAAC,CAAC;MAChC,IAAI,CAACZ,UAAU,CAAC89D,SAAS,GAAGA,SAAS;IACtC;;IAEA;IACA,IAAI6E,MAAM,GAAG5rE,SAAS,CAAC6rE,aAAa;IACpC,IAAI,CAACD,MAAM,IAAI15D,MAAM,CAACqiB,EAAE,KAAKje,SAAS,EAAE;MACvCs1D,MAAM,GAAGr3C,EAAE,CAAChd,MAAM,CAACiS,MAAM,GAAG+K,EAAE,CAAChd,MAAM,CAACgS,KAAK;IAC5C;IACA,IAAI,CAACqiD,MAAM,EAAE;MACZA,MAAM,GAAG,CAAC;IACX;IACAA,MAAM,GAAG,IAAI,CAAC3iE,UAAU,CAACwiE,eAAe,GAAGG,MAAM,GAAG,CAAC;IAErD,IAAIpkD,KAAK,GAAG,IAAI,CAACve,UAAU,CAACue,KAAK,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;IAC3Ci0C,GAAG,CAACqQ,SAAS,CAACF,MAAM,GAAGpkD,KAAK,CAAC,CAAC,CAAC,EAAEA,KAAK,CAAC,CAAC,CAAC,EAAEu/C,SAAS,EAAEhoC,IAAI,CAAC;IAC3D,KAAK,IAAI5gC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGqvD,UAAU,EAAE,EAAErvD,CAAC,EAAE;MACpC4gC,IAAI,CAAC+sC,SAAS,CACbF,MAAM,GAAGpkD,KAAK,CAAC,CAAC,CAAC,IAAIrpB,CAAC,GAAG,CAAC,CAAC,EAC3BqpB,KAAK,CAAC,CAAC,CAAC,IAAIrpB,CAAC,GAAG,CAAC,CAAC,EAClB4oE,SAAS,CACT;IACF;IAEA,IAAI,CAACh9D,aAAa,CAAC,CAAC,EAAEg1B,IAAI,CAAC;EAC5B,CAAC;;EAED;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEC/+B,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAEulE,iBAAiB,CAAC;;EAE7D;EACA;EACA,SAASO,MAAM,GACf;IACC,IAAI,CAAChF,SAAS,GAAG,GAAG;IACpB,IAAI,CAACjZ,WAAW,GAAG,GAAG;IACtB,IAAI,CAACN,UAAU,GAAG,CAAC;IACnB,IAAI,CAACnD,SAAS,GAAG,GAAG;IACpB,IAAI,CAAC7iC,KAAK,GAAG,CAAC;IAEd,IAAI,CAACwkD,YAAY,GAAG,IAAI;IACxB,IAAI,CAACC,WAAW,GAAG,GAAG;IAEtB,IAAI,CAACC,SAAS,GAAG,EAAE;IACnB,IAAI,CAACxK,SAAS,GAAG;MAChByK,WAAW,EAAE,CAAC;MACdnL,SAAS,EAAE,CAAC;MACZoL,cAAc,EAAE,CAAC;MACjB9B,WAAW,EAAE,CAAC;MACd+B,YAAY,EAAEtsB,IAAI,CAAC4R,MAAM;IAC1B,CAAC;EACF;EAEAoa,MAAM,CAACxtE,SAAS,CAAC+tE,OAAO,GAAG,UAAU7Q,GAAG,EAAE8Q,cAAc,EAAEC,YAAY,EAAEC,eAAe,EAAG;IAEzF,IAAIljD,KAAK,GAAGkyC,GAAG,CAAClyC,KAAK;IACrB,IAAIC,MAAM,GAAGiyC,GAAG,CAACjyC,MAAM;IAEvB,IAAIkjD,YAAY,GAAG;MAClBzQ,MAAM,EAAER,GAAG,CAACQ,MAAM;MAClB/1D,IAAI,EAAEu1D,GAAG,CAACv1D,IAAI;MACd83D,SAAS,EAAE3pC,EAAE,CAAC6nC,MAAM;MACpBiI,SAAS,EAAE9vC,EAAE,CAAC6nC,MAAM;MACpBQ,IAAI,EAAEnoC,EAAE,CAAC4yC;IACV,CAAC;IAED,IAAIpG,QAAQ,GAAG,IAAI,CAACW,SAAS;IAC7B,IAAInG,QAAQ,GAAG,IAAI,CAAC2Q,SAAS;;IAE7B;IACA,IAAIrM,MAAM,GAAGkM,MAAM,CAACY,WAAW;IAC/B,IAAI,CAAC9M,MAAM,EAAE;MACZA,MAAM,GAAGkM,MAAM,CAACY,WAAW,GAAG,IAAIt4C,EAAE,CAAC+rC,MAAM,CAC1C/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAC9B0L,MAAM,CAACa,gBAAgB,CACvB;IACF;IAEAr4C,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACksC,UAAU,CAAC;IACzBlsC,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;IAEpBI,QAAQ,CAACuJ,WAAW,GAAG,IAAI,CAACjgB,SAAS;IACrC,IAAIwiB,kBAAkB,GAAItR,QAAQ,CAAC,CAAC,CAAC,GAAGlnC,EAAE,CAACqnC,OAAO,CAAC6I,YAAY,CAC9Dh7C,KAAK,EACLC,MAAM,EACNkjD,YAAY,CACX;IACFjR,GAAG,CAACqR,IAAI,CAAED,kBAAkB,EAAEhN,MAAM,CAACkB,QAAQ,CAACA,QAAQ,CAAC,CAAE;IACzD,IAAIgM,aAAa,GAAGF,kBAAkB;IAEtC,IAAIrf,UAAU,GAAG,IAAI,CAACA,UAAU;IAChCA,UAAU,GAAG9sC,IAAI,CAAC+pB,KAAK,CAAC+iB,UAAU,EAAE,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC;IAC9C,IAAIwf,UAAU,GAAGjM,QAAQ,CAACsL,YAAY;IACtC,IAAItF,SAAS,GAAG,IAAI,CAACA,SAAS;IAE9BhG,QAAQ,CAACoL,WAAW,GAAG,CAAC;IACxBpL,QAAQ,CAACkM,OAAO,GAAG,IAAI,CAACzlD,KAAK,CAAC,CAAC;;IAE/B;IACA,IAAIq4C,MAAM,GAAGkM,MAAM,CAACjM,OAAO;IAC3B,IAAI,CAACD,MAAM,EAAE;MACZA,MAAM,GAAGkM,MAAM,CAACjM,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CACtC/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAC9B0L,MAAM,CAACmB,kBAAkB,CACzB;IACF;IAEA,IAAI/uE,CAAC,GAAG,CAAC;IACT;IACA,OAAOA,CAAC,GAAGqvD,UAAU,EAAErvD,CAAC,EAAE,EAAE;MAC3BorB,KAAK,GAAGA,KAAK,IAAI,CAAC;MAClB,IAAI,CAACC,MAAM,GAAG,CAAC,IAAI,CAAC,EAAE;QACrBA,MAAM,GAAGA,MAAM,IAAI,CAAC;MACrB;MACA,IAAID,KAAK,GAAG,CAAC,EAAE;QACd;MACD;MACAsjD,kBAAkB,GAAGtR,QAAQ,CAACp9D,CAAC,CAAC,GAAGk2B,EAAE,CAACqnC,OAAO,CAAC6I,YAAY,CACzDh7C,KAAK,EACLC,MAAM,EACNkjD,YAAY,CACZ;MACDM,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,GAAGD,aAAa,CAACxjD,KAAK;MACvCyjD,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,GAAGD,aAAa,CAACvjD,MAAM;MACxCujD,aAAa,CAACD,IAAI,CACjBD,kBAAkB,EAClBhN,MAAM,CAACkB,QAAQ,CAACA,QAAQ,CAAC,CACzB;MACDgM,aAAa,GAAGF,kBAAkB;IACnC;;IAEA;IACA,IAAIJ,eAAe,EAAE;MACpBO,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,GAAGD,aAAa,CAACxjD,KAAK;MACvCyjD,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,GAAGD,aAAa,CAACvjD,MAAM;MACxCu3C,QAAQ,CAACoL,WAAW,GAAGpF,SAAS;MAChChG,QAAQ,CAACkM,OAAO,GAAG,CAAC;MACpBF,aAAa,CAACD,IAAI,CAACL,eAAe,EAAE5M,MAAM,CAACkB,QAAQ,CAACA,QAAQ,CAAC,CAAC;IAC/D;;IAEA;IACAxsC,EAAE,CAACyuC,MAAM,CAACzuC,EAAE,CAACosC,KAAK,CAAC;IACnBpsC,EAAE,CAAC0uC,SAAS,CAAC1uC,EAAE,CAAC4uC,GAAG,EAAE5uC,EAAE,CAAC4uC,GAAG,CAAC;IAC5BpC,QAAQ,CAACoL,WAAW,GAAG,IAAI,CAACre,WAAW;IACvCiT,QAAQ,CAACkM,OAAO,GAAG,GAAG;;IAEtB;IACA,KAAM9uE,CAAC,IAAI,CAAC,EAAEA,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EACzB;MACC0uE,kBAAkB,GAAGtR,QAAQ,CAACp9D,CAAC,CAAC;MAChCo9D,QAAQ,CAACp9D,CAAC,CAAC,GAAG,IAAI;MAClB6uE,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,GAAGD,aAAa,CAACxjD,KAAK;MACvCyjD,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,GAAGD,aAAa,CAACvjD,MAAM;MACxCujD,aAAa,CAACD,IAAI,CACjBD,kBAAkB,EAClBhN,MAAM,CAACkB,QAAQ,CAACA,QAAQ,CAAC,CACzB;MACD1sC,EAAE,CAACqnC,OAAO,CAAC4I,gBAAgB,CAACyI,aAAa,CAAC;MAC1CA,aAAa,GAAGF,kBAAkB;IACnC;IACAt4C,EAAE,CAACisC,OAAO,CAACjsC,EAAE,CAACosC,KAAK,CAAC;;IAEpB;IACA,IAAI6L,YAAY,EAAE;MACjBO,aAAa,CAACD,IAAI,CAACN,YAAY,CAAC;IACjC;;IAEA;IACA,IAAKD,cAAc,EAAG;MACrB,IAAIY,aAAa,GAAGZ,cAAc;MAClC,IAAIP,YAAY,GAAG,IAAI,CAACA,YAAY;MACpC,IAAIC,WAAW,GAAG,IAAI,CAACA,WAAW;MAClClL,QAAQ,CAACoL,WAAW,GAAGpF,SAAS;MAEhClH,MAAM,GAAGmM,YAAY,GAClBD,MAAM,CAACqB,kBAAkB,GACzBrB,MAAM,CAACsB,aAAa;MACvB,IAAI,CAACxN,MAAM,EAAE;QACZ,IAAImM,YAAY,EAAE;UACjBnM,MAAM,GAAGkM,MAAM,CAACqB,kBAAkB,GAAG,IAAI/4C,EAAE,CAAC+rC,MAAM,CACjD/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAC9B0L,MAAM,CAACuB,kBAAkB,EACzB;YAAEC,QAAQ,EAAE;UAAG,CAAC,CAChB;QACF,CAAC,MAAM;UACN1N,MAAM,GAAGkM,MAAM,CAACsB,aAAa,GAAG,IAAIh5C,EAAE,CAAC+rC,MAAM,CAC5C/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAC9B0L,MAAM,CAACuB,kBAAkB,CACzB;QACF;MACD;MAEAH,aAAa,CAAC5M,MAAM,CAAC,YAAW;QAC/B9E,GAAG,CAAC7sD,IAAI,CAAC,CAAC,CAAC;QACXm+D,aAAa,CAACn+D,IAAI,CAAC,CAAC,CAAC;QACrB,IAAIo9D,YAAY,EAAE;UACjBnM,MAAM,CAACuC,UAAU,CAAC,eAAe,EAAE6J,WAAW,CAAC;UAC/CpM,MAAM,CAACuC,UAAU,CAChB,gBAAgB,EAChB4J,YAAY,CAACp9D,IAAI,CAAC,CAAC,CAAC,CACpB;QACF;QACAixD,MAAM,CAACkE,UAAU,CAAChD,QAAQ,CAAC;MAC5B,CAAC,CAAC;IACH;IAEA1sC,EAAE,CAACqnC,OAAO,CAAC4I,gBAAgB,CAACyI,aAAa,CAAC;EAC3C,CAAC;EAEDhB,MAAM,CAACa,gBAAgB,GACtB;AACF;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFb,MAAM,CAACmB,kBAAkB,GACxB;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEFnB,MAAM,CAACuB,kBAAkB,GACxB;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;EAGF;EACA,SAASE,iBAAiB,GAAG;IAC5B,IAAI,CAACp0D,QAAQ,CAAC,IAAI,EAAE,SAAS,CAAC;IAC9B,IAAI,CAACA,QAAQ,CAAC,MAAM,EAAE,SAAS,CAAC;IAChC,IAAI,CAACY,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC;IAChC,IAAI,CAACA,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC;IACjC,IAAI,CAAC/Q,UAAU,GAAG;MACjB6f,OAAO,EAAE,IAAI;MACbi+C,SAAS,EAAE,CAAC;MACZjZ,WAAW,EAAE,IAAI;MACjBN,UAAU,EAAE,EAAE;MACdnD,SAAS,EAAE,CAAC;MACZ7iC,KAAK,EAAE,CAAC;MACRykD,WAAW,EAAE,GAAG;MAChB3hC,SAAS,EAAEgwB,aAAa,CAACS;IAC1B,CAAC;IAED,IAAI,CAAC0S,EAAE,GAAG,IAAI1B,MAAM,EAAE;EACvB;EAEAyB,iBAAiB,CAAC/uE,KAAK,GAAG,MAAM;EAChC+uE,iBAAiB,CAAC7jE,IAAI,GAAG,2CAA2C;EAEpE6jE,iBAAiB,CAAC7qD,YAAY,GAAG;IAChC6qC,UAAU,EAAE;MACXtnD,IAAI,EAAE,QAAQ;MACdo+B,GAAG,EAAE,CAAC;MACNziB,GAAG,EAAE,EAAE;MACP8oB,IAAI,EAAE,CAAC;MACPL,SAAS,EAAE;IACZ,CAAC;IACD+f,SAAS,EAAE;MACVnkD,IAAI,EAAE,QAAQ;MACdo+B,GAAG,EAAE,CAAC;MACNziB,GAAG,EAAE,EAAE;MACP8oB,IAAI,EAAE,IAAI;MACVL,SAAS,EAAE;IACZ,CAAC;IACDA,SAAS,EAAE;MAAEznB,MAAM,EAAE,OAAO;MAAEE,MAAM,EAAEu3C,aAAa,CAACU;IAAY;EACjE,CAAC;EAEDwS,iBAAiB,CAACjvE,SAAS,CAACovC,WAAW,GAAG,YAAW;IACpD,OAAO,CACN,CAAC,SAAS,EAAE,SAAS,CAAC,EACtB,CAAC,WAAW,EAAE,QAAQ,CAAC,EACvB,CAAC,WAAW,EAAE,QAAQ,CAAC,EACvB,CAAC,aAAa,EAAE,QAAQ,CAAC,EACzB,CAAC,YAAY,EAAE,QAAQ,CAAC,EACxB,CAAC,aAAa,EAAE,QAAQ,CAAC,CACzB;EACF,CAAC;EAED6/B,iBAAiB,CAACjvE,SAAS,CAAC2vC,YAAY,GAAG,YAAW;IACrD,OAAO,CAAC,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;EAChC,CAAC;EAEDs/B,iBAAiB,CAACjvE,SAAS,CAACqL,SAAS,GAAG,YAAW;IAClD,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,EAAE;MACT;IACD;IAEA,IAAI,CAAC,IAAI,CAAC77C,oBAAoB,EAAE,EAAE;MACjC;IACD,CAAC,CAAC;;IAEF,IACC,IAAI,CAAC3W,UAAU,CAACqhC,SAAS,KAAKgwB,aAAa,CAACI,YAAY,IACxD,IAAI,CAACl7C,kBAAkB,CAAC,SAAS,CAAC,KAAK,KAAK,EAC3C;MACD,IAAI,CAACzV,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEA,IAAIlyC,KAAK,GAAGkyC,GAAG,CAAClyC,KAAK;IACrB,IAAIC,MAAM,GAAGiyC,GAAG,CAACjyC,MAAM;IAEvB,IAAIikD,EAAE,GAAG,IAAI,CAACA,EAAE;IAChBA,EAAE,CAACpjB,SAAS,GAAG,IAAI,CAAC7qC,kBAAkB,CAAC,WAAW,CAAC;IACnDiuD,EAAE,CAACjgB,UAAU,GAAG,IAAI,CAAChuC,kBAAkB,CAAC,YAAY,CAAC;IACrDiuD,EAAE,CAAC1G,SAAS,GAAG,IAAI,CAACvnD,kBAAkB,CAAC,WAAW,CAAC;IACnDiuD,EAAE,CAAC3f,WAAW,GAAG,IAAI,CAACtuC,kBAAkB,CAAC,aAAa,CAAC;IACvDiuD,EAAE,CAACzB,YAAY,GAAG,IAAI,CAACniE,YAAY,CAAC,CAAC,CAAC;IACtC4jE,EAAE,CAACxB,WAAW,GAAG,IAAI,CAACzsD,kBAAkB,CAAC,aAAa,CAAC;IACvDiuD,EAAE,CAACjmD,KAAK,GAAG,IAAI,CAACve,UAAU,CAACue,KAAK;IAEhC,IAAIthB,IAAI,GAAGo0D,aAAa,CAAC6B,cAAc,CAAE,IAAI,CAAClzD,UAAU,CAACqhC,SAAS,EAAEmxB,GAAG,CAAE;IAEzE,IAAIgR,eAAe,GAAG,IAAI;IAC1B,IAAI,IAAI,CAAC9sD,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC9B8sD,eAAe,GAAG,IAAI,CAACiB,gBAAgB;MACvC,IACC,CAACjB,eAAe,IAChBA,eAAe,CAACvmE,IAAI,IAAIu1D,GAAG,CAACv1D,IAAI,IAChCumE,eAAe,CAACxQ,MAAM,IAAIR,GAAG,CAACQ,MAAM,EACnC;QACDwQ,eAAe,GAAG,IAAI,CAACiB,gBAAgB,GAAG,IAAIr5C,EAAE,CAACqnC,OAAO,CACvD,CAAC,EACD,CAAC,EACD;UACCx1D,IAAI,EAAEu1D,GAAG,CAACv1D,IAAI;UACd+1D,MAAM,EAAER,GAAG,CAACQ,MAAM;UAClBlxD,MAAM,EAAEwpB,EAAE,CAAC2nC;QACZ,CAAC,CACD;MACF;IACD;IAEA,IAAIsQ,YAAY,GAAG,IAAI;IACvB,IAAI,IAAI,CAAC7sD,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC9B6sD,YAAY,GAAG,IAAI,CAACmB,aAAa;MACjC,IACC,CAACnB,YAAY,IACbA,YAAY,CAACjjD,KAAK,IAAIkyC,GAAG,CAAClyC,KAAK,IAC/BijD,YAAY,CAAChjD,MAAM,IAAIiyC,GAAG,CAACjyC,MAAM,IACjCgjD,YAAY,CAACtmE,IAAI,IAAIA,IAAI,IACzBsmE,YAAY,CAACvQ,MAAM,IAAIR,GAAG,CAACQ,MAAM,EAChC;QACDuQ,YAAY,GAAG,IAAI,CAACmB,aAAa,GAAG,IAAIt5C,EAAE,CAACqnC,OAAO,CACjDD,GAAG,CAAClyC,KAAK,EACTkyC,GAAG,CAACjyC,MAAM,EACV;UAAEtjB,IAAI,EAAEA,IAAI;UAAE+1D,MAAM,EAAER,GAAG,CAACQ,MAAM;UAAElxD,MAAM,EAAEwpB,EAAE,CAAC2nC;QAAO,CAAC,CACrD;MACF;IACD;IAEA,IAAIiR,aAAa,GAAG,IAAI;IACxB,IAAI,IAAI,CAACxtD,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC9BwtD,aAAa,GAAG,IAAI,CAACxB,cAAc;MACnC,IACC,CAACwB,aAAa,IACdA,aAAa,CAAC5jD,KAAK,IAAIkyC,GAAG,CAAClyC,KAAK,IAChC4jD,aAAa,CAAC3jD,MAAM,IAAIiyC,GAAG,CAACjyC,MAAM,IAClC2jD,aAAa,CAACjnE,IAAI,IAAIA,IAAI,IAC1BinE,aAAa,CAAClR,MAAM,IAAIR,GAAG,CAACQ,MAAM,EACjC;QACDkR,aAAa,GAAG,IAAI,CAACxB,cAAc,GAAG,IAAIt3C,EAAE,CAACqnC,OAAO,CACnDD,GAAG,CAAClyC,KAAK,EACTkyC,GAAG,CAACjyC,MAAM,EACV;UAAEtjB,IAAI,EAAEA,IAAI;UAAE+1D,MAAM,EAAER,GAAG,CAACQ,MAAM;UAAElxD,MAAM,EAAEwpB,EAAE,CAAC2nC;QAAO,CAAC,CACrD;MACF;IAED;;IAEA;IACAuR,EAAE,CAACnB,OAAO,CAAC7Q,GAAG,EAAE0R,aAAa,EAAEX,YAAY,EAAEC,eAAe,CAAE;IAE9D,IAAI,IAAI,CAAC9sD,iBAAiB,CAAC,CAAC,CAAC,EAC5B,IAAI,CAAC5V,aAAa,CAAC,CAAC,EAAEojE,aAAa,CAAC;IAErC,IAAI,IAAI,CAACxtD,iBAAiB,CAAC,CAAC,CAAC,EAC5B,IAAI,CAAC5V,aAAa,CAAC,CAAC,EAAE0iE,eAAe,CAAC;IAEvC,IAAI,IAAI,CAAC9sD,iBAAiB,CAAC,CAAC,CAAC,EAC5B,IAAI,CAAC5V,aAAa,CAAC,CAAC,EAAEyiE,YAAY,CAAC;EACrC,CAAC;EAEDxsE,SAAS,CAACiG,gBAAgB,CAAC,cAAc,EAAEunE,iBAAiB,CAAC;;EAE7D;EACA,SAASI,2BAA2B,GAAG;IACtC,IAAI,CAACx0D,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;IACnC,IAAI,CAACY,SAAS,CAAC,UAAU,EAAE,SAAS,CAAC;IACrC,IAAI,CAAC/Q,UAAU,GAAG;MAAE89D,SAAS,EAAE,CAAC;MAAElsB,MAAM,EAAE;IAAE,CAAC;EAC9C;EAEA+yB,2BAA2B,CAACnvE,KAAK,GAAG,iBAAiB;EACrDmvE,2BAA2B,CAACjkE,IAAI,GAC/B,0DAA0D;EAE3DikE,2BAA2B,CAACC,UAAU,GAAG,EAAE;EAC3CD,2BAA2B,CAACE,QAAQ,GAAG,EAAE;EAEzCF,2BAA2B,CAACrvE,SAAS,CAACqL,SAAS,GAAG,YAAW;IAC5D,IAAI6xD,GAAG,GAAG,IAAI,CAAC5xD,YAAY,CAAC,CAAC,CAAC;IAC9B,IAAI,CAAC4xD,GAAG,EAAE;MACT;IACD;IAEA,IAAI,CAAC,IAAI,CAAC97C,iBAAiB,CAAC,CAAC,CAAC,EAAE;MAC/B;IACD,CAAC,CAAC;;IAEF,IAAIof,IAAI,GAAG,IAAI,CAACklC,aAAa;IAE7B,IACC,CAACllC,IAAI,IACLA,IAAI,CAACxV,KAAK,IAAIkyC,GAAG,CAAClyC,KAAK,IACvBwV,IAAI,CAACvV,MAAM,IAAIiyC,GAAG,CAACjyC,MAAM,IACzBuV,IAAI,CAAC74B,IAAI,IAAIu1D,GAAG,CAACv1D,IAAI,EACpB;MACD,IAAI,CAAC+9D,aAAa,GAAG,IAAI5vC,EAAE,CAACqnC,OAAO,CAACD,GAAG,CAAClyC,KAAK,EAAEkyC,GAAG,CAACjyC,MAAM,EAAE;QAC1DtjB,IAAI,EAAEu1D,GAAG,CAACv1D,IAAI;QACd+1D,MAAM,EAAE1nC,EAAE,CAACkoC,IAAI;QACf1xD,MAAM,EAAEwpB,EAAE,CAAC2nC;MACZ,CAAC,CAAC;IACH;;IAEA;IACA,IAAIrhB,MAAM,GAAG,IAAI,CAAC5xC,UAAU,CAAC4xC,MAAM;IACnCA,MAAM,GAAGn6B,IAAI,CAAC4jB,GAAG,CAChB5jB,IAAI,CAACC,KAAK,CAACk6B,MAAM,CAAC,EAClB+yB,2BAA2B,CAACC,UAAU,CACtC;IACD,IAAIhzB,MAAM,IAAI,CAAC,EAAE;MAChB;MACA,IAAI,CAAC9wC,aAAa,CAAC,CAAC,EAAE0xD,GAAG,CAAC;MAC1B;IACD;IAEA,IAAIsL,SAAS,GAAG,IAAI,CAAC99D,UAAU,CAAC89D,SAAS;;IAEzC;IACA,IAAI6E,MAAM,GAAG5rE,SAAS,CAAC6rE,aAAa;IACpC,IAAI,CAACD,MAAM,IAAI15D,MAAM,CAACqiB,EAAE,KAAKje,SAAS,EAAE;MACvCs1D,MAAM,GAAGr3C,EAAE,CAAChd,MAAM,CAACiS,MAAM,GAAG+K,EAAE,CAAChd,MAAM,CAACgS,KAAK;IAC5C;IACA,IAAI,CAACqiD,MAAM,EAAE;MACZA,MAAM,GAAG,CAAC;IACX;IACAA,MAAM,GAAG,IAAI,CAAC3iE,UAAU,CAACwiE,eAAe,GAAGG,MAAM,GAAG,CAAC;IAErD,IAAI,CAACgC,2BAA2B,CAACE,QAAQ,CAACjzB,MAAM,CAAC,EAAE;MAClD+yB,2BAA2B,CAACE,QAAQ,CAACjzB,MAAM,CAAC,GAAG,IAAIxmB,EAAE,CAAC+rC,MAAM,CAC3DA,MAAM,CAACC,oBAAoB,EAC3BuN,2BAA2B,CAAC3N,YAAY,EACxC;QAAE8N,MAAM,EAAElzB,MAAM,CAAC7X,OAAO,CAAC,CAAC;MAAE,CAAC,CAC7B;IACF;IAEA,IAAI68B,MAAM,GAAG+N,2BAA2B,CAACE,QAAQ,CAACjzB,MAAM,CAAC;IACzD,IAAI+lB,IAAI,GAAGvsC,EAAE,CAACwsC,IAAI,CAACC,aAAa,EAAE;IAClCrF,GAAG,CAAC7sD,IAAI,CAAC,CAAC,CAAC;IAEX,IAAI,CAACq1D,aAAa,CAAC1D,MAAM,CAAC,YAAW;MACpCV,MAAM,CACJkB,QAAQ,CAAC;QACTC,SAAS,EAAE,CAAC;QACZmL,WAAW,EAAEpF,SAAS;QACtBiH,YAAY,EAAE,CAACvS,GAAG,CAAClyC,KAAK,EAAEkyC,GAAG,CAACjyC,MAAM,CAAC;QACrCykD,aAAa,EAAE,CAAC,CAAC,GAAGxS,GAAG,CAAClyC,KAAK,EAAE,CAAC,GAAGkyC,GAAG,CAACjyC,MAAM;MAC9C,CAAC,CAAC,CACDyL,IAAI,CAAC2rC,IAAI,CAAC;IACb,CAAC,CAAC;IAEF,IAAI,CAAC72D,aAAa,CAAC,CAAC,EAAE,IAAI,CAACk6D,aAAa,CAAC;EAC1C,CAAC;;EAED;EACA2J,2BAA2B,CAAC3N,YAAY,GACvC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EAEAjgE,SAAS,CAACiG,gBAAgB,CACzB,kBAAkB,EAClB2nE,2BAA2B,CAC3B;;EAED;EACA,SAASM,uBAAuB,GAAG;IAClC,IAAI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AAK,CAAE;IAEtBpsC,EAAE,CAACyuC,MAAM,CAAEzuC,EAAE,CAACksC,UAAU,CAAE;IAC1B,IAAI,IAAI,CAACx3D,UAAU,CAAC05D,QAAQ,EAC5B;MACCpuC,EAAE,CAAC0uC,SAAS,CAAE1uC,EAAE,CAAC2uC,SAAS,EAAE3uC,EAAE,CAAC4uC,GAAG,CAAE;MACpC5uC,EAAE,CAACuwD,SAAS,CAAE,KAAK,CAAE;IACtB,CAAC,MAEAvwD,EAAE,CAAC0uC,SAAS,CAAE1uC,EAAE,CAAC2uC,SAAS,EAAE3uC,EAAE,CAAC6uC,mBAAmB,CAAE;IAErDvD,MAAM,CAAC5qC,IAAI,CAAE,IAAI,CAAC2rC,IAAI,EAAEvsC,EAAE,CAAC6vD,MAAM,CAAE;IAEnC3vD,EAAE,CAACisC,OAAO,CAAEjsC,EAAE,CAACosC,KAAK,CAAE;IACtBpsC,EAAE,CAACuwD,SAAS,CAAE,IAAI,CAAE;EACrB,CAAC;EAED9kF,SAAS,CAACiG,gBAAgB,CAAE,wBAAwB,EAAEw+E,kBAAkB,CAAE;EAE1EA,kBAAkB,CAACC,kBAAkB,GAAG;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;EAEDD,kBAAkB,CAACE,oBAAoB,GAAG;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;EAED;EACA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA4BA,CAAC,EAAE,IAAI,CAAC;AACR,CAAC,UAAS5kF,MAAM,EAAE;EACd,IAAIC,SAAS,GAAGD,MAAM,CAACC,SAAS;EAChC,IAAIs6D,aAAa,GAAGv6D,MAAM,CAACu6D,aAAa;;EAExC;EACA,IAAI,OAAOjmC,EAAE,IAAI,WAAW,EAAE;IAC1B;IAAA,IACS+xD,YAAY,GAArB,SAASA,YAAY,GAAG;MACpB,IAAI,CAAChtE,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC;MACnC,IAAI,CAACA,QAAQ,CAAC,YAAY,EAAE,QAAQ,CAAC;MACrC,IAAI,CAACA,QAAQ,CAAC,YAAY,EAAE,QAAQ,CAAC;MACrC,IAAI,CAACA,QAAQ,CAAC,MAAM,EAAE,QAAQ,CAAC;MAC/B,IAAI,CAACY,SAAS,CAAC,SAAS,EAAE,SAAS,CAAC;MACpC,IAAI,CAAC/Q,UAAU,GAAG;QACdo9E,UAAU,EAAE,GAAG;QACfC,UAAU,EAAE,GAAG;QACfr0C,IAAI,EAAE,GAAG;QACT3H,SAAS,EAAEgwB,aAAa,CAACS;MAC7B,CAAC;MAED,IAAI,CAACqrB,YAAY,CAACtmB,OAAO,EAAE;QACvBsmB,YAAY,CAACtmB,OAAO,GAAG,IAAIzrC,EAAE,CAAC+rC,MAAM,CAChC/rC,EAAE,CAAC+rC,MAAM,CAACC,oBAAoB,EAC9B+lB,YAAY,CAACnmB,YAAY,CAC5B;QACDmmB,YAAY,CAACrnB,QAAQ,GAAG,IAAI1qC,EAAE,CAACqnC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE;UACzCO,MAAM,EAAE1nC,EAAE,CAACi0C,GAAG;UACd9L,IAAI,EAAEnoC,EAAE,CAAC4yC,aAAa;UACtBhD,SAAS,EAAE5vC,EAAE,CAAC2nC,MAAM;UACpB8B,SAAS,EAAEzpC,EAAE,CAAC2nC,MAAM;UACpBqqB,UAAU,EAAE,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG;QAChD,CAAC,CAAC;MACN;IACJ,CAAC;IAoGD;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IAcQ;IAAA,IAESC,a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","file":"litegraph.58470eed.js","sourceRoot":"..","sourcesContent":["// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","//packer version\n\n\n(function(global) {\n    // *************************************************************\n    //   LiteGraph CLASS                                     *******\n    // *************************************************************\n\n    /**\n     * The Global Scope. It contains all the registered node classes.\n     *\n     * @class LiteGraph\n     * @constructor\n     */\n\n    var LiteGraph = (global.LiteGraph = {\n        VERSION: 0.4,\n\n        CANVAS_GRID_SIZE: 10,\n\n        NODE_TITLE_HEIGHT: 30,\n        NODE_TITLE_TEXT_Y: 20,\n        NODE_SLOT_HEIGHT: 20,\n        NODE_WIDGET_HEIGHT: 20,\n        NODE_WIDTH: 140,\n        NODE_MIN_WIDTH: 50,\n        NODE_COLLAPSED_RADIUS: 10,\n        NODE_COLLAPSED_WIDTH: 80,\n        NODE_TITLE_COLOR: \"#999\",\n        NODE_SELECTED_TITLE_COLOR: \"#FFF\",\n        NODE_TEXT_SIZE: 14,\n        NODE_TEXT_COLOR: \"#AAA\",\n        NODE_SUBTEXT_SIZE: 12,\n        NODE_DEFAULT_COLOR: \"#333\",\n        NODE_DEFAULT_BGCOLOR: \"#353535\",\n        NODE_DEFAULT_BOXCOLOR: \"#666\",\n        NODE_DEFAULT_SHAPE: \"box\",\n        NODE_BOX_OUTLINE_COLOR: \"#FFF\",\n        DEFAULT_SHADOW_COLOR: \"rgba(0,0,0,0.5)\",\n        DEFAULT_GROUP_FONT: 24,\n\n        WIDGET_BGCOLOR: \"#222\",\n        WIDGET_OUTLINE_COLOR: \"#666\",\n        WIDGET_TEXT_COLOR: \"#DDD\",\n        WIDGET_SECONDARY_TEXT_COLOR: \"#999\",\n\n        LINK_COLOR: \"#9A9\",\n        EVENT_LINK_COLOR: \"#A86\",\n        CONNECTING_LINK_COLOR: \"#AFA\",\n\n        MAX_NUMBER_OF_NODES: 1000, //avoid infinite loops\n        DEFAULT_POSITION: [100, 100], //default node position\n        VALID_SHAPES: [\"default\", \"box\", \"round\", \"card\"], //,\"circle\"\n\n        //shapes are used for nodes but also for slots\n        BOX_SHAPE: 1,\n        ROUND_SHAPE: 2,\n        CIRCLE_SHAPE: 3,\n        CARD_SHAPE: 4,\n        ARROW_SHAPE: 5,\n        GRID_SHAPE: 6, // intended for slot arrays\n\n        //enums\n        INPUT: 1,\n        OUTPUT: 2,\n\n        EVENT: -1, //for outputs\n        ACTION: -1, //for inputs\n\n        NODE_MODES: [\"Always\", \"On Event\", \"Never\", \"On Trigger\"], // helper, will add \"On Request\" and more in the future\n        NODE_MODES_COLORS:[\"#666\",\"#422\",\"#333\",\"#224\",\"#626\"], // use with node_box_coloured_by_mode\n        ALWAYS: 0,\n        ON_EVENT: 1,\n        NEVER: 2,\n        ON_TRIGGER: 3,\n\n        UP: 1,\n        DOWN: 2,\n        LEFT: 3,\n        RIGHT: 4,\n        CENTER: 5,\n\n        LINK_RENDER_MODES: [\"Straight\", \"Linear\", \"Spline\"], // helper\n        STRAIGHT_LINK: 0,\n        LINEAR_LINK: 1,\n        SPLINE_LINK: 2,\n\n        NORMAL_TITLE: 0,\n        NO_TITLE: 1,\n        TRANSPARENT_TITLE: 2,\n        AUTOHIDE_TITLE: 3,\n        VERTICAL_LAYOUT: \"vertical\", // arrange nodes vertically\n\n        proxy: null, //used to redirect calls\n        node_images_path: \"\",\n\n        debug: false,\n        catch_exceptions: true,\n        throw_errors: true,\n        allow_scripts: false, //if set to true some nodes like Formula would be allowed to evaluate code that comes from unsafe sources (like node configuration), which could lead to exploits\n        registered_node_types: {}, //nodetypes by string\n        node_types_by_file_extension: {}, //used for dropping files in the canvas\n        Nodes: {}, //node types by classname\n\t\tGlobals: {}, //used to store vars between graphs\n\n        searchbox_extras: {}, //used to add extra features to the search box\n        auto_sort_node_types: false, // [true!] If set to true, will automatically sort node types / categories in the context menus\n\t\t\n\t\tnode_box_coloured_when_on: false, // [true!] this make the nodes box (top left circle) coloured when triggered (execute/action), visual feedback\n        node_box_coloured_by_mode: false, // [true!] nodebox based on node mode, visual feedback\n        \n        dialog_close_on_mouse_leave: true, // [false on mobile] better true if not touch device, TODO add an helper/listener to close if false\n        dialog_close_on_mouse_leave_delay: 500,\n        \n        shift_click_do_break_link_from: false, // [false!] prefer false if results too easy to break links - implement with ALT or TODO custom keys\n        click_do_break_link_to: false, // [false!]prefer false, way too easy to break links\n        \n        search_hide_on_mouse_leave: true, // [false on mobile] better true if not touch device, TODO add an helper/listener to close if false\n        search_filter_enabled: false, // [true!] enable filtering slots type in the search widget, !requires auto_load_slot_types or manual set registered_slot_[in/out]_types and slot_types_[in/out]\n        search_show_all_on_open: true, // [true!] opens the results list when opening the search widget\n        \n        auto_load_slot_types: false, // [if want false, use true, run, get vars values to be statically set, than disable] nodes types and nodeclass association with node types need to be calculated, if dont want this, calculate once and set registered_slot_[in/out]_types and slot_types_[in/out]\n        \n\t\t// set these values if not using auto_load_slot_types\n        registered_slot_in_types: {}, // slot types for nodeclass\n        registered_slot_out_types: {}, // slot types for nodeclass\n        slot_types_in: [], // slot types IN\n        slot_types_out: [], // slot types OUT\n        slot_types_default_in: [], // specify for each IN slot type a(/many) deafult node(s), use single string, array, or object (with node, title, parameters, ..) like for search\n\t\tslot_types_default_out: [], // specify for each OUT slot type a(/many) deafult node(s), use single string, array, or object (with node, title, parameters, ..) like for search\n\t\t\n\t\talt_drag_do_clone_nodes: false, // [true!] very handy, ALT click to clone and drag the new node\n\n\t\tdo_add_triggers_slots: false, // [true!] will create and connect event slots when using action/events connections, !WILL CHANGE node mode when using onTrigger (enable mode colors), onExecuted does not need this\n\t\t\n\t\tallow_multi_output_for_events: true, // [false!] being events, it is strongly reccomended to use them sequentually, one by one\n\n\t\tmiddle_click_slot_add_default_node: false, //[true!] allows to create and connect a ndoe clicking with the third button (wheel)\n\t\t\n\t\trelease_link_on_empty_shows_menu: false, //[true!] dragging a link to empty space will open a menu, add from list, search or defaults\n\t\t\n        pointerevents_method: \"mouse\", // \"mouse\"|\"pointer\" use mouse for retrocompatibility issues? (none found @ now)\n        // TODO implement pointercancel, gotpointercapture, lostpointercapture, (pointerover, pointerout if necessary)\n\n        /**\n         * Register a node class so it can be listed when the user wants to create a new one\n         * @method registerNodeType\n         * @param {String} type name of the node and path\n         * @param {Class} base_class class containing the structure of a node\n         */\n\n        registerNodeType: function(type, base_class) {\n            if (!base_class.prototype) {\n                throw \"Cannot register a simple object, it must be a class with a prototype\";\n            }\n            base_class.type = type;\n\n            if (LiteGraph.debug) {\n                console.log(\"Node registered: \" + type);\n            }\n\n            var categories = type.split(\"/\");\n            var classname = base_class.name;\n\n            var pos = type.lastIndexOf(\"/\");\n            base_class.category = type.substr(0, pos);\n\n            if (!base_class.title) {\n                base_class.title = classname;\n            }\n            //info.name = name.substr(pos+1,name.length - pos);\n\n            //extend class\n            if (base_class.prototype) {\n                //is a class\n                for (var i in LGraphNode.prototype) {\n                    if (!base_class.prototype[i]) {\n                        base_class.prototype[i] = LGraphNode.prototype[i];\n                    }\n                }\n            }\n\n            var prev = this.registered_node_types[type];\n\t\t\tif(prev)\n\t\t\t\tconsole.log(\"replacing node type: \" + type);\n\t\t\telse\n\t\t\t{\n\t\t\t\tif( !Object.hasOwnProperty( base_class.prototype, \"shape\") )\n\t\t\t\tObject.defineProperty(base_class.prototype, \"shape\", {\n\t\t\t\t\tset: function(v) {\n\t\t\t\t\t\tswitch (v) {\n\t\t\t\t\t\t\tcase \"default\":\n\t\t\t\t\t\t\t\tdelete this._shape;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"box\":\n\t\t\t\t\t\t\t\tthis._shape = LiteGraph.BOX_SHAPE;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"round\":\n\t\t\t\t\t\t\t\tthis._shape = LiteGraph.ROUND_SHAPE;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"circle\":\n\t\t\t\t\t\t\t\tthis._shape = LiteGraph.CIRCLE_SHAPE;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"card\":\n\t\t\t\t\t\t\t\tthis._shape = LiteGraph.CARD_SHAPE;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tthis._shape = v;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tget: function(v) {\n\t\t\t\t\t\treturn this._shape;\n\t\t\t\t\t},\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tconfigurable: true\n\t\t\t\t});\n\n\t\t\t\t//warnings\n\t\t\t\tif (base_class.prototype.onPropertyChange) {\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\"LiteGraph node class \" +\n\t\t\t\t\t\t\ttype +\n\t\t\t\t\t\t\t\" has onPropertyChange method, it must be called onPropertyChanged with d at the end\"\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t//used to know which nodes create when dragging files to the canvas\n\t\t\t\tif (base_class.supported_extensions) {\n\t\t\t\t\tfor (var i in base_class.supported_extensions) {\n\t\t\t\t\t\tvar ext = base_class.supported_extensions[i];\n\t\t\t\t\t\tif(ext && ext.constructor === String)\n\t\t\t\t\t\t\tthis.node_types_by_file_extension[ ext.toLowerCase() ] = base_class;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n            this.registered_node_types[type] = base_class;\n            if (base_class.constructor.name) {\n                this.Nodes[classname] = base_class;\n            }\n            if (LiteGraph.onNodeTypeRegistered) {\n                LiteGraph.onNodeTypeRegistered(type, base_class);\n            }\n            if (prev && LiteGraph.onNodeTypeReplaced) {\n                LiteGraph.onNodeTypeReplaced(type, base_class, prev);\n            }\n\n            //warnings\n            if (base_class.prototype.onPropertyChange) {\n                console.warn(\n                    \"LiteGraph node class \" +\n                        type +\n                        \" has onPropertyChange method, it must be called onPropertyChanged with d at the end\"\n                );\n            }\n\n\t\t\t//used to know which nodes create when dragging files to the canvas\n            if (base_class.supported_extensions) {\n                for (var i=0; i < base_class.supported_extensions.length; i++) {\n\t\t\t\t\tvar ext = base_class.supported_extensions[i];\n\t\t\t\t\tif(ext && ext.constructor === String)\n\t                    this.node_types_by_file_extension[ ext.toLowerCase() ] = base_class;\n                }\n            }\n            \n            // TODO one would want to know input and ouput :: this would allow trought registerNodeAndSlotType to get all the slots types\n            //console.debug(\"Registering \"+type);\n            if (this.auto_load_slot_types) nodeTmp = new base_class(base_class.title || \"tmpnode\");\n        },\n\n        /**\n         * removes a node type from the system\n         * @method unregisterNodeType\n         * @param {String|Object} type name of the node or the node constructor itself\n         */\n        unregisterNodeType: function(type) {\n\t\t\tvar base_class = type.constructor === String ? this.registered_node_types[type] : type;\n\t\t\tif(!base_class)\n\t\t\t\tthrow(\"node type not found: \" + type );\n\t\t\tdelete this.registered_node_types[base_class.type];\n\t\t\tif(base_class.constructor.name)\n\t\t\t\tdelete this.Nodes[base_class.constructor.name];\n\t\t},\n\n        /**\n        * Save a slot type and his node\n        * @method registerSlotType\n        * @param {String|Object} type name of the node or the node constructor itself\n        * @param {String} slot_type name of the slot type (variable type), eg. string, number, array, boolean, ..\n        */\n        registerNodeAndSlotType: function(type,slot_type,out){\n            out = out || false;\n            var base_class = type.constructor === String && this.registered_node_types[type] !== \"anonymous\" ? this.registered_node_types[type] : type;\n            \n            var sCN = base_class.constructor.type;\n            \n            if (typeof slot_type == \"string\"){\n                var aTypes = slot_type.split(\",\");\n            }else if (slot_type == this.EVENT || slot_type == this.ACTION){\n                var aTypes = [\"_event_\"];\n            }else{\n                var aTypes = [\"*\"];\n            }\n\n            for (var i = 0; i < aTypes.length; ++i) {\n                var sT = aTypes[i]; //.toLowerCase();\n                if (sT === \"\"){\n                    sT = \"*\";\n                }\n                var registerTo = out ? \"registered_slot_out_types\" : \"registered_slot_in_types\";\n                if (typeof this[registerTo][sT] == \"undefined\") this[registerTo][sT] = {nodes: []};\n                this[registerTo][sT].nodes.push(sCN);\n                \n                // check if is a new type\n                if (!out){\n                    if (!this.slot_types_in.includes(sT.toLowerCase())){\n                        this.slot_types_in.push(sT.toLowerCase());\n                        this.slot_types_in.sort();\n                    }\n                }else{\n                    if (!this.slot_types_out.includes(sT.toLowerCase())){\n                        this.slot_types_out.push(sT.toLowerCase());\n                        this.slot_types_out.sort();\n                    }\n                }\n            }\n        },\n        \n        /**\n         * Create a new nodetype by passing a function, it wraps it with a proper class and generates inputs according to the parameters of the function.\n         * Useful to wrap simple methods that do not require properties, and that only process some input to generate an output.\n         * @method wrapFunctionAsNode\n         * @param {String} name node name with namespace (p.e.: 'math/sum')\n         * @param {Function} func\n         * @param {Array} param_types [optional] an array containing the type of every parameter, otherwise parameters will accept any type\n         * @param {String} return_type [optional] string with the return type, otherwise it will be generic\n         * @param {Object} properties [optional] properties to be configurable\n         */\n        wrapFunctionAsNode: function(\n            name,\n            func,\n            param_types,\n            return_type,\n            properties\n        ) {\n            var params = Array(func.length);\n            var code = \"\";\n            var names = LiteGraph.getParameterNames(func);\n            for (var i = 0; i < names.length; ++i) {\n                code +=\n                    \"this.addInput('\" +\n                    names[i] +\n                    \"',\" +\n                    (param_types && param_types[i]\n                        ? \"'\" + param_types[i] + \"'\"\n                        : \"0\") +\n                    \");\\n\";\n            }\n            code +=\n                \"this.addOutput('out',\" +\n                (return_type ? \"'\" + return_type + \"'\" : 0) +\n                \");\\n\";\n            if (properties) {\n                code +=\n                    \"this.properties = \" + JSON.stringify(properties) + \";\\n\";\n            }\n            var classobj = Function(code);\n            classobj.title = name.split(\"/\").pop();\n            classobj.desc = \"Generated from \" + func.name;\n            classobj.prototype.onExecute = function onExecute() {\n                for (var i = 0; i < params.length; ++i) {\n                    params[i] = this.getInputData(i);\n                }\n                var r = func.apply(this, params);\n                this.setOutputData(0, r);\n            };\n            this.registerNodeType(name, classobj);\n        },\n\n        /**\n         * Removes all previously registered node's types\n         */\n        clearRegisteredTypes: function() {\n            this.registered_node_types = {};\n            this.node_types_by_file_extension = {};\n            this.Nodes = {};\n            this.searchbox_extras = {};\n        },\n\n        /**\n         * Adds this method to all nodetypes, existing and to be created\n         * (You can add it to LGraphNode.prototype but then existing node types wont have it)\n         * @method addNodeMethod\n         * @param {Function} func\n         */\n        addNodeMethod: function(name, func) {\n            LGraphNode.prototype[name] = func;\n            for (var i in this.registered_node_types) {\n                var type = this.registered_node_types[i];\n                if (type.prototype[name]) {\n                    type.prototype[\"_\" + name] = type.prototype[name];\n                } //keep old in case of replacing\n                type.prototype[name] = func;\n            }\n        },\n\n        /**\n         * Create a node of a given type with a name. The node is not attached to any graph yet.\n         * @method createNode\n         * @param {String} type full name of the node class. p.e. \"math/sin\"\n         * @param {String} name a name to distinguish from other nodes\n         * @param {Object} options to set options\n         */\n\n        createNode: function(type, title, options) {\n            var base_class = this.registered_node_types[type];\n            if (!base_class) {\n                if (LiteGraph.debug) {\n                    console.log(\n                        'GraphNode type \"' + type + '\" not registered.'\n                    );\n                }\n                return null;\n            }\n\n            var prototype = base_class.prototype || base_class;\n\n            title = title || base_class.title || type;\n\n            var node = null;\n\n            if (LiteGraph.catch_exceptions) {\n                try {\n                    node = new base_class(title);\n                } catch (err) {\n                    console.error(err);\n                    return null;\n                }\n            } else {\n                node = new base_class(title);\n            }\n\n            node.type = type;\n\n            if (!node.title && title) {\n                node.title = title;\n            }\n            if (!node.properties) {\n                node.properties = {};\n            }\n            if (!node.properties_info) {\n                node.properties_info = [];\n            }\n            if (!node.flags) {\n                node.flags = {};\n            }\n            if (!node.size) {\n                node.size = node.computeSize();\n\t\t\t\t//call onresize?\n            }\n            if (!node.pos) {\n                node.pos = LiteGraph.DEFAULT_POSITION.concat();\n            }\n            if (!node.mode) {\n                node.mode = LiteGraph.ALWAYS;\n            }\n\n            //extra options\n            if (options) {\n                for (var i in options) {\n                    node[i] = options[i];\n                }\n            }\n\n\t\t\t// callback\n            if ( node.onNodeCreated ) {\n                node.onNodeCreated();\n            }\n            \n            return node;\n        },\n\n        /**\n         * Returns a registered node type with a given name\n         * @method getNodeType\n         * @param {String} type full name of the node class. p.e. \"math/sin\"\n         * @return {Class} the node class\n         */\n        getNodeType: function(type) {\n            return this.registered_node_types[type];\n        },\n\n        /**\n         * Returns a list of node types matching one category\n         * @method getNodeType\n         * @param {String} category category name\n         * @return {Array} array with all the node classes\n         */\n\n        getNodeTypesInCategory: function(category, filter) {\n            var r = [];\n            for (var i in this.registered_node_types) {\n                var type = this.registered_node_types[i];\n                if (type.filter != filter) {\n                    continue;\n                }\n\n                if (category == \"\") {\n                    if (type.category == null) {\n                        r.push(type);\n                    }\n                } else if (type.category == category) {\n                    r.push(type);\n                }\n            }\n\n            if (this.auto_sort_node_types) {\n                r.sort(function(a,b){return a.title.localeCompare(b.title)});\n            }\n\n            return r;\n        },\n\n        /**\n         * Returns a list with all the node type categories\n         * @method getNodeTypesCategories\n         * @param {String} filter only nodes with ctor.filter equal can be shown\n         * @return {Array} array with all the names of the categories\n         */\n        getNodeTypesCategories: function( filter ) {\n            var categories = { \"\": 1 };\n            for (var i in this.registered_node_types) {\n\t\t\t\tvar type = this.registered_node_types[i];\n                if ( type.category && !type.skip_list )\n                {\n\t\t\t\t\tif(type.filter != filter)\n\t\t\t\t\t\tcontinue;\n                    categories[type.category] = 1;\n                }\n            }\n            var result = [];\n            for (var i in categories) {\n                result.push(i);\n            }\n            return this.auto_sort_node_types ? result.sort() : result;\n        },\n\n        //debug purposes: reloads all the js scripts that matches a wildcard\n        reloadNodes: function(folder_wildcard) {\n            var tmp = document.getElementsByTagName(\"script\");\n            //weird, this array changes by its own, so we use a copy\n            var script_files = [];\n            for (var i=0; i < tmp.length; i++) {\n                script_files.push(tmp[i]);\n            }\n\n            var docHeadObj = document.getElementsByTagName(\"head\")[0];\n            folder_wildcard = document.location.href + folder_wildcard;\n\n            for (var i=0; i < script_files.length; i++) {\n                var src = script_files[i].src;\n                if (\n                    !src ||\n                    src.substr(0, folder_wildcard.length) != folder_wildcard\n                ) {\n                    continue;\n                }\n\n                try {\n                    if (LiteGraph.debug) {\n                        console.log(\"Reloading: \" + src);\n                    }\n                    var dynamicScript = document.createElement(\"script\");\n                    dynamicScript.type = \"text/javascript\";\n                    dynamicScript.src = src;\n                    docHeadObj.appendChild(dynamicScript);\n                    docHeadObj.removeChild(script_files[i]);\n                } catch (err) {\n                    if (LiteGraph.throw_errors) {\n                        throw err;\n                    }\n                    if (LiteGraph.debug) {\n                        console.log(\"Error while reloading \" + src);\n                    }\n                }\n            }\n\n            if (LiteGraph.debug) {\n                console.log(\"Nodes reloaded\");\n            }\n        },\n\n        //separated just to improve if it doesn't work\n        cloneObject: function(obj, target) {\n            if (obj == null) {\n                return null;\n            }\n            var r = JSON.parse(JSON.stringify(obj));\n            if (!target) {\n                return r;\n            }\n\n            for (var i in r) {\n                target[i] = r[i];\n            }\n            return target;\n        },\n\n        /**\n         * Returns if the types of two slots are compatible (taking into account wildcards, etc)\n         * @method isValidConnection\n         * @param {String} type_a\n         * @param {String} type_b\n         * @return {Boolean} true if they can be connected\n         */\n        isValidConnection: function(type_a, type_b) {\n\t\t\tif (type_a==\"\" || type_a===\"*\") type_a = 0;\n\t\t\tif (type_b==\"\" || type_b===\"*\") type_b = 0;\n            if (\n                !type_a //generic output\n                || !type_b // generic input\n                || type_a == type_b //same type (is valid for triggers)\n                || (type_a == LiteGraph.EVENT && type_b == LiteGraph.ACTION)\n            ) {\n                return true;\n            }\n\n            // Enforce string type to handle toLowerCase call (-1 number not ok)\n            type_a = String(type_a);\n            type_b = String(type_b);\n            type_a = type_a.toLowerCase();\n            type_b = type_b.toLowerCase();\n\n            // For nodes supporting multiple connection types\n            if (type_a.indexOf(\",\") == -1 && type_b.indexOf(\",\") == -1) {\n                return type_a == type_b;\n            }\n\n            // Check all permutations to see if one is valid\n            var supported_types_a = type_a.split(\",\");\n            var supported_types_b = type_b.split(\",\");\n            for (var i = 0; i < supported_types_a.length; ++i) {\n                for (var j = 0; j < supported_types_b.length; ++j) {\n                    if(this.isValidConnection(supported_types_a[i],supported_types_b[j])){\n\t\t\t\t\t//if (supported_types_a[i] == supported_types_b[j]) {\n                        return true;\n                    }\n                }\n            }\n\n            return false;\n        },\n\n        /**\n         * Register a string in the search box so when the user types it it will recommend this node\n         * @method registerSearchboxExtra\n         * @param {String} node_type the node recommended\n         * @param {String} description text to show next to it\n         * @param {Object} data it could contain info of how the node should be configured\n         * @return {Boolean} true if they can be connected\n         */\n        registerSearchboxExtra: function(node_type, description, data) {\n            this.searchbox_extras[description.toLowerCase()] = {\n                type: node_type,\n                desc: description,\n                data: data\n            };\n        },\n\n        /**\n         * Wrapper to load files (from url using fetch or from file using FileReader)\n         * @method fetchFile\n         * @param {String|File|Blob} url the url of the file (or the file itself)\n         * @param {String} type an string to know how to fetch it: \"text\",\"arraybuffer\",\"json\",\"blob\"\n         * @param {Function} on_complete callback(data)\n         * @param {Function} on_error in case of an error\n         * @return {FileReader|Promise} returns the object used to \n         */\n\t\tfetchFile: function( url, type, on_complete, on_error ) {\n\t\t\tvar that = this;\n\t\t\tif(!url)\n\t\t\t\treturn null;\n\n\t\t\ttype = type || \"text\";\n\t\t\tif( url.constructor === String )\n\t\t\t{\n\t\t\t\tif (url.substr(0, 4) == \"http\" && LiteGraph.proxy) {\n\t\t\t\t\turl = LiteGraph.proxy + url.substr(url.indexOf(\":\") + 3);\n\t\t\t\t}\n\t\t\t\treturn fetch(url)\n\t\t\t\t.then(function(response) {\n\t\t\t\t\tif(!response.ok)\n\t\t\t\t\t\t throw new Error(\"File not found\"); //it will be catch below\n\t\t\t\t\tif(type == \"arraybuffer\")\n\t\t\t\t\t\treturn response.arrayBuffer();\n\t\t\t\t\telse if(type == \"text\" || type == \"string\")\n\t\t\t\t\t\treturn response.text();\n\t\t\t\t\telse if(type == \"json\")\n\t\t\t\t\t\treturn response.json();\n\t\t\t\t\telse if(type == \"blob\")\n\t\t\t\t\t\treturn response.blob();\n\t\t\t\t})\n\t\t\t\t.then(function(data) {\n\t\t\t\t\tif(on_complete)\n\t\t\t\t\t\ton_complete(data);\n\t\t\t\t})\n\t\t\t\t.catch(function(error) {\n\t\t\t\t\tconsole.error(\"error fetching file:\",url);\n\t\t\t\t\tif(on_error)\n\t\t\t\t\t\ton_error(error);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if( url.constructor === File || url.constructor === Blob)\n\t\t\t{\n\t\t\t\tvar reader = new FileReader();\n\t\t\t\treader.onload = function(e)\n\t\t\t\t{\n\t\t\t\t\tvar v = e.target.result;\n\t\t\t\t\tif( type == \"json\" )\n\t\t\t\t\t\tv = JSON.parse(v);\n\t\t\t\t\tif(on_complete)\n\t\t\t\t\t\ton_complete(v);\n\t\t\t\t}\n\t\t\t\tif(type == \"arraybuffer\")\n\t\t\t\t\treturn reader.readAsArrayBuffer(url);\n\t\t\t\telse if(type == \"text\" || type == \"json\")\n\t\t\t\t\treturn reader.readAsText(url);\n\t\t\t\telse if(type == \"blob\")\n\t\t\t\t\treturn reader.readAsBinaryString(url);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n    });\n\n    //timer that works everywhere\n    if (typeof performance != \"undefined\") {\n        LiteGraph.getTime = performance.now.bind(performance);\n    } else if (typeof Date != \"undefined\" && Date.now) {\n        LiteGraph.getTime = Date.now.bind(Date);\n    } else if (typeof process != \"undefined\") {\n        LiteGraph.getTime = function() {\n            var t = process.hrtime();\n            return t[0] * 0.001 + t[1] * 1e-6;\n        };\n    } else {\n        LiteGraph.getTime = function getTime() {\n            return new Date().getTime();\n        };\n    }\n\n    //*********************************************************************************\n    // LGraph CLASS\n    //*********************************************************************************\n\n    /**\n     * LGraph is the class that contain a full graph. We instantiate one and add nodes to it, and then we can run the execution loop.\n\t * supported callbacks:\n\t\t+ onNodeAdded: when a new node is added to the graph\n\t\t+ onNodeRemoved: when a node inside this graph is removed\n\t\t+ onNodeConnectionChange: some connection has changed in the graph (connected or disconnected)\n     *\n     * @class LGraph\n     * @constructor\n     * @param {Object} o data from previous serialization [optional]\n     */\n\n    function LGraph(o) {\n        if (LiteGraph.debug) {\n            console.log(\"Graph created\");\n        }\n        this.list_of_graphcanvas = null;\n        this.clear();\n\n        if (o) {\n            this.configure(o);\n        }\n    }\n\n    global.LGraph = LiteGraph.LGraph = LGraph;\n\n    //default supported types\n    LGraph.supported_types = [\"number\", \"string\", \"boolean\"];\n\n    //used to know which types of connections support this graph (some graphs do not allow certain types)\n    LGraph.prototype.getSupportedTypes = function() {\n        return this.supported_types || LGraph.supported_types;\n    };\n\n    LGraph.STATUS_STOPPED = 1;\n    LGraph.STATUS_RUNNING = 2;\n\n    /**\n     * Removes all nodes from this graph\n     * @method clear\n     */\n\n    LGraph.prototype.clear = function() {\n        this.stop();\n        this.status = LGraph.STATUS_STOPPED;\n\n        this.last_node_id = 0;\n        this.last_link_id = 0;\n\n        this._version = -1; //used to detect changes\n\n        //safe clear\n        if (this._nodes) {\n            for (var i = 0; i < this._nodes.length; ++i) {\n                var node = this._nodes[i];\n                if (node.onRemoved) {\n                    node.onRemoved();\n                }\n            }\n        }\n\n        //nodes\n        this._nodes = [];\n        this._nodes_by_id = {};\n        this._nodes_in_order = []; //nodes sorted in execution order\n        this._nodes_executable = null; //nodes that contain onExecute sorted in execution order\n\n        //other scene stuff\n        this._groups = [];\n\n        //links\n        this.links = {}; //container with all the links\n\n        //iterations\n        this.iteration = 0;\n\n        //custom data\n        this.config = {};\n\t\tthis.vars = {};\n\t\tthis.extra = {}; //to store custom data\n\n        //timing\n        this.globaltime = 0;\n        this.runningtime = 0;\n        this.fixedtime = 0;\n        this.fixedtime_lapse = 0.01;\n        this.elapsed_time = 0.01;\n        this.last_update_time = 0;\n        this.starttime = 0;\n\n        this.catch_errors = true;\n\n        this.nodes_executing = [];\n        this.nodes_actioning = [];\n        this.nodes_executedAction = [];\n        \n        //subgraph_data\n        this.inputs = {};\n        this.outputs = {};\n\n        //notify canvas to redraw\n        this.change();\n\n        this.sendActionToCanvas(\"clear\");\n    };\n\n    /**\n     * Attach Canvas to this graph\n     * @method attachCanvas\n     * @param {GraphCanvas} graph_canvas\n     */\n\n    LGraph.prototype.attachCanvas = function(graphcanvas) {\n        if (graphcanvas.constructor != LGraphCanvas) {\n            throw \"attachCanvas expects a LGraphCanvas instance\";\n        }\n        if (graphcanvas.graph && graphcanvas.graph != this) {\n            graphcanvas.graph.detachCanvas(graphcanvas);\n        }\n\n        graphcanvas.graph = this;\n\n        if (!this.list_of_graphcanvas) {\n            this.list_of_graphcanvas = [];\n        }\n        this.list_of_graphcanvas.push(graphcanvas);\n    };\n\n    /**\n     * Detach Canvas from this graph\n     * @method detachCanvas\n     * @param {GraphCanvas} graph_canvas\n     */\n    LGraph.prototype.detachCanvas = function(graphcanvas) {\n        if (!this.list_of_graphcanvas) {\n            return;\n        }\n\n        var pos = this.list_of_graphcanvas.indexOf(graphcanvas);\n        if (pos == -1) {\n            return;\n        }\n        graphcanvas.graph = null;\n        this.list_of_graphcanvas.splice(pos, 1);\n    };\n\n    /**\n     * Starts running this graph every interval milliseconds.\n     * @method start\n     * @param {number} interval amount of milliseconds between executions, if 0 then it renders to the monitor refresh rate\n     */\n\n    LGraph.prototype.start = function(interval) {\n        if (this.status == LGraph.STATUS_RUNNING) {\n            return;\n        }\n        this.status = LGraph.STATUS_RUNNING;\n\n        if (this.onPlayEvent) {\n            this.onPlayEvent();\n        }\n\n        this.sendEventToAllNodes(\"onStart\");\n\n        //launch\n        this.starttime = LiteGraph.getTime();\n        this.last_update_time = this.starttime;\n        interval = interval || 0;\n        var that = this;\n\n\t\t//execute once per frame\n        if ( interval == 0 && typeof window != \"undefined\" && window.requestAnimationFrame ) {\n            function on_frame() {\n                if (that.execution_timer_id != -1) {\n                    return;\n                }\n                window.requestAnimationFrame(on_frame);\n\t\t\t\tif(that.onBeforeStep)\n\t\t\t\t\tthat.onBeforeStep();\n                that.runStep(1, !that.catch_errors);\n\t\t\t\tif(that.onAfterStep)\n\t\t\t\t\tthat.onAfterStep();\n            }\n            this.execution_timer_id = -1;\n            on_frame();\n        } else { //execute every 'interval' ms\n            this.execution_timer_id = setInterval(function() {\n                //execute\n\t\t\t\tif(that.onBeforeStep)\n\t\t\t\t\tthat.onBeforeStep();\n                that.runStep(1, !that.catch_errors);\n\t\t\t\tif(that.onAfterStep)\n\t\t\t\t\tthat.onAfterStep();\n            }, interval);\n        }\n    };\n\n    /**\n     * Stops the execution loop of the graph\n     * @method stop execution\n     */\n\n    LGraph.prototype.stop = function() {\n        if (this.status == LGraph.STATUS_STOPPED) {\n            return;\n        }\n\n        this.status = LGraph.STATUS_STOPPED;\n\n        if (this.onStopEvent) {\n            this.onStopEvent();\n        }\n\n        if (this.execution_timer_id != null) {\n            if (this.execution_timer_id != -1) {\n                clearInterval(this.execution_timer_id);\n            }\n            this.execution_timer_id = null;\n        }\n\n        this.sendEventToAllNodes(\"onStop\");\n    };\n\n    /**\n     * Run N steps (cycles) of the graph\n     * @method runStep\n     * @param {number} num number of steps to run, default is 1\n     * @param {Boolean} do_not_catch_errors [optional] if you want to try/catch errors \n     * @param {number} limit max number of nodes to execute (used to execute from start to a node)\n     */\n\n    LGraph.prototype.runStep = function(num, do_not_catch_errors, limit ) {\n        num = num || 1;\n\n        var start = LiteGraph.getTime();\n        this.globaltime = 0.001 * (start - this.starttime);\n\n        var nodes = this._nodes_executable\n            ? this._nodes_executable\n            : this._nodes;\n        if (!nodes) {\n            return;\n        }\n\n\t\tlimit = limit || nodes.length;\n\n        if (do_not_catch_errors) {\n            //iterations\n            for (var i = 0; i < num; i++) {\n                for (var j = 0; j < limit; ++j) {\n                    var node = nodes[j];\n                    if (node.mode == LiteGraph.ALWAYS && node.onExecute) {\n                        //wrap node.onExecute();\n\t\t\t\t\t\tnode.doExecute();\n                    }\n                }\n\n                this.fixedtime += this.fixedtime_lapse;\n                if (this.onExecuteStep) {\n                    this.onExecuteStep();\n                }\n            }\n\n            if (this.onAfterExecute) {\n                this.onAfterExecute();\n            }\n        } else {\n            try {\n                //iterations\n                for (var i = 0; i < num; i++) {\n                    for (var j = 0; j < limit; ++j) {\n                        var node = nodes[j];\n                        if (node.mode == LiteGraph.ALWAYS && node.onExecute) {\n                            node.onExecute();\n                        }\n                    }\n\n                    this.fixedtime += this.fixedtime_lapse;\n                    if (this.onExecuteStep) {\n                        this.onExecuteStep();\n                    }\n                }\n\n                if (this.onAfterExecute) {\n                    this.onAfterExecute();\n                }\n                this.errors_in_execution = false;\n            } catch (err) {\n                this.errors_in_execution = true;\n                if (LiteGraph.throw_errors) {\n                    throw err;\n                }\n                if (LiteGraph.debug) {\n                    console.log(\"Error during execution: \" + err);\n                }\n                this.stop();\n            }\n        }\n\n        var now = LiteGraph.getTime();\n        var elapsed = now - start;\n        if (elapsed == 0) {\n            elapsed = 1;\n        }\n        this.execution_time = 0.001 * elapsed;\n        this.globaltime += 0.001 * elapsed;\n        this.iteration += 1;\n        this.elapsed_time = (now - this.last_update_time) * 0.001;\n        this.last_update_time = now;\n        this.nodes_executing = [];\n        this.nodes_actioning = [];\n        this.nodes_executedAction = [];\n    };\n\n    /**\n     * Updates the graph execution order according to relevance of the nodes (nodes with only outputs have more relevance than\n     * nodes with only inputs.\n     * @method updateExecutionOrder\n     */\n    LGraph.prototype.updateExecutionOrder = function() {\n        this._nodes_in_order = this.computeExecutionOrder(false);\n        this._nodes_executable = [];\n        for (var i = 0; i < this._nodes_in_order.length; ++i) {\n            if (this._nodes_in_order[i].onExecute) {\n                this._nodes_executable.push(this._nodes_in_order[i]);\n            }\n        }\n    };\n\n    //This is more internal, it computes the executable nodes in order and returns it\n    LGraph.prototype.computeExecutionOrder = function(\n        only_onExecute,\n        set_level\n    ) {\n        var L = [];\n        var S = [];\n        var M = {};\n        var visited_links = {}; //to avoid repeating links\n        var remaining_links = {}; //to a\n\n        //search for the nodes without inputs (starting nodes)\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            var node = this._nodes[i];\n            if (only_onExecute && !node.onExecute) {\n                continue;\n            }\n\n            M[node.id] = node; //add to pending nodes\n\n            var num = 0; //num of input connections\n            if (node.inputs) {\n                for (var j = 0, l2 = node.inputs.length; j < l2; j++) {\n                    if (node.inputs[j] && node.inputs[j].link != null) {\n                        num += 1;\n                    }\n                }\n            }\n\n            if (num == 0) {\n                //is a starting node\n                S.push(node);\n                if (set_level) {\n                    node._level = 1;\n                }\n            } //num of input links\n            else {\n                if (set_level) {\n                    node._level = 0;\n                }\n                remaining_links[node.id] = num;\n            }\n        }\n\n        while (true) {\n            if (S.length == 0) {\n                break;\n            }\n\n            //get an starting node\n            var node = S.shift();\n            L.push(node); //add to ordered list\n            delete M[node.id]; //remove from the pending nodes\n\n            if (!node.outputs) {\n                continue;\n            }\n\n            //for every output\n            for (var i = 0; i < node.outputs.length; i++) {\n                var output = node.outputs[i];\n                //not connected\n                if (\n                    output == null ||\n                    output.links == null ||\n                    output.links.length == 0\n                ) {\n                    continue;\n                }\n\n                //for every connection\n                for (var j = 0; j < output.links.length; j++) {\n                    var link_id = output.links[j];\n                    var link = this.links[link_id];\n                    if (!link) {\n                        continue;\n                    }\n\n                    //already visited link (ignore it)\n                    if (visited_links[link.id]) {\n                        continue;\n                    }\n\n                    var target_node = this.getNodeById(link.target_id);\n                    if (target_node == null) {\n                        visited_links[link.id] = true;\n                        continue;\n                    }\n\n                    if (\n                        set_level &&\n                        (!target_node._level ||\n                            target_node._level <= node._level)\n                    ) {\n                        target_node._level = node._level + 1;\n                    }\n\n                    visited_links[link.id] = true; //mark as visited\n                    remaining_links[target_node.id] -= 1; //reduce the number of links remaining\n                    if (remaining_links[target_node.id] == 0) {\n                        S.push(target_node);\n                    } //if no more links, then add to starters array\n                }\n            }\n        }\n\n        //the remaining ones (loops)\n        for (var i in M) {\n            L.push(M[i]);\n        }\n\n        if (L.length != this._nodes.length && LiteGraph.debug) {\n            console.warn(\"something went wrong, nodes missing\");\n        }\n\n        var l = L.length;\n\n        //save order number in the node\n        for (var i = 0; i < l; ++i) {\n            L[i].order = i;\n        }\n\n        //sort now by priority\n        L = L.sort(function(A, B) {\n            var Ap = A.constructor.priority || A.priority || 0;\n            var Bp = B.constructor.priority || B.priority || 0;\n            if (Ap == Bp) {\n                //if same priority, sort by order\n                return A.order - B.order;\n            }\n            return Ap - Bp; //sort by priority\n        });\n\n        //save order number in the node, again...\n        for (var i = 0; i < l; ++i) {\n            L[i].order = i;\n        }\n\n        return L;\n    };\n\n    /**\n     * Returns all the nodes that could affect this one (ancestors) by crawling all the inputs recursively.\n     * It doesn't include the node itself\n     * @method getAncestors\n     * @return {Array} an array with all the LGraphNodes that affect this node, in order of execution\n     */\n    LGraph.prototype.getAncestors = function(node) {\n        var ancestors = [];\n        var pending = [node];\n        var visited = {};\n\n        while (pending.length) {\n            var current = pending.shift();\n            if (!current.inputs) {\n                continue;\n            }\n            if (!visited[current.id] && current != node) {\n                visited[current.id] = true;\n                ancestors.push(current);\n            }\n\n            for (var i = 0; i < current.inputs.length; ++i) {\n                var input = current.getInputNode(i);\n                if (input && ancestors.indexOf(input) == -1) {\n                    pending.push(input);\n                }\n            }\n        }\n\n        ancestors.sort(function(a, b) {\n            return a.order - b.order;\n        });\n        return ancestors;\n    };\n\n    /**\n     * Positions every node in a more readable manner\n     * @method arrange\n     */\n    LGraph.prototype.arrange = function (margin, layout) {\n        margin = margin || 100;\n\n        var nodes = this.computeExecutionOrder(false, true);\n        var columns = [];\n        for (var i = 0; i < nodes.length; ++i) {\n            var node = nodes[i];\n            var col = node._level || 1;\n            if (!columns[col]) {\n                columns[col] = [];\n            }\n            columns[col].push(node);\n        }\n\n        var x = margin;\n\n        for (var i = 0; i < columns.length; ++i) {\n            var column = columns[i];\n            if (!column) {\n                continue;\n            }\n            var max_size = 100;\n            var y = margin + LiteGraph.NODE_TITLE_HEIGHT;\n            for (var j = 0; j < column.length; ++j) {\n                var node = column[j];\n                node.pos[0] = (layout == LiteGraph.VERTICAL_LAYOUT) ? y : x;\n                node.pos[1] = (layout == LiteGraph.VERTICAL_LAYOUT) ? x : y;\n                max_size_index = (layout == LiteGraph.VERTICAL_LAYOUT) ? 1 : 0;\n                if (node.size[max_size_index] > max_size) {\n                    max_size = node.size[max_size_index];\n                }\n                node_size_index = (layout == LiteGraph.VERTICAL_LAYOUT) ? 0 : 1;\n                y += node.size[node_size_index] + margin + LiteGraph.NODE_TITLE_HEIGHT;\n            }\n            x += max_size + margin;\n        }\n\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * Returns the amount of time the graph has been running in milliseconds\n     * @method getTime\n     * @return {number} number of milliseconds the graph has been running\n     */\n    LGraph.prototype.getTime = function() {\n        return this.globaltime;\n    };\n\n    /**\n     * Returns the amount of time accumulated using the fixedtime_lapse var. This is used in context where the time increments should be constant\n     * @method getFixedTime\n     * @return {number} number of milliseconds the graph has been running\n     */\n\n    LGraph.prototype.getFixedTime = function() {\n        return this.fixedtime;\n    };\n\n    /**\n     * Returns the amount of time it took to compute the latest iteration. Take into account that this number could be not correct\n     * if the nodes are using graphical actions\n     * @method getElapsedTime\n     * @return {number} number of milliseconds it took the last cycle\n     */\n\n    LGraph.prototype.getElapsedTime = function() {\n        return this.elapsed_time;\n    };\n\n    /**\n     * Sends an event to all the nodes, useful to trigger stuff\n     * @method sendEventToAllNodes\n     * @param {String} eventname the name of the event (function to be called)\n     * @param {Array} params parameters in array format\n     */\n    LGraph.prototype.sendEventToAllNodes = function(eventname, params, mode) {\n        mode = mode || LiteGraph.ALWAYS;\n\n        var nodes = this._nodes_in_order ? this._nodes_in_order : this._nodes;\n        if (!nodes) {\n            return;\n        }\n\n        for (var j = 0, l = nodes.length; j < l; ++j) {\n            var node = nodes[j];\n\n            if (\n                node.constructor === LiteGraph.Subgraph &&\n                eventname != \"onExecute\"\n            ) {\n                if (node.mode == mode) {\n                    node.sendEventToAllNodes(eventname, params, mode);\n                }\n                continue;\n            }\n\n            if (!node[eventname] || node.mode != mode) {\n                continue;\n            }\n            if (params === undefined) {\n                node[eventname]();\n            } else if (params && params.constructor === Array) {\n                node[eventname].apply(node, params);\n            } else {\n                node[eventname](params);\n            }\n        }\n    };\n\n    LGraph.prototype.sendActionToCanvas = function(action, params) {\n        if (!this.list_of_graphcanvas) {\n            return;\n        }\n\n        for (var i = 0; i < this.list_of_graphcanvas.length; ++i) {\n            var c = this.list_of_graphcanvas[i];\n            if (c[action]) {\n                c[action].apply(c, params);\n            }\n        }\n    };\n\n    /**\n     * Adds a new node instance to this graph\n     * @method add\n     * @param {LGraphNode} node the instance of the node\n     */\n\n    LGraph.prototype.add = function(node, skip_compute_order) {\n        if (!node) {\n            return;\n        }\n\n        //groups\n        if (node.constructor === LGraphGroup) {\n            this._groups.push(node);\n            this.setDirtyCanvas(true);\n            this.change();\n            node.graph = this;\n            this._version++;\n            return;\n        }\n\n        //nodes\n        if (node.id != -1 && this._nodes_by_id[node.id] != null) {\n            console.warn(\n                \"LiteGraph: there is already a node with this ID, changing it\"\n            );\n            node.id = ++this.last_node_id;\n        }\n\n        if (this._nodes.length >= LiteGraph.MAX_NUMBER_OF_NODES) {\n            throw \"LiteGraph: max number of nodes in a graph reached\";\n        }\n\n        //give him an id\n        if (node.id == null || node.id == -1) {\n            node.id = ++this.last_node_id;\n        } else if (this.last_node_id < node.id) {\n            this.last_node_id = node.id;\n        }\n\n        node.graph = this;\n        this._version++;\n\n        this._nodes.push(node);\n        this._nodes_by_id[node.id] = node;\n\n        if (node.onAdded) {\n            node.onAdded(this);\n        }\n\n        if (this.config.align_to_grid) {\n            node.alignToGrid();\n        }\n\n        if (!skip_compute_order) {\n            this.updateExecutionOrder();\n        }\n\n        if (this.onNodeAdded) {\n            this.onNodeAdded(node);\n        }\n\n        this.setDirtyCanvas(true);\n        this.change();\n\n        return node; //to chain actions\n    };\n\n    /**\n     * Removes a node from the graph\n     * @method remove\n     * @param {LGraphNode} node the instance of the node\n     */\n\n    LGraph.prototype.remove = function(node) {\n        if (node.constructor === LiteGraph.LGraphGroup) {\n            var index = this._groups.indexOf(node);\n            if (index != -1) {\n                this._groups.splice(index, 1);\n            }\n            node.graph = null;\n            this._version++;\n            this.setDirtyCanvas(true, true);\n            this.change();\n            return;\n        }\n\n        if (this._nodes_by_id[node.id] == null) {\n            return;\n        } //not found\n\n        if (node.ignore_remove) {\n            return;\n        } //cannot be removed\n\n\t\tthis.beforeChange(); //sure? - almost sure is wrong\n\n        //disconnect inputs\n        if (node.inputs) {\n            for (var i = 0; i < node.inputs.length; i++) {\n                var slot = node.inputs[i];\n                if (slot.link != null) {\n                    node.disconnectInput(i);\n                }\n            }\n        }\n\n        //disconnect outputs\n        if (node.outputs) {\n            for (var i = 0; i < node.outputs.length; i++) {\n                var slot = node.outputs[i];\n                if (slot.links != null && slot.links.length) {\n                    node.disconnectOutput(i);\n                }\n            }\n        }\n\n        //node.id = -1; //why?\n\n        //callback\n        if (node.onRemoved) {\n            node.onRemoved();\n        }\n\n        node.graph = null;\n        this._version++;\n\n        //remove from canvas render\n        if (this.list_of_graphcanvas) {\n            for (var i = 0; i < this.list_of_graphcanvas.length; ++i) {\n                var canvas = this.list_of_graphcanvas[i];\n                if (canvas.selected_nodes[node.id]) {\n                    delete canvas.selected_nodes[node.id];\n                }\n                if (canvas.node_dragged == node) {\n                    canvas.node_dragged = null;\n                }\n            }\n        }\n\n        //remove from containers\n        var pos = this._nodes.indexOf(node);\n        if (pos != -1) {\n            this._nodes.splice(pos, 1);\n        }\n        delete this._nodes_by_id[node.id];\n\n        if (this.onNodeRemoved) {\n            this.onNodeRemoved(node);\n        }\n\n\t\t//close panels\n\t\tthis.sendActionToCanvas(\"checkPanels\");\n\n        this.setDirtyCanvas(true, true);\n\t\tthis.afterChange(); //sure? - almost sure is wrong\n        this.change();\n\n        this.updateExecutionOrder();\n    };\n\n    /**\n     * Returns a node by its id.\n     * @method getNodeById\n     * @param {Number} id\n     */\n\n    LGraph.prototype.getNodeById = function(id) {\n        if (id == null) {\n            return null;\n        }\n        return this._nodes_by_id[id];\n    };\n\n    /**\n     * Returns a list of nodes that matches a class\n     * @method findNodesByClass\n     * @param {Class} classObject the class itself (not an string)\n     * @return {Array} a list with all the nodes of this type\n     */\n    LGraph.prototype.findNodesByClass = function(classObject, result) {\n        result = result || [];\n        result.length = 0;\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            if (this._nodes[i].constructor === classObject) {\n                result.push(this._nodes[i]);\n            }\n        }\n        return result;\n    };\n\n    /**\n     * Returns a list of nodes that matches a type\n     * @method findNodesByType\n     * @param {String} type the name of the node type\n     * @return {Array} a list with all the nodes of this type\n     */\n    LGraph.prototype.findNodesByType = function(type, result) {\n        var type = type.toLowerCase();\n        result = result || [];\n        result.length = 0;\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            if (this._nodes[i].type.toLowerCase() == type) {\n                result.push(this._nodes[i]);\n            }\n        }\n        return result;\n    };\n\n    /**\n     * Returns the first node that matches a name in its title\n     * @method findNodeByTitle\n     * @param {String} name the name of the node to search\n     * @return {Node} the node or null\n     */\n    LGraph.prototype.findNodeByTitle = function(title) {\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            if (this._nodes[i].title == title) {\n                return this._nodes[i];\n            }\n        }\n        return null;\n    };\n\n    /**\n     * Returns a list of nodes that matches a name\n     * @method findNodesByTitle\n     * @param {String} name the name of the node to search\n     * @return {Array} a list with all the nodes with this name\n     */\n    LGraph.prototype.findNodesByTitle = function(title) {\n        var result = [];\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            if (this._nodes[i].title == title) {\n                result.push(this._nodes[i]);\n            }\n        }\n        return result;\n    };\n\n    /**\n     * Returns the top-most node in this position of the canvas\n     * @method getNodeOnPos\n     * @param {number} x the x coordinate in canvas space\n     * @param {number} y the y coordinate in canvas space\n     * @param {Array} nodes_list a list with all the nodes to search from, by default is all the nodes in the graph\n     * @return {LGraphNode} the node at this position or null\n     */\n    LGraph.prototype.getNodeOnPos = function(x, y, nodes_list, margin) {\n        nodes_list = nodes_list || this._nodes;\n\t\tvar nRet = null;\n        for (var i = nodes_list.length - 1; i >= 0; i--) {\n            var n = nodes_list[i];\n            if (n.isPointInside(x, y, margin)) {\n                // check for lesser interest nodes (TODO check for overlapping, use the top)\n\t\t\t\t/*if (typeof n == \"LGraphGroup\"){\n\t\t\t\t\tnRet = n;\n\t\t\t\t}else{*/\n\t\t\t\t\treturn n;\n\t\t\t\t/*}*/\n            }\n        }\n        return nRet;\n    };\n\n    /**\n     * Returns the top-most group in that position\n     * @method getGroupOnPos\n     * @param {number} x the x coordinate in canvas space\n     * @param {number} y the y coordinate in canvas space\n     * @return {LGraphGroup} the group or null\n     */\n    LGraph.prototype.getGroupOnPos = function(x, y) {\n        for (var i = this._groups.length - 1; i >= 0; i--) {\n            var g = this._groups[i];\n            if (g.isPointInside(x, y, 2, true)) {\n                return g;\n            }\n        }\n        return null;\n    };\n\n    /**\n     * Checks that the node type matches the node type registered, used when replacing a nodetype by a newer version during execution\n     * this replaces the ones using the old version with the new version\n     * @method checkNodeTypes\n     */\n    LGraph.prototype.checkNodeTypes = function() {\n        var changes = false;\n        for (var i = 0; i < this._nodes.length; i++) {\n            var node = this._nodes[i];\n            var ctor = LiteGraph.registered_node_types[node.type];\n            if (node.constructor == ctor) {\n                continue;\n            }\n            console.log(\"node being replaced by newer version: \" + node.type);\n            var newnode = LiteGraph.createNode(node.type);\n            changes = true;\n            this._nodes[i] = newnode;\n            newnode.configure(node.serialize());\n            newnode.graph = this;\n            this._nodes_by_id[newnode.id] = newnode;\n            if (node.inputs) {\n                newnode.inputs = node.inputs.concat();\n            }\n            if (node.outputs) {\n                newnode.outputs = node.outputs.concat();\n            }\n        }\n        this.updateExecutionOrder();\n    };\n\n    // ********** GLOBALS *****************\n\n    LGraph.prototype.onAction = function(action, param, options) {\n        this._input_nodes = this.findNodesByClass(\n            LiteGraph.GraphInput,\n            this._input_nodes\n        );\n        for (var i = 0; i < this._input_nodes.length; ++i) {\n            var node = this._input_nodes[i];\n            if (node.properties.name != action) {\n                continue;\n            }\n            //wrap node.onAction(action, param);\n            node.actionDo(action, param, options);\n            break;\n        }\n    };\n\n    LGraph.prototype.trigger = function(action, param) {\n        if (this.onTrigger) {\n            this.onTrigger(action, param);\n        }\n    };\n\n    /**\n     * Tell this graph it has a global graph input of this type\n     * @method addGlobalInput\n     * @param {String} name\n     * @param {String} type\n     * @param {*} value [optional]\n     */\n    LGraph.prototype.addInput = function(name, type, value) {\n        var input = this.inputs[name];\n        if (input) {\n            //already exist\n            return;\n        }\n\n\t\tthis.beforeChange();\n        this.inputs[name] = { name: name, type: type, value: value };\n        this._version++;\n\t\tthis.afterChange();\n\n        if (this.onInputAdded) {\n            this.onInputAdded(name, type);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    };\n\n    /**\n     * Assign a data to the global graph input\n     * @method setGlobalInputData\n     * @param {String} name\n     * @param {*} data\n     */\n    LGraph.prototype.setInputData = function(name, data) {\n        var input = this.inputs[name];\n        if (!input) {\n            return;\n        }\n        input.value = data;\n    };\n\n    /**\n     * Returns the current value of a global graph input\n     * @method getInputData\n     * @param {String} name\n     * @return {*} the data\n     */\n    LGraph.prototype.getInputData = function(name) {\n        var input = this.inputs[name];\n        if (!input) {\n            return null;\n        }\n        return input.value;\n    };\n\n    /**\n     * Changes the name of a global graph input\n     * @method renameInput\n     * @param {String} old_name\n     * @param {String} new_name\n     */\n    LGraph.prototype.renameInput = function(old_name, name) {\n        if (name == old_name) {\n            return;\n        }\n\n        if (!this.inputs[old_name]) {\n            return false;\n        }\n\n        if (this.inputs[name]) {\n            console.error(\"there is already one input with that name\");\n            return false;\n        }\n\n        this.inputs[name] = this.inputs[old_name];\n        delete this.inputs[old_name];\n        this._version++;\n\n        if (this.onInputRenamed) {\n            this.onInputRenamed(old_name, name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    };\n\n    /**\n     * Changes the type of a global graph input\n     * @method changeInputType\n     * @param {String} name\n     * @param {String} type\n     */\n    LGraph.prototype.changeInputType = function(name, type) {\n        if (!this.inputs[name]) {\n            return false;\n        }\n\n        if (\n            this.inputs[name].type &&\n            String(this.inputs[name].type).toLowerCase() ==\n                String(type).toLowerCase()\n        ) {\n            return;\n        }\n\n        this.inputs[name].type = type;\n        this._version++;\n        if (this.onInputTypeChanged) {\n            this.onInputTypeChanged(name, type);\n        }\n    };\n\n    /**\n     * Removes a global graph input\n     * @method removeInput\n     * @param {String} name\n     * @param {String} type\n     */\n    LGraph.prototype.removeInput = function(name) {\n        if (!this.inputs[name]) {\n            return false;\n        }\n\n        delete this.inputs[name];\n        this._version++;\n\n        if (this.onInputRemoved) {\n            this.onInputRemoved(name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n        return true;\n    };\n\n    /**\n     * Creates a global graph output\n     * @method addOutput\n     * @param {String} name\n     * @param {String} type\n     * @param {*} value\n     */\n    LGraph.prototype.addOutput = function(name, type, value) {\n        this.outputs[name] = { name: name, type: type, value: value };\n        this._version++;\n\n        if (this.onOutputAdded) {\n            this.onOutputAdded(name, type);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    };\n\n    /**\n     * Assign a data to the global output\n     * @method setOutputData\n     * @param {String} name\n     * @param {String} value\n     */\n    LGraph.prototype.setOutputData = function(name, value) {\n        var output = this.outputs[name];\n        if (!output) {\n            return;\n        }\n        output.value = value;\n    };\n\n    /**\n     * Returns the current value of a global graph output\n     * @method getOutputData\n     * @param {String} name\n     * @return {*} the data\n     */\n    LGraph.prototype.getOutputData = function(name) {\n        var output = this.outputs[name];\n        if (!output) {\n            return null;\n        }\n        return output.value;\n    };\n\n    /**\n     * Renames a global graph output\n     * @method renameOutput\n     * @param {String} old_name\n     * @param {String} new_name\n     */\n    LGraph.prototype.renameOutput = function(old_name, name) {\n        if (!this.outputs[old_name]) {\n            return false;\n        }\n\n        if (this.outputs[name]) {\n            console.error(\"there is already one output with that name\");\n            return false;\n        }\n\n        this.outputs[name] = this.outputs[old_name];\n        delete this.outputs[old_name];\n        this._version++;\n\n        if (this.onOutputRenamed) {\n            this.onOutputRenamed(old_name, name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n    };\n\n    /**\n     * Changes the type of a global graph output\n     * @method changeOutputType\n     * @param {String} name\n     * @param {String} type\n     */\n    LGraph.prototype.changeOutputType = function(name, type) {\n        if (!this.outputs[name]) {\n            return false;\n        }\n\n        if (\n            this.outputs[name].type &&\n            String(this.outputs[name].type).toLowerCase() ==\n                String(type).toLowerCase()\n        ) {\n            return;\n        }\n\n        this.outputs[name].type = type;\n        this._version++;\n        if (this.onOutputTypeChanged) {\n            this.onOutputTypeChanged(name, type);\n        }\n    };\n\n    /**\n     * Removes a global graph output\n     * @method removeOutput\n     * @param {String} name\n     */\n    LGraph.prototype.removeOutput = function(name) {\n        if (!this.outputs[name]) {\n            return false;\n        }\n        delete this.outputs[name];\n        this._version++;\n\n        if (this.onOutputRemoved) {\n            this.onOutputRemoved(name);\n        }\n\n        if (this.onInputsOutputsChange) {\n            this.onInputsOutputsChange();\n        }\n        return true;\n    };\n\n    LGraph.prototype.triggerInput = function(name, value) {\n        var nodes = this.findNodesByTitle(name);\n        for (var i = 0; i < nodes.length; ++i) {\n            nodes[i].onTrigger(value);\n        }\n    };\n\n    LGraph.prototype.setCallback = function(name, func) {\n        var nodes = this.findNodesByTitle(name);\n        for (var i = 0; i < nodes.length; ++i) {\n            nodes[i].setTrigger(func);\n        }\n    };\n\n\t//used for undo, called before any change is made to the graph\n    LGraph.prototype.beforeChange = function(info) {\n        if (this.onBeforeChange) {\n            this.onBeforeChange(this,info);\n        }\n        this.sendActionToCanvas(\"onBeforeChange\", this);\n    };\n\n\t//used to resend actions, called after any change is made to the graph\n    LGraph.prototype.afterChange = function(info) {\n        if (this.onAfterChange) {\n            this.onAfterChange(this,info);\n        }\n        this.sendActionToCanvas(\"onAfterChange\", this);\n    };\n\n    LGraph.prototype.connectionChange = function(node, link_info) {\n        this.updateExecutionOrder();\n        if (this.onConnectionChange) {\n            this.onConnectionChange(node);\n        }\n        this._version++;\n        this.sendActionToCanvas(\"onConnectionChange\");\n    };\n\n    /**\n     * returns if the graph is in live mode\n     * @method isLive\n     */\n\n    LGraph.prototype.isLive = function() {\n        if (!this.list_of_graphcanvas) {\n            return false;\n        }\n\n        for (var i = 0; i < this.list_of_graphcanvas.length; ++i) {\n            var c = this.list_of_graphcanvas[i];\n            if (c.live_mode) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    /**\n     * clears the triggered slot animation in all links (stop visual animation)\n     * @method clearTriggeredSlots\n     */\n    LGraph.prototype.clearTriggeredSlots = function() {\n        for (var i in this.links) {\n            var link_info = this.links[i];\n            if (!link_info) {\n                continue;\n            }\n            if (link_info._last_time) {\n                link_info._last_time = 0;\n            }\n        }\n    };\n\n    /* Called when something visually changed (not the graph!) */\n    LGraph.prototype.change = function() {\n        if (LiteGraph.debug) {\n            console.log(\"Graph changed\");\n        }\n        this.sendActionToCanvas(\"setDirty\", [true, true]);\n        if (this.on_change) {\n            this.on_change(this);\n        }\n    };\n\n    LGraph.prototype.setDirtyCanvas = function(fg, bg) {\n        this.sendActionToCanvas(\"setDirty\", [fg, bg]);\n    };\n\n    /**\n     * Destroys a link\n     * @method removeLink\n     * @param {Number} link_id\n     */\n    LGraph.prototype.removeLink = function(link_id) {\n        var link = this.links[link_id];\n        if (!link) {\n            return;\n        }\n        var node = this.getNodeById(link.target_id);\n        if (node) {\n            node.disconnectInput(link.target_slot);\n        }\n    };\n\n    //save and recover app state ***************************************\n    /**\n     * Creates a Object containing all the info about this graph, it can be serialized\n     * @method serialize\n     * @return {Object} value of the node\n     */\n    LGraph.prototype.serialize = function() {\n        var nodes_info = [];\n        for (var i = 0, l = this._nodes.length; i < l; ++i) {\n            nodes_info.push(this._nodes[i].serialize());\n        }\n\n        //pack link info into a non-verbose format\n        var links = [];\n        for (var i in this.links) {\n            //links is an OBJECT\n            var link = this.links[i];\n            if (!link.serialize) {\n                //weird bug I havent solved yet\n                console.warn(\n                    \"weird LLink bug, link info is not a LLink but a regular object\"\n                );\n                var link2 = new LLink();\n                for (var j in link) { \n                    link2[j] = link[j];\n                }\n                this.links[i] = link2;\n                link = link2;\n            }\n\n            links.push(link.serialize());\n        }\n\n        var groups_info = [];\n        for (var i = 0; i < this._groups.length; ++i) {\n            groups_info.push(this._groups[i].serialize());\n        }\n\n        var data = {\n            last_node_id: this.last_node_id,\n            last_link_id: this.last_link_id,\n            nodes: nodes_info,\n            links: links,\n            groups: groups_info,\n            config: this.config,\n\t\t\textra: this.extra,\n            version: LiteGraph.VERSION\n        };\n\n\t\tif(this.onSerialize)\n\t\t\tthis.onSerialize(data);\n\n        return data;\n    };\n\n    /**\n     * Configure a graph from a JSON string\n     * @method configure\n     * @param {String} str configure a graph from a JSON string\n     * @param {Boolean} returns if there was any error parsing\n     */\n    LGraph.prototype.configure = function(data, keep_old) {\n        if (!data) {\n            return;\n        }\n\n        if (!keep_old) {\n            this.clear();\n        }\n\n        var nodes = data.nodes;\n\n        //decode links info (they are very verbose)\n        if (data.links && data.links.constructor === Array) {\n            var links = [];\n            for (var i = 0; i < data.links.length; ++i) {\n                var link_data = data.links[i];\n\t\t\t\tif(!link_data) //weird bug\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(\"serialized graph link data contains errors, skipping.\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n                var link = new LLink();\n                link.configure(link_data);\n                links[link.id] = link;\n            }\n            data.links = links;\n        }\n\n        //copy all stored fields\n        for (var i in data) {\n\t\t\tif(i == \"nodes\" || i == \"groups\" ) //links must be accepted\n\t\t\t\tcontinue;\n            this[i] = data[i];\n        }\n\n        var error = false;\n\n        //create nodes\n        this._nodes = [];\n        if (nodes) {\n            for (var i = 0, l = nodes.length; i < l; ++i) {\n                var n_info = nodes[i]; //stored info\n                var node = LiteGraph.createNode(n_info.type, n_info.title);\n                if (!node) {\n                    if (LiteGraph.debug) {\n                        console.log(\n                            \"Node not found or has errors: \" + n_info.type\n                        );\n                    }\n\n                    //in case of error we create a replacement node to avoid losing info\n                    node = new LGraphNode();\n                    node.last_serialization = n_info;\n                    node.has_errors = true;\n                    error = true;\n                    //continue;\n                }\n\n                node.id = n_info.id; //id it or it will create a new id\n                this.add(node, true); //add before configure, otherwise configure cannot create links\n            }\n\n            //configure nodes afterwards so they can reach each other\n            for (var i = 0, l = nodes.length; i < l; ++i) {\n                var n_info = nodes[i];\n                var node = this.getNodeById(n_info.id);\n                if (node) {\n                    node.configure(n_info);\n                }\n            }\n        }\n\n        //groups\n        this._groups.length = 0;\n        if (data.groups) {\n            for (var i = 0; i < data.groups.length; ++i) {\n                var group = new LiteGraph.LGraphGroup();\n                group.configure(data.groups[i]);\n                this.add(group);\n            }\n        }\n\n        this.updateExecutionOrder();\n\n\t\tthis.extra = data.extra || {};\n\n\t\tif(this.onConfigure)\n\t\t\tthis.onConfigure(data);\n\n        this._version++;\n        this.setDirtyCanvas(true, true);\n        return error;\n    };\n\n    LGraph.prototype.load = function(url, callback) {\n        var that = this;\n\n\t\t//from file\n\t\tif(url.constructor === File || url.constructor === Blob)\n\t\t{\n\t\t\tvar reader = new FileReader();\n\t\t\treader.addEventListener('load', function(event) {\n\t\t\t\tvar data = JSON.parse(event.target.result);\n\t\t\t\tthat.configure(data);\n\t\t\t\tif(callback)\n\t\t\t\t\tcallback();\n\t\t\t});\n\t\t\t\n\t\t\treader.readAsText(url);\n\t\t\treturn;\n\t\t}\n\n\t\t//is a string, then an URL\n        var req = new XMLHttpRequest();\n        req.open(\"GET\", url, true);\n        req.send(null);\n        req.onload = function(oEvent) {\n            if (req.status !== 200) {\n                console.error(\"Error loading graph:\", req.status, req.response);\n                return;\n            }\n            var data = JSON.parse( req.response );\n            that.configure(data);\n\t\t\tif(callback)\n\t\t\t\tcallback();\n        };\n        req.onerror = function(err) {\n            console.error(\"Error loading graph:\", err);\n        };\n    };\n\n    LGraph.prototype.onNodeTrace = function(node, msg, color) {\n        //TODO\n    };\n\n    //this is the class in charge of storing link information\n    function LLink(id, type, origin_id, origin_slot, target_id, target_slot) {\n        this.id = id;\n        this.type = type;\n        this.origin_id = origin_id;\n        this.origin_slot = origin_slot;\n        this.target_id = target_id;\n        this.target_slot = target_slot;\n\n        this._data = null;\n        this._pos = new Float32Array(2); //center\n    }\n\n    LLink.prototype.configure = function(o) {\n        if (o.constructor === Array) {\n            this.id = o[0];\n            this.origin_id = o[1];\n            this.origin_slot = o[2];\n            this.target_id = o[3];\n            this.target_slot = o[4];\n            this.type = o[5];\n        } else {\n            this.id = o.id;\n            this.type = o.type;\n            this.origin_id = o.origin_id;\n            this.origin_slot = o.origin_slot;\n            this.target_id = o.target_id;\n            this.target_slot = o.target_slot;\n        }\n    };\n\n    LLink.prototype.serialize = function() {\n        return [\n            this.id,\n            this.origin_id,\n            this.origin_slot,\n            this.target_id,\n            this.target_slot,\n            this.type\n        ];\n    };\n\n    LiteGraph.LLink = LLink;\n\n    // *************************************************************\n    //   Node CLASS                                          *******\n    // *************************************************************\n\n    /*\n\ttitle: string\n\tpos: [x,y]\n\tsize: [x,y]\n\n\tinput|output: every connection\n\t\t+  { name:string, type:string, pos: [x,y]=Optional, direction: \"input\"|\"output\", links: Array });\n\n\tgeneral properties:\n\t\t+ clip_area: if you render outside the node, it will be clipped\n\t\t+ unsafe_execution: not allowed for safe execution\n\t\t+ skip_repeated_outputs: when adding new outputs, it wont show if there is one already connected\n\t\t+ resizable: if set to false it wont be resizable with the mouse\n\t\t+ horizontal: slots are distributed horizontally\n\t\t+ widgets_start_y: widgets start at y distance from the top of the node\n\t\n\tflags object:\n\t\t+ collapsed: if it is collapsed\n\n\tsupported callbacks:\n\t\t+ onAdded: when added to graph (warning: this is called BEFORE the node is configured when loading)\n\t\t+ onRemoved: when removed from graph\n\t\t+ onStart:\twhen the graph starts playing\n\t\t+ onStop:\twhen the graph stops playing\n\t\t+ onDrawForeground: render the inside widgets inside the node\n\t\t+ onDrawBackground: render the background area inside the node (only in edit mode)\n\t\t+ onMouseDown\n\t\t+ onMouseMove\n\t\t+ onMouseUp\n\t\t+ onMouseEnter\n\t\t+ onMouseLeave\n\t\t+ onExecute: execute the node\n\t\t+ onPropertyChanged: when a property is changed in the panel (return true to skip default behaviour)\n\t\t+ onGetInputs: returns an array of possible inputs\n\t\t+ onGetOutputs: returns an array of possible outputs\n\t\t+ onBounding: in case this node has a bigger bounding than the node itself (the callback receives the bounding as [x,y,w,h])\n\t\t+ onDblClick: double clicked in the node\n\t\t+ onInputDblClick: input slot double clicked (can be used to automatically create a node connected)\n\t\t+ onOutputDblClick: output slot double clicked (can be used to automatically create a node connected)\n\t\t+ onConfigure: called after the node has been configured\n\t\t+ onSerialize: to add extra info when serializing (the callback receives the object that should be filled with the data)\n\t\t+ onSelected\n\t\t+ onDeselected\n\t\t+ onDropItem : DOM item dropped over the node\n\t\t+ onDropFile : file dropped over the node\n\t\t+ onConnectInput : if returns false the incoming connection will be canceled\n\t\t+ onConnectionsChange : a connection changed (new one or removed) (LiteGraph.INPUT or LiteGraph.OUTPUT, slot, true if connected, link_info, input_info )\n\t\t+ onAction: action slot triggered\n\t\t+ getExtraMenuOptions: to add option to context menu\n*/\n\n    /**\n     * Base Class for all the node type classes\n     * @class LGraphNode\n     * @param {String} name a name for the node\n     */\n\n    function LGraphNode(title) {\n        this._ctor(title);\n    }\n\n    global.LGraphNode = LiteGraph.LGraphNode = LGraphNode;\n\n    LGraphNode.prototype._ctor = function(title) {\n        this.title = title || \"Unnamed\";\n        this.size = [LiteGraph.NODE_WIDTH, 60];\n        this.graph = null;\n\n        this._pos = new Float32Array(10, 10);\n\n        Object.defineProperty(this, \"pos\", {\n            set: function(v) {\n                if (!v || v.length < 2) {\n                    return;\n                }\n                this._pos[0] = v[0];\n                this._pos[1] = v[1];\n            },\n            get: function() {\n                return this._pos;\n            },\n            enumerable: true\n        });\n\n        this.id = -1; //not know till not added\n        this.type = null;\n\n        //inputs available: array of inputs\n        this.inputs = [];\n        this.outputs = [];\n        this.connections = [];\n\n        //local data\n        this.properties = {}; //for the values\n        this.properties_info = []; //for the info\n\n        this.flags = {};\n    };\n\n    /**\n     * configure a node from an object containing the serialized info\n     * @method configure\n     */\n    LGraphNode.prototype.configure = function(info) {\n        if (this.graph) {\n            this.graph._version++;\n        }\n        for (var j in info) {\n            if (j == \"properties\") {\n                //i don't want to clone properties, I want to reuse the old container\n                for (var k in info.properties) {\n                    this.properties[k] = info.properties[k];\n                    if (this.onPropertyChanged) {\n                        this.onPropertyChanged( k, info.properties[k] );\n                    }\n                }\n                continue;\n            }\n\n            if (info[j] == null) {\n                continue;\n            } else if (typeof info[j] == \"object\") {\n                //object\n                if (this[j] && this[j].configure) {\n                    this[j].configure(info[j]);\n                } else {\n                    this[j] = LiteGraph.cloneObject(info[j], this[j]);\n                }\n            } //value\n            else {\n                this[j] = info[j];\n            }\n        }\n\n        if (!info.title) {\n            this.title = this.constructor.title;\n        }\n\n\t\tif (this.inputs) {\n\t\t\tfor (var i = 0; i < this.inputs.length; ++i) {\n\t\t\t\tvar input = this.inputs[i];\n\t\t\t\tvar link_info = this.graph ? this.graph.links[input.link] : null;\n\t\t\t\tif (this.onConnectionsChange)\n\t\t\t\t\tthis.onConnectionsChange( LiteGraph.INPUT, i, true, link_info, input ); //link_info has been created now, so its updated\n\n\t\t\t\tif( this.onInputAdded )\n\t\t\t\t\tthis.onInputAdded(input);\n\n\t\t\t}\n\t\t}\n\n\t\tif (this.outputs) {\n\t\t\tfor (var i = 0; i < this.outputs.length; ++i) {\n\t\t\t\tvar output = this.outputs[i];\n\t\t\t\tif (!output.links) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tfor (var j = 0; j < output.links.length; ++j) {\n\t\t\t\t\tvar link_info = this.graph \t? this.graph.links[output.links[j]] : null;\n\t\t\t\t\tif (this.onConnectionsChange)\n\t\t\t\t\t\tthis.onConnectionsChange( LiteGraph.OUTPUT, i, true, link_info, output ); //link_info has been created now, so its updated\n\t\t\t\t}\n\n\t\t\t\tif( this.onOutputAdded )\n\t\t\t\t\tthis.onOutputAdded(output);\n\t\t\t}\n        }\n\n\t\tif( this.widgets )\n\t\t{\n\t\t\tfor (var i = 0; i < this.widgets.length; ++i)\n\t\t\t{\n\t\t\t\tvar w = this.widgets[i];\n\t\t\t\tif(!w)\n\t\t\t\t\tcontinue;\n\t\t\t\tif(w.options && w.options.property && this.properties[ w.options.property ])\n\t\t\t\t\tw.value = JSON.parse( JSON.stringify( this.properties[ w.options.property ] ) );\n\t\t\t}\n\t\t\tif (info.widgets_values) {\n\t\t\t\tfor (var i = 0; i < info.widgets_values.length; ++i) {\n\t\t\t\t\tif (this.widgets[i]) {\n\t\t\t\t\t\tthis.widgets[i].value = info.widgets_values[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n        if (this.onConfigure) {\n            this.onConfigure(info);\n        }\n    };\n\n    /**\n     * serialize the content\n     * @method serialize\n     */\n\n    LGraphNode.prototype.serialize = function() {\n        //create serialization object\n        var o = {\n            id: this.id,\n            type: this.type,\n            pos: this.pos,\n            size: this.size,\n            flags: LiteGraph.cloneObject(this.flags),\n\t\t\torder: this.order,\n            mode: this.mode\n        };\n\n        //special case for when there were errors\n        if (this.constructor === LGraphNode && this.last_serialization) {\n            return this.last_serialization;\n        }\n\n        if (this.inputs) {\n            o.inputs = this.inputs;\n        }\n\n        if (this.outputs) {\n            //clear outputs last data (because data in connections is never serialized but stored inside the outputs info)\n            for (var i = 0; i < this.outputs.length; i++) {\n                delete this.outputs[i]._data;\n            }\n            o.outputs = this.outputs;\n        }\n\n        if (this.title && this.title != this.constructor.title) {\n            o.title = this.title;\n        }\n\n        if (this.properties) {\n            o.properties = LiteGraph.cloneObject(this.properties);\n        }\n\n        if (this.widgets && this.serialize_widgets) {\n            o.widgets_values = [];\n            for (var i = 0; i < this.widgets.length; ++i) {\n\t\t\t\tif(this.widgets[i])\n\t                o.widgets_values[i] = this.widgets[i].value;\n\t\t\t\telse\n\t\t\t\t\to.widgets_values[i] = null;\n            }\n        }\n\n        if (!o.type) {\n            o.type = this.constructor.type;\n        }\n\n        if (this.color) {\n            o.color = this.color;\n        }\n        if (this.bgcolor) {\n            o.bgcolor = this.bgcolor;\n        }\n        if (this.boxcolor) {\n            o.boxcolor = this.boxcolor;\n        }\n        if (this.shape) {\n            o.shape = this.shape;\n        }\n\n        if (this.onSerialize) {\n            if (this.onSerialize(o)) {\n                console.warn(\n                    \"node onSerialize shouldnt return anything, data should be stored in the object pass in the first parameter\"\n                );\n            }\n        }\n\n        return o;\n    };\n\n    /* Creates a clone of this node */\n    LGraphNode.prototype.clone = function() {\n        var node = LiteGraph.createNode(this.type);\n        if (!node) {\n            return null;\n        }\n\n        //we clone it because serialize returns shared containers\n        var data = LiteGraph.cloneObject(this.serialize());\n\n        //remove links\n        if (data.inputs) {\n            for (var i = 0; i < data.inputs.length; ++i) {\n                data.inputs[i].link = null;\n            }\n        }\n\n        if (data.outputs) {\n            for (var i = 0; i < data.outputs.length; ++i) {\n                if (data.outputs[i].links) {\n                    data.outputs[i].links.length = 0;\n                }\n            }\n        }\n\n        delete data[\"id\"];\n        //remove links\n        node.configure(data);\n\n        return node;\n    };\n\n    /**\n     * serialize and stringify\n     * @method toString\n     */\n\n    LGraphNode.prototype.toString = function() {\n        return JSON.stringify(this.serialize());\n    };\n    //LGraphNode.prototype.deserialize = function(info) {} //this cannot be done from within, must be done in LiteGraph\n\n    /**\n     * get the title string\n     * @method getTitle\n     */\n\n    LGraphNode.prototype.getTitle = function() {\n        return this.title || this.constructor.title;\n    };\n\n    /**\n     * sets the value of a property\n     * @method setProperty\n     * @param {String} name\n     * @param {*} value\n     */\n    LGraphNode.prototype.setProperty = function(name, value) {\n        if (!this.properties) {\n            this.properties = {};\n        }\n\t\tif( value === this.properties[name] )\n\t\t\treturn;\n\t\tvar prev_value = this.properties[name];\n        this.properties[name] = value;\n        if (this.onPropertyChanged) {\n            if( this.onPropertyChanged(name, value, prev_value) === false ) //abort change\n\t\t\t\tthis.properties[name] = prev_value;\n        }\n\t\tif(this.widgets) //widgets could be linked to properties\n\t\t\tfor(var i = 0; i < this.widgets.length; ++i)\n\t\t\t{\n\t\t\t\tvar w = this.widgets[i];\n\t\t\t\tif(!w)\n\t\t\t\t\tcontinue;\n\t\t\t\tif(w.options.property == name)\n\t\t\t\t{\n\t\t\t\t\tw.value = value;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n    };\n\n    // Execution *************************\n    /**\n     * sets the output data\n     * @method setOutputData\n     * @param {number} slot\n     * @param {*} data\n     */\n    LGraphNode.prototype.setOutputData = function(slot, data) {\n        if (!this.outputs) {\n            return;\n        }\n\n        //this maybe slow and a niche case\n        //if(slot && slot.constructor === String)\n        //\tslot = this.findOutputSlot(slot);\n\n        if (slot == -1 || slot >= this.outputs.length) {\n            return;\n        }\n\n        var output_info = this.outputs[slot];\n        if (!output_info) {\n            return;\n        }\n\n        //store data in the output itself in case we want to debug\n        output_info._data = data;\n\n        //if there are connections, pass the data to the connections\n        if (this.outputs[slot].links) {\n            for (var i = 0; i < this.outputs[slot].links.length; i++) {\n                var link_id = this.outputs[slot].links[i];\n\t\t\t\tvar link = this.graph.links[link_id];\n\t\t\t\tif(link)\n\t\t\t\t\tlink.data = data;\n            }\n        }\n    };\n\n    /**\n     * sets the output data type, useful when you want to be able to overwrite the data type\n     * @method setOutputDataType\n     * @param {number} slot\n     * @param {String} datatype\n     */\n    LGraphNode.prototype.setOutputDataType = function(slot, type) {\n        if (!this.outputs) {\n            return;\n        }\n        if (slot == -1 || slot >= this.outputs.length) {\n            return;\n        }\n        var output_info = this.outputs[slot];\n        if (!output_info) {\n            return;\n        }\n        //store data in the output itself in case we want to debug\n        output_info.type = type;\n\n        //if there are connections, pass the data to the connections\n        if (this.outputs[slot].links) {\n            for (var i = 0; i < this.outputs[slot].links.length; i++) {\n                var link_id = this.outputs[slot].links[i];\n                this.graph.links[link_id].type = type;\n            }\n        }\n    };\n\n    /**\n     * Retrieves the input data (data traveling through the connection) from one slot\n     * @method getInputData\n     * @param {number} slot\n     * @param {boolean} force_update if set to true it will force the connected node of this slot to output data into this link\n     * @return {*} data or if it is not connected returns undefined\n     */\n    LGraphNode.prototype.getInputData = function(slot, force_update) {\n        if (!this.inputs) {\n            return;\n        } //undefined;\n\n        if (slot >= this.inputs.length || this.inputs[slot].link == null) {\n            return;\n        }\n\n        var link_id = this.inputs[slot].link;\n        var link = this.graph.links[link_id];\n        if (!link) {\n            //bug: weird case but it happens sometimes\n            return null;\n        }\n\n        if (!force_update) {\n            return link.data;\n        }\n\n        //special case: used to extract data from the incoming connection before the graph has been executed\n        var node = this.graph.getNodeById(link.origin_id);\n        if (!node) {\n            return link.data;\n        }\n\n        if (node.updateOutputData) {\n            node.updateOutputData(link.origin_slot);\n        } else if (node.onExecute) {\n            node.onExecute();\n        }\n\n        return link.data;\n    };\n\n    /**\n     * Retrieves the input data type (in case this supports multiple input types)\n     * @method getInputDataType\n     * @param {number} slot\n     * @return {String} datatype in string format\n     */\n    LGraphNode.prototype.getInputDataType = function(slot) {\n        if (!this.inputs) {\n            return null;\n        } //undefined;\n\n        if (slot >= this.inputs.length || this.inputs[slot].link == null) {\n            return null;\n        }\n        var link_id = this.inputs[slot].link;\n        var link = this.graph.links[link_id];\n        if (!link) {\n            //bug: weird case but it happens sometimes\n            return null;\n        }\n        var node = this.graph.getNodeById(link.origin_id);\n        if (!node) {\n            return link.type;\n        }\n        var output_info = node.outputs[link.origin_slot];\n        if (output_info) {\n            return output_info.type;\n        }\n        return null;\n    };\n\n    /**\n     * Retrieves the input data from one slot using its name instead of slot number\n     * @method getInputDataByName\n     * @param {String} slot_name\n     * @param {boolean} force_update if set to true it will force the connected node of this slot to output data into this link\n     * @return {*} data or if it is not connected returns null\n     */\n    LGraphNode.prototype.getInputDataByName = function(\n        slot_name,\n        force_update\n    ) {\n        var slot = this.findInputSlot(slot_name);\n        if (slot == -1) {\n            return null;\n        }\n        return this.getInputData(slot, force_update);\n    };\n\n    /**\n     * tells you if there is a connection in one input slot\n     * @method isInputConnected\n     * @param {number} slot\n     * @return {boolean}\n     */\n    LGraphNode.prototype.isInputConnected = function(slot) {\n        if (!this.inputs) {\n            return false;\n        }\n        return slot < this.inputs.length && this.inputs[slot].link != null;\n    };\n\n    /**\n     * tells you info about an input connection (which node, type, etc)\n     * @method getInputInfo\n     * @param {number} slot\n     * @return {Object} object or null { link: id, name: string, type: string or 0 }\n     */\n    LGraphNode.prototype.getInputInfo = function(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot < this.inputs.length) {\n            return this.inputs[slot];\n        }\n        return null;\n    };\n\n    /**\n     * Returns the link info in the connection of an input slot\n     * @method getInputLink\n     * @param {number} slot\n     * @return {LLink} object or null\n     */\n    LGraphNode.prototype.getInputLink = function(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot < this.inputs.length) {\n            var slot_info = this.inputs[slot];\n\t\t\treturn this.graph.links[ slot_info.link ];\n        }\n        return null;\n    };\n\n    /**\n     * returns the node connected in the input slot\n     * @method getInputNode\n     * @param {number} slot\n     * @return {LGraphNode} node or null\n     */\n    LGraphNode.prototype.getInputNode = function(slot) {\n        if (!this.inputs) {\n            return null;\n        }\n        if (slot >= this.inputs.length) {\n            return null;\n        }\n        var input = this.inputs[slot];\n        if (!input || input.link === null) {\n            return null;\n        }\n        var link_info = this.graph.links[input.link];\n        if (!link_info) {\n            return null;\n        }\n        return this.graph.getNodeById(link_info.origin_id);\n    };\n\n    /**\n     * returns the value of an input with this name, otherwise checks if there is a property with that name\n     * @method getInputOrProperty\n     * @param {string} name\n     * @return {*} value\n     */\n    LGraphNode.prototype.getInputOrProperty = function(name) {\n        if (!this.inputs || !this.inputs.length) {\n            return this.properties ? this.properties[name] : null;\n        }\n\n        for (var i = 0, l = this.inputs.length; i < l; ++i) {\n            var input_info = this.inputs[i];\n            if (name == input_info.name && input_info.link != null) {\n                var link = this.graph.links[input_info.link];\n                if (link) {\n                    return link.data;\n                }\n            }\n        }\n        return this.properties[name];\n    };\n\n    /**\n     * tells you the last output data that went in that slot\n     * @method getOutputData\n     * @param {number} slot\n     * @return {Object}  object or null\n     */\n    LGraphNode.prototype.getOutputData = function(slot) {\n        if (!this.outputs) {\n            return null;\n        }\n        if (slot >= this.outputs.length) {\n            return null;\n        }\n\n        var info = this.outputs[slot];\n        return info._data;\n    };\n\n    /**\n     * tells you info about an output connection (which node, type, etc)\n     * @method getOutputInfo\n     * @param {number} slot\n     * @return {Object}  object or null { name: string, type: string, links: [ ids of links in number ] }\n     */\n    LGraphNode.prototype.getOutputInfo = function(slot) {\n        if (!this.outputs) {\n            return null;\n        }\n        if (slot < this.outputs.length) {\n            return this.outputs[slot];\n        }\n        return null;\n    };\n\n    /**\n     * tells you if there is a connection in one output slot\n     * @method isOutputConnected\n     * @param {number} slot\n     * @return {boolean}\n     */\n    LGraphNode.prototype.isOutputConnected = function(slot) {\n        if (!this.outputs) {\n            return false;\n        }\n        return (\n            slot < this.outputs.length &&\n            this.outputs[slot].links &&\n            this.outputs[slot].links.length\n        );\n    };\n\n    /**\n     * tells you if there is any connection in the output slots\n     * @method isAnyOutputConnected\n     * @return {boolean}\n     */\n    LGraphNode.prototype.isAnyOutputConnected = function() {\n        if (!this.outputs) {\n            return false;\n        }\n        for (var i = 0; i < this.outputs.length; ++i) {\n            if (this.outputs[i].links && this.outputs[i].links.length) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    /**\n     * retrieves all the nodes connected to this output slot\n     * @method getOutputNodes\n     * @param {number} slot\n     * @return {array}\n     */\n    LGraphNode.prototype.getOutputNodes = function(slot) {\n        if (!this.outputs || this.outputs.length == 0) {\n            return null;\n        }\n\n        if (slot >= this.outputs.length) {\n            return null;\n        }\n\n        var output = this.outputs[slot];\n        if (!output.links || output.links.length == 0) {\n            return null;\n        }\n\n        var r = [];\n        for (var i = 0; i < output.links.length; i++) {\n            var link_id = output.links[i];\n            var link = this.graph.links[link_id];\n            if (link) {\n                var target_node = this.graph.getNodeById(link.target_id);\n                if (target_node) {\n                    r.push(target_node);\n                }\n            }\n        }\n        return r;\n    };\n\n    LGraphNode.prototype.addOnTriggerInput = function(){\n        var trigS = this.findInputSlot(\"onTrigger\");\n        if (trigS == -1){ //!trigS || \n            var input = this.addInput(\"onTrigger\", LiteGraph.EVENT, {optional: true, nameLocked: true});\n            return this.findInputSlot(\"onTrigger\");\n        }\n        return trigS;\n    }\n    \n    LGraphNode.prototype.addOnExecutedOutput = function(){\n        var trigS = this.findOutputSlot(\"onExecuted\");\n        if (trigS == -1){ //!trigS || \n            var output = this.addOutput(\"onExecuted\", LiteGraph.ACTION, {optional: true, nameLocked: true});\n            return this.findOutputSlot(\"onExecuted\");\n        }\n        return trigS;\n    }\n    \n    LGraphNode.prototype.onAfterExecuteNode = function(param, options){\n        var trigS = this.findOutputSlot(\"onExecuted\");\n        if (trigS != -1){\n            \n            //console.debug(this.id+\":\"+this.order+\" triggering slot onAfterExecute\");\n            //console.debug(param);\n            //console.debug(options);\n            this.triggerSlot(trigS, param, null, options);\n            \n        }\n    }    \n    \n    LGraphNode.prototype.changeMode = function(modeTo){\n        switch(modeTo){\n            case LiteGraph.ON_EVENT:\n                // this.addOnExecutedOutput();\n                break;\n                \n            case LiteGraph.ON_TRIGGER:\n                this.addOnTriggerInput();\n                this.addOnExecutedOutput();\n                break;\n                \n            case LiteGraph.NEVER:\n                break;\n                \n            case LiteGraph.ALWAYS:\n                break;\n                \n            case LiteGraph.ON_REQUEST:\n                break;\n            \n            default:\n                return false;\n                break;\n        }\n        this.mode = modeTo;\n        return true;\n    };\n    \n    /**\n     * Triggers the node code execution, place a boolean/counter to mark the node as being executed\n     * @method execute\n     * @param {*} param\n     * @param {*} options\n     */\n    LGraphNode.prototype.doExecute = function(param, options) {\n        options = options || {};\n        if (this.onExecute){\n            \n            // enable this to give the event an ID\n\t\t\tif (!options.action_call) options.action_call = this.id+\"_exec_\"+Math.floor(Math.random()*9999);\n            \n            this.graph.nodes_executing[this.id] = true; //.push(this.id);\n\n            this.onExecute(param, options);\n            \n            this.graph.nodes_executing[this.id] = false; //.pop();\n            \n            // save execution/action ref\n            this.exec_version = this.graph.iteration;\n            if(options && options.action_call){\n                this.action_call = options.action_call; // if (param)\n                this.graph.nodes_executedAction[this.id] = options.action_call;\n            }\n        }\n        this.execute_triggered = 2; // the nFrames it will be used (-- each step), means \"how old\" is the event\n        if(this.onAfterExecuteNode) this.onAfterExecuteNode(param, options); // callback\n    };\n    \n    /**\n     * Triggers an action, wrapped by logics to control execution flow\n     * @method actionDo\n     * @param {String} action name\n     * @param {*} param\n     */\n    LGraphNode.prototype.actionDo = function(action, param, options) {\n        options = options || {};\n        if (this.onAction){\n            \n\t\t\t// enable this to give the event an ID\n            if (!options.action_call) options.action_call = this.id+\"_\"+(action?action:\"action\")+\"_\"+Math.floor(Math.random()*9999);\n            \n            this.graph.nodes_actioning[this.id] = (action?action:\"actioning\"); //.push(this.id);\n            \n            this.onAction(action, param, options);\n            \n            this.graph.nodes_actioning[this.id] = false; //.pop();\n            \n            // save execution/action ref\n            if(options && options.action_call){\n                this.action_call = options.action_call; // if (param)\n                this.graph.nodes_executedAction[this.id] = options.action_call;\n            }\n        }\n        this.action_triggered = 2; // the nFrames it will be used (-- each step), means \"how old\" is the event\n        if(this.onAfterExecuteNode) this.onAfterExecuteNode(param, options);\n    };\n    \n    /**\n     * Triggers an event in this node, this will trigger any output with the same name\n     * @method trigger\n     * @param {String} event name ( \"on_play\", ... ) if action is equivalent to false then the event is send to all\n     * @param {*} param\n     */\n    LGraphNode.prototype.trigger = function(action, param, options) {\n        if (!this.outputs || !this.outputs.length) {\n            return;\n        }\n\n        if (this.graph)\n            this.graph._last_trigger_time = LiteGraph.getTime();\n\n        for (var i = 0; i < this.outputs.length; ++i) {\n            var output = this.outputs[i];\n            if ( !output || output.type !== LiteGraph.EVENT || (action && output.name != action) )\n                continue;\n            this.triggerSlot(i, param, null, options);\n        }\n    };\n\n    /**\n     * Triggers a slot event in this node: cycle output slots and launch execute/action on connected nodes\n     * @method triggerSlot\n     * @param {Number} slot the index of the output slot\n     * @param {*} param\n     * @param {Number} link_id [optional] in case you want to trigger and specific output link in a slot\n     */\n    LGraphNode.prototype.triggerSlot = function(slot, param, link_id, options) {\n        options = options || {};\n        if (!this.outputs) {\n            return;\n        }\n\n        var output = this.outputs[slot];\n        if (!output) {\n            return;\n        }\n\n        var links = output.links;\n        if (!links || !links.length) {\n            return;\n        }\n\n        if (this.graph) {\n            this.graph._last_trigger_time = LiteGraph.getTime();\n        }\n\n        //for every link attached here\n        for (var k = 0; k < links.length; ++k) {\n            var id = links[k];\n            if (link_id != null && link_id != id) {\n                //to skip links\n                continue;\n            }\n            var link_info = this.graph.links[links[k]];\n            if (!link_info) {\n                //not connected\n                continue;\n            }\n            link_info._last_time = LiteGraph.getTime();\n            var node = this.graph.getNodeById(link_info.target_id);\n            if (!node) {\n                //node not found?\n                continue;\n            }\n\n            //used to mark events in graph\n            var target_connection = node.inputs[link_info.target_slot];\n\n\t\t\tif (node.mode === LiteGraph.ON_TRIGGER)\n\t\t\t{\n\t\t\t\t// generate unique trigger ID if not present\n\t\t\t\tif (!options.action_call) options.action_call = this.id+\"_trigg_\"+Math.floor(Math.random()*9999);\n                if (node.onExecute) {\n                    // -- wrapping node.onExecute(param); --\n                    node.doExecute(param, options);\n                }\n\t\t\t}\n\t\t\telse if (node.onAction) {\n                // generate unique action ID if not present\n\t\t\t\tif (!options.action_call) options.action_call = this.id+\"_act_\"+Math.floor(Math.random()*9999);\n                //pass the action name\n                var target_connection = node.inputs[link_info.target_slot];\n\t\t\t\t// wrap node.onAction(target_connection.name, param);\n                node.actionDo(target_connection.name, param, options);\n            }\n        }\n    };\n\n    /**\n     * clears the trigger slot animation\n     * @method clearTriggeredSlot\n     * @param {Number} slot the index of the output slot\n     * @param {Number} link_id [optional] in case you want to trigger and specific output link in a slot\n     */\n    LGraphNode.prototype.clearTriggeredSlot = function(slot, link_id) {\n        if (!this.outputs) {\n            return;\n        }\n\n        var output = this.outputs[slot];\n        if (!output) {\n            return;\n        }\n\n        var links = output.links;\n        if (!links || !links.length) {\n            return;\n        }\n\n        //for every link attached here\n        for (var k = 0; k < links.length; ++k) {\n            var id = links[k];\n            if (link_id != null && link_id != id) {\n                //to skip links\n                continue;\n            }\n            var link_info = this.graph.links[links[k]];\n            if (!link_info) {\n                //not connected\n                continue;\n            }\n            link_info._last_time = 0;\n        }\n    };\n\n    /**\n     * changes node size and triggers callback\n     * @method setSize\n     * @param {vec2} size\n     */\n    LGraphNode.prototype.setSize = function(size)\n\t{\n\t\tthis.size = size;\n\t\tif(this.onResize)\n\t\t\tthis.onResize(this.size);\n\t}\n\n    /**\n     * add a new property to this node\n     * @method addProperty\n     * @param {string} name\n     * @param {*} default_value\n     * @param {string} type string defining the output type (\"vec3\",\"number\",...)\n     * @param {Object} extra_info this can be used to have special properties of the property (like values, etc)\n     */\n    LGraphNode.prototype.addProperty = function(\n        name,\n        default_value,\n        type,\n        extra_info\n    ) {\n        var o = { name: name, type: type, default_value: default_value };\n        if (extra_info) {\n            for (var i in extra_info) {\n                o[i] = extra_info[i];\n            }\n        }\n        if (!this.properties_info) {\n            this.properties_info = [];\n        }\n        this.properties_info.push(o);\n        if (!this.properties) {\n            this.properties = {};\n        }\n        this.properties[name] = default_value;\n        return o;\n    };\n\n    //connections\n\n    /**\n     * add a new output slot to use in this node\n     * @method addOutput\n     * @param {string} name\n     * @param {string} type string defining the output type (\"vec3\",\"number\",...)\n     * @param {Object} extra_info this can be used to have special properties of an output (label, special color, position, etc)\n     */\n    LGraphNode.prototype.addOutput = function(name, type, extra_info) {\n        var output = { name: name, type: type, links: null };\n        if (extra_info) {\n            for (var i in extra_info) {\n                output[i] = extra_info[i];\n            }\n        }\n\n        if (!this.outputs) {\n            this.outputs = [];\n        }\n        this.outputs.push(output);\n        if (this.onOutputAdded) {\n            this.onOutputAdded(output);\n        }\n        \n        if (LiteGraph.auto_load_slot_types) LiteGraph.registerNodeAndSlotType(this,type,true);\n        \n        this.setSize( this.computeSize() );\n        this.setDirtyCanvas(true, true);\n        return output;\n    };\n\n    /**\n     * add a new output slot to use in this node\n     * @method addOutputs\n     * @param {Array} array of triplets like [[name,type,extra_info],[...]]\n     */\n    LGraphNode.prototype.addOutputs = function(array) {\n        for (var i = 0; i < array.length; ++i) {\n            var info = array[i];\n            var o = { name: info[0], type: info[1], link: null };\n            if (array[2]) {\n                for (var j in info[2]) {\n                    o[j] = info[2][j];\n                }\n            }\n\n            if (!this.outputs) {\n                this.outputs = [];\n            }\n            this.outputs.push(o);\n            if (this.onOutputAdded) {\n                this.onOutputAdded(o);\n            }\n            \n            if (LiteGraph.auto_load_slot_types) LiteGraph.registerNodeAndSlotType(this,info[1],true);\n            \n        }\n\n        this.setSize( this.computeSize() );\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * remove an existing output slot\n     * @method removeOutput\n     * @param {number} slot\n     */\n    LGraphNode.prototype.removeOutput = function(slot) {\n        this.disconnectOutput(slot);\n        this.outputs.splice(slot, 1);\n        for (var i = slot; i < this.outputs.length; ++i) {\n            if (!this.outputs[i] || !this.outputs[i].links) {\n                continue;\n            }\n            var links = this.outputs[i].links;\n            for (var j = 0; j < links.length; ++j) {\n                var link = this.graph.links[links[j]];\n                if (!link) {\n                    continue;\n                }\n                link.origin_slot -= 1;\n            }\n        }\n\n        this.setSize( this.computeSize() );\n        if (this.onOutputRemoved) {\n            this.onOutputRemoved(slot);\n        }\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * add a new input slot to use in this node\n     * @method addInput\n     * @param {string} name\n     * @param {string} type string defining the input type (\"vec3\",\"number\",...), it its a generic one use 0\n     * @param {Object} extra_info this can be used to have special properties of an input (label, color, position, etc)\n     */\n    LGraphNode.prototype.addInput = function(name, type, extra_info) {\n        type = type || 0;\n        var input = { name: name, type: type, link: null };\n        if (extra_info) {\n            for (var i in extra_info) {\n                input[i] = extra_info[i];\n            }\n        }\n\n        if (!this.inputs) {\n            this.inputs = [];\n        }\n\n        this.inputs.push(input);\n        this.setSize( this.computeSize() );\n\n        if (this.onInputAdded) {\n            this.onInputAdded(input);\n\t\t}\n        \n        LiteGraph.registerNodeAndSlotType(this,type);\n\n        this.setDirtyCanvas(true, true);\n        return input;\n    };\n\n    /**\n     * add several new input slots in this node\n     * @method addInputs\n     * @param {Array} array of triplets like [[name,type,extra_info],[...]]\n     */\n    LGraphNode.prototype.addInputs = function(array) {\n        for (var i = 0; i < array.length; ++i) {\n            var info = array[i];\n            var o = { name: info[0], type: info[1], link: null };\n            if (array[2]) {\n                for (var j in info[2]) {\n                    o[j] = info[2][j];\n                }\n            }\n\n            if (!this.inputs) {\n                this.inputs = [];\n            }\n            this.inputs.push(o);\n            if (this.onInputAdded) {\n                this.onInputAdded(o);\n            }\n            \n            LiteGraph.registerNodeAndSlotType(this,info[1]);\n        }\n\n        this.setSize( this.computeSize() );\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * remove an existing input slot\n     * @method removeInput\n     * @param {number} slot\n     */\n    LGraphNode.prototype.removeInput = function(slot) {\n        this.disconnectInput(slot);\n        var slot_info = this.inputs.splice(slot, 1);\n        for (var i = slot; i < this.inputs.length; ++i) {\n            if (!this.inputs[i]) {\n                continue;\n            }\n            var link = this.graph.links[this.inputs[i].link];\n            if (!link) {\n                continue;\n            }\n            link.target_slot -= 1;\n        }\n        this.setSize( this.computeSize() );\n        if (this.onInputRemoved) {\n            this.onInputRemoved(slot, slot_info[0] );\n        }\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * add an special connection to this node (used for special kinds of graphs)\n     * @method addConnection\n     * @param {string} name\n     * @param {string} type string defining the input type (\"vec3\",\"number\",...)\n     * @param {[x,y]} pos position of the connection inside the node\n     * @param {string} direction if is input or output\n     */\n    LGraphNode.prototype.addConnection = function(name, type, pos, direction) {\n        var o = {\n            name: name,\n            type: type,\n            pos: pos,\n            direction: direction,\n            links: null\n        };\n        this.connections.push(o);\n        return o;\n    };\n\n    /**\n     * computes the minimum size of a node according to its inputs and output slots\n     * @method computeSize\n     * @param {number} minHeight\n     * @return {number} the total size\n     */\n    LGraphNode.prototype.computeSize = function(out) {\n        if (this.constructor.size) {\n            return this.constructor.size.concat();\n        }\n\n        var rows = Math.max(\n            this.inputs ? this.inputs.length : 1,\n            this.outputs ? this.outputs.length : 1\n        );\n        var size = out || new Float32Array([0, 0]);\n        rows = Math.max(rows, 1);\n        var font_size = LiteGraph.NODE_TEXT_SIZE; //although it should be graphcanvas.inner_text_font size\n\n        var title_width = compute_text_size(this.title);\n        var input_width = 0;\n        var output_width = 0;\n\n        if (this.inputs) {\n            for (var i = 0, l = this.inputs.length; i < l; ++i) {\n                var input = this.inputs[i];\n                var text = input.label || input.name || \"\";\n                var text_width = compute_text_size(text);\n                if (input_width < text_width) {\n                    input_width = text_width;\n                }\n            }\n        }\n\n        if (this.outputs) {\n            for (var i = 0, l = this.outputs.length; i < l; ++i) {\n                var output = this.outputs[i];\n                var text = output.label || output.name || \"\";\n                var text_width = compute_text_size(text);\n                if (output_width < text_width) {\n                    output_width = text_width;\n                }\n            }\n        }\n\n        size[0] = Math.max(input_width + output_width + 10, title_width);\n        size[0] = Math.max(size[0], LiteGraph.NODE_WIDTH);\n        if (this.widgets && this.widgets.length) {\n            size[0] = Math.max(size[0], LiteGraph.NODE_WIDTH * 1.5);\n        }\n\n        size[1] = (this.constructor.slot_start_y || 0) + rows * LiteGraph.NODE_SLOT_HEIGHT;\n\n        var widgets_height = 0;\n        if (this.widgets && this.widgets.length) {\n            for (var i = 0, l = this.widgets.length; i < l; ++i) {\n                if (this.widgets[i].computeSize)\n                    widgets_height += this.widgets[i].computeSize(size[0])[1] + 4;\n                else\n                    widgets_height += LiteGraph.NODE_WIDGET_HEIGHT + 4;\n            }\n            widgets_height += 8;\n        }\n\n        //compute height using widgets height\n        if( this.widgets_up )\n            size[1] = Math.max( size[1], widgets_height );\n        else if( this.widgets_start_y != null )\n            size[1] = Math.max( size[1], widgets_height + this.widgets_start_y );\n        else\n            size[1] += widgets_height;\n\n        function compute_text_size(text) {\n            if (!text) {\n                return 0;\n            }\n            return font_size * text.length * 0.6;\n        }\n\n        if (\n            this.constructor.min_height &&\n            size[1] < this.constructor.min_height\n        ) {\n            size[1] = this.constructor.min_height;\n        }\n\n        size[1] += 6; //margin\n\n        return size;\n    };\n\n    /**\n     * returns all the info available about a property of this node.\n     *\n     * @method getPropertyInfo\n     * @param {String} property name of the property\n     * @return {Object} the object with all the available info\n    */\n    LGraphNode.prototype.getPropertyInfo = function( property )\n\t{\n        var info = null;\n\n\t\t//there are several ways to define info about a property\n\t\t//legacy mode\n\t\tif (this.properties_info) {\n            for (var i = 0; i < this.properties_info.length; ++i) {\n                if (this.properties_info[i].name == property) {\n                    info = this.properties_info[i];\n                    break;\n                }\n            }\n        }\n\t\t//litescene mode using the constructor\n\t\tif(this.constructor[\"@\" + property])\n\t\t\tinfo = this.constructor[\"@\" + property];\n\n\t\tif(this.constructor.widgets_info && this.constructor.widgets_info[property])\n\t\t\tinfo = this.constructor.widgets_info[property];\n\n\t\t//litescene mode using the constructor\n\t\tif (!info && this.onGetPropertyInfo) {\n            info = this.onGetPropertyInfo(property);\n        }\n\n        if (!info)\n            info = {};\n\t\tif(!info.type)\n\t\t\tinfo.type = typeof this.properties[property];\n\t\tif(info.widget == \"combo\")\n\t\t\tinfo.type = \"enum\";\n\n\t\treturn info;\n\t}\n\n    /**\n     * Defines a widget inside the node, it will be rendered on top of the node, you can control lots of properties\n     *\n     * @method addWidget\n     * @param {String} type the widget type (could be \"number\",\"string\",\"combo\"\n     * @param {String} name the text to show on the widget\n     * @param {String} value the default value\n     * @param {Function|String} callback function to call when it changes (optionally, it can be the name of the property to modify)\n     * @param {Object} options the object that contains special properties of this widget \n     * @return {Object} the created widget object\n     */\n    LGraphNode.prototype.addWidget = function( type, name, value, callback, options )\n\t{\n        if (!this.widgets) {\n            this.widgets = [];\n        }\n\n\t\tif(!options && callback && callback.constructor === Object)\n\t\t{\n\t\t\toptions = callback;\n\t\t\tcallback = null;\n\t\t}\n\n\t\tif(options && options.constructor === String) //options can be the property name\n\t\t\toptions = { property: options };\n\n\t\tif(callback && callback.constructor === String) //callback can be the property name\n\t\t{\n\t\t\tif(!options)\n\t\t\t\toptions = {};\n\t\t\toptions.property = callback;\n\t\t\tcallback = null;\n\t\t}\n\n\t\tif(callback && callback.constructor !== Function)\n\t\t{\n\t\t\tconsole.warn(\"addWidget: callback must be a function\");\n\t\t\tcallback = null;\n\t\t}\n\n        var w = {\n            type: type.toLowerCase(),\n            name: name,\n            value: value,\n            callback: callback,\n            options: options || {}\n        };\n\n        if (w.options.y !== undefined) {\n            w.y = w.options.y;\n        }\n\n        if (!callback && !w.options.callback && !w.options.property) {\n            console.warn(\"LiteGraph addWidget(...) without a callback or property assigned\");\n        }\n        if (type == \"combo\" && !w.options.values) {\n            throw \"LiteGraph addWidget('combo',...) requires to pass values in options: { values:['red','blue'] }\";\n        }\n        this.widgets.push(w);\n\t\tthis.setSize( this.computeSize() );\n        return w;\n    };\n\n    LGraphNode.prototype.addCustomWidget = function(custom_widget) {\n        if (!this.widgets) {\n            this.widgets = [];\n        }\n        this.widgets.push(custom_widget);\n        return custom_widget;\n    };\n\n    /**\n     * returns the bounding of the object, used for rendering purposes\n     * bounding is: [topleft_cornerx, topleft_cornery, width, height]\n     * @method getBounding\n     * @return {Float32Array[4]} the total size\n     */\n    LGraphNode.prototype.getBounding = function(out) {\n        out = out || new Float32Array(4);\n        out[0] = this.pos[0] - 4;\n        out[1] = this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT;\n        out[2] = this.size[0] + 4;\n        out[3] = this.flags.collapsed ? LiteGraph.NODE_TITLE_HEIGHT : this.size[1] + LiteGraph.NODE_TITLE_HEIGHT;\n\n        if (this.onBounding) {\n            this.onBounding(out);\n        }\n        return out;\n    };\n\n    /**\n     * checks if a point is inside the shape of a node\n     * @method isPointInside\n     * @param {number} x\n     * @param {number} y\n     * @return {boolean}\n     */\n    LGraphNode.prototype.isPointInside = function(x, y, margin, skip_title) {\n        margin = margin || 0;\n\n        var margin_top = this.graph && this.graph.isLive() ? 0 : LiteGraph.NODE_TITLE_HEIGHT;\n        if (skip_title) {\n            margin_top = 0;\n        }\n        if (this.flags && this.flags.collapsed) {\n            //if ( distance([x,y], [this.pos[0] + this.size[0]*0.5, this.pos[1] + this.size[1]*0.5]) < LiteGraph.NODE_COLLAPSED_RADIUS)\n            if (\n                isInsideRectangle(\n                    x,\n                    y,\n                    this.pos[0] - margin,\n                    this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT - margin,\n                    (this._collapsed_width || LiteGraph.NODE_COLLAPSED_WIDTH) +\n                        2 * margin,\n                    LiteGraph.NODE_TITLE_HEIGHT + 2 * margin\n                )\n            ) {\n                return true;\n            }\n        } else if (\n            this.pos[0] - 4 - margin < x &&\n            this.pos[0] + this.size[0] + 4 + margin > x &&\n            this.pos[1] - margin_top - margin < y &&\n            this.pos[1] + this.size[1] + margin > y\n        ) {\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * checks if a point is inside a node slot, and returns info about which slot\n     * @method getSlotInPosition\n     * @param {number} x\n     * @param {number} y\n     * @return {Object} if found the object contains { input|output: slot object, slot: number, link_pos: [x,y] }\n     */\n    LGraphNode.prototype.getSlotInPosition = function(x, y) {\n        //search for inputs\n        var link_pos = new Float32Array(2);\n        if (this.inputs) {\n            for (var i = 0, l = this.inputs.length; i < l; ++i) {\n                var input = this.inputs[i];\n                this.getConnectionPos(true, i, link_pos);\n                if (\n                    isInsideRectangle(\n                        x,\n                        y,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        20,\n                        10\n                    )\n                ) {\n                    return { input: input, slot: i, link_pos: link_pos };\n                }\n            }\n        }\n\n        if (this.outputs) {\n            for (var i = 0, l = this.outputs.length; i < l; ++i) {\n                var output = this.outputs[i];\n                this.getConnectionPos(false, i, link_pos);\n                if (\n                    isInsideRectangle(\n                        x,\n                        y,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        20,\n                        10\n                    )\n                ) {\n                    return { output: output, slot: i, link_pos: link_pos };\n                }\n            }\n        }\n\n        return null;\n    };\n\n    /**\n     * returns the input slot with a given name (used for dynamic slots), -1 if not found\n     * @method findInputSlot\n     * @param {string} name the name of the slot\n     * @param {boolean} returnObj if the obj itself wanted\n     * @return {number_or_object} the slot (-1 if not found)\n     */\n    LGraphNode.prototype.findInputSlot = function(name,  returnObj) {\n        if (!this.inputs) {\n            return -1;\n        }\n        for (var i = 0, l = this.inputs.length; i < l; ++i) {\n            if (name == this.inputs[i].name) {\n                return !returnObj ? i : this.inputs[i];\n            }\n        }\n        return -1;\n    };\n\n    /**\n     * returns the output slot with a given name (used for dynamic slots), -1 if not found\n     * @method findOutputSlot\n     * @param {string} name the name of the slot\n     * @param {boolean} returnObj if the obj itself wanted\n     * @return {number_or_object} the slot (-1 if not found)\n     */\n    LGraphNode.prototype.findOutputSlot = function(name, returnObj) {\n        returnObj = returnObj || false;\n        if (!this.outputs) {\n            return -1;\n        }\n        for (var i = 0, l = this.outputs.length; i < l; ++i) {\n            if (name == this.outputs[i].name) {\n                return !returnObj ? i : this.outputs[i];\n            }\n        }\n        return -1;\n    };\n    \n    // TODO refactor: USE SINGLE findInput/findOutput functions! :: merge options\n    \n    /**\n     * returns the first free input slot\n     * @method findInputSlotFree\n     * @param {object} options\n     * @return {number_or_object} the slot (-1 if not found)\n     */\n    LGraphNode.prototype.findInputSlotFree = function(optsIn) {\n        var optsIn = optsIn || {};\n        var optsDef = {returnObj: false\n                        ,typesNotAccepted: []\n                      };\n        var opts = Object.assign(optsDef,optsIn);\n        if (!this.inputs) {\n            return -1;\n        }\n        for (var i = 0, l = this.inputs.length; i < l; ++i) {\n            if (this.inputs[i].link && this.inputs[i].link != null) {\n                continue;\n            }\n            if (opts.typesNotAccepted && opts.typesNotAccepted.includes && opts.typesNotAccepted.includes(this.inputs[i].type)){\n                continue;\n            }\n            return !opts.returnObj ? i : this.inputs[i];\n        }\n        return -1;\n    };\n\n    /**\n     * returns the first output slot free\n     * @method findOutputSlotFree\n     * @param {object} options\n     * @return {number_or_object} the slot (-1 if not found)\n     */\n    LGraphNode.prototype.findOutputSlotFree = function(optsIn) {\n        var optsIn = optsIn || {};\n        var optsDef = { returnObj: false\n                        ,typesNotAccepted: []\n                      };\n        var opts = Object.assign(optsDef,optsIn);\n        if (!this.outputs) {\n            return -1;\n        }\n        for (var i = 0, l = this.outputs.length; i < l; ++i) {\n            if (this.outputs[i].links && this.outputs[i].links != null) {\n                continue;\n            }\n            if (opts.typesNotAccepted && opts.typesNotAccepted.includes && opts.typesNotAccepted.includes(this.outputs[i].type)){\n                continue;\n            }\n            return !opts.returnObj ? i : this.outputs[i];\n        }\n        return -1;\n    };\n    \n    /**\n     * findSlotByType for INPUTS\n     */\n    LGraphNode.prototype.findInputSlotByType = function(type, returnObj, preferFreeSlot, doNotUseOccupied) {\n        return this.findSlotByType(true, type, returnObj, preferFreeSlot, doNotUseOccupied);\n    };\n\n    /**\n     * findSlotByType for OUTPUTS\n     */\n    LGraphNode.prototype.findOutputSlotByType = function(type, returnObj, preferFreeSlot, doNotUseOccupied) {\n        return this.findSlotByType(false, type, returnObj, preferFreeSlot, doNotUseOccupied);\n    };\n    \n    /**\n     * returns the output (or input) slot with a given type, -1 if not found\n     * @method findSlotByType\n     * @param {boolean} input uise inputs instead of outputs\n     * @param {string} type the type of the slot\n     * @param {boolean} returnObj if the obj itself wanted\n     * @param {boolean} preferFreeSlot if we want a free slot (if not found, will return the first of the type anyway)\n     * @return {number_or_object} the slot (-1 if not found)\n     */\n    LGraphNode.prototype.findSlotByType = function(input, type, returnObj, preferFreeSlot, doNotUseOccupied) {\n        input = input || false;\n        returnObj = returnObj || false;\n        preferFreeSlot = preferFreeSlot || false;\n        doNotUseOccupied = doNotUseOccupied || false;\n        var aSlots = input ? this.inputs : this.outputs;\n        if (!aSlots) {\n            return -1;\n        }\n\t\t// !! empty string type is considered 0, * !!\n\t\tif (type == \"\" || type == \"*\") type = 0; \n        for (var i = 0, l = aSlots.length; i < l; ++i) {\n            var tFound = false;\n            var aSource = (type+\"\").toLowerCase().split(\",\");\n            var aDest = aSlots[i].type==\"0\"||aSlots[i].type==\"*\"?\"0\":aSlots[i].type;\n\t\t\taDest = (aDest+\"\").toLowerCase().split(\",\");\n            for(sI=0;sI<aSource.length;sI++){\n                for(dI=0;dI<aDest.length;dI++){\n\t\t\t\t\tif (aSource[sI]==\"_event_\") aSource[sI] = LiteGraph.EVENT;\n\t\t\t\t\tif (aDest[sI]==\"_event_\") aDest[sI] = LiteGraph.EVENT;\n\t\t\t\t\tif (aSource[sI]==\"*\") aSource[sI] = 0;\n\t\t\t\t\tif (aDest[sI]==\"*\") aDest[sI] = 0;\n\t\t\t\t\tif (aSource[sI] == aDest[dI]) {\n                        if (preferFreeSlot && aSlots[i].links && aSlots[i].links !== null) continue;\n                        return !returnObj ? i : aSlots[i];\n                    }\n                }\n            }\n        }\n        // if didnt find some, stop checking for free slots\n        if (preferFreeSlot && !doNotUseOccupied){\n            for (var i = 0, l = aSlots.length; i < l; ++i) {\n                var tFound = false;\n                var aSource = (type+\"\").toLowerCase().split(\",\");\n                var aDest = aSlots[i].type==\"0\"||aSlots[i].type==\"*\"?\"0\":aSlots[i].type;\n\t\t\t\taDest = (aDest+\"\").toLowerCase().split(\",\");\n                for(sI=0;sI<aSource.length;sI++){\n                    for(dI=0;dI<aDest.length;dI++){\n\t\t\t\t\t\tif (aSource[sI]==\"*\") aSource[sI] = 0;\n\t\t\t\t\t\tif (aDest[sI]==\"*\") aDest[sI] = 0;\n                        if (aSource[sI] == aDest[dI]) {\n                            return !returnObj ? i : aSlots[i];\n                        }\n                    }\n                }\n            }\n        }\n        return -1;\n    };\n\n    /**\n     * connect this node output to the input of another node BY TYPE\n     * @method connectByType\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @param {LGraphNode} node the target node\n     * @param {string} target_type the input slot type of the target node\n     * @return {Object} the link_info is created, otherwise null\n     */\n    LGraphNode.prototype.connectByType = function(slot, target_node, target_slotType, optsIn) {\n        var optsIn = optsIn || {};\n        var optsDef = { createEventInCase: true\n\t\t\t\t\t   \t,firstFreeIfOutputGeneralInCase: true\n                        ,generalTypeInCase: true\n                      };\n        var opts = Object.assign(optsDef,optsIn);\n        if (target_node && target_node.constructor === Number) {\n            target_node = this.graph.getNodeById(target_node);\n        }\n        target_slot = target_node.findInputSlotByType(target_slotType, false, true);\n        if (target_slot >= 0 && target_slot !== null){\n            //console.debug(\"CONNbyTYPE type \"+target_slotType+\" for \"+target_slot)\n            return this.connect(slot, target_node, target_slot);\n        }else{\n            //console.log(\"type \"+target_slotType+\" not found or not free?\")\n            if (opts.createEventInCase && target_slotType == LiteGraph.EVENT){\n                // WILL CREATE THE onTrigger IN SLOT\n\t\t\t\t//console.debug(\"connect WILL CREATE THE onTrigger \"+target_slotType+\" to \"+target_node);\n                return this.connect(slot, target_node, -1);\n            }\n\t\t\t// connect to the first general output slot if not found a specific type and \n            if (opts.generalTypeInCase){\n                var target_slot = target_node.findInputSlotByType(0, false, true, true);\n\t\t\t\t//console.debug(\"connect TO a general type (*, 0), if not found the specific type \",target_slotType,\" to \",target_node,\"RES_SLOT:\",target_slot);\n                if (target_slot >= 0){\n                    return this.connect(slot, target_node, target_slot);\n                }\n            }\n            // connect to the first free input slot if not found a specific type and this output is general\n            if (opts.firstFreeIfOutputGeneralInCase && (target_slotType == 0 || target_slotType == \"*\" || target_slotType == \"\")){\n                var target_slot = target_node.findInputSlotFree({typesNotAccepted: [LiteGraph.EVENT] });\n\t\t\t\t//console.debug(\"connect TO TheFirstFREE \",target_slotType,\" to \",target_node,\"RES_SLOT:\",target_slot);\n                if (target_slot >= 0){\n\t\t\t\t\treturn this.connect(slot, target_node, target_slot);\n                }\n            }\n\t\t\t\n\t\t\tconsole.debug(\"no way to connect type: \",target_slotType,\" to targetNODE \",target_node);\n\t\t\t//TODO filter\n\t\t\t\n            return null;\n        }\n    }\n    \n    /**\n     * connect this node input to the output of another node BY TYPE\n     * @method connectByType\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @param {LGraphNode} node the target node\n     * @param {string} target_type the output slot type of the target node\n     * @return {Object} the link_info is created, otherwise null\n     */\n    LGraphNode.prototype.connectByTypeOutput = function(slot, source_node, source_slotType, optsIn) {\n        var optsIn = optsIn || {};\n        var optsDef = { createEventInCase: true\n                        ,firstFreeIfInputGeneralInCase: true\n                        ,generalTypeInCase: true\n                      };\n        var opts = Object.assign(optsDef,optsIn);\n        if (source_node && source_node.constructor === Number) {\n            source_node = this.graph.getNodeById(source_node);\n        }\n        source_slot = source_node.findOutputSlotByType(source_slotType, false, true);\n        if (source_slot >= 0 && source_slot !== null){\n            //console.debug(\"CONNbyTYPE OUT! type \"+source_slotType+\" for \"+source_slot)\n            return source_node.connect(source_slot, this, slot);\n        }else{\n            \n            // connect to the first general output slot if not found a specific type and \n            if (opts.generalTypeInCase){\n                var source_slot = source_node.findOutputSlotByType(0, false, true, true);\n                if (source_slot >= 0){\n                    return source_node.connect(source_slot, this, slot);\n                }\n            }\n            \n            if (opts.createEventInCase && source_slotType == LiteGraph.EVENT){\n                // WILL CREATE THE onExecuted OUT SLOT\n\t\t\t\tif (LiteGraph.do_add_triggers_slots){\n\t\t\t\t\tvar source_slot = source_node.addOnExecutedOutput();\n\t\t\t\t\treturn source_node.connect(source_slot, this, slot);\n\t\t\t\t}\n            }\n            // connect to the first free output slot if not found a specific type and this input is general\n            if (opts.firstFreeIfInputGeneralInCase && (source_slotType == 0 || source_slotType == \"*\" || source_slotType == \"\")){\n                var source_slot = source_node.findOutputSlotFree({typesNotAccepted: [LiteGraph.EVENT] });\n                if (source_slot >= 0){\n                    return source_node.connect(source_slot, this, slot);\n                }\n            }\n            \n\t\t\tconsole.debug(\"no way to connect byOUT type: \",source_slotType,\" to sourceNODE \",source_node);\n\t\t\t//TODO filter\n\t\t\t\n            //console.log(\"type OUT! \"+source_slotType+\" not found or not free?\")\n            return null;\n        }\n    }\n    \n    /**\n     * connect this node output to the input of another node\n     * @method connect\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @param {LGraphNode} node the target node\n     * @param {number_or_string} target_slot the input slot of the target node (could be the number of the slot or the string with the name of the slot, or -1 to connect a trigger)\n     * @return {Object} the link_info is created, otherwise null\n     */\n    LGraphNode.prototype.connect = function(slot, target_node, target_slot) {\n        target_slot = target_slot || 0;\n\n        if (!this.graph) {\n            //could be connected before adding it to a graph\n            console.log(\n                \"Connect: Error, node doesn't belong to any graph. Nodes must be added first to a graph before connecting them.\"\n            ); //due to link ids being associated with graphs\n            return null;\n        }\n\n        //seek for the output slot\n        if (slot.constructor === String) {\n            slot = this.findOutputSlot(slot);\n            if (slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(\"Connect: Error, no slot of name \" + slot);\n                }\n                return null;\n            }\n        } else if (!this.outputs || slot >= this.outputs.length) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return null;\n        }\n\n        if (target_node && target_node.constructor === Number) {\n            target_node = this.graph.getNodeById(target_node);\n        }\n        if (!target_node) {\n            throw \"target node is null\";\n        }\n\n        //avoid loopback\n        if (target_node == this) {\n            return null;\n        }\n\n        //you can specify the slot by name\n        if (target_slot.constructor === String) {\n            target_slot = target_node.findInputSlot(target_slot);\n            if (target_slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(\n                        \"Connect: Error, no slot of name \" + target_slot\n                    );\n                }\n                return null;\n            }\n        } else if (target_slot === LiteGraph.EVENT) {\n            \n            if (LiteGraph.do_add_triggers_slots){\n\t            //search for first slot with event? :: NO this is done outside\n\t\t\t\t//console.log(\"Connect: Creating triggerEvent\");\n\t            // force mode\n\t            target_node.changeMode(LiteGraph.ON_TRIGGER);\n\t            target_slot = target_node.findInputSlot(\"onTrigger\");\n        \t}else{\n            \treturn null; // -- break --\n\t\t\t}\n        } else if (\n            !target_node.inputs ||\n            target_slot >= target_node.inputs.length\n        ) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return null;\n        }\n\n\t\tvar changed = false;\n\n        var input = target_node.inputs[target_slot];\n        var link_info = null;\n        var output = this.outputs[slot];\n        \n        if (!this.outputs[slot]){\n            /*console.debug(\"Invalid slot passed: \"+slot);\n            console.debug(this.outputs);*/\n            return null;\n        }\n\n        // allow target node to change slot\n        if (target_node.onBeforeConnectInput) {\n            // This way node can choose another slot (or make a new one?)\n            target_slot = target_node.onBeforeConnectInput(target_slot); //callback\n        }\n\n\t\t//check target_slot and check connection types\n        if (target_slot===false || target_slot===null || !LiteGraph.isValidConnection(output.type, input.type))\n\t\t{\n\t        this.setDirtyCanvas(false, true);\n\t\t\tif(changed)\n\t\t        this.graph.connectionChange(this, link_info);\n\t\t\treturn null;\n\t\t}else{\n\t\t\t//console.debug(\"valid connection\",output.type, input.type);\n\t\t}\n\n        //allows nodes to block connection, callback\n        if (target_node.onConnectInput) {\n            if ( target_node.onConnectInput(target_slot, output.type, output, this, slot) === false ) {\n                return null;\n            }\n        }\n        if (this.onConnectOutput) { // callback\n            if ( this.onConnectOutput(slot, input.type, input, target_node, target_slot) === false ) {\n                return null;\n            }\n        }\n\n        //if there is something already plugged there, disconnect\n        if (target_node.inputs[target_slot] && target_node.inputs[target_slot].link != null) {\n\t\t\tthis.graph.beforeChange();\n            target_node.disconnectInput(target_slot, {doProcessChange: false});\n\t\t\tchanged = true;\n        }\n        if (output.links !== null && output.links.length){\n            switch(output.type){\n                case LiteGraph.EVENT:\n                    if (!LiteGraph.allow_multi_output_for_events){\n                        this.graph.beforeChange();\n                        this.disconnectOutput(slot, false, {doProcessChange: false}); // Input(target_slot, {doProcessChange: false});\n                        changed = true;\n                    }\n                break;\n                default:\n                break;\n            }\n        }\n        \n\t\t//create link class\n\t\tlink_info = new LLink(\n\t\t\t++this.graph.last_link_id,\n\t\t\tinput.type || output.type,\n\t\t\tthis.id,\n\t\t\tslot,\n\t\t\ttarget_node.id,\n\t\t\ttarget_slot\n\t\t);\n\n\t\t//add to graph links list\n\t\tthis.graph.links[link_info.id] = link_info;\n\n\t\t//connect in output\n\t\tif (output.links == null) {\n\t\t\toutput.links = [];\n\t\t}\n\t\toutput.links.push(link_info.id);\n\t\t//connect in input\n\t\ttarget_node.inputs[target_slot].link = link_info.id;\n\t\tif (this.graph) {\n\t\t\tthis.graph._version++;\n\t\t}\n\t\tif (this.onConnectionsChange) {\n\t\t\tthis.onConnectionsChange(\n\t\t\t\tLiteGraph.OUTPUT,\n\t\t\t\tslot,\n\t\t\t\ttrue,\n\t\t\t\tlink_info,\n\t\t\t\toutput\n\t\t\t);\n\t\t} //link_info has been created now, so its updated\n\t\tif (target_node.onConnectionsChange) {\n\t\t\ttarget_node.onConnectionsChange(\n\t\t\t\tLiteGraph.INPUT,\n\t\t\t\ttarget_slot,\n\t\t\t\ttrue,\n\t\t\t\tlink_info,\n\t\t\t\tinput\n\t\t\t);\n\t\t}\n\t\tif (this.graph && this.graph.onNodeConnectionChange) {\n\t\t\tthis.graph.onNodeConnectionChange(\n\t\t\t\tLiteGraph.INPUT,\n\t\t\t\ttarget_node,\n\t\t\t\ttarget_slot,\n\t\t\t\tthis,\n\t\t\t\tslot\n\t\t\t);\n\t\t\tthis.graph.onNodeConnectionChange(\n\t\t\t\tLiteGraph.OUTPUT,\n\t\t\t\tthis,\n\t\t\t\tslot,\n\t\t\t\ttarget_node,\n\t\t\t\ttarget_slot\n\t\t\t);\n\t\t}\n\n        this.setDirtyCanvas(false, true);\n\t\tthis.graph.afterChange();\n\t\tthis.graph.connectionChange(this, link_info);\n\n        return link_info;\n    };\n\n    /**\n     * disconnect one output to an specific node\n     * @method disconnectOutput\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @param {LGraphNode} target_node the target node to which this slot is connected [Optional, if not target_node is specified all nodes will be disconnected]\n     * @return {boolean} if it was disconnected successfully\n     */\n    LGraphNode.prototype.disconnectOutput = function(slot, target_node) {\n        if (slot.constructor === String) {\n            slot = this.findOutputSlot(slot);\n            if (slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(\"Connect: Error, no slot of name \" + slot);\n                }\n                return false;\n            }\n        } else if (!this.outputs || slot >= this.outputs.length) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return false;\n        }\n\n        //get output slot\n        var output = this.outputs[slot];\n        if (!output || !output.links || output.links.length == 0) {\n            return false;\n        }\n\n        //one of the output links in this slot\n        if (target_node) {\n            if (target_node.constructor === Number) {\n                target_node = this.graph.getNodeById(target_node);\n            }\n            if (!target_node) {\n                throw \"Target Node not found\";\n            }\n\n            for (var i = 0, l = output.links.length; i < l; i++) {\n                var link_id = output.links[i];\n                var link_info = this.graph.links[link_id];\n\n                //is the link we are searching for...\n                if (link_info.target_id == target_node.id) {\n                    output.links.splice(i, 1); //remove here\n                    var input = target_node.inputs[link_info.target_slot];\n                    input.link = null; //remove there\n                    delete this.graph.links[link_id]; //remove the link from the links pool\n                    if (this.graph) {\n                        this.graph._version++;\n                    }\n                    if (target_node.onConnectionsChange) {\n                        target_node.onConnectionsChange(\n                            LiteGraph.INPUT,\n                            link_info.target_slot,\n                            false,\n                            link_info,\n                            input\n                        );\n                    } //link_info hasn't been modified so its ok\n                    if (this.onConnectionsChange) {\n                        this.onConnectionsChange(\n                            LiteGraph.OUTPUT,\n                            slot,\n                            false,\n                            link_info,\n                            output\n                        );\n                    }\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.OUTPUT,\n                            this,\n                            slot\n                        );\n                    }\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.OUTPUT,\n                            this,\n                            slot\n                        );\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.INPUT,\n                            target_node,\n                            link_info.target_slot\n                        );\n                    }\n                    break;\n                }\n            }\n        } //all the links in this output slot\n        else {\n            for (var i = 0, l = output.links.length; i < l; i++) {\n                var link_id = output.links[i];\n                var link_info = this.graph.links[link_id];\n                if (!link_info) {\n                    //bug: it happens sometimes\n                    continue;\n                }\n\n                var target_node = this.graph.getNodeById(link_info.target_id);\n                var input = null;\n                if (this.graph) {\n                    this.graph._version++;\n                }\n                if (target_node) {\n                    input = target_node.inputs[link_info.target_slot];\n                    input.link = null; //remove other side link\n                    if (target_node.onConnectionsChange) {\n                        target_node.onConnectionsChange(\n                            LiteGraph.INPUT,\n                            link_info.target_slot,\n                            false,\n                            link_info,\n                            input\n                        );\n                    } //link_info hasn't been modified so its ok\n                    if (this.graph && this.graph.onNodeConnectionChange) {\n                        this.graph.onNodeConnectionChange(\n                            LiteGraph.INPUT,\n                            target_node,\n                            link_info.target_slot\n                        );\n                    }\n                }\n                delete this.graph.links[link_id]; //remove the link from the links pool\n                if (this.onConnectionsChange) {\n                    this.onConnectionsChange(\n                        LiteGraph.OUTPUT,\n                        slot,\n                        false,\n                        link_info,\n                        output\n                    );\n                }\n                if (this.graph && this.graph.onNodeConnectionChange) {\n                    this.graph.onNodeConnectionChange(\n                        LiteGraph.OUTPUT,\n                        this,\n                        slot\n                    );\n                    this.graph.onNodeConnectionChange(\n                        LiteGraph.INPUT,\n                        target_node,\n                        link_info.target_slot\n                    );\n                }\n            }\n            output.links = null;\n        }\n\n        this.setDirtyCanvas(false, true);\n        this.graph.connectionChange(this);\n        return true;\n    };\n\n    /**\n     * disconnect one input\n     * @method disconnectInput\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @return {boolean} if it was disconnected successfully\n     */\n    LGraphNode.prototype.disconnectInput = function(slot) {\n        //seek for the output slot\n        if (slot.constructor === String) {\n            slot = this.findInputSlot(slot);\n            if (slot == -1) {\n                if (LiteGraph.debug) {\n                    console.log(\"Connect: Error, no slot of name \" + slot);\n                }\n                return false;\n            }\n        } else if (!this.inputs || slot >= this.inputs.length) {\n            if (LiteGraph.debug) {\n                console.log(\"Connect: Error, slot number not found\");\n            }\n            return false;\n        }\n\n        var input = this.inputs[slot];\n        if (!input) {\n            return false;\n        }\n\n        var link_id = this.inputs[slot].link;\n\t\tif(link_id != null)\n\t\t{\n\t\t\tthis.inputs[slot].link = null;\n\n\t\t\t//remove other side\n\t\t\tvar link_info = this.graph.links[link_id];\n\t\t\tif (link_info) {\n\t\t\t\tvar target_node = this.graph.getNodeById(link_info.origin_id);\n\t\t\t\tif (!target_node) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tvar output = target_node.outputs[link_info.origin_slot];\n\t\t\t\tif (!output || !output.links || output.links.length == 0) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t//search in the inputs list for this link\n\t\t\t\tfor (var i = 0, l = output.links.length; i < l; i++) {\n\t\t\t\t\tif (output.links[i] == link_id) {\n\t\t\t\t\t\toutput.links.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdelete this.graph.links[link_id]; //remove from the pool\n\t\t\t\tif (this.graph) {\n\t\t\t\t\tthis.graph._version++;\n\t\t\t\t}\n\t\t\t\tif (this.onConnectionsChange) {\n\t\t\t\t\tthis.onConnectionsChange(\n\t\t\t\t\t\tLiteGraph.INPUT,\n\t\t\t\t\t\tslot,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tlink_info,\n\t\t\t\t\t\tinput\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (target_node.onConnectionsChange) {\n\t\t\t\t\ttarget_node.onConnectionsChange(\n\t\t\t\t\t\tLiteGraph.OUTPUT,\n\t\t\t\t\t\ti,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tlink_info,\n\t\t\t\t\t\toutput\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (this.graph && this.graph.onNodeConnectionChange) {\n\t\t\t\t\tthis.graph.onNodeConnectionChange(\n\t\t\t\t\t\tLiteGraph.OUTPUT,\n\t\t\t\t\t\ttarget_node,\n\t\t\t\t\t\ti\n\t\t\t\t\t);\n\t\t\t\t\tthis.graph.onNodeConnectionChange(LiteGraph.INPUT, this, slot);\n\t\t\t\t}\n\t\t\t}\n\t\t} //link != null\n\n        this.setDirtyCanvas(false, true);\n\t\tif(this.graph)\n\t        this.graph.connectionChange(this);\n        return true;\n    };\n\n    /**\n     * returns the center of a connection point in canvas coords\n     * @method getConnectionPos\n     * @param {boolean} is_input true if if a input slot, false if it is an output\n     * @param {number_or_string} slot (could be the number of the slot or the string with the name of the slot)\n     * @param {vec2} out [optional] a place to store the output, to free garbage\n     * @return {[x,y]} the position\n     **/\n    LGraphNode.prototype.getConnectionPos = function(\n        is_input,\n        slot_number,\n        out\n    ) {\n        out = out || new Float32Array(2);\n        var num_slots = 0;\n        if (is_input && this.inputs) {\n            num_slots = this.inputs.length;\n        }\n        if (!is_input && this.outputs) {\n            num_slots = this.outputs.length;\n        }\n\n        var offset = LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n\n        if (this.flags.collapsed) {\n            var w = this._collapsed_width || LiteGraph.NODE_COLLAPSED_WIDTH;\n            if (this.horizontal) {\n                out[0] = this.pos[0] + w * 0.5;\n                if (is_input) {\n                    out[1] = this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT;\n                } else {\n                    out[1] = this.pos[1];\n                }\n            } else {\n                if (is_input) {\n                    out[0] = this.pos[0];\n                } else {\n                    out[0] = this.pos[0] + w;\n                }\n                out[1] = this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n            }\n            return out;\n        }\n\n        //weird feature that never got finished\n        if (is_input && slot_number == -1) {\n            out[0] = this.pos[0] + LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n            out[1] = this.pos[1] + LiteGraph.NODE_TITLE_HEIGHT * 0.5;\n            return out;\n        }\n\n        //hard-coded pos\n        if (\n            is_input &&\n            num_slots > slot_number &&\n            this.inputs[slot_number].pos\n        ) {\n            out[0] = this.pos[0] + this.inputs[slot_number].pos[0];\n            out[1] = this.pos[1] + this.inputs[slot_number].pos[1];\n            return out;\n        } else if (\n            !is_input &&\n            num_slots > slot_number &&\n            this.outputs[slot_number].pos\n        ) {\n            out[0] = this.pos[0] + this.outputs[slot_number].pos[0];\n            out[1] = this.pos[1] + this.outputs[slot_number].pos[1];\n            return out;\n        }\n\n        //horizontal distributed slots\n        if (this.horizontal) {\n            out[0] =\n                this.pos[0] + (slot_number + 0.5) * (this.size[0] / num_slots);\n            if (is_input) {\n                out[1] = this.pos[1] - LiteGraph.NODE_TITLE_HEIGHT;\n            } else {\n                out[1] = this.pos[1] + this.size[1];\n            }\n            return out;\n        }\n\n        //default vertical slots\n        if (is_input) {\n            out[0] = this.pos[0] + offset;\n        } else {\n            out[0] = this.pos[0] + this.size[0] + 1 - offset;\n        }\n        out[1] =\n            this.pos[1] +\n            (slot_number + 0.7) * LiteGraph.NODE_SLOT_HEIGHT +\n            (this.constructor.slot_start_y || 0);\n        return out;\n    };\n\n    /* Force align to grid */\n    LGraphNode.prototype.alignToGrid = function() {\n        this.pos[0] =\n            LiteGraph.CANVAS_GRID_SIZE *\n            Math.round(this.pos[0] / LiteGraph.CANVAS_GRID_SIZE);\n        this.pos[1] =\n            LiteGraph.CANVAS_GRID_SIZE *\n            Math.round(this.pos[1] / LiteGraph.CANVAS_GRID_SIZE);\n    };\n\n    /* Console output */\n    LGraphNode.prototype.trace = function(msg) {\n        if (!this.console) {\n            this.console = [];\n        }\n\n        this.console.push(msg);\n        if (this.console.length > LGraphNode.MAX_CONSOLE) {\n            this.console.shift();\n        }\n\n\t\tif(this.graph.onNodeTrace)\n\t        this.graph.onNodeTrace(this, msg);\n    };\n\n    /* Forces to redraw or the main canvas (LGraphNode) or the bg canvas (links) */\n    LGraphNode.prototype.setDirtyCanvas = function(\n        dirty_foreground,\n        dirty_background\n    ) {\n        if (!this.graph) {\n            return;\n        }\n        this.graph.sendActionToCanvas(\"setDirty\", [\n            dirty_foreground,\n            dirty_background\n        ]);\n    };\n\n    LGraphNode.prototype.loadImage = function(url) {\n        var img = new Image();\n        img.src = LiteGraph.node_images_path + url;\n        img.ready = false;\n\n        var that = this;\n        img.onload = function() {\n            this.ready = true;\n            that.setDirtyCanvas(true);\n        };\n        return img;\n    };\n\n    //safe LGraphNode action execution (not sure if safe)\n    /*\nLGraphNode.prototype.executeAction = function(action)\n{\n\tif(action == \"\") return false;\n\n\tif( action.indexOf(\";\") != -1 || action.indexOf(\"}\") != -1)\n\t{\n\t\tthis.trace(\"Error: Action contains unsafe characters\");\n\t\treturn false;\n\t}\n\n\tvar tokens = action.split(\"(\");\n\tvar func_name = tokens[0];\n\tif( typeof(this[func_name]) != \"function\")\n\t{\n\t\tthis.trace(\"Error: Action not found on node: \" + func_name);\n\t\treturn false;\n\t}\n\n\tvar code = action;\n\n\ttry\n\t{\n\t\tvar _foo = eval;\n\t\teval = null;\n\t\t(new Function(\"with(this) { \" + code + \"}\")).call(this);\n\t\teval = _foo;\n\t}\n\tcatch (err)\n\t{\n\t\tthis.trace(\"Error executing action {\" + action + \"} :\" + err);\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n*/\n\n    /* Allows to get onMouseMove and onMouseUp events even if the mouse is out of focus */\n    LGraphNode.prototype.captureInput = function(v) {\n        if (!this.graph || !this.graph.list_of_graphcanvas) {\n            return;\n        }\n\n        var list = this.graph.list_of_graphcanvas;\n\n        for (var i = 0; i < list.length; ++i) {\n            var c = list[i];\n            //releasing somebody elses capture?!\n            if (!v && c.node_capturing_input != this) {\n                continue;\n            }\n\n            //change\n            c.node_capturing_input = v ? this : null;\n        }\n    };\n\n    /**\n     * Collapse the node to make it smaller on the canvas\n     * @method collapse\n     **/\n    LGraphNode.prototype.collapse = function(force) {\n        this.graph._version++;\n        if (this.constructor.collapsable === false && !force) {\n            return;\n        }\n        if (!this.flags.collapsed) {\n            this.flags.collapsed = true;\n        } else {\n            this.flags.collapsed = false;\n        }\n        this.setDirtyCanvas(true, true);\n    };\n\n    /**\n     * Forces the node to do not move or realign on Z\n     * @method pin\n     **/\n\n    LGraphNode.prototype.pin = function(v) {\n        this.graph._version++;\n        if (v === undefined) {\n            this.flags.pinned = !this.flags.pinned;\n        } else {\n            this.flags.pinned = v;\n        }\n    };\n\n    LGraphNode.prototype.localToScreen = function(x, y, graphcanvas) {\n        return [\n            (x + this.pos[0]) * graphcanvas.scale + graphcanvas.offset[0],\n            (y + this.pos[1]) * graphcanvas.scale + graphcanvas.offset[1]\n        ];\n    };\n\n    function LGraphGroup(title) {\n        this._ctor(title);\n    }\n\n    global.LGraphGroup = LiteGraph.LGraphGroup = LGraphGroup;\n\n    LGraphGroup.prototype._ctor = function(title) {\n        this.title = title || \"Group\";\n        this.font_size = 24;\n        this.color = LGraphCanvas.node_colors.pale_blue\n            ? LGraphCanvas.node_colors.pale_blue.groupcolor\n            : \"#AAA\";\n        this._bounding = new Float32Array([10, 10, 140, 80]);\n        this._pos = this._bounding.subarray(0, 2);\n        this._size = this._bounding.subarray(2, 4);\n        this._nodes = [];\n        this.graph = null;\n\n        Object.defineProperty(this, \"pos\", {\n            set: function(v) {\n                if (!v || v.length < 2) {\n                    return;\n                }\n                this._pos[0] = v[0];\n                this._pos[1] = v[1];\n            },\n            get: function() {\n                return this._pos;\n            },\n            enumerable: true\n        });\n\n        Object.defineProperty(this, \"size\", {\n            set: function(v) {\n                if (!v || v.length < 2) {\n                    return;\n                }\n                this._size[0] = Math.max(140, v[0]);\n                this._size[1] = Math.max(80, v[1]);\n            },\n            get: function() {\n                return this._size;\n            },\n            enumerable: true\n        });\n    };\n\n    LGraphGroup.prototype.configure = function(o) {\n        this.title = o.title;\n        this._bounding.set(o.bounding);\n        this.color = o.color;\n        this.font = o.font;\n    };\n\n    LGraphGroup.prototype.serialize = function() {\n        var b = this._bounding;\n        return {\n            title: this.title,\n            bounding: [\n                Math.round(b[0]),\n                Math.round(b[1]),\n                Math.round(b[2]),\n                Math.round(b[3])\n            ],\n            color: this.color,\n            font: this.font\n        };\n    };\n\n    LGraphGroup.prototype.move = function(deltax, deltay, ignore_nodes) {\n        this._pos[0] += deltax;\n        this._pos[1] += deltay;\n        if (ignore_nodes) {\n            return;\n        }\n        for (var i = 0; i < this._nodes.length; ++i) {\n            var node = this._nodes[i];\n            node.pos[0] += deltax;\n            node.pos[1] += deltay;\n        }\n    };\n\n    LGraphGroup.prototype.recomputeInsideNodes = function() {\n        this._nodes.length = 0;\n        var nodes = this.graph._nodes;\n        var node_bounding = new Float32Array(4);\n\n        for (var i = 0; i < nodes.length; ++i) {\n            var node = nodes[i];\n            node.getBounding(node_bounding);\n            if (!overlapBounding(this._bounding, node_bounding)) {\n                continue;\n            } //out of the visible area\n            this._nodes.push(node);\n        }\n    };\n\n    LGraphGroup.prototype.isPointInside = LGraphNode.prototype.isPointInside;\n    LGraphGroup.prototype.setDirtyCanvas = LGraphNode.prototype.setDirtyCanvas;\n\n    //****************************************\n\n    //Scale and Offset\n    function DragAndScale(element, skip_events) {\n        this.offset = new Float32Array([0, 0]);\n        this.scale = 1;\n        this.max_scale = 10;\n        this.min_scale = 0.1;\n        this.onredraw = null;\n        this.enabled = true;\n        this.last_mouse = [0, 0];\n        this.element = null;\n        this.visible_area = new Float32Array(4);\n\n        if (element) {\n            this.element = element;\n            if (!skip_events) {\n                this.bindEvents(element);\n            }\n        }\n    }\n\n    LiteGraph.DragAndScale = DragAndScale;\n\n    DragAndScale.prototype.bindEvents = function(element) {\n        this.last_mouse = new Float32Array(2);\n\n        this._binded_mouse_callback = this.onMouse.bind(this);\n\n\t\tLiteGraph.pointerListenerAdd(element,\"down\", this._binded_mouse_callback);\n\t\tLiteGraph.pointerListenerAdd(element,\"move\", this._binded_mouse_callback);\n\t\tLiteGraph.pointerListenerAdd(element,\"up\", this._binded_mouse_callback);\n\n        element.addEventListener(\n            \"mousewheel\",\n            this._binded_mouse_callback,\n            false\n        );\n        element.addEventListener(\"wheel\", this._binded_mouse_callback, false);\n    };\n\n    DragAndScale.prototype.computeVisibleArea = function( viewport ) {\n        if (!this.element) {\n            this.visible_area[0] = this.visible_area[1] = this.visible_area[2] = this.visible_area[3] = 0;\n            return;\n        }\n        var width = this.element.width;\n        var height = this.element.height;\n        var startx = -this.offset[0];\n        var starty = -this.offset[1];\n\t\tif( viewport )\n\t\t{\n\t\t\tstartx += viewport[0] / this.scale;\n\t\t\tstarty += viewport[1] / this.scale;\n\t\t\twidth = viewport[2];\n\t\t\theight = viewport[3];\n\t\t}\n        var endx = startx + width / this.scale;\n        var endy = starty + height / this.scale;\n        this.visible_area[0] = startx;\n        this.visible_area[1] = starty;\n        this.visible_area[2] = endx - startx;\n        this.visible_area[3] = endy - starty;\n    };\n\n    DragAndScale.prototype.onMouse = function(e) {\n        if (!this.enabled) {\n            return;\n        }\n\n        var canvas = this.element;\n        var rect = canvas.getBoundingClientRect();\n        var x = e.clientX - rect.left;\n        var y = e.clientY - rect.top;\n        e.canvasx = x;\n        e.canvasy = y;\n        e.dragging = this.dragging;\n        \n\t\tvar is_inside = !this.viewport || ( this.viewport && x >= this.viewport[0] && x < (this.viewport[0] + this.viewport[2]) && y >= this.viewport[1] && y < (this.viewport[1] + this.viewport[3]) );\n\n\t\t//console.log(\"pointerevents: DragAndScale onMouse \"+e.type+\" \"+is_inside);\n\t\t\n        var ignore = false;\n        if (this.onmouse) {\n            ignore = this.onmouse(e);\n        }\n\n        if (e.type == LiteGraph.pointerevents_method+\"down\" && is_inside) {\n            this.dragging = true;\n\t\t\tLiteGraph.pointerListenerRemove(canvas,\"move\",this._binded_mouse_callback);\n\t\t\tLiteGraph.pointerListenerAdd(document,\"move\",this._binded_mouse_callback);\n\t\t\tLiteGraph.pointerListenerAdd(document,\"up\",this._binded_mouse_callback);\n        } else if (e.type == LiteGraph.pointerevents_method+\"move\") {\n            if (!ignore) {\n                var deltax = x - this.last_mouse[0];\n                var deltay = y - this.last_mouse[1];\n                if (this.dragging) {\n                    this.mouseDrag(deltax, deltay);\n                }\n            }\n        } else if (e.type == LiteGraph.pointerevents_method+\"up\") {\n            this.dragging = false;\n\t\t\tLiteGraph.pointerListenerRemove(document,\"move\",this._binded_mouse_callback);\n\t\t\tLiteGraph.pointerListenerRemove(document,\"up\",this._binded_mouse_callback);\n\t\t\tLiteGraph.pointerListenerAdd(canvas,\"move\",this._binded_mouse_callback);\n        } else if ( is_inside &&\n            (e.type == \"mousewheel\" ||\n            e.type == \"wheel\" ||\n            e.type == \"DOMMouseScroll\")\n        ) {\n            e.eventType = \"mousewheel\";\n            if (e.type == \"wheel\") {\n                e.wheel = -e.deltaY;\n            } else {\n                e.wheel =\n                    e.wheelDeltaY != null ? e.wheelDeltaY : e.detail * -60;\n            }\n\n            //from stack overflow\n            e.delta = e.wheelDelta\n                ? e.wheelDelta / 40\n                : e.deltaY\n                ? -e.deltaY / 3\n                : 0;\n            this.changeDeltaScale(1.0 + e.delta * 0.05);\n        }\n\n        this.last_mouse[0] = x;\n        this.last_mouse[1] = y;\n\n\t\tif(is_inside)\n\t\t{\n\t        e.preventDefault();\n\t\t    e.stopPropagation();\n\t\t    return false;\n\t\t}\n    };\n\n    DragAndScale.prototype.toCanvasContext = function(ctx) {\n        ctx.scale(this.scale, this.scale);\n        ctx.translate(this.offset[0], this.offset[1]);\n    };\n\n    DragAndScale.prototype.convertOffsetToCanvas = function(pos) {\n        //return [pos[0] / this.scale - this.offset[0], pos[1] / this.scale - this.offset[1]];\n        return [\n            (pos[0] + this.offset[0]) * this.scale,\n            (pos[1] + this.offset[1]) * this.scale\n        ];\n    };\n\n    DragAndScale.prototype.convertCanvasToOffset = function(pos, out) {\n        out = out || [0, 0];\n        out[0] = pos[0] / this.scale - this.offset[0];\n        out[1] = pos[1] / this.scale - this.offset[1];\n        return out;\n    };\n\n    DragAndScale.prototype.mouseDrag = function(x, y) {\n        this.offset[0] += x / this.scale;\n        this.offset[1] += y / this.scale;\n\n        if (this.onredraw) {\n            this.onredraw(this);\n        }\n    };\n\n    DragAndScale.prototype.changeScale = function(value, zooming_center) {\n        if (value < this.min_scale) {\n            value = this.min_scale;\n        } else if (value > this.max_scale) {\n            value = this.max_scale;\n        }\n\n        if (value == this.scale) {\n            return;\n        }\n\n        if (!this.element) {\n            return;\n        }\n\n        var rect = this.element.getBoundingClientRect();\n        if (!rect) {\n            return;\n        }\n\n        zooming_center = zooming_center || [\n            rect.width * 0.5,\n            rect.height * 0.5\n        ];\n        var center = this.convertCanvasToOffset(zooming_center);\n        this.scale = value;\n        if (Math.abs(this.scale - 1) < 0.01) {\n            this.scale = 1;\n        }\n\n        var new_center = this.convertCanvasToOffset(zooming_center);\n        var delta_offset = [\n            new_center[0] - center[0],\n            new_center[1] - center[1]\n        ];\n\n        this.offset[0] += delta_offset[0];\n        this.offset[1] += delta_offset[1];\n\n        if (this.onredraw) {\n            this.onredraw(this);\n        }\n    };\n\n    DragAndScale.prototype.changeDeltaScale = function(value, zooming_center) {\n        this.changeScale(this.scale * value, zooming_center);\n    };\n\n    DragAndScale.prototype.reset = function() {\n        this.scale = 1;\n        this.offset[0] = 0;\n        this.offset[1] = 0;\n    };\n\n    //*********************************************************************************\n    // LGraphCanvas: LGraph renderer CLASS\n    //*********************************************************************************\n\n    /**\n     * This class is in charge of rendering one graph inside a canvas. And provides all the interaction required.\n     * Valid callbacks are: onNodeSelected, onNodeDeselected, onShowNodePanel, onNodeDblClicked\n     *\n     * @class LGraphCanvas\n     * @constructor\n     * @param {HTMLCanvas} canvas the canvas where you want to render (it accepts a selector in string format or the canvas element itself)\n     * @param {LGraph} graph [optional]\n     * @param {Object} options [optional] { skip_rendering, autoresize, viewport }\n     */\n    function LGraphCanvas(canvas, graph, options) {\n        this.options = options = options || {};\n\n        //if(graph === undefined)\n        //\tthrow (\"No graph assigned\");\n        this.background_image = LGraphCanvas.DEFAULT_BACKGROUND_IMAGE;\n\n        if (canvas && canvas.constructor === String) {\n            canvas = document.querySelector(canvas);\n        }\n\n        this.ds = new DragAndScale();\n        this.zoom_modify_alpha = true; //otherwise it generates ugly patterns when scaling down too much\n\n        this.title_text_font = \"\" + LiteGraph.NODE_TEXT_SIZE + \"px Arial\";\n        this.inner_text_font =\n            \"normal \" + LiteGraph.NODE_SUBTEXT_SIZE + \"px Arial\";\n        this.node_title_color = LiteGraph.NODE_TITLE_COLOR;\n        this.default_link_color = LiteGraph.LINK_COLOR;\n        this.default_connection_color = {\n            input_off: \"#778\",\n            input_on: \"#7F7\", //\"#BBD\"\n            output_off: \"#778\",\n            output_on: \"#7F7\" //\"#BBD\"\n\t\t};\n        this.default_connection_color_byType = {\n            /*number: \"#7F7\",\n            string: \"#77F\",\n            boolean: \"#F77\",*/\n        }\n        this.default_connection_color_byTypeOff = {\n            /*number: \"#474\",\n            string: \"#447\",\n            boolean: \"#744\",*/\n        };\n\n        this.highquality_render = true;\n        this.use_gradients = false; //set to true to render titlebar with gradients\n        this.editor_alpha = 1; //used for transition\n        this.pause_rendering = false;\n        this.clear_background = true;\n\n\t\tthis.read_only = false; //if set to true users cannot modify the graph\n        this.render_only_selected = true;\n        this.live_mode = false;\n        this.show_info = true;\n        this.allow_dragcanvas = true;\n        this.allow_dragnodes = true;\n        this.allow_interaction = true; //allow to control widgets, buttons, collapse, etc\n        this.allow_searchbox = true;\n        this.allow_reconnect_links = true; //allows to change a connection with having to redo it again\n\t\tthis.align_to_grid = false; //snap to grid\n\n        this.drag_mode = false;\n        this.dragging_rectangle = null;\n\n        this.filter = null; //allows to filter to only accept some type of nodes in a graph\n\n\t\tthis.set_canvas_dirty_on_mouse_event = true; //forces to redraw the canvas if the mouse does anything\n        this.always_render_background = false;\n        this.render_shadows = true;\n        this.render_canvas_border = true;\n        this.render_connections_shadows = false; //too much cpu\n        this.render_connections_border = true;\n        this.render_curved_connections = false;\n        this.render_connection_arrows = false;\n        this.render_collapsed_slots = true;\n        this.render_execution_order = false;\n        this.render_title_colored = true;\n\t\tthis.render_link_tooltip = true;\n\n        this.links_render_mode = LiteGraph.SPLINE_LINK;\n\n        this.mouse = [0, 0]; //mouse in canvas coordinates, where 0,0 is the top-left corner of the blue rectangle\n        this.graph_mouse = [0, 0]; //mouse in graph coordinates, where 0,0 is the top-left corner of the blue rectangle\n\t\tthis.canvas_mouse = this.graph_mouse; //LEGACY: REMOVE THIS, USE GRAPH_MOUSE INSTEAD\n\n        //to personalize the search box\n        this.onSearchBox = null;\n        this.onSearchBoxSelection = null;\n\n        //callbacks\n        this.onMouse = null;\n        this.onDrawBackground = null; //to render background objects (behind nodes and connections) in the canvas affected by transform\n        this.onDrawForeground = null; //to render foreground objects (above nodes and connections) in the canvas affected by transform\n        this.onDrawOverlay = null; //to render foreground objects not affected by transform (for GUIs)\n\t\tthis.onDrawLinkTooltip = null; //called when rendering a tooltip\n\t\tthis.onNodeMoved = null; //called after moving a node\n\t\tthis.onSelectionChange = null; //called if the selection changes\n\t\tthis.onConnectingChange = null; //called before any link changes\n\t\tthis.onBeforeChange = null; //called before modifying the graph\n\t\tthis.onAfterChange = null; //called after modifying the graph\n\n        this.connections_width = 3;\n        this.round_radius = 8;\n\n        this.current_node = null;\n        this.node_widget = null; //used for widgets\n\t\tthis.over_link_center = null;\n        this.last_mouse_position = [0, 0];\n        this.visible_area = this.ds.visible_area;\n        this.visible_links = [];\n\n\t\tthis.viewport = options.viewport || null; //to constraint render area to a portion of the canvas\n\n        //link canvas and graph\n        if (graph) {\n            graph.attachCanvas(this);\n        }\n\n        this.setCanvas(canvas,options.skip_events);\n        this.clear();\n\n        if (!options.skip_render) {\n            this.startRendering();\n        }\n\n        this.autoresize = options.autoresize;\n    }\n\n    global.LGraphCanvas = LiteGraph.LGraphCanvas = LGraphCanvas;\n\n\tLGraphCanvas.DEFAULT_BACKGROUND_IMAGE = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQBJREFUeNrs1rEKwjAUhlETUkj3vP9rdmr1Ysammk2w5wdxuLgcMHyptfawuZX4pJSWZTnfnu/lnIe/jNNxHHGNn//HNbbv+4dr6V+11uF527arU7+u63qfa/bnmh8sWLBgwYJlqRf8MEptXPBXJXa37BSl3ixYsGDBMliwFLyCV/DeLIMFCxYsWLBMwSt4Be/NggXLYMGCBUvBK3iNruC9WbBgwYJlsGApeAWv4L1ZBgsWLFiwYJmCV/AK3psFC5bBggULloJX8BpdwXuzYMGCBctgwVLwCl7Be7MMFixYsGDBsu8FH1FaSmExVfAxBa/gvVmwYMGCZbBg/W4vAQYA5tRF9QYlv/QAAAAASUVORK5CYII=\";\n\n    LGraphCanvas.link_type_colors = {\n        \"-1\": LiteGraph.EVENT_LINK_COLOR,\n        number: \"#AAA\",\n        node: \"#DCA\"\n    };\n    LGraphCanvas.gradients = {}; //cache of gradients\n\n    /**\n     * clears all the data inside\n     *\n     * @method clear\n     */\n    LGraphCanvas.prototype.clear = function() {\n        this.frame = 0;\n        this.last_draw_time = 0;\n        this.render_time = 0;\n        this.fps = 0;\n\n        //this.scale = 1;\n        //this.offset = [0,0];\n\n        this.dragging_rectangle = null;\n\n        this.selected_nodes = {};\n        this.selected_group = null;\n\n        this.visible_nodes = [];\n        this.node_dragged = null;\n        this.node_over = null;\n        this.node_capturing_input = null;\n        this.connecting_node = null;\n        this.highlighted_links = {};\n\n\t\tthis.dragging_canvas = false;\n\n        this.dirty_canvas = true;\n        this.dirty_bgcanvas = true;\n        this.dirty_area = null;\n\n        this.node_in_panel = null;\n        this.node_widget = null;\n\n        this.last_mouse = [0, 0];\n        this.last_mouseclick = 0;\n\t  \tthis.pointer_is_down = false;\n\t  \tthis.pointer_is_double = false;\n        this.visible_area.set([0, 0, 0, 0]);\n\n        if (this.onClear) {\n            this.onClear();\n        }\n    };\n\n    /**\n     * assigns a graph, you can reassign graphs to the same canvas\n     *\n     * @method setGraph\n     * @param {LGraph} graph\n     */\n    LGraphCanvas.prototype.setGraph = function(graph, skip_clear) {\n        if (this.graph == graph) {\n            return;\n        }\n\n        if (!skip_clear) {\n            this.clear();\n        }\n\n        if (!graph && this.graph) {\n            this.graph.detachCanvas(this);\n            return;\n        }\n\n        graph.attachCanvas(this);\n\n\t\t//remove the graph stack in case a subgraph was open\n\t\tif (this._graph_stack)\n\t\t\tthis._graph_stack = null;\n\n        this.setDirty(true, true);\n    };\n\n    /**\n     * returns the top level graph (in case there are subgraphs open on the canvas)\n     *\n     * @method getTopGraph\n     * @return {LGraph} graph\n     */\n\tLGraphCanvas.prototype.getTopGraph = function()\n\t{\n\t\tif(this._graph_stack.length)\n\t\t\treturn this._graph_stack[0];\n\t\treturn this.graph;\n\t}\n\n    /**\n     * opens a graph contained inside a node in the current graph\n     *\n     * @method openSubgraph\n     * @param {LGraph} graph\n     */\n    LGraphCanvas.prototype.openSubgraph = function(graph) {\n        if (!graph) {\n            throw \"graph cannot be null\";\n        }\n\n        if (this.graph == graph) {\n            throw \"graph cannot be the same\";\n        }\n\n        this.clear();\n\n        if (this.graph) {\n            if (!this._graph_stack) {\n                this._graph_stack = [];\n            }\n            this._graph_stack.push(this.graph);\n        }\n\n        graph.attachCanvas(this);\n\t\tthis.checkPanels();\n        this.setDirty(true, true);\n    };\n\n    /**\n     * closes a subgraph contained inside a node\n     *\n     * @method closeSubgraph\n     * @param {LGraph} assigns a graph\n     */\n    LGraphCanvas.prototype.closeSubgraph = function() {\n        if (!this._graph_stack || this._graph_stack.length == 0) {\n            return;\n        }\n        var subgraph_node = this.graph._subgraph_node;\n        var graph = this._graph_stack.pop();\n        this.selected_nodes = {};\n        this.highlighted_links = {};\n        graph.attachCanvas(this);\n        this.setDirty(true, true);\n        if (subgraph_node) {\n            this.centerOnNode(subgraph_node);\n            this.selectNodes([subgraph_node]);\n        }\n        // when close sub graph back to offset [0, 0] scale 1\n        this.ds.offset = [0, 0]\n        this.ds.scale = 1\n    };\n\n    /**\n     * returns the visualy active graph (in case there are more in the stack)\n     * @method getCurrentGraph\n     * @return {LGraph} the active graph\n     */\n    LGraphCanvas.prototype.getCurrentGraph = function() {\n        return this.graph;\n    };\n\n    /**\n     * assigns a canvas\n     *\n     * @method setCanvas\n     * @param {Canvas} assigns a canvas (also accepts the ID of the element (not a selector)\n     */\n    LGraphCanvas.prototype.setCanvas = function(canvas, skip_events) {\n        var that = this;\n\n        if (canvas) {\n            if (canvas.constructor === String) {\n                canvas = document.getElementById(canvas);\n                if (!canvas) {\n                    throw \"Error creating LiteGraph canvas: Canvas not found\";\n                }\n            }\n        }\n\n        if (canvas === this.canvas) {\n            return;\n        }\n\n        if (!canvas && this.canvas) {\n            //maybe detach events from old_canvas\n            if (!skip_events) {\n                this.unbindEvents();\n            }\n        }\n\n        this.canvas = canvas;\n        this.ds.element = canvas;\n\n        if (!canvas) {\n            return;\n        }\n\n        //this.canvas.tabindex = \"1000\";\n        canvas.className += \" lgraphcanvas\";\n        canvas.data = this;\n        canvas.tabindex = \"1\"; //to allow key events\n\n        //bg canvas: used for non changing stuff\n        this.bgcanvas = null;\n        if (!this.bgcanvas) {\n            this.bgcanvas = document.createElement(\"canvas\");\n            this.bgcanvas.width = this.canvas.width;\n            this.bgcanvas.height = this.canvas.height;\n        }\n\n        if (canvas.getContext == null) {\n            if (canvas.localName != \"canvas\") {\n                throw \"Element supplied for LGraphCanvas must be a <canvas> element, you passed a \" +\n                    canvas.localName;\n            }\n            throw \"This browser doesn't support Canvas\";\n        }\n\n        var ctx = (this.ctx = canvas.getContext(\"2d\"));\n        if (ctx == null) {\n            if (!canvas.webgl_enabled) {\n                console.warn(\n                    \"This canvas seems to be WebGL, enabling WebGL renderer\"\n                );\n            }\n            this.enableWebGL();\n        }\n\n        //input:  (move and up could be unbinded)\n        // why here? this._mousemove_callback = this.processMouseMove.bind(this);\n        // why here? this._mouseup_callback = this.processMouseUp.bind(this);\n\n        if (!skip_events) {\n            this.bindEvents();\n        }\n    };\n\n    //used in some events to capture them\n    LGraphCanvas.prototype._doNothing = function doNothing(e) {\n    \t//console.log(\"pointerevents: _doNothing \"+e.type);\n        e.preventDefault();\n        return false;\n    };\n    LGraphCanvas.prototype._doReturnTrue = function doNothing(e) {\n        e.preventDefault();\n        return true;\n    };\n\n    /**\n     * binds mouse, keyboard, touch and drag events to the canvas\n     * @method bindEvents\n     **/\n    LGraphCanvas.prototype.bindEvents = function() {\n        if (this._events_binded) {\n            console.warn(\"LGraphCanvas: events already binded\");\n            return;\n        }\n\n        //console.log(\"pointerevents: bindEvents\");\n        \n        var canvas = this.canvas;\n\n        var ref_window = this.getCanvasWindow();\n        var document = ref_window.document; //hack used when moving canvas between windows\n\n        this._mousedown_callback = this.processMouseDown.bind(this);\n        this._mousewheel_callback = this.processMouseWheel.bind(this);\n        // why mousemove and mouseup were not binded here?\n        this._mousemove_callback = this.processMouseMove.bind(this);\n        this._mouseup_callback = this.processMouseUp.bind(this);\n        \n        //touch events -- TODO IMPLEMENT\n        //this._touch_callback = this.touchHandler.bind(this);\n\n\t\tLiteGraph.pointerListenerAdd(canvas,\"down\", this._mousedown_callback, true); //down do not need to store the binded\n        canvas.addEventListener(\"mousewheel\", this._mousewheel_callback, false);\n\n        LiteGraph.pointerListenerAdd(canvas,\"up\", this._mouseup_callback, true); // CHECK: ??? binded or not\n\t\tLiteGraph.pointerListenerAdd(canvas,\"move\", this._mousemove_callback);\n        \n        canvas.addEventListener(\"contextmenu\", this._doNothing);\n        canvas.addEventListener(\n            \"DOMMouseScroll\",\n            this._mousewheel_callback,\n            false\n        );\n\n        //touch events -- THIS WAY DOES NOT WORK, finish implementing pointerevents, than clean the touchevents\n        /*if( 'touchstart' in document.documentElement )\n        {\n            canvas.addEventListener(\"touchstart\", this._touch_callback, true);\n            canvas.addEventListener(\"touchmove\", this._touch_callback, true);\n            canvas.addEventListener(\"touchend\", this._touch_callback, true);\n            canvas.addEventListener(\"touchcancel\", this._touch_callback, true);\n        }*/\n\n        //Keyboard ******************\n        this._key_callback = this.processKey.bind(this);\n\n        canvas.addEventListener(\"keydown\", this._key_callback, true);\n        document.addEventListener(\"keyup\", this._key_callback, true); //in document, otherwise it doesn't fire keyup\n\n        //Dropping Stuff over nodes ************************************\n        this._ondrop_callback = this.processDrop.bind(this);\n\n        canvas.addEventListener(\"dragover\", this._doNothing, false);\n        canvas.addEventListener(\"dragend\", this._doNothing, false);\n        canvas.addEventListener(\"drop\", this._ondrop_callback, false);\n        canvas.addEventListener(\"dragenter\", this._doReturnTrue, false);\n\n        this._events_binded = true;\n    };\n\n    /**\n     * unbinds mouse events from the canvas\n     * @method unbindEvents\n     **/\n    LGraphCanvas.prototype.unbindEvents = function() {\n        if (!this._events_binded) {\n            console.warn(\"LGraphCanvas: no events binded\");\n            return;\n        }\n\n        //console.log(\"pointerevents: unbindEvents\");\n        \n        var ref_window = this.getCanvasWindow();\n        var document = ref_window.document;\n\n\t\tLiteGraph.pointerListenerRemove(this.canvas,\"move\", this._mousedown_callback);\n        LiteGraph.pointerListenerRemove(this.canvas,\"up\", this._mousedown_callback);\n        LiteGraph.pointerListenerRemove(this.canvas,\"down\", this._mousedown_callback);\n        this.canvas.removeEventListener(\n            \"mousewheel\",\n            this._mousewheel_callback\n        );\n        this.canvas.removeEventListener(\n            \"DOMMouseScroll\",\n            this._mousewheel_callback\n        );\n        this.canvas.removeEventListener(\"keydown\", this._key_callback);\n        document.removeEventListener(\"keyup\", this._key_callback);\n        this.canvas.removeEventListener(\"contextmenu\", this._doNothing);\n        this.canvas.removeEventListener(\"drop\", this._ondrop_callback);\n        this.canvas.removeEventListener(\"dragenter\", this._doReturnTrue);\n\n        //touch events -- THIS WAY DOES NOT WORK, finish implementing pointerevents, than clean the touchevents\n        /*this.canvas.removeEventListener(\"touchstart\", this._touch_callback );\n        this.canvas.removeEventListener(\"touchmove\", this._touch_callback );\n        this.canvas.removeEventListener(\"touchend\", this._touch_callback );\n        this.canvas.removeEventListener(\"touchcancel\", this._touch_callback );*/\n\n        this._mousedown_callback = null;\n        this._mousewheel_callback = null;\n        this._key_callback = null;\n        this._ondrop_callback = null;\n\n        this._events_binded = false;\n    };\n\n    LGraphCanvas.getFileExtension = function(url) {\n        var question = url.indexOf(\"?\");\n        if (question != -1) {\n            url = url.substr(0, question);\n        }\n        var point = url.lastIndexOf(\".\");\n        if (point == -1) {\n            return \"\";\n        }\n        return url.substr(point + 1).toLowerCase();\n    };\n\n    /**\n     * this function allows to render the canvas using WebGL instead of Canvas2D\n     * this is useful if you plant to render 3D objects inside your nodes, it uses litegl.js for webgl and canvas2DtoWebGL to emulate the Canvas2D calls in webGL\n     * @method enableWebGL\n     **/\n    LGraphCanvas.prototype.enableWebGL = function() {\n        if (typeof GL === undefined) {\n            throw \"litegl.js must be included to use a WebGL canvas\";\n        }\n        if (typeof enableWebGLCanvas === undefined) {\n            throw \"webglCanvas.js must be included to use this feature\";\n        }\n\n        this.gl = this.ctx = enableWebGLCanvas(this.canvas);\n        this.ctx.webgl = true;\n        this.bgcanvas = this.canvas;\n        this.bgctx = this.gl;\n        this.canvas.webgl_enabled = true;\n\n        /*\n\tGL.create({ canvas: this.bgcanvas });\n\tthis.bgctx = enableWebGLCanvas( this.bgcanvas );\n\twindow.gl = this.gl;\n\t*/\n    };\n\n    /**\n     * marks as dirty the canvas, this way it will be rendered again\n     *\n     * @class LGraphCanvas\n     * @method setDirty\n     * @param {bool} fgcanvas if the foreground canvas is dirty (the one containing the nodes)\n     * @param {bool} bgcanvas if the background canvas is dirty (the one containing the wires)\n     */\n    LGraphCanvas.prototype.setDirty = function(fgcanvas, bgcanvas) {\n        if (fgcanvas) {\n            this.dirty_canvas = true;\n        }\n        if (bgcanvas) {\n            this.dirty_bgcanvas = true;\n        }\n    };\n\n    /**\n     * Used to attach the canvas in a popup\n     *\n     * @method getCanvasWindow\n     * @return {window} returns the window where the canvas is attached (the DOM root node)\n     */\n    LGraphCanvas.prototype.getCanvasWindow = function() {\n        if (!this.canvas) {\n            return window;\n        }\n        var doc = this.canvas.ownerDocument;\n        return doc.defaultView || doc.parentWindow;\n    };\n\n    /**\n     * starts rendering the content of the canvas when needed\n     *\n     * @method startRendering\n     */\n    LGraphCanvas.prototype.startRendering = function() {\n        if (this.is_rendering) {\n            return;\n        } //already rendering\n\n        this.is_rendering = true;\n        renderFrame.call(this);\n\n        function renderFrame() {\n            if (!this.pause_rendering) {\n                this.draw();\n            }\n\n            var window = this.getCanvasWindow();\n            if (this.is_rendering) {\n                window.requestAnimationFrame(renderFrame.bind(this));\n            }\n        }\n    };\n\n    /**\n     * stops rendering the content of the canvas (to save resources)\n     *\n     * @method stopRendering\n     */\n    LGraphCanvas.prototype.stopRendering = function() {\n        this.is_rendering = false;\n        /*\n\tif(this.rendering_timer_id)\n\t{\n\t\tclearInterval(this.rendering_timer_id);\n\t\tthis.rendering_timer_id = null;\n\t}\n\t*/\n    };\n\n    /* LiteGraphCanvas input */\n\n\t//used to block future mouse events (because of im gui)\n\tLGraphCanvas.prototype.blockClick = function()\n\t{\n\t\tthis.block_click = true;\n\t\tthis.last_mouseclick = 0;\n\t}\n\t\n    LGraphCanvas.prototype.processMouseDown = function(e) {\n    \t\n\t\tif( this.set_canvas_dirty_on_mouse_event )\n\t\t\tthis.dirty_canvas = true;\n\t\t\n\t\tif (!this.graph) {\n            return;\n        }\n\n        this.adjustMouseEvent(e);\n\n        var ref_window = this.getCanvasWindow();\n        var document = ref_window.document;\n        LGraphCanvas.active_canvas = this;\n        var that = this;\n\n\t\tvar x = e.clientX;\n\t\tvar y = e.clientY;\n\t\t//console.log(y,this.viewport);\n\t\t//console.log(\"pointerevents: processMouseDown pointerId:\"+e.pointerId+\" which:\"+e.which+\" isPrimary:\"+e.isPrimary+\" :: x y \"+x+\" \"+y);\n\n\t\tthis.ds.viewport = this.viewport;\n\t\tvar is_inside = !this.viewport || ( this.viewport && x >= this.viewport[0] && x < (this.viewport[0] + this.viewport[2]) && y >= this.viewport[1] && y < (this.viewport[1] + this.viewport[3]) );\n\n        //move mouse move event to the window in case it drags outside of the canvas\n\t\tif(!this.options.skip_events)\n\t\t{\n\t\t\tLiteGraph.pointerListenerRemove(this.canvas,\"move\", this._mousemove_callback);\n\t\t\tLiteGraph.pointerListenerAdd(ref_window.document,\"move\", this._mousemove_callback,true); //catch for the entire window\n\t\t\tLiteGraph.pointerListenerAdd(ref_window.document,\"up\", this._mouseup_callback,true);\n\t\t}\n\n\t\tif(!is_inside){\n\t\t\treturn;\n\t\t}\n\n        var node = this.graph.getNodeOnPos( e.canvasX, e.canvasY, this.visible_nodes, 5 );\n        var skip_dragging = false;\n        var skip_action = false;\n        var now = LiteGraph.getTime();\n\t\tvar is_primary = (e.isPrimary === undefined || !e.isPrimary);\n        var is_double_click = (now - this.last_mouseclick < 300) && is_primary;\n\t\tthis.mouse[0] = e.clientX;\n\t\tthis.mouse[1] = e.clientY;\n        this.graph_mouse[0] = e.canvasX;\n        this.graph_mouse[1] = e.canvasY;\n\t\tthis.last_click_position = [this.mouse[0],this.mouse[1]];\n\t  \t\n\t  \tif (this.pointer_is_down && is_primary ){\n\t\t  this.pointer_is_double = true;\n\t\t  //console.log(\"pointerevents: pointer_is_double start\");\n\t\t}else{\n\t\t  this.pointer_is_double = false;\n\t\t}\n\t  \tthis.pointer_is_down = true;\n\t  \n\t  \t\n        this.canvas.focus();\n\n        LiteGraph.closeAllContextMenus(ref_window);\n\n        if (this.onMouse)\n\t\t{\n            if (this.onMouse(e) == true)\n                return;\n        }\n\n\t\t//left button mouse / single finger\n        if (e.which == 1 && !this.pointer_is_double)\n\t\t{\n            if (e.ctrlKey)\n\t\t\t{\n                this.dragging_rectangle = new Float32Array(4);\n                this.dragging_rectangle[0] = e.canvasX;\n                this.dragging_rectangle[1] = e.canvasY;\n                this.dragging_rectangle[2] = 1;\n                this.dragging_rectangle[3] = 1;\n                skip_action = true;\n            }\n\n            // clone node ALT dragging\n            if (LiteGraph.alt_drag_do_clone_nodes && e.altKey && node && this.allow_interaction && !skip_action && !this.read_only)\n            {\n                if (cloned = node.clone()){\n                    cloned.pos[0] += 5;\n                    cloned.pos[1] += 5;\n                    this.graph.add(cloned,false,{doCalcSize: false});\n                    node = cloned;\n                    skip_action = true;\n                    if (!block_drag_node) {\n                        if (this.allow_dragnodes) {\n\t\t\t\t\t\t\tthis.graph.beforeChange();\n                            this.node_dragged = node;\n                        }\n                        if (!this.selected_nodes[node.id]) {\n                            this.processNodeSelected(node, e);\n                        }\n                    }\n                }\n            }\n            \n            var clicking_canvas_bg = false;\n\n            //when clicked on top of a node\n            //and it is not interactive\n            if (node && this.allow_interaction && !skip_action && !this.read_only) {\n                if (!this.live_mode && !node.flags.pinned) {\n                    this.bringToFront(node);\n                } //if it wasn't selected?\n\n                //not dragging mouse to connect two slots\n                if ( !this.connecting_node && !node.flags.collapsed && !this.live_mode ) {\n                    //Search for corner for resize\n                    if ( !skip_action &&\n                        node.resizable !== false &&\n                        isInsideRectangle( e.canvasX,\n                            e.canvasY,\n                            node.pos[0] + node.size[0] - 5,\n                            node.pos[1] + node.size[1] - 5,\n                            10,\n                            10\n                        )\n                    ) {\n\t\t\t\t\t\tthis.graph.beforeChange();\n                        this.resizing_node = node;\n                        this.canvas.style.cursor = \"se-resize\";\n                        skip_action = true;\n                    } else {\n                        //search for outputs\n                        if (node.outputs) {\n                            for ( var i = 0, l = node.outputs.length; i < l; ++i ) {\n                                var output = node.outputs[i];\n                                var link_pos = node.getConnectionPos(false, i);\n                                if (\n                                    isInsideRectangle(\n                                        e.canvasX,\n                                        e.canvasY,\n                                        link_pos[0] - 15,\n                                        link_pos[1] - 10,\n                                        30,\n                                        20\n                                    )\n                                ) {\n                                    this.connecting_node = node;\n                                    this.connecting_output = output;\n                                    this.connecting_output.slot_index = i;\n                                    this.connecting_pos = node.getConnectionPos( false, i );\n                                    this.connecting_slot = i;\n\n                                    if (LiteGraph.shift_click_do_break_link_from){\n                                        if (e.shiftKey) {\n                                            node.disconnectOutput(i);\n                                        }\n                                    }\n\n                                    if (is_double_click) {\n                                        if (node.onOutputDblClick) {\n                                            node.onOutputDblClick(i, e);\n                                        }\n                                    } else {\n                                        if (node.onOutputClick) {\n                                            node.onOutputClick(i, e);\n                                        }\n                                    }\n\n                                    skip_action = true;\n                                    break;\n                                }\n                            }\n                        }\n\n                        //search for inputs\n                        if (node.inputs) {\n                            for ( var i = 0, l = node.inputs.length; i < l; ++i ) {\n                                var input = node.inputs[i];\n                                var link_pos = node.getConnectionPos(true, i);\n                                if (\n                                    isInsideRectangle(\n                                        e.canvasX,\n                                        e.canvasY,\n                                        link_pos[0] - 15,\n                                        link_pos[1] - 10,\n                                        30,\n                                        20\n                                    )\n                                ) {\n                                    if (is_double_click) {\n                                        if (node.onInputDblClick) {\n                                            node.onInputDblClick(i, e);\n                                        }\n                                    } else {\n                                        if (node.onInputClick) {\n                                            node.onInputClick(i, e);\n                                        }\n                                    }\n\n                                    if (input.link !== null) {\n                                        var link_info = this.graph.links[\n                                            input.link\n                                        ]; //before disconnecting\n                                        if (LiteGraph.click_do_break_link_to){\n                                            node.disconnectInput(i);\n                                            this.dirty_bgcanvas = true;\n                                            skip_action = true;\n                                        }else{\n                                            // do same action as has not node ?\n                                        }\n\n                                        if (\n                                            this.allow_reconnect_links ||\n\t\t\t\t\t\t\t\t\t\t\t//this.move_destination_link_without_shift ||\n                                            e.shiftKey\n                                        ) {\n                                            if (!LiteGraph.click_do_break_link_to){\n                                                node.disconnectInput(i);\n                                            }\n                                            this.connecting_node = this.graph._nodes_by_id[\n                                                link_info.origin_id\n                                            ];\n                                            this.connecting_slot =\n                                                link_info.origin_slot;\n                                            this.connecting_output = this.connecting_node.outputs[\n                                                this.connecting_slot\n                                            ];\n                                            this.connecting_pos = this.connecting_node.getConnectionPos( false, this.connecting_slot );\n                                            \n                                            this.dirty_bgcanvas = true;\n                                            skip_action = true;\n                                        }\n\n                                        \n                                    }else{\n                                        // has not node\n                                    }\n                                    \n                                    if (!skip_action){\n                                        // connect from in to out, from to to from\n                                        this.connecting_node = node;\n                                        this.connecting_input = input;\n                                        this.connecting_input.slot_index = i;\n                                        this.connecting_pos = node.getConnectionPos( true, i );\n                                        this.connecting_slot = i;\n                                        \n                                        this.dirty_bgcanvas = true;\n                                        skip_action = true;\n                                    }\n                                }\n                            }\n                        }\n                    } //not resizing\n                }\n\n                //it wasn't clicked on the links boxes\n                if (!skip_action) {\n                    var block_drag_node = false;\n\t\t\t\t\tvar pos = [e.canvasX - node.pos[0], e.canvasY - node.pos[1]];\n\n                    //widgets\n                    var widget = this.processNodeWidgets( node, this.graph_mouse, e );\n                    if (widget) {\n                        block_drag_node = true;\n                        this.node_widget = [node, widget];\n                    }\n\n                    //double clicking\n                    if (is_double_click && this.selected_nodes[node.id]) {\n                        //double click node\n                        if (node.onDblClick) {\n                            node.onDblClick( e, pos, this );\n                        }\n                        this.processNodeDblClicked(node);\n                        block_drag_node = true;\n                    }\n\n                    //if do not capture mouse\n                    if ( node.onMouseDown && node.onMouseDown( e, pos, this ) ) {\n                        block_drag_node = true;\n                    } else {\n\t\t\t\t\t\t//open subgraph button\n\t\t\t\t\t\tif(node.subgraph && !node.skip_subgraph_button)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif ( !node.flags.collapsed && pos[0] > node.size[0] - LiteGraph.NODE_TITLE_HEIGHT && pos[1] < 0 ) {\n\t\t\t\t\t\t\t\tvar that = this;\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tthat.openSubgraph(node.subgraph);\n\t\t\t\t\t\t\t\t}, 10);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.live_mode) {\n\t\t\t\t\t\t\tclicking_canvas_bg = true;\n\t                        block_drag_node = true;\n\t\t\t\t\t\t}\n                    }\n\n                    if (!block_drag_node) {\n                        if (this.allow_dragnodes) {\n\t\t\t\t\t\t\tthis.graph.beforeChange();\n                            this.node_dragged = node;\n                        }\n                        if (!this.selected_nodes[node.id]) {\n                            this.processNodeSelected(node, e);\n                        }\n                    }\n\n                    this.dirty_canvas = true;\n                }\n            } //clicked outside of nodes\n            else {\n\t\t\t\tif (!skip_action){\n\t\t\t\t\t//search for link connector\n\t\t\t\t\tif(!this.read_only) {\n\t\t\t\t\t\tfor (var i = 0; i < this.visible_links.length; ++i) {\n\t\t\t\t\t\t\tvar link = this.visible_links[i];\n\t\t\t\t\t\t\tvar center = link._pos;\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t!center ||\n\t\t\t\t\t\t\t\te.canvasX < center[0] - 4 ||\n\t\t\t\t\t\t\t\te.canvasX > center[0] + 4 ||\n\t\t\t\t\t\t\t\te.canvasY < center[1] - 4 ||\n\t\t\t\t\t\t\t\te.canvasY > center[1] + 4\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//link clicked\n\t\t\t\t\t\t\tthis.showLinkMenu(link, e);\n\t\t\t\t\t\t\tthis.over_link_center = null; //clear tooltip\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selected_group = this.graph.getGroupOnPos( e.canvasX, e.canvasY );\n\t\t\t\t\tthis.selected_group_resizing = false;\n\t\t\t\t\tif (this.selected_group && !this.read_only ) {\n\t\t\t\t\t\tif (e.ctrlKey) {\n\t\t\t\t\t\t\tthis.dragging_rectangle = null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar dist = distance( [e.canvasX, e.canvasY], [ this.selected_group.pos[0] + this.selected_group.size[0], this.selected_group.pos[1] + this.selected_group.size[1] ] );\n\t\t\t\t\t\tif (dist * this.ds.scale < 10) {\n\t\t\t\t\t\t\tthis.selected_group_resizing = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.selected_group.recomputeInsideNodes();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (is_double_click && !this.read_only && this.allow_searchbox) {\n\t\t\t\t\t\tthis.showSearchBox(e);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\n\t\t\t\t\tclicking_canvas_bg = true;\n\t\t\t\t}\n            }\n\n            if (!skip_action && clicking_canvas_bg && this.allow_dragcanvas) {\n            \t//console.log(\"pointerevents: dragging_canvas start\");\n            \tthis.dragging_canvas = true;\n            }\n            \n        } else if (e.which == 2) {\n            //middle button\n        \t\n\t\t\tif (LiteGraph.middle_click_slot_add_default_node){\n\t\t\t\tif (node && this.allow_interaction && !skip_action && !this.read_only){\n\t\t\t\t\t//not dragging mouse to connect two slots\n\t\t\t\t\tif (\n\t\t\t\t\t\t!this.connecting_node &&\n\t\t\t\t\t\t!node.flags.collapsed &&\n\t\t\t\t\t\t!this.live_mode\n\t\t\t\t\t) {\n\t\t\t\t\t\tvar mClikSlot = false;\n\t\t\t\t\t\tvar mClikSlot_index = false;\n\t\t\t\t\t\tvar mClikSlot_isOut = false;\n\t\t\t\t\t\t//search for outputs\n\t\t\t\t\t\tif (node.outputs) {\n\t\t\t\t\t\t\tfor ( var i = 0, l = node.outputs.length; i < l; ++i ) {\n\t\t\t\t\t\t\t\tvar output = node.outputs[i];\n\t\t\t\t\t\t\t\tvar link_pos = node.getConnectionPos(false, i);\n\t\t\t\t\t\t\t\tif (isInsideRectangle(e.canvasX,e.canvasY,link_pos[0] - 15,link_pos[1] - 10,30,20)) {\n\t\t\t\t\t\t\t\t\tmClikSlot = output;\n\t\t\t\t\t\t\t\t\tmClikSlot_index = i;\n\t\t\t\t\t\t\t\t\tmClikSlot_isOut = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//search for inputs\n\t\t\t\t\t\tif (node.inputs) {\n\t\t\t\t\t\t\tfor ( var i = 0, l = node.inputs.length; i < l; ++i ) {\n\t\t\t\t\t\t\t\tvar input = node.inputs[i];\n\t\t\t\t\t\t\t\tvar link_pos = node.getConnectionPos(true, i);\n\t\t\t\t\t\t\t\tif (isInsideRectangle(e.canvasX,e.canvasY,link_pos[0] - 15,link_pos[1] - 10,30,20)) {\n\t\t\t\t\t\t\t\t\tmClikSlot = input;\n\t\t\t\t\t\t\t\t\tmClikSlot_index = i;\n\t\t\t\t\t\t\t\t\tmClikSlot_isOut = false;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//console.log(\"middleClickSlots? \"+mClikSlot+\" & \"+(mClikSlot_index!==false));\n\t\t\t\t\t\tif (mClikSlot && mClikSlot_index!==false){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar alphaPosY = 0.5-((mClikSlot_index+1)/((mClikSlot_isOut?node.outputs.length:node.inputs.length)));\n\t\t\t\t\t\t\tvar node_bounding = node.getBounding();\n\t\t\t\t\t\t\t// estimate a position: this is a bad semi-bad-working mess .. REFACTOR with a correct autoplacement that knows about the others slots and nodes\n\t\t\t\t\t\t\tvar posRef = [\t(!mClikSlot_isOut?node_bounding[0]:node_bounding[0]+node_bounding[2])// + node_bounding[0]/this.canvas.width*150\n\t\t\t\t\t\t\t\t\t\t\t,e.canvasY-80// + node_bounding[0]/this.canvas.width*66 // vertical \"derive\"\n\t\t\t\t\t\t\t\t\t\t  ];\n\t\t\t\t\t\t\tvar nodeCreated = this.createDefaultNodeForSlot({   \tnodeFrom: !mClikSlot_isOut?null:node\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,slotFrom: !mClikSlot_isOut?null:mClikSlot_index\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,nodeTo: !mClikSlot_isOut?node:null\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,slotTo: !mClikSlot_isOut?mClikSlot_index:null\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,position: posRef //,e: e\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,nodeType: \"AUTO\" //nodeNewType\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,posAdd:[!mClikSlot_isOut?-30:30, -alphaPosY*130] //-alphaPosY*30]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,posSizeFix:[!mClikSlot_isOut?-1:0, 0] //-alphaPosY*2*/\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n        \t\n        } else if (e.which == 3 || this.pointer_is_double) {\n\t\t\t\n            //right button\n\t\t\tif (this.allow_interaction && !skip_action && !this.read_only){\n\t\t\t\t\n\t\t\t\t// is it hover a node ?\n\t\t\t\tif (node){\n\t\t\t\t\tif(Object.keys(this.selected_nodes).length\n\t\t\t\t\t   && (this.selected_nodes[node.id] || e.shiftKey || e.ctrlKey || e.metaKey)\n\t\t\t\t\t){\n\t\t\t\t\t\t// is multiselected or using shift to include the now node\n\t\t\t\t\t\tif (!this.selected_nodes[node.id]) this.selectNodes([node],true); // add this if not present\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// update selection\n\t\t\t\t\t\tthis.selectNodes([node]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// show menu on this node\n\t\t\t\tthis.processContextMenu(node, e);\n\t\t\t}\n\t\t\t\n        }\n\n        //TODO\n        //if(this.node_selected != prev_selected)\n        //\tthis.onNodeSelectionChange(this.node_selected);\n\n        this.last_mouse[0] = e.clientX;\n        this.last_mouse[1] = e.clientY;\n        this.last_mouseclick = LiteGraph.getTime();\n        this.last_mouse_dragging = true;\n\n        /*\n\tif( (this.dirty_canvas || this.dirty_bgcanvas) && this.rendering_timer_id == null)\n\t\tthis.draw();\n\t*/\n\n        this.graph.change();\n\n        //this is to ensure to defocus(blur) if a text input element is on focus\n        if (\n            !ref_window.document.activeElement ||\n            (ref_window.document.activeElement.nodeName.toLowerCase() !=\n                \"input\" &&\n                ref_window.document.activeElement.nodeName.toLowerCase() !=\n                    \"textarea\")\n        ) {\n            e.preventDefault();\n        }\n        e.stopPropagation();\n\n        if (this.onMouseDown) {\n            this.onMouseDown(e);\n        }\n\n        return false;\n    };\n\n    /**\n     * Called when a mouse move event has to be processed\n     * @method processMouseMove\n     **/\n    LGraphCanvas.prototype.processMouseMove = function(e) {\n        if (this.autoresize) {\n            this.resize();\n        }\n\n\t\tif( this.set_canvas_dirty_on_mouse_event )\n\t\t\tthis.dirty_canvas = true;\n\n        if (!this.graph) {\n            return;\n        }\n\n        LGraphCanvas.active_canvas = this;\n        this.adjustMouseEvent(e);\n        var mouse = [e.clientX, e.clientY];\n\t\tthis.mouse[0] = mouse[0];\n\t\tthis.mouse[1] = mouse[1];\n        var delta = [\n            mouse[0] - this.last_mouse[0],\n            mouse[1] - this.last_mouse[1]\n        ];\n        this.last_mouse = mouse;\n        this.graph_mouse[0] = e.canvasX;\n        this.graph_mouse[1] = e.canvasY;\n\n        //console.log(\"pointerevents: processMouseMove \"+e.pointerId+\" \"+e.isPrimary);\n        \n\t\tif(this.block_click)\n\t\t{\n\t\t\t//console.log(\"pointerevents: processMouseMove block_click\");\n\t\t\te.preventDefault();\n\t\t\treturn false;\n\t\t}\n\n        e.dragging = this.last_mouse_dragging;\n\n        if (this.node_widget) {\n            this.processNodeWidgets(\n                this.node_widget[0],\n                this.graph_mouse,\n                e,\n                this.node_widget[1]\n            );\n            this.dirty_canvas = true;\n        }\n\n        if (this.dragging_rectangle)\n\t\t{\n            this.dragging_rectangle[2] = e.canvasX - this.dragging_rectangle[0];\n            this.dragging_rectangle[3] = e.canvasY - this.dragging_rectangle[1];\n            this.dirty_canvas = true;\n        } \n\t\telse if (this.selected_group && !this.read_only)\n\t\t{\n            //moving/resizing a group\n            if (this.selected_group_resizing) {\n                this.selected_group.size = [\n                    e.canvasX - this.selected_group.pos[0],\n                    e.canvasY - this.selected_group.pos[1]\n                ];\n            } else {\n                var deltax = delta[0] / this.ds.scale;\n                var deltay = delta[1] / this.ds.scale;\n                this.selected_group.move(deltax, deltay, e.ctrlKey);\n                if (this.selected_group._nodes.length) {\n                    this.dirty_canvas = true;\n                }\n            }\n            this.dirty_bgcanvas = true;\n        } else if (this.dragging_canvas) {\n        \t////console.log(\"pointerevents: processMouseMove is dragging_canvas\");\n            this.ds.offset[0] += delta[0] / this.ds.scale;\n            this.ds.offset[1] += delta[1] / this.ds.scale;\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n        } else if (this.allow_interaction && !this.read_only) {\n            if (this.connecting_node) {\n                this.dirty_canvas = true;\n            }\n\n            //get node over\n            var node = this.graph.getNodeOnPos(e.canvasX,e.canvasY,this.visible_nodes);\n\n            //remove mouseover flag\n            for (var i = 0, l = this.graph._nodes.length; i < l; ++i) {\n                if (this.graph._nodes[i].mouseOver && node != this.graph._nodes[i] ) {\n                    //mouse leave\n                    this.graph._nodes[i].mouseOver = false;\n                    if (this.node_over && this.node_over.onMouseLeave) {\n                        this.node_over.onMouseLeave(e);\n                    }\n                    this.node_over = null;\n                    this.dirty_canvas = true;\n                }\n            }\n\n            //mouse over a node\n            if (node) {\n\n\t\t\t\tif(node.redraw_on_mouse)\n                    this.dirty_canvas = true;\n\n                //this.canvas.style.cursor = \"move\";\n                if (!node.mouseOver) {\n                    //mouse enter\n                    node.mouseOver = true;\n                    this.node_over = node;\n                    this.dirty_canvas = true;\n\n                    if (node.onMouseEnter) {\n                        node.onMouseEnter(e);\n                    }\n                }\n\n                //in case the node wants to do something\n                if (node.onMouseMove) {\n                    node.onMouseMove( e, [e.canvasX - node.pos[0], e.canvasY - node.pos[1]], this );\n                }\n\n                //if dragging a link\n                if (this.connecting_node) {\n                    \n                    if (this.connecting_output){\n                        \n                        var pos = this._highlight_input || [0, 0]; //to store the output of isOverNodeInput\n\n                        //on top of input\n                        if (this.isOverNodeBox(node, e.canvasX, e.canvasY)) {\n                            //mouse on top of the corner box, don't know what to do\n                        } else {\n                            //check if I have a slot below de mouse\n                            var slot = this.isOverNodeInput( node, e.canvasX, e.canvasY, pos );\n                            if (slot != -1 && node.inputs[slot]) {\n                                var slot_type = node.inputs[slot].type;\n                                if ( LiteGraph.isValidConnection( this.connecting_output.type, slot_type ) ) {\n                                    this._highlight_input = pos;\n\t\t\t\t\t\t\t\t\tthis._highlight_input_slot = node.inputs[slot]; // XXX CHECK THIS\n                                }\n                            } else {\n                                this._highlight_input = null;\n\t\t\t\t\t\t\t\tthis._highlight_input_slot = null;  // XXX CHECK THIS\n                            }\n                        }\n                        \n                    }else if(this.connecting_input){\n                        \n                        var pos = this._highlight_output || [0, 0]; //to store the output of isOverNodeOutput\n\n                        //on top of output\n                        if (this.isOverNodeBox(node, e.canvasX, e.canvasY)) {\n                            //mouse on top of the corner box, don't know what to do\n                        } else {\n                            //check if I have a slot below de mouse\n                            var slot = this.isOverNodeOutput( node, e.canvasX, e.canvasY, pos );\n                            if (slot != -1 && node.outputs[slot]) {\n                                var slot_type = node.outputs[slot].type;\n                                if ( LiteGraph.isValidConnection( this.connecting_input.type, slot_type ) ) {\n                                    this._highlight_output = pos;\n                                }\n                            } else {\n                                this._highlight_output = null;\n                            }\n                        }\n                    }\n                }\n\n                //Search for corner\n                if (this.canvas) {\n                    if (\n                        isInsideRectangle(\n                            e.canvasX,\n                            e.canvasY,\n                            node.pos[0] + node.size[0] - 5,\n                            node.pos[1] + node.size[1] - 5,\n                            5,\n                            5\n                        )\n                    ) {\n                        this.canvas.style.cursor = \"se-resize\";\n                    } else {\n                        this.canvas.style.cursor = \"crosshair\";\n                    }\n                }\n            } else { //not over a node\n\n                //search for link connector\n\t\t\t\tvar over_link = null;\n\t\t\t\tfor (var i = 0; i < this.visible_links.length; ++i) {\n\t\t\t\t\tvar link = this.visible_links[i];\n\t\t\t\t\tvar center = link._pos;\n\t\t\t\t\tif (\n\t\t\t\t\t\t!center ||\n\t\t\t\t\t\te.canvasX < center[0] - 4 ||\n\t\t\t\t\t\te.canvasX > center[0] + 4 ||\n\t\t\t\t\t\te.canvasY < center[1] - 4 ||\n\t\t\t\t\t\te.canvasY > center[1] + 4\n\t\t\t\t\t) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tover_link = link;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif( over_link != this.over_link_center )\n\t\t\t\t{\n\t\t\t\t\tthis.over_link_center = over_link;\n\t                this.dirty_canvas = true;\n\t\t\t\t}\n\n\t\t\t\tif (this.canvas) {\n\t                this.canvas.style.cursor = \"\";\n\t\t\t\t}\n\t\t\t} //end\n\n\t\t\t//send event to node if capturing input (used with widgets that allow drag outside of the area of the node)\n            if ( this.node_capturing_input && this.node_capturing_input != node && this.node_capturing_input.onMouseMove ) {\n                this.node_capturing_input.onMouseMove(e,[e.canvasX - this.node_capturing_input.pos[0],e.canvasY - this.node_capturing_input.pos[1]], this);\n            }\n\n\t\t\t//node being dragged\n            if (this.node_dragged && !this.live_mode) {\n\t\t\t\t//console.log(\"draggin!\",this.selected_nodes);\n                for (var i in this.selected_nodes) {\n                    var n = this.selected_nodes[i];\n                    n.pos[0] += delta[0] / this.ds.scale;\n                    n.pos[1] += delta[1] / this.ds.scale;\n                }\n\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n            }\n\n            if (this.resizing_node && !this.live_mode) {\n                //convert mouse to node space\n\t\t\t\tvar desired_size = [ e.canvasX - this.resizing_node.pos[0], e.canvasY - this.resizing_node.pos[1] ];\n\t\t\t\tvar min_size = this.resizing_node.computeSize();\n\t\t\t\tdesired_size[0] = Math.max( min_size[0], desired_size[0] );\n\t\t\t\tdesired_size[1] = Math.max( min_size[1], desired_size[1] );\n\t\t\t\tthis.resizing_node.setSize( desired_size );\n\n                this.canvas.style.cursor = \"se-resize\";\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n            }\n        }\n\n        e.preventDefault();\n        return false;\n    };\n\n    /**\n     * Called when a mouse up event has to be processed\n     * @method processMouseUp\n     **/\n    LGraphCanvas.prototype.processMouseUp = function(e) {\n\n\t\tvar is_primary = ( e.isPrimary === undefined || e.isPrimary );\n\n    \t//early exit for extra pointer\n    \tif(!is_primary){\n    \t\t/*e.stopPropagation();\n        \te.preventDefault();*/\n    \t\t//console.log(\"pointerevents: processMouseUp pointerN_stop \"+e.pointerId+\" \"+e.isPrimary);\n    \t\treturn false;\n    \t}\n    \t\n    \t//console.log(\"pointerevents: processMouseUp \"+e.pointerId+\" \"+e.isPrimary+\" :: \"+e.clientX+\" \"+e.clientY);\n    \t\n\t\tif( this.set_canvas_dirty_on_mouse_event )\n\t\t\tthis.dirty_canvas = true;\n\n        if (!this.graph)\n            return;\n\n        var window = this.getCanvasWindow();\n        var document = window.document;\n        LGraphCanvas.active_canvas = this;\n\n        //restore the mousemove event back to the canvas\n\t\tif(!this.options.skip_events)\n\t\t{\n\t\t\t//console.log(\"pointerevents: processMouseUp adjustEventListener\");\n\t\t\tLiteGraph.pointerListenerRemove(document,\"move\", this._mousemove_callback,true);\n\t\t\tLiteGraph.pointerListenerAdd(this.canvas,\"move\", this._mousemove_callback,true);\n\t\t\tLiteGraph.pointerListenerRemove(document,\"up\", this._mouseup_callback,true);\n\t\t}\n\n        this.adjustMouseEvent(e);\n        var now = LiteGraph.getTime();\n        e.click_time = now - this.last_mouseclick;\n        this.last_mouse_dragging = false;\n\t\tthis.last_click_position = null;\n\n\t\tif(this.block_click)\n\t\t{\n\t\t\t//console.log(\"pointerevents: processMouseUp block_clicks\");\n\t\t\tthis.block_click = false; //used to avoid sending twice a click in a immediate button\n\t\t}\n\n\t\t//console.log(\"pointerevents: processMouseUp which: \"+e.which);\n\t\t\n        if (e.which == 1) {\n\n\t\t\tif( this.node_widget )\n\t\t\t{\n\t\t\t\tthis.processNodeWidgets( this.node_widget[0], this.graph_mouse, e );\n\t\t\t}\n\n            //left button\n            this.node_widget = null;\n\n            if (this.selected_group) {\n                var diffx =\n                    this.selected_group.pos[0] -\n                    Math.round(this.selected_group.pos[0]);\n                var diffy =\n                    this.selected_group.pos[1] -\n                    Math.round(this.selected_group.pos[1]);\n                this.selected_group.move(diffx, diffy, e.ctrlKey);\n                this.selected_group.pos[0] = Math.round(\n                    this.selected_group.pos[0]\n                );\n                this.selected_group.pos[1] = Math.round(\n                    this.selected_group.pos[1]\n                );\n                if (this.selected_group._nodes.length) {\n                    this.dirty_canvas = true;\n                }\n                this.selected_group = null;\n            }\n            this.selected_group_resizing = false;\n\n\t\t\tvar node = this.graph.getNodeOnPos(\n\t\t\t\t\t\t\te.canvasX,\n\t\t\t\t\t\t\te.canvasY,\n\t\t\t\t\t\t\tthis.visible_nodes\n\t\t\t\t\t\t);\n\t\t\t\n            if (this.dragging_rectangle) {\n                if (this.graph) {\n                    var nodes = this.graph._nodes;\n                    var node_bounding = new Float32Array(4);\n                    \n                    //compute bounding and flip if left to right\n                    var w = Math.abs(this.dragging_rectangle[2]);\n                    var h = Math.abs(this.dragging_rectangle[3]);\n                    var startx =\n                        this.dragging_rectangle[2] < 0\n                            ? this.dragging_rectangle[0] - w\n                            : this.dragging_rectangle[0];\n                    var starty =\n                        this.dragging_rectangle[3] < 0\n                            ? this.dragging_rectangle[1] - h\n                            : this.dragging_rectangle[1];\n                    this.dragging_rectangle[0] = startx;\n                    this.dragging_rectangle[1] = starty;\n                    this.dragging_rectangle[2] = w;\n                    this.dragging_rectangle[3] = h;\n\n\t\t\t\t\t// test dragging rect size, if minimun simulate a click\n\t\t\t\t\tif (!node || (w > 10 && h > 10 )){\n\t\t\t\t\t\t//test against all nodes (not visible because the rectangle maybe start outside\n\t\t\t\t\t\tvar to_select = [];\n\t\t\t\t\t\tfor (var i = 0; i < nodes.length; ++i) {\n\t\t\t\t\t\t\tvar nodeX = nodes[i];\n\t\t\t\t\t\t\tnodeX.getBounding(node_bounding);\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t!overlapBounding(\n\t\t\t\t\t\t\t\t\tthis.dragging_rectangle,\n\t\t\t\t\t\t\t\t\tnode_bounding\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t} //out of the visible area\n\t\t\t\t\t\t\tto_select.push(nodeX);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (to_select.length) {\n\t\t\t\t\t\t\tthis.selectNodes(to_select,e.shiftKey); // add to selection with shift\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// will select of update selection\n\t\t\t\t\t\tthis.selectNodes([node],e.shiftKey||e.ctrlKey); // add to selection add to selection with ctrlKey or shiftKey\n\t\t\t\t\t}\n\t\t\t\t\t\n                }\n                this.dragging_rectangle = null;\n            } else if (this.connecting_node) {\n                //dragging a connection\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n\n                var connInOrOut = this.connecting_output || this.connecting_input;\n                var connType = connInOrOut.type;\n                \n                //node below mouse\n                if (node) {\n                    \n                    /* no need to condition on event type.. just another type\n                    if (\n                        connType == LiteGraph.EVENT &&\n                        this.isOverNodeBox(node, e.canvasX, e.canvasY)\n                    ) {\n                        \n                        this.connecting_node.connect(\n                            this.connecting_slot,\n                            node,\n                            LiteGraph.EVENT\n                        );\n                        \n                    } else {*/\n                        \n                        //slot below mouse? connect\n                        \n                        if (this.connecting_output){\n                            \n                            var slot = this.isOverNodeInput(\n                                node,\n                                e.canvasX,\n                                e.canvasY\n                            );\n                            if (slot != -1) {\n                                this.connecting_node.connect(this.connecting_slot, node, slot);\n                            } else {\n                                //not on top of an input\n                                // look for a good slot\n                                this.connecting_node.connectByType(this.connecting_slot,node,connType);\n                            }\n                            \n                        }else if (this.connecting_input){\n                            \n                            var slot = this.isOverNodeOutput(\n                                node,\n                                e.canvasX,\n                                e.canvasY\n                            );\n\n                            if (slot != -1) {\n                                node.connect(slot, this.connecting_node, this.connecting_slot); // this is inverted has output-input nature like\n                            } else {\n                                //not on top of an input\n                                // look for a good slot\n                                this.connecting_node.connectByTypeOutput(this.connecting_slot,node,connType);\n                            }\n                            \n                        }\n                        \n                        \n                    //}\n                    \n                }else{\n                    \n                    // add menu when releasing link in empty space\n                \tif (LiteGraph.release_link_on_empty_shows_menu){\n\t                    if (e.shiftKey && this.allow_searchbox){\n\t                        if(this.connecting_output){\n\t                            this.showSearchBox(e,{node_from: this.connecting_node, slot_from: this.connecting_output, type_filter_in: this.connecting_output.type});\n\t                        }else if(this.connecting_input){\n\t                            this.showSearchBox(e,{node_to: this.connecting_node, slot_from: this.connecting_input, type_filter_out: this.connecting_input.type});\n\t                        }\n\t                    }else{\n\t                        if(this.connecting_output){\n\t                            this.showConnectionMenu({nodeFrom: this.connecting_node, slotFrom: this.connecting_output, e: e});\n\t                        }else if(this.connecting_input){\n\t                            this.showConnectionMenu({nodeTo: this.connecting_node, slotTo: this.connecting_input, e: e});\n\t                        }\n\t                    }\n                \t}\n                }\n\n                this.connecting_output = null;\n                this.connecting_input = null;\n                this.connecting_pos = null;\n                this.connecting_node = null;\n                this.connecting_slot = -1;\n            } //not dragging connection\n            else if (this.resizing_node) {\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n\t\t\t\tthis.graph.afterChange(this.resizing_node);\n                this.resizing_node = null;\n            } else if (this.node_dragged) {\n                //node being dragged?\n                var node = this.node_dragged;\n                if (\n                    node &&\n                    e.click_time < 300 &&\n                    isInsideRectangle( e.canvasX, e.canvasY, node.pos[0], node.pos[1] - LiteGraph.NODE_TITLE_HEIGHT, LiteGraph.NODE_TITLE_HEIGHT, LiteGraph.NODE_TITLE_HEIGHT )\n                ) {\n                    node.collapse();\n                }\n\n                this.dirty_canvas = true;\n                this.dirty_bgcanvas = true;\n                this.node_dragged.pos[0] = Math.round(this.node_dragged.pos[0]);\n                this.node_dragged.pos[1] = Math.round(this.node_dragged.pos[1]);\n                if (this.graph.config.align_to_grid || this.align_to_grid ) {\n                    this.node_dragged.alignToGrid();\n                }\n\t\t\t\tif( this.onNodeMoved )\n\t\t\t\t\tthis.onNodeMoved( this.node_dragged );\n\t\t\t\tthis.graph.afterChange(this.node_dragged);\n                this.node_dragged = null;\n            } //no node being dragged\n            else {\n                //get node over\n                var node = this.graph.getNodeOnPos(\n                    e.canvasX,\n                    e.canvasY,\n                    this.visible_nodes\n                );\n\n                if (!node && e.click_time < 300) {\n                    this.deselectAllNodes();\n                }\n\n                this.dirty_canvas = true;\n                this.dragging_canvas = false;\n\n                if (this.node_over && this.node_over.onMouseUp) {\n                    this.node_over.onMouseUp( e, [ e.canvasX - this.node_over.pos[0], e.canvasY - this.node_over.pos[1] ], this );\n                }\n                if (\n                    this.node_capturing_input &&\n                    this.node_capturing_input.onMouseUp\n                ) {\n                    this.node_capturing_input.onMouseUp(e, [\n                        e.canvasX - this.node_capturing_input.pos[0],\n                        e.canvasY - this.node_capturing_input.pos[1]\n                    ]);\n                }\n            }\n        } else if (e.which == 2) {\n            //middle button\n            //trace(\"middle\");\n            this.dirty_canvas = true;\n            this.dragging_canvas = false;\n        } else if (e.which == 3) {\n            //right button\n            //trace(\"right\");\n            this.dirty_canvas = true;\n            this.dragging_canvas = false;\n        }\n\n        /*\n\t\tif((this.dirty_canvas || this.dirty_bgcanvas) && this.rendering_timer_id == null)\n\t\t\tthis.draw();\n\t\t*/\n\n\t  \tif (is_primary)\n\t\t{\n\t\t\tthis.pointer_is_down = false;\n\t\t\tthis.pointer_is_double = false;\n\t\t}\n\t  \n        this.graph.change();\n\n        //console.log(\"pointerevents: processMouseUp stopPropagation\");\n        e.stopPropagation();\n        e.preventDefault();\n        return false;\n    };\n\n    /**\n     * Called when a mouse wheel event has to be processed\n     * @method processMouseWheel\n     **/\n    LGraphCanvas.prototype.processMouseWheel = function(e) {\n        if (!this.graph || !this.allow_dragcanvas) {\n            return;\n        }\n\n        var delta = e.wheelDeltaY != null ? e.wheelDeltaY : e.detail * -60;\n\n        this.adjustMouseEvent(e);\n\n\t\tvar x = e.clientX;\n\t\tvar y = e.clientY;\n\t\tvar is_inside = !this.viewport || ( this.viewport && x >= this.viewport[0] && x < (this.viewport[0] + this.viewport[2]) && y >= this.viewport[1] && y < (this.viewport[1] + this.viewport[3]) );\n\t\tif(!is_inside)\n\t\t\treturn;\n\n        var scale = this.ds.scale;\n\n        if (delta > 0) {\n            scale *= 1.1;\n        } else if (delta < 0) {\n            scale *= 1 / 1.1;\n        }\n\n        //this.setZoom( scale, [ e.clientX, e.clientY ] );\n        this.ds.changeScale(scale, [e.clientX, e.clientY]);\n\n        this.graph.change();\n\n        e.preventDefault();\n        return false; // prevent default\n    };\n\n    /**\n     * returns true if a position (in graph space) is on top of a node little corner box\n     * @method isOverNodeBox\n     **/\n    LGraphCanvas.prototype.isOverNodeBox = function(node, canvasx, canvasy) {\n        var title_height = LiteGraph.NODE_TITLE_HEIGHT;\n        if (\n            isInsideRectangle(\n                canvasx,\n                canvasy,\n                node.pos[0] + 2,\n                node.pos[1] + 2 - title_height,\n                title_height - 4,\n                title_height - 4\n            )\n        ) {\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * returns the INDEX if a position (in graph space) is on top of a node input slot\n     * @method isOverNodeInput\n     **/\n    LGraphCanvas.prototype.isOverNodeInput = function(\n        node,\n        canvasx,\n        canvasy,\n        slot_pos\n    ) {\n        if (node.inputs) {\n            for (var i = 0, l = node.inputs.length; i < l; ++i) {\n                var input = node.inputs[i];\n                var link_pos = node.getConnectionPos(true, i);\n                var is_inside = false;\n                if (node.horizontal) {\n                    is_inside = isInsideRectangle(\n                        canvasx,\n                        canvasy,\n                        link_pos[0] - 5,\n                        link_pos[1] - 10,\n                        10,\n                        20\n                    );\n                } else {\n                    is_inside = isInsideRectangle(\n                        canvasx,\n                        canvasy,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        40,\n                        10\n                    );\n                }\n                if (is_inside) {\n                    if (slot_pos) {\n                        slot_pos[0] = link_pos[0];\n                        slot_pos[1] = link_pos[1];\n                    }\n                    return i;\n                }\n            }\n        }\n        return -1;\n    };\n    \n    /**\n     * returns the INDEX if a position (in graph space) is on top of a node output slot\n     * @method isOverNodeOuput\n     **/\n    LGraphCanvas.prototype.isOverNodeOutput = function(\n        node,\n        canvasx,\n        canvasy,\n        slot_pos\n    ) {\n        if (node.outputs) {\n            for (var i = 0, l = node.outputs.length; i < l; ++i) {\n                var output = node.outputs[i];\n                var link_pos = node.getConnectionPos(false, i);\n                var is_inside = false;\n                if (node.horizontal) {\n                    is_inside = isInsideRectangle(\n                        canvasx,\n                        canvasy,\n                        link_pos[0] - 5,\n                        link_pos[1] - 10,\n                        10,\n                        20\n                    );\n                } else {\n                    is_inside = isInsideRectangle(\n                        canvasx,\n                        canvasy,\n                        link_pos[0] - 10,\n                        link_pos[1] - 5,\n                        40,\n                        10\n                    );\n                }\n                if (is_inside) {\n                    if (slot_pos) {\n                        slot_pos[0] = link_pos[0];\n                        slot_pos[1] = link_pos[1];\n                    }\n                    return i;\n                }\n            }\n        }\n        return -1;\n    };\n\n    /**\n     * process a key event\n     * @method processKey\n     **/\n    LGraphCanvas.prototype.processKey = function(e) {\n        if (!this.graph) {\n            return;\n        }\n\n        var block_default = false;\n        //console.log(e); //debug\n\n        if (e.target.localName == \"input\") {\n            return;\n        }\n\n        if (e.type == \"keydown\") {\n            if (e.keyCode == 32) {\n                //space\n                this.dragging_canvas = true;\n                block_default = true;\n            }\n            \n            if (e.keyCode == 27) {\n                //esc\n                if(this.node_panel) this.node_panel.close();\n                if(this.options_panel) this.options_panel.close();\n                block_default = true;\n            }\n\n            //select all Control A\n            if (e.keyCode == 65 && e.ctrlKey) {\n                this.selectNodes();\n                block_default = true;\n            }\n\n            if (e.code == \"KeyC\" && (e.metaKey || e.ctrlKey) && !e.shiftKey) {\n                //copy\n                if (this.selected_nodes) {\n                    this.copyToClipboard();\n                    block_default = true;\n                }\n            }\n\n            if (e.code == \"KeyV\" && (e.metaKey || e.ctrlKey) && !e.shiftKey) {\n                //paste\n                this.pasteFromClipboard();\n            }\n\n            //delete or backspace\n            if (e.keyCode == 46 || e.keyCode == 8) {\n                if (\n                    e.target.localName != \"input\" &&\n                    e.target.localName != \"textarea\"\n                ) {\n                    this.deleteSelectedNodes();\n                    block_default = true;\n                }\n            }\n\n            //collapse\n            //...\n\n            //TODO\n            if (this.selected_nodes) {\n                for (var i in this.selected_nodes) {\n                    if (this.selected_nodes[i].onKeyDown) {\n                        this.selected_nodes[i].onKeyDown(e);\n                    }\n                }\n            }\n        } else if (e.type == \"keyup\") {\n            if (e.keyCode == 32) {\n                // space\n                this.dragging_canvas = false;\n            }\n\n            if (this.selected_nodes) {\n                for (var i in this.selected_nodes) {\n                    if (this.selected_nodes[i].onKeyUp) {\n                        this.selected_nodes[i].onKeyUp(e);\n                    }\n                }\n            }\n        }\n\n        this.graph.change();\n\n        if (block_default) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            return false;\n        }\n    };\n\n    LGraphCanvas.prototype.copyToClipboard = function() {\n        var clipboard_info = {\n            nodes: [],\n            links: []\n        };\n        var index = 0;\n        var selected_nodes_array = [];\n        for (var i in this.selected_nodes) {\n            var node = this.selected_nodes[i];\n            node._relative_id = index;\n            selected_nodes_array.push(node);\n            index += 1;\n        }\n\n        for (var i = 0; i < selected_nodes_array.length; ++i) {\n            var node = selected_nodes_array[i];\n\t\t\tvar cloned = node.clone();\n\t\t\tif(!cloned)\n\t\t\t{\n\t\t\t\tconsole.warn(\"node type not found: \" + node.type );\n\t\t\t\tcontinue;\n\t\t\t}\n            clipboard_info.nodes.push(cloned.serialize());\n            if (node.inputs && node.inputs.length) {\n                for (var j = 0; j < node.inputs.length; ++j) {\n                    var input = node.inputs[j];\n                    if (!input || input.link == null) {\n                        continue;\n                    }\n                    var link_info = this.graph.links[input.link];\n                    if (!link_info) {\n                        continue;\n                    }\n                    var target_node = this.graph.getNodeById(\n                        link_info.origin_id\n                    );\n                    if (!target_node || !this.selected_nodes[target_node.id]) {\n                        //improve this by allowing connections to non-selected nodes\n                        continue;\n                    } //not selected\n                    clipboard_info.links.push([\n                        target_node._relative_id,\n                        link_info.origin_slot, //j,\n                        node._relative_id,\n                        link_info.target_slot\n                    ]);\n                }\n            }\n        }\n        localStorage.setItem(\n            \"litegrapheditor_clipboard\",\n            JSON.stringify(clipboard_info)\n        );\n    };\n\n    LGraphCanvas.prototype.pasteFromClipboard = function() {\n        var data = localStorage.getItem(\"litegrapheditor_clipboard\");\n        if (!data) {\n            return;\n        }\n\n\t\tthis.graph.beforeChange();\n\n        //create nodes\n        var clipboard_info = JSON.parse(data);\n        // calculate top-left node, could work without this processing but using diff with last node pos :: clipboard_info.nodes[clipboard_info.nodes.length-1].pos\n        var posMin = false;\n        var posMinIndexes = false;\n        for (var i = 0; i < clipboard_info.nodes.length; ++i) {\n            if (posMin){\n                if(posMin[0]>clipboard_info.nodes[i].pos[0]){\n                    posMin[0] = clipboard_info.nodes[i].pos[0];\n                    posMinIndexes[0] = i;\n                }\n                if(posMin[1]>clipboard_info.nodes[i].pos[1]){\n                    posMin[1] = clipboard_info.nodes[i].pos[1];\n                    posMinIndexes[1] = i;\n                }\n            }\n            else{\n                posMin = [clipboard_info.nodes[i].pos[0], clipboard_info.nodes[i].pos[1]];\n                posMinIndexes = [i, i];\n            }\n        }\n        var nodes = [];\n        for (var i = 0; i < clipboard_info.nodes.length; ++i) {\n            var node_data = clipboard_info.nodes[i];\n            var node = LiteGraph.createNode(node_data.type);\n            if (node) {\n                node.configure(node_data);\n        \n\t\t\t\t//paste in last known mouse position\n                node.pos[0] += this.graph_mouse[0] - posMin[0]; //+= 5;\n                node.pos[1] += this.graph_mouse[1] - posMin[1]; //+= 5;\n\n                this.graph.add(node,{doProcessChange:false});\n                \n                nodes.push(node);\n            }\n        }\n\n        //create links\n        for (var i = 0; i < clipboard_info.links.length; ++i) {\n            var link_info = clipboard_info.links[i];\n            var origin_node = nodes[link_info[0]];\n            var target_node = nodes[link_info[2]];\n\t\t\tif( origin_node && target_node )\n\t            origin_node.connect(link_info[1], target_node, link_info[3]);\n\t\t\telse\n\t\t\t\tconsole.warn(\"Warning, nodes missing on pasting\");\n        }\n\n        this.selectNodes(nodes);\n\n\t\tthis.graph.afterChange();\n    };\n\n    /**\n     * process a item drop event on top the canvas\n     * @method processDrop\n     **/\n    LGraphCanvas.prototype.processDrop = function(e) {\n        e.preventDefault();\n        this.adjustMouseEvent(e);\n\t\tvar x = e.clientX;\n\t\tvar y = e.clientY;\n\t\tvar is_inside = !this.viewport || ( this.viewport && x >= this.viewport[0] && x < (this.viewport[0] + this.viewport[2]) && y >= this.viewport[1] && y < (this.viewport[1] + this.viewport[3]) );\n\t\tif(!is_inside){\n\t\t\treturn;\n\t\t\t// --- BREAK ---\n\t\t}\n\n        var pos = [e.canvasX, e.canvasY];\n\n\n        var node = this.graph ? this.graph.getNodeOnPos(pos[0], pos[1]) : null;\n\n        if (!node) {\n            var r = null;\n            if (this.onDropItem) {\n                r = this.onDropItem(event);\n            }\n            if (!r) {\n                this.checkDropItem(e);\n            }\n            return;\n        }\n\n        if (node.onDropFile || node.onDropData) {\n            var files = e.dataTransfer.files;\n            if (files && files.length) {\n                for (var i = 0; i < files.length; i++) {\n                    var file = e.dataTransfer.files[0];\n                    var filename = file.name;\n                    var ext = LGraphCanvas.getFileExtension(filename);\n                    //console.log(file);\n\n                    if (node.onDropFile) {\n                        node.onDropFile(file);\n                    }\n\n                    if (node.onDropData) {\n                        //prepare reader\n                        var reader = new FileReader();\n                        reader.onload = function(event) {\n                            //console.log(event.target);\n                            var data = event.target.result;\n                            node.onDropData(data, filename, file);\n                        };\n\n                        //read data\n                        var type = file.type.split(\"/\")[0];\n                        if (type == \"text\" || type == \"\") {\n                            reader.readAsText(file);\n                        } else if (type == \"image\") {\n                            reader.readAsDataURL(file);\n                        } else {\n                            reader.readAsArrayBuffer(file);\n                        }\n                    }\n                }\n            }\n        }\n\n        if (node.onDropItem) {\n            if (node.onDropItem(event)) {\n                return true;\n            }\n        }\n\n        if (this.onDropItem) {\n            return this.onDropItem(event);\n        }\n\n        return false;\n    };\n\n    //called if the graph doesn't have a default drop item behaviour\n    LGraphCanvas.prototype.checkDropItem = function(e) {\n        if (e.dataTransfer.files.length) {\n            var file = e.dataTransfer.files[0];\n            var ext = LGraphCanvas.getFileExtension(file.name).toLowerCase();\n            var nodetype = LiteGraph.node_types_by_file_extension[ext];\n            if (nodetype) {\n\t\t\t\tthis.graph.beforeChange();\n                var node = LiteGraph.createNode(nodetype.type);\n                node.pos = [e.canvasX, e.canvasY];\n                this.graph.add(node);\n                if (node.onDropFile) {\n                    node.onDropFile(file);\n                }\n\t\t\t\tthis.graph.afterChange();\n            }\n        }\n    };\n\n    LGraphCanvas.prototype.processNodeDblClicked = function(n) {\n        if (this.onShowNodePanel) {\n            this.onShowNodePanel(n);\n        }\n\t\telse\n\t\t{\n\t\t\tthis.showShowNodePanel(n);\n\t\t}\n\n        if (this.onNodeDblClicked) {\n            this.onNodeDblClicked(n);\n        }\n\n        this.setDirty(true);\n    };\n\n    LGraphCanvas.prototype.processNodeSelected = function(node, e) {\n        this.selectNode(node, e && (e.shiftKey||e.ctrlKey));\n        if (this.onNodeSelected) {\n            this.onNodeSelected(node);\n        }\n    };\n\n    /**\n     * selects a given node (or adds it to the current selection)\n     * @method selectNode\n     **/\n    LGraphCanvas.prototype.selectNode = function(\n        node,\n        add_to_current_selection\n    ) {\n        if (node == null) {\n            this.deselectAllNodes();\n        } else {\n            this.selectNodes([node], add_to_current_selection);\n        }\n    };\n\n    /**\n     * selects several nodes (or adds them to the current selection)\n     * @method selectNodes\n     **/\n    LGraphCanvas.prototype.selectNodes = function( nodes, add_to_current_selection )\n\t{\n\t\tif (!add_to_current_selection) {\n            this.deselectAllNodes();\n        }\n\n        nodes = nodes || this.graph._nodes;\n\t\tif (typeof nodes == \"string\") nodes = [nodes];\n        for (var i in nodes) {\n            var node = nodes[i];\n            if (node.is_selected) {\n                continue;\n            }\n\n            if (!node.is_selected && node.onSelected) {\n                node.onSelected();\n            }\n            node.is_selected = true;\n            this.selected_nodes[node.id] = node;\n\n            if (node.inputs) {\n                for (var j = 0; j < node.inputs.length; ++j) {\n                    this.highlighted_links[node.inputs[j].link] = true;\n                }\n            }\n            if (node.outputs) {\n                for (var j = 0; j < node.outputs.length; ++j) {\n                    var out = node.outputs[j];\n                    if (out.links) {\n                        for (var k = 0; k < out.links.length; ++k) {\n                            this.highlighted_links[out.links[k]] = true;\n                        }\n                    }\n                }\n            }\n        }\n\n\t\tif(\tthis.onSelectionChange )\n\t\t\tthis.onSelectionChange( this.selected_nodes );\n\n        this.setDirty(true);\n    };\n\n    /**\n     * removes a node from the current selection\n     * @method deselectNode\n     **/\n    LGraphCanvas.prototype.deselectNode = function(node) {\n        if (!node.is_selected) {\n            return;\n        }\n        if (node.onDeselected) {\n            node.onDeselected();\n        }\n        node.is_selected = false;\n\n        if (this.onNodeDeselected) {\n            this.onNodeDeselected(node);\n        }\n\n        //remove highlighted\n        if (node.inputs) {\n            for (var i = 0; i < node.inputs.length; ++i) {\n                delete this.highlighted_links[node.inputs[i].link];\n            }\n        }\n        if (node.outputs) {\n            for (var i = 0; i < node.outputs.length; ++i) {\n                var out = node.outputs[i];\n                if (out.links) {\n                    for (var j = 0; j < out.links.length; ++j) {\n                        delete this.highlighted_links[out.links[j]];\n                    }\n                }\n            }\n        }\n    };\n\n    /**\n     * removes all nodes from the current selection\n     * @method deselectAllNodes\n     **/\n    LGraphCanvas.prototype.deselectAllNodes = function() {\n        if (!this.graph) {\n            return;\n        }\n        var nodes = this.graph._nodes;\n        for (var i = 0, l = nodes.length; i < l; ++i) {\n            var node = nodes[i];\n            if (!node.is_selected) {\n                continue;\n            }\n            if (node.onDeselected) {\n                node.onDeselected();\n            }\n            node.is_selected = false;\n\t\t\tif (this.onNodeDeselected) {\n\t\t\t\tthis.onNodeDeselected(node);\n\t\t\t}\n        }\n        this.selected_nodes = {};\n        this.current_node = null;\n        this.highlighted_links = {};\n\t\tif(\tthis.onSelectionChange )\n\t\t\tthis.onSelectionChange( this.selected_nodes );\n        this.setDirty(true);\n    };\n\n    /**\n     * deletes all nodes in the current selection from the graph\n     * @method deleteSelectedNodes\n     **/\n    LGraphCanvas.prototype.deleteSelectedNodes = function() {\n\n\t\tthis.graph.beforeChange();\n\n        for (var i in this.selected_nodes) {\n            var node = this.selected_nodes[i];\n\n\t\t\tif(node.block_delete)\n\t\t\t\tcontinue;\n\n\t\t\t//autoconnect when possible (very basic, only takes into account first input-output)\n\t\t\tif(node.inputs && node.inputs.length && node.outputs && node.outputs.length && LiteGraph.isValidConnection( node.inputs[0].type, node.outputs[0].type ) && node.inputs[0].link && node.outputs[0].links && node.outputs[0].links.length ) \n\t\t\t{\n\t\t\t\tvar input_link = node.graph.links[ node.inputs[0].link ];\n\t\t\t\tvar output_link = node.graph.links[ node.outputs[0].links[0] ];\n\t\t\t\tvar input_node = node.getInputNode(0);\n\t\t\t\tvar output_node = node.getOutputNodes(0)[0];\n\t\t\t\tif(input_node && output_node)\n\t\t\t\t\tinput_node.connect( input_link.origin_slot, output_node, output_link.target_slot );\n\t\t\t}\n            this.graph.remove(node);\n\t\t\tif (this.onNodeDeselected) {\n\t\t\t\tthis.onNodeDeselected(node);\n\t\t\t}\n        }\n        this.selected_nodes = {};\n        this.current_node = null;\n        this.highlighted_links = {};\n        this.setDirty(true);\n\t\tthis.graph.afterChange();\n    };\n    \n    /**\n     * centers the camera on a given node\n     * @method centerOnNode\n     **/\n    LGraphCanvas.prototype.centerOnNode = function(node) {\n        this.ds.offset[0] =\n            -node.pos[0] -\n            node.size[0] * 0.5 +\n            (this.canvas.width * 0.5) / this.ds.scale;\n        this.ds.offset[1] =\n            -node.pos[1] -\n            node.size[1] * 0.5 +\n            (this.canvas.height * 0.5) / this.ds.scale;\n        this.setDirty(true, true);\n    };\n\n    /**\n     * adds some useful properties to a mouse event, like the position in graph coordinates\n     * @method adjustMouseEvent\n     **/\n    LGraphCanvas.prototype.adjustMouseEvent = function(e) {\n\tvar clientX_rel = 0;\n        var clientY_rel = 0;\n\t    \n    \tif (this.canvas) {\n            var b = this.canvas.getBoundingClientRect();\n            clientX_rel = e.clientX - b.left;\n            clientY_rel = e.clientY - b.top;\n        } else {\n        \tclientX_rel = e.clientX;\n        \tclientY_rel = e.clientY;\n        }\n    \t\n        e.deltaX = clientX_rel - this.last_mouse_position[0];\n        e.deltaY = clientY_rel- this.last_mouse_position[1];\n\n        this.last_mouse_position[0] = clientX_rel;\n        this.last_mouse_position[1] = clientY_rel;\n\n        e.canvasX = clientX_rel / this.ds.scale - this.ds.offset[0];\n        e.canvasY = clientY_rel / this.ds.scale - this.ds.offset[1];\n        \n        //console.log(\"pointerevents: adjustMouseEvent \"+e.clientX+\":\"+e.clientY+\" \"+clientX_rel+\":\"+clientY_rel+\" \"+e.canvasX+\":\"+e.canvasY);\n    };\n\n    /**\n     * changes the zoom level of the graph (default is 1), you can pass also a place used to pivot the zoom\n     * @method setZoom\n     **/\n    LGraphCanvas.prototype.setZoom = function(value, zooming_center) {\n        this.ds.changeScale(value, zooming_center);\n        /*\n\tif(!zooming_center && this.canvas)\n\t\tzooming_center = [this.canvas.width * 0.5,this.canvas.height * 0.5];\n\n\tvar center = this.convertOffsetToCanvas( zooming_center );\n\n\tthis.ds.scale = value;\n\n\tif(this.scale > this.max_zoom)\n\t\tthis.scale = this.max_zoom;\n\telse if(this.scale < this.min_zoom)\n\t\tthis.scale = this.min_zoom;\n\n\tvar new_center = this.convertOffsetToCanvas( zooming_center );\n\tvar delta_offset = [new_center[0] - center[0], new_center[1] - center[1]];\n\n\tthis.offset[0] += delta_offset[0];\n\tthis.offset[1] += delta_offset[1];\n\t*/\n\n        this.dirty_canvas = true;\n        this.dirty_bgcanvas = true;\n    };\n\n    /**\n     * converts a coordinate from graph coordinates to canvas2D coordinates\n     * @method convertOffsetToCanvas\n     **/\n    LGraphCanvas.prototype.convertOffsetToCanvas = function(pos, out) {\n        return this.ds.convertOffsetToCanvas(pos, out);\n    };\n\n    /**\n     * converts a coordinate from Canvas2D coordinates to graph space\n     * @method convertCanvasToOffset\n     **/\n    LGraphCanvas.prototype.convertCanvasToOffset = function(pos, out) {\n        return this.ds.convertCanvasToOffset(pos, out);\n    };\n\n    //converts event coordinates from canvas2D to graph coordinates\n    LGraphCanvas.prototype.convertEventToCanvasOffset = function(e) {\n        var rect = this.canvas.getBoundingClientRect();\n        return this.convertCanvasToOffset([\n            e.clientX - rect.left,\n            e.clientY - rect.top\n        ]);\n    };\n\n    /**\n     * brings a node to front (above all other nodes)\n     * @method bringToFront\n     **/\n    LGraphCanvas.prototype.bringToFront = function(node) {\n        var i = this.graph._nodes.indexOf(node);\n        if (i == -1) {\n            return;\n        }\n\n        this.graph._nodes.splice(i, 1);\n        this.graph._nodes.push(node);\n    };\n\n    /**\n     * sends a node to the back (below all other nodes)\n     * @method sendToBack\n     **/\n    LGraphCanvas.prototype.sendToBack = function(node) {\n        var i = this.graph._nodes.indexOf(node);\n        if (i == -1) {\n            return;\n        }\n\n        this.graph._nodes.splice(i, 1);\n        this.graph._nodes.unshift(node);\n    };\n\n    /* Interaction */\n\n    /* LGraphCanvas render */\n    var temp = new Float32Array(4);\n\n    /**\n     * checks which nodes are visible (inside the camera area)\n     * @method computeVisibleNodes\n     **/\n    LGraphCanvas.prototype.computeVisibleNodes = function(nodes, out) {\n        var visible_nodes = out || [];\n        visible_nodes.length = 0;\n        nodes = nodes || this.graph._nodes;\n        for (var i = 0, l = nodes.length; i < l; ++i) {\n            var n = nodes[i];\n\n            //skip rendering nodes in live mode\n            if (this.live_mode && !n.onDrawBackground && !n.onDrawForeground) {\n                continue;\n            }\n\n            if (!overlapBounding(this.visible_area, n.getBounding(temp))) {\n                continue;\n            } //out of the visible area\n\n            visible_nodes.push(n);\n        }\n        return visible_nodes;\n    };\n\n    /**\n     * renders the whole canvas content, by rendering in two separated canvas, one containing the background grid and the connections, and one containing the nodes)\n     * @method draw\n     **/\n    LGraphCanvas.prototype.draw = function(force_canvas, force_bgcanvas) {\n        if (!this.canvas || this.canvas.width == 0 || this.canvas.height == 0) {\n            return;\n        }\n\n        //fps counting\n        var now = LiteGraph.getTime();\n        this.render_time = (now - this.last_draw_time) * 0.001;\n        this.last_draw_time = now;\n\n        if (this.graph) {\n            this.ds.computeVisibleArea(this.viewport);\n        }\n\n        if (\n            this.dirty_bgcanvas ||\n            force_bgcanvas ||\n            this.always_render_background ||\n            (this.graph &&\n                this.graph._last_trigger_time &&\n                now - this.graph._last_trigger_time < 1000)\n        ) {\n            this.drawBackCanvas();\n        }\n\n        if (this.dirty_canvas || force_canvas) {\n            this.drawFrontCanvas();\n        }\n\n        this.fps = this.render_time ? 1.0 / this.render_time : 0;\n        this.frame += 1;\n    };\n\n    /**\n     * draws the front canvas (the one containing all the nodes)\n     * @method drawFrontCanvas\n     **/\n    LGraphCanvas.prototype.drawFrontCanvas = function() {\n        this.dirty_canvas = false;\n\n        if (!this.ctx) {\n            this.ctx = this.bgcanvas.getContext(\"2d\");\n        }\n        var ctx = this.ctx;\n        if (!ctx) {\n            //maybe is using webgl...\n            return;\n        }\n\n        var canvas = this.canvas;\n        if ( ctx.start2D && !this.viewport ) {\n            ctx.start2D();\n\t\t\tctx.restore();\n\t\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\n        }\n\n        //clip dirty area if there is one, otherwise work in full canvas\n\t\tvar area = this.viewport || this.dirty_area;\n        if (area) {\n            ctx.save();\n            ctx.beginPath();\n            ctx.rect( area[0],area[1],area[2],area[3] );\n            ctx.clip();\n        }\n\n        //clear\n        //canvas.width = canvas.width;\n        if (this.clear_background) {\n\t\t\tif(area)\n\t            ctx.clearRect( area[0],area[1],area[2],area[3] );\n\t\t\telse\n\t            ctx.clearRect(0, 0, canvas.width, canvas.height);\n        }\n\n        //draw bg canvas\n        if (this.bgcanvas == this.canvas) {\n            this.drawBackCanvas();\n        } else {\n            ctx.drawImage( this.bgcanvas, 0, 0 );\n        }\n\n        //rendering\n        if (this.onRender) {\n            this.onRender(canvas, ctx);\n        }\n\n        //info widget\n        if (this.show_info) {\n            this.renderInfo(ctx, area ? area[0] : 0, area ? area[1] : 0 );\n        }\n\n        if (this.graph) {\n            //apply transformations\n            ctx.save();\n            this.ds.toCanvasContext(ctx);\n\n            //draw nodes\n            var drawn_nodes = 0;\n            var visible_nodes = this.computeVisibleNodes(\n                null,\n                this.visible_nodes\n            );\n\n            for (var i = 0; i < visible_nodes.length; ++i) {\n                var node = visible_nodes[i];\n\n                //transform coords system\n                ctx.save();\n                ctx.translate(node.pos[0], node.pos[1]);\n\n                //Draw\n                this.drawNode(node, ctx);\n                drawn_nodes += 1;\n\n                //Restore\n                ctx.restore();\n            }\n\n            //on top (debug)\n            if (this.render_execution_order) {\n                this.drawExecutionOrder(ctx);\n            }\n\n            //connections ontop?\n            if (this.graph.config.links_ontop) {\n                if (!this.live_mode) {\n                    this.drawConnections(ctx);\n                }\n            }\n\n            //current connection (the one being dragged by the mouse)\n            if (this.connecting_pos != null) {\n                ctx.lineWidth = this.connections_width;\n                var link_color = null;\n                \n                var connInOrOut = this.connecting_output || this.connecting_input;\n\n                var connType = connInOrOut.type;\n                var connDir = connInOrOut.dir;\n\t\t\t\tif(connDir == null)\n\t\t\t\t{\n\t\t\t\t\tif (this.connecting_output)\n\t\t\t\t\t\tconnDir = this.connecting_node.horizontal ? LiteGraph.DOWN : LiteGraph.RIGHT;\n\t\t\t\t\telse\n\t\t\t\t\t\tconnDir = this.connecting_node.horizontal ? LiteGraph.UP : LiteGraph.LEFT;\n\t\t\t\t}\n                var connShape = connInOrOut.shape;\n                \n                switch (connType) {\n                    case LiteGraph.EVENT:\n                        link_color = LiteGraph.EVENT_LINK_COLOR;\n                        break;\n                    default:\n                        link_color = LiteGraph.CONNECTING_LINK_COLOR;\n                }\n\n                //the connection being dragged by the mouse\n                this.renderLink(\n                    ctx,\n                    this.connecting_pos,\n                    [this.graph_mouse[0], this.graph_mouse[1]],\n                    null,\n                    false,\n                    null,\n                    link_color,\n                    connDir,\n                    LiteGraph.CENTER\n                );\n\n                ctx.beginPath();\n                if (\n                    connType === LiteGraph.EVENT ||\n                    connShape === LiteGraph.BOX_SHAPE\n                ) {\n                    ctx.rect(\n                        this.connecting_pos[0] - 6 + 0.5,\n                        this.connecting_pos[1] - 5 + 0.5,\n                        14,\n                        10\n                    );\n\t                ctx.fill();\n\t\t\t\t\tctx.beginPath();\n                    ctx.rect(\n                        this.graph_mouse[0] - 6 + 0.5,\n                        this.graph_mouse[1] - 5 + 0.5,\n                        14,\n                        10\n                    );\n                } else if (connShape === LiteGraph.ARROW_SHAPE) {\n                    ctx.moveTo(this.connecting_pos[0] + 8, this.connecting_pos[1] + 0.5);\n                    ctx.lineTo(this.connecting_pos[0] - 4, this.connecting_pos[1] + 6 + 0.5);\n                    ctx.lineTo(this.connecting_pos[0] - 4, this.connecting_pos[1] - 6 + 0.5);\n                    ctx.closePath();\n                } \n                else {\n                    ctx.arc(\n                        this.connecting_pos[0],\n                        this.connecting_pos[1],\n                        4,\n                        0,\n                        Math.PI * 2\n                    );\n\t                ctx.fill();\n\t\t\t\t\tctx.beginPath();\n                    ctx.arc(\n                        this.graph_mouse[0],\n                        this.graph_mouse[1],\n                        4,\n                        0,\n                        Math.PI * 2\n                    );\n                }\n                ctx.fill();\n\n                ctx.fillStyle = \"#ffcc00\";\n                if (this._highlight_input) {\n                    ctx.beginPath();\n                    var shape = this._highlight_input_slot.shape;\n                    if (shape === LiteGraph.ARROW_SHAPE) {\n                        ctx.moveTo(this._highlight_input[0] + 8, this._highlight_input[1] + 0.5);\n                        ctx.lineTo(this._highlight_input[0] - 4, this._highlight_input[1] + 6 + 0.5);\n                        ctx.lineTo(this._highlight_input[0] - 4, this._highlight_input[1] - 6 + 0.5);\n                        ctx.closePath();\n                    } else {\n                        ctx.arc(\n                            this._highlight_input[0],\n                            this._highlight_input[1],\n                            6,\n                            0,\n                            Math.PI * 2\n                        );\n                    }\n                    ctx.fill();\n                }\n                if (this._highlight_output) {\n                    ctx.beginPath();\n                    if (shape === LiteGraph.ARROW_SHAPE) {\n                        ctx.moveTo(this._highlight_output[0] + 8, this._highlight_output[1] + 0.5);\n                        ctx.lineTo(this._highlight_output[0] - 4, this._highlight_output[1] + 6 + 0.5);\n                        ctx.lineTo(this._highlight_output[0] - 4, this._highlight_output[1] - 6 + 0.5);\n                        ctx.closePath();\n                    } else {\n                        ctx.arc(\n                            this._highlight_output[0],\n                            this._highlight_output[1],\n                            6,\n                            0,\n                            Math.PI * 2\n                        );\n                    }\n                    ctx.fill();\n                }\n            }\n\n\t\t\t//the selection rectangle\n            if (this.dragging_rectangle) {\n                ctx.strokeStyle = \"#FFF\";\n                ctx.strokeRect(\n                    this.dragging_rectangle[0],\n                    this.dragging_rectangle[1],\n                    this.dragging_rectangle[2],\n                    this.dragging_rectangle[3]\n                );\n            }\n\n\t\t\t//on top of link center\n\t\t\tif(this.over_link_center && this.render_link_tooltip)\n\t\t\t\tthis.drawLinkTooltip( ctx, this.over_link_center );\n\t\t\telse\n\t\t\t\tif(this.onDrawLinkTooltip) //to remove\n\t\t\t\t\tthis.onDrawLinkTooltip(ctx,null);\n\n\t\t\t//custom info\n            if (this.onDrawForeground) {\n                this.onDrawForeground(ctx, this.visible_rect);\n            }\n\n            ctx.restore();\n        }\n\n\t\t//draws panel in the corner \n\t\tif (this._graph_stack && this._graph_stack.length) {\n\t\t\tthis.drawSubgraphPanel( ctx );\n\t\t}\n\n\n        if (this.onDrawOverlay) {\n            this.onDrawOverlay(ctx);\n        }\n\n        if (area){\n            ctx.restore();\n        }\n\n        if (ctx.finish2D) {\n            //this is a function I use in webgl renderer\n            ctx.finish2D();\n        }\n    };\n\n    /**\n     * draws the panel in the corner that shows subgraph properties\n     * @method drawSubgraphPanel\n     **/\n    LGraphCanvas.prototype.drawSubgraphPanel = function (ctx) {\n        var subgraph = this.graph;\n        var subnode = subgraph._subgraph_node;\n        if (!subnode) {\n            console.warn(\"subgraph without subnode\");\n            return;\n        }\n        this.drawSubgraphPanelLeft(subgraph, subnode, ctx)\n        this.drawSubgraphPanelRight(subgraph, subnode, ctx)\n    }\n\n    LGraphCanvas.prototype.drawSubgraphPanelLeft = function (subgraph, subnode, ctx) {\n        var num = subnode.inputs ? subnode.inputs.length : 0;\n        var w = 200;\n        var h = Math.floor(LiteGraph.NODE_SLOT_HEIGHT * 1.6);\n\n        ctx.fillStyle = \"#111\";\n        ctx.globalAlpha = 0.8;\n        ctx.beginPath();\n        ctx.roundRect(10, 10, w, (num + 1) * h + 50, [8]);\n        ctx.fill();\n        ctx.globalAlpha = 1;\n\n        ctx.fillStyle = \"#888\";\n        ctx.font = \"14px Arial\";\n        ctx.textAlign = \"left\";\n        ctx.fillText(\"Graph Inputs\", 20, 34);\n        // var pos = this.mouse;\n\n        if (this.drawButton(w - 20, 20, 20, 20, \"X\", \"#151515\")) {\n            this.closeSubgraph();\n            return;\n        }\n\n        var y = 50;\n        ctx.font = \"14px Arial\";\n        if (subnode.inputs)\n            for (var i = 0; i < subnode.inputs.length; ++i) {\n                var input = subnode.inputs[i];\n                if (input.not_subgraph_input)\n                    continue;\n\n                //input button clicked\n                if (this.drawButton(20, y + 2, w - 20, h - 2)) {\n                    var type = subnode.constructor.input_node_type || \"graph/input\";\n                    this.graph.beforeChange();\n                    var newnode = LiteGraph.createNode(type);\n                    if (newnode) {\n                        subgraph.add(newnode);\n                        this.block_click = false;\n                        this.last_click_position = null;\n                        this.selectNodes([newnode]);\n                        this.node_dragged = newnode;\n                        this.dragging_canvas = false;\n                        newnode.setProperty(\"name\", input.name);\n                        newnode.setProperty(\"type\", input.type);\n                        this.node_dragged.pos[0] = this.graph_mouse[0] - 5;\n                        this.node_dragged.pos[1] = this.graph_mouse[1] - 5;\n                        this.graph.afterChange();\n                    }\n                    else\n                        console.error(\"graph input node not found:\", type);\n                }\n                ctx.fillStyle = \"#9C9\";\n                ctx.beginPath();\n                ctx.arc(w - 16, y + h * 0.5, 5, 0, 2 * Math.PI);\n                ctx.fill();\n                ctx.fillStyle = \"#AAA\";\n                ctx.fillText(input.name, 30, y + h * 0.75);\n                // var tw = ctx.measureText(input.name);\n                ctx.fillStyle = \"#777\";\n                ctx.fillText(input.type, 130, y + h * 0.75);\n                y += h;\n            }\n        //add + button\n        if (this.drawButton(20, y + 2, w - 20, h - 2, \"+\", \"#151515\", \"#222\")) {\n            this.showSubgraphPropertiesDialog(subnode);\n        }\n    }\n    LGraphCanvas.prototype.drawSubgraphPanelRight = function (subgraph, subnode, ctx) {\n        var num = subnode.outputs ? subnode.outputs.length : 0;\n        var canvas_w = this.bgcanvas.width\n        var w = 200;\n        var h = Math.floor(LiteGraph.NODE_SLOT_HEIGHT * 1.6);\n\n        ctx.fillStyle = \"#111\";\n        ctx.globalAlpha = 0.8;\n        ctx.beginPath();\n        ctx.roundRect(canvas_w - w - 10, 10, w, (num + 1) * h + 50, [8]);\n        ctx.fill();\n        ctx.globalAlpha = 1;\n\n        ctx.fillStyle = \"#888\";\n        ctx.font = \"14px Arial\";\n        ctx.textAlign = \"left\";\n        var title_text = \"Graph Outputs\"\n        var tw = ctx.measureText(title_text).width\n        ctx.fillText(title_text, (canvas_w - tw) - 20, 34);\n        // var pos = this.mouse;\n        if (this.drawButton(canvas_w - w, 20, 20, 20, \"X\", \"#151515\")) {\n            this.closeSubgraph();\n            return;\n        }\n\n        var y = 50;\n        ctx.font = \"14px Arial\";\n        if (subnode.outputs)\n            for (var i = 0; i < subnode.outputs.length; ++i) {\n                var output = subnode.outputs[i];\n                if (output.not_subgraph_input)\n                    continue;\n\n                //output button clicked\n                if (this.drawButton(canvas_w - w, y + 2, w - 20, h - 2)) {\n                    var type = subnode.constructor.output_node_type || \"graph/output\";\n                    this.graph.beforeChange();\n                    var newnode = LiteGraph.createNode(type);\n                    if (newnode) {\n                        subgraph.add(newnode);\n                        this.block_click = false;\n                        this.last_click_position = null;\n                        this.selectNodes([newnode]);\n                        this.node_dragged = newnode;\n                        this.dragging_canvas = false;\n                        newnode.setProperty(\"name\", output.name);\n                        newnode.setProperty(\"type\", output.type);\n                        this.node_dragged.pos[0] = this.graph_mouse[0] - 5;\n                        this.node_dragged.pos[1] = this.graph_mouse[1] - 5;\n                        this.graph.afterChange();\n                    }\n                    else\n                        console.error(\"graph input node not found:\", type);\n                }\n                ctx.fillStyle = \"#9C9\";\n                ctx.beginPath();\n                ctx.arc(canvas_w - w + 16, y + h * 0.5, 5, 0, 2 * Math.PI);\n                ctx.fill();\n                ctx.fillStyle = \"#AAA\";\n                ctx.fillText(output.name, canvas_w - w + 30, y + h * 0.75);\n                // var tw = ctx.measureText(input.name);\n                ctx.fillStyle = \"#777\";\n                ctx.fillText(output.type, canvas_w - w + 130, y + h * 0.75);\n                y += h;\n            }\n        //add + button\n        if (this.drawButton(canvas_w - w, y + 2, w - 20, h - 2, \"+\", \"#151515\", \"#222\")) {\n            this.showSubgraphPropertiesDialogRight(subnode);\n        }\n    }\n\t//Draws a button into the canvas overlay and computes if it was clicked using the immediate gui paradigm\n\tLGraphCanvas.prototype.drawButton = function( x,y,w,h, text, bgcolor, hovercolor, textcolor )\n\t{\n\t\tvar ctx = this.ctx;\n\t\tbgcolor = bgcolor || LiteGraph.NODE_DEFAULT_COLOR;\n\t\thovercolor = hovercolor || \"#555\";\n\t\ttextcolor = textcolor || LiteGraph.NODE_TEXT_COLOR;\n\t\tvar yFix = y + LiteGraph.NODE_TITLE_HEIGHT + 2;\t// fix the height with the title\n\t\tvar pos = this.mouse;\n\t\tvar hover = LiteGraph.isInsideRectangle( pos[0], pos[1], x,yFix,w,h );\n\t\tpos = this.last_click_position;\n\t\tvar clicked = pos && LiteGraph.isInsideRectangle( pos[0], pos[1], x,yFix,w,h );\n\n\t\tctx.fillStyle = hover ? hovercolor : bgcolor;\n\t\tif(clicked)\n\t\t\tctx.fillStyle = \"#AAA\";\n\t\tctx.beginPath();\n\t\tctx.roundRect(x,y,w,h,[4] );\n\t\tctx.fill();\n\n\t\tif(text != null)\n\t\t{\n\t\t\tif(text.constructor == String)\n\t\t\t{\n\t\t\t\tctx.fillStyle = textcolor;\n\t\t\t\tctx.textAlign = \"center\";\n\t\t\t\tctx.font = ((h * 0.65)|0) + \"px Arial\";\n\t\t\t\tctx.fillText( text, x + w * 0.5,y + h * 0.75 );\n\t\t\t\tctx.textAlign = \"left\";\n\t\t\t}\n\t\t}\n\n\t\tvar was_clicked = clicked && !this.block_click;\n\t\tif(clicked)\n\t\t\tthis.blockClick();\n\t\treturn was_clicked;\n\t}\n\n\tLGraphCanvas.prototype.isAreaClicked = function( x,y,w,h, hold_click )\n\t{\n\t\tvar pos = this.mouse;\n\t\tvar hover = LiteGraph.isInsideRectangle( pos[0], pos[1], x,y,w,h );\n\t\tpos = this.last_click_position;\n\t\tvar clicked = pos && LiteGraph.isInsideRectangle( pos[0], pos[1], x,y,w,h );\n\t\tvar was_clicked = clicked && !this.block_click;\n\t\tif(clicked && hold_click)\n\t\t\tthis.blockClick();\n\t\treturn was_clicked;\n\t}\n\n    /**\n     * draws some useful stats in the corner of the canvas\n     * @method renderInfo\n     **/\n    LGraphCanvas.prototype.renderInfo = function(ctx, x, y) {\n        x = x || 10;\n        y = y || this.canvas.height - 80;\n\n        ctx.save();\n        ctx.translate(x, y);\n\n        ctx.font = \"10px Arial\";\n        ctx.fillStyle = \"#888\";\n\t\tctx.textAlign = \"left\";\n        if (this.graph) {\n            ctx.fillText( \"T: \" + this.graph.globaltime.toFixed(2) + \"s\", 5, 13 * 1 );\n            ctx.fillText(\"I: \" + this.graph.iteration, 5, 13 * 2 );\n            ctx.fillText(\"N: \" + this.graph._nodes.length + \" [\" + this.visible_nodes.length + \"]\", 5, 13 * 3 );\n            ctx.fillText(\"V: \" + this.graph._version, 5, 13 * 4);\n            ctx.fillText(\"FPS:\" + this.fps.toFixed(2), 5, 13 * 5);\n        } else {\n            ctx.fillText(\"No graph selected\", 5, 13 * 1);\n        }\n        ctx.restore();\n    };\n\n    /**\n     * draws the back canvas (the one containing the background and the connections)\n     * @method drawBackCanvas\n     **/\n    LGraphCanvas.prototype.drawBackCanvas = function() {\n        var canvas = this.bgcanvas;\n        if (\n            canvas.width != this.canvas.width ||\n            canvas.height != this.canvas.height\n        ) {\n            canvas.width = this.canvas.width;\n            canvas.height = this.canvas.height;\n        }\n\n        if (!this.bgctx) {\n            this.bgctx = this.bgcanvas.getContext(\"2d\");\n        }\n        var ctx = this.bgctx;\n        if (ctx.start) {\n            ctx.start();\n        }\n\n\t\tvar viewport = this.viewport || [0,0,ctx.canvas.width,ctx.canvas.height];\n\n        //clear\n        if (this.clear_background) {\n            ctx.clearRect( viewport[0], viewport[1], viewport[2], viewport[3] );\n        }\n\n\t\t//show subgraph stack header\n        if (this._graph_stack && this._graph_stack.length) {\n            ctx.save();\n            var parent_graph = this._graph_stack[this._graph_stack.length - 1];\n            var subgraph_node = this.graph._subgraph_node;\n            ctx.strokeStyle = subgraph_node.bgcolor;\n            ctx.lineWidth = 10;\n            ctx.strokeRect(1, 1, canvas.width - 2, canvas.height - 2);\n            ctx.lineWidth = 1;\n            ctx.font = \"40px Arial\";\n            ctx.textAlign = \"center\";\n            ctx.fillStyle = subgraph_node.bgcolor || \"#AAA\";\n            var title = \"\";\n            for (var i = 1; i < this._graph_stack.length; ++i) {\n                title +=\n                    this._graph_stack[i]._subgraph_node.getTitle() + \" >> \";\n            }\n            ctx.fillText(\n                title + subgraph_node.getTitle(),\n                canvas.width * 0.5,\n                40\n            );\n            ctx.restore();\n        }\n\n        var bg_already_painted = false;\n        if (this.onRenderBackground) {\n            bg_already_painted = this.onRenderBackground(canvas, ctx);\n        }\n\n        //reset in case of error\n        if ( !this.viewport )\n\t\t{\n\t        ctx.restore();\n\t\t    ctx.setTransform(1, 0, 0, 1, 0, 0);\n\t\t}\n        this.visible_links.length = 0;\n\n        if (this.graph) {\n            //apply transformations\n            ctx.save();\n            this.ds.toCanvasContext(ctx);\n\n            //render BG\n            if (\n                this.background_image &&\n                this.ds.scale > 0.5 &&\n                !bg_already_painted\n            ) {\n                if (this.zoom_modify_alpha) {\n                    ctx.globalAlpha =\n                        (1.0 - 0.5 / this.ds.scale) * this.editor_alpha;\n                } else {\n                    ctx.globalAlpha = this.editor_alpha;\n                }\n                ctx.imageSmoothingEnabled = ctx.imageSmoothingEnabled = false; // ctx.mozImageSmoothingEnabled = \n                if (\n                    !this._bg_img ||\n                    this._bg_img.name != this.background_image\n                ) {\n                    this._bg_img = new Image();\n                    this._bg_img.name = this.background_image;\n                    this._bg_img.src = this.background_image;\n                    var that = this;\n                    this._bg_img.onload = function() {\n                        that.draw(true, true);\n                    };\n                }\n\n                var pattern = null;\n                if (this._pattern == null && this._bg_img.width > 0) {\n                    pattern = ctx.createPattern(this._bg_img, \"repeat\");\n                    this._pattern_img = this._bg_img;\n                    this._pattern = pattern;\n                } else {\n                    pattern = this._pattern;\n                }\n                if (pattern) {\n                    ctx.fillStyle = pattern;\n                    ctx.fillRect(\n                        this.visible_area[0],\n                        this.visible_area[1],\n                        this.visible_area[2],\n                        this.visible_area[3]\n                    );\n                    ctx.fillStyle = \"transparent\";\n                }\n\n                ctx.globalAlpha = 1.0;\n                ctx.imageSmoothingEnabled = ctx.imageSmoothingEnabled = true; //= ctx.mozImageSmoothingEnabled\n            }\n\n            //groups\n            if (this.graph._groups.length && !this.live_mode) {\n                this.drawGroups(canvas, ctx);\n            }\n\n            if (this.onDrawBackground) {\n                this.onDrawBackground(ctx, this.visible_area);\n            }\n            if (this.onBackgroundRender) {\n                //LEGACY\n                console.error(\n                    \"WARNING! onBackgroundRender deprecated, now is named onDrawBackground \"\n                );\n                this.onBackgroundRender = null;\n            }\n\n            //DEBUG: show clipping area\n            //ctx.fillStyle = \"red\";\n            //ctx.fillRect( this.visible_area[0] + 10, this.visible_area[1] + 10, this.visible_area[2] - 20, this.visible_area[3] - 20);\n\n            //bg\n            if (this.render_canvas_border) {\n                ctx.strokeStyle = \"#235\";\n                ctx.strokeRect(0, 0, canvas.width, canvas.height);\n            }\n\n            if (this.render_connections_shadows) {\n                ctx.shadowColor = \"#000\";\n                ctx.shadowOffsetX = 0;\n                ctx.shadowOffsetY = 0;\n                ctx.shadowBlur = 6;\n            } else {\n                ctx.shadowColor = \"rgba(0,0,0,0)\";\n            }\n\n            //draw connections\n            if (!this.live_mode) {\n                this.drawConnections(ctx);\n            }\n\n            ctx.shadowColor = \"rgba(0,0,0,0)\";\n\n            //restore state\n            ctx.restore();\n        }\n\n        if (ctx.finish) {\n            ctx.finish();\n        }\n\n        this.dirty_bgcanvas = false;\n        this.dirty_canvas = true; //to force to repaint the front canvas with the bgcanvas\n    };\n\n    var temp_vec2 = new Float32Array(2);\n\n    /**\n     * draws the given node inside the canvas\n     * @method drawNode\n     **/\n    LGraphCanvas.prototype.drawNode = function(node, ctx) {\n        var glow = false;\n        this.current_node = node;\n\n        var color = node.color || node.constructor.color || LiteGraph.NODE_DEFAULT_COLOR;\n        var bgcolor = node.bgcolor || node.constructor.bgcolor || LiteGraph.NODE_DEFAULT_BGCOLOR;\n\n        //shadow and glow\n        if (node.mouseOver) {\n            glow = true;\n        }\n\n        var low_quality = this.ds.scale < 0.6; //zoomed out\n\n        //only render if it forces it to do it\n        if (this.live_mode) {\n            if (!node.flags.collapsed) {\n                ctx.shadowColor = \"transparent\";\n                if (node.onDrawForeground) {\n                    node.onDrawForeground(ctx, this, this.canvas);\n                }\n            }\n            return;\n        }\n\n        var editor_alpha = this.editor_alpha;\n        ctx.globalAlpha = editor_alpha;\n\n        if (this.render_shadows && !low_quality) {\n            ctx.shadowColor = LiteGraph.DEFAULT_SHADOW_COLOR;\n            ctx.shadowOffsetX = 2 * this.ds.scale;\n            ctx.shadowOffsetY = 2 * this.ds.scale;\n            ctx.shadowBlur = 3 * this.ds.scale;\n        } else {\n            ctx.shadowColor = \"transparent\";\n        }\n\n        //custom draw collapsed method (draw after shadows because they are affected)\n        if (\n            node.flags.collapsed &&\n            node.onDrawCollapsed &&\n            node.onDrawCollapsed(ctx, this) == true\n        ) {\n            return;\n        }\n\n        //clip if required (mask)\n        var shape = node._shape || LiteGraph.BOX_SHAPE;\n        var size = temp_vec2;\n        temp_vec2.set(node.size);\n        var horizontal = node.horizontal; // || node.flags.horizontal;\n\n        if (node.flags.collapsed) {\n            ctx.font = this.inner_text_font;\n            var title = node.getTitle ? node.getTitle() : node.title;\n            if (title != null) {\n                node._collapsed_width = Math.min(\n                    node.size[0],\n                    ctx.measureText(title).width +\n                        LiteGraph.NODE_TITLE_HEIGHT * 2\n                ); //LiteGraph.NODE_COLLAPSED_WIDTH;\n                size[0] = node._collapsed_width;\n                size[1] = 0;\n            }\n        }\n\n        if (node.clip_area) {\n            //Start clipping\n            ctx.save();\n            ctx.beginPath();\n            if (shape == LiteGraph.BOX_SHAPE) {\n                ctx.rect(0, 0, size[0], size[1]);\n            } else if (shape == LiteGraph.ROUND_SHAPE) {\n                ctx.roundRect(0, 0, size[0], size[1], [10]);\n            } else if (shape == LiteGraph.CIRCLE_SHAPE) {\n                ctx.arc(\n                    size[0] * 0.5,\n                    size[1] * 0.5,\n                    size[0] * 0.5,\n                    0,\n                    Math.PI * 2\n                );\n            }\n            ctx.clip();\n        }\n\n        //draw shape\n        if (node.has_errors) {\n            bgcolor = \"red\";\n        }\n        this.drawNodeShape(\n            node,\n            ctx,\n            size,\n            color,\n            bgcolor,\n            node.is_selected,\n            node.mouseOver\n        );\n        ctx.shadowColor = \"transparent\";\n\n        //draw foreground\n        if (node.onDrawForeground) {\n            node.onDrawForeground(ctx, this, this.canvas);\n        }\n\n        //connection slots\n        ctx.textAlign = horizontal ? \"center\" : \"left\";\n        ctx.font = this.inner_text_font;\n\n        var render_text = !low_quality;\n\n        var out_slot = this.connecting_output;\n        var in_slot = this.connecting_input;\n        ctx.lineWidth = 1;\n\n        var max_y = 0;\n        var slot_pos = new Float32Array(2); //to reuse\n\n        //render inputs and outputs\n        if (!node.flags.collapsed) {\n            //input connection slots\n            if (node.inputs) {\n                for (var i = 0; i < node.inputs.length; i++) {\n                    var slot = node.inputs[i];\n                    \n                    var slot_type = slot.type;\n                    var slot_shape = slot.shape;\n                    \n                    ctx.globalAlpha = editor_alpha;\n                    //change opacity of incompatible slots when dragging a connection\n                    if ( this.connecting_output && !LiteGraph.isValidConnection( slot.type , out_slot.type) ) {\n                        ctx.globalAlpha = 0.4 * editor_alpha;\n                    }\n\n                    ctx.fillStyle =\n                        slot.link != null\n                            ? slot.color_on ||\n                              this.default_connection_color_byType[slot_type] ||\n                              this.default_connection_color.input_on\n                            : slot.color_off ||\n                              this.default_connection_color_byTypeOff[slot_type] ||\n                              this.default_connection_color_byType[slot_type] ||\n                              this.default_connection_color.input_off;\n\n                    var pos = node.getConnectionPos(true, i, slot_pos);\n                    pos[0] -= node.pos[0];\n                    pos[1] -= node.pos[1];\n                    if (max_y < pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5) {\n                        max_y = pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n                    }\n\n                    ctx.beginPath();\n\n\t\t\t\t\tif (slot_type == \"array\"){\n                        slot_shape = LiteGraph.GRID_SHAPE; // place in addInput? addOutput instead?\n                    }\n                    \n                    var doStroke = true;\n                    \n                    if (\n                        slot.type === LiteGraph.EVENT ||\n                        slot.shape === LiteGraph.BOX_SHAPE\n                    ) {\n                        if (horizontal) {\n                            ctx.rect(\n                                pos[0] - 5 + 0.5,\n                                pos[1] - 8 + 0.5,\n                                10,\n                                14\n                            );\n                        } else {\n                            ctx.rect(\n                                pos[0] - 6 + 0.5,\n                                pos[1] - 5 + 0.5,\n                                14,\n                                10\n                            );\n                        }\n                    } else if (slot_shape === LiteGraph.ARROW_SHAPE) {\n                        ctx.moveTo(pos[0] + 8, pos[1] + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] + 6 + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] - 6 + 0.5);\n                        ctx.closePath();\n                    } else if (slot_shape === LiteGraph.GRID_SHAPE) {\n                        ctx.rect(pos[0] - 4, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] - 4, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] - 4, pos[1] + 2, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] + 2, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] + 2, 2, 2);\n                        doStroke = false;\n                    } else {\n\t\t\t\t\t\tif(low_quality)\n\t                        ctx.rect(pos[0] - 4, pos[1] - 4, 8, 8 ); //faster\n\t\t\t\t\t\telse\n\t                        ctx.arc(pos[0], pos[1], 4, 0, Math.PI * 2);\n                    }\n                    ctx.fill();\n\n                    //render name\n                    if (render_text) {\n                        var text = slot.label != null ? slot.label : slot.name;\n                        if (text) {\n                            ctx.fillStyle = LiteGraph.NODE_TEXT_COLOR;\n                            if (horizontal || slot.dir == LiteGraph.UP) {\n                                ctx.fillText(text, pos[0], pos[1] - 10);\n                            } else {\n                                ctx.fillText(text, pos[0] + 10, pos[1] + 5);\n                            }\n                        }\n                    }\n                }\n            }\n\n            //output connection slots\n\n            ctx.textAlign = horizontal ? \"center\" : \"right\";\n            ctx.strokeStyle = \"black\";\n            if (node.outputs) {\n                for (var i = 0; i < node.outputs.length; i++) {\n                    var slot = node.outputs[i];\n                    \n                    var slot_type = slot.type;\n                    var slot_shape = slot.shape;\n                    \n                    //change opacity of incompatible slots when dragging a connection\n                    if (this.connecting_input && !LiteGraph.isValidConnection( slot_type , in_slot.type) ) {\n                        ctx.globalAlpha = 0.4 * editor_alpha;\n                    }\n                    \n                    var pos = node.getConnectionPos(false, i, slot_pos);\n                    pos[0] -= node.pos[0];\n                    pos[1] -= node.pos[1];\n                    if (max_y < pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5) {\n                        max_y = pos[1] + LiteGraph.NODE_SLOT_HEIGHT * 0.5;\n                    }\n\n                    ctx.fillStyle =\n                        slot.links && slot.links.length\n                            ? slot.color_on ||\n                              this.default_connection_color_byType[slot_type] ||\n                              this.default_connection_color.output_on\n                            : slot.color_off ||\n                              this.default_connection_color_byTypeOff[slot_type] ||\n                              this.default_connection_color_byType[slot_type] ||\n                              this.default_connection_color.output_off;\n                    ctx.beginPath();\n                    //ctx.rect( node.size[0] - 14,i*14,10,10);\n\n\t\t\t\t\tif (slot_type == \"array\"){\n                        slot_shape = LiteGraph.GRID_SHAPE;\n                    }\n                    \n                    var doStroke = true;\n                    \n                    if (\n                        slot_type === LiteGraph.EVENT ||\n                        slot_shape === LiteGraph.BOX_SHAPE\n                    ) {\n                        if (horizontal) {\n                            ctx.rect(\n                                pos[0] - 5 + 0.5,\n                                pos[1] - 8 + 0.5,\n                                10,\n                                14\n                            );\n                        } else {\n                            ctx.rect(\n                                pos[0] - 6 + 0.5,\n                                pos[1] - 5 + 0.5,\n                                14,\n                                10\n                            );\n                        }\n                    } else if (slot_shape === LiteGraph.ARROW_SHAPE) {\n                        ctx.moveTo(pos[0] + 8, pos[1] + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] + 6 + 0.5);\n                        ctx.lineTo(pos[0] - 4, pos[1] - 6 + 0.5);\n                        ctx.closePath();\n                    }  else if (slot_shape === LiteGraph.GRID_SHAPE) {\n                        ctx.rect(pos[0] - 4, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] - 4, 2, 2);\n                        ctx.rect(pos[0] - 4, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] - 1, 2, 2);\n                        ctx.rect(pos[0] - 4, pos[1] + 2, 2, 2);\n                        ctx.rect(pos[0] - 1, pos[1] + 2, 2, 2);\n                        ctx.rect(pos[0] + 2, pos[1] + 2, 2, 2);\n                        doStroke = false;\n                    } else {\n\t\t\t\t\t\tif(low_quality)\n\t                        ctx.rect(pos[0] - 4, pos[1] - 4, 8, 8 );\n\t\t\t\t\t\telse\n\t                        ctx.arc(pos[0], pos[1], 4, 0, Math.PI * 2);\n                    }\n\n                    //trigger\n                    //if(slot.node_id != null && slot.slot == -1)\n                    //\tctx.fillStyle = \"#F85\";\n\n                    //if(slot.links != null && slot.links.length)\n                    ctx.fill();\n\t\t\t\t\tif(!low_quality && doStroke)\n\t                    ctx.stroke();\n\n                    //render output name\n                    if (render_text) {\n                        var text = slot.label != null ? slot.label : slot.name;\n                        if (text) {\n                            ctx.fillStyle = LiteGraph.NODE_TEXT_COLOR;\n                            if (horizontal || slot.dir == LiteGraph.DOWN) {\n                                ctx.fillText(text, pos[0], pos[1] - 8);\n                            } else {\n                                ctx.fillText(text, pos[0] - 10, pos[1] + 5);\n                            }\n                        }\n                    }\n                }\n            }\n\n            ctx.textAlign = \"left\";\n            ctx.globalAlpha = 1;\n\n            if (node.widgets) {\n\t\t\t\tvar widgets_y = max_y;\n                if (horizontal || node.widgets_up) {\n                    widgets_y = 2;\n                }\n\t\t\t\tif( node.widgets_start_y != null )\n                    widgets_y = node.widgets_start_y;\n                this.drawNodeWidgets(\n                    node,\n                    widgets_y,\n                    ctx,\n                    this.node_widget && this.node_widget[0] == node\n                        ? this.node_widget[1]\n                        : null\n                );\n            }\n        } else if (this.render_collapsed_slots) {\n            //if collapsed\n            var input_slot = null;\n            var output_slot = null;\n\n            //get first connected slot to render\n            if (node.inputs) {\n                for (var i = 0; i < node.inputs.length; i++) {\n                    var slot = node.inputs[i];\n                    if (slot.link == null) {\n                        continue;\n                    }\n                    input_slot = slot;\n                    break;\n                }\n            }\n            if (node.outputs) {\n                for (var i = 0; i < node.outputs.length; i++) {\n                    var slot = node.outputs[i];\n                    if (!slot.links || !slot.links.length) {\n                        continue;\n                    }\n                    output_slot = slot;\n                }\n            }\n\n            if (input_slot) {\n                var x = 0;\n                var y = LiteGraph.NODE_TITLE_HEIGHT * -0.5; //center\n                if (horizontal) {\n                    x = node._collapsed_width * 0.5;\n                    y = -LiteGraph.NODE_TITLE_HEIGHT;\n                }\n                ctx.fillStyle = \"#686\";\n                ctx.beginPath();\n                if (\n                    slot.type === LiteGraph.EVENT ||\n                    slot.shape === LiteGraph.BOX_SHAPE\n                ) {\n                    ctx.rect(x - 7 + 0.5, y - 4, 14, 8);\n                } else if (slot.shape === LiteGraph.ARROW_SHAPE) {\n                    ctx.moveTo(x + 8, y);\n                    ctx.lineTo(x + -4, y - 4);\n                    ctx.lineTo(x + -4, y + 4);\n                    ctx.closePath();\n                } else {\n                    ctx.arc(x, y, 4, 0, Math.PI * 2);\n                }\n                ctx.fill();\n            }\n\n            if (output_slot) {\n                var x = node._collapsed_width;\n                var y = LiteGraph.NODE_TITLE_HEIGHT * -0.5; //center\n                if (horizontal) {\n                    x = node._collapsed_width * 0.5;\n                    y = 0;\n                }\n                ctx.fillStyle = \"#686\";\n                ctx.strokeStyle = \"black\";\n                ctx.beginPath();\n                if (\n                    slot.type === LiteGraph.EVENT ||\n                    slot.shape === LiteGraph.BOX_SHAPE\n                ) {\n                    ctx.rect(x - 7 + 0.5, y - 4, 14, 8);\n                } else if (slot.shape === LiteGraph.ARROW_SHAPE) {\n                    ctx.moveTo(x + 6, y);\n                    ctx.lineTo(x - 6, y - 4);\n                    ctx.lineTo(x - 6, y + 4);\n                    ctx.closePath();\n                } else {\n                    ctx.arc(x, y, 4, 0, Math.PI * 2);\n                }\n                ctx.fill();\n                //ctx.stroke();\n            }\n        }\n\n        if (node.clip_area) {\n            ctx.restore();\n        }\n\n        ctx.globalAlpha = 1.0;\n    };\n\n\t//used by this.over_link_center\n\tLGraphCanvas.prototype.drawLinkTooltip = function( ctx, link )\n\t{\n\t\tvar pos = link._pos;\n\t\tctx.fillStyle = \"black\";\n\t\tctx.beginPath();\n\t\tctx.arc( pos[0], pos[1], 3, 0, Math.PI * 2 );\n\t\tctx.fill();\n\n\t\tif(link.data == null)\n\t\t\treturn;\n\n\t\tif(this.onDrawLinkTooltip)\n\t\t\tif( this.onDrawLinkTooltip(ctx,link,this) == true )\n\t\t\t\treturn;\n\n\t\tvar data = link.data;\n\t\tvar text = null;\n\n\t\tif( data.constructor === Number )\n\t\t\ttext = data.toFixed(2);\n\t\telse if( data.constructor === String )\n\t\t\ttext = \"\\\"\" + data + \"\\\"\";\n\t\telse if( data.constructor === Boolean )\n\t\t\ttext = String(data);\n\t\telse if (data.toToolTip)\n\t\t\ttext = data.toToolTip();\n\t\telse\n\t\t\ttext = \"[\" + data.constructor.name + \"]\";\n\n\t\tif(text == null)\n\t\t\treturn;\n\t\ttext = text.substr(0,30); //avoid weird\n\n\t\tctx.font = \"14px Courier New\";\n\t\tvar info = ctx.measureText(text);\n\t\tvar w = info.width + 20;\n\t\tvar h = 24;\n\t\tctx.shadowColor = \"black\";\n\t\tctx.shadowOffsetX = 2;\n\t\tctx.shadowOffsetY = 2;\n\t\tctx.shadowBlur = 3;\n\t\tctx.fillStyle = \"#454\";\n\t\tctx.beginPath();\n\t\tctx.roundRect( pos[0] - w*0.5, pos[1] - 15 - h, w, h, [3]);\n\t\tctx.moveTo( pos[0] - 10, pos[1] - 15 );\n\t\tctx.lineTo( pos[0] + 10, pos[1] - 15 );\n\t\tctx.lineTo( pos[0], pos[1] - 5 );\n\t\tctx.fill();\n        ctx.shadowColor = \"transparent\";\n\t\tctx.textAlign = \"center\";\n\t\tctx.fillStyle = \"#CEC\";\n\t\tctx.fillText(text, pos[0], pos[1] - 15 - h * 0.3);\n\t}\n\n    /**\n     * draws the shape of the given node in the canvas\n     * @method drawNodeShape\n     **/\n    var tmp_area = new Float32Array(4);\n\n    LGraphCanvas.prototype.drawNodeShape = function(\n        node,\n        ctx,\n        size,\n        fgcolor,\n        bgcolor,\n        selected,\n        mouse_over\n    ) {\n        //bg rect\n        ctx.strokeStyle = fgcolor;\n        ctx.fillStyle = bgcolor;\n\n        var title_height = LiteGraph.NODE_TITLE_HEIGHT;\n        var low_quality = this.ds.scale < 0.5;\n\n        //render node area depending on shape\n        var shape =\n            node._shape || node.constructor.shape || LiteGraph.ROUND_SHAPE;\n\n        var title_mode = node.constructor.title_mode;\n\n        var render_title = true;\n        if (title_mode == LiteGraph.TRANSPARENT_TITLE || title_mode == LiteGraph.NO_TITLE) {\n            render_title = false;\n        } else if (title_mode == LiteGraph.AUTOHIDE_TITLE && mouse_over) {\n            render_title = true;\n        }\n\n        var area = tmp_area;\n        area[0] = 0; //x\n        area[1] = render_title ? -title_height : 0; //y\n        area[2] = size[0] + 1; //w\n        area[3] = render_title ? size[1] + title_height : size[1]; //h\n\n        var old_alpha = ctx.globalAlpha;\n\n        //full node shape\n        //if(node.flags.collapsed)\n        {\n            ctx.beginPath();\n            if (shape == LiteGraph.BOX_SHAPE || low_quality) {\n                ctx.fillRect(area[0], area[1], area[2], area[3]);\n            } else if (\n                shape == LiteGraph.ROUND_SHAPE ||\n                shape == LiteGraph.CARD_SHAPE\n            ) {\n                ctx.roundRect(\n                    area[0],\n                    area[1],\n                    area[2],\n                    area[3],\n                    shape == LiteGraph.CARD_SHAPE ? [this.round_radius,this.round_radius,0,0] : [this.round_radius] \n                );\n            } else if (shape == LiteGraph.CIRCLE_SHAPE) {\n                ctx.arc(\n                    size[0] * 0.5,\n                    size[1] * 0.5,\n                    size[0] * 0.5,\n                    0,\n                    Math.PI * 2\n                );\n            }\n            ctx.fill();\n\n\t\t\t//separator\n\t\t\tif(!node.flags.collapsed && render_title)\n\t\t\t{\n\t\t\t\tctx.shadowColor = \"transparent\";\n\t\t\t\tctx.fillStyle = \"rgba(0,0,0,0.2)\";\n\t\t\t\tctx.fillRect(0, -1, area[2], 2);\n\t\t\t}\n        }\n        ctx.shadowColor = \"transparent\";\n\n        if (node.onDrawBackground) {\n            node.onDrawBackground(ctx, this, this.canvas, this.graph_mouse );\n        }\n\n        //title bg (remember, it is rendered ABOVE the node)\n        if (render_title || title_mode == LiteGraph.TRANSPARENT_TITLE) {\n            //title bar\n            if (node.onDrawTitleBar) {\n                node.onDrawTitleBar( ctx, title_height, size, this.ds.scale, fgcolor );\n            } else if (\n                title_mode != LiteGraph.TRANSPARENT_TITLE &&\n                (node.constructor.title_color || this.render_title_colored)\n            ) {\n                var title_color = node.constructor.title_color || fgcolor;\n\n                if (node.flags.collapsed) {\n                    ctx.shadowColor = LiteGraph.DEFAULT_SHADOW_COLOR;\n                }\n\n                //* gradient test\n                if (this.use_gradients) {\n                    var grad = LGraphCanvas.gradients[title_color];\n                    if (!grad) {\n                        grad = LGraphCanvas.gradients[ title_color ] = ctx.createLinearGradient(0, 0, 400, 0);\n                        grad.addColorStop(0, title_color); // TODO refactor: validate color !! prevent DOMException\n                        grad.addColorStop(1, \"#000\");\n                    }\n                    ctx.fillStyle = grad;\n                } else {\n                    ctx.fillStyle = title_color;\n                }\n\n                //ctx.globalAlpha = 0.5 * old_alpha;\n                ctx.beginPath();\n                if (shape == LiteGraph.BOX_SHAPE || low_quality) {\n                    ctx.rect(0, -title_height, size[0] + 1, title_height);\n                } else if (  shape == LiteGraph.ROUND_SHAPE || shape == LiteGraph.CARD_SHAPE ) {\n                    ctx.roundRect(\n                        0,\n                        -title_height,\n                        size[0] + 1,\n                        title_height,\n                        node.flags.collapsed ? [this.round_radius] : [this.round_radius,this.round_radius,0,0]\n                    );\n                }\n                ctx.fill();\n                ctx.shadowColor = \"transparent\";\n            }\n\n            var colState = false;\n            if (LiteGraph.node_box_coloured_by_mode){\n                if(LiteGraph.NODE_MODES_COLORS[node.mode]){\n                    colState = LiteGraph.NODE_MODES_COLORS[node.mode];\n                }\n            }\n            if (LiteGraph.node_box_coloured_when_on){\n                colState = node.action_triggered ? \"#FFF\" : (node.execute_triggered ? \"#AAA\" : colState);\n            }\n            \n            //title box\n            var box_size = 10;\n            if (node.onDrawTitleBox) {\n                node.onDrawTitleBox(ctx, title_height, size, this.ds.scale);\n            } else if (\n                shape == LiteGraph.ROUND_SHAPE ||\n                shape == LiteGraph.CIRCLE_SHAPE ||\n                shape == LiteGraph.CARD_SHAPE\n            ) {\n                if (low_quality) {\n                    ctx.fillStyle = \"black\";\n                    ctx.beginPath();\n                    ctx.arc(\n                        title_height * 0.5,\n                        title_height * -0.5,\n                        box_size * 0.5 + 1,\n                        0,\n                        Math.PI * 2\n                    );\n                    ctx.fill();\n                }\n                \n                ctx.fillStyle = node.boxcolor || colState || LiteGraph.NODE_DEFAULT_BOXCOLOR;\n\t\t\t\tif(low_quality)\n\t\t\t\t\tctx.fillRect( title_height * 0.5 - box_size *0.5, title_height * -0.5 - box_size *0.5, box_size , box_size  );\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.arc(\n\t\t\t\t\t\ttitle_height * 0.5,\n\t\t\t\t\t\ttitle_height * -0.5,\n\t\t\t\t\t\tbox_size * 0.5,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tMath.PI * 2\n\t\t\t\t\t);\n\t\t\t\t\tctx.fill();\n\t\t\t\t}\n            } else {\n                if (low_quality) {\n                    ctx.fillStyle = \"black\";\n                    ctx.fillRect(\n                        (title_height - box_size) * 0.5 - 1,\n                        (title_height + box_size) * -0.5 - 1,\n                        box_size + 2,\n                        box_size + 2\n                    );\n                }\n                ctx.fillStyle = node.boxcolor || colState || LiteGraph.NODE_DEFAULT_BOXCOLOR;\n                ctx.fillRect(\n                    (title_height - box_size) * 0.5,\n                    (title_height + box_size) * -0.5,\n                    box_size,\n                    box_size\n                );\n            }\n            ctx.globalAlpha = old_alpha;\n\n            //title text\n            if (node.onDrawTitleText) {\n                node.onDrawTitleText(\n                    ctx,\n                    title_height,\n                    size,\n                    this.ds.scale,\n                    this.title_text_font,\n                    selected\n                );\n            }\n            if (!low_quality) {\n                ctx.font = this.title_text_font;\n                var title = String(node.getTitle());\n                if (title) {\n                    if (selected) {\n                        ctx.fillStyle = LiteGraph.NODE_SELECTED_TITLE_COLOR;\n                    } else {\n                        ctx.fillStyle =\n                            node.constructor.title_text_color ||\n                            this.node_title_color;\n                    }\n                    if (node.flags.collapsed) {\n                        ctx.textAlign = \"left\";\n                        var measure = ctx.measureText(title);\n                        ctx.fillText(\n                            title.substr(0,20), //avoid urls too long\n                            title_height,// + measure.width * 0.5,\n                            LiteGraph.NODE_TITLE_TEXT_Y - title_height\n                        );\n                        ctx.textAlign = \"left\";\n                    } else {\n                        ctx.textAlign = \"left\";\n                        ctx.fillText(\n                            title,\n                            title_height,\n                            LiteGraph.NODE_TITLE_TEXT_Y - title_height\n                        );\n                    }\n                }\n            }\n\n\t\t\t//subgraph box\n\t\t\tif (!node.flags.collapsed && node.subgraph && !node.skip_subgraph_button) {\n\t\t\t\tvar w = LiteGraph.NODE_TITLE_HEIGHT;\n\t\t\t\tvar x = node.size[0] - w;\n\t\t\t\tvar over = LiteGraph.isInsideRectangle( this.graph_mouse[0] - node.pos[0], this.graph_mouse[1] - node.pos[1], x+2, -w+2, w-4, w-4 );\n\t\t\t\tctx.fillStyle = over ? \"#888\" : \"#555\";\n\t\t\t\tif( shape == LiteGraph.BOX_SHAPE || low_quality)\n\t\t\t\t\tctx.fillRect(x+2, -w+2, w-4, w-4);\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.roundRect(x+2, -w+2, w-4, w-4,[4]);\n\t\t\t\t\tctx.fill();\n\t\t\t\t}\n\t\t\t\tctx.fillStyle = \"#333\";\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.moveTo(x + w * 0.2, -w * 0.6);\n\t\t\t\tctx.lineTo(x + w * 0.8, -w * 0.6);\n\t\t\t\tctx.lineTo(x + w * 0.5, -w * 0.3);\n\t\t\t\tctx.fill();\n\t\t\t}\n\n\t\t\t//custom title render\n            if (node.onDrawTitle) {\n                node.onDrawTitle(ctx);\n            }\n        }\n\n        //render selection marker\n        if (selected) {\n            if (node.onBounding) {\n                node.onBounding(area);\n            }\n\n            if (title_mode == LiteGraph.TRANSPARENT_TITLE) {\n                area[1] -= title_height;\n                area[3] += title_height;\n            }\n            ctx.lineWidth = 1;\n            ctx.globalAlpha = 0.8;\n            ctx.beginPath();\n            if (shape == LiteGraph.BOX_SHAPE) {\n                ctx.rect(\n                    -6 + area[0],\n                    -6 + area[1],\n                    12 + area[2],\n                    12 + area[3]\n                );\n            } else if (\n                shape == LiteGraph.ROUND_SHAPE ||\n                (shape == LiteGraph.CARD_SHAPE && node.flags.collapsed)\n            ) {\n                ctx.roundRect(\n                    -6 + area[0],\n                    -6 + area[1],\n                    12 + area[2],\n                    12 + area[3],\n                    [this.round_radius * 2]\n                );\n            } else if (shape == LiteGraph.CARD_SHAPE) {\n                ctx.roundRect(\n                    -6 + area[0],\n                    -6 + area[1],\n                    12 + area[2],\n                    12 + area[3],\n                    [this.round_radius * 2,2,this.round_radius * 2,2]\n                );\n            } else if (shape == LiteGraph.CIRCLE_SHAPE) {\n                ctx.arc(\n                    size[0] * 0.5,\n                    size[1] * 0.5,\n                    size[0] * 0.5 + 6,\n                    0,\n                    Math.PI * 2\n                );\n            }\n            ctx.strokeStyle = LiteGraph.NODE_BOX_OUTLINE_COLOR;\n            ctx.stroke();\n            ctx.strokeStyle = fgcolor;\n            ctx.globalAlpha = 1;\n        }\n        \n        // these counter helps in conditioning drawing based on if the node has been executed or an action occurred\n        if (node.execute_triggered>0) node.execute_triggered--;\n        if (node.action_triggered>0) node.action_triggered--;\n    };\n\n    var margin_area = new Float32Array(4);\n    var link_bounding = new Float32Array(4);\n    var tempA = new Float32Array(2);\n    var tempB = new Float32Array(2);\n\n    /**\n     * draws every connection visible in the canvas\n     * OPTIMIZE THIS: pre-catch connections position instead of recomputing them every time\n     * @method drawConnections\n     **/\n    LGraphCanvas.prototype.drawConnections = function(ctx) {\n        var now = LiteGraph.getTime();\n        var visible_area = this.visible_area;\n        margin_area[0] = visible_area[0] - 20;\n        margin_area[1] = visible_area[1] - 20;\n        margin_area[2] = visible_area[2] + 40;\n        margin_area[3] = visible_area[3] + 40;\n\n        //draw connections\n        ctx.lineWidth = this.connections_width;\n\n        ctx.fillStyle = \"#AAA\";\n        ctx.strokeStyle = \"#AAA\";\n        ctx.globalAlpha = this.editor_alpha;\n        //for every node\n        var nodes = this.graph._nodes;\n        for (var n = 0, l = nodes.length; n < l; ++n) {\n            var node = nodes[n];\n            //for every input (we render just inputs because it is easier as every slot can only have one input)\n            if (!node.inputs || !node.inputs.length) {\n                continue;\n            }\n\n            for (var i = 0; i < node.inputs.length; ++i) {\n                var input = node.inputs[i];\n                if (!input || input.link == null) {\n                    continue;\n                }\n                var link_id = input.link;\n                var link = this.graph.links[link_id];\n                if (!link) {\n                    continue;\n                }\n\n                //find link info\n                var start_node = this.graph.getNodeById(link.origin_id);\n                if (start_node == null) {\n                    continue;\n                }\n                var start_node_slot = link.origin_slot;\n                var start_node_slotpos = null;\n                if (start_node_slot == -1) {\n                    start_node_slotpos = [\n                        start_node.pos[0] + 10,\n                        start_node.pos[1] + 10\n                    ];\n                } else {\n                    start_node_slotpos = start_node.getConnectionPos(\n                        false,\n                        start_node_slot,\n                        tempA\n                    );\n                }\n                var end_node_slotpos = node.getConnectionPos(true, i, tempB);\n\n                //compute link bounding\n                link_bounding[0] = start_node_slotpos[0];\n                link_bounding[1] = start_node_slotpos[1];\n                link_bounding[2] = end_node_slotpos[0] - start_node_slotpos[0];\n                link_bounding[3] = end_node_slotpos[1] - start_node_slotpos[1];\n                if (link_bounding[2] < 0) {\n                    link_bounding[0] += link_bounding[2];\n                    link_bounding[2] = Math.abs(link_bounding[2]);\n                }\n                if (link_bounding[3] < 0) {\n                    link_bounding[1] += link_bounding[3];\n                    link_bounding[3] = Math.abs(link_bounding[3]);\n                }\n\n                //skip links outside of the visible area of the canvas\n                if (!overlapBounding(link_bounding, margin_area)) {\n                    continue;\n                }\n\n                var start_slot = start_node.outputs[start_node_slot];\n                var end_slot = node.inputs[i];\n                if (!start_slot || !end_slot) {\n                    continue;\n                }\n                var start_dir =\n                    start_slot.dir ||\n                    (start_node.horizontal ? LiteGraph.DOWN : LiteGraph.RIGHT);\n                var end_dir =\n                    end_slot.dir ||\n                    (node.horizontal ? LiteGraph.UP : LiteGraph.LEFT);\n\n                this.renderLink(\n                    ctx,\n                    start_node_slotpos,\n                    end_node_slotpos,\n                    link,\n                    false,\n                    0,\n                    null,\n                    start_dir,\n                    end_dir\n                );\n\n                //event triggered rendered on top\n                if (link && link._last_time && now - link._last_time < 1000) {\n                    var f = 2.0 - (now - link._last_time) * 0.002;\n                    var tmp = ctx.globalAlpha;\n                    ctx.globalAlpha = tmp * f;\n                    this.renderLink(\n                        ctx,\n                        start_node_slotpos,\n                        end_node_slotpos,\n                        link,\n                        true,\n                        f,\n                        \"white\",\n                        start_dir,\n                        end_dir\n                    );\n                    ctx.globalAlpha = tmp;\n                }\n            }\n        }\n        ctx.globalAlpha = 1;\n    };\n\n    /**\n     * draws a link between two points\n     * @method renderLink\n     * @param {vec2} a start pos\n     * @param {vec2} b end pos\n     * @param {Object} link the link object with all the link info\n     * @param {boolean} skip_border ignore the shadow of the link\n     * @param {boolean} flow show flow animation (for events)\n     * @param {string} color the color for the link\n     * @param {number} start_dir the direction enum\n     * @param {number} end_dir the direction enum\n     * @param {number} num_sublines number of sublines (useful to represent vec3 or rgb)\n     **/\n    LGraphCanvas.prototype.renderLink = function(\n        ctx,\n        a,\n        b,\n        link,\n        skip_border,\n        flow,\n        color,\n        start_dir,\n        end_dir,\n        num_sublines\n    ) {\n        if (link) {\n            this.visible_links.push(link);\n        }\n\n        //choose color\n        if (!color && link) {\n            color = link.color || LGraphCanvas.link_type_colors[link.type];\n        }\n        if (!color) {\n            color = this.default_link_color;\n        }\n        if (link != null && this.highlighted_links[link.id]) {\n            color = \"#FFF\";\n        }\n\n        start_dir = start_dir || LiteGraph.RIGHT;\n        end_dir = end_dir || LiteGraph.LEFT;\n\n        var dist = distance(a, b);\n\n        if (this.render_connections_border && this.ds.scale > 0.6) {\n            ctx.lineWidth = this.connections_width + 4;\n        }\n        ctx.lineJoin = \"round\";\n        num_sublines = num_sublines || 1;\n        if (num_sublines > 1) {\n            ctx.lineWidth = 0.5;\n        }\n\n        //begin line shape\n        ctx.beginPath();\n        for (var i = 0; i < num_sublines; i += 1) {\n            var offsety = (i - (num_sublines - 1) * 0.5) * 5;\n\n            if (this.links_render_mode == LiteGraph.SPLINE_LINK) {\n                ctx.moveTo(a[0], a[1] + offsety);\n                var start_offset_x = 0;\n                var start_offset_y = 0;\n                var end_offset_x = 0;\n                var end_offset_y = 0;\n                switch (start_dir) {\n                    case LiteGraph.LEFT:\n                        start_offset_x = dist * -0.25;\n                        break;\n                    case LiteGraph.RIGHT:\n                        start_offset_x = dist * 0.25;\n                        break;\n                    case LiteGraph.UP:\n                        start_offset_y = dist * -0.25;\n                        break;\n                    case LiteGraph.DOWN:\n                        start_offset_y = dist * 0.25;\n                        break;\n                }\n                switch (end_dir) {\n                    case LiteGraph.LEFT:\n                        end_offset_x = dist * -0.25;\n                        break;\n                    case LiteGraph.RIGHT:\n                        end_offset_x = dist * 0.25;\n                        break;\n                    case LiteGraph.UP:\n                        end_offset_y = dist * -0.25;\n                        break;\n                    case LiteGraph.DOWN:\n                        end_offset_y = dist * 0.25;\n                        break;\n                }\n                ctx.bezierCurveTo(\n                    a[0] + start_offset_x,\n                    a[1] + start_offset_y + offsety,\n                    b[0] + end_offset_x,\n                    b[1] + end_offset_y + offsety,\n                    b[0],\n                    b[1] + offsety\n                );\n            } else if (this.links_render_mode == LiteGraph.LINEAR_LINK) {\n                ctx.moveTo(a[0], a[1] + offsety);\n                var start_offset_x = 0;\n                var start_offset_y = 0;\n                var end_offset_x = 0;\n                var end_offset_y = 0;\n                switch (start_dir) {\n                    case LiteGraph.LEFT:\n                        start_offset_x = -1;\n                        break;\n                    case LiteGraph.RIGHT:\n                        start_offset_x = 1;\n                        break;\n                    case LiteGraph.UP:\n                        start_offset_y = -1;\n                        break;\n                    case LiteGraph.DOWN:\n                        start_offset_y = 1;\n                        break;\n                }\n                switch (end_dir) {\n                    case LiteGraph.LEFT:\n                        end_offset_x = -1;\n                        break;\n                    case LiteGraph.RIGHT:\n                        end_offset_x = 1;\n                        break;\n                    case LiteGraph.UP:\n                        end_offset_y = -1;\n                        break;\n                    case LiteGraph.DOWN:\n                        end_offset_y = 1;\n                        break;\n                }\n                var l = 15;\n                ctx.lineTo(\n                    a[0] + start_offset_x * l,\n                    a[1] + start_offset_y * l + offsety\n                );\n                ctx.lineTo(\n                    b[0] + end_offset_x * l,\n                    b[1] + end_offset_y * l + offsety\n                );\n                ctx.lineTo(b[0], b[1] + offsety);\n            } else if (this.links_render_mode == LiteGraph.STRAIGHT_LINK) {\n                ctx.moveTo(a[0], a[1]);\n                var start_x = a[0];\n                var start_y = a[1];\n                var end_x = b[0];\n                var end_y = b[1];\n                if (start_dir == LiteGraph.RIGHT) {\n                    start_x += 10;\n                } else {\n                    start_y += 10;\n                }\n                if (end_dir == LiteGraph.LEFT) {\n                    end_x -= 10;\n                } else {\n                    end_y -= 10;\n                }\n                ctx.lineTo(start_x, start_y);\n                ctx.lineTo((start_x + end_x) * 0.5, start_y);\n                ctx.lineTo((start_x + end_x) * 0.5, end_y);\n                ctx.lineTo(end_x, end_y);\n                ctx.lineTo(b[0], b[1]);\n            } else {\n                return;\n            } //unknown\n        }\n\n        //rendering the outline of the connection can be a little bit slow\n        if (\n            this.render_connections_border &&\n            this.ds.scale > 0.6 &&\n            !skip_border\n        ) {\n            ctx.strokeStyle = \"rgba(0,0,0,0.5)\";\n            ctx.stroke();\n        }\n\n        ctx.lineWidth = this.connections_width;\n        ctx.fillStyle = ctx.strokeStyle = color;\n        ctx.stroke();\n        //end line shape\n\n        var pos = this.computeConnectionPoint(a, b, 0.5, start_dir, end_dir);\n        if (link && link._pos) {\n            link._pos[0] = pos[0];\n            link._pos[1] = pos[1];\n        }\n\n        //render arrow in the middle\n        if (\n            this.ds.scale >= 0.6 &&\n            this.highquality_render &&\n            end_dir != LiteGraph.CENTER\n        ) {\n            //render arrow\n            if (this.render_connection_arrows) {\n                //compute two points in the connection\n                var posA = this.computeConnectionPoint(\n                    a,\n                    b,\n                    0.25,\n                    start_dir,\n                    end_dir\n                );\n                var posB = this.computeConnectionPoint(\n                    a,\n                    b,\n                    0.26,\n                    start_dir,\n                    end_dir\n                );\n                var posC = this.computeConnectionPoint(\n                    a,\n                    b,\n                    0.75,\n                    start_dir,\n                    end_dir\n                );\n                var posD = this.computeConnectionPoint(\n                    a,\n                    b,\n                    0.76,\n                    start_dir,\n                    end_dir\n                );\n\n                //compute the angle between them so the arrow points in the right direction\n                var angleA = 0;\n                var angleB = 0;\n                if (this.render_curved_connections) {\n                    angleA = -Math.atan2(posB[0] - posA[0], posB[1] - posA[1]);\n                    angleB = -Math.atan2(posD[0] - posC[0], posD[1] - posC[1]);\n                } else {\n                    angleB = angleA = b[1] > a[1] ? 0 : Math.PI;\n                }\n\n                //render arrow\n                ctx.save();\n                ctx.translate(posA[0], posA[1]);\n                ctx.rotate(angleA);\n                ctx.beginPath();\n                ctx.moveTo(-5, -3);\n                ctx.lineTo(0, +7);\n                ctx.lineTo(+5, -3);\n                ctx.fill();\n                ctx.restore();\n                ctx.save();\n                ctx.translate(posC[0], posC[1]);\n                ctx.rotate(angleB);\n                ctx.beginPath();\n                ctx.moveTo(-5, -3);\n                ctx.lineTo(0, +7);\n                ctx.lineTo(+5, -3);\n                ctx.fill();\n                ctx.restore();\n            }\n\n            //circle\n            ctx.beginPath();\n            ctx.arc(pos[0], pos[1], 5, 0, Math.PI * 2);\n            ctx.fill();\n        }\n\n        //render flowing points\n        if (flow) {\n            ctx.fillStyle = color;\n            for (var i = 0; i < 5; ++i) {\n                var f = (LiteGraph.getTime() * 0.001 + i * 0.2) % 1;\n                var pos = this.computeConnectionPoint(\n                    a,\n                    b,\n                    f,\n                    start_dir,\n                    end_dir\n                );\n                ctx.beginPath();\n                ctx.arc(pos[0], pos[1], 5, 0, 2 * Math.PI);\n                ctx.fill();\n            }\n        }\n    };\n\n    //returns the link center point based on curvature\n    LGraphCanvas.prototype.computeConnectionPoint = function(\n        a,\n        b,\n        t,\n        start_dir,\n        end_dir\n    ) {\n        start_dir = start_dir || LiteGraph.RIGHT;\n        end_dir = end_dir || LiteGraph.LEFT;\n\n        var dist = distance(a, b);\n        var p0 = a;\n        var p1 = [a[0], a[1]];\n        var p2 = [b[0], b[1]];\n        var p3 = b;\n\n        switch (start_dir) {\n            case LiteGraph.LEFT:\n                p1[0] += dist * -0.25;\n                break;\n            case LiteGraph.RIGHT:\n                p1[0] += dist * 0.25;\n                break;\n            case LiteGraph.UP:\n                p1[1] += dist * -0.25;\n                break;\n            case LiteGraph.DOWN:\n                p1[1] += dist * 0.25;\n                break;\n        }\n        switch (end_dir) {\n            case LiteGraph.LEFT:\n                p2[0] += dist * -0.25;\n                break;\n            case LiteGraph.RIGHT:\n                p2[0] += dist * 0.25;\n                break;\n            case LiteGraph.UP:\n                p2[1] += dist * -0.25;\n                break;\n            case LiteGraph.DOWN:\n                p2[1] += dist * 0.25;\n                break;\n        }\n\n        var c1 = (1 - t) * (1 - t) * (1 - t);\n        var c2 = 3 * ((1 - t) * (1 - t)) * t;\n        var c3 = 3 * (1 - t) * (t * t);\n        var c4 = t * t * t;\n\n        var x = c1 * p0[0] + c2 * p1[0] + c3 * p2[0] + c4 * p3[0];\n        var y = c1 * p0[1] + c2 * p1[1] + c3 * p2[1] + c4 * p3[1];\n        return [x, y];\n    };\n\n    LGraphCanvas.prototype.drawExecutionOrder = function(ctx) {\n        ctx.shadowColor = \"transparent\";\n        ctx.globalAlpha = 0.25;\n\n        ctx.textAlign = \"center\";\n        ctx.strokeStyle = \"white\";\n        ctx.globalAlpha = 0.75;\n\n        var visible_nodes = this.visible_nodes;\n        for (var i = 0; i < visible_nodes.length; ++i) {\n            var node = visible_nodes[i];\n            ctx.fillStyle = \"black\";\n            ctx.fillRect(\n                node.pos[0] - LiteGraph.NODE_TITLE_HEIGHT,\n                node.pos[1] - LiteGraph.NODE_TITLE_HEIGHT,\n                LiteGraph.NODE_TITLE_HEIGHT,\n                LiteGraph.NODE_TITLE_HEIGHT\n            );\n            if (node.order == 0) {\n                ctx.strokeRect(\n                    node.pos[0] - LiteGraph.NODE_TITLE_HEIGHT + 0.5,\n                    node.pos[1] - LiteGraph.NODE_TITLE_HEIGHT + 0.5,\n                    LiteGraph.NODE_TITLE_HEIGHT,\n                    LiteGraph.NODE_TITLE_HEIGHT\n                );\n            }\n            ctx.fillStyle = \"#FFF\";\n            ctx.fillText(\n                node.order,\n                node.pos[0] + LiteGraph.NODE_TITLE_HEIGHT * -0.5,\n                node.pos[1] - 6\n            );\n        }\n        ctx.globalAlpha = 1;\n    };\n\n    /**\n     * draws the widgets stored inside a node\n     * @method drawNodeWidgets\n     **/\n    LGraphCanvas.prototype.drawNodeWidgets = function(\n        node,\n        posY,\n        ctx,\n        active_widget\n    ) {\n        if (!node.widgets || !node.widgets.length) {\n            return 0;\n        }\n        var width = node.size[0];\n        var widgets = node.widgets;\n        posY += 2;\n        var H = LiteGraph.NODE_WIDGET_HEIGHT;\n        var show_text = this.ds.scale > 0.5;\n        ctx.save();\n        ctx.globalAlpha = this.editor_alpha;\n        var outline_color = LiteGraph.WIDGET_OUTLINE_COLOR;\n        var background_color = LiteGraph.WIDGET_BGCOLOR;\n        var text_color = LiteGraph.WIDGET_TEXT_COLOR;\n\t\tvar secondary_text_color = LiteGraph.WIDGET_SECONDARY_TEXT_COLOR;\n        var margin = 15;\n\n        for (var i = 0; i < widgets.length; ++i) {\n            var w = widgets[i];\n            var y = posY;\n            if (w.y) {\n                y = w.y;\n            }\n            w.last_y = y;\n            ctx.strokeStyle = outline_color;\n            ctx.fillStyle = \"#222\";\n            ctx.textAlign = \"left\";\n\t\t\t//ctx.lineWidth = 2;\n\t\t\tif(w.disabled)\n\t\t\t\tctx.globalAlpha *= 0.5;\n\t\t\tvar widget_width = w.width || width;\n\n            switch (w.type) {\n                case \"button\":\n                    if (w.clicked) {\n                        ctx.fillStyle = \"#AAA\";\n                        w.clicked = false;\n                        this.dirty_canvas = true;\n                    }\n                    ctx.fillRect(margin, y, widget_width - margin * 2, H);\n\t\t\t\t\tif(show_text && !w.disabled)\n\t                    ctx.strokeRect( margin, y, widget_width - margin * 2, H );\n                    if (show_text) {\n                        ctx.textAlign = \"center\";\n                        ctx.fillStyle = text_color;\n                        ctx.fillText(w.name, widget_width * 0.5, y + H * 0.7);\n                    }\n                    break;\n                case \"toggle\":\n                    ctx.textAlign = \"left\";\n                    ctx.strokeStyle = outline_color;\n                    ctx.fillStyle = background_color;\n                    ctx.beginPath();\n                    if (show_text)\n\t                    ctx.roundRect(margin, y, widget_width - margin * 2, H, [H * 0.5]);\n\t\t\t\t\telse\n\t                    ctx.rect(margin, y, widget_width - margin * 2, H );\n                    ctx.fill();\n\t\t\t\t\tif(show_text && !w.disabled)\n\t                    ctx.stroke();\n                    ctx.fillStyle = w.value ? \"#89A\" : \"#333\";\n                    ctx.beginPath();\n                    ctx.arc( widget_width - margin * 2, y + H * 0.5, H * 0.36, 0, Math.PI * 2 );\n                    ctx.fill();\n                    if (show_text) {\n                        ctx.fillStyle = secondary_text_color;\n                        if (w.name != null) {\n                            ctx.fillText(w.name, margin * 2, y + H * 0.7);\n                        }\n                        ctx.fillStyle = w.value ? text_color : secondary_text_color;\n                        ctx.textAlign = \"right\";\n                        ctx.fillText(\n                            w.value\n                                ? w.options.on || \"true\"\n                                : w.options.off || \"false\",\n                            widget_width - 40,\n                            y + H * 0.7\n                        );\n                    }\n                    break;\n                case \"slider\":\n                    ctx.fillStyle = background_color;\n                    ctx.fillRect(margin, y, widget_width - margin * 2, H);\n                    var range = w.options.max - w.options.min;\n                    var nvalue = (w.value - w.options.min) / range;\n                    ctx.fillStyle = active_widget == w ? \"#89A\" : \"#678\";\n                    ctx.fillRect(margin, y, nvalue * (widget_width - margin * 2), H);\n\t\t\t\t\tif(show_text && !w.disabled)\n\t                    ctx.strokeRect(margin, y, widget_width - margin * 2, H);\n                    if (w.marker) {\n                        var marker_nvalue = (w.marker - w.options.min) / range;\n                        ctx.fillStyle = \"#AA9\";\n                        ctx.fillRect( margin + marker_nvalue * (widget_width - margin * 2), y, 2, H );\n                    }\n                    if (show_text) {\n                        ctx.textAlign = \"center\";\n                        ctx.fillStyle = text_color;\n                        ctx.fillText(\n                            w.name + \"  \" + Number(w.value).toFixed(3),\n                            widget_width * 0.5,\n                            y + H * 0.7\n                        );\n                    }\n                    break;\n                case \"number\":\n                case \"combo\":\n                    ctx.textAlign = \"left\";\n                    ctx.strokeStyle = outline_color;\n                    ctx.fillStyle = background_color;\n                    ctx.beginPath();\n\t\t\t\t\tif(show_text)\n\t                    ctx.roundRect(margin, y, widget_width - margin * 2, H, [H * 0.5] );\n\t\t\t\t\telse\n\t                    ctx.rect(margin, y, widget_width - margin * 2, H );\n                    ctx.fill();\n                    if (show_text) {\n\t\t\t\t\t\tif(!w.disabled)\n\t\t                    ctx.stroke();\n                        ctx.fillStyle = text_color;\n\t\t\t\t\t\tif(!w.disabled)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\t\tctx.moveTo(margin + 16, y + 5);\n\t\t\t\t\t\t\tctx.lineTo(margin + 6, y + H * 0.5);\n\t\t\t\t\t\t\tctx.lineTo(margin + 16, y + H - 5);\n\t\t\t\t\t\t\tctx.fill();\n\t\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\t\tctx.moveTo(widget_width - margin - 16, y + 5);\n\t\t\t\t\t\t\tctx.lineTo(widget_width - margin - 6, y + H * 0.5);\n\t\t\t\t\t\t\tctx.lineTo(widget_width - margin - 16, y + H - 5);\n\t\t\t\t\t\t\tctx.fill();\n\t\t\t\t\t\t}\n                        ctx.fillStyle = secondary_text_color;\n                        ctx.fillText(w.name, margin * 2 + 5, y + H * 0.7);\n                        ctx.fillStyle = text_color;\n                        ctx.textAlign = \"right\";\n                        if (w.type == \"number\") {\n                            ctx.fillText(\n                                Number(w.value).toFixed(\n                                    w.options.precision !== undefined\n                                        ? w.options.precision\n                                        : 3\n                                ),\n                                widget_width - margin * 2 - 20,\n                                y + H * 0.7\n                            );\n                        } else {\n\t\t\t\t\t\t\tvar v = w.value;\n\t\t\t\t\t\t\tif( w.options.values )\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar values = w.options.values;\n\t\t\t\t\t\t\t\tif( values.constructor === Function )\n\t\t\t\t\t\t\t\t\tvalues = values();\n\t\t\t\t\t\t\t\tif(values && values.constructor !== Array)\n\t\t\t\t\t\t\t\t\tv = values[ w.value ];\n\t\t\t\t\t\t\t}\n                            ctx.fillText(\n                                v,\n                                widget_width - margin * 2 - 20,\n                                y + H * 0.7\n                            );\n                        }\n                    }\n                    break;\n                case \"string\":\n                case \"text\":\n                    ctx.textAlign = \"left\";\n                    ctx.strokeStyle = outline_color;\n                    ctx.fillStyle = background_color;\n                    ctx.beginPath();\n                    if (show_text)\n\t                    ctx.roundRect(margin, y, widget_width - margin * 2, H, [H * 0.5]);\n\t\t\t\t\telse\n\t                    ctx.rect( margin, y, widget_width - margin * 2, H );\n                    ctx.fill();\n\t                if (show_text) {\n\t\t\t\t\t\tif(!w.disabled)\n\t\t\t\t\t\t\tctx.stroke();\n    \t\t\t\t\tctx.save();\n\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\tctx.rect(margin, y, widget_width - margin * 2, H);\n\t\t\t\t\t\tctx.clip();\n\n\t                    //ctx.stroke();\n                        ctx.fillStyle = secondary_text_color;\n                        if (w.name != null) {\n                            ctx.fillText(w.name, margin * 2, y + H * 0.7);\n                        }\n                        ctx.fillStyle = text_color;\n                        ctx.textAlign = \"right\";\n                        ctx.fillText(String(w.value).substr(0,30), widget_width - margin * 2, y + H * 0.7); //30 chars max\n\t\t\t\t\t\tctx.restore();\n                    }\n                    break;\n                default:\n                    if (w.draw) {\n                        w.draw(ctx, node, widget_width, y, H);\n                    }\n                    break;\n            }\n            posY += (w.computeSize ? w.computeSize(widget_width)[1] : H) + 4;\n\t\t\tctx.globalAlpha = this.editor_alpha;\n\n        }\n        ctx.restore();\n\t\tctx.textAlign = \"left\";\n    };\n\n    /**\n     * process an event on widgets\n     * @method processNodeWidgets\n     **/\n    LGraphCanvas.prototype.processNodeWidgets = function(\n        node,\n        pos,\n        event,\n        active_widget\n    ) {\n        if (!node.widgets || !node.widgets.length) {\n            return null;\n        }\n\n        var x = pos[0] - node.pos[0];\n        var y = pos[1] - node.pos[1];\n        var width = node.size[0];\n        var that = this;\n        var ref_window = this.getCanvasWindow();\n\n        for (var i = 0; i < node.widgets.length; ++i) {\n            var w = node.widgets[i];\n\t\t\tif(!w || w.disabled)\n\t\t\t\tcontinue;\n\t\t\tvar widget_height = w.computeSize ? w.computeSize(width)[1] : LiteGraph.NODE_WIDGET_HEIGHT;\n\t\t\tvar widget_width = w.width || width;\n\t\t\t//outside\n\t\t\tif ( w != active_widget && \n\t\t\t\t(x < 6 || x > widget_width - 12 || y < w.last_y || y > w.last_y + widget_height || w.last_y === undefined) ) \n\t\t\t\tcontinue;\n\n\t\t\tvar old_value = w.value;\n\n            //if ( w == active_widget || (x > 6 && x < widget_width - 12 && y > w.last_y && y < w.last_y + widget_height) ) {\n\t\t\t//inside widget\n\t\t\tswitch (w.type) {\n\t\t\t\tcase \"button\":\n\t\t\t\t\tif (event.type === LiteGraph.pointerevents_method+\"down\") {\n                        if (w.callback) {\n                            setTimeout(function() {\n                                w.callback(w, that, node, pos, event);\n                            }, 20);\n                        }\n                        w.clicked = true;\n                        this.dirty_canvas = true;\n                    }\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"slider\":\n\t\t\t\t\tvar range = w.options.max - w.options.min;\n\t\t\t\t\tvar nvalue = Math.clamp((x - 15) / (widget_width - 30), 0, 1);\n\t\t\t\t\tw.value = w.options.min + (w.options.max - w.options.min) * nvalue;\n\t\t\t\t\tif (w.callback) {\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tinner_value_change(w, w.value);\n\t\t\t\t\t\t}, 20);\n\t\t\t\t\t}\n\t\t\t\t\tthis.dirty_canvas = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"number\":\n\t\t\t\tcase \"combo\":\n\t\t\t\t\tvar old_value = w.value;\n\t\t\t\t\tif (event.type == LiteGraph.pointerevents_method+\"move\" && w.type == \"number\") {\n\t\t\t\t\t\tw.value += event.deltaX * 0.1 * (w.options.step || 1);\n\t\t\t\t\t\tif ( w.options.min != null && w.value < w.options.min ) {\n\t\t\t\t\t\t\tw.value = w.options.min;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( w.options.max != null && w.value > w.options.max ) {\n\t\t\t\t\t\t\tw.value = w.options.max;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (event.type == LiteGraph.pointerevents_method+\"down\") {\n\t\t\t\t\t\tvar values = w.options.values;\n\t\t\t\t\t\tif (values && values.constructor === Function) {\n\t\t\t\t\t\t\tvalues = w.options.values(w, node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar values_list = null;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif( w.type != \"number\")\n\t\t\t\t\t\t\tvalues_list = values.constructor === Array ? values : Object.keys(values);\n\n\t\t\t\t\t\tvar delta = x < 40 ? -1 : x > widget_width - 40 ? 1 : 0;\n\t\t\t\t\t\tif (w.type == \"number\") {\n\t\t\t\t\t\t\tw.value += delta * 0.1 * (w.options.step || 1);\n\t\t\t\t\t\t\tif ( w.options.min != null && w.value < w.options.min ) {\n\t\t\t\t\t\t\t\tw.value = w.options.min;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ( w.options.max != null && w.value > w.options.max ) {\n\t\t\t\t\t\t\t\tw.value = w.options.max;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (delta) { //clicked in arrow, used for combos \n\t\t\t\t\t\t\tvar index = -1;\n\t\t\t\t\t\t\tthis.last_mouseclick = 0; //avoids dobl click event\n\t\t\t\t\t\t\tif(values.constructor === Object)\n\t\t\t\t\t\t\t\tindex = values_list.indexOf( String( w.value ) ) + delta;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tindex = values_list.indexOf( w.value ) + delta;\n\t\t\t\t\t\t\tif (index >= values_list.length) {\n\t\t\t\t\t\t\t\tindex = values_list.length - 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (index < 0) {\n\t\t\t\t\t\t\t\tindex = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif( values.constructor === Array )\n\t\t\t\t\t\t\t\tw.value = values[index];\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tw.value = index;\n\t\t\t\t\t\t} else { //combo clicked \n\t\t\t\t\t\t\tvar text_values = values != values_list ? Object.values(values) : values;\n\t\t\t\t\t\t\tvar menu = new LiteGraph.ContextMenu(text_values, {\n\t\t\t\t\t\t\t\t\tscale: Math.max(1, this.ds.scale),\n\t\t\t\t\t\t\t\t\tevent: event,\n\t\t\t\t\t\t\t\t\tclassName: \"dark\",\n\t\t\t\t\t\t\t\t\tcallback: inner_clicked.bind(w)\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tref_window);\n\t\t\t\t\t\t\tfunction inner_clicked(v, option, event) {\n\t\t\t\t\t\t\t\tif(values != values_list)\n\t\t\t\t\t\t\t\t\tv = text_values.indexOf(v);\n\t\t\t\t\t\t\t\tthis.value = v;\n\t\t\t\t\t\t\t\tinner_value_change(this, v);\n\t\t\t\t\t\t\t\tthat.dirty_canvas = true;\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} //end mousedown\n\t\t\t\t\telse if(event.type == LiteGraph.pointerevents_method+\"up\" && w.type == \"number\")\n\t\t\t\t\t{\n\t\t\t\t\t\tvar delta = x < 40 ? -1 : x > widget_width - 40 ? 1 : 0;\n\t\t\t\t\t\tif (event.click_time < 200 && delta == 0) {\n\t\t\t\t\t\t\tthis.prompt(\"Value\",w.value,function(v) {\n\t\t\t\t\t\t\t\t\tthis.value = Number(v);\n\t\t\t\t\t\t\t\t\tinner_value_change(this, this.value);\n\t\t\t\t\t\t\t\t}.bind(w),\n\t\t\t\t\t\t\t\tevent);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif( old_value != w.value )\n\t\t\t\t\t\tsetTimeout(\n\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\tinner_value_change(this, this.value);\n\t\t\t\t\t\t\t}.bind(w),\n\t\t\t\t\t\t\t20\n\t\t\t\t\t\t);\n\t\t\t\t\tthis.dirty_canvas = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"toggle\":\n\t\t\t\t\tif (event.type == LiteGraph.pointerevents_method+\"down\") {\n\t\t\t\t\t\tw.value = !w.value;\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tinner_value_change(w, w.value);\n\t\t\t\t\t\t}, 20);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"string\":\n\t\t\t\tcase \"text\":\n\t\t\t\t\tif (event.type == LiteGraph.pointerevents_method+\"down\") {\n\t\t\t\t\t\tthis.prompt(\"Value\",w.value,function(v) {\n\t\t\t\t\t\t\t\tthis.value = v;\n\t\t\t\t\t\t\t\tinner_value_change(this, v);\n\t\t\t\t\t\t\t}.bind(w),\n\t\t\t\t\t\t\tevent,w.options ? w.options.multiline : false );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (w.mouse) {\n\t\t\t\t\t\tthis.dirty_canvas = w.mouse(event, [x, y], node);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t} //end switch\n\n\t\t\t//value changed\n\t\t\tif( old_value != w.value )\n\t\t\t{\n\t\t\t\tif(node.onWidgetChanged)\n\t\t\t\t\tnode.onWidgetChanged( w.name,w.value,old_value,w );\n                node.graph._version++;\n\t\t\t}\n\n\t\t\treturn w;\n        }//end for\n\n        function inner_value_change(widget, value) {\n            widget.value = value;\n            if ( widget.options && widget.options.property && node.properties[widget.options.property] !== undefined ) {\n                node.setProperty( widget.options.property, value );\n            }\n            if (widget.callback) {\n                widget.callback(widget.value, that, node, pos, event);\n            }\n        }\n\n        return null;\n    };\n\n    /**\n     * draws every group area in the background\n     * @method drawGroups\n     **/\n    LGraphCanvas.prototype.drawGroups = function(canvas, ctx) {\n        if (!this.graph) {\n            return;\n        }\n\n        var groups = this.graph._groups;\n\n        ctx.save();\n        ctx.globalAlpha = 0.5 * this.editor_alpha;\n\n        for (var i = 0; i < groups.length; ++i) {\n            var group = groups[i];\n\n            if (!overlapBounding(this.visible_area, group._bounding)) {\n                continue;\n            } //out of the visible area\n\n            ctx.fillStyle = group.color || \"#335\";\n            ctx.strokeStyle = group.color || \"#335\";\n            var pos = group._pos;\n            var size = group._size;\n            ctx.globalAlpha = 0.25 * this.editor_alpha;\n            ctx.beginPath();\n            ctx.rect(pos[0] + 0.5, pos[1] + 0.5, size[0], size[1]);\n            ctx.fill();\n            ctx.globalAlpha = this.editor_alpha;\n            ctx.stroke();\n\n            ctx.beginPath();\n            ctx.moveTo(pos[0] + size[0], pos[1] + size[1]);\n            ctx.lineTo(pos[0] + size[0] - 10, pos[1] + size[1]);\n            ctx.lineTo(pos[0] + size[0], pos[1] + size[1] - 10);\n            ctx.fill();\n\n            var font_size =\n                group.font_size || LiteGraph.DEFAULT_GROUP_FONT_SIZE;\n            ctx.font = font_size + \"px Arial\";\n\t\t\tctx.textAlign = \"left\";\n            ctx.fillText(group.title, pos[0] + 4, pos[1] + font_size);\n        }\n\n        ctx.restore();\n    };\n\n    LGraphCanvas.prototype.adjustNodesSize = function() {\n        var nodes = this.graph._nodes;\n        for (var i = 0; i < nodes.length; ++i) {\n            nodes[i].size = nodes[i].computeSize();\n        }\n        this.setDirty(true, true);\n    };\n\n    /**\n     * resizes the canvas to a given size, if no size is passed, then it tries to fill the parentNode\n     * @method resize\n     **/\n    LGraphCanvas.prototype.resize = function(width, height) {\n        if (!width && !height) {\n            var parent = this.canvas.parentNode;\n            width = parent.offsetWidth;\n            height = parent.offsetHeight;\n        }\n\n        if (this.canvas.width == width && this.canvas.height == height) {\n            return;\n        }\n\n        this.canvas.width = width;\n        this.canvas.height = height;\n        this.bgcanvas.width = this.canvas.width;\n        this.bgcanvas.height = this.canvas.height;\n        this.setDirty(true, true);\n    };\n\n    /**\n     * switches to live mode (node shapes are not rendered, only the content)\n     * this feature was designed when graphs where meant to create user interfaces\n     * @method switchLiveMode\n     **/\n    LGraphCanvas.prototype.switchLiveMode = function(transition) {\n        if (!transition) {\n            this.live_mode = !this.live_mode;\n            this.dirty_canvas = true;\n            this.dirty_bgcanvas = true;\n            return;\n        }\n\n        var self = this;\n        var delta = this.live_mode ? 1.1 : 0.9;\n        if (this.live_mode) {\n            this.live_mode = false;\n            this.editor_alpha = 0.1;\n        }\n\n        var t = setInterval(function() {\n            self.editor_alpha *= delta;\n            self.dirty_canvas = true;\n            self.dirty_bgcanvas = true;\n\n            if (delta < 1 && self.editor_alpha < 0.01) {\n                clearInterval(t);\n                if (delta < 1) {\n                    self.live_mode = true;\n                }\n            }\n            if (delta > 1 && self.editor_alpha > 0.99) {\n                clearInterval(t);\n                self.editor_alpha = 1;\n            }\n        }, 1);\n    };\n\n    LGraphCanvas.prototype.onNodeSelectionChange = function(node) {\n        return; //disabled\n    };\n\n    /* this is an implementation for touch not in production and not ready\n     */\n    /*LGraphCanvas.prototype.touchHandler = function(event) {\n        //alert(\"foo\");\n        var touches = event.changedTouches,\n            first = touches[0],\n            type = \"\";\n\n        switch (event.type) {\n            case \"touchstart\":\n                type = \"mousedown\";\n                break;\n            case \"touchmove\":\n                type = \"mousemove\";\n                break;\n            case \"touchend\":\n                type = \"mouseup\";\n                break;\n            default:\n                return;\n        }\n\n        //initMouseEvent(type, canBubble, cancelable, view, clickCount,\n        //           screenX, screenY, clientX, clientY, ctrlKey,\n        //           altKey, shiftKey, metaKey, button, relatedTarget);\n\n        // this is eventually a Dom object, get the LGraphCanvas back\n        if(typeof this.getCanvasWindow == \"undefined\"){\n            var window = this.lgraphcanvas.getCanvasWindow();\n        }else{\n            var window = this.getCanvasWindow();\n        }\n        \n        var document = window.document;\n\n        var simulatedEvent = document.createEvent(\"MouseEvent\");\n        simulatedEvent.initMouseEvent(\n            type,\n            true,\n            true,\n            window,\n            1,\n            first.screenX,\n            first.screenY,\n            first.clientX,\n            first.clientY,\n            false,\n            false,\n            false,\n            false,\n            0, //left\n            null\n        );\n        first.target.dispatchEvent(simulatedEvent);\n        event.preventDefault();\n    };*/\n\n    /* CONTEXT MENU ********************/\n\n    LGraphCanvas.onGroupAdd = function(info, entry, mouse_event) {\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n\n        var group = new LiteGraph.LGraphGroup();\n        group.pos = canvas.convertEventToCanvasOffset(mouse_event);\n        canvas.graph.add(group);\n    };\n\n    LGraphCanvas.onMenuAdd = function (node, options, e, prev_menu, callback) {\n\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n        var graph = canvas.graph;\n        if (!graph)\n            return;\n\n        function inner_onMenuAdded(base_category ,prev_menu){\n    \n            var categories  = LiteGraph.getNodeTypesCategories(canvas.filter || graph.filter).filter(function(category){return category.startsWith(base_category)});\n            var entries = [];\n    \n            categories.map(function(category){\n    \n                if (!category) \n                    return;\n    \n                var base_category_regex = new RegExp('^(' + base_category + ')');\n                var category_name = category.replace(base_category_regex,\"\").split('/')[0];\n                var category_path = base_category  === '' ? category_name + '/' : base_category + category_name + '/';\n    \n                var name = category_name;\n                if(name.indexOf(\"::\") != -1) //in case it has a namespace like \"shader::math/rand\" it hides the namespace\n                    name = name.split(\"::\")[1];\n                        \n                var index = entries.findIndex(function(entry){return entry.value === category_path});\n                if (index === -1) {\n                    entries.push({ value: category_path, content: name, has_submenu: true, callback : function(value, event, mouseEvent, contextMenu){\n                        inner_onMenuAdded(value.value, contextMenu)\n                    }});\n                }\n                \n            });\n    \n            var nodes = LiteGraph.getNodeTypesInCategory(base_category.slice(0, -1), canvas.filter || graph.filter );\n            nodes.map(function(node){\n    \n                if (node.skip_list)\n                    return;\n    \n                var entry = { value: node.type, content: node.title, has_submenu: false , callback : function(value, event, mouseEvent, contextMenu){\n                    \n                        var first_event = contextMenu.getFirstEvent();\n                        canvas.graph.beforeChange();\n                        var node = LiteGraph.createNode(value.value);\n                        if (node) {\n                            node.pos = canvas.convertEventToCanvasOffset(first_event);\n                            canvas.graph.add(node);\n                        }\n                        if(callback)\n                            callback(node);\n                        canvas.graph.afterChange();\n                    \n                    }\n                }\n    \n                entries.push(entry);\n    \n            });\n    \n            new LiteGraph.ContextMenu( entries, { event: e, parentMenu: prev_menu }, ref_window );\n    \n        }\n    \n        inner_onMenuAdded('',prev_menu);\n        return false;\n    \n    };\n\n    LGraphCanvas.onMenuCollapseAll = function() {};\n\n    LGraphCanvas.onMenuNodeEdit = function() {};\n\n    LGraphCanvas.showMenuNodeOptionalInputs = function(\n        v,\n        options,\n        e,\n        prev_menu,\n        node\n    ) {\n        if (!node) {\n            return;\n        }\n\n        var that = this;\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n\n        var options = node.optional_inputs;\n        if (node.onGetInputs) {\n            options = node.onGetInputs();\n        }\n\n        var entries = [];\n        if (options) {\n            for (var i=0; i < options.length; i++) {\n                var entry = options[i];\n                if (!entry) {\n                    entries.push(null);\n                    continue;\n                }\n                var label = entry[0];\n\t\t\t\tif(!entry[2])\n\t\t\t\t\tentry[2] = {};\n\n                if (entry[2].label) {\n                    label = entry[2].label;\n                }\n\n\t\t\t\tentry[2].removable = true;\n                var data = { content: label, value: entry };\n                if (entry[1] == LiteGraph.ACTION) {\n                    data.className = \"event\";\n                }\n                entries.push(data);\n            }\n        }\n\n        if (node.onMenuNodeInputs) {\n            var retEntries = node.onMenuNodeInputs(entries);\n            if(retEntries) entries = retEntries;\n        }\n\n        if (!entries.length) {\n\t\t\tconsole.log(\"no input entries\");\n            return;\n        }\n\n        var menu = new LiteGraph.ContextMenu(\n            entries,\n            {\n                event: e,\n                callback: inner_clicked,\n                parentMenu: prev_menu,\n                node: node\n            },\n            ref_window\n        );\n\n        function inner_clicked(v, e, prev) {\n            if (!node) {\n                return;\n            }\n\n            if (v.callback) {\n                v.callback.call(that, node, v, e, prev);\n            }\n\n            if (v.value) {\n\t\t\t\tnode.graph.beforeChange();\n                node.addInput(v.value[0], v.value[1], v.value[2]);\n\n                if (node.onNodeInputAdd) { // callback to the node when adding a slot\n                    node.onNodeInputAdd(v.value);\n                }\n                node.setDirtyCanvas(true, true);\n\t\t\t\tnode.graph.afterChange();\n            }\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.showMenuNodeOptionalOutputs = function(\n        v,\n        options,\n        e,\n        prev_menu,\n        node\n    ) {\n        if (!node) {\n            return;\n        }\n\n        var that = this;\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n\n        var options = node.optional_outputs;\n        if (node.onGetOutputs) {\n            options = node.onGetOutputs();\n        }\n\n        var entries = [];\n        if (options) {\n            for (var i=0; i < options.length; i++) {\n                var entry = options[i];\n                if (!entry) {\n                    //separator?\n                    entries.push(null);\n                    continue;\n                }\n\n                if (\n                    node.flags &&\n                    node.flags.skip_repeated_outputs &&\n                    node.findOutputSlot(entry[0]) != -1\n                ) {\n                    continue;\n                } //skip the ones already on\n                var label = entry[0];\n\t\t\t\tif(!entry[2])\n\t\t\t\t\tentry[2] = {};\n                if (entry[2].label) {\n                    label = entry[2].label;\n                }\n\t\t\t\tentry[2].removable = true;\n                var data = { content: label, value: entry };\n                if (entry[1] == LiteGraph.EVENT) {\n                    data.className = \"event\";\n                }\n                entries.push(data);\n            }\n        }\n\n        if (this.onMenuNodeOutputs) {\n            entries = this.onMenuNodeOutputs(entries);\n        }\n        if (LiteGraph.do_add_triggers_slots){ //canvas.allow_addOutSlot_onExecuted\n            if (node.findOutputSlot(\"onExecuted\") == -1){\n                entries.push({content: \"On Executed\", value: [\"onExecuted\", LiteGraph.EVENT, {nameLocked: true}], className: \"event\"}); //, opts: {}\n            }\n        }\n        // add callback for modifing the menu elements onMenuNodeOutputs\n        if (node.onMenuNodeOutputs) {\n            var retEntries = node.onMenuNodeOutputs(entries);\n            if(retEntries) entries = retEntries;\n        }\n\n        if (!entries.length) {\n            return;\n        }\n\n        var menu = new LiteGraph.ContextMenu(\n            entries,\n            {\n                event: e,\n                callback: inner_clicked,\n                parentMenu: prev_menu,\n                node: node\n            },\n            ref_window\n        );\n\n        function inner_clicked(v, e, prev) {\n            if (!node) {\n                return;\n            }\n\n            if (v.callback) {\n                v.callback.call(that, node, v, e, prev);\n            }\n\n            if (!v.value) {\n                return;\n            }\n\n            var value = v.value[1];\n\n            if (\n                value &&\n                (value.constructor === Object || value.constructor === Array)\n            ) {\n                //submenu why?\n                var entries = [];\n                for (var i in value) {\n                    entries.push({ content: i, value: value[i] });\n                }\n                new LiteGraph.ContextMenu(entries, {\n                    event: e,\n                    callback: inner_clicked,\n                    parentMenu: prev_menu,\n                    node: node\n                });\n                return false;\n            } else {\n\t\t\t\tnode.graph.beforeChange();\n                node.addOutput(v.value[0], v.value[1], v.value[2]);\n\n                if (node.onNodeOutputAdd) { // a callback to the node when adding a slot\n                    node.onNodeOutputAdd(v.value);\n                }\n                node.setDirtyCanvas(true, true);\n\t\t\t\tnode.graph.afterChange();\n            }\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.onShowMenuNodeProperties = function(\n        value,\n        options,\n        e,\n        prev_menu,\n        node\n    ) {\n        if (!node || !node.properties) {\n            return;\n        }\n\n        var that = this;\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n\n        var entries = [];\n        for (var i in node.properties) {\n            var value = node.properties[i] !== undefined ? node.properties[i] : \" \";\n\t\t\tif( typeof value == \"object\" )\n\t\t\t\tvalue = JSON.stringify(value);\n\t\t\tvar info = node.getPropertyInfo(i);\n\t\t\tif(info.type == \"enum\" || info.type == \"combo\")\n\t\t\t\tvalue = LGraphCanvas.getPropertyPrintableValue( value, info.values );\n\n            //value could contain invalid html characters, clean that\n            value = LGraphCanvas.decodeHTML(value);\n            entries.push({\n                content:\n                    \"<span class='property_name'>\" +\n                    (info.label ? info.label : i) +\n                    \"</span>\" +\n                    \"<span class='property_value'>\" +\n                    value +\n                    \"</span>\",\n                value: i\n            });\n        }\n        if (!entries.length) {\n            return;\n        }\n\n        var menu = new LiteGraph.ContextMenu(\n            entries,\n            {\n                event: e,\n                callback: inner_clicked,\n                parentMenu: prev_menu,\n                allow_html: true,\n                node: node\n            },\n            ref_window\n        );\n\n        function inner_clicked(v, options, e, prev) {\n            if (!node) {\n                return;\n            }\n            var rect = this.getBoundingClientRect();\n            canvas.showEditPropertyValue(node, v.value, {\n                position: [rect.left, rect.top]\n            });\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.decodeHTML = function(str) {\n        var e = document.createElement(\"div\");\n        e.innerText = str;\n        return e.innerHTML;\n    };\n\n    LGraphCanvas.onMenuResizeNode = function(value, options, e, menu, node) {\n        if (!node) {\n            return;\n        }\n        \n\t\tvar fApplyMultiNode = function(node){\n\t\t\tnode.size = node.computeSize();\n\t\t\tif (node.onResize)\n\t\t\t\tnode.onResize(node.size);\n\t\t}\n\t\t\n\t\tvar graphcanvas = LGraphCanvas.active_canvas;\n\t\tif (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n\t\t\tfApplyMultiNode(node);\n\t\t}else{\n\t\t\tfor (var i in graphcanvas.selected_nodes) {\n\t\t\t\tfApplyMultiNode(graphcanvas.selected_nodes[i]);\n\t\t\t}\n\t\t}\n\t\t\n        node.setDirtyCanvas(true, true);\n    };\n\n    LGraphCanvas.prototype.showLinkMenu = function(link, e) {\n        var that = this;\n\t\t// console.log(link);\n\t\tvar node_left = that.graph.getNodeById( link.origin_id );\n\t\tvar node_right = that.graph.getNodeById( link.target_id );\n\t\tvar fromType = false;\n\t\tif (node_left && node_left.outputs && node_left.outputs[link.origin_slot]) fromType = node_left.outputs[link.origin_slot].type;\n        var destType = false;\n\t\tif (node_right && node_right.outputs && node_right.outputs[link.target_slot]) destType = node_right.inputs[link.target_slot].type;\n\t\t\n\t\tvar options = [\"Add Node\",null,\"Delete\",null];\n\t\t\n\t\t\n        var menu = new LiteGraph.ContextMenu(options, {\n            event: e,\n\t\t\ttitle: link.data != null ? link.data.constructor.name : null,\n            callback: inner_clicked\n        });\n\n        function inner_clicked(v,options,e) {\n            switch (v) {\n                case \"Add Node\":\n\t\t\t\t\tLGraphCanvas.onMenuAdd(null, null, e, menu, function(node){\n\t\t\t\t\t\t// console.debug(\"node autoconnect\");\n\t\t\t\t\t\tif(!node.inputs || !node.inputs.length || !node.outputs || !node.outputs.length){\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// leave the connection type checking inside connectByType\n\t\t\t\t\t\tif (node_left.connectByType( link.origin_slot, node, fromType )){\n                        \tnode.connectByType( link.target_slot, node_right, destType );\n                            node.pos[0] -= node.size[0] * 0.5;\n                        }\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\t\t\n                case \"Delete\":\n                    that.graph.removeLink(link.id);\n                    break;\n                default:\n\t\t\t\t\t/*var nodeCreated = createDefaultNodeForSlot({   nodeFrom: node_left\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,slotFrom: link.origin_slot\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,nodeTo: node\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,slotTo: link.target_slot\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,e: e\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,nodeType: \"AUTO\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\tif(nodeCreated) console.log(\"new node in beetween \"+v+\" created\");*/\n            }\n        }\n\n        return false;\n    };\n    \n \tLGraphCanvas.prototype.createDefaultNodeForSlot = function(optPass) { // addNodeMenu for connection\n        var optPass = optPass || {};\n        var opts = Object.assign({   nodeFrom: null // input\n                                    ,slotFrom: null // input\n                                    ,nodeTo: null   // output\n                                    ,slotTo: null   // output\n                                    ,position: []\t// pass the event coords\n\t\t\t\t\t\t\t\t  \t,nodeType: null\t// choose a nodetype to add, AUTO to set at first good\n\t\t\t\t\t\t\t\t  \t,posAdd:[0,0]\t// adjust x,y\n\t\t\t\t\t\t\t\t  \t,posSizeFix:[0,0] // alpha, adjust the position x,y based on the new node size w,h\n                                }\n                                ,optPass\n                            );\n        var that = this;\n        \n        var isFrom = opts.nodeFrom && opts.slotFrom!==null;\n        var isTo = !isFrom && opts.nodeTo && opts.slotTo!==null;\n\t\n        if (!isFrom && !isTo){\n            console.warn(\"No data passed to createDefaultNodeForSlot \"+opts.nodeFrom+\" \"+opts.slotFrom+\" \"+opts.nodeTo+\" \"+opts.slotTo);\n            return false;\n        }\n\t\tif (!opts.nodeType){\n            console.warn(\"No type to createDefaultNodeForSlot\");\n            return false;\n        }\n        \n        var nodeX = isFrom ? opts.nodeFrom : opts.nodeTo;\n        var slotX = isFrom ? opts.slotFrom : opts.slotTo;\n        \n        var iSlotConn = false;\n        switch (typeof slotX){\n            case \"string\":\n                iSlotConn = isFrom ? nodeX.findOutputSlot(slotX,false) : nodeX.findInputSlot(slotX,false);\n                slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n            break;\n            case \"object\":\n                // ok slotX\n                iSlotConn = isFrom ? nodeX.findOutputSlot(slotX.name) : nodeX.findInputSlot(slotX.name);\n            break;\n            case \"number\":\n                iSlotConn = slotX;\n                slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n            break;\n\t\t\tcase \"undefined\":\n            default:\n                // bad ?\n                //iSlotConn = 0;\n                console.warn(\"Cant get slot information \"+slotX);\n                return false;\n        }\n\t\n\t\tif (slotX===false || iSlotConn===false){\n\t\t\tconsole.warn(\"createDefaultNodeForSlot bad slotX \"+slotX+\" \"+iSlotConn);\n\t\t}\n\t\t\n\t\t// check for defaults nodes for this slottype\n\t\tvar fromSlotType = slotX.type==LiteGraph.EVENT?\"_event_\":slotX.type;\n\t\tvar slotTypesDefault = isFrom ? LiteGraph.slot_types_default_out : LiteGraph.slot_types_default_in;\n\t\tif(slotTypesDefault && slotTypesDefault[fromSlotType]){\n\t\t\tif (slotX.link !== null) {\n\t\t\t\t// is connected\n\t\t\t}else{\n\t\t\t\t// is not not connected\n\t\t\t}\n\t\t\tnodeNewType = false;\n\t\t\tif(typeof slotTypesDefault[fromSlotType] == \"object\" || typeof slotTypesDefault[fromSlotType] == \"array\"){\n\t\t\t\tfor(var typeX in slotTypesDefault[fromSlotType]){\n\t\t\t\t\tif (opts.nodeType == slotTypesDefault[fromSlotType][typeX] || opts.nodeType == \"AUTO\"){\n\t\t\t\t\t\tnodeNewType = slotTypesDefault[fromSlotType][typeX];\n\t\t\t\t\t\t// console.log(\"opts.nodeType == slotTypesDefault[fromSlotType][typeX] :: \"+opts.nodeType);\n\t\t\t\t\t\tbreak; // --------\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif (opts.nodeType == slotTypesDefault[fromSlotType] || opts.nodeType == \"AUTO\") nodeNewType = slotTypesDefault[fromSlotType];\n\t\t\t}\n\t\t\tif (nodeNewType) {\n\t\t\t\tvar nodeNewOpts = false;\n\t\t\t\tif (typeof nodeNewType == \"object\" && nodeNewType.node){\n\t\t\t\t\tnodeNewOpts = nodeNewType;\n\t\t\t\t\tnodeNewType = nodeNewType.node;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//that.graph.beforeChange();\n\t\t\t\t\n\t\t\t\tvar newNode = LiteGraph.createNode(nodeNewType);\n\t\t\t\tif(newNode){\n\t\t\t\t\t// if is object pass options\n\t\t\t\t\tif (nodeNewOpts){\n\t\t\t\t\t\tif (nodeNewOpts.properties) {\n\t\t\t\t\t\t\tfor (var i in nodeNewOpts.properties) {\n\t\t\t\t\t\t\t\tnewNode.addProperty( i, nodeNewOpts.properties[i] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (nodeNewOpts.inputs) {\n\t\t\t\t\t\t\tnewNode.inputs = [];\n\t\t\t\t\t\t\tfor (var i in nodeNewOpts.inputs) {\n\t\t\t\t\t\t\t\tnewNode.addOutput(\n\t\t\t\t\t\t\t\t\tnodeNewOpts.inputs[i][0],\n\t\t\t\t\t\t\t\t\tnodeNewOpts.inputs[i][1]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (nodeNewOpts.outputs) {\n\t\t\t\t\t\t\tnewNode.outputs = [];\n\t\t\t\t\t\t\tfor (var i in nodeNewOpts.outputs) {\n\t\t\t\t\t\t\t\tnewNode.addOutput(\n\t\t\t\t\t\t\t\t\tnodeNewOpts.outputs[i][0],\n\t\t\t\t\t\t\t\t\tnodeNewOpts.outputs[i][1]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (nodeNewOpts.title) {\n\t\t\t\t\t\t\tnewNode.title = nodeNewOpts.title;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (nodeNewOpts.json) {\n\t\t\t\t\t\t\tnewNode.configure(nodeNewOpts.json);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// add the node\n\t\t\t\t\tthat.graph.add(newNode);\n\t\t\t\t\tnewNode.pos = [\topts.position[0]+opts.posAdd[0]+(opts.posSizeFix[0]?opts.posSizeFix[0]*newNode.size[0]:0)\n\t\t\t\t\t\t\t\t   \t,opts.position[1]+opts.posAdd[1]+(opts.posSizeFix[1]?opts.posSizeFix[1]*newNode.size[1]:0)]; //that.last_click_position; //[e.canvasX+30, e.canvasX+5];*/\n\t\t\t\t\t\n\t\t\t\t\t//that.graph.afterChange();\n\t\t\t\t\t\n\t\t\t\t\t// connect the two!\n\t\t\t\t\tif (isFrom){\n\t\t\t\t\t\topts.nodeFrom.connectByType( iSlotConn, newNode, fromSlotType );\n\t\t\t\t\t}else{\n\t\t\t\t\t\topts.nodeTo.connectByTypeOutput( iSlotConn, newNode, fromSlotType );\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// if connecting in between\n\t\t\t\t\tif (isFrom && isTo){\n\t\t\t\t\t\t// TODO\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn true;\n\t\t\t\t\t\n\t\t\t\t}else{\n\t\t\t\t\tconsole.log(\"failed creating \"+nodeNewType);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n \n    LGraphCanvas.prototype.showConnectionMenu = function(optPass) { // addNodeMenu for connection\n        var optPass = optPass || {};\n        var opts = Object.assign({   nodeFrom: null  // input\n                                    ,slotFrom: null // input\n                                    ,nodeTo: null   // output\n                                    ,slotTo: null   // output\n                                    ,e: null\n                                }\n                                ,optPass\n                            );\n        var that = this;\n        \n        var isFrom = opts.nodeFrom && opts.slotFrom;\n        var isTo = !isFrom && opts.nodeTo && opts.slotTo;\n        \n        if (!isFrom && !isTo){\n            console.warn(\"No data passed to showConnectionMenu\");\n            return false;\n        }\n        \n        var nodeX = isFrom ? opts.nodeFrom : opts.nodeTo;\n        var slotX = isFrom ? opts.slotFrom : opts.slotTo;\n        \n        var iSlotConn = false;\n        switch (typeof slotX){\n            case \"string\":\n                iSlotConn = isFrom ? nodeX.findOutputSlot(slotX,false) : nodeX.findInputSlot(slotX,false);\n                slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n            break;\n            case \"object\":\n                // ok slotX\n                iSlotConn = isFrom ? nodeX.findOutputSlot(slotX.name) : nodeX.findInputSlot(slotX.name);\n            break;\n            case \"number\":\n                iSlotConn = slotX;\n                slotX = isFrom ? nodeX.outputs[slotX] : nodeX.inputs[slotX];\n            break;\n            default:\n                // bad ?\n                //iSlotConn = 0;\n                console.warn(\"Cant get slot information \"+slotX);\n                return false;\n        }\n            \n\t\tvar options = [\"Add Node\",null];\n\t\t\n\t\tif (that.allow_searchbox){\n\t\t\toptions.push(\"Search\");\n\t\t\toptions.push(null);\n\t\t}\n\t\t\n\t\t// get defaults nodes for this slottype\n\t\tvar fromSlotType = slotX.type==LiteGraph.EVENT?\"_event_\":slotX.type;\n\t\tvar slotTypesDefault = isFrom ? LiteGraph.slot_types_default_out : LiteGraph.slot_types_default_in;\n\t\tif(slotTypesDefault && slotTypesDefault[fromSlotType]){\n\t\t\tif(typeof slotTypesDefault[fromSlotType] == \"object\" || typeof slotTypesDefault[fromSlotType] == \"array\"){\n\t\t\t\tfor(var typeX in slotTypesDefault[fromSlotType]){\n\t\t\t\t\toptions.push(slotTypesDefault[fromSlotType][typeX]);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\toptions.push(slotTypesDefault[fromSlotType]);\n\t\t\t}\n\t\t}\n\t\t\n\t\t// build menu\n        var menu = new LiteGraph.ContextMenu(options, {\n            event: opts.e,\n\t\t\ttitle: (slotX && slotX.name!=\"\" ? (slotX.name + (fromSlotType?\" | \":\"\")) : \"\")+(slotX && fromSlotType ? fromSlotType : \"\"),\n            callback: inner_clicked\n        });\n        \n\t\t// callback\n        function inner_clicked(v,options,e) {\n            //console.log(\"Process showConnectionMenu selection\");\n            switch (v) {\n                case \"Add Node\":\n                    LGraphCanvas.onMenuAdd(null, null, e, menu, function(node){\n                        if (isFrom){\n                            opts.nodeFrom.connectByType( iSlotConn, node, fromSlotType );\n                        }else{\n                            opts.nodeTo.connectByTypeOutput( iSlotConn, node, fromSlotType );\n                        }\n                    });\n                    break;\n\t\t\t\tcase \"Search\":\n\t\t\t\t\tif(isFrom){\n\t\t\t\t\t\tthat.showSearchBox(e,{node_from: opts.nodeFrom, slot_from: slotX, type_filter_in: fromSlotType});\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthat.showSearchBox(e,{node_to: opts.nodeTo, slot_from: slotX, type_filter_out: fromSlotType});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n                default:\n\t\t\t\t\t// check for defaults nodes for this slottype\n\t\t\t\t\tvar nodeCreated = that.createDefaultNodeForSlot(Object.assign(opts,{ position: [opts.e.canvasX, opts.e.canvasY]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,nodeType: v\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}));\n\t\t\t\t\tif (nodeCreated){\n\t\t\t\t\t\t// new node created\n\t\t\t\t\t\t//console.log(\"node \"+v+\" created\")\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// failed or v is not in defaults\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n            }\n        }   \n        \n        return false;\n    };\n\n    // TODO refactor :: this is used fot title but not for properties!\n    LGraphCanvas.onShowPropertyEditor = function(item, options, e, menu, node) {\n        var input_html = \"\";\n        var property = item.property || \"title\";\n        var value = node[property];\n\n        // TODO refactor :: use createDialog ?\n        \n        var dialog = document.createElement(\"div\");\n        dialog.is_modified = false;\n        dialog.className = \"graphdialog\";\n        dialog.innerHTML =\n            \"<span class='name'></span><input autofocus type='text' class='value'/><button>OK</button>\";\n        dialog.close = function() {\n            if (dialog.parentNode) {\n                dialog.parentNode.removeChild(dialog);\n            }\n        };\n        var title = dialog.querySelector(\".name\");\n        title.innerText = property;\n        var input = dialog.querySelector(\".value\");\n        if (input) {\n            input.value = value;\n            input.addEventListener(\"blur\", function(e) {\n                this.focus();\n            });\n            input.addEventListener(\"keydown\", function(e) {\n                dialog.is_modified = true;\n                if (e.keyCode == 27) {\n                    //ESC\n                    dialog.close();\n                } else if (e.keyCode == 13) {\n                    inner(); // save\n                } else if (e.keyCode != 13 && e.target.localName != \"textarea\") {\n                    return;\n                }\n                e.preventDefault();\n                e.stopPropagation();\n            });\n        }\n\n        var graphcanvas = LGraphCanvas.active_canvas;\n        var canvas = graphcanvas.canvas;\n\n        var rect = canvas.getBoundingClientRect();\n        var offsetx = -20;\n        var offsety = -20;\n        if (rect) {\n            offsetx -= rect.left;\n            offsety -= rect.top;\n        }\n\n        if (event) {\n            dialog.style.left = event.clientX + offsetx + \"px\";\n            dialog.style.top = event.clientY + offsety + \"px\";\n        } else {\n            dialog.style.left = canvas.width * 0.5 + offsetx + \"px\";\n            dialog.style.top = canvas.height * 0.5 + offsety + \"px\";\n        }\n\n        var button = dialog.querySelector(\"button\");\n        button.addEventListener(\"click\", inner);\n        canvas.parentNode.appendChild(dialog);\n\n        if(input) input.focus();\n        \n        var dialogCloseTimer = null;\n        dialog.addEventListener(\"mouseleave\", function(e) {\n            if(LiteGraph.dialog_close_on_mouse_leave)\n                if (!dialog.is_modified && LiteGraph.dialog_close_on_mouse_leave)\n                    dialogCloseTimer = setTimeout(dialog.close, LiteGraph.dialog_close_on_mouse_leave_delay); //dialog.close();\n        });\n        dialog.addEventListener(\"mouseenter\", function(e) {\n            if(LiteGraph.dialog_close_on_mouse_leave)\n                if(dialogCloseTimer) clearTimeout(dialogCloseTimer);\n        });\n        \n        function inner() {\n            if(input) setValue(input.value);\n        }\n\n        function setValue(value) {\n            if (item.type == \"Number\") {\n                value = Number(value);\n            } else if (item.type == \"Boolean\") {\n                value = Boolean(value);\n            }\n            node[property] = value;\n            if (dialog.parentNode) {\n                dialog.parentNode.removeChild(dialog);\n            }\n            node.setDirtyCanvas(true, true);\n        }\n    };\n\n    // refactor: there are different dialogs, some uses createDialog some dont\n    LGraphCanvas.prototype.prompt = function(title, value, callback, event, multiline) {\n        var that = this;\n        var input_html = \"\";\n        title = title || \"\";\n\n        var dialog = document.createElement(\"div\");\n        dialog.is_modified = false;\n        dialog.className = \"graphdialog rounded\";\n        if(multiline)\n\t        dialog.innerHTML = \"<span class='name'></span> <textarea autofocus class='value'></textarea><button class='rounded'>OK</button>\";\n\t\telse\n        \tdialog.innerHTML = \"<span class='name'></span> <input autofocus type='text' class='value'/><button class='rounded'>OK</button>\";\n        dialog.close = function() {\n            that.prompt_box = null;\n            if (dialog.parentNode) {\n                dialog.parentNode.removeChild(dialog);\n            }\n        };\n\n        var graphcanvas = LGraphCanvas.active_canvas;\n        var canvas = graphcanvas.canvas;\n        canvas.parentNode.appendChild(dialog);\n        \n        if (this.ds.scale > 1) {\n            dialog.style.transform = \"scale(\" + this.ds.scale + \")\";\n        }\n\n        var dialogCloseTimer = null;\n        var prevent_timeout = false;\n        LiteGraph.pointerListenerAdd(dialog,\"leave\", function(e) {\n            if (prevent_timeout)\n                return;\n            if(LiteGraph.dialog_close_on_mouse_leave)\n                if (!dialog.is_modified && LiteGraph.dialog_close_on_mouse_leave)\n                    dialogCloseTimer = setTimeout(dialog.close, LiteGraph.dialog_close_on_mouse_leave_delay); //dialog.close();\n        });\n        LiteGraph.pointerListenerAdd(dialog,\"enter\", function(e) {\n            if(LiteGraph.dialog_close_on_mouse_leave)\n                if(dialogCloseTimer) clearTimeout(dialogCloseTimer);\n        });\n        var selInDia = dialog.querySelectorAll(\"select\");\n        if (selInDia){\n            // if filtering, check focus changed to comboboxes and prevent closing\n            selInDia.forEach(function(selIn) {\n                selIn.addEventListener(\"click\", function(e) {\n                    prevent_timeout++;\n                });\n                selIn.addEventListener(\"blur\", function(e) {\n                   prevent_timeout = 0;\n                });\n                selIn.addEventListener(\"change\", function(e) {\n                    prevent_timeout = -1;\n                });\n            });\n        }\n\n        if (that.prompt_box) {\n            that.prompt_box.close();\n        }\n        that.prompt_box = dialog;\n\n        var first = null;\n        var timeout = null;\n        var selected = null;\n\n        var name_element = dialog.querySelector(\".name\");\n        name_element.innerText = title;\n        var value_element = dialog.querySelector(\".value\");\n        value_element.value = value;\n\n        var input = value_element;\n        input.addEventListener(\"keydown\", function(e) {\n            dialog.is_modified = true;\n            if (e.keyCode == 27) {\n                //ESC\n                dialog.close();\n            } else if (e.keyCode == 13 && e.target.localName != \"textarea\") {\n                if (callback) {\n                    callback(this.value);\n                }\n                dialog.close();\n            } else {\n                return;\n            }\n            e.preventDefault();\n            e.stopPropagation();\n        });\n\n        var button = dialog.querySelector(\"button\");\n        button.addEventListener(\"click\", function(e) {\n            if (callback) {\n                callback(input.value);\n            }\n            that.setDirty(true);\n            dialog.close();\n        });\n\n        var rect = canvas.getBoundingClientRect();\n        var offsetx = -20;\n        var offsety = -20;\n        if (rect) {\n            offsetx -= rect.left;\n            offsety -= rect.top;\n        }\n\n        if (event) {\n            dialog.style.left = event.clientX + offsetx + \"px\";\n            dialog.style.top = event.clientY + offsety + \"px\";\n        } else {\n            dialog.style.left = canvas.width * 0.5 + offsetx + \"px\";\n            dialog.style.top = canvas.height * 0.5 + offsety + \"px\";\n        }\n\n        setTimeout(function() {\n            input.focus();\n        }, 10);\n\n        return dialog;\n    };\n\n    LGraphCanvas.search_limit = -1;\n    LGraphCanvas.prototype.showSearchBox = function(event, options) {\n        // proposed defaults\n        def_options = { slot_from: null\n                        ,node_from: null\n                        ,node_to: null\n                        ,do_type_filter: LiteGraph.search_filter_enabled // TODO check for registered_slot_[in/out]_types not empty // this will be checked for functionality enabled : filter on slot type, in and out\n                        ,type_filter_in: false                          // these are default: pass to set initially set values\n                        ,type_filter_out: false\n                        ,show_general_if_none_on_typefilter: true\n                        ,show_general_after_typefiltered: true\n                        ,hide_on_mouse_leave: LiteGraph.search_hide_on_mouse_leave\n                        ,show_all_if_empty: true\n                        ,show_all_on_open: LiteGraph.search_show_all_on_open\n                    };\n        options = Object.assign(def_options, options || {});\n        \n\t\t//console.log(options);\n\t\t\n        var that = this;\n        var input_html = \"\";\n        var graphcanvas = LGraphCanvas.active_canvas;\n        var canvas = graphcanvas.canvas;\n        var root_document = canvas.ownerDocument || document;\n\n        var dialog = document.createElement(\"div\");\n        dialog.className = \"litegraph litesearchbox graphdialog rounded\";\n        dialog.innerHTML = \"<span class='name'>Search</span> <input autofocus type='text' class='value rounded'/>\";\n        if (options.do_type_filter){\n            dialog.innerHTML += \"<select class='slot_in_type_filter'><option value=''></option></select>\";\n            dialog.innerHTML += \"<select class='slot_out_type_filter'><option value=''></option></select>\";\n        }\n        dialog.innerHTML += \"<div class='helper'></div>\";\n        \n        if( root_document.fullscreenElement )\n\t        root_document.fullscreenElement.appendChild(dialog);\n\t\telse\n\t\t{\n\t\t    root_document.body.appendChild(dialog);\n\t\t\troot_document.body.style.overflow = \"hidden\";\n\t\t}\n        // dialog element has been appended\n        \n        if (options.do_type_filter){\n            var selIn = dialog.querySelector(\".slot_in_type_filter\");\n            var selOut = dialog.querySelector(\".slot_out_type_filter\");\n        }\n        \n        dialog.close = function() {\n            that.search_box = null;\n\t\t\tthis.blur();\n            canvas.focus();\n\t\t\troot_document.body.style.overflow = \"\";\n\n            setTimeout(function() {\n                that.canvas.focus();\n            }, 20); //important, if canvas loses focus keys wont be captured\n            if (dialog.parentNode) {\n                dialog.parentNode.removeChild(dialog);\n            }\n        };\n\n        if (this.ds.scale > 1) {\n            dialog.style.transform = \"scale(\" + this.ds.scale + \")\";\n        }\n\n        // hide on mouse leave\n        if(options.hide_on_mouse_leave){\n            var prevent_timeout = false;\n            var timeout_close = null;\n            LiteGraph.pointerListenerAdd(dialog,\"enter\", function(e) {\n                if (timeout_close) {\n                    clearTimeout(timeout_close);\n                    timeout_close = null;\n                }\n            });\n            LiteGraph.pointerListenerAdd(dialog,\"leave\", function(e) {\n                if (prevent_timeout){\n                    return;\n                }\n                timeout_close = setTimeout(function() {\n                    dialog.close();\n                }, 500);\n            });\n            // if filtering, check focus changed to comboboxes and prevent closing\n            if (options.do_type_filter){\n                selIn.addEventListener(\"click\", function(e) {\n                    prevent_timeout++;\n                });\n                selIn.addEventListener(\"blur\", function(e) {\n                   prevent_timeout = 0;\n                });\n                selIn.addEventListener(\"change\", function(e) {\n                    prevent_timeout = -1;\n                });\n                selOut.addEventListener(\"click\", function(e) {\n                    prevent_timeout++;\n                });\n                selOut.addEventListener(\"blur\", function(e) {\n                   prevent_timeout = 0;\n                });\n                selOut.addEventListener(\"change\", function(e) {\n                    prevent_timeout = -1;\n                });\n            }\n        }\n\n        if (that.search_box) {\n            that.search_box.close();\n        }\n        that.search_box = dialog;\n\n        var helper = dialog.querySelector(\".helper\");\n\n        var first = null;\n        var timeout = null;\n        var selected = null;\n\n        var input = dialog.querySelector(\"input\");\n        if (input) {\n            input.addEventListener(\"blur\", function(e) {\n                this.focus();\n            });\n            input.addEventListener(\"keydown\", function(e) {\n                if (e.keyCode == 38) {\n                    //UP\n                    changeSelection(false);\n                } else if (e.keyCode == 40) {\n                    //DOWN\n                    changeSelection(true);\n                } else if (e.keyCode == 27) {\n                    //ESC\n                    dialog.close();\n                } else if (e.keyCode == 13) {\n                    if (selected) {\n                        select(selected.innerHTML);\n                    } else if (first) {\n                        select(first);\n                    } else {\n                        dialog.close();\n                    }\n                } else {\n                    if (timeout) {\n                        clearInterval(timeout);\n                    }\n                    timeout = setTimeout(refreshHelper, 250);\n                    return;\n                }\n                e.preventDefault();\n                e.stopPropagation();\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t\treturn true;\n            });\n        }\n        \n        // if should filter on type, load and fill selected and choose elements if passed\n        if (options.do_type_filter){\n            if (selIn){\n                var aSlots = LiteGraph.slot_types_in;\n                var nSlots = aSlots.length; // this for object :: Object.keys(aSlots).length;\n                \n                if (options.type_filter_in == LiteGraph.EVENT || options.type_filter_in == LiteGraph.ACTION)\n                    options.type_filter_in = \"_event_\";\n                /* this will filter on * .. but better do it manually in case\n                else if(options.type_filter_in === \"\" || options.type_filter_in === 0)\n                    options.type_filter_in = \"*\";*/\n                \n                for (var iK=0; iK<nSlots; iK++){\n                    var opt = document.createElement('option');\n                    opt.value = aSlots[iK];\n                    opt.innerHTML = aSlots[iK];\n                    selIn.appendChild(opt);\n                    if(options.type_filter_in !==false && (options.type_filter_in+\"\").toLowerCase() == (aSlots[iK]+\"\").toLowerCase()){\n                        //selIn.selectedIndex ..\n                        opt.selected = true;\n\t\t\t\t\t\t//console.log(\"comparing IN \"+options.type_filter_in+\" :: \"+aSlots[iK]);\n\t                }else{\n\t\t\t\t\t\t//console.log(\"comparing OUT \"+options.type_filter_in+\" :: \"+aSlots[iK]);\n\t\t\t\t\t}\n\t\t\t\t}\n                selIn.addEventListener(\"change\",function(){\n                    refreshHelper();\n                });\n            }\n            if (selOut){\n                var aSlots = LiteGraph.slot_types_out;\n                var nSlots = aSlots.length; // this for object :: Object.keys(aSlots).length; \n                \n                if (options.type_filter_out == LiteGraph.EVENT || options.type_filter_out == LiteGraph.ACTION)\n                    options.type_filter_out = \"_event_\";\n                /* this will filter on * .. but better do it manually in case\n                else if(options.type_filter_out === \"\" || options.type_filter_out === 0)\n                    options.type_filter_out = \"*\";*/\n                \n                for (var iK=0; iK<nSlots; iK++){\n                    var opt = document.createElement('option');\n                    opt.value = aSlots[iK];\n                    opt.innerHTML = aSlots[iK];\n                    selOut.appendChild(opt);\n                    if(options.type_filter_out !==false && (options.type_filter_out+\"\").toLowerCase() == (aSlots[iK]+\"\").toLowerCase()){\n                        //selOut.selectedIndex ..\n                        opt.selected = true;\n                    }\n                }\n                selOut.addEventListener(\"change\",function(){\n                    refreshHelper();\n                });\n            }\n        }\n        \n        //compute best position\n        var rect = canvas.getBoundingClientRect();\n\n        var left = ( event ? event.clientX : (rect.left + rect.width * 0.5) ) - 80;\n        var top = ( event ? event.clientY : (rect.top + rect.height * 0.5) ) - 20;\n        dialog.style.left = left + \"px\";\n        dialog.style.top = top + \"px\";\n\n\t\t//To avoid out of screen problems\n\t\tif(event.layerY > (rect.height - 200)) \n            helper.style.maxHeight = (rect.height - event.layerY - 20) + \"px\";\n\n\t\t/*\n        var offsetx = -20;\n        var offsety = -20;\n        if (rect) {\n            offsetx -= rect.left;\n            offsety -= rect.top;\n        }\n\n        if (event) {\n            dialog.style.left = event.clientX + offsetx + \"px\";\n            dialog.style.top = event.clientY + offsety + \"px\";\n        } else {\n            dialog.style.left = canvas.width * 0.5 + offsetx + \"px\";\n            dialog.style.top = canvas.height * 0.5 + offsety + \"px\";\n        }\n        canvas.parentNode.appendChild(dialog);\n\t\t*/\n\n        input.focus();\n        if (options.show_all_on_open) refreshHelper();\n\n        function select(name) {\n            if (name) {\n                if (that.onSearchBoxSelection) {\n                    that.onSearchBoxSelection(name, event, graphcanvas);\n                } else {\n                    var extra = LiteGraph.searchbox_extras[name.toLowerCase()];\n                    if (extra) {\n                        name = extra.type;\n                    }\n\n\t\t\t\t\tgraphcanvas.graph.beforeChange();\n                    var node = LiteGraph.createNode(name);\n                    if (node) {\n                        node.pos = graphcanvas.convertEventToCanvasOffset(\n                            event\n                        );\n                        graphcanvas.graph.add(node, false);\n                    }\n\n                    if (extra && extra.data) {\n                        if (extra.data.properties) {\n                            for (var i in extra.data.properties) {\n                                node.addProperty( i, extra.data.properties[i] );\n                            }\n                        }\n                        if (extra.data.inputs) {\n                            node.inputs = [];\n                            for (var i in extra.data.inputs) {\n                                node.addOutput(\n                                    extra.data.inputs[i][0],\n                                    extra.data.inputs[i][1]\n                                );\n                            }\n                        }\n                        if (extra.data.outputs) {\n                            node.outputs = [];\n                            for (var i in extra.data.outputs) {\n                                node.addOutput(\n                                    extra.data.outputs[i][0],\n                                    extra.data.outputs[i][1]\n                                );\n                            }\n                        }\n                        if (extra.data.title) {\n                            node.title = extra.data.title;\n                        }\n                        if (extra.data.json) {\n                            node.configure(extra.data.json);\n                        }\n\n                    }\n\n                    // join node after inserting\n                    if (options.node_from){\n                        var iS = false;\n                        switch (typeof options.slot_from){\n                            case \"string\":\n                                iS = options.node_from.findOutputSlot(options.slot_from);    \n                            break;\n                            case \"object\":\n                                if (options.slot_from.name){\n                                    iS = options.node_from.findOutputSlot(options.slot_from.name);\n                                }else{\n                                    iS = -1;\n                                }\n                                if (iS==-1 && typeof options.slot_from.slot_index !== \"undefined\") iS = options.slot_from.slot_index;\n                            break;\n                            case \"number\":\n                                iS = options.slot_from;\n                            break;\n                            default:\n                                iS = 0; // try with first if no name set\n                        }\n                        if (typeof options.node_from.outputs[iS] !== undefined){\n                            if (iS!==false && iS>-1){\n                                options.node_from.connectByType( iS, node, options.node_from.outputs[iS].type );\n                            }\n                        }else{\n                            // console.warn(\"cant find slot \" + options.slot_from);\n                        }\n                    }\n                    if (options.node_to){\n                        var iS = false;\n                        switch (typeof options.slot_from){\n                            case \"string\":\n                                iS = options.node_to.findInputSlot(options.slot_from);    \n                            break;\n                            case \"object\":\n                                if (options.slot_from.name){\n                                    iS = options.node_to.findInputSlot(options.slot_from.name);\n                                }else{\n                                    iS = -1;\n                                }\n                                if (iS==-1 && typeof options.slot_from.slot_index !== \"undefined\") iS = options.slot_from.slot_index;\n                            break;\n                            case \"number\":\n                                iS = options.slot_from;\n                            break;\n                            default:\n                                iS = 0; // try with first if no name set\n                        }\n                        if (typeof options.node_to.inputs[iS] !== undefined){\n                            if (iS!==false && iS>-1){\n                                // try connection\n                                options.node_to.connectByTypeOutput(iS,node,options.node_to.inputs[iS].type);\n                            }\n                        }else{\n                            // console.warn(\"cant find slot_nodeTO \" + options.slot_from);\n                        }\n                    }\n                    \n                    graphcanvas.graph.afterChange();\n                }\n            }\n\n            dialog.close();\n        }\n\n        function changeSelection(forward) {\n            var prev = selected;\n            if (selected) {\n                selected.classList.remove(\"selected\");\n            }\n            if (!selected) {\n                selected = forward\n                    ? helper.childNodes[0]\n                    : helper.childNodes[helper.childNodes.length];\n            } else {\n                selected = forward\n                    ? selected.nextSibling\n                    : selected.previousSibling;\n                if (!selected) {\n                    selected = prev;\n                }\n            }\n            if (!selected) {\n                return;\n            }\n            selected.classList.add(\"selected\");\n            selected.scrollIntoView({block: \"end\", behavior: \"smooth\"});\n        }\n\n        function refreshHelper() {\n            timeout = null;\n            var str = input.value;\n            first = null;\n            helper.innerHTML = \"\";\n            if (!str && !options.show_all_if_empty) {\n                return;\n            }\n\n            if (that.onSearchBox) {\n                var list = that.onSearchBox(helper, str, graphcanvas);\n                if (list) {\n                    for (var i = 0; i < list.length; ++i) {\n                        addResult(list[i]);\n                    }\n                }\n            } else {\n                var c = 0;\n                str = str.toLowerCase();\n\t\t\t\tvar filter = graphcanvas.filter || graphcanvas.graph.filter;\n\n                // filter by type preprocess\n                if(options.do_type_filter && that.search_box){\n                    var sIn = that.search_box.querySelector(\".slot_in_type_filter\");\n                    var sOut = that.search_box.querySelector(\".slot_out_type_filter\");\n                }else{\n                    var sIn = false;\n                    var sOut = false;\n                }\n                \n                //extras\n                for (var i in LiteGraph.searchbox_extras) {\n                    var extra = LiteGraph.searchbox_extras[i];\n                    if ((!options.show_all_if_empty || str) && extra.desc.toLowerCase().indexOf(str) === -1) {\n                        continue;\n                    }\n\t\t\t\t\tvar ctor = LiteGraph.registered_node_types[ extra.type ];\n\t\t\t\t\tif( ctor && ctor.filter != filter )\n\t\t\t\t\t\tcontinue;\n                    if( ! inner_test_filter(extra.type) )\n                        continue;\n                    addResult( extra.desc, \"searchbox_extra\" );\n                    if ( LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit ) {\n                        break;\n                    }\n                }\n\n\t\t\t\tvar filtered = null;\n                if (Array.prototype.filter) { //filter supported\n                    var keys = Object.keys( LiteGraph.registered_node_types ); //types\n                    var filtered = keys.filter( inner_test_filter );\n                } else {\n\t\t\t\t\tfiltered = [];\n                    for (var i in LiteGraph.registered_node_types) {\n\t\t\t\t\t\tif( inner_test_filter(i) )\n\t\t\t\t\t\t\tfiltered.push(i);\n                    }\n                }\n\n\t\t\t\tfor (var i = 0; i < filtered.length; i++) {\n\t\t\t\t\taddResult(filtered[i]);\n\t\t\t\t\tif ( LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n                \n                // add general type if filtering\n                if (options.show_general_after_typefiltered\n                    && (sIn.value || sOut.value) \n                ){\n                    filtered_extra = [];\n                    for (var i in LiteGraph.registered_node_types) {\n\t\t\t\t\t\tif( inner_test_filter(i, {inTypeOverride: sIn&&sIn.value?\"*\":false, outTypeOverride: sOut&&sOut.value?\"*\":false}) )\n\t\t\t\t\t\t\tfiltered_extra.push(i);\n                    }\n                    for (var i = 0; i < filtered_extra.length; i++) {\n                        addResult(filtered_extra[i], \"generic_type\");\n                        if ( LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit ) {\n                            break;\n                        }\n                    }\n                }\n                \n                // check il filtering gave no results\n                if ((sIn.value || sOut.value) && \n                    ( (helper.childNodes.length == 0 && options.show_general_if_none_on_typefilter) )\n                ){\n                    filtered_extra = [];\n                    for (var i in LiteGraph.registered_node_types) {\n\t\t\t\t\t\tif( inner_test_filter(i, {skipFilter: true}) )\n\t\t\t\t\t\t\tfiltered_extra.push(i);\n                    }\n                    for (var i = 0; i < filtered_extra.length; i++) {\n                        addResult(filtered_extra[i], \"not_in_filter\");\n                        if ( LGraphCanvas.search_limit !== -1 && c++ > LGraphCanvas.search_limit ) {\n                            break;\n                        }\n                    }\n                }\n                \n\t\t\t\tfunction inner_test_filter( type, optsIn )\n\t\t\t\t{\n                    var optsIn = optsIn || {};\n                    var optsDef = { skipFilter: false\n                                    ,inTypeOverride: false\n                                    ,outTypeOverride: false\n                                  };\n                    var opts = Object.assign(optsDef,optsIn);\n\t\t\t\t\tvar ctor = LiteGraph.registered_node_types[ type ];\n\t\t\t\t\tif(filter && ctor.filter != filter )\n\t\t\t\t\t\treturn false;\n                    if ((!options.show_all_if_empty || str) && type.toLowerCase().indexOf(str) === -1)\n                        return false;\n                    \n                    // filter by slot IN, OUT types\n                    if(options.do_type_filter && !opts.skipFilter){\n                        var sType = type;\n                        \n                        var sV = sIn.value;\n                        if (opts.inTypeOverride!==false) sV = opts.inTypeOverride;\n\t\t\t\t\t\t//if (sV.toLowerCase() == \"_event_\") sV = LiteGraph.EVENT; // -1\n                        \n                        if(sIn && sV){\n                            //console.log(\"will check filter against \"+sV);\n                            if (LiteGraph.registered_slot_in_types[sV] && LiteGraph.registered_slot_in_types[sV].nodes){ // type is stored\n                                //console.debug(\"check \"+sType+\" in \"+LiteGraph.registered_slot_in_types[sV].nodes);\n                                var doesInc = LiteGraph.registered_slot_in_types[sV].nodes.includes(sType);\n                                if (doesInc!==false){\n                                    //console.log(sType+\" HAS \"+sV);\n                                }else{\n                                    /*console.debug(LiteGraph.registered_slot_in_types[sV]);\n                                    console.log(+\" DONT includes \"+type);*/\n                                    return false;\n                                }\n                            }\n                        }\n                        \n                        var sV = sOut.value;\n                        if (opts.outTypeOverride!==false) sV = opts.outTypeOverride;\n                        //if (sV.toLowerCase() == \"_event_\") sV = LiteGraph.EVENT; // -1\n                        \n                        if(sOut && sV){\n                            //console.log(\"search will check filter against \"+sV);\n                            if (LiteGraph.registered_slot_out_types[sV] && LiteGraph.registered_slot_out_types[sV].nodes){ // type is stored\n                                //console.debug(\"check \"+sType+\" in \"+LiteGraph.registered_slot_out_types[sV].nodes);\n                                var doesInc = LiteGraph.registered_slot_out_types[sV].nodes.includes(sType);\n                                if (doesInc!==false){\n                                    //console.log(sType+\" HAS \"+sV);\n                                }else{\n                                    /*console.debug(LiteGraph.registered_slot_out_types[sV]);\n                                    console.log(+\" DONT includes \"+type);*/\n                                    return false;\n                                }\n                            }\n                        }\n                    }\n                    return true;\n\t\t\t\t}\n            }\n\n            function addResult(type, className) {\n                var help = document.createElement(\"div\");\n                if (!first) {\n                    first = type;\n                }\n                help.innerText = type;\n                help.dataset[\"type\"] = escape(type);\n                help.className = \"litegraph lite-search-item\";\n                if (className) {\n                    help.className += \" \" + className;\n                }\n                help.addEventListener(\"click\", function(e) {\n                    select(unescape(this.dataset[\"type\"]));\n                });\n                helper.appendChild(help);\n            }\n        }\n\n        return dialog;\n    };\n\n    LGraphCanvas.prototype.showEditPropertyValue = function( node, property, options ) {\n        if (!node || node.properties[property] === undefined) {\n            return;\n        }\n\n        options = options || {};\n        var that = this;\n\n        var info = node.getPropertyInfo(property);\n\t\tvar type = info.type;\n\n        var input_html = \"\";\n\n        if (type == \"string\" || type == \"number\" || type == \"array\" || type == \"object\") {\n            input_html = \"<input autofocus type='text' class='value'/>\";\n        } else if ( (type == \"enum\" || type == \"combo\") && info.values) {\n            input_html = \"<select autofocus type='text' class='value'>\";\n            for (var i in info.values) {\n                var v = i;\n\t\t\t\tif( info.values.constructor === Array )\n\t\t\t\t\tv = info.values[i];\n\n                input_html +=\n                    \"<option value='\" +\n                    v +\n                    \"' \" +\n                    (v == node.properties[property] ? \"selected\" : \"\") +\n                    \">\" +\n                    info.values[i] +\n                    \"</option>\";\n            }\n            input_html += \"</select>\";\n        } else if (type == \"boolean\" || type == \"toggle\") {\n            input_html =\n                \"<input autofocus type='checkbox' class='value' \" +\n                (node.properties[property] ? \"checked\" : \"\") +\n                \"/>\";\n        } else {\n            console.warn(\"unknown type: \" + type);\n            return;\n        }\n\n        var dialog = this.createDialog(\n            \"<span class='name'>\" +\n                (info.label ? info.label : property) +\n                \"</span>\" +\n                input_html +\n                \"<button>OK</button>\",\n            options\n        );\n\n        var input = false;\n        if ((type == \"enum\" || type == \"combo\") && info.values) {\n            input = dialog.querySelector(\"select\");\n            input.addEventListener(\"change\", function(e) {\n                dialog.modified();\n                setValue(e.target.value);\n                //var index = e.target.value;\n                //setValue( e.options[e.selectedIndex].value );\n            });\n        } else if (type == \"boolean\" || type == \"toggle\") {\n            input = dialog.querySelector(\"input\");\n            if (input) {\n                input.addEventListener(\"click\", function(e) {\n                    dialog.modified();\n                    setValue(!!input.checked);\n                });\n            }\n        } else {\n            input = dialog.querySelector(\"input\");\n            if (input) {\n                input.addEventListener(\"blur\", function(e) {\n                    this.focus();\n                });\n\n\t\t\t\tvar v = node.properties[property] !== undefined ? node.properties[property] : \"\";\n\t\t\t\tif (type !== 'string') {\n                    v = JSON.stringify(v);\n                }\n\n                input.value = v;\n                input.addEventListener(\"keydown\", function(e) {\n                    if (e.keyCode == 27) {\n                        //ESC\n                        dialog.close();\n                    } else if (e.keyCode == 13) {\n                        // ENTER\n                        inner(); // save\n                    } else if (e.keyCode != 13) {\n                        dialog.modified();\n                        return;\n                    }\n                    e.preventDefault();\n                    e.stopPropagation();\n                });\n            }\n        }\n        if (input) input.focus();\n\n        var button = dialog.querySelector(\"button\");\n        button.addEventListener(\"click\", inner);\n\n        function inner() {\n            setValue(input.value);\n        }\n\n        function setValue(value) {\n\n\t\t\tif(info && info.values && info.values.constructor === Object && info.values[value] != undefined )\n\t\t\t\tvalue = info.values[value];\n\n            if (typeof node.properties[property] == \"number\") {\n                value = Number(value);\n            }\n            if (type == \"array\" || type == \"object\") {\n                value = JSON.parse(value);\n            }\n            node.properties[property] = value;\n            if (node.graph) {\n                node.graph._version++;\n            }\n            if (node.onPropertyChanged) {\n                node.onPropertyChanged(property, value);\n            }\n\t\t\tif(options.onclose)\n\t\t\t\toptions.onclose();\n            dialog.close();\n            node.setDirtyCanvas(true, true);\n        }\n\n\t\treturn dialog;\n    };\n\n    // TODO refactor, theer are different dialog, some uses createDialog, some dont\n    LGraphCanvas.prototype.createDialog = function(html, options) {\n        def_options = { checkForInput: false, closeOnLeave: true, closeOnLeave_checkModified: true };\n        options = Object.assign(def_options, options || {});\n\n        var dialog = document.createElement(\"div\");\n        dialog.className = \"graphdialog\";\n        dialog.innerHTML = html;\n        dialog.is_modified = false;\n\n        var rect = this.canvas.getBoundingClientRect();\n        var offsetx = -20;\n        var offsety = -20;\n        if (rect) {\n            offsetx -= rect.left;\n            offsety -= rect.top;\n        }\n\n        if (options.position) {\n            offsetx += options.position[0];\n            offsety += options.position[1];\n        } else if (options.event) {\n            offsetx += options.event.clientX;\n            offsety += options.event.clientY;\n        } //centered\n        else {\n            offsetx += this.canvas.width * 0.5;\n            offsety += this.canvas.height * 0.5;\n        }\n\n        dialog.style.left = offsetx + \"px\";\n        dialog.style.top = offsety + \"px\";\n\n        this.canvas.parentNode.appendChild(dialog);\n        \n        // acheck for input and use default behaviour: save on enter, close on esc\n        if (options.checkForInput){\n            var aI = [];\n            var focused = false;\n            if (aI = dialog.querySelectorAll(\"input\")){\n                aI.forEach(function(iX) {\n                    iX.addEventListener(\"keydown\",function(e){\n                        dialog.modified();\n                        if (e.keyCode == 27) {\n                            dialog.close();\n                        } else if (e.keyCode != 13) {\n                            return;\n                        }\n                        // set value ?\n                        e.preventDefault();\n                        e.stopPropagation();\n                    });\n                    if (!focused) iX.focus();\n                });\n            }\n        }\n        \n        dialog.modified = function(){\n            dialog.is_modified = true;\n        }\n        dialog.close = function() {\n            if (dialog.parentNode) {\n                dialog.parentNode.removeChild(dialog);\n            }\n        };\n        \n        var dialogCloseTimer = null;\n        var prevent_timeout = false;\n        dialog.addEventListener(\"mouseleave\", function(e) {\n            if (prevent_timeout)\n                return;\n            if(options.closeOnLeave || LiteGraph.dialog_close_on_mouse_leave)\n                if (!dialog.is_modified && LiteGraph.dialog_close_on_mouse_leave)\n                    dialogCloseTimer = setTimeout(dialog.close, LiteGraph.dialog_close_on_mouse_leave_delay); //dialog.close();\n        });\n        dialog.addEventListener(\"mouseenter\", function(e) {\n            if(options.closeOnLeave || LiteGraph.dialog_close_on_mouse_leave)\n                if(dialogCloseTimer) clearTimeout(dialogCloseTimer);\n        });\n        var selInDia = dialog.querySelectorAll(\"select\");\n        if (selInDia){\n            // if filtering, check focus changed to comboboxes and prevent closing\n            selInDia.forEach(function(selIn) {\n                selIn.addEventListener(\"click\", function(e) {\n                    prevent_timeout++;\n                });\n                selIn.addEventListener(\"blur\", function(e) {\n                   prevent_timeout = 0;\n                });\n                selIn.addEventListener(\"change\", function(e) {\n                    prevent_timeout = -1;\n                });\n            });\n        }\n\n        return dialog;\n    };\n\n\tLGraphCanvas.prototype.createPanel = function(title, options) {\n\t\toptions = options || {};\n\n\t\tvar ref_window = options.window || window;\n\t\tvar root = document.createElement(\"div\");\n\t\troot.className = \"litegraph dialog\";\n\t\troot.innerHTML = \"<div class='dialog-header'><span class='dialog-title'></span></div><div class='dialog-content'></div><div style='display:none;' class='dialog-alt-content'></div><div class='dialog-footer'></div>\";\n\t\troot.header = root.querySelector(\".dialog-header\");\n\n\t\tif(options.width)\n\t\t\troot.style.width = options.width + (options.width.constructor === Number ? \"px\" : \"\");\n\t\tif(options.height)\n\t\t\troot.style.height = options.height + (options.height.constructor === Number ? \"px\" : \"\");\n\t\tif(options.closable)\n\t\t{\n\t\t\tvar close = document.createElement(\"span\");\n\t\t\tclose.innerHTML = \"&#10005;\";\n\t\t\tclose.classList.add(\"close\");\n\t\t\tclose.addEventListener(\"click\",function(){\n\t\t\t\troot.close();\n\t\t\t});\n\t\t\troot.header.appendChild(close);\n\t\t}\n\t\troot.title_element = root.querySelector(\".dialog-title\");\n\t\troot.title_element.innerText = title;\n\t\troot.content = root.querySelector(\".dialog-content\");\n        root.alt_content = root.querySelector(\".dialog-alt-content\");\n\t\troot.footer = root.querySelector(\".dialog-footer\");\n\n\t\troot.close = function()\n\t\t{\n\t\t    if (root.onClose && typeof root.onClose == \"function\"){\n\t\t        root.onClose();\n\t\t    }\n\t\t    root.parentNode.removeChild(root);\n\t\t    /* XXX CHECK THIS */\n\t\t    if(this.parentNode){\n\t\t    \tthis.parentNode.removeChild(this);\n\t\t    }\n\t\t    /* XXX this was not working, was fixed with an IF, check this */\n\t\t}\n\n        // function to swap panel content\n        root.toggleAltContent = function(force){\n            if (typeof force != \"undefined\"){\n                var vTo = force ? \"block\" : \"none\";\n                var vAlt = force ? \"none\" : \"block\";\n            }else{\n                var vTo = root.alt_content.style.display != \"block\" ? \"block\" : \"none\";\n                var vAlt = root.alt_content.style.display != \"block\" ? \"none\" : \"block\";\n            }\n            root.alt_content.style.display = vTo;\n            root.content.style.display = vAlt;\n        }\n        \n        root.toggleFooterVisibility = function(force){\n            if (typeof force != \"undefined\"){\n                var vTo = force ? \"block\" : \"none\";\n            }else{\n                var vTo = root.footer.style.display != \"block\" ? \"block\" : \"none\";\n            }\n            root.footer.style.display = vTo;\n        }\n        \n\t\troot.clear = function()\n\t\t{\n\t\t\tthis.content.innerHTML = \"\";\n\t\t}\n\n\t\troot.addHTML = function(code, classname, on_footer)\n\t\t{\n\t\t\tvar elem = document.createElement(\"div\");\n\t\t\tif(classname)\n\t\t\t\telem.className = classname;\n\t\t\telem.innerHTML = code;\n\t\t\tif(on_footer)\n\t\t\t\troot.footer.appendChild(elem);\n\t\t\telse\n\t\t\t\troot.content.appendChild(elem);\n\t\t\treturn elem;\n\t\t}\n\n\t\troot.addButton = function( name, callback, options )\n\t\t{\n\t\t\tvar elem = document.createElement(\"button\");\n\t\t\telem.innerText = name;\n\t\t\telem.options = options;\n\t\t\telem.classList.add(\"btn\");\n\t\t\telem.addEventListener(\"click\",callback);\n\t\t\troot.footer.appendChild(elem);\n\t\t\treturn elem;\n\t\t}\n\n\t\troot.addSeparator = function()\n\t\t{\n\t\t\tvar elem = document.createElement(\"div\");\n\t\t\telem.className = \"separator\";\n\t\t\troot.content.appendChild(elem);\n\t\t}\n\n\t\troot.addWidget = function( type, name, value, options, callback )\n\t\t{\n\t\t\toptions = options || {};\n\t\t\tvar str_value = String(value);\n\t\t\ttype = type.toLowerCase();\n\t\t\tif(type == \"number\")\n\t\t\t\tstr_value = value.toFixed(3);\n\n\t\t\tvar elem = document.createElement(\"div\");\n\t\t\telem.className = \"property\";\n\t\t\telem.innerHTML = \"<span class='property_name'></span><span class='property_value'></span>\";\n\t\t\telem.querySelector(\".property_name\").innerText = options.label || name;\n\t\t\tvar value_element = elem.querySelector(\".property_value\");\n\t\t\tvalue_element.innerText = str_value;\n\t\t\telem.dataset[\"property\"] = name;\n\t\t\telem.dataset[\"type\"] = options.type || type;\n\t\t\telem.options = options;\n\t\t\telem.value = value;\n\n\t\t\tif( type == \"code\" )\n\t\t\t\telem.addEventListener(\"click\", function(e){ root.inner_showCodePad( this.dataset[\"property\"] ); });\n\t\t\telse if (type == \"boolean\")\n\t\t\t{\n\t\t\t\telem.classList.add(\"boolean\");\n\t\t\t\tif(value)\n\t\t\t\t\telem.classList.add(\"bool-on\");\n\t\t\t\telem.addEventListener(\"click\", function(){ \n\t\t\t\t\t//var v = node.properties[this.dataset[\"property\"]]; \n\t\t\t\t\t//node.setProperty(this.dataset[\"property\"],!v); this.innerText = v ? \"true\" : \"false\"; \n\t\t\t\t\tvar propname = this.dataset[\"property\"];\n\t\t\t\t\tthis.value = !this.value;\n\t\t\t\t\tthis.classList.toggle(\"bool-on\");\n\t\t\t\t\tthis.querySelector(\".property_value\").innerText = this.value ? \"true\" : \"false\";\n\t\t\t\t\tinnerChange(propname, this.value );\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (type == \"string\" || type == \"number\")\n\t\t\t{\n\t\t\t\tvalue_element.setAttribute(\"contenteditable\",true);\n\t\t\t\tvalue_element.addEventListener(\"keydown\", function(e){ \n\t\t\t\t\tif(e.code == \"Enter\" && (type != \"string\" || !e.shiftKey)) // allow for multiline\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tthis.blur();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tvalue_element.addEventListener(\"blur\", function(){ \n\t\t\t\t\tvar v = this.innerText;\n\t\t\t\t\tvar propname = this.parentNode.dataset[\"property\"];\n\t\t\t\t\tvar proptype = this.parentNode.dataset[\"type\"];\n\t\t\t\t\tif( proptype == \"number\")\n\t\t\t\t\t\tv = Number(v);\n\t\t\t\t\tinnerChange(propname, v);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (type == \"enum\" || type == \"combo\") {\n\t\t\t\tvar str_value = LGraphCanvas.getPropertyPrintableValue( value, options.values );\n\t\t\t\tvalue_element.innerText = str_value;\n\n\t\t\t\tvalue_element.addEventListener(\"click\", function(event){ \n\t\t\t\t\tvar values = options.values || [];\n\t\t\t\t\tvar propname = this.parentNode.dataset[\"property\"];\n\t\t\t\t\tvar elem_that = this;\n\t\t\t\t\tvar menu = new LiteGraph.ContextMenu(values,{\n\t\t\t\t\t\t\tevent: event,\n\t\t\t\t\t\t\tclassName: \"dark\",\n\t\t\t\t\t\t\tcallback: inner_clicked\n\t\t\t\t\t\t},\n\t\t\t\t\t\tref_window);\n\t\t\t\t\tfunction inner_clicked(v, option, event) {\n\t\t\t\t\t\t//node.setProperty(propname,v); \n\t\t\t\t\t\t//graphcanvas.dirty_canvas = true;\n\t\t\t\t\t\telem_that.innerText = v;\n\t\t\t\t\t\tinnerChange(propname,v);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n            }\n\n\t\t\troot.content.appendChild(elem);\n\n\t\t\tfunction innerChange(name, value)\n\t\t\t{\n\t\t\t\t//console.log(\"change\",name,value);\n\t\t\t\t//that.dirty_canvas = true;\n\t\t\t\tif(options.callback)\n\t\t\t\t\toptions.callback(name,value,options);\n\t\t\t\tif(callback)\n\t\t\t\t\tcallback(name,value,options);\n\t\t\t}\n\n\t\t\treturn elem;\n\t\t}\n\n        if (root.onOpen && typeof root.onOpen == \"function\") root.onOpen();\n        \n\t\treturn root;\n\t};\n\n\tLGraphCanvas.getPropertyPrintableValue = function(value, values)\n\t{\n\t\tif(!values)\n\t\t\treturn String(value);\n\n\t\tif(values.constructor === Array)\n\t\t{\n\t\t\treturn String(value);\t\t\t\n\t\t}\n\n\t\tif(values.constructor === Object)\n\t\t{\n\t\t\tvar desc_value = \"\";\n\t\t\tfor(var k in values)\n\t\t\t{\n\t\t\t\tif(values[k] != value)\n\t\t\t\t\tcontinue;\n\t\t\t\tdesc_value = k;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn String(value) + \" (\"+desc_value+\")\";\n\t\t}\n\t}\n\n    LGraphCanvas.prototype.closePanels = function(){\n        var panel = document.querySelector(\"#node-panel\");\n\t\tif(panel)\n\t\t\tpanel.close();\n        var panel = document.querySelector(\"#option-panel\");\n\t\tif(panel)\n\t\t\tpanel.close();\n    }\n    \n    LGraphCanvas.prototype.showShowGraphOptionsPanel = function(refOpts, obEv, refMenu, refMenu2){\n        if(this.constructor && this.constructor.name == \"HTMLDivElement\"){\n            // assume coming from the menu event click\n            if (!obEv || !obEv.event || !obEv.event.target || !obEv.event.target.lgraphcanvas){\n                console.warn(\"Canvas not found\"); // need a ref to canvas obj\n                /*console.debug(event);\n                console.debug(event.target);*/\n                return;\n            }\n            var graphcanvas = obEv.event.target.lgraphcanvas;\n        }else{\n            // assume called internally\n            var graphcanvas = this;\n        }\n        graphcanvas.closePanels();\n        var ref_window = graphcanvas.getCanvasWindow();\n        panel = graphcanvas.createPanel(\"Options\",{\n                                            closable: true\n                                            ,window: ref_window\n                                            ,onOpen: function(){\n                                                graphcanvas.OPTIONPANEL_IS_OPEN = true;\n                                            }\n                                            ,onClose: function(){\n                                                graphcanvas.OPTIONPANEL_IS_OPEN = false;\n                                                graphcanvas.options_panel = null;\n                                            }\n                                        });\n        graphcanvas.options_panel = panel;\n        panel.id = \"option-panel\";\n\t\tpanel.classList.add(\"settings\");\n        \n        function inner_refresh(){\n            \n            panel.content.innerHTML = \"\"; //clear\n\n            var fUpdate = function(name, value, options){\n                switch(name){\n                    /*case \"Render mode\":\n                        // Case \"\".. \n                        if (options.values && options.key){\n                            var kV = Object.values(options.values).indexOf(value);\n                            if (kV>=0 && options.values[kV]){\n                                console.debug(\"update graph options: \"+options.key+\": \"+kV);\n                                graphcanvas[options.key] = kV;\n                                //console.debug(graphcanvas);\n                                break;\n                            }\n                        }\n                        console.warn(\"unexpected options\");\n                        console.debug(options);\n                        break;*/\n                    default:\n                        //console.debug(\"want to update graph options: \"+name+\": \"+value);\n                        if (options && options.key){\n                            name = options.key;\n                        }\n                        if (options.values){\n                            value = Object.values(options.values).indexOf(value);\n                        }\n                        //console.debug(\"update graph option: \"+name+\": \"+value);\n                        graphcanvas[name] = value;\n                        break;\n                }\n            };\n            \n            // panel.addWidget( \"string\", \"Graph name\", \"\", {}, fUpdate); // implement\n            \n            var aProps = LiteGraph.availableCanvasOptions;\n            aProps.sort();\n            for(pI in aProps){\n                var pX = aProps[pI];\n                panel.addWidget( \"boolean\", pX, graphcanvas[pX], {key: pX, on: \"True\", off: \"False\"}, fUpdate);\n            }\n            \n            var aLinks = [ graphcanvas.links_render_mode ];\n            panel.addWidget( \"combo\", \"Render mode\", LiteGraph.LINK_RENDER_MODES[graphcanvas.links_render_mode], {key: \"links_render_mode\", values: LiteGraph.LINK_RENDER_MODES}, fUpdate);\n            \n            panel.addSeparator();\n            \n            panel.footer.innerHTML = \"\"; // clear\n\n\t\t}\n        inner_refresh();\n\n\t\tgraphcanvas.canvas.parentNode.appendChild( panel );\n    }\n    \n    LGraphCanvas.prototype.showShowNodePanel = function( node )\n\t{\n\t\tthis.SELECTED_NODE = node;\n\t\tthis.closePanels();\n\t\tvar ref_window = this.getCanvasWindow();\n        var that = this;\n\t\tvar graphcanvas = this;\n\t\tpanel = this.createPanel(node.title || \"\",{\n                                                    closable: true\n                                                    ,window: ref_window\n                                                    ,onOpen: function(){\n                                                        graphcanvas.NODEPANEL_IS_OPEN = true;\n                                                    }\n                                                    ,onClose: function(){\n                                                        graphcanvas.NODEPANEL_IS_OPEN = false;\n                                                        graphcanvas.node_panel = null;\n                                                    }\n                                                });\n        graphcanvas.node_panel = panel;\n\t\tpanel.id = \"node-panel\";\n\t\tpanel.node = node;\n\t\tpanel.classList.add(\"settings\");\n\n\t\tfunction inner_refresh()\n\t\t{\n\t\t\tpanel.content.innerHTML = \"\"; //clear\n\t\t\tpanel.addHTML(\"<span class='node_type'>\"+node.type+\"</span><span class='node_desc'>\"+(node.constructor.desc || \"\")+\"</span><span class='separator'></span>\");\n\n\t\t\tpanel.addHTML(\"<h3>Properties</h3>\");\n\n            var fUpdate = function(name,value){\n                            graphcanvas.graph.beforeChange(node);\n                            switch(name){\n                                case \"Title\":\n                                    node.title = value;\n                                    break;\n                                case \"Mode\":\n                                    var kV = Object.values(LiteGraph.NODE_MODES).indexOf(value);\n                                    if (kV>=0 && LiteGraph.NODE_MODES[kV]){\n                                        node.changeMode(kV);\n                                    }else{\n                                        console.warn(\"unexpected mode: \"+value);\n                                    }\n                                    break;\n                                case \"Color\":\n                                    if (LGraphCanvas.node_colors[value]){\n                                        node.color = LGraphCanvas.node_colors[value].color;\n                                        node.bgcolor = LGraphCanvas.node_colors[value].bgcolor;\n                                    }else{\n                                        console.warn(\"unexpected color: \"+value);\n                                    }\n                                    break;\n                                default:\n                                    node.setProperty(name,value);\n                                    break;\n                            }\n                            graphcanvas.graph.afterChange();\n                            graphcanvas.dirty_canvas = true;\n                        };\n            \n            panel.addWidget( \"string\", \"Title\", node.title, {}, fUpdate);\n            \n            panel.addWidget( \"combo\", \"Mode\", LiteGraph.NODE_MODES[node.mode], {values: LiteGraph.NODE_MODES}, fUpdate);\n            \n            var nodeCol = \"\";\n            if (node.color !== undefined){\n                nodeCol = Object.keys(LGraphCanvas.node_colors).filter(function(nK){ return LGraphCanvas.node_colors[nK].color == node.color; });\n            }\n            \n            panel.addWidget( \"combo\", \"Color\", nodeCol, {values: Object.keys(LGraphCanvas.node_colors)}, fUpdate);\n            \n            for(var pName in node.properties)\n\t\t\t{\n\t\t\t\tvar value = node.properties[pName];\n\t\t\t\tvar info = node.getPropertyInfo(pName);\n\t\t\t\tvar type = info.type || \"string\";\n\n\t\t\t\t//in case the user wants control over the side panel widget\n\t\t\t\tif( node.onAddPropertyToPanel && node.onAddPropertyToPanel(pName,panel) )\n\t\t\t\t\tcontinue;\n\n\t\t\t\tpanel.addWidget( info.widget || info.type, pName, value, info, fUpdate);\n\t\t\t}\n\n\t\t\tpanel.addSeparator();\n\n\t\t\tif(node.onShowCustomPanelInfo)\n\t\t\t\tnode.onShowCustomPanelInfo(panel);\n\n            panel.footer.innerHTML = \"\"; // clear\n\t\t\tpanel.addButton(\"Delete\",function(){\n\t\t\t\tif(node.block_delete)\n\t\t\t\t\treturn;\n\t\t\t\tnode.graph.remove(node);\n\t\t\t\tpanel.close();\n\t\t\t}).classList.add(\"delete\");\n\t\t}\n\n\t\tpanel.inner_showCodePad = function( propname )\n\t\t{\n            panel.classList.remove(\"settings\");\n            panel.classList.add(\"centered\");\n\n            \n\t\t\t/*if(window.CodeFlask) //disabled for now\n\t\t\t{\n\t\t\t\tpanel.content.innerHTML = \"<div class='code'></div>\";\n\t\t\t\tvar flask = new CodeFlask( \"div.code\", { language: 'js' });\n\t\t\t\tflask.updateCode(node.properties[propname]);\n\t\t\t\tflask.onUpdate( function(code) {\n\t\t\t\t\tnode.setProperty(propname, code);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{*/\n\t\t\t\tpanel.alt_content.innerHTML = \"<textarea class='code'></textarea>\";\n\t\t\t\tvar textarea = panel.alt_content.querySelector(\"textarea\");\n                var fDoneWith = function(){\n                    panel.toggleAltContent(false); //if(node_prop_div) node_prop_div.style.display = \"block\"; // panel.close();\n                    panel.toggleFooterVisibility(true);\n                    textarea.parentNode.removeChild(textarea);\n                    panel.classList.add(\"settings\");\n                    panel.classList.remove(\"centered\");\n                    inner_refresh();\n                }\n\t\t\t\ttextarea.value = node.properties[propname];\n\t\t\t\ttextarea.addEventListener(\"keydown\", function(e){\n\t\t\t\t\tif(e.code == \"Enter\" && e.ctrlKey )\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.setProperty(propname, textarea.value);\n                        fDoneWith();\n\t\t\t\t\t}\n\t\t\t\t});\n                panel.toggleAltContent(true);\n                panel.toggleFooterVisibility(false);\n\t\t\t\ttextarea.style.height = \"calc(100% - 40px)\";\n\t\t\t/*}*/\n\t\t\tvar assign = panel.addButton( \"Assign\", function(){\n\t\t\t\tnode.setProperty(propname, textarea.value);\n                fDoneWith();\n\t\t\t});\n\t\t\tpanel.alt_content.appendChild(assign); //panel.content.appendChild(assign);\n\t\t\tvar button = panel.addButton( \"Close\", fDoneWith);\n\t\t\tbutton.style.float = \"right\";\n\t\t\tpanel.alt_content.appendChild(button); // panel.content.appendChild(button);\n\t\t}\n\n\t\tinner_refresh();\n\n\t\tthis.canvas.parentNode.appendChild( panel );\n\t}\n\t\n\tLGraphCanvas.prototype.showSubgraphPropertiesDialog = function(node)\n\t{\n\t\tconsole.log(\"showing subgraph properties dialog\");\n\n\t\tvar old_panel = this.canvas.parentNode.querySelector(\".subgraph_dialog\");\n\t\tif(old_panel)\n\t\t\told_panel.close();\n\n\t\tvar panel = this.createPanel(\"Subgraph Inputs\",{closable:true, width: 500});\n\t\tpanel.node = node;\n\t\tpanel.classList.add(\"subgraph_dialog\");\n\n\t\tfunction inner_refresh()\n\t\t{\n\t\t\tpanel.clear();\n\n\t\t\t//show currents\n\t\t\tif(node.inputs)\n\t\t\t\tfor(var i = 0; i < node.inputs.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tvar input = node.inputs[i];\n\t\t\t\t\tif(input.not_subgraph_input)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tvar html = \"<button>&#10005;</button> <span class='bullet_icon'></span><span class='name'></span><span class='type'></span>\";\n\t\t\t\t\tvar elem = panel.addHTML(html,\"subgraph_property\");\n\t\t\t\t\telem.dataset[\"name\"] = input.name;\n\t\t\t\t\telem.dataset[\"slot\"] = i;\n\t\t\t\t\telem.querySelector(\".name\").innerText = input.name;\n\t\t\t\t\telem.querySelector(\".type\").innerText = input.type;\n\t\t\t\t\telem.querySelector(\"button\").addEventListener(\"click\",function(e){\n\t\t\t\t\t\tnode.removeInput( Number( this.parentNode.dataset[\"slot\"] ) );\n\t\t\t\t\t\tinner_refresh();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t}\n\n\t\t//add extra\n\t\tvar html = \" + <span class='label'>Name</span><input class='name'/><span class='label'>Type</span><input class='type'></input><button>+</button>\";\n\t\tvar elem = panel.addHTML(html,\"subgraph_property extra\", true);\n\t\telem.querySelector(\"button\").addEventListener(\"click\", function(e){\n\t\t\tvar elem = this.parentNode;\n\t\t\tvar name = elem.querySelector(\".name\").value;\n\t\t\tvar type = elem.querySelector(\".type\").value;\n\t\t\tif(!name || node.findInputSlot(name) != -1)\n\t\t\t\treturn;\n\t\t\tnode.addInput(name,type);\n\t\t\telem.querySelector(\".name\").value = \"\";\n\t\t\telem.querySelector(\".type\").value = \"\";\n\t\t\tinner_refresh();\n\t\t});\n\n\t\tinner_refresh();\n\t    this.canvas.parentNode.appendChild(panel);\n\t\treturn panel;\n\t}\n    LGraphCanvas.prototype.showSubgraphPropertiesDialogRight = function (node) {\n\n        // console.log(\"showing subgraph properties dialog\");\n        var that = this;\n        // old_panel if old_panel is exist close it\n        var old_panel = this.canvas.parentNode.querySelector(\".subgraph_dialog\");\n        if (old_panel)\n            old_panel.close();\n        // new panel\n        var panel = this.createPanel(\"Subgraph Outputs\", { closable: true, width: 500 });\n        panel.node = node;\n        panel.classList.add(\"subgraph_dialog\");\n\n        function inner_refresh() {\n            panel.clear();\n            //show currents\n            if (node.outputs)\n                for (var i = 0; i < node.outputs.length; ++i) {\n                    var input = node.outputs[i];\n                    if (input.not_subgraph_output)\n                        continue;\n                    var html = \"<button>&#10005;</button> <span class='bullet_icon'></span><span class='name'></span><span class='type'></span>\";\n                    var elem = panel.addHTML(html, \"subgraph_property\");\n                    elem.dataset[\"name\"] = input.name;\n                    elem.dataset[\"slot\"] = i;\n                    elem.querySelector(\".name\").innerText = input.name;\n                    elem.querySelector(\".type\").innerText = input.type;\n                    elem.querySelector(\"button\").addEventListener(\"click\", function (e) {\n                        node.removeOutput(Number(this.parentNode.dataset[\"slot\"]));\n                        inner_refresh();\n                    });\n                }\n        }\n\n        //add extra\n        var html = \" + <span class='label'>Name</span><input class='name'/><span class='label'>Type</span><input class='type'></input><button>+</button>\";\n        var elem = panel.addHTML(html, \"subgraph_property extra\", true);\n        elem.querySelector(\".name\").addEventListener(\"keydown\", function (e) {\n            if (e.keyCode == 13) {\n                addOutput.apply(this)\n            }\n        })\n        elem.querySelector(\"button\").addEventListener(\"click\", function (e) {\n            addOutput.apply(this)\n        });\n        function addOutput() {\n            var elem = this.parentNode;\n            var name = elem.querySelector(\".name\").value;\n            var type = elem.querySelector(\".type\").value;\n            if (!name || node.findOutputSlot(name) != -1)\n                return;\n            node.addOutput(name, type);\n            elem.querySelector(\".name\").value = \"\";\n            elem.querySelector(\".type\").value = \"\";\n            inner_refresh();\n        }\n\n        inner_refresh();\n        this.canvas.parentNode.appendChild(panel);\n        return panel;\n    }\n\tLGraphCanvas.prototype.checkPanels = function()\n\t{\n\t\tif(!this.canvas)\n\t\t\treturn;\n\t\tvar panels = this.canvas.parentNode.querySelectorAll(\".litegraph.dialog\");\n\t\tfor(var i = 0; i < panels.length; ++i)\n\t\t{\n\t\t\tvar panel = panels[i];\n\t\t\tif( !panel.node )\n\t\t\t\tcontinue;\n\t\t\tif( !panel.node.graph || panel.graph != this.graph )\n\t\t\t\tpanel.close();\n\t\t}\n\t}\n\n    LGraphCanvas.onMenuNodeCollapse = function(value, options, e, menu, node) {\n\t\tnode.graph.beforeChange(/*?*/);\n\t\t\n\t\tvar fApplyMultiNode = function(node){\n\t\t\tnode.collapse();\n\t\t}\n\t\t\n\t\tvar graphcanvas = LGraphCanvas.active_canvas;\n\t\tif (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n\t\t\tfApplyMultiNode(node);\n\t\t}else{\n\t\t\tfor (var i in graphcanvas.selected_nodes) {\n\t\t\t\tfApplyMultiNode(graphcanvas.selected_nodes[i]);\n\t\t\t}\n\t\t}\n\t\t\n\t\tnode.graph.afterChange(/*?*/);\n    };\n\n    LGraphCanvas.onMenuNodePin = function(value, options, e, menu, node) {\n        node.pin();\n    };\n\n    LGraphCanvas.onMenuNodeMode = function(value, options, e, menu, node) {\n        new LiteGraph.ContextMenu(\n            LiteGraph.NODE_MODES,\n            { event: e, callback: inner_clicked, parentMenu: menu, node: node }\n        );\n\n        function inner_clicked(v) {\n            if (!node) {\n                return;\n            }\n            var kV = Object.values(LiteGraph.NODE_MODES).indexOf(v);\n            var fApplyMultiNode = function(node){\n\t\t\t\tif (kV>=0 && LiteGraph.NODE_MODES[kV])\n\t\t\t\t\tnode.changeMode(kV);\n\t\t\t\telse{\n\t\t\t\t\tconsole.warn(\"unexpected mode: \"+v);\n\t\t\t\t\tnode.changeMode(LiteGraph.ALWAYS);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tvar graphcanvas = LGraphCanvas.active_canvas;\n\t\t\tif (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n\t\t\t\tfApplyMultiNode(node);\n\t\t\t}else{\n\t\t\t\tfor (var i in graphcanvas.selected_nodes) {\n\t\t\t\t\tfApplyMultiNode(graphcanvas.selected_nodes[i]);\n\t\t\t\t}\n\t\t\t}\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.onMenuNodeColors = function(value, options, e, menu, node) {\n        if (!node) {\n            throw \"no node for color\";\n        }\n\n        var values = [];\n        values.push({\n            value: null,\n            content:\n                \"<span style='display: block; padding-left: 4px;'>No color</span>\"\n        });\n\n        for (var i in LGraphCanvas.node_colors) {\n            var color = LGraphCanvas.node_colors[i];\n            var value = {\n                value: i,\n                content:\n                    \"<span style='display: block; color: #999; padding-left: 4px; border-left: 8px solid \" +\n                    color.color +\n                    \"; background-color:\" +\n                    color.bgcolor +\n                    \"'>\" +\n                    i +\n                    \"</span>\"\n            };\n            values.push(value);\n        }\n        new LiteGraph.ContextMenu(values, {\n            event: e,\n            callback: inner_clicked,\n            parentMenu: menu,\n            node: node\n        });\n\n        function inner_clicked(v) {\n            if (!node) {\n                return;\n            }\n\n            var color = v.value ? LGraphCanvas.node_colors[v.value] : null;\n\t\t\t\n\t\t\tvar fApplyColor = function(node){\n\t\t\t\tif (color) {\n\t\t\t\t\tif (node.constructor === LiteGraph.LGraphGroup) {\n\t\t\t\t\t\tnode.color = color.groupcolor;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnode.color = color.color;\n\t\t\t\t\t\tnode.bgcolor = color.bgcolor;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tdelete node.color;\n\t\t\t\t\tdelete node.bgcolor;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tvar graphcanvas = LGraphCanvas.active_canvas;\n\t\t\tif (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n\t\t\t\tfApplyColor(node);\n\t\t\t}else{\n\t\t\t\tfor (var i in graphcanvas.selected_nodes) {\n\t\t\t\t\tfApplyColor(graphcanvas.selected_nodes[i]);\n\t\t\t\t}\n\t\t\t}\n            node.setDirtyCanvas(true, true);\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.onMenuNodeShapes = function(value, options, e, menu, node) {\n        if (!node) {\n            throw \"no node passed\";\n        }\n\n        new LiteGraph.ContextMenu(LiteGraph.VALID_SHAPES, {\n            event: e,\n            callback: inner_clicked,\n            parentMenu: menu,\n            node: node\n        });\n\n        function inner_clicked(v) {\n            if (!node) {\n                return;\n            }\n\t\t\tnode.graph.beforeChange(/*?*/); //node\n            \n\t\t\tvar fApplyMultiNode = function(node){\n\t\t\t\tnode.shape = v;\n\t\t\t}\n\n\t\t\tvar graphcanvas = LGraphCanvas.active_canvas;\n\t\t\tif (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n\t\t\t\tfApplyMultiNode(node);\n\t\t\t}else{\n\t\t\t\tfor (var i in graphcanvas.selected_nodes) {\n\t\t\t\t\tfApplyMultiNode(graphcanvas.selected_nodes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tnode.graph.afterChange(/*?*/); //node\n            node.setDirtyCanvas(true);\n        }\n\n        return false;\n    };\n\n    LGraphCanvas.onMenuNodeRemove = function(value, options, e, menu, node) {\n        if (!node) {\n            throw \"no node passed\";\n        }\n\n\t\tvar graph = node.graph;\n\t\tgraph.beforeChange();\n        \n\t\t\n\t\tvar fApplyMultiNode = function(node){\n\t\t\tif (node.removable === false) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tgraph.remove(node);\n\t\t}\n\n\t\tvar graphcanvas = LGraphCanvas.active_canvas;\n\t\tif (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n\t\t\tfApplyMultiNode(node);\n\t\t}else{\n\t\t\tfor (var i in graphcanvas.selected_nodes) {\n\t\t\t\tfApplyMultiNode(graphcanvas.selected_nodes[i]);\n\t\t\t}\n\t\t}\n\t\t\n\t\tgraph.afterChange();\n        node.setDirtyCanvas(true, true);\n    };\n\n    LGraphCanvas.onMenuNodeToSubgraph = function(value, options, e, menu, node) {\n\t\tvar graph = node.graph;\n\t\tvar graphcanvas = LGraphCanvas.active_canvas;\n\t\tif(!graphcanvas) //??\n\t\t\treturn;\n\n\t\tvar nodes_list = Object.values( graphcanvas.selected_nodes || {} );\n\t\tif( !nodes_list.length )\n\t\t\tnodes_list = [ node ];\n\n\t\tvar subgraph_node = LiteGraph.createNode(\"graph/subgraph\");\n\t\tsubgraph_node.pos = node.pos.concat();\n\t\tgraph.add(subgraph_node);\n\n\t\tsubgraph_node.buildFromNodes( nodes_list );\n\n\t\tgraphcanvas.deselectAllNodes();\n        node.setDirtyCanvas(true, true);\n    };\n\n    LGraphCanvas.onMenuNodeClone = function(value, options, e, menu, node) {\n        \n\t\tnode.graph.beforeChange();\n        \n\t\tvar newSelected = {};\n\t\t\n\t\tvar fApplyMultiNode = function(node){\n\t\t\tif (node.clonable == false) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar newnode = node.clone();\n\t\t\tif (!newnode) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tnewnode.pos = [node.pos[0] + 5, node.pos[1] + 5];\n\t\t\tnode.graph.add(newnode);\n\t\t\tnewSelected[newnode.id] = newnode;\n\t\t}\n\n\t\tvar graphcanvas = LGraphCanvas.active_canvas;\n\t\tif (!graphcanvas.selected_nodes || Object.keys(graphcanvas.selected_nodes).length <= 1){\n\t\t\tfApplyMultiNode(node);\n\t\t}else{\n\t\t\tfor (var i in graphcanvas.selected_nodes) {\n\t\t\t\tfApplyMultiNode(graphcanvas.selected_nodes[i]);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(Object.keys(newSelected).length){\n\t\t\tgraphcanvas.selectNodes(newSelected);\n\t\t}\n\t\t\n\t\tnode.graph.afterChange();\n\n        node.setDirtyCanvas(true, true);\n    };\n\n    LGraphCanvas.node_colors = {\n        red: { color: \"#322\", bgcolor: \"#533\", groupcolor: \"#A88\" },\n        brown: { color: \"#332922\", bgcolor: \"#593930\", groupcolor: \"#b06634\" },\n        green: { color: \"#232\", bgcolor: \"#353\", groupcolor: \"#8A8\" },\n        blue: { color: \"#223\", bgcolor: \"#335\", groupcolor: \"#88A\" },\n        pale_blue: {\n            color: \"#2a363b\",\n            bgcolor: \"#3f5159\",\n            groupcolor: \"#3f789e\"\n        },\n        cyan: { color: \"#233\", bgcolor: \"#355\", groupcolor: \"#8AA\" },\n        purple: { color: \"#323\", bgcolor: \"#535\", groupcolor: \"#a1309b\" },\n        yellow: { color: \"#432\", bgcolor: \"#653\", groupcolor: \"#b58b2a\" },\n        black: { color: \"#222\", bgcolor: \"#000\", groupcolor: \"#444\" }\n    };\n\n    LGraphCanvas.prototype.getCanvasMenuOptions = function() {\n        var options = null;\n\t\tvar that = this;\n        if (this.getMenuOptions) {\n            options = this.getMenuOptions();\n        } else {\n            options = [\n                {\n                    content: \"Add Node\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuAdd\n                },\n                { content: \"Add Group\", callback: LGraphCanvas.onGroupAdd },\n\t\t\t\t//{ content: \"Arrange\", callback: that.graph.arrange },\n                //{content:\"Collapse All\", callback: LGraphCanvas.onMenuCollapseAll }\n            ];\n            /*if (LiteGraph.showCanvasOptions){\n                options.push({ content: \"Options\", callback: that.showShowGraphOptionsPanel });\n            }*/\n\n            if (this._graph_stack && this._graph_stack.length > 0) {\n                options.push(null, {\n                    content: \"Close subgraph\",\n                    callback: this.closeSubgraph.bind(this)\n                });\n            }\n        }\n\n        if (this.getExtraMenuOptions) {\n            var extra = this.getExtraMenuOptions(this, options);\n            if (extra) {\n                options = options.concat(extra);\n            }\n        }\n\n        return options;\n    };\n\n    //called by processContextMenu to extract the menu list\n    LGraphCanvas.prototype.getNodeMenuOptions = function(node) {\n        var options = null;\n\n        if (node.getMenuOptions) {\n            options = node.getMenuOptions(this);\n        } else {\n            options = [\n                {\n                    content: \"Inputs\",\n                    has_submenu: true,\n                    disabled: true,\n                    callback: LGraphCanvas.showMenuNodeOptionalInputs\n                },\n                {\n                    content: \"Outputs\",\n                    has_submenu: true,\n                    disabled: true,\n                    callback: LGraphCanvas.showMenuNodeOptionalOutputs\n                },\n                null,\n                {\n                    content: \"Properties\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onShowMenuNodeProperties\n                },\n                null,\n                {\n                    content: \"Title\",\n                    callback: LGraphCanvas.onShowPropertyEditor\n                },\n                {\n                    content: \"Mode\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuNodeMode\n                }];\n            if(node.resizable !== false){\n                options.push({\n                    content: \"Resize\", callback: LGraphCanvas.onMenuResizeNode\n                });\n            }\n            options.push(\n                {\n                    content: \"Collapse\",\n                    callback: LGraphCanvas.onMenuNodeCollapse\n                },\n                { content: \"Pin\", callback: LGraphCanvas.onMenuNodePin },\n                {\n                    content: \"Colors\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuNodeColors\n                },\n                {\n                    content: \"Shapes\",\n                    has_submenu: true,\n                    callback: LGraphCanvas.onMenuNodeShapes\n                },\n                null\n            );\n        }\n\n        if (node.onGetInputs) {\n            var inputs = node.onGetInputs();\n            if (inputs && inputs.length) {\n                options[0].disabled = false;\n            }\n        }\n\n        if (node.onGetOutputs) {\n            var outputs = node.onGetOutputs();\n            if (outputs && outputs.length) {\n                options[1].disabled = false;\n            }\n        }\n\n        if (node.getExtraMenuOptions) {\n            var extra = node.getExtraMenuOptions(this, options);\n            if (extra) {\n                extra.push(null);\n                options = extra.concat(options);\n            }\n        }\n\n        if (node.clonable !== false) {\n            options.push({\n                content: \"Clone\",\n                callback: LGraphCanvas.onMenuNodeClone\n            });\n        }\n\n\t\tif(0) //TODO\n\t\toptions.push({\n\t\t\tcontent: \"To Subgraph\",\n\t\t\tcallback: LGraphCanvas.onMenuNodeToSubgraph\n\t\t});\n\n\t\toptions.push(null, {\n\t\t\tcontent: \"Remove\",\n\t\t\tdisabled: !(node.removable !== false && !node.block_delete ),\n\t\t\tcallback: LGraphCanvas.onMenuNodeRemove\n\t\t});\n\n        if (node.graph && node.graph.onGetNodeMenuOptions) {\n            node.graph.onGetNodeMenuOptions(options, node);\n        }\n\n        return options;\n    };\n\n    LGraphCanvas.prototype.getGroupMenuOptions = function(node) {\n        var o = [\n            { content: \"Title\", callback: LGraphCanvas.onShowPropertyEditor },\n            {\n                content: \"Color\",\n                has_submenu: true,\n                callback: LGraphCanvas.onMenuNodeColors\n            },\n            {\n                content: \"Font size\",\n                property: \"font_size\",\n                type: \"Number\",\n                callback: LGraphCanvas.onShowPropertyEditor\n            },\n            null,\n            { content: \"Remove\", callback: LGraphCanvas.onMenuNodeRemove }\n        ];\n\n        return o;\n    };\n\n    LGraphCanvas.prototype.processContextMenu = function(node, event) {\n        var that = this;\n        var canvas = LGraphCanvas.active_canvas;\n        var ref_window = canvas.getCanvasWindow();\n\n        var menu_info = null;\n        var options = {\n            event: event,\n            callback: inner_option_clicked,\n            extra: node\n        };\n\n\t\tif(node)\n\t\t\toptions.title = node.type;\n\n        //check if mouse is in input\n        var slot = null;\n        if (node) {\n            slot = node.getSlotInPosition(event.canvasX, event.canvasY);\n            LGraphCanvas.active_node = node;\n        }\n\n        if (slot) {\n            //on slot\n            menu_info = [];\n            if (node.getSlotMenuOptions) {\n                menu_info = node.getSlotMenuOptions(slot);\n            } else {\n                if (\n                    slot &&\n                    slot.output &&\n                    slot.output.links &&\n                    slot.output.links.length\n                ) {\n                    menu_info.push({ content: \"Disconnect Links\", slot: slot });\n                }\n                var _slot = slot.input || slot.output;\n                if (_slot.removable){\n                \tmenu_info.push(\n\t                    _slot.locked\n\t                        ? \"Cannot remove\"\n\t                        : { content: \"Remove Slot\", slot: slot }\n\t                );\n            \t}\n                if (!_slot.nameLocked){\n\t                menu_info.push({ content: \"Rename Slot\", slot: slot });\n                }\n    \n            }\n            options.title =\n                (slot.input ? slot.input.type : slot.output.type) || \"*\";\n            if (slot.input && slot.input.type == LiteGraph.ACTION) {\n                options.title = \"Action\";\n            }\n            if (slot.output && slot.output.type == LiteGraph.EVENT) {\n                options.title = \"Event\";\n            }\n        } else {\n            if (node) {\n                //on node\n                menu_info = this.getNodeMenuOptions(node);\n            } else {\n                menu_info = this.getCanvasMenuOptions();\n                var group = this.graph.getGroupOnPos(\n                    event.canvasX,\n                    event.canvasY\n                );\n                if (group) {\n                    //on group\n                    menu_info.push(null, {\n                        content: \"Edit Group\",\n                        has_submenu: true,\n                        submenu: {\n                            title: \"Group\",\n                            extra: group,\n                            options: this.getGroupMenuOptions(group)\n                        }\n                    });\n                }\n            }\n        }\n\n        //show menu\n        if (!menu_info) {\n            return;\n        }\n\n        var menu = new LiteGraph.ContextMenu(menu_info, options, ref_window);\n\n        function inner_option_clicked(v, options, e) {\n            if (!v) {\n                return;\n            }\n\n            if (v.content == \"Remove Slot\") {\n                var info = v.slot;\n                node.graph.beforeChange();\n                if (info.input) {\n                    node.removeInput(info.slot);\n                } else if (info.output) {\n                    node.removeOutput(info.slot);\n                }\n                node.graph.afterChange();\n                return;\n            } else if (v.content == \"Disconnect Links\") {\n                var info = v.slot;\n                node.graph.beforeChange();\n                if (info.output) {\n                    node.disconnectOutput(info.slot);\n                } else if (info.input) {\n                    node.disconnectInput(info.slot);\n                }\n                node.graph.afterChange();\n                return;\n            } else if (v.content == \"Rename Slot\") {\n                var info = v.slot;\n                var slot_info = info.input\n                    ? node.getInputInfo(info.slot)\n                    : node.getOutputInfo(info.slot);\n                var dialog = that.createDialog(\n                    \"<span class='name'>Name</span><input autofocus type='text'/><button>OK</button>\",\n                    options\n                );\n                var input = dialog.querySelector(\"input\");\n                if (input && slot_info) {\n                    input.value = slot_info.label || \"\";\n                }\n                var inner = function(){\n                \tnode.graph.beforeChange();\n                    if (input.value) {\n                        if (slot_info) {\n                            slot_info.label = input.value;\n                        }\n                        that.setDirty(true);\n                    }\n                    dialog.close();\n                    node.graph.afterChange();\n                }\n                dialog.querySelector(\"button\").addEventListener(\"click\", inner);\n                input.addEventListener(\"keydown\", function(e) {\n                    dialog.is_modified = true;\n                    if (e.keyCode == 27) {\n                        //ESC\n                        dialog.close();\n                    } else if (e.keyCode == 13) {\n                        inner(); // save\n                    } else if (e.keyCode != 13 && e.target.localName != \"textarea\") {\n                        return;\n                    }\n                    e.preventDefault();\n                    e.stopPropagation();\n                });\n                input.focus();\n            }\n\n            //if(v.callback)\n            //\treturn v.callback.call(that, node, options, e, menu, that, event );\n        }\n    };\n\n    //API *************************************************\n    //like rect but rounded corners\n    if (typeof(window) != \"undefined\" && window.CanvasRenderingContext2D && !window.CanvasRenderingContext2D.prototype.roundRect) {\n        window.CanvasRenderingContext2D.prototype.roundRect = function(\n\t\tx,\n\t\ty,\n\t\tw,\n\t\th,\n\t\tradius,\n\t\tradius_low\n\t) {\n\t\tvar top_left_radius = 0;\n\t\tvar top_right_radius = 0;\n\t\tvar bottom_left_radius = 0;\n\t\tvar bottom_right_radius = 0;\n\n\t\tif ( radius === 0 )\n\t\t{\n\t\t\tthis.rect(x,y,w,h);\n\t\t\treturn;\n\t\t}\n\n\t\tif(radius_low === undefined)\n\t\t\tradius_low = radius;\n\n\t\t//make it compatible with official one\n\t\tif(radius != null && radius.constructor === Array)\n\t\t{\n\t\t\tif(radius.length == 1)\n\t\t\t\ttop_left_radius = top_right_radius = bottom_left_radius = bottom_right_radius = radius[0];\n\t\t\telse if(radius.length == 2)\n\t\t\t{\n\t\t\t\ttop_left_radius = bottom_right_radius = radius[0];\n\t\t\t\ttop_right_radius = bottom_left_radius = radius[1];\n\t\t\t}\n\t\t\telse if(radius.length == 4)\n\t\t\t{\n\t\t\t\ttop_left_radius = radius[0];\n\t\t\t\ttop_right_radius = radius[1];\n\t\t\t\tbottom_left_radius = radius[2];\n\t\t\t\tbottom_right_radius = radius[3];\n\t\t\t}\n\t\t\telse\n\t\t\t\treturn;\n\t\t}\n\t\telse //old using numbers\n\t\t{\n\t\t\ttop_left_radius = radius || 0;\n\t\t\ttop_right_radius = radius || 0;\n\t\t\tbottom_left_radius = radius_low || 0;\n\t\t\tbottom_right_radius = radius_low || 0;\n\t\t}\n\n\t\t//top right\n\t\tthis.moveTo(x + top_left_radius, y);\n\t\tthis.lineTo(x + w - top_right_radius, y);\n\t\tthis.quadraticCurveTo(x + w, y, x + w, y + top_right_radius);\n\n\t\t//bottom right\n\t\tthis.lineTo(x + w, y + h - bottom_right_radius);\n\t\tthis.quadraticCurveTo(\n\t\t\tx + w,\n\t\t\ty + h,\n\t\t\tx + w - bottom_right_radius,\n\t\t\ty + h\n\t\t);\n\n\t\t//bottom left\n\t\tthis.lineTo(x + bottom_right_radius, y + h);\n\t\tthis.quadraticCurveTo(x, y + h, x, y + h - bottom_left_radius);\n\n\t\t//top left\n\t\tthis.lineTo(x, y + bottom_left_radius);\n\t\tthis.quadraticCurveTo(x, y, x + top_left_radius, y);\n\t};\n\t}//if\n\n    function compareObjects(a, b) {\n        for (var i in a) {\n            if (a[i] != b[i]) {\n                return false;\n            }\n        }\n        return true;\n    }\n    LiteGraph.compareObjects = compareObjects;\n\n    function distance(a, b) {\n        return Math.sqrt(\n            (b[0] - a[0]) * (b[0] - a[0]) + (b[1] - a[1]) * (b[1] - a[1])\n        );\n    }\n    LiteGraph.distance = distance;\n\n    function colorToString(c) {\n        return (\n            \"rgba(\" +\n            Math.round(c[0] * 255).toFixed() +\n            \",\" +\n            Math.round(c[1] * 255).toFixed() +\n            \",\" +\n            Math.round(c[2] * 255).toFixed() +\n            \",\" +\n            (c.length == 4 ? c[3].toFixed(2) : \"1.0\") +\n            \")\"\n        );\n    }\n    LiteGraph.colorToString = colorToString;\n\n    function isInsideRectangle(x, y, left, top, width, height) {\n        if (left < x && left + width > x && top < y && top + height > y) {\n            return true;\n        }\n        return false;\n    }\n    LiteGraph.isInsideRectangle = isInsideRectangle;\n\n    //[minx,miny,maxx,maxy]\n    function growBounding(bounding, x, y) {\n        if (x < bounding[0]) {\n            bounding[0] = x;\n        } else if (x > bounding[2]) {\n            bounding[2] = x;\n        }\n\n        if (y < bounding[1]) {\n            bounding[1] = y;\n        } else if (y > bounding[3]) {\n            bounding[3] = y;\n        }\n    }\n    LiteGraph.growBounding = growBounding;\n\n    //point inside bounding box\n    function isInsideBounding(p, bb) {\n        if (\n            p[0] < bb[0][0] ||\n            p[1] < bb[0][1] ||\n            p[0] > bb[1][0] ||\n            p[1] > bb[1][1]\n        ) {\n            return false;\n        }\n        return true;\n    }\n    LiteGraph.isInsideBounding = isInsideBounding;\n\n    //bounding overlap, format: [ startx, starty, width, height ]\n    function overlapBounding(a, b) {\n        var A_end_x = a[0] + a[2];\n        var A_end_y = a[1] + a[3];\n        var B_end_x = b[0] + b[2];\n        var B_end_y = b[1] + b[3];\n\n        if (\n            a[0] > B_end_x ||\n            a[1] > B_end_y ||\n            A_end_x < b[0] ||\n            A_end_y < b[1]\n        ) {\n            return false;\n        }\n        return true;\n    }\n    LiteGraph.overlapBounding = overlapBounding;\n\n    //Convert a hex value to its decimal value - the inputted hex must be in the\n    //\tformat of a hex triplet - the kind we use for HTML colours. The function\n    //\twill return an array with three values.\n    function hex2num(hex) {\n        if (hex.charAt(0) == \"#\") {\n            hex = hex.slice(1);\n        } //Remove the '#' char - if there is one.\n        hex = hex.toUpperCase();\n        var hex_alphabets = \"0123456789ABCDEF\";\n        var value = new Array(3);\n        var k = 0;\n        var int1, int2;\n        for (var i = 0; i < 6; i += 2) {\n            int1 = hex_alphabets.indexOf(hex.charAt(i));\n            int2 = hex_alphabets.indexOf(hex.charAt(i + 1));\n            value[k] = int1 * 16 + int2;\n            k++;\n        }\n        return value;\n    }\n\n    LiteGraph.hex2num = hex2num;\n\n    //Give a array with three values as the argument and the function will return\n    //\tthe corresponding hex triplet.\n    function num2hex(triplet) {\n        var hex_alphabets = \"0123456789ABCDEF\";\n        var hex = \"#\";\n        var int1, int2;\n        for (var i = 0; i < 3; i++) {\n            int1 = triplet[i] / 16;\n            int2 = triplet[i] % 16;\n\n            hex += hex_alphabets.charAt(int1) + hex_alphabets.charAt(int2);\n        }\n        return hex;\n    }\n\n    LiteGraph.num2hex = num2hex;\n\n    /* LiteGraph GUI elements used for canvas editing *************************************/\n\n    /**\n     * ContextMenu from LiteGUI\n     *\n     * @class ContextMenu\n     * @constructor\n     * @param {Array} values (allows object { title: \"Nice text\", callback: function ... })\n     * @param {Object} options [optional] Some options:\\\n     * - title: title to show on top of the menu\n     * - callback: function to call when an option is clicked, it receives the item information\n     * - ignore_item_callbacks: ignores the callback inside the item, it just calls the options.callback\n     * - event: you can pass a MouseEvent, this way the ContextMenu appears in that position\n     */\n    function ContextMenu(values, options) {\n        options = options || {};\n        this.options = options;\n        var that = this;\n\n        //to link a menu with its parent\n        if (options.parentMenu) {\n            if (options.parentMenu.constructor !== this.constructor) {\n                console.error(\n                    \"parentMenu must be of class ContextMenu, ignoring it\"\n                );\n                options.parentMenu = null;\n            } else {\n                this.parentMenu = options.parentMenu;\n                this.parentMenu.lock = true;\n                this.parentMenu.current_submenu = this;\n            }\n        }\n\n\t\tvar eventClass = null;\n\t\tif(options.event) //use strings because comparing classes between windows doesnt work\n\t\t\teventClass = options.event.constructor.name;\n        if ( eventClass !== \"MouseEvent\" &&\n            eventClass !== \"CustomEvent\" &&\n\t\t\teventClass !== \"PointerEvent\"\n        ) {\n            console.error(\n                \"Event passed to ContextMenu is not of type MouseEvent or CustomEvent. Ignoring it. (\"+eventClass+\")\"\n            );\n            options.event = null;\n        }\n\n        var root = document.createElement(\"div\");\n        root.className = \"litegraph litecontextmenu litemenubar-panel\";\n        if (options.className) {\n            root.className += \" \" + options.className;\n        }\n        root.style.minWidth = 100;\n        root.style.minHeight = 100;\n        root.style.pointerEvents = \"none\";\n        setTimeout(function() {\n            root.style.pointerEvents = \"auto\";\n        }, 100); //delay so the mouse up event is not caught by this element\n\n        //this prevents the default context browser menu to open in case this menu was created when pressing right button\n\t\tLiteGraph.pointerListenerAdd(root,\"up\",\n            function(e) {\n\t\t\t  \t//console.log(\"pointerevents: ContextMenu up root prevent\");\n                e.preventDefault();\n                return true;\n            },\n            true\n        );\n        root.addEventListener(\n            \"contextmenu\",\n            function(e) {\n                if (e.button != 2) {\n                    //right button\n                    return false;\n                }\n                e.preventDefault();\n                return false;\n            },\n            true\n        );\n\n        LiteGraph.pointerListenerAdd(root,\"down\",\n            function(e) {\n\t\t\t  \t//console.log(\"pointerevents: ContextMenu down\");\n                if (e.button == 2) {\n                    that.close();\n                    e.preventDefault();\n                    return true;\n                }\n            },\n            true\n        );\n\n        function on_mouse_wheel(e) {\n            var pos = parseInt(root.style.top);\n            root.style.top =\n                (pos + e.deltaY * options.scroll_speed).toFixed() + \"px\";\n            e.preventDefault();\n            return true;\n        }\n\n        if (!options.scroll_speed) {\n            options.scroll_speed = 0.1;\n        }\n\n        root.addEventListener(\"wheel\", on_mouse_wheel, true);\n        root.addEventListener(\"mousewheel\", on_mouse_wheel, true);\n\n        this.root = root;\n\n        //title\n        if (options.title) {\n            var element = document.createElement(\"div\");\n            element.className = \"litemenu-title\";\n            element.innerHTML = options.title;\n            root.appendChild(element);\n        }\n\n        //entries\n        var num = 0;\n        for (var i=0; i < values.length; i++) {\n            var name = values.constructor == Array ? values[i] : i;\n            if (name != null && name.constructor !== String) {\n                name = name.content === undefined ? String(name) : name.content;\n            }\n            var value = values[i];\n            this.addItem(name, value, options);\n            num++;\n        }\n\n        //close on leave? touch enabled devices won't work TODO use a global device detector and condition on that\n        /*LiteGraph.pointerListenerAdd(root,\"leave\", function(e) {\n\t\t  \tconsole.log(\"pointerevents: ContextMenu leave\");\n            if (that.lock) {\n                return;\n            }\n            if (root.closing_timer) {\n                clearTimeout(root.closing_timer);\n            }\n            root.closing_timer = setTimeout(that.close.bind(that, e), 500);\n            //that.close(e);\n        });*/\n\n\t\tLiteGraph.pointerListenerAdd(root,\"enter\", function(e) {\n\t\t  \t//console.log(\"pointerevents: ContextMenu enter\");\n            if (root.closing_timer) {\n                clearTimeout(root.closing_timer);\n            }\n        });\n\n        //insert before checking position\n        var root_document = document;\n        if (options.event) {\n            root_document = options.event.target.ownerDocument;\n        }\n\n        if (!root_document) {\n            root_document = document;\n        }\n\n\t\tif( root_document.fullscreenElement )\n\t        root_document.fullscreenElement.appendChild(root);\n\t\telse\n\t\t    root_document.body.appendChild(root);\n\n        //compute best position\n        var left = options.left || 0;\n        var top = options.top || 0;\n        if (options.event) {\n            left = options.event.clientX - 10;\n            top = options.event.clientY - 10;\n            if (options.title) {\n                top -= 20;\n            }\n\n            if (options.parentMenu) {\n                var rect = options.parentMenu.root.getBoundingClientRect();\n                left = rect.left + rect.width;\n            }\n\n            var body_rect = document.body.getBoundingClientRect();\n            var root_rect = root.getBoundingClientRect();\n\t\t\tif(body_rect.height == 0)\n\t\t\t\tconsole.error(\"document.body height is 0. That is dangerous, set html,body { height: 100%; }\");\n\n            if (body_rect.width && left > body_rect.width - root_rect.width - 10) {\n                left = body_rect.width - root_rect.width - 10;\n            }\n            if (body_rect.height && top > body_rect.height - root_rect.height - 10) {\n                top = body_rect.height - root_rect.height - 10;\n            }\n        }\n\n        root.style.left = left + \"px\";\n        root.style.top = top + \"px\";\n\n        if (options.scale) {\n            root.style.transform = \"scale(\" + options.scale + \")\";\n        }\n    }\n\n    ContextMenu.prototype.addItem = function(name, value, options) {\n        var that = this;\n        options = options || {};\n\n        var element = document.createElement(\"div\");\n        element.className = \"litemenu-entry submenu\";\n\n        var disabled = false;\n\n        if (value === null) {\n            element.classList.add(\"separator\");\n            //element.innerHTML = \"<hr/>\"\n            //continue;\n        } else {\n            element.innerHTML = value && value.title ? value.title : name;\n            element.value = value;\n\n            if (value) {\n                if (value.disabled) {\n                    disabled = true;\n                    element.classList.add(\"disabled\");\n                }\n                if (value.submenu || value.has_submenu) {\n                    element.classList.add(\"has_submenu\");\n                }\n            }\n\n            if (typeof value == \"function\") {\n                element.dataset[\"value\"] = name;\n                element.onclick_callback = value;\n            } else {\n                element.dataset[\"value\"] = value;\n            }\n\n            if (value.className) {\n                element.className += \" \" + value.className;\n            }\n        }\n\n        this.root.appendChild(element);\n        if (!disabled) {\n            element.addEventListener(\"click\", inner_onclick);\n        }\n        if (options.autoopen) {\n\t\t\tLiteGraph.pointerListenerAdd(element,\"enter\",inner_over);\n        }\n\n        function inner_over(e) {\n            var value = this.value;\n            if (!value || !value.has_submenu) {\n                return;\n            }\n            //if it is a submenu, autoopen like the item was clicked\n            inner_onclick.call(this, e);\n        }\n\n        //menu option clicked\n        function inner_onclick(e) {\n            var value = this.value;\n            var close_parent = true;\n\n            if (that.current_submenu) {\n                that.current_submenu.close(e);\n            }\n\n            //global callback\n            if (options.callback) {\n                var r = options.callback.call(\n                    this,\n                    value,\n                    options,\n                    e,\n                    that,\n                    options.node\n                );\n                if (r === true) {\n                    close_parent = false;\n                }\n            }\n\n            //special cases\n            if (value) {\n                if (\n                    value.callback &&\n                    !options.ignore_item_callbacks &&\n                    value.disabled !== true\n                ) {\n                    //item callback\n                    var r = value.callback.call(\n                        this,\n                        value,\n                        options,\n                        e,\n                        that,\n                        options.extra\n                    );\n                    if (r === true) {\n                        close_parent = false;\n                    }\n                }\n                if (value.submenu) {\n                    if (!value.submenu.options) {\n                        throw \"ContextMenu submenu needs options\";\n                    }\n                    var submenu = new that.constructor(value.submenu.options, {\n                        callback: value.submenu.callback,\n                        event: e,\n                        parentMenu: that,\n                        ignore_item_callbacks:\n                            value.submenu.ignore_item_callbacks,\n                        title: value.submenu.title,\n                        extra: value.submenu.extra,\n                        autoopen: options.autoopen\n                    });\n                    close_parent = false;\n                }\n            }\n\n            if (close_parent && !that.lock) {\n                that.close();\n            }\n        }\n\n        return element;\n    };\n\n    ContextMenu.prototype.close = function(e, ignore_parent_menu) {\n        if (this.root.parentNode) {\n            this.root.parentNode.removeChild(this.root);\n        }\n        if (this.parentMenu && !ignore_parent_menu) {\n            this.parentMenu.lock = false;\n            this.parentMenu.current_submenu = null;\n            if (e === undefined) {\n                this.parentMenu.close();\n            } else if (\n                e &&\n                !ContextMenu.isCursorOverElement(e, this.parentMenu.root)\n            ) {\n                ContextMenu.trigger(this.parentMenu.root, LiteGraph.pointerevents_method+\"leave\", e);\n            }\n        }\n        if (this.current_submenu) {\n            this.current_submenu.close(e, true);\n        }\n\n        if (this.root.closing_timer) {\n            clearTimeout(this.root.closing_timer);\n        }\n        \n        // TODO implement : LiteGraph.contextMenuClosed(); :: keep track of opened / closed / current ContextMenu\n        // on key press, allow filtering/selecting the context menu elements\n    };\n\n    //this code is used to trigger events easily (used in the context menu mouseleave\n    ContextMenu.trigger = function(element, event_name, params, origin) {\n        var evt = document.createEvent(\"CustomEvent\");\n        evt.initCustomEvent(event_name, true, true, params); //canBubble, cancelable, detail\n        evt.srcElement = origin;\n        if (element.dispatchEvent) {\n            element.dispatchEvent(evt);\n        } else if (element.__events) {\n            element.__events.dispatchEvent(evt);\n        }\n        //else nothing seems binded here so nothing to do\n        return evt;\n    };\n\n    //returns the top most menu\n    ContextMenu.prototype.getTopMenu = function() {\n        if (this.options.parentMenu) {\n            return this.options.parentMenu.getTopMenu();\n        }\n        return this;\n    };\n\n    ContextMenu.prototype.getFirstEvent = function() {\n        if (this.options.parentMenu) {\n            return this.options.parentMenu.getFirstEvent();\n        }\n        return this.options.event;\n    };\n\n    ContextMenu.isCursorOverElement = function(event, element) {\n        var left = event.clientX;\n        var top = event.clientY;\n        var rect = element.getBoundingClientRect();\n        if (!rect) {\n            return false;\n        }\n        if (\n            top > rect.top &&\n            top < rect.top + rect.height &&\n            left > rect.left &&\n            left < rect.left + rect.width\n        ) {\n            return true;\n        }\n        return false;\n    };\n\n    LiteGraph.ContextMenu = ContextMenu;\n\n    LiteGraph.closeAllContextMenus = function(ref_window) {\n        ref_window = ref_window || window;\n\n        var elements = ref_window.document.querySelectorAll(\".litecontextmenu\");\n        if (!elements.length) {\n            return;\n        }\n\n        var result = [];\n        for (var i = 0; i < elements.length; i++) {\n            result.push(elements[i]);\n        }\n\n        for (var i=0; i < result.length; i++) {\n            if (result[i].close) {\n                result[i].close();\n            } else if (result[i].parentNode) {\n                result[i].parentNode.removeChild(result[i]);\n            }\n        }\n    };\n\n    LiteGraph.extendClass = function(target, origin) {\n        for (var i in origin) {\n            //copy class properties\n            if (target.hasOwnProperty(i)) {\n                continue;\n            }\n            target[i] = origin[i];\n        }\n\n        if (origin.prototype) {\n            //copy prototype properties\n            for (var i in origin.prototype) {\n                //only enumerable\n                if (!origin.prototype.hasOwnProperty(i)) {\n                    continue;\n                }\n\n                if (target.prototype.hasOwnProperty(i)) {\n                    //avoid overwriting existing ones\n                    continue;\n                }\n\n                //copy getters\n                if (origin.prototype.__lookupGetter__(i)) {\n                    target.prototype.__defineGetter__(\n                        i,\n                        origin.prototype.__lookupGetter__(i)\n                    );\n                } else {\n                    target.prototype[i] = origin.prototype[i];\n                }\n\n                //and setters\n                if (origin.prototype.__lookupSetter__(i)) {\n                    target.prototype.__defineSetter__(\n                        i,\n                        origin.prototype.__lookupSetter__(i)\n                    );\n                }\n            }\n        }\n    };\n\n\t//used by some widgets to render a curve editor\n\tfunction CurveEditor( points )\n\t{\n\t\tthis.points = points;\n\t\tthis.selected = -1;\n\t\tthis.nearest = -1;\n\t\tthis.size = null; //stores last size used\n\t\tthis.must_update = true;\n\t\tthis.margin = 5;\n\t}\n\n\tCurveEditor.sampleCurve = function(f,points)\n\t{\n\t\tif(!points)\n\t\t\treturn;\n\t\tfor(var i = 0; i < points.length - 1; ++i)\n\t\t{\n\t\t\tvar p = points[i];\n\t\t\tvar pn = points[i+1];\n\t\t\tif(pn[0] < f)\n\t\t\t\tcontinue;\n\t\t\tvar r = (pn[0] - p[0]);\n\t\t\tif( Math.abs(r) < 0.00001 )\n\t\t\t\treturn p[1];\n\t\t\tvar local_f = (f - p[0]) / r;\n\t\t\treturn p[1] * (1.0 - local_f) + pn[1] * local_f;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tCurveEditor.prototype.draw = function( ctx, size, graphcanvas, background_color, line_color, inactive )\n\t{\n\t\tvar points = this.points;\n\t\tif(!points)\n\t\t\treturn;\n\t\tthis.size = size;\n\t\tvar w = size[0] - this.margin * 2;\n\t\tvar h = size[1] - this.margin * 2;\n\n\t\tline_color = line_color || \"#666\";\n\n\t\tctx.save();\n\t\tctx.translate(this.margin,this.margin);\n\n\t\tif(background_color)\n\t\t{\n\t\t\tctx.fillStyle = \"#111\";\n\t\t\tctx.fillRect(0,0,w,h);\n\t\t\tctx.fillStyle = \"#222\";\n\t\t\tctx.fillRect(w*0.5,0,1,h);\n\t\t\tctx.strokeStyle = \"#333\";\n\t\t\tctx.strokeRect(0,0,w,h);\n\t\t}\n\t\tctx.strokeStyle = line_color;\n\t\tif(inactive)\n\t\t\tctx.globalAlpha = 0.5;\n\t\tctx.beginPath();\n\t\tfor(var i = 0; i < points.length; ++i)\n\t\t{\n\t\t\tvar p = points[i];\n\t\t\tctx.lineTo( p[0] * w, (1.0 - p[1]) * h );\n\t\t}\n\t\tctx.stroke();\n\t\tctx.globalAlpha = 1;\n\t\tif(!inactive)\n\t\t\tfor(var i = 0; i < points.length; ++i)\n\t\t\t{\n\t\t\t\tvar p = points[i];\n\t\t\t\tctx.fillStyle = this.selected == i ? \"#FFF\" : (this.nearest == i ? \"#DDD\" : \"#AAA\");\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.arc( p[0] * w, (1.0 - p[1]) * h, 2, 0, Math.PI * 2 );\n\t\t\t\tctx.fill();\n\t\t\t}\n\t\tctx.restore();\n\t}\n\n\t//localpos is mouse in curve editor space\n\tCurveEditor.prototype.onMouseDown = function( localpos, graphcanvas )\n\t{\n\t\tvar points = this.points;\n\t\tif(!points)\n\t\t\treturn;\n\t\tif( localpos[1] < 0 )\n\t\t\treturn;\n\n\t\t//this.captureInput(true);\n\t\tvar w = this.size[0] - this.margin * 2;\n\t\tvar h = this.size[1] - this.margin * 2;\n\t\tvar x = localpos[0] - this.margin;\n\t\tvar y = localpos[1] - this.margin;\n\t\tvar pos = [x,y];\n\t\tvar max_dist = 30 / graphcanvas.ds.scale;\n\t\t//search closer one\n\t\tthis.selected = this.getCloserPoint(pos, max_dist);\n\t\t//create one\n\t\tif(this.selected == -1)\n\t\t{\n\t\t\tvar point = [x / w, 1 - y / h];\n\t\t\tpoints.push(point);\n\t\t\tpoints.sort(function(a,b){ return a[0] - b[0]; });\n\t\t\tthis.selected = points.indexOf(point);\n\t\t\tthis.must_update = true;\n\t\t}\n\t\tif(this.selected != -1)\n\t\t\treturn true;\n\t}\n\n\tCurveEditor.prototype.onMouseMove = function( localpos, graphcanvas )\n\t{\n\t\tvar points = this.points;\n\t\tif(!points)\n\t\t\treturn;\n\t\tvar s = this.selected;\n\t\tif(s < 0)\n\t\t\treturn;\n\t\tvar x = (localpos[0] - this.margin) / (this.size[0] - this.margin * 2 );\n\t\tvar y = (localpos[1] - this.margin) / (this.size[1] - this.margin * 2 );\n\t\tvar curvepos = [(localpos[0] - this.margin),(localpos[1] - this.margin)];\n\t\tvar max_dist = 30 / graphcanvas.ds.scale;\n\t\tthis._nearest = this.getCloserPoint(curvepos, max_dist);\n\t\tvar point = points[s];\n\t\tif(point)\n\t\t{\n\t\t\tvar is_edge_point = s == 0 || s == points.length - 1;\n\t\t\tif( !is_edge_point && (localpos[0] < -10 || localpos[0] > this.size[0] + 10 || localpos[1] < -10 || localpos[1] > this.size[1] + 10) )\n\t\t\t{\n\t\t\t\tpoints.splice(s,1);\n\t\t\t\tthis.selected = -1;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif( !is_edge_point ) //not edges\n\t\t\t\tpoint[0] = Math.clamp(x,0,1);\n\t\t\telse\n\t\t\t\tpoint[0] = s == 0 ? 0 : 1;\n\t\t\tpoint[1] = 1.0 - Math.clamp(y,0,1);\n\t\t\tpoints.sort(function(a,b){ return a[0] - b[0]; });\n\t\t\tthis.selected = points.indexOf(point);\n\t\t\tthis.must_update = true;\n\t\t}\n\t}\n\n\tCurveEditor.prototype.onMouseUp = function( localpos, graphcanvas )\n\t{\n\t\tthis.selected = -1;\n\t\treturn false;\n\t}\n\n\tCurveEditor.prototype.getCloserPoint = function(pos, max_dist)\n\t{\n\t\tvar points = this.points;\n\t\tif(!points)\n\t\t\treturn -1;\n\t\tmax_dist = max_dist || 30;\n\t\tvar w = (this.size[0] - this.margin * 2);\n\t\tvar h = (this.size[1] - this.margin * 2);\n\t\tvar num = points.length;\n\t\tvar p2 = [0,0];\n\t\tvar min_dist = 1000000;\n\t\tvar closest = -1;\n\t\tvar last_valid = -1;\n\t\tfor(var i = 0; i < num; ++i)\n\t\t{\n\t\t\tvar p = points[i];\n\t\t\tp2[0] = p[0] * w;\n\t\t\tp2[1] = (1.0 - p[1]) * h;\n\t\t\tif(p2[0] < pos[0])\n\t\t\t\tlast_valid = i;\n\t\t\tvar dist = vec2.distance(pos,p2);\n\t\t\tif(dist > min_dist || dist > max_dist)\n\t\t\t\tcontinue;\n\t\t\tclosest = i;\n\t\t\tmin_dist = dist;\n\t\t}\n\t\treturn closest;\n\t}\n\n\tLiteGraph.CurveEditor = CurveEditor;\n\n    //used to create nodes from wrapping functions\n    LiteGraph.getParameterNames = function(func) {\n        return (func + \"\")\n            .replace(/[/][/].*$/gm, \"\") // strip single-line comments\n            .replace(/\\s+/g, \"\") // strip white space\n            .replace(/[/][*][^/*]*[*][/]/g, \"\") // strip multi-line comments  /**/\n            .split(\"){\", 1)[0]\n            .replace(/^[^(]*[(]/, \"\") // extract the parameters\n            .replace(/=[^,]+/g, \"\") // strip any ES6 defaults\n            .split(\",\")\n            .filter(Boolean); // split & filter [\"\"]\n    };\n\n\t/* helper for interaction: pointer, touch, mouse Listeners\n\tused by LGraphCanvas DragAndScale ContextMenu*/\n\tLiteGraph.pointerListenerAdd = function(oDOM, sEvIn, fCall, capture=false) {\n\t\tif (!oDOM || !oDOM.addEventListener || !sEvIn || typeof fCall!==\"function\"){\n\t\t\t//console.log(\"cant pointerListenerAdd \"+oDOM+\", \"+sEvent+\", \"+fCall);\n\t\t\treturn; // -- break --\n\t\t}\n\t\t\n\t\tvar sMethod = LiteGraph.pointerevents_method;\n\t\tvar sEvent = sEvIn;\n\t\t\n\t\t// UNDER CONSTRUCTION\n\t\t// convert pointerevents to touch event when not available\n\t\tif (sMethod==\"pointer\" && !window.PointerEvent){ \n\t\t\tconsole.warn(\"sMethod=='pointer' && !window.PointerEvent\");\n\t\t\tconsole.log(\"Converting pointer[\"+sEvent+\"] : down move up cancel enter TO touchstart touchmove touchend, etc ..\");\n\t\t\tswitch(sEvent){\n\t\t\t\tcase \"down\":{\n\t\t\t\t\tsMethod = \"touch\";\n\t\t\t\t\tsEvent = \"start\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"move\":{\n\t\t\t\t\tsMethod = \"touch\";\n\t\t\t\t\t//sEvent = \"move\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"up\":{\n\t\t\t\t\tsMethod = \"touch\";\n\t\t\t\t\tsEvent = \"end\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"cancel\":{\n\t\t\t\t\tsMethod = \"touch\";\n\t\t\t\t\t//sEvent = \"cancel\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"enter\":{\n\t\t\t\t\tconsole.log(\"debug: Should I send a move event?\"); // ???\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t// case \"over\": case \"out\": not used at now\n\t\t\t\tdefault:{\n\t\t\t\t\tconsole.warn(\"PointerEvent not available in this browser ? The event \"+sEvent+\" would not be called\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tswitch(sEvent){\n\t\t\t//both pointer and move events\n\t\t\tcase \"down\": case \"up\": case \"move\": case \"over\": case \"out\": case \"enter\":\n\t\t\t{\n\t\t\t\toDOM.addEventListener(sMethod+sEvent, fCall, capture);\n\t\t\t}\n\t\t\t// only pointerevents\n\t\t\tcase \"leave\": case \"cancel\": case \"gotpointercapture\": case \"lostpointercapture\":\n\t\t\t{\n\t\t\t\tif (sMethod!=\"mouse\"){\n\t\t\t\t\treturn oDOM.addEventListener(sMethod+sEvent, fCall, capture);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// not \"pointer\" || \"mouse\"\n\t\t\tdefault:\n\t\t\t\treturn oDOM.addEventListener(sEvent, fCall, capture);\n\t\t}\n\t}\n\tLiteGraph.pointerListenerRemove = function(oDOM, sEvent, fCall, capture=false) {\n\t\tif (!oDOM || !oDOM.removeEventListener || !sEvent || typeof fCall!==\"function\"){\n\t\t\t//console.log(\"cant pointerListenerRemove \"+oDOM+\", \"+sEvent+\", \"+fCall);\n\t\t\treturn; // -- break --\n\t\t}\n\t\tswitch(sEvent){\n\t\t\t//both pointer and move events\n\t\t\tcase \"down\": case \"up\": case \"move\": case \"over\": case \"out\": case \"enter\":\n\t\t\t{\n\t\t\t\tif (LiteGraph.pointerevents_method==\"pointer\" || LiteGraph.pointerevents_method==\"mouse\"){\n\t\t\t\t\toDOM.removeEventListener(LiteGraph.pointerevents_method+sEvent, fCall, capture);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// only pointerevents\n\t\t\tcase \"leave\": case \"cancel\": case \"gotpointercapture\": case \"lostpointercapture\":\n\t\t\t{\n\t\t\t\tif (LiteGraph.pointerevents_method==\"pointer\"){\n\t\t\t\t\treturn oDOM.removeEventListener(LiteGraph.pointerevents_method+sEvent, fCall, capture);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// not \"pointer\" || \"mouse\"\n\t\t\tdefault:\n\t\t\t\treturn oDOM.removeEventListener(sEvent, fCall, capture);\n\t\t}\n\t}\n\t\n    Math.clamp = function(v, a, b) {\n        return a > v ? a : b < v ? b : v;\n    };\n\n    if (typeof window != \"undefined\" && !window[\"requestAnimationFrame\"]) {\n        window.requestAnimationFrame =\n            window.webkitRequestAnimationFrame ||\n            window.mozRequestAnimationFrame ||\n            function(callback) {\n                window.setTimeout(callback, 1000 / 60);\n            };\n    }\n})(this);\n\nif (typeof exports != \"undefined\") {\n    exports.LiteGraph = this.LiteGraph;\n}\n\n\n//basic nodes\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n    //Constant\n    function Time() {\n        this.addOutput(\"in ms\", \"number\");\n        this.addOutput(\"in sec\", \"number\");\n    }\n\n    Time.title = \"Time\";\n    Time.desc = \"Time\";\n\n    Time.prototype.onExecute = function() {\n        this.setOutputData(0, this.graph.globaltime * 1000);\n        this.setOutputData(1, this.graph.globaltime);\n    };\n\n    LiteGraph.registerNodeType(\"basic/time\", Time);\n\n    //Subgraph: a node that contains a graph\n    function Subgraph() {\n        var that = this;\n        this.size = [140, 80];\n        this.properties = { enabled: true };\n        this.enabled = true;\n\n        //create inner graph\n        this.subgraph = new LiteGraph.LGraph();\n        this.subgraph._subgraph_node = this;\n        this.subgraph._is_subgraph = true;\n\n        this.subgraph.onTrigger = this.onSubgraphTrigger.bind(this);\n\n\t\t//nodes input node added inside\n        this.subgraph.onInputAdded = this.onSubgraphNewInput.bind(this);\n        this.subgraph.onInputRenamed = this.onSubgraphRenamedInput.bind(this);\n        this.subgraph.onInputTypeChanged = this.onSubgraphTypeChangeInput.bind(this);\n        this.subgraph.onInputRemoved = this.onSubgraphRemovedInput.bind(this);\n\n        this.subgraph.onOutputAdded = this.onSubgraphNewOutput.bind(this);\n        this.subgraph.onOutputRenamed = this.onSubgraphRenamedOutput.bind(this);\n        this.subgraph.onOutputTypeChanged = this.onSubgraphTypeChangeOutput.bind(this);\n        this.subgraph.onOutputRemoved = this.onSubgraphRemovedOutput.bind(this);\n    }\n\n    Subgraph.title = \"Subgraph\";\n    Subgraph.desc = \"Graph inside a node\";\n    Subgraph.title_color = \"#334\";\n\n    Subgraph.prototype.onGetInputs = function() {\n        return [[\"enabled\", \"boolean\"]];\n    };\n\n\t/*\n    Subgraph.prototype.onDrawTitle = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n\n        ctx.fillStyle = \"#555\";\n        var w = LiteGraph.NODE_TITLE_HEIGHT;\n        var x = this.size[0] - w;\n        ctx.fillRect(x, -w, w, w);\n        ctx.fillStyle = \"#333\";\n        ctx.beginPath();\n        ctx.moveTo(x + w * 0.2, -w * 0.6);\n        ctx.lineTo(x + w * 0.8, -w * 0.6);\n        ctx.lineTo(x + w * 0.5, -w * 0.3);\n        ctx.fill();\n    };\n\t*/\n\n    Subgraph.prototype.onDblClick = function(e, pos, graphcanvas) {\n        var that = this;\n        setTimeout(function() {\n            graphcanvas.openSubgraph(that.subgraph);\n        }, 10);\n    };\n\n\t/*\n    Subgraph.prototype.onMouseDown = function(e, pos, graphcanvas) {\n        if (\n            !this.flags.collapsed &&\n            pos[0] > this.size[0] - LiteGraph.NODE_TITLE_HEIGHT &&\n            pos[1] < 0\n        ) {\n            var that = this;\n            setTimeout(function() {\n                graphcanvas.openSubgraph(that.subgraph);\n            }, 10);\n        }\n    };\n\t*/\n\n    Subgraph.prototype.onAction = function(action, param) {\n        this.subgraph.onAction(action, param);\n    };\n\n    Subgraph.prototype.onExecute = function() {\n        this.enabled = this.getInputOrProperty(\"enabled\");\n        if (!this.enabled) {\n            return;\n        }\n\n        //send inputs to subgraph global inputs\n        if (this.inputs) {\n            for (var i = 0; i < this.inputs.length; i++) {\n                var input = this.inputs[i];\n                var value = this.getInputData(i);\n                this.subgraph.setInputData(input.name, value);\n            }\n        }\n\n        //execute\n        this.subgraph.runStep();\n\n        //send subgraph global outputs to outputs\n        if (this.outputs) {\n            for (var i = 0; i < this.outputs.length; i++) {\n                var output = this.outputs[i];\n                var value = this.subgraph.getOutputData(output.name);\n                this.setOutputData(i, value);\n            }\n        }\n    };\n\n    Subgraph.prototype.sendEventToAllNodes = function(eventname, param, mode) {\n        if (this.enabled) {\n            this.subgraph.sendEventToAllNodes(eventname, param, mode);\n        }\n    };\n\n    Subgraph.prototype.onDrawBackground = function (ctx, graphcanvas, canvas, pos) {\n        if (this.flags.collapsed)\n            return;\n        var y = this.size[1] - LiteGraph.NODE_TITLE_HEIGHT + 0.5;\n        // button\n        var over = LiteGraph.isInsideRectangle(pos[0], pos[1], this.pos[0], this.pos[1] + y, this.size[0], LiteGraph.NODE_TITLE_HEIGHT);\n        let overleft = LiteGraph.isInsideRectangle(pos[0], pos[1], this.pos[0], this.pos[1] + y, this.size[0] / 2, LiteGraph.NODE_TITLE_HEIGHT)\n        ctx.fillStyle = over ? \"#555\" : \"#222\";\n        ctx.beginPath();\n        if (this._shape == LiteGraph.BOX_SHAPE) {\n            if (overleft) {\n                ctx.rect(0, y, this.size[0] / 2 + 1, LiteGraph.NODE_TITLE_HEIGHT);\n            } else {\n                ctx.rect(this.size[0] / 2, y, this.size[0] / 2 + 1, LiteGraph.NODE_TITLE_HEIGHT);\n            }\n        }\n        else {\n            if (overleft) {\n                ctx.roundRect(0, y, this.size[0] / 2 + 1, LiteGraph.NODE_TITLE_HEIGHT, [0,0, 8,8]);\n            } else {\n                ctx.roundRect(this.size[0] / 2, y, this.size[0] / 2 + 1, LiteGraph.NODE_TITLE_HEIGHT, [0,0, 8,8]);\n            }\n        }\n        if (over) {\n            ctx.fill();\n        } else {\n            ctx.fillRect(0, y, this.size[0] + 1, LiteGraph.NODE_TITLE_HEIGHT);\n        }\n        // button\n        ctx.textAlign = \"center\";\n        ctx.font = \"24px Arial\";\n        ctx.fillStyle = over ? \"#DDD\" : \"#999\";\n        ctx.fillText(\"+\", this.size[0] * 0.25, y + 24);\n        ctx.fillText(\"+\", this.size[0] * 0.75, y + 24);\n    }\n\n    // Subgraph.prototype.onMouseDown = function(e, localpos, graphcanvas)\n    // {\n    // \tvar y = this.size[1] - LiteGraph.NODE_TITLE_HEIGHT + 0.5;\n    // \tif(localpos[1] > y)\n    // \t{\n    // \t\tgraphcanvas.showSubgraphPropertiesDialog(this);\n    // \t}\n    // }\n    Subgraph.prototype.onMouseDown = function (e, localpos, graphcanvas) {\n        var y = this.size[1] - LiteGraph.NODE_TITLE_HEIGHT + 0.5;\n        console.log(0)\n        if (localpos[1] > y) {\n            if (localpos[0] < this.size[0] / 2) {\n                console.log(1)\n                graphcanvas.showSubgraphPropertiesDialog(this);\n            } else {\n                console.log(2)\n                graphcanvas.showSubgraphPropertiesDialogRight(this);\n            }\n        }\n    }\n\tSubgraph.prototype.computeSize = function()\n\t{\n\t\tvar num_inputs = this.inputs ? this.inputs.length : 0;\n\t\tvar num_outputs = this.outputs ? this.outputs.length : 0;\n\t\treturn [ 200, Math.max(num_inputs,num_outputs) * LiteGraph.NODE_SLOT_HEIGHT + LiteGraph.NODE_TITLE_HEIGHT ];\n\t}\n\n    //**** INPUTS ***********************************\n    Subgraph.prototype.onSubgraphTrigger = function(event, param) {\n        var slot = this.findOutputSlot(event);\n        if (slot != -1) {\n            this.triggerSlot(slot);\n        }\n    };\n\n    Subgraph.prototype.onSubgraphNewInput = function(name, type) {\n        var slot = this.findInputSlot(name);\n        if (slot == -1) {\n            //add input to the node\n            this.addInput(name, type);\n        }\n    };\n\n    Subgraph.prototype.onSubgraphRenamedInput = function(oldname, name) {\n        var slot = this.findInputSlot(oldname);\n        if (slot == -1) {\n            return;\n        }\n        var info = this.getInputInfo(slot);\n        info.name = name;\n    };\n\n    Subgraph.prototype.onSubgraphTypeChangeInput = function(name, type) {\n        var slot = this.findInputSlot(name);\n        if (slot == -1) {\n            return;\n        }\n        var info = this.getInputInfo(slot);\n        info.type = type;\n    };\n\n    Subgraph.prototype.onSubgraphRemovedInput = function(name) {\n        var slot = this.findInputSlot(name);\n        if (slot == -1) {\n            return;\n        }\n        this.removeInput(slot);\n    };\n\n    //**** OUTPUTS ***********************************\n    Subgraph.prototype.onSubgraphNewOutput = function(name, type) {\n        var slot = this.findOutputSlot(name);\n        if (slot == -1) {\n            this.addOutput(name, type);\n        }\n    };\n\n    Subgraph.prototype.onSubgraphRenamedOutput = function(oldname, name) {\n        var slot = this.findOutputSlot(oldname);\n        if (slot == -1) {\n            return;\n        }\n        var info = this.getOutputInfo(slot);\n        info.name = name;\n    };\n\n    Subgraph.prototype.onSubgraphTypeChangeOutput = function(name, type) {\n        var slot = this.findOutputSlot(name);\n        if (slot == -1) {\n            return;\n        }\n        var info = this.getOutputInfo(slot);\n        info.type = type;\n    };\n\n    Subgraph.prototype.onSubgraphRemovedOutput = function(name) {\n        var slot = this.findInputSlot(name);\n        if (slot == -1) {\n            return;\n        }\n        this.removeOutput(slot);\n    };\n    // *****************************************************\n\n    Subgraph.prototype.getExtraMenuOptions = function(graphcanvas) {\n        var that = this;\n        return [\n            {\n                content: \"Open\",\n                callback: function() {\n                    graphcanvas.openSubgraph(that.subgraph);\n                }\n            }\n        ];\n    };\n\n    Subgraph.prototype.onResize = function(size) {\n        size[1] += 20;\n    };\n\n    Subgraph.prototype.serialize = function() {\n        var data = LiteGraph.LGraphNode.prototype.serialize.call(this);\n        data.subgraph = this.subgraph.serialize();\n        return data;\n    };\n    //no need to define node.configure, the default method detects node.subgraph and passes the object to node.subgraph.configure()\n\n    Subgraph.prototype.clone = function() {\n        var node = LiteGraph.createNode(this.type);\n        var data = this.serialize();\n        delete data[\"id\"];\n        delete data[\"inputs\"];\n        delete data[\"outputs\"];\n        node.configure(data);\n        return node;\n    };\n\n\tSubgraph.prototype.buildFromNodes = function(nodes)\n\t{\n\t\t//clear all?\n\t\t//TODO\n\n\t\t//nodes that connect data between parent graph and subgraph\n\t\tvar subgraph_inputs = [];\n\t\tvar subgraph_outputs = [];\n\n\t\t//mark inner nodes\n\t\tvar ids = {};\n\t\tvar min_x = 0;\n\t\tvar max_x = 0;\n\t\tfor(var i = 0; i < nodes.length; ++i)\n\t\t{\n\t\t\tvar node = nodes[i];\n\t\t\tids[ node.id ] = node;\n\t\t\tmin_x = Math.min( node.pos[0], min_x );\n\t\t\tmax_x = Math.max( node.pos[0], min_x );\n\t\t}\n\t\t\n\t\tvar last_input_y = 0;\n\t\tvar last_output_y = 0;\n\n\t\tfor(var i = 0; i < nodes.length; ++i)\n\t\t{\n\t\t\tvar node = nodes[i];\n\t\t\t//check inputs\n\t\t\tif( node.inputs )\n\t\t\t\tfor(var j = 0; j < node.inputs.length; ++j)\n\t\t\t\t{\n\t\t\t\t\tvar input = node.inputs[j];\n\t\t\t\t\tif( !input || !input.link )\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tvar link = node.graph.links[ input.link ];\n\t\t\t\t\tif(!link)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tif( ids[ link.origin_id ] )\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t//this.addInput(input.name,link.type);\n\t\t\t\t\tthis.subgraph.addInput(input.name,link.type);\n\t\t\t\t\t/*\n\t\t\t\t\tvar input_node = LiteGraph.createNode(\"graph/input\");\n\t\t\t\t\tthis.subgraph.add( input_node );\n\t\t\t\t\tinput_node.pos = [min_x - 200, last_input_y ];\n\t\t\t\t\tlast_input_y += 100;\n\t\t\t\t\t*/\n\t\t\t\t}\n\n\t\t\t//check outputs\n\t\t\tif( node.outputs )\n\t\t\t\tfor(var j = 0; j < node.outputs.length; ++j)\n\t\t\t\t{\n\t\t\t\t\tvar output = node.outputs[j];\n\t\t\t\t\tif( !output || !output.links || !output.links.length )\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tvar is_external = false;\n\t\t\t\t\tfor(var k = 0; k < output.links.length; ++k)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar link = node.graph.links[ output.links[k] ];\n\t\t\t\t\t\tif(!link)\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tif( ids[ link.target_id ] )\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tis_external = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(!is_external)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t//this.addOutput(output.name,output.type);\n\t\t\t\t\t/*\n\t\t\t\t\tvar output_node = LiteGraph.createNode(\"graph/output\");\n\t\t\t\t\tthis.subgraph.add( output_node );\n\t\t\t\t\toutput_node.pos = [max_x + 50, last_output_y ];\n\t\t\t\t\tlast_output_y += 100;\n\t\t\t\t\t*/\n\t\t\t\t}\n\t\t}\n\n\t\t//detect inputs and outputs\n\t\t\t//split every connection in two data_connection nodes\n\t\t\t//keep track of internal connections\n\t\t\t//connect external connections\n\n\t\t//clone nodes inside subgraph and try to reconnect them\n\n\t\t//connect edge subgraph nodes to extarnal connections nodes\n\t}\n\n    LiteGraph.Subgraph = Subgraph;\n    LiteGraph.registerNodeType(\"graph/subgraph\", Subgraph);\n\n    //Input for a subgraph\n    function GraphInput() {\n        this.addOutput(\"\", \"number\");\n\n        this.name_in_graph = \"\";\n        this.properties = {\n\t\t\tname: \"\",\n\t\t\ttype: \"number\",\n\t\t\tvalue: 0\n\t\t}; \n\n        var that = this;\n\n        this.name_widget = this.addWidget(\n            \"text\",\n            \"Name\",\n            this.properties.name,\n            function(v) {\n                if (!v) {\n                    return;\n                }\n                that.setProperty(\"name\",v);\n            }\n        );\n        this.type_widget = this.addWidget(\n            \"text\",\n            \"Type\",\n            this.properties.type,\n            function(v) {\n\t\t\t\tthat.setProperty(\"type\",v);\n            }\n        );\n\n        this.value_widget = this.addWidget(\n            \"number\",\n            \"Value\",\n            this.properties.value,\n            function(v) {\n                that.setProperty(\"value\",v);\n            }\n        );\n\n        this.widgets_up = true;\n        this.size = [180, 90];\n    }\n\n    GraphInput.title = \"Input\";\n    GraphInput.desc = \"Input of the graph\";\n\n\tGraphInput.prototype.onConfigure = function()\n\t{\n\t\tthis.updateType();\n\t}\n\n\t//ensures the type in the node output and the type in the associated graph input are the same\n\tGraphInput.prototype.updateType = function()\n\t{\n\t\tvar type = this.properties.type;\n\t\tthis.type_widget.value = type;\n\n\t\t//update output\n\t\tif(this.outputs[0].type != type)\n\t\t{\n\t        if (!LiteGraph.isValidConnection(this.outputs[0].type,type))\n\t\t\t\tthis.disconnectOutput(0);\n\t\t\tthis.outputs[0].type = type;\n\t\t}\n\n\t\t//update widget\n\t\tif(type == \"number\")\n\t\t{\n\t\t\tthis.value_widget.type = \"number\";\n\t\t\tthis.value_widget.value = 0;\n\t\t}\n\t\telse if(type == \"boolean\")\n\t\t{\n\t\t\tthis.value_widget.type = \"toggle\";\n\t\t\tthis.value_widget.value = true;\n\t\t}\n\t\telse if(type == \"string\")\n\t\t{\n\t\t\tthis.value_widget.type = \"text\";\n\t\t\tthis.value_widget.value = \"\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.value_widget.type = null;\n\t\t\tthis.value_widget.value = null;\n\t\t}\n\t\tthis.properties.value = this.value_widget.value;\n\n\t\t//update graph\n\t\tif (this.graph && this.name_in_graph) {\n\t\t\tthis.graph.changeInputType(this.name_in_graph, type);\n\t\t}\n\t}\n\n\t//this is executed AFTER the property has changed\n\tGraphInput.prototype.onPropertyChanged = function(name,v)\n\t{\n\t\tif( name == \"name\" )\n\t\t{\n\t\t\tif (v == \"\" || v == this.name_in_graph || v == \"enabled\") {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(this.graph)\n\t\t\t{\n\t\t\t\tif (this.name_in_graph) {\n\t\t\t\t\t//already added\n\t\t\t\t\tthis.graph.renameInput( this.name_in_graph, v );\n\t\t\t\t} else {\n\t\t\t\t\tthis.graph.addInput( v, this.properties.type );\n\t\t\t\t}\n\t\t\t} //what if not?!\n\t\t\tthis.name_widget.value = v;\n\t\t\tthis.name_in_graph = v;\n\t\t}\n\t\telse if( name == \"type\" )\n\t\t{\n\t\t\tthis.updateType();\n\t\t}\n\t\telse if( name == \"value\" )\n\t\t{\n\t\t}\n\t}\n\n    GraphInput.prototype.getTitle = function() {\n        if (this.flags.collapsed) {\n            return this.properties.name;\n        }\n        return this.title;\n    };\n\n    GraphInput.prototype.onAction = function(action, param) {\n        if (this.properties.type == LiteGraph.EVENT) {\n            this.triggerSlot(0, param);\n        }\n    };\n\n    GraphInput.prototype.onExecute = function() {\n        var name = this.properties.name;\n        //read from global input\n        var data = this.graph.inputs[name];\n        if (!data) {\n            this.setOutputData(0, this.properties.value );\n\t\t\treturn;\n        }\n\n        this.setOutputData(0, data.value !== undefined ? data.value : this.properties.value );\n    };\n\n    GraphInput.prototype.onRemoved = function() {\n        if (this.name_in_graph) {\n            this.graph.removeInput(this.name_in_graph);\n        }\n    };\n\n    LiteGraph.GraphInput = GraphInput;\n    LiteGraph.registerNodeType(\"graph/input\", GraphInput);\n\n    //Output for a subgraph\n    function GraphOutput() {\n        this.addInput(\"\", \"\");\n\n        this.name_in_graph = \"\";\n        this.properties = { name: \"\", type: \"\" };\n        var that = this;\n\n        // Object.defineProperty(this.properties, \"name\", {\n        //     get: function() {\n        //         return that.name_in_graph;\n        //     },\n        //     set: function(v) {\n        //         if (v == \"\" || v == that.name_in_graph) {\n        //             return;\n        //         }\n        //         if (that.name_in_graph) {\n        //             //already added\n        //             that.graph.renameOutput(that.name_in_graph, v);\n        //         } else {\n        //             that.graph.addOutput(v, that.properties.type);\n        //         }\n        //         that.name_widget.value = v;\n        //         that.name_in_graph = v;\n        //     },\n        //     enumerable: true\n        // });\n\n        // Object.defineProperty(this.properties, \"type\", {\n        //     get: function() {\n        //         return that.inputs[0].type;\n        //     },\n        //     set: function(v) {\n        //         if (v == \"action\" || v == \"event\") {\n        //             v = LiteGraph.ACTION;\n        //         }\n\t\t//         if (!LiteGraph.isValidConnection(that.inputs[0].type,v))\n\t\t// \t\t\tthat.disconnectInput(0);\n        //         that.inputs[0].type = v;\n        //         if (that.name_in_graph) {\n        //             //already added\n        //             that.graph.changeOutputType(\n        //                 that.name_in_graph,\n        //                 that.inputs[0].type\n        //             );\n        //         }\n        //         that.type_widget.value = v || \"\";\n        //     },\n        //     enumerable: true\n        // });\n\n        this.name_widget = this.addWidget(\"text\",\"Name\",this.properties.name,\"name\");\n        this.type_widget = this.addWidget(\"text\",\"Type\",this.properties.type,\"type\");\n        this.widgets_up = true;\n        this.size = [180, 60];\n    }\n\n    GraphOutput.title = \"Output\";\n    GraphOutput.desc = \"Output of the graph\";\n\n    GraphOutput.prototype.onPropertyChanged = function (name, v) {\n        if (name == \"name\") {\n            if (v == \"\" || v == this.name_in_graph || v == \"enabled\") {\n                return false;\n            }\n            if (this.graph) {\n                if (this.name_in_graph) {\n                    //already added\n                    this.graph.renameOutput(this.name_in_graph, v);\n                } else {\n                    this.graph.addOutput(v, this.properties.type);\n                }\n            } //what if not?!\n            this.name_widget.value = v;\n            this.name_in_graph = v;\n        }\n        else if (name == \"type\") {\n            this.updateType();\n        }\n        else if (name == \"value\") {\n        }\n    }\n     \n    GraphOutput.prototype.updateType = function () {\n        var type = this.properties.type;\n        if (this.type_widget)\n            this.type_widget.value = type;\n\n        //update output\n        if (this.inputs[0].type != type) {\n\n\t\t\tif ( type == \"action\" || type == \"event\")\n\t            type = LiteGraph.EVENT;\n\t\t\tif (!LiteGraph.isValidConnection(this.inputs[0].type, type))\n\t\t\t\tthis.disconnectInput(0);\n\t\t\tthis.inputs[0].type = type;\n        }\n\n        //update graph\n        if (this.graph && this.name_in_graph) {\n            this.graph.changeOutputType(this.name_in_graph, type);\n        }\n    }\n\n\n\n    GraphOutput.prototype.onExecute = function() {\n        this._value = this.getInputData(0);\n        this.graph.setOutputData(this.properties.name, this._value);\n    };\n\n    GraphOutput.prototype.onAction = function(action, param) {\n        if (this.properties.type == LiteGraph.ACTION) {\n            this.graph.trigger( this.properties.name, param );\n        }\n    };\n\n    GraphOutput.prototype.onRemoved = function() {\n        if (this.name_in_graph) {\n            this.graph.removeOutput(this.name_in_graph);\n        }\n    };\n\n    GraphOutput.prototype.getTitle = function() {\n        if (this.flags.collapsed) {\n            return this.properties.name;\n        }\n        return this.title;\n    };\n\n    LiteGraph.GraphOutput = GraphOutput;\n    LiteGraph.registerNodeType(\"graph/output\", GraphOutput);\n\n    //Constant\n    function ConstantNumber() {\n        this.addOutput(\"value\", \"number\");\n        this.addProperty(\"value\", 1.0);\n        this.widget = this.addWidget(\"number\",\"value\",1,\"value\");\n        this.widgets_up = true;\n        this.size = [180, 30];\n    }\n\n    ConstantNumber.title = \"Const Number\";\n    ConstantNumber.desc = \"Constant number\";\n\n    ConstantNumber.prototype.onExecute = function() {\n        this.setOutputData(0, parseFloat(this.properties[\"value\"]));\n    };\n\n    ConstantNumber.prototype.getTitle = function() {\n        if (this.flags.collapsed) {\n            return this.properties.value;\n        }\n        return this.title;\n    };\n\n\tConstantNumber.prototype.setValue = function(v)\n\t{\n\t\tthis.setProperty(\"value\",v);\n\t}\n\n    ConstantNumber.prototype.onDrawBackground = function(ctx) {\n        //show the current value\n        this.outputs[0].label = this.properties[\"value\"].toFixed(3);\n    };\n\n    LiteGraph.registerNodeType(\"basic/const\", ConstantNumber);\n\n    function ConstantBoolean() {\n        this.addOutput(\"bool\", \"boolean\");\n        this.addProperty(\"value\", true);\n        this.widget = this.addWidget(\"toggle\",\"value\",true,\"value\");\n        this.serialize_widgets = true;\n        this.widgets_up = true;\n        this.size = [140, 30];\n    }\n\n    ConstantBoolean.title = \"Const Boolean\";\n    ConstantBoolean.desc = \"Constant boolean\";\n    ConstantBoolean.prototype.getTitle = ConstantNumber.prototype.getTitle;\n\n    ConstantBoolean.prototype.onExecute = function() {\n        this.setOutputData(0, this.properties[\"value\"]);\n    };\n\n\tConstantBoolean.prototype.setValue = ConstantNumber.prototype.setValue;\n\n\tConstantBoolean.prototype.onGetInputs = function() {\n\t\treturn [[\"toggle\", LiteGraph.ACTION]];\n\t};\n\n\tConstantBoolean.prototype.onAction = function(action)\n\t{\n\t\tthis.setValue( !this.properties.value );\n\t}\n\n    LiteGraph.registerNodeType(\"basic/boolean\", ConstantBoolean);\n\n    function ConstantString() {\n        this.addOutput(\"string\", \"string\");\n        this.addProperty(\"value\", \"\");\n        this.widget = this.addWidget(\"text\",\"value\",\"\",\"value\");  //link to property value\n        this.widgets_up = true;\n        this.size = [180, 30];\n    }\n\n    ConstantString.title = \"Const String\";\n    ConstantString.desc = \"Constant string\";\n\n    ConstantString.prototype.getTitle = ConstantNumber.prototype.getTitle;\n\n    ConstantString.prototype.onExecute = function() {\n        this.setOutputData(0, this.properties[\"value\"]);\n    };\n\n\tConstantString.prototype.setValue = ConstantNumber.prototype.setValue;\n\n\tConstantString.prototype.onDropFile = function(file)\n\t{\n\t\tvar that = this;\n\t\tvar reader = new FileReader();\n\t\treader.onload = function(e)\n\t\t{\n\t\t\tthat.setProperty(\"value\",e.target.result);\n\t\t}\n\t\treader.readAsText(file);\n\t}\n\n    LiteGraph.registerNodeType(\"basic/string\", ConstantString);\n\n    function ConstantObject() {\n        this.addOutput(\"obj\", \"object\");\n        this.size = [120, 30];\n\t\tthis._object = {};\n    }\n\n    ConstantObject.title = \"Const Object\";\n    ConstantObject.desc = \"Constant Object\";\n\n    ConstantObject.prototype.onExecute = function() {\n        this.setOutputData(0, this._object);\n    };\n\n    LiteGraph.registerNodeType( \"basic/object\", ConstantObject );\n\n    function ConstantFile() {\n        this.addInput(\"url\", \"string\");\n        this.addOutput(\"file\", \"string\");\n        this.addProperty(\"url\", \"\");\n        this.addProperty(\"type\", \"text\");\n        this.widget = this.addWidget(\"text\",\"url\",\"\",\"url\");\n        this._data = null;\n    }\n\n    ConstantFile.title = \"Const File\";\n    ConstantFile.desc = \"Fetches a file from an url\";\n    ConstantFile[\"@type\"] = { type: \"enum\", values: [\"text\",\"arraybuffer\",\"blob\",\"json\"] };\n\n    ConstantFile.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"url\")\n\t\t{\n\t\t\tif( value == null || value == \"\")\n\t\t\t\tthis._data = null;\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.fetchFile(value);\n\t\t\t}\n\t\t}\n\t}\n\n    ConstantFile.prototype.onExecute = function() {\n\t\tvar url = this.getInputData(0) || this.properties.url;\n\t\tif(url && (url != this._url || this._type != this.properties.type))\n\t\t\tthis.fetchFile(url);\n        this.setOutputData(0, this._data );\n    };\n\n\tConstantFile.prototype.setValue = ConstantNumber.prototype.setValue;\n\n    ConstantFile.prototype.fetchFile = function(url) {\n\t\tvar that = this;\n\t\tif(!url || url.constructor !== String)\n\t\t{\n\t\t\tthat._data = null;\n            that.boxcolor = null;\n\t\t\treturn;\n\t\t}\n\n\t\tthis._url = url;\n\t\tthis._type = this.properties.type;\n        if (url.substr(0, 4) == \"http\" && LiteGraph.proxy) {\n            url = LiteGraph.proxy + url.substr(url.indexOf(\":\") + 3);\n        }\n\t\tfetch(url)\n\t\t.then(function(response) {\n\t\t\tif(!response.ok)\n\t\t\t\t throw new Error(\"File not found\");\n\n\t\t\tif(that.properties.type == \"arraybuffer\")\n\t\t\t\treturn response.arrayBuffer();\n\t\t\telse if(that.properties.type == \"text\")\n\t\t\t\treturn response.text();\n\t\t\telse if(that.properties.type == \"json\")\n\t\t\t\treturn response.json();\n\t\t\telse if(that.properties.type == \"blob\")\n\t\t\t\treturn response.blob();\n\t\t})\n\t\t.then(function(data) {\n\t\t\tthat._data = data;\n            that.boxcolor = \"#AEA\";\n\t\t})\n\t\t.catch(function(error) {\n\t\t\tthat._data = null;\n            that.boxcolor = \"red\";\n\t\t\tconsole.error(\"error fetching file:\",url);\n\t\t});\n    };\n\n\tConstantFile.prototype.onDropFile = function(file)\n\t{\n\t\tvar that = this;\n\t\tthis._url = file.name;\n\t\tthis._type = this.properties.type;\n\t\tthis.properties.url = file.name;\n\t\tvar reader = new FileReader();\n\t\treader.onload = function(e)\n\t\t{\n            that.boxcolor = \"#AEA\";\n\t\t\tvar v = e.target.result;\n\t\t\tif( that.properties.type == \"json\" )\n\t\t\t\tv = JSON.parse(v);\n\t\t\tthat._data = v;\n\t\t}\n\t\tif(that.properties.type == \"arraybuffer\")\n\t\t\treader.readAsArrayBuffer(file);\n\t\telse if(that.properties.type == \"text\" || that.properties.type == \"json\")\n\t\t\treader.readAsText(file);\n\t\telse if(that.properties.type == \"blob\")\n\t\t\treturn reader.readAsBinaryString(file);\n\t}\n\n    LiteGraph.registerNodeType(\"basic/file\", ConstantFile);\n\n\t//to store json objects\n    function ConstantData() {\n        this.addOutput(\"data\", \"object\");\n        this.addProperty(\"value\", \"\");\n        this.widget = this.addWidget(\"text\",\"json\",\"\",\"value\");\n        this.widgets_up = true;\n        this.size = [140, 30];\n        this._value = null;\n    }\n\n    ConstantData.title = \"Const Data\";\n    ConstantData.desc = \"Constant Data\";\n\n    ConstantData.prototype.onPropertyChanged = function(name, value) {\n        this.widget.value = value;\n        if (value == null || value == \"\") {\n            return;\n        }\n\n        try {\n            this._value = JSON.parse(value);\n            this.boxcolor = \"#AEA\";\n        } catch (err) {\n            this.boxcolor = \"red\";\n        }\n    };\n\n    ConstantData.prototype.onExecute = function() {\n        this.setOutputData(0, this._value);\n    };\n\n\tConstantData.prototype.setValue = ConstantNumber.prototype.setValue;\n\n    LiteGraph.registerNodeType(\"basic/data\", ConstantData);\n\n\t//to store json objects\n    function ConstantArray() {\n\t\tthis._value = [];\n        this.addInput(\"json\", \"\");\n        this.addOutput(\"arrayOut\", \"array\");\n\t\tthis.addOutput(\"length\", \"number\");\n        this.addProperty(\"value\", \"[]\");\n        this.widget = this.addWidget(\"text\",\"array\",this.properties.value,\"value\");\n        this.widgets_up = true;\n        this.size = [140, 50];\n    }\n\n    ConstantArray.title = \"Const Array\";\n    ConstantArray.desc = \"Constant Array\";\n\n    ConstantArray.prototype.onPropertyChanged = function(name, value) {\n        this.widget.value = value;\n        if (value == null || value == \"\") {\n            return;\n        }\n\n        try {\n\t\t\tif(value[0] != \"[\")\n\t            this._value = JSON.parse(\"[\" + value + \"]\");\n\t\t\telse\n\t            this._value = JSON.parse(value);\n            this.boxcolor = \"#AEA\";\n        } catch (err) {\n            this.boxcolor = \"red\";\n        }\n    };\n\n    ConstantArray.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n\t\tif(v && v.length) //clone\n\t\t{\n\t\t\tif(!this._value)\n\t\t\t\tthis._value = new Array();\n\t\t\tthis._value.length = v.length;\n\t\t\tfor(var i = 0; i < v.length; ++i)\n\t\t\t\tthis._value[i] = v[i];\n\t\t}\n\t\tthis.setOutputData(0, this._value);\n\t\tthis.setOutputData(1, this._value ? ( this._value.length || 0) : 0 );\n    };\n\n\tConstantArray.prototype.setValue = ConstantNumber.prototype.setValue;\n\n    LiteGraph.registerNodeType(\"basic/array\", ConstantArray);\n\n\tfunction SetArray()\n\t{\n        this.addInput(\"arr\", \"array\");\n        this.addInput(\"value\", \"\");\n        this.addOutput(\"arr\", \"array\");\n\t\tthis.properties = { index: 0 };\n        this.widget = this.addWidget(\"number\",\"i\",this.properties.index,\"index\",{precision: 0, step: 10, min: 0});\n\t}\n\n    SetArray.title = \"Set Array\";\n    SetArray.desc = \"Sets index of array\";\n\n    SetArray.prototype.onExecute = function() {\n        var arr = this.getInputData(0);\n\t\tif(!arr)\n\t\t\treturn;\n        var v = this.getInputData(1);\n\t\tif(v === undefined )\n\t\t\treturn;\n\t\tif(this.properties.index)\n\t\t\tarr[ Math.floor(this.properties.index) ] = v;\n\t\tthis.setOutputData(0,arr);\n    };\n\n    LiteGraph.registerNodeType(\"basic/set_array\", SetArray );\n\n    function ArrayElement() {\n        this.addInput(\"array\", \"array,table,string\");\n        this.addInput(\"index\", \"number\");\n        this.addOutput(\"value\", \"\");\n\t\tthis.addProperty(\"index\",0);\n    }\n\n    ArrayElement.title = \"Array[i]\";\n    ArrayElement.desc = \"Returns an element from an array\";\n\n    ArrayElement.prototype.onExecute = function() {\n        var array = this.getInputData(0);\n        var index = this.getInputData(1);\n\t\tif(index == null)\n\t\t\tindex = this.properties.index;\n\t\tif(array == null || index == null )\n\t\t\treturn;\n        this.setOutputData(0, array[Math.floor(Number(index))] );\n    };\n\n    LiteGraph.registerNodeType(\"basic/array[]\", ArrayElement);\n\n    function TableElement() {\n        this.addInput(\"table\", \"table\");\n        this.addInput(\"row\", \"number\");\n        this.addInput(\"col\", \"number\");\n        this.addOutput(\"value\", \"\");\n\t\tthis.addProperty(\"row\",0);\n\t\tthis.addProperty(\"column\",0);\n    }\n\n    TableElement.title = \"Table[row][col]\";\n    TableElement.desc = \"Returns an element from a table\";\n\n    TableElement.prototype.onExecute = function() {\n        var table = this.getInputData(0);\n        var row = this.getInputData(1);\n        var col = this.getInputData(2);\n\t\tif(row == null)\n\t\t\trow = this.properties.row;\n\t\tif(col == null)\n\t\t\tcol = this.properties.column;\n\t\tif(table == null || row == null || col == null)\n\t\t\treturn;\n\t\tvar row = table[Math.floor(Number(row))];\n\t\tif(row)\n\t        this.setOutputData(0, row[Math.floor(Number(col))] );\n\t\telse\n\t        this.setOutputData(0, null );\n    };\n\n    LiteGraph.registerNodeType(\"basic/table[][]\", TableElement);\n\n    function ObjectProperty() {\n        this.addInput(\"obj\", \"object\");\n        this.addOutput(\"property\", 0);\n        this.addProperty(\"value\", 0);\n        this.widget = this.addWidget(\"text\",\"prop.\",\"\",this.setValue.bind(this) );\n        this.widgets_up = true;\n        this.size = [140, 30];\n        this._value = null;\n    }\n\n    ObjectProperty.title = \"Object property\";\n    ObjectProperty.desc = \"Outputs the property of an object\";\n\n    ObjectProperty.prototype.setValue = function(v) {\n        this.properties.value = v;\n        this.widget.value = v;\n    };\n\n    ObjectProperty.prototype.getTitle = function() {\n        if (this.flags.collapsed) {\n            return \"in.\" + this.properties.value;\n        }\n        return this.title;\n    };\n\n    ObjectProperty.prototype.onPropertyChanged = function(name, value) {\n        this.widget.value = value;\n    };\n\n    ObjectProperty.prototype.onExecute = function() {\n        var data = this.getInputData(0);\n        if (data != null) {\n            this.setOutputData(0, data[this.properties.value]);\n        }\n    };\n\n    LiteGraph.registerNodeType(\"basic/object_property\", ObjectProperty);\n\n    function ObjectKeys() {\n        this.addInput(\"obj\", \"\");\n        this.addOutput(\"keys\", \"array\");\n        this.size = [140, 30];\n    }\n\n    ObjectKeys.title = \"Object keys\";\n    ObjectKeys.desc = \"Outputs an array with the keys of an object\";\n\n    ObjectKeys.prototype.onExecute = function() {\n        var data = this.getInputData(0);\n        if (data != null) {\n            this.setOutputData(0, Object.keys(data) );\n        }\n    };\n\n    LiteGraph.registerNodeType(\"basic/object_keys\", ObjectKeys);\n\n\n\tfunction SetObject()\n\t{\n        this.addInput(\"obj\", \"\");\n        this.addInput(\"value\", \"\");\n        this.addOutput(\"obj\", \"\");\n\t\tthis.properties = { property: \"\" };\n        this.name_widget = this.addWidget(\"text\",\"prop.\",this.properties.property,\"property\");\n\t}\n\n    SetObject.title = \"Set Object\";\n    SetObject.desc = \"Adds propertiesrty to object\";\n\n    SetObject.prototype.onExecute = function() {\n        var obj = this.getInputData(0);\n\t\tif(!obj)\n\t\t\treturn;\n        var v = this.getInputData(1);\n\t\tif(v === undefined )\n\t\t\treturn;\n\t\tif(this.properties.property)\n\t\t\tobj[ this.properties.property ] = v;\n\t\tthis.setOutputData(0,obj);\n    };\n\n    LiteGraph.registerNodeType(\"basic/set_object\", SetObject );\n\n\n    function MergeObjects() {\n        this.addInput(\"A\", \"object\");\n        this.addInput(\"B\", \"object\");\n        this.addOutput(\"out\", \"object\");\n\t\tthis._result = {};\n\t\tvar that = this;\n\t\tthis.addWidget(\"button\",\"clear\",\"\",function(){\n\t\t\tthat._result = {};\n\t\t});\n\t\tthis.size = this.computeSize();\n    }\n\n    MergeObjects.title = \"Merge Objects\";\n    MergeObjects.desc = \"Creates an object copying properties from others\";\n\n    MergeObjects.prototype.onExecute = function() {\n        var A = this.getInputData(0);\n        var B = this.getInputData(1);\n\t\tvar C = this._result;\n\t\tif(A)\n\t\t\tfor(var i in A)\n\t\t\t\tC[i] = A[i];\n\t\tif(B)\n\t\t\tfor(var i in B)\n\t\t\t\tC[i] = B[i];\n\t\tthis.setOutputData(0,C);\n    };\n\n    LiteGraph.registerNodeType(\"basic/merge_objects\", MergeObjects );\n\n    //Store as variable\n    function Variable() {\n        this.size = [60, 30];\n        this.addInput(\"in\");\n        this.addOutput(\"out\");\n\t\tthis.properties = { varname: \"myname\", container: Variable.LITEGRAPH };\n        this.value = null;\n    }\n\n    Variable.title = \"Variable\";\n    Variable.desc = \"store/read variable value\";\n\n\tVariable.LITEGRAPH = 0; //between all graphs\n\tVariable.GRAPH = 1;\t//only inside this graph\n\tVariable.GLOBALSCOPE = 2;\t//attached to Window\n\n    Variable[\"@container\"] = { type: \"enum\", values: {\"litegraph\":Variable.LITEGRAPH, \"graph\":Variable.GRAPH,\"global\": Variable.GLOBALSCOPE} };\n\n    Variable.prototype.onExecute = function() {\n\t\tvar container = this.getContainer();\n\n\t\tif(this.isInputConnected(0))\n\t\t{\n\t\t\tthis.value = this.getInputData(0);\n\t\t\tcontainer[ this.properties.varname ] = this.value;\n\t\t\tthis.setOutputData(0, this.value );\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setOutputData( 0, container[ this.properties.varname ] );\n    };\n\n\tVariable.prototype.getContainer = function()\n\t{\n\t\tswitch(this.properties.container)\n\t\t{\n\t\t\tcase Variable.GRAPH:\n\t\t\t\tif(this.graph)\n\t\t\t\t\treturn this.graph.vars;\n\t\t\t\treturn {};\n\t\t\t\tbreak;\n\t\t\tcase Variable.GLOBALSCOPE:\n\t\t\t\treturn global;\n\t\t\t\tbreak;\n\t\t\tcase Variable.LITEGRAPH:\n\t\t\tdefault:\n\t\t\t\treturn LiteGraph.Globals;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n    Variable.prototype.getTitle = function() {\n        return this.properties.varname;\n    };\n\n    LiteGraph.registerNodeType(\"basic/variable\", Variable);\n\n    function length(v) {\n        if(v && v.length != null)\n\t\t\treturn Number(v.length);\n\t\treturn 0;\n    }\n\n    LiteGraph.wrapFunctionAsNode(\n        \"basic/length\",\n        length,\n        [\"\"],\n        \"number\"\n    );\n\n    function length(v) {\n        if(v && v.length != null)\n\t\t\treturn Number(v.length);\n\t\treturn 0;\n    }\n\n    LiteGraph.wrapFunctionAsNode(\n        \"basic/not\",\n        function(a){ return !a; },\n        [\"\"],\n        \"boolean\"\n    );\n\n\tfunction DownloadData() {\n        this.size = [60, 30];\n        this.addInput(\"data\", 0 );\n        this.addInput(\"download\", LiteGraph.ACTION );\n\t\tthis.properties = { filename: \"data.json\" };\n        this.value = null;\n\t\tvar that = this;\n\t\tthis.addWidget(\"button\",\"Download\",\"\", function(v){\n\t\t\tif(!that.value)\n\t\t\t\treturn;\n\t\t\tthat.downloadAsFile();\n\t\t});\n    }\n\n    DownloadData.title = \"Download\";\n    DownloadData.desc = \"Download some data\";\n\n\tDownloadData.prototype.downloadAsFile = function()\n\t{\n\t\tif(this.value == null)\n\t\t\treturn;\n\n\t\tvar str = null;\n\t\tif(this.value.constructor === String)\n\t\t\tstr = this.value;\n\t\telse\n\t\t\tstr = JSON.stringify(this.value);\n\n\t\tvar file = new Blob([str]);\n\t\tvar url = URL.createObjectURL( file );\n\t\tvar element = document.createElement(\"a\");\n\t\telement.setAttribute('href', url);\n\t\telement.setAttribute('download', this.properties.filename );\n\t\telement.style.display = 'none';\n\t\tdocument.body.appendChild(element);\n\t\telement.click();\n\t\tdocument.body.removeChild(element);\n\t\tsetTimeout( function(){ URL.revokeObjectURL( url ); }, 1000*60 ); //wait one minute to revoke url\n\t}\n\n    DownloadData.prototype.onAction = function(action, param) {\n\t\tvar that = this;\n\t\tsetTimeout( function(){ that.downloadAsFile(); }, 100); //deferred to avoid blocking the renderer with the popup\n\t}\n\n    DownloadData.prototype.onExecute = function() {\n        if (this.inputs[0]) {\n            this.value = this.getInputData(0);\n        }\n    };\n\n    DownloadData.prototype.getTitle = function() {\n        if (this.flags.collapsed) {\n            return this.properties.filename;\n        }\n        return this.title;\n    };\n\n    LiteGraph.registerNodeType(\"basic/download\", DownloadData);\n\n\n\n    //Watch a value in the editor\n    function Watch() {\n        this.size = [60, 30];\n        this.addInput(\"value\", 0, { label: \"\" });\n        this.value = 0;\n    }\n\n    Watch.title = \"Watch\";\n    Watch.desc = \"Show value of input\";\n\n    Watch.prototype.onExecute = function() {\n        if (this.inputs[0]) {\n            this.value = this.getInputData(0);\n        }\n    };\n\n    Watch.prototype.getTitle = function() {\n        if (this.flags.collapsed) {\n            return this.inputs[0].label;\n        }\n        return this.title;\n    };\n\n    Watch.toString = function(o) {\n        if (o == null) {\n            return \"null\";\n        } else if (o.constructor === Number) {\n            return o.toFixed(3);\n        } else if (o.constructor === Array) {\n            var str = \"[\";\n            for (var i = 0; i < o.length; ++i) {\n                str += Watch.toString(o[i]) + (i + 1 != o.length ? \",\" : \"\");\n            }\n            str += \"]\";\n            return str;\n        } else {\n            return String(o);\n        }\n    };\n\n    Watch.prototype.onDrawBackground = function(ctx) {\n        //show the current value\n        this.inputs[0].label = Watch.toString(this.value);\n    };\n\n    LiteGraph.registerNodeType(\"basic/watch\", Watch);\n\n    //in case one type doesnt match other type but you want to connect them anyway\n    function Cast() {\n        this.addInput(\"in\", 0);\n        this.addOutput(\"out\", 0);\n        this.size = [40, 30];\n    }\n\n    Cast.title = \"Cast\";\n    Cast.desc = \"Allows to connect different types\";\n\n    Cast.prototype.onExecute = function() {\n        this.setOutputData(0, this.getInputData(0));\n    };\n\n    LiteGraph.registerNodeType(\"basic/cast\", Cast);\n\n    //Show value inside the debug console\n    function Console() {\n        this.mode = LiteGraph.ON_EVENT;\n        this.size = [80, 30];\n        this.addProperty(\"msg\", \"\");\n        this.addInput(\"log\", LiteGraph.EVENT);\n        this.addInput(\"msg\", 0);\n    }\n\n    Console.title = \"Console\";\n    Console.desc = \"Show value inside the console\";\n\n    Console.prototype.onAction = function(action, param) {\n        // param is the action\n        var msg = this.getInputData(1); //getInputDataByName(\"msg\");\n        //if (msg == null || typeof msg == \"undefined\") return;\n        if (!msg) msg = this.properties.msg;\n        if (!msg) msg = \"Event: \"+param; // msg is undefined if the slot is lost?\n        if (action == \"log\") {\n            console.log(msg);\n        } else if (action == \"warn\") {\n            console.warn(msg);\n        } else if (action == \"error\") {\n            console.error(msg);\n        }\n    };\n\n    Console.prototype.onExecute = function() {\n        var msg = this.getInputData(1); //getInputDataByName(\"msg\");\n        if (!msg) msg = this.properties.msg;\n        if (msg != null && typeof msg != \"undefined\") {\n            this.properties.msg = msg;\n            console.log(msg);\n        }\n    };\n\n    Console.prototype.onGetInputs = function() {\n        return [\n            [\"log\", LiteGraph.ACTION],\n            [\"warn\", LiteGraph.ACTION],\n            [\"error\", LiteGraph.ACTION]\n        ];\n    };\n\n    LiteGraph.registerNodeType(\"basic/console\", Console);\n\n    //Show value inside the debug console\n    function Alert() {\n        this.mode = LiteGraph.ON_EVENT;\n        this.addProperty(\"msg\", \"\");\n        this.addInput(\"\", LiteGraph.EVENT);\n        var that = this;\n        this.widget = this.addWidget(\"text\", \"Text\", \"\", \"msg\");\n        this.widgets_up = true;\n        this.size = [200, 30];\n    }\n\n    Alert.title = \"Alert\";\n    Alert.desc = \"Show an alert window\";\n    Alert.color = \"#510\";\n\n    Alert.prototype.onConfigure = function(o) {\n        this.widget.value = o.properties.msg;\n    };\n\n    Alert.prototype.onAction = function(action, param) {\n        var msg = this.properties.msg;\n        setTimeout(function() {\n            alert(msg);\n        }, 10);\n    };\n\n    LiteGraph.registerNodeType(\"basic/alert\", Alert);\n\n    //Execites simple code\n    function NodeScript() {\n        this.size = [60, 30];\n        this.addProperty(\"onExecute\", \"return A;\");\n        this.addInput(\"A\", 0);\n        this.addInput(\"B\", 0);\n        this.addOutput(\"out\", 0);\n\n        this._func = null;\n        this.data = {};\n    }\n\n    NodeScript.prototype.onConfigure = function(o) {\n        if (o.properties.onExecute && LiteGraph.allow_scripts)\n            this.compileCode(o.properties.onExecute);\n\t\telse\n\t\t\tconsole.warn(\"Script not compiled, LiteGraph.allow_scripts is false\");\n    };\n\n    NodeScript.title = \"Script\";\n    NodeScript.desc = \"executes a code (max 100 characters)\";\n\n    NodeScript.widgets_info = {\n        onExecute: { type: \"code\" }\n    };\n\n    NodeScript.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"onExecute\" && LiteGraph.allow_scripts)\n            this.compileCode(value);\n\t\telse\n\t\t\tconsole.warn(\"Script not compiled, LiteGraph.allow_scripts is false\");\n    };\n\n    NodeScript.prototype.compileCode = function(code) {\n        this._func = null;\n        if (code.length > 256) {\n            console.warn(\"Script too long, max 256 chars\");\n        } else {\n            var code_low = code.toLowerCase();\n            var forbidden_words = [\n                \"script\",\n                \"body\",\n                \"document\",\n                \"eval\",\n                \"nodescript\",\n                \"function\"\n            ]; //bad security solution\n            for (var i = 0; i < forbidden_words.length; ++i) {\n                if (code_low.indexOf(forbidden_words[i]) != -1) {\n                    console.warn(\"invalid script\");\n                    return;\n                }\n            }\n            try {\n                this._func = new Function(\"A\", \"B\", \"C\", \"DATA\", \"node\", code);\n            } catch (err) {\n                console.error(\"Error parsing script\");\n                console.error(err);\n            }\n        }\n    };\n\n    NodeScript.prototype.onExecute = function() {\n        if (!this._func) {\n            return;\n        }\n\n        try {\n            var A = this.getInputData(0);\n            var B = this.getInputData(1);\n            var C = this.getInputData(2);\n            this.setOutputData(0, this._func(A, B, C, this.data, this));\n        } catch (err) {\n            console.error(\"Error in script\");\n            console.error(err);\n        }\n    };\n\n    NodeScript.prototype.onGetOutputs = function() {\n        return [[\"C\", \"\"]];\n    };\n\n    LiteGraph.registerNodeType(\"basic/script\", NodeScript);\n    \n    \n    function GenericCompare() {\n        this.addInput(\"A\", 0);\n        this.addInput(\"B\", 0);\n        this.addOutput(\"true\", \"boolean\");\n        this.addOutput(\"false\", \"boolean\");\n        this.addProperty(\"A\", 1);\n        this.addProperty(\"B\", 1);\n        this.addProperty(\"OP\", \"==\", \"enum\", { values: GenericCompare.values });\n\t\tthis.addWidget(\"combo\",\"Op.\",this.properties.OP,{ property: \"OP\", values: GenericCompare.values } );\n\n        this.size = [80, 60];\n    }\n\n    GenericCompare.values = [\"==\", \"!=\"]; //[\">\", \"<\", \"==\", \"!=\", \"<=\", \">=\", \"||\", \"&&\" ];\n    GenericCompare[\"@OP\"] = {\n        type: \"enum\",\n        title: \"operation\",\n        values: GenericCompare.values\n    };\n\n    GenericCompare.title = \"Compare *\";\n    GenericCompare.desc = \"evaluates condition between A and B\";\n\n    GenericCompare.prototype.getTitle = function() {\n        return \"*A \" + this.properties.OP + \" *B\";\n    };\n\n    GenericCompare.prototype.onExecute = function() {\n        var A = this.getInputData(0);\n        if (A === undefined) {\n            A = this.properties.A;\n        } else {\n            this.properties.A = A;\n        }\n\n        var B = this.getInputData(1);\n        if (B === undefined) {\n            B = this.properties.B;\n        } else {\n            this.properties.B = B;\n        }\n\n        var result = false;\n        if (typeof A == typeof B){\n            switch (this.properties.OP) {\n                case \"==\":\n                case \"!=\":\n                    // traverse both objects.. consider that this is not a true deep check! consider underscore or other library for thath :: _isEqual()\n                    result = true;\n                    switch(typeof A){\n                        case \"object\":\n                            var aProps = Object.getOwnPropertyNames(A);\n                            var bProps = Object.getOwnPropertyNames(B);\n                            if (aProps.length != bProps.length){\n                                result = false;\n                                break;\n                            }\n                            for (var i = 0; i < aProps.length; i++) {\n                                var propName = aProps[i];\n                                if (A[propName] !== B[propName]) {\n                                    result = false;\n                                    break;\n                                }\n                            }\n                        break;\n                        default:\n                            result = A == B;\n                    }\n                    if (this.properties.OP == \"!=\") result = !result;\n                    break;\n                /*case \">\":\n                    result = A > B;\n                    break;\n                case \"<\":\n                    result = A < B;\n                    break;\n                case \"<=\":\n                    result = A <= B;\n                    break;\n                case \">=\":\n                    result = A >= B;\n                    break;\n                case \"||\":\n                    result = A || B;\n                    break;\n                case \"&&\":\n                    result = A && B;\n                    break;*/\n            }\n        }\n        this.setOutputData(0, result);\n        this.setOutputData(1, !result);\n    };\n\n    LiteGraph.registerNodeType(\"basic/CompareValues\", GenericCompare);\n    \n})(this);\n\n//event related nodes\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n    //Show value inside the debug console\n    function LogEvent() {\n        this.size = [60, 30];\n        this.addInput(\"event\", LiteGraph.ACTION);\n    }\n\n    LogEvent.title = \"Log Event\";\n    LogEvent.desc = \"Log event in console\";\n\n    LogEvent.prototype.onAction = function(action, param, options) {\n        console.log(action, param);\n    };\n\n    LiteGraph.registerNodeType(\"events/log\", LogEvent);\n\n    //convert to Event if the value is true\n    function TriggerEvent() {\n        this.size = [60, 30];\n        this.addInput(\"if\", \"\");\n        this.addOutput(\"true\", LiteGraph.EVENT);\n        this.addOutput(\"change\", LiteGraph.EVENT);\n        this.addOutput(\"false\", LiteGraph.EVENT);\n\t\tthis.properties = { only_on_change: true };\n\t\tthis.prev = 0;\n    }\n\n    TriggerEvent.title = \"TriggerEvent\";\n    TriggerEvent.desc = \"Triggers event if input evaluates to true\";\n\n    TriggerEvent.prototype.onExecute = function( param, options) {\n\t\tvar v = this.getInputData(0);\n\t\tvar changed = (v != this.prev);\n\t\tif(this.prev === 0)\n\t\t\tchanged = false;\n\t\tvar must_resend = (changed && this.properties.only_on_change) || (!changed && !this.properties.only_on_change);\n\t\tif(v && must_resend )\n\t        this.triggerSlot(0, param, null, options);\n\t\tif(!v && must_resend)\n\t        this.triggerSlot(2, param, null, options);\n\t\tif(changed)\n\t        this.triggerSlot(1, param, null, options);\n\t\tthis.prev = v;\n    };\n\n    LiteGraph.registerNodeType(\"events/trigger\", TriggerEvent);\n\n    //Sequence of events\n    function Sequence() {\n\t\tvar that = this;\n        this.addInput(\"\", LiteGraph.ACTION);\n        this.addInput(\"\", LiteGraph.ACTION);\n        this.addInput(\"\", LiteGraph.ACTION);\n        this.addOutput(\"\", LiteGraph.EVENT);\n        this.addOutput(\"\", LiteGraph.EVENT);\n        this.addOutput(\"\", LiteGraph.EVENT);\n        this.addWidget(\"button\",\"+\",null,function(){\n\t        that.addInput(\"\", LiteGraph.ACTION);\n\t        that.addOutput(\"\", LiteGraph.EVENT);\n        });\n        this.size = [90, 70];\n        this.flags = { horizontal: true, render_box: false };\n    }\n\n    Sequence.title = \"Sequence\";\n    Sequence.desc = \"Triggers a sequence of events when an event arrives\";\n\n    Sequence.prototype.getTitle = function() {\n        return \"\";\n    };\n\n    Sequence.prototype.onAction = function(action, param, options) {\n        if (this.outputs) {\n            options = options || {};\n            for (var i = 0; i < this.outputs.length; ++i) {\n\t\t\t\tvar output = this.outputs[i];\n\t\t\t\t//needs more info about this...\n\t\t\t\tif( options.action_call ) // CREATE A NEW ID FOR THE ACTION\n\t                options.action_call = options.action_call + \"_seq_\" + i;\n\t\t\t\telse\n\t\t\t\t\toptions.action_call = this.id + \"_\" + (action ? action : \"action\")+\"_seq_\"+i+\"_\"+Math.floor(Math.random()*9999);\n                this.triggerSlot(i, param, null, options);\n            }\n        }\n    };\n\n    LiteGraph.registerNodeType(\"events/sequence\", Sequence);\n\n\n    //Sequencer for events\n    function Stepper() {\n\t\tvar that = this;\n\t\tthis.properties = { index: 0 };\n        this.addInput(\"index\", \"number\");\n        this.addInput(\"step\", LiteGraph.ACTION);\n        this.addInput(\"reset\", LiteGraph.ACTION);\n        this.addOutput(\"index\", \"number\");\n        this.addOutput(\"\", LiteGraph.EVENT);\n        this.addOutput(\"\", LiteGraph.EVENT);\n        this.addOutput(\"\", LiteGraph.EVENT,{removable:true});\n        this.addWidget(\"button\",\"+\",null,function(){\n\t        that.addOutput(\"\", LiteGraph.EVENT, {removable:true});\n        });\n        this.size = [120, 120];\n        this.flags = { render_box: false };\n    }\n\n    Stepper.title = \"Stepper\";\n    Stepper.desc = \"Trigger events sequentially when an tick arrives\";\n\n\tStepper.prototype.onDrawBackground = function(ctx)\n\t{\n        if (this.flags.collapsed) {\n            return;\n        }\n\t\tvar index = this.properties.index || 0;\n        ctx.fillStyle = \"#AFB\";\n\t\tvar w = this.size[0];\n        var y = (index + 1)* LiteGraph.NODE_SLOT_HEIGHT + 4;\n        ctx.beginPath();\n        ctx.moveTo(w - 30, y);\n        ctx.lineTo(w - 30, y + LiteGraph.NODE_SLOT_HEIGHT);\n        ctx.lineTo(w - 15, y + LiteGraph.NODE_SLOT_HEIGHT * 0.5);\n        ctx.fill();\n\t}\n\n\tStepper.prototype.onExecute = function()\n\t{\n\t\tvar index = this.getInputData(0);\n\t\tif(index != null)\n\t\t{\n\t\t\tindex = Math.floor(index);\n\t\t\tindex = Math.clamp( index, 0, this.outputs ? (this.outputs.length - 2) : 0 );\n\t\t\tif( index != this.properties.index )\n\t\t\t{\n\t\t\t\tthis.properties.index = index;\n\t\t\t    this.triggerSlot( index+1 );\n\t\t\t}\n\t\t}\n\n\t\tthis.setOutputData(0, this.properties.index );\n\t}\n\n    Stepper.prototype.onAction = function(action, param) {\n\t\tif(action == \"reset\")\n\t\t\tthis.properties.index = 0;\n\t\telse if(action == \"step\")\n\t\t{\n            this.triggerSlot(this.properties.index+1, param);\n\t\t\tvar n = this.outputs ? this.outputs.length - 1 : 0;\n\t\t\tthis.properties.index = (this.properties.index + 1) % n;\n        }\n    };\n\n    LiteGraph.registerNodeType(\"events/stepper\", Stepper);\n\n    //Filter events\n    function FilterEvent() {\n        this.size = [60, 30];\n        this.addInput(\"event\", LiteGraph.ACTION);\n        this.addOutput(\"event\", LiteGraph.EVENT);\n        this.properties = {\n            equal_to: \"\",\n            has_property: \"\",\n            property_equal_to: \"\"\n        };\n    }\n\n    FilterEvent.title = \"Filter Event\";\n    FilterEvent.desc = \"Blocks events that do not match the filter\";\n\n    FilterEvent.prototype.onAction = function(action, param, options) {\n        if (param == null) {\n            return;\n        }\n\n        if (this.properties.equal_to && this.properties.equal_to != param) {\n            return;\n        }\n\n        if (this.properties.has_property) {\n            var prop = param[this.properties.has_property];\n            if (prop == null) {\n                return;\n            }\n\n            if (\n                this.properties.property_equal_to &&\n                this.properties.property_equal_to != prop\n            ) {\n                return;\n            }\n        }\n\n        this.triggerSlot(0, param, null, options);\n    };\n\n    LiteGraph.registerNodeType(\"events/filter\", FilterEvent);\n\n\n    function EventBranch() {\n        this.addInput(\"in\", LiteGraph.ACTION);\n        this.addInput(\"cond\", \"boolean\");\n        this.addOutput(\"true\", LiteGraph.EVENT);\n        this.addOutput(\"false\", LiteGraph.EVENT);\n        this.size = [120, 60];\n\t\tthis._value = false;\n    }\n\n    EventBranch.title = \"Branch\";\n    EventBranch.desc = \"If condition is true, outputs triggers true, otherwise false\";\n\n    EventBranch.prototype.onExecute = function() {\n\t\tthis._value = this.getInputData(1);\n\t}\n\n    EventBranch.prototype.onAction = function(action, param, options) {\n        this._value = this.getInputData(1);\n\t\tthis.triggerSlot(this._value ? 0 : 1, param, null, options);\n\t}\n\n    LiteGraph.registerNodeType(\"events/branch\", EventBranch);\n\n    //Show value inside the debug console\n    function EventCounter() {\n        this.addInput(\"inc\", LiteGraph.ACTION);\n        this.addInput(\"dec\", LiteGraph.ACTION);\n        this.addInput(\"reset\", LiteGraph.ACTION);\n        this.addOutput(\"change\", LiteGraph.EVENT);\n        this.addOutput(\"num\", \"number\");\n        this.addProperty(\"doCountExecution\", false, \"boolean\", {name: \"Count Executions\"});\n        this.addWidget(\"toggle\",\"Count Exec.\",this.properties.doCountExecution,\"doCountExecution\");\n        this.num = 0;\n    }\n\n    EventCounter.title = \"Counter\";\n    EventCounter.desc = \"Counts events\";\n\n    EventCounter.prototype.getTitle = function() {\n        if (this.flags.collapsed) {\n            return String(this.num);\n        }\n        return this.title;\n    };\n\n    EventCounter.prototype.onAction = function(action, param, options) {\n        var v = this.num;\n        if (action == \"inc\") {\n            this.num += 1;\n        } else if (action == \"dec\") {\n            this.num -= 1;\n        } else if (action == \"reset\") {\n            this.num = 0;\n        }\n        if (this.num != v) {\n            this.trigger(\"change\", this.num);\n        }\n    };\n\n    EventCounter.prototype.onDrawBackground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n        ctx.fillStyle = \"#AAA\";\n        ctx.font = \"20px Arial\";\n        ctx.textAlign = \"center\";\n        ctx.fillText(this.num, this.size[0] * 0.5, this.size[1] * 0.5);\n    };\n\n    EventCounter.prototype.onExecute = function() {\n        if(this.properties.doCountExecution){\n            this.num += 1;\n        }\n        this.setOutputData(1, this.num);\n    };\n\n    LiteGraph.registerNodeType(\"events/counter\", EventCounter);\n\n    //Show value inside the debug console\n    function DelayEvent() {\n        this.size = [60, 30];\n        this.addProperty(\"time_in_ms\", 1000);\n        this.addInput(\"event\", LiteGraph.ACTION);\n        this.addOutput(\"on_time\", LiteGraph.EVENT);\n\n        this._pending = [];\n    }\n\n    DelayEvent.title = \"Delay\";\n    DelayEvent.desc = \"Delays one event\";\n\n    DelayEvent.prototype.onAction = function(action, param, options) {\n        var time = this.properties.time_in_ms;\n        if (time <= 0) {\n            this.trigger(null, param, options);\n        } else {\n            this._pending.push([time, param]);\n        }\n    };\n\n    DelayEvent.prototype.onExecute = function(param, options) {\n        var dt = this.graph.elapsed_time * 1000; //in ms\n\n        if (this.isInputConnected(1)) {\n            this.properties.time_in_ms = this.getInputData(1);\n        }\n\n        for (var i = 0; i < this._pending.length; ++i) {\n            var actionPass = this._pending[i];\n            actionPass[0] -= dt;\n            if (actionPass[0] > 0) {\n                continue;\n            }\n\n            //remove\n            this._pending.splice(i, 1);\n            --i;\n\n            //trigger\n            this.trigger(null, actionPass[1], options);\n        }\n    };\n\n    DelayEvent.prototype.onGetInputs = function() {\n        return [[\"event\", LiteGraph.ACTION], [\"time_in_ms\", \"number\"]];\n    };\n\n    LiteGraph.registerNodeType(\"events/delay\", DelayEvent);\n\n    //Show value inside the debug console\n    function TimerEvent() {\n        this.addProperty(\"interval\", 1000);\n        this.addProperty(\"event\", \"tick\");\n        this.addOutput(\"on_tick\", LiteGraph.EVENT);\n        this.time = 0;\n        this.last_interval = 1000;\n        this.triggered = false;\n    }\n\n    TimerEvent.title = \"Timer\";\n    TimerEvent.desc = \"Sends an event every N milliseconds\";\n\n    TimerEvent.prototype.onStart = function() {\n        this.time = 0;\n    };\n\n    TimerEvent.prototype.getTitle = function() {\n        return \"Timer: \" + this.last_interval.toString() + \"ms\";\n    };\n\n    TimerEvent.on_color = \"#AAA\";\n    TimerEvent.off_color = \"#222\";\n\n    TimerEvent.prototype.onDrawBackground = function() {\n        this.boxcolor = this.triggered\n            ? TimerEvent.on_color\n            : TimerEvent.off_color;\n        this.triggered = false;\n    };\n\n    TimerEvent.prototype.onExecute = function() {\n        var dt = this.graph.elapsed_time * 1000; //in ms\n\n        var trigger = this.time == 0;\n\n        this.time += dt;\n        this.last_interval = Math.max(\n            1,\n            this.getInputOrProperty(\"interval\") | 0\n        );\n\n        if (\n            !trigger &&\n            (this.time < this.last_interval || isNaN(this.last_interval))\n        ) {\n            if (this.inputs && this.inputs.length > 1 && this.inputs[1]) {\n                this.setOutputData(1, false);\n            }\n            return;\n        }\n\n        this.triggered = true;\n        this.time = this.time % this.last_interval;\n        this.trigger(\"on_tick\", this.properties.event);\n        if (this.inputs && this.inputs.length > 1 && this.inputs[1]) {\n            this.setOutputData(1, true);\n        }\n    };\n\n    TimerEvent.prototype.onGetInputs = function() {\n        return [[\"interval\", \"number\"]];\n    };\n\n    TimerEvent.prototype.onGetOutputs = function() {\n        return [[\"tick\", \"boolean\"]];\n    };\n\n    LiteGraph.registerNodeType(\"events/timer\", TimerEvent);\n\n\n\n    function SemaphoreEvent() {\n        this.addInput(\"go\", LiteGraph.ACTION );\n        this.addInput(\"green\", LiteGraph.ACTION );\n        this.addInput(\"red\", LiteGraph.ACTION );\n        this.addOutput(\"continue\", LiteGraph.EVENT );\n        this.addOutput(\"blocked\", LiteGraph.EVENT );\n        this.addOutput(\"is_green\", \"boolean\" );\n\t\tthis._ready = false;\n\t\tthis.properties = {};\n\t\tvar that = this;\n\t\tthis.addWidget(\"button\",\"reset\",\"\",function(){\n\t\t\tthat._ready = false;\n\t\t});\n    }\n\n    SemaphoreEvent.title = \"Semaphore Event\";\n    SemaphoreEvent.desc = \"Until both events are not triggered, it doesnt continue.\";\n\n\tSemaphoreEvent.prototype.onExecute = function()\n\t{\n\t\tthis.setOutputData(1,this._ready);\n\t\tthis.boxcolor = this._ready ? \"#9F9\" : \"#FA5\";\n\t}\n\n    SemaphoreEvent.prototype.onAction = function(action, param) {\n\t\tif( action == \"go\" )\n\t\t\tthis.triggerSlot( this._ready ? 0 : 1 );\n\t\telse if( action == \"green\" )\n\t\t\tthis._ready = true;\n\t\telse if( action == \"red\" )\n\t\t\tthis._ready = false;\n    };\n\n    LiteGraph.registerNodeType(\"events/semaphore\", SemaphoreEvent);\n\n\n\n    function DataStore() {\n        this.addInput(\"data\", 0);\n        this.addInput(\"assign\", LiteGraph.ACTION);\n        this.addOutput(\"data\", 0);\n\t\tthis._last_value = null;\n\t\tthis.properties = { data: null, serialize: true };\n\t\tvar that = this;\n\t\tthis.addWidget(\"button\",\"store\",\"\",function(){\n\t\t\tthat.properties.data = that._last_value;\n\t\t});\n    }\n\n    DataStore.title = \"Data Store\";\n    DataStore.desc = \"Stores data and only changes when event is received\";\n\n\tDataStore.prototype.onExecute = function()\n\t{\n\t\tthis._last_value = this.getInputData(0);\n\t\tthis.setOutputData(0, this.properties.data );\n\t}\n\n    DataStore.prototype.onAction = function(action, param, options) {\n\t\tthis.properties.data = this._last_value;\n    };\n\n\tDataStore.prototype.onSerialize = function(o)\n\t{\n\t\tif(o.data == null)\n\t\t\treturn;\n\t\tif(this.properties.serialize == false || (o.data.constructor !== String && o.data.constructor !== Number && o.data.constructor !== Boolean && o.data.constructor !== Array && o.data.constructor !== Object ))\n\t\t\to.data = null;\n\t}\n\n    LiteGraph.registerNodeType(\"basic/data_store\", DataStore);\n\n\n\n})(this);\n\n//widgets\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n    /* Button ****************/\n\n    function WidgetButton() {\n        this.addOutput(\"\", LiteGraph.EVENT);\n        this.addOutput(\"\", \"boolean\");\n        this.addProperty(\"text\", \"click me\");\n        this.addProperty(\"font_size\", 30);\n        this.addProperty(\"message\", \"\");\n        this.size = [164, 84];\n        this.clicked = false;\n    }\n\n    WidgetButton.title = \"Button\";\n    WidgetButton.desc = \"Triggers an event\";\n\n    WidgetButton.font = \"Arial\";\n    WidgetButton.prototype.onDrawForeground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n        var margin = 10;\n        ctx.fillStyle = \"black\";\n        ctx.fillRect(\n            margin + 1,\n            margin + 1,\n            this.size[0] - margin * 2,\n            this.size[1] - margin * 2\n        );\n        ctx.fillStyle = \"#AAF\";\n        ctx.fillRect(\n            margin - 1,\n            margin - 1,\n            this.size[0] - margin * 2,\n            this.size[1] - margin * 2\n        );\n        ctx.fillStyle = this.clicked\n            ? \"white\"\n            : this.mouseOver\n            ? \"#668\"\n            : \"#334\";\n        ctx.fillRect(\n            margin,\n            margin,\n            this.size[0] - margin * 2,\n            this.size[1] - margin * 2\n        );\n\n        if (this.properties.text || this.properties.text === 0) {\n            var font_size = this.properties.font_size || 30;\n            ctx.textAlign = \"center\";\n            ctx.fillStyle = this.clicked ? \"black\" : \"white\";\n            ctx.font = font_size + \"px \" + WidgetButton.font;\n            ctx.fillText(\n                this.properties.text,\n                this.size[0] * 0.5,\n                this.size[1] * 0.5 + font_size * 0.3\n            );\n            ctx.textAlign = \"left\";\n        }\n    };\n\n    WidgetButton.prototype.onMouseDown = function(e, local_pos) {\n        if (\n            local_pos[0] > 1 &&\n            local_pos[1] > 1 &&\n            local_pos[0] < this.size[0] - 2 &&\n            local_pos[1] < this.size[1] - 2\n        ) {\n            this.clicked = true;\n            this.setOutputData(1, this.clicked);\n            this.triggerSlot(0, this.properties.message);\n            return true;\n        }\n    };\n\n    WidgetButton.prototype.onExecute = function() {\n        this.setOutputData(1, this.clicked);\n    };\n\n    WidgetButton.prototype.onMouseUp = function(e) {\n        this.clicked = false;\n    };\n\n    LiteGraph.registerNodeType(\"widget/button\", WidgetButton);\n\n    function WidgetToggle() {\n        this.addInput(\"\", \"boolean\");\n        this.addInput(\"e\", LiteGraph.ACTION);\n        this.addOutput(\"v\", \"boolean\");\n        this.addOutput(\"e\", LiteGraph.EVENT);\n        this.properties = { font: \"\", value: false };\n        this.size = [160, 44];\n    }\n\n    WidgetToggle.title = \"Toggle\";\n    WidgetToggle.desc = \"Toggles between true or false\";\n\n    WidgetToggle.prototype.onDrawForeground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n\n        var size = this.size[1] * 0.5;\n        var margin = 0.25;\n        var h = this.size[1] * 0.8;\n        ctx.font = this.properties.font || (size * 0.8).toFixed(0) + \"px Arial\";\n        var w = ctx.measureText(this.title).width;\n        var x = (this.size[0] - (w + size)) * 0.5;\n\n        ctx.fillStyle = \"#AAA\";\n        ctx.fillRect(x, h - size, size, size);\n\n        ctx.fillStyle = this.properties.value ? \"#AEF\" : \"#000\";\n        ctx.fillRect(\n            x + size * margin,\n            h - size + size * margin,\n            size * (1 - margin * 2),\n            size * (1 - margin * 2)\n        );\n\n        ctx.textAlign = \"left\";\n        ctx.fillStyle = \"#AAA\";\n        ctx.fillText(this.title, size * 1.2 + x, h * 0.85);\n        ctx.textAlign = \"left\";\n    };\n\n    WidgetToggle.prototype.onAction = function(action) {\n        this.properties.value = !this.properties.value;\n        this.trigger(\"e\", this.properties.value);\n    };\n\n    WidgetToggle.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v != null) {\n            this.properties.value = v;\n        }\n        this.setOutputData(0, this.properties.value);\n    };\n\n    WidgetToggle.prototype.onMouseDown = function(e, local_pos) {\n        if (\n            local_pos[0] > 1 &&\n            local_pos[1] > 1 &&\n            local_pos[0] < this.size[0] - 2 &&\n            local_pos[1] < this.size[1] - 2\n        ) {\n            this.properties.value = !this.properties.value;\n            this.graph._version++;\n            this.trigger(\"e\", this.properties.value);\n            return true;\n        }\n    };\n\n    LiteGraph.registerNodeType(\"widget/toggle\", WidgetToggle);\n\n    /* Number ****************/\n\n    function WidgetNumber() {\n        this.addOutput(\"\", \"number\");\n        this.size = [80, 60];\n        this.properties = { min: -1000, max: 1000, value: 1, step: 1 };\n        this.old_y = -1;\n        this._remainder = 0;\n        this._precision = 0;\n        this.mouse_captured = false;\n    }\n\n    WidgetNumber.title = \"Number\";\n    WidgetNumber.desc = \"Widget to select number value\";\n\n    WidgetNumber.pixels_threshold = 10;\n    WidgetNumber.markers_color = \"#666\";\n\n    WidgetNumber.prototype.onDrawForeground = function(ctx) {\n        var x = this.size[0] * 0.5;\n        var h = this.size[1];\n        if (h > 30) {\n            ctx.fillStyle = WidgetNumber.markers_color;\n            ctx.beginPath();\n            ctx.moveTo(x, h * 0.1);\n            ctx.lineTo(x + h * 0.1, h * 0.2);\n            ctx.lineTo(x + h * -0.1, h * 0.2);\n            ctx.fill();\n            ctx.beginPath();\n            ctx.moveTo(x, h * 0.9);\n            ctx.lineTo(x + h * 0.1, h * 0.8);\n            ctx.lineTo(x + h * -0.1, h * 0.8);\n            ctx.fill();\n            ctx.font = (h * 0.7).toFixed(1) + \"px Arial\";\n        } else {\n            ctx.font = (h * 0.8).toFixed(1) + \"px Arial\";\n        }\n\n        ctx.textAlign = \"center\";\n        ctx.font = (h * 0.7).toFixed(1) + \"px Arial\";\n        ctx.fillStyle = \"#EEE\";\n        ctx.fillText(\n            this.properties.value.toFixed(this._precision),\n            x,\n            h * 0.75\n        );\n    };\n\n    WidgetNumber.prototype.onExecute = function() {\n        this.setOutputData(0, this.properties.value);\n    };\n\n    WidgetNumber.prototype.onPropertyChanged = function(name, value) {\n        var t = (this.properties.step + \"\").split(\".\");\n        this._precision = t.length > 1 ? t[1].length : 0;\n    };\n\n    WidgetNumber.prototype.onMouseDown = function(e, pos) {\n        if (pos[1] < 0) {\n            return;\n        }\n\n        this.old_y = e.canvasY;\n        this.captureInput(true);\n        this.mouse_captured = true;\n\n        return true;\n    };\n\n    WidgetNumber.prototype.onMouseMove = function(e) {\n        if (!this.mouse_captured) {\n            return;\n        }\n\n        var delta = this.old_y - e.canvasY;\n        if (e.shiftKey) {\n            delta *= 10;\n        }\n        if (e.metaKey || e.altKey) {\n            delta *= 0.1;\n        }\n        this.old_y = e.canvasY;\n\n        var steps = this._remainder + delta / WidgetNumber.pixels_threshold;\n        this._remainder = steps % 1;\n        steps = steps | 0;\n\n        var v = Math.clamp(\n            this.properties.value + steps * this.properties.step,\n            this.properties.min,\n            this.properties.max\n        );\n        this.properties.value = v;\n        this.graph._version++;\n        this.setDirtyCanvas(true);\n    };\n\n    WidgetNumber.prototype.onMouseUp = function(e, pos) {\n        if (e.click_time < 200) {\n            var steps = pos[1] > this.size[1] * 0.5 ? -1 : 1;\n            this.properties.value = Math.clamp(\n                this.properties.value + steps * this.properties.step,\n                this.properties.min,\n                this.properties.max\n            );\n            this.graph._version++;\n            this.setDirtyCanvas(true);\n        }\n\n        if (this.mouse_captured) {\n            this.mouse_captured = false;\n            this.captureInput(false);\n        }\n    };\n\n    LiteGraph.registerNodeType(\"widget/number\", WidgetNumber);\n\n\n    /* Combo ****************/\n\n    function WidgetCombo() {\n        this.addOutput(\"\", \"string\");\n        this.addOutput(\"change\", LiteGraph.EVENT);\n        this.size = [80, 60];\n        this.properties = { value: \"A\", values:\"A;B;C\" };\n        this.old_y = -1;\n        this.mouse_captured = false;\n\t\tthis._values = this.properties.values.split(\";\");\n\t\tvar that = this;\n        this.widgets_up = true;\n\t\tthis.widget = this.addWidget(\"combo\",\"\", this.properties.value, function(v){\n\t\t\tthat.properties.value = v;\n            that.triggerSlot(1, v);\n\t\t}, { property: \"value\", values: this._values } );\n    }\n\n    WidgetCombo.title = \"Combo\";\n    WidgetCombo.desc = \"Widget to select from a list\";\n\n    WidgetCombo.prototype.onExecute = function() {\n        this.setOutputData( 0, this.properties.value );\n    };\n\n    WidgetCombo.prototype.onPropertyChanged = function(name, value) {\n\t\tif(name == \"values\")\n\t\t{\n\t\t\tthis._values = value.split(\";\");\n\t\t\tthis.widget.options.values = this._values;\n\t\t}\n\t\telse if(name == \"value\")\n\t\t{\n\t\t\tthis.widget.value = value;\n\t\t}\n\t};\n\n    LiteGraph.registerNodeType(\"widget/combo\", WidgetCombo);\n\n\n    /* Knob ****************/\n\n    function WidgetKnob() {\n        this.addOutput(\"\", \"number\");\n        this.size = [64, 84];\n        this.properties = {\n            min: 0,\n            max: 1,\n            value: 0.5,\n            color: \"#7AF\",\n            precision: 2\n        };\n        this.value = -1;\n    }\n\n    WidgetKnob.title = \"Knob\";\n    WidgetKnob.desc = \"Circular controller\";\n    WidgetKnob.size = [80, 100];\n\n    WidgetKnob.prototype.onDrawForeground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n\n        if (this.value == -1) {\n            this.value =\n                (this.properties.value - this.properties.min) /\n                (this.properties.max - this.properties.min);\n        }\n\n        var center_x = this.size[0] * 0.5;\n        var center_y = this.size[1] * 0.5;\n        var radius = Math.min(this.size[0], this.size[1]) * 0.5 - 5;\n        var w = Math.floor(radius * 0.05);\n\n        ctx.globalAlpha = 1;\n        ctx.save();\n        ctx.translate(center_x, center_y);\n        ctx.rotate(Math.PI * 0.75);\n\n        //bg\n        ctx.fillStyle = \"rgba(0,0,0,0.5)\";\n        ctx.beginPath();\n        ctx.moveTo(0, 0);\n        ctx.arc(0, 0, radius, 0, Math.PI * 1.5);\n        ctx.fill();\n\n        //value\n        ctx.strokeStyle = \"black\";\n        ctx.fillStyle = this.properties.color;\n        ctx.lineWidth = 2;\n        ctx.beginPath();\n        ctx.moveTo(0, 0);\n        ctx.arc(\n            0,\n            0,\n            radius - 4,\n            0,\n            Math.PI * 1.5 * Math.max(0.01, this.value)\n        );\n        ctx.closePath();\n        ctx.fill();\n        //ctx.stroke();\n        ctx.lineWidth = 1;\n        ctx.globalAlpha = 1;\n        ctx.restore();\n\n        //inner\n        ctx.fillStyle = \"black\";\n        ctx.beginPath();\n        ctx.arc(center_x, center_y, radius * 0.75, 0, Math.PI * 2, true);\n        ctx.fill();\n\n        //miniball\n        ctx.fillStyle = this.mouseOver ? \"white\" : this.properties.color;\n        ctx.beginPath();\n        var angle = this.value * Math.PI * 1.5 + Math.PI * 0.75;\n        ctx.arc(\n            center_x + Math.cos(angle) * radius * 0.65,\n            center_y + Math.sin(angle) * radius * 0.65,\n            radius * 0.05,\n            0,\n            Math.PI * 2,\n            true\n        );\n        ctx.fill();\n\n        //text\n        ctx.fillStyle = this.mouseOver ? \"white\" : \"#AAA\";\n        ctx.font = Math.floor(radius * 0.5) + \"px Arial\";\n        ctx.textAlign = \"center\";\n        ctx.fillText(\n            this.properties.value.toFixed(this.properties.precision),\n            center_x,\n            center_y + radius * 0.15\n        );\n    };\n\n    WidgetKnob.prototype.onExecute = function() {\n        this.setOutputData(0, this.properties.value);\n        this.boxcolor = LiteGraph.colorToString([\n            this.value,\n            this.value,\n            this.value\n        ]);\n    };\n\n    WidgetKnob.prototype.onMouseDown = function(e) {\n        this.center = [this.size[0] * 0.5, this.size[1] * 0.5 + 20];\n        this.radius = this.size[0] * 0.5;\n        if (\n            e.canvasY - this.pos[1] < 20 ||\n            LiteGraph.distance(\n                [e.canvasX, e.canvasY],\n                [this.pos[0] + this.center[0], this.pos[1] + this.center[1]]\n            ) > this.radius\n        ) {\n            return false;\n        }\n        this.oldmouse = [e.canvasX - this.pos[0], e.canvasY - this.pos[1]];\n        this.captureInput(true);\n        return true;\n    };\n\n    WidgetKnob.prototype.onMouseMove = function(e) {\n        if (!this.oldmouse) {\n            return;\n        }\n\n        var m = [e.canvasX - this.pos[0], e.canvasY - this.pos[1]];\n\n        var v = this.value;\n        v -= (m[1] - this.oldmouse[1]) * 0.01;\n        if (v > 1.0) {\n            v = 1.0;\n        } else if (v < 0.0) {\n            v = 0.0;\n        }\n        this.value = v;\n        this.properties.value =\n            this.properties.min +\n            (this.properties.max - this.properties.min) * this.value;\n        this.oldmouse = m;\n        this.setDirtyCanvas(true);\n    };\n\n    WidgetKnob.prototype.onMouseUp = function(e) {\n        if (this.oldmouse) {\n            this.oldmouse = null;\n            this.captureInput(false);\n        }\n    };\n\n    WidgetKnob.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"min\" || name == \"max\" || name == \"value\") {\n            this.properties[name] = parseFloat(value);\n            return true; //block\n        }\n    };\n\n    LiteGraph.registerNodeType(\"widget/knob\", WidgetKnob);\n\n    //Show value inside the debug console\n    function WidgetSliderGUI() {\n        this.addOutput(\"\", \"number\");\n        this.properties = {\n            value: 0.5,\n            min: 0,\n            max: 1,\n            text: \"V\"\n        };\n        var that = this;\n        this.size = [140, 40];\n        this.slider = this.addWidget(\n            \"slider\",\n            \"V\",\n            this.properties.value,\n            function(v) {\n                that.properties.value = v;\n            },\n            this.properties\n        );\n        this.widgets_up = true;\n    }\n\n    WidgetSliderGUI.title = \"Inner Slider\";\n\n    WidgetSliderGUI.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"value\") {\n            this.slider.value = value;\n        }\n    };\n\n    WidgetSliderGUI.prototype.onExecute = function() {\n        this.setOutputData(0, this.properties.value);\n    };\n\n    LiteGraph.registerNodeType(\"widget/internal_slider\", WidgetSliderGUI);\n\n    //Widget H SLIDER\n    function WidgetHSlider() {\n        this.size = [160, 26];\n        this.addOutput(\"\", \"number\");\n        this.properties = { color: \"#7AF\", min: 0, max: 1, value: 0.5 };\n        this.value = -1;\n    }\n\n    WidgetHSlider.title = \"H.Slider\";\n    WidgetHSlider.desc = \"Linear slider controller\";\n\n    WidgetHSlider.prototype.onDrawForeground = function(ctx) {\n        if (this.value == -1) {\n            this.value =\n                (this.properties.value - this.properties.min) /\n                (this.properties.max - this.properties.min);\n        }\n\n        //border\n        ctx.globalAlpha = 1;\n        ctx.lineWidth = 1;\n        ctx.fillStyle = \"#000\";\n        ctx.fillRect(2, 2, this.size[0] - 4, this.size[1] - 4);\n\n        ctx.fillStyle = this.properties.color;\n        ctx.beginPath();\n        ctx.rect(4, 4, (this.size[0] - 8) * this.value, this.size[1] - 8);\n        ctx.fill();\n    };\n\n    WidgetHSlider.prototype.onExecute = function() {\n        this.properties.value =\n            this.properties.min +\n            (this.properties.max - this.properties.min) * this.value;\n        this.setOutputData(0, this.properties.value);\n        this.boxcolor = LiteGraph.colorToString([\n            this.value,\n            this.value,\n            this.value\n        ]);\n    };\n\n    WidgetHSlider.prototype.onMouseDown = function(e) {\n        if (e.canvasY - this.pos[1] < 0) {\n            return false;\n        }\n\n        this.oldmouse = [e.canvasX - this.pos[0], e.canvasY - this.pos[1]];\n        this.captureInput(true);\n        return true;\n    };\n\n    WidgetHSlider.prototype.onMouseMove = function(e) {\n        if (!this.oldmouse) {\n            return;\n        }\n\n        var m = [e.canvasX - this.pos[0], e.canvasY - this.pos[1]];\n\n        var v = this.value;\n        var delta = m[0] - this.oldmouse[0];\n        v += delta / this.size[0];\n        if (v > 1.0) {\n            v = 1.0;\n        } else if (v < 0.0) {\n            v = 0.0;\n        }\n\n        this.value = v;\n\n        this.oldmouse = m;\n        this.setDirtyCanvas(true);\n    };\n\n    WidgetHSlider.prototype.onMouseUp = function(e) {\n        this.oldmouse = null;\n        this.captureInput(false);\n    };\n\n    WidgetHSlider.prototype.onMouseLeave = function(e) {\n        //this.oldmouse = null;\n    };\n\n    LiteGraph.registerNodeType(\"widget/hslider\", WidgetHSlider);\n\n    function WidgetProgress() {\n        this.size = [160, 26];\n        this.addInput(\"\", \"number\");\n        this.properties = { min: 0, max: 1, value: 0, color: \"#AAF\" };\n    }\n\n    WidgetProgress.title = \"Progress\";\n    WidgetProgress.desc = \"Shows data in linear progress\";\n\n    WidgetProgress.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v != undefined) {\n            this.properties[\"value\"] = v;\n        }\n    };\n\n    WidgetProgress.prototype.onDrawForeground = function(ctx) {\n        //border\n        ctx.lineWidth = 1;\n        ctx.fillStyle = this.properties.color;\n        var v =\n            (this.properties.value - this.properties.min) /\n            (this.properties.max - this.properties.min);\n        v = Math.min(1, v);\n        v = Math.max(0, v);\n        ctx.fillRect(2, 2, (this.size[0] - 4) * v, this.size[1] - 4);\n    };\n\n    LiteGraph.registerNodeType(\"widget/progress\", WidgetProgress);\n\n    function WidgetText() {\n        this.addInputs(\"\", 0);\n        this.properties = {\n            value: \"...\",\n            font: \"Arial\",\n            fontsize: 18,\n            color: \"#AAA\",\n            align: \"left\",\n            glowSize: 0,\n            decimals: 1\n        };\n    }\n\n    WidgetText.title = \"Text\";\n    WidgetText.desc = \"Shows the input value\";\n    WidgetText.widgets = [\n        { name: \"resize\", text: \"Resize box\", type: \"button\" },\n        { name: \"led_text\", text: \"LED\", type: \"minibutton\" },\n        { name: \"normal_text\", text: \"Normal\", type: \"minibutton\" }\n    ];\n\n    WidgetText.prototype.onDrawForeground = function(ctx) {\n        //ctx.fillStyle=\"#000\";\n        //ctx.fillRect(0,0,100,60);\n        ctx.fillStyle = this.properties[\"color\"];\n        var v = this.properties[\"value\"];\n\n        if (this.properties[\"glowSize\"]) {\n            ctx.shadowColor = this.properties.color;\n            ctx.shadowOffsetX = 0;\n            ctx.shadowOffsetY = 0;\n            ctx.shadowBlur = this.properties[\"glowSize\"];\n        } else {\n            ctx.shadowColor = \"transparent\";\n        }\n\n        var fontsize = this.properties[\"fontsize\"];\n\n        ctx.textAlign = this.properties[\"align\"];\n        ctx.font = fontsize.toString() + \"px \" + this.properties[\"font\"];\n        this.str =\n            typeof v == \"number\" ? v.toFixed(this.properties[\"decimals\"]) : v;\n\n        if (typeof this.str == \"string\") {\n            var lines = this.str.replace(/[\\r\\n]/g, \"\\\\n\").split(\"\\\\n\");\n            for (var i=0; i < lines.length; i++) {\n                ctx.fillText(\n                    lines[i],\n                    this.properties[\"align\"] == \"left\" ? 15 : this.size[0] - 15,\n                    fontsize * -0.15 + fontsize * (parseInt(i) + 1)\n                );\n            }\n        }\n\n        ctx.shadowColor = \"transparent\";\n        this.last_ctx = ctx;\n        ctx.textAlign = \"left\";\n    };\n\n    WidgetText.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v != null) {\n            this.properties[\"value\"] = v;\n        }\n        //this.setDirtyCanvas(true);\n    };\n\n    WidgetText.prototype.resize = function() {\n        if (!this.last_ctx) {\n            return;\n        }\n\n        var lines = this.str.split(\"\\\\n\");\n        this.last_ctx.font =\n            this.properties[\"fontsize\"] + \"px \" + this.properties[\"font\"];\n        var max = 0;\n        for (var i=0; i < lines.length; i++) {\n            var w = this.last_ctx.measureText(lines[i]).width;\n            if (max < w) {\n                max = w;\n            }\n        }\n        this.size[0] = max + 20;\n        this.size[1] = 4 + lines.length * this.properties[\"fontsize\"];\n\n        this.setDirtyCanvas(true);\n    };\n\n    WidgetText.prototype.onPropertyChanged = function(name, value) {\n        this.properties[name] = value;\n        this.str = typeof value == \"number\" ? value.toFixed(3) : value;\n        //this.resize();\n        return true;\n    };\n\n    LiteGraph.registerNodeType(\"widget/text\", WidgetText);\n\n    function WidgetPanel() {\n        this.size = [200, 100];\n        this.properties = {\n            borderColor: \"#ffffff\",\n            bgcolorTop: \"#f0f0f0\",\n            bgcolorBottom: \"#e0e0e0\",\n            shadowSize: 2,\n            borderRadius: 3\n        };\n    }\n\n    WidgetPanel.title = \"Panel\";\n    WidgetPanel.desc = \"Non interactive panel\";\n    WidgetPanel.widgets = [{ name: \"update\", text: \"Update\", type: \"button\" }];\n\n    WidgetPanel.prototype.createGradient = function(ctx) {\n        if (\n            this.properties[\"bgcolorTop\"] == \"\" ||\n            this.properties[\"bgcolorBottom\"] == \"\"\n        ) {\n            this.lineargradient = 0;\n            return;\n        }\n\n        this.lineargradient = ctx.createLinearGradient(0, 0, 0, this.size[1]);\n        this.lineargradient.addColorStop(0, this.properties[\"bgcolorTop\"]);\n        this.lineargradient.addColorStop(1, this.properties[\"bgcolorBottom\"]);\n    };\n\n    WidgetPanel.prototype.onDrawForeground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n\n        if (this.lineargradient == null) {\n            this.createGradient(ctx);\n        }\n\n        if (!this.lineargradient) {\n            return;\n        }\n\n        ctx.lineWidth = 1;\n        ctx.strokeStyle = this.properties[\"borderColor\"];\n        //ctx.fillStyle = \"#ebebeb\";\n        ctx.fillStyle = this.lineargradient;\n\n        if (this.properties[\"shadowSize\"]) {\n            ctx.shadowColor = \"#000\";\n            ctx.shadowOffsetX = 0;\n            ctx.shadowOffsetY = 0;\n            ctx.shadowBlur = this.properties[\"shadowSize\"];\n        } else {\n            ctx.shadowColor = \"transparent\";\n        }\n\n        ctx.roundRect(\n            0,\n            0,\n            this.size[0] - 1,\n            this.size[1] - 1,\n            this.properties[\"shadowSize\"]\n        );\n        ctx.fill();\n        ctx.shadowColor = \"transparent\";\n        ctx.stroke();\n    };\n\n    LiteGraph.registerNodeType(\"widget/panel\", WidgetPanel);\n})(this);\n\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n    function GamepadInput() {\n        this.addOutput(\"left_x_axis\", \"number\");\n        this.addOutput(\"left_y_axis\", \"number\");\n        this.addOutput(\"button_pressed\", LiteGraph.EVENT);\n        this.properties = { gamepad_index: 0, threshold: 0.1 };\n\n        this._left_axis = new Float32Array(2);\n        this._right_axis = new Float32Array(2);\n        this._triggers = new Float32Array(2);\n        this._previous_buttons = new Uint8Array(17);\n        this._current_buttons = new Uint8Array(17);\n    }\n\n    GamepadInput.title = \"Gamepad\";\n    GamepadInput.desc = \"gets the input of the gamepad\";\n\n    GamepadInput.CENTER = 0;\n    GamepadInput.LEFT = 1;\n    GamepadInput.RIGHT = 2;\n    GamepadInput.UP = 4;\n    GamepadInput.DOWN = 8;\n\n    GamepadInput.zero = new Float32Array(2);\n    GamepadInput.buttons = [\n        \"a\",\n        \"b\",\n        \"x\",\n        \"y\",\n        \"lb\",\n        \"rb\",\n        \"lt\",\n        \"rt\",\n        \"back\",\n        \"start\",\n        \"ls\",\n        \"rs\",\n        \"home\"\n    ];\n\n    GamepadInput.prototype.onExecute = function() {\n        //get gamepad\n        var gamepad = this.getGamepad();\n        var threshold = this.properties.threshold || 0.0;\n\n        if (gamepad) {\n            this._left_axis[0] =\n                Math.abs(gamepad.xbox.axes[\"lx\"]) > threshold\n                    ? gamepad.xbox.axes[\"lx\"]\n                    : 0;\n            this._left_axis[1] =\n                Math.abs(gamepad.xbox.axes[\"ly\"]) > threshold\n                    ? gamepad.xbox.axes[\"ly\"]\n                    : 0;\n            this._right_axis[0] =\n                Math.abs(gamepad.xbox.axes[\"rx\"]) > threshold\n                    ? gamepad.xbox.axes[\"rx\"]\n                    : 0;\n            this._right_axis[1] =\n                Math.abs(gamepad.xbox.axes[\"ry\"]) > threshold\n                    ? gamepad.xbox.axes[\"ry\"]\n                    : 0;\n            this._triggers[0] =\n                Math.abs(gamepad.xbox.axes[\"ltrigger\"]) > threshold\n                    ? gamepad.xbox.axes[\"ltrigger\"]\n                    : 0;\n            this._triggers[1] =\n                Math.abs(gamepad.xbox.axes[\"rtrigger\"]) > threshold\n                    ? gamepad.xbox.axes[\"rtrigger\"]\n                    : 0;\n        }\n\n        if (this.outputs) {\n            for (var i = 0; i < this.outputs.length; i++) {\n                var output = this.outputs[i];\n                if (!output.links || !output.links.length) {\n                    continue;\n                }\n                var v = null;\n\n                if (gamepad) {\n                    switch (output.name) {\n                        case \"left_axis\":\n                            v = this._left_axis;\n                            break;\n                        case \"right_axis\":\n                            v = this._right_axis;\n                            break;\n                        case \"left_x_axis\":\n                            v = this._left_axis[0];\n                            break;\n                        case \"left_y_axis\":\n                            v = this._left_axis[1];\n                            break;\n                        case \"right_x_axis\":\n                            v = this._right_axis[0];\n                            break;\n                        case \"right_y_axis\":\n                            v = this._right_axis[1];\n                            break;\n                        case \"trigger_left\":\n                            v = this._triggers[0];\n                            break;\n                        case \"trigger_right\":\n                            v = this._triggers[1];\n                            break;\n                        case \"a_button\":\n                            v = gamepad.xbox.buttons[\"a\"] ? 1 : 0;\n                            break;\n                        case \"b_button\":\n                            v = gamepad.xbox.buttons[\"b\"] ? 1 : 0;\n                            break;\n                        case \"x_button\":\n                            v = gamepad.xbox.buttons[\"x\"] ? 1 : 0;\n                            break;\n                        case \"y_button\":\n                            v = gamepad.xbox.buttons[\"y\"] ? 1 : 0;\n                            break;\n                        case \"lb_button\":\n                            v = gamepad.xbox.buttons[\"lb\"] ? 1 : 0;\n                            break;\n                        case \"rb_button\":\n                            v = gamepad.xbox.buttons[\"rb\"] ? 1 : 0;\n                            break;\n                        case \"ls_button\":\n                            v = gamepad.xbox.buttons[\"ls\"] ? 1 : 0;\n                            break;\n                        case \"rs_button\":\n                            v = gamepad.xbox.buttons[\"rs\"] ? 1 : 0;\n                            break;\n                        case \"hat_left\":\n                            v = gamepad.xbox.hatmap & GamepadInput.LEFT;\n                            break;\n                        case \"hat_right\":\n                            v = gamepad.xbox.hatmap & GamepadInput.RIGHT;\n                            break;\n                        case \"hat_up\":\n                            v = gamepad.xbox.hatmap & GamepadInput.UP;\n                            break;\n                        case \"hat_down\":\n                            v = gamepad.xbox.hatmap & GamepadInput.DOWN;\n                            break;\n                        case \"hat\":\n                            v = gamepad.xbox.hatmap;\n                            break;\n                        case \"start_button\":\n                            v = gamepad.xbox.buttons[\"start\"] ? 1 : 0;\n                            break;\n                        case \"back_button\":\n                            v = gamepad.xbox.buttons[\"back\"] ? 1 : 0;\n                            break;\n                        case \"button_pressed\":\n                            for (\n                                var j = 0;\n                                j < this._current_buttons.length;\n                                ++j\n                            ) {\n                                if (\n                                    this._current_buttons[j] &&\n                                    !this._previous_buttons[j]\n                                ) {\n                                    this.triggerSlot(\n                                        i,\n                                        GamepadInput.buttons[j]\n                                    );\n                                }\n                            }\n                            break;\n                        default:\n                            break;\n                    }\n                } else {\n                    //if no gamepad is connected, output 0\n                    switch (output.name) {\n                        case \"button_pressed\":\n                            break;\n                        case \"left_axis\":\n                        case \"right_axis\":\n                            v = GamepadInput.zero;\n                            break;\n                        default:\n                            v = 0;\n                    }\n                }\n                this.setOutputData(i, v);\n            }\n        }\n    };\n\n\tGamepadInput.mapping = {a:0,b:1,x:2,y:3,lb:4,rb:5,lt:6,rt:7,back:8,start:9,ls:10,rs:11 };\n\tGamepadInput.mapping_array = [\"a\",\"b\",\"x\",\"y\",\"lb\",\"rb\",\"lt\",\"rt\",\"back\",\"start\",\"ls\",\"rs\"];\n\n    GamepadInput.prototype.getGamepad = function() {\n        var getGamepads =\n            navigator.getGamepads ||\n            navigator.webkitGetGamepads ||\n            navigator.mozGetGamepads;\n        if (!getGamepads) {\n            return null;\n        }\n        var gamepads = getGamepads.call(navigator);\n        var gamepad = null;\n\n        this._previous_buttons.set(this._current_buttons);\n\n        //pick the first connected\n        for (var i = this.properties.gamepad_index; i < 4; i++) {\n            if (!gamepads[i]) {\n                continue;\n            }\n            gamepad = gamepads[i];\n\n            //xbox controller mapping\n            var xbox = this.xbox_mapping;\n            if (!xbox) {\n                xbox = this.xbox_mapping = {\n                    axes: [],\n                    buttons: {},\n                    hat: \"\",\n                    hatmap: GamepadInput.CENTER\n                };\n            }\n\n            xbox.axes[\"lx\"] = gamepad.axes[0];\n            xbox.axes[\"ly\"] = gamepad.axes[1];\n            xbox.axes[\"rx\"] = gamepad.axes[2];\n            xbox.axes[\"ry\"] = gamepad.axes[3];\n            xbox.axes[\"ltrigger\"] = gamepad.buttons[6].value;\n            xbox.axes[\"rtrigger\"] = gamepad.buttons[7].value;\n            xbox.hat = \"\";\n            xbox.hatmap = GamepadInput.CENTER;\n\n            for (var j = 0; j < gamepad.buttons.length; j++) {\n                this._current_buttons[j] = gamepad.buttons[j].pressed;\n\n\t\t\t\tif(j < 12)\n\t\t\t\t{\n\t\t\t\t\txbox.buttons[ GamepadInput.mapping_array[j] ] = gamepad.buttons[j].pressed;\n\t\t\t\t\tif(gamepad.buttons[j].was_pressed)\n\t\t\t\t\t\tthis.trigger( GamepadInput.mapping_array[j] + \"_button_event\" );\n\t\t\t\t}\n\t\t\t\telse //mapping of XBOX\n\t\t\t\t\tswitch ( j ) //I use a switch to ensure that a player with another gamepad could play\n\t\t\t\t\t{\n\t\t\t\t\t\tcase 12:\n\t\t\t\t\t\t\tif (gamepad.buttons[j].pressed) {\n\t\t\t\t\t\t\t\txbox.hat += \"up\";\n\t\t\t\t\t\t\t\txbox.hatmap |= GamepadInput.UP;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 13:\n\t\t\t\t\t\t\tif (gamepad.buttons[j].pressed) {\n\t\t\t\t\t\t\t\txbox.hat += \"down\";\n\t\t\t\t\t\t\t\txbox.hatmap |= GamepadInput.DOWN;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 14:\n\t\t\t\t\t\t\tif (gamepad.buttons[j].pressed) {\n\t\t\t\t\t\t\t\txbox.hat += \"left\";\n\t\t\t\t\t\t\t\txbox.hatmap |= GamepadInput.LEFT;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 15:\n\t\t\t\t\t\t\tif (gamepad.buttons[j].pressed) {\n\t\t\t\t\t\t\t\txbox.hat += \"right\";\n\t\t\t\t\t\t\t\txbox.hatmap |= GamepadInput.RIGHT;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 16:\n\t\t\t\t\t\t\txbox.buttons[\"home\"] = gamepad.buttons[j].pressed;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t}\n            }\n            gamepad.xbox = xbox;\n            return gamepad;\n        }\n    };\n\n    GamepadInput.prototype.onDrawBackground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n\n        //render gamepad state?\n        var la = this._left_axis;\n        var ra = this._right_axis;\n        ctx.strokeStyle = \"#88A\";\n        ctx.strokeRect(\n            (la[0] + 1) * 0.5 * this.size[0] - 4,\n            (la[1] + 1) * 0.5 * this.size[1] - 4,\n            8,\n            8\n        );\n        ctx.strokeStyle = \"#8A8\";\n        ctx.strokeRect(\n            (ra[0] + 1) * 0.5 * this.size[0] - 4,\n            (ra[1] + 1) * 0.5 * this.size[1] - 4,\n            8,\n            8\n        );\n        var h = this.size[1] / this._current_buttons.length;\n        ctx.fillStyle = \"#AEB\";\n        for (var i = 0; i < this._current_buttons.length; ++i) {\n            if (this._current_buttons[i]) {\n                ctx.fillRect(0, h * i, 6, h);\n            }\n        }\n    };\n\n    GamepadInput.prototype.onGetOutputs = function() {\n        return [\n            [\"left_axis\", \"vec2\"],\n            [\"right_axis\", \"vec2\"],\n            [\"left_x_axis\", \"number\"],\n            [\"left_y_axis\", \"number\"],\n            [\"right_x_axis\", \"number\"],\n            [\"right_y_axis\", \"number\"],\n            [\"trigger_left\", \"number\"],\n            [\"trigger_right\", \"number\"],\n            [\"a_button\", \"number\"],\n            [\"b_button\", \"number\"],\n            [\"x_button\", \"number\"],\n            [\"y_button\", \"number\"],\n            [\"lb_button\", \"number\"],\n            [\"rb_button\", \"number\"],\n            [\"ls_button\", \"number\"],\n            [\"rs_button\", \"number\"],\n            [\"start_button\", \"number\"],\n            [\"back_button\", \"number\"],\n            [\"a_button_event\", LiteGraph.EVENT ],\n            [\"b_button_event\", LiteGraph.EVENT ],\n            [\"x_button_event\", LiteGraph.EVENT ],\n            [\"y_button_event\", LiteGraph.EVENT ],\n            [\"lb_button_event\", LiteGraph.EVENT ],\n            [\"rb_button_event\", LiteGraph.EVENT ],\n            [\"ls_button_event\", LiteGraph.EVENT ],\n            [\"rs_button_event\", LiteGraph.EVENT ],\n            [\"start_button_event\", LiteGraph.EVENT ],\n            [\"back_button_event\", LiteGraph.EVENT ],\n            [\"hat_left\", \"number\"],\n            [\"hat_right\", \"number\"],\n            [\"hat_up\", \"number\"],\n            [\"hat_down\", \"number\"],\n            [\"hat\", \"number\"],\n            [\"button_pressed\", LiteGraph.EVENT]\n        ];\n    };\n\n    LiteGraph.registerNodeType(\"input/gamepad\", GamepadInput);\n\n})(this);\n\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n    //Converter\n    function Converter() {\n        this.addInput(\"in\", 0);\n\t\tthis.addOutput(\"out\", 0);\n        this.size = [80, 30];\n    }\n\n    Converter.title = \"Converter\";\n    Converter.desc = \"type A to type B\";\n\n    Converter.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            return;\n        }\n\n        if (this.outputs) {\n            for (var i = 0; i < this.outputs.length; i++) {\n                var output = this.outputs[i];\n                if (!output.links || !output.links.length) {\n                    continue;\n                }\n\n                var result = null;\n                switch (output.name) {\n                    case \"number\":\n                        result = v.length ? v[0] : parseFloat(v);\n                        break;\n                    case \"vec2\":\n                    case \"vec3\":\n                    case \"vec4\":\n                        var result = null;\n                        var count = 1;\n                        switch (output.name) {\n                            case \"vec2\":\n                                count = 2;\n                                break;\n                            case \"vec3\":\n                                count = 3;\n                                break;\n                            case \"vec4\":\n                                count = 4;\n                                break;\n                        }\n\n                        var result = new Float32Array(count);\n                        if (v.length) {\n                            for (\n                                var j = 0;\n                                j < v.length && j < result.length;\n                                j++\n                            ) {\n                                result[j] = v[j];\n                            }\n                        } else {\n                            result[0] = parseFloat(v);\n                        }\n                        break;\n                }\n                this.setOutputData(i, result);\n            }\n        }\n    };\n\n    Converter.prototype.onGetOutputs = function() {\n        return [\n            [\"number\", \"number\"],\n            [\"vec2\", \"vec2\"],\n            [\"vec3\", \"vec3\"],\n            [\"vec4\", \"vec4\"]\n        ];\n    };\n\n    LiteGraph.registerNodeType(\"math/converter\", Converter);\n\n    //Bypass\n    function Bypass() {\n        this.addInput(\"in\");\n        this.addOutput(\"out\");\n        this.size = [80, 30];\n    }\n\n    Bypass.title = \"Bypass\";\n    Bypass.desc = \"removes the type\";\n\n    Bypass.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        this.setOutputData(0, v);\n    };\n\n    LiteGraph.registerNodeType(\"math/bypass\", Bypass);\n\n    function ToNumber() {\n        this.addInput(\"in\");\n        this.addOutput(\"out\");\n    }\n\n    ToNumber.title = \"to Number\";\n    ToNumber.desc = \"Cast to number\";\n\n    ToNumber.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        this.setOutputData(0, Number(v));\n    };\n\n    LiteGraph.registerNodeType(\"math/to_number\", ToNumber);\n\n    function MathRange() {\n        this.addInput(\"in\", \"number\", { locked: true });\n        this.addOutput(\"out\", \"number\", { locked: true });\n        this.addOutput(\"clamped\", \"number\", { locked: true });\n\n        this.addProperty(\"in\", 0);\n        this.addProperty(\"in_min\", 0);\n        this.addProperty(\"in_max\", 1);\n        this.addProperty(\"out_min\", 0);\n        this.addProperty(\"out_max\", 1);\n\n        this.size = [120, 50];\n    }\n\n    MathRange.title = \"Range\";\n    MathRange.desc = \"Convert a number from one range to another\";\n\n    MathRange.prototype.getTitle = function() {\n        if (this.flags.collapsed) {\n            return (this._last_v || 0).toFixed(2);\n        }\n        return this.title;\n    };\n\n    MathRange.prototype.onExecute = function() {\n        if (this.inputs) {\n            for (var i = 0; i < this.inputs.length; i++) {\n                var input = this.inputs[i];\n                var v = this.getInputData(i);\n                if (v === undefined) {\n                    continue;\n                }\n                this.properties[input.name] = v;\n            }\n        }\n\n        var v = this.properties[\"in\"];\n        if (v === undefined || v === null || v.constructor !== Number) {\n            v = 0;\n        }\n\n        var in_min = this.properties.in_min;\n        var in_max = this.properties.in_max;\n        var out_min = this.properties.out_min;\n        var out_max = this.properties.out_max;\n\t\t/*\n\t\tif( in_min > in_max )\n\t\t{\n\t\t\tin_min = in_max;\n\t\t\tin_max = this.properties.in_min;\n\t\t}\n\t\tif( out_min > out_max )\n\t\t{\n\t\t\tout_min = out_max;\n\t\t\tout_max = this.properties.out_min;\n\t\t}\n\t\t*/\n\n        this._last_v = ((v - in_min) / (in_max - in_min)) * (out_max - out_min) + out_min;\n        this.setOutputData(0, this._last_v);\n        this.setOutputData(1, Math.clamp( this._last_v, out_min, out_max ));\n    };\n\n    MathRange.prototype.onDrawBackground = function(ctx) {\n        //show the current value\n        if (this._last_v) {\n            this.outputs[0].label = this._last_v.toFixed(3);\n        } else {\n            this.outputs[0].label = \"?\";\n        }\n    };\n\n    MathRange.prototype.onGetInputs = function() {\n        return [\n            [\"in_min\", \"number\"],\n            [\"in_max\", \"number\"],\n            [\"out_min\", \"number\"],\n            [\"out_max\", \"number\"]\n        ];\n    };\n\n    LiteGraph.registerNodeType(\"math/range\", MathRange);\n\n    function MathRand() {\n        this.addOutput(\"value\", \"number\");\n        this.addProperty(\"min\", 0);\n        this.addProperty(\"max\", 1);\n        this.size = [80, 30];\n    }\n\n    MathRand.title = \"Rand\";\n    MathRand.desc = \"Random number\";\n\n    MathRand.prototype.onExecute = function() {\n        if (this.inputs) {\n            for (var i = 0; i < this.inputs.length; i++) {\n                var input = this.inputs[i];\n                var v = this.getInputData(i);\n                if (v === undefined) {\n                    continue;\n                }\n                this.properties[input.name] = v;\n            }\n        }\n\n        var min = this.properties.min;\n        var max = this.properties.max;\n        this._last_v = Math.random() * (max - min) + min;\n        this.setOutputData(0, this._last_v);\n    };\n\n    MathRand.prototype.onDrawBackground = function(ctx) {\n        //show the current value\n        this.outputs[0].label = (this._last_v || 0).toFixed(3);\n    };\n\n    MathRand.prototype.onGetInputs = function() {\n        return [[\"min\", \"number\"], [\"max\", \"number\"]];\n    };\n\n    LiteGraph.registerNodeType(\"math/rand\", MathRand);\n\n    //basic continuous noise\n    function MathNoise() {\n        this.addInput(\"in\", \"number\");\n        this.addOutput(\"out\", \"number\");\n        this.addProperty(\"min\", 0);\n        this.addProperty(\"max\", 1);\n        this.addProperty(\"smooth\", true);\n        this.addProperty(\"seed\", 0);\n        this.addProperty(\"octaves\", 1);\n        this.addProperty(\"persistence\", 0.8);\n        this.addProperty(\"speed\", 1);\n        this.size = [90, 30];\n    }\n\n    MathNoise.title = \"Noise\";\n    MathNoise.desc = \"Random number with temporal continuity\";\n    MathNoise.data = null;\n\n    MathNoise.getValue = function(f, smooth) {\n        if (!MathNoise.data) {\n            MathNoise.data = new Float32Array(1024);\n            for (var i = 0; i < MathNoise.data.length; ++i) {\n                MathNoise.data[i] = Math.random();\n            }\n        }\n        f = f % 1024;\n        if (f < 0) {\n            f += 1024;\n        }\n        var f_min = Math.floor(f);\n        var f = f - f_min;\n        var r1 = MathNoise.data[f_min];\n        var r2 = MathNoise.data[f_min == 1023 ? 0 : f_min + 1];\n        if (smooth) {\n            f = f * f * f * (f * (f * 6.0 - 15.0) + 10.0);\n        }\n        return r1 * (1 - f) + r2 * f;\n    };\n\n    MathNoise.prototype.onExecute = function() {\n        var f = this.getInputData(0) || 0;\n\t\tvar iterations = this.properties.octaves || 1;\n\t\tvar r = 0;\n\t\tvar amp = 1;\n\t\tvar seed = this.properties.seed || 0;\n\t\tf += seed;\n\t\tvar speed = this.properties.speed || 1;\n\t\tvar total_amp = 0;\n\t\tfor(var i = 0; i < iterations; ++i)\n\t\t{\n\t\t\tr += MathNoise.getValue(f * (1+i) * speed, this.properties.smooth) * amp;\n\t\t\ttotal_amp += amp;\n\t\t\tamp *= this.properties.persistence;\n\t\t\tif(amp < 0.001)\n\t\t\t\tbreak;\n\t\t}\n\t\tr /= total_amp;\n        var min = this.properties.min;\n        var max = this.properties.max;\n        this._last_v = r * (max - min) + min;\n        this.setOutputData(0, this._last_v);\n    };\n\n    MathNoise.prototype.onDrawBackground = function(ctx) {\n        //show the current value\n        this.outputs[0].label = (this._last_v || 0).toFixed(3);\n    };\n\n    LiteGraph.registerNodeType(\"math/noise\", MathNoise);\n\n    //generates spikes every random time\n    function MathSpikes() {\n        this.addOutput(\"out\", \"number\");\n        this.addProperty(\"min_time\", 1);\n        this.addProperty(\"max_time\", 2);\n        this.addProperty(\"duration\", 0.2);\n        this.size = [90, 30];\n        this._remaining_time = 0;\n        this._blink_time = 0;\n    }\n\n    MathSpikes.title = \"Spikes\";\n    MathSpikes.desc = \"spike every random time\";\n\n    MathSpikes.prototype.onExecute = function() {\n        var dt = this.graph.elapsed_time; //in secs\n\n        this._remaining_time -= dt;\n        this._blink_time -= dt;\n\n        var v = 0;\n        if (this._blink_time > 0) {\n            var f = this._blink_time / this.properties.duration;\n            v = 1 / (Math.pow(f * 8 - 4, 4) + 1);\n        }\n\n        if (this._remaining_time < 0) {\n            this._remaining_time =\n                Math.random() *\n                    (this.properties.max_time - this.properties.min_time) +\n                this.properties.min_time;\n            this._blink_time = this.properties.duration;\n            this.boxcolor = \"#FFF\";\n        } else {\n            this.boxcolor = \"#000\";\n        }\n        this.setOutputData(0, v);\n    };\n\n    LiteGraph.registerNodeType(\"math/spikes\", MathSpikes);\n\n    //Math clamp\n    function MathClamp() {\n        this.addInput(\"in\", \"number\");\n        this.addOutput(\"out\", \"number\");\n        this.size = [80, 30];\n        this.addProperty(\"min\", 0);\n        this.addProperty(\"max\", 1);\n    }\n\n    MathClamp.title = \"Clamp\";\n    MathClamp.desc = \"Clamp number between min and max\";\n    //MathClamp.filter = \"shader\";\n\n    MathClamp.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            return;\n        }\n        v = Math.max(this.properties.min, v);\n        v = Math.min(this.properties.max, v);\n        this.setOutputData(0, v);\n    };\n\n    MathClamp.prototype.getCode = function(lang) {\n        var code = \"\";\n        if (this.isInputConnected(0)) {\n            code +=\n                \"clamp({{0}},\" +\n                this.properties.min +\n                \",\" +\n                this.properties.max +\n                \")\";\n        }\n        return code;\n    };\n\n    LiteGraph.registerNodeType(\"math/clamp\", MathClamp);\n\n    //Math ABS\n    function MathLerp() {\n        this.properties = { f: 0.5 };\n        this.addInput(\"A\", \"number\");\n        this.addInput(\"B\", \"number\");\n\n        this.addOutput(\"out\", \"number\");\n    }\n\n    MathLerp.title = \"Lerp\";\n    MathLerp.desc = \"Linear Interpolation\";\n\n    MathLerp.prototype.onExecute = function() {\n        var v1 = this.getInputData(0);\n        if (v1 == null) {\n            v1 = 0;\n        }\n        var v2 = this.getInputData(1);\n        if (v2 == null) {\n            v2 = 0;\n        }\n\n        var f = this.properties.f;\n\n        var _f = this.getInputData(2);\n        if (_f !== undefined) {\n            f = _f;\n        }\n\n        this.setOutputData(0, v1 * (1 - f) + v2 * f);\n    };\n\n    MathLerp.prototype.onGetInputs = function() {\n        return [[\"f\", \"number\"]];\n    };\n\n    LiteGraph.registerNodeType(\"math/lerp\", MathLerp);\n\n    //Math ABS\n    function MathAbs() {\n        this.addInput(\"in\", \"number\");\n        this.addOutput(\"out\", \"number\");\n        this.size = [80, 30];\n    }\n\n    MathAbs.title = \"Abs\";\n    MathAbs.desc = \"Absolute\";\n\n    MathAbs.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            return;\n        }\n        this.setOutputData(0, Math.abs(v));\n    };\n\n    LiteGraph.registerNodeType(\"math/abs\", MathAbs);\n\n    //Math Floor\n    function MathFloor() {\n        this.addInput(\"in\", \"number\");\n        this.addOutput(\"out\", \"number\");\n        this.size = [80, 30];\n    }\n\n    MathFloor.title = \"Floor\";\n    MathFloor.desc = \"Floor number to remove fractional part\";\n\n    MathFloor.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            return;\n        }\n        this.setOutputData(0, Math.floor(v));\n    };\n\n    LiteGraph.registerNodeType(\"math/floor\", MathFloor);\n\n    //Math frac\n    function MathFrac() {\n        this.addInput(\"in\", \"number\");\n        this.addOutput(\"out\", \"number\");\n        this.size = [80, 30];\n    }\n\n    MathFrac.title = \"Frac\";\n    MathFrac.desc = \"Returns fractional part\";\n\n    MathFrac.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            return;\n        }\n        this.setOutputData(0, v % 1);\n    };\n\n    LiteGraph.registerNodeType(\"math/frac\", MathFrac);\n\n    //Math Floor\n    function MathSmoothStep() {\n        this.addInput(\"in\", \"number\");\n        this.addOutput(\"out\", \"number\");\n        this.size = [80, 30];\n        this.properties = { A: 0, B: 1 };\n    }\n\n    MathSmoothStep.title = \"Smoothstep\";\n    MathSmoothStep.desc = \"Smoothstep\";\n\n    MathSmoothStep.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v === undefined) {\n            return;\n        }\n\n        var edge0 = this.properties.A;\n        var edge1 = this.properties.B;\n\n        // Scale, bias and saturate x to 0..1 range\n        v = Math.clamp((v - edge0) / (edge1 - edge0), 0.0, 1.0);\n        // Evaluate polynomial\n        v = v * v * (3 - 2 * v);\n\n        this.setOutputData(0, v);\n    };\n\n    LiteGraph.registerNodeType(\"math/smoothstep\", MathSmoothStep);\n\n    //Math scale\n    function MathScale() {\n        this.addInput(\"in\", \"number\", { label: \"\" });\n        this.addOutput(\"out\", \"number\", { label: \"\" });\n        this.size = [80, 30];\n        this.addProperty(\"factor\", 1);\n    }\n\n    MathScale.title = \"Scale\";\n    MathScale.desc = \"v * factor\";\n\n    MathScale.prototype.onExecute = function() {\n        var value = this.getInputData(0);\n        if (value != null) {\n            this.setOutputData(0, value * this.properties.factor);\n        }\n    };\n\n    LiteGraph.registerNodeType(\"math/scale\", MathScale);\n\n\t//Gate\n\tfunction Gate() {\n\t\tthis.addInput(\"v\",\"boolean\");\n\t\tthis.addInput(\"A\");\n\t\tthis.addInput(\"B\");\n\t\tthis.addOutput(\"out\");\n\t}\n\n\tGate.title = \"Gate\";\n\tGate.desc = \"if v is true, then outputs A, otherwise B\";\n\n\tGate.prototype.onExecute = function() {\n\t\tvar v = this.getInputData(0);\n\t\tthis.setOutputData(0, this.getInputData( v ? 1 : 2 ));\n\t};\n\n\tLiteGraph.registerNodeType(\"math/gate\", Gate);\n\n\n    //Math Average\n    function MathAverageFilter() {\n        this.addInput(\"in\", \"number\");\n        this.addOutput(\"out\", \"number\");\n        this.size = [80, 30];\n        this.addProperty(\"samples\", 10);\n        this._values = new Float32Array(10);\n        this._current = 0;\n    }\n\n    MathAverageFilter.title = \"Average\";\n    MathAverageFilter.desc = \"Average Filter\";\n\n    MathAverageFilter.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            v = 0;\n        }\n\n        var num_samples = this._values.length;\n\n        this._values[this._current % num_samples] = v;\n        this._current += 1;\n        if (this._current > num_samples) {\n            this._current = 0;\n        }\n\n        var avr = 0;\n        for (var i = 0; i < num_samples; ++i) {\n            avr += this._values[i];\n        }\n\n        this.setOutputData(0, avr / num_samples);\n    };\n\n    MathAverageFilter.prototype.onPropertyChanged = function(name, value) {\n        if (value < 1) {\n            value = 1;\n        }\n        this.properties.samples = Math.round(value);\n        var old = this._values;\n\n        this._values = new Float32Array(this.properties.samples);\n        if (old.length <= this._values.length) {\n            this._values.set(old);\n        } else {\n            this._values.set(old.subarray(0, this._values.length));\n        }\n    };\n\n    LiteGraph.registerNodeType(\"math/average\", MathAverageFilter);\n\n    //Math\n    function MathTendTo() {\n        this.addInput(\"in\", \"number\");\n        this.addOutput(\"out\", \"number\");\n        this.addProperty(\"factor\", 0.1);\n        this.size = [80, 30];\n        this._value = null;\n    }\n\n    MathTendTo.title = \"TendTo\";\n    MathTendTo.desc = \"moves the output value always closer to the input\";\n\n    MathTendTo.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            v = 0;\n        }\n        var f = this.properties.factor;\n        if (this._value == null) {\n            this._value = v;\n        } else {\n            this._value = this._value * (1 - f) + v * f;\n        }\n        this.setOutputData(0, this._value);\n    };\n\n    LiteGraph.registerNodeType(\"math/tendTo\", MathTendTo);\n\n    //Math operation\n    function MathOperation() {\n        this.addInput(\"A\", \"number,array,object\");\n        this.addInput(\"B\", \"number\");\n        this.addOutput(\"=\", \"number\");\n        this.addProperty(\"A\", 1);\n        this.addProperty(\"B\", 1);\n        this.addProperty(\"OP\", \"+\", \"enum\", { values: MathOperation.values });\n\t\tthis._func = function(A,B) { return A + B; };\n\t\tthis._result = []; //only used for arrays\n    }\n\n    MathOperation.values = [\"+\", \"-\", \"*\", \"/\", \"%\", \"^\", \"max\", \"min\"];\n\n\tMathOperation.title = \"Operation\";\n    MathOperation.desc = \"Easy math operators\";\n    MathOperation[\"@OP\"] = {\n        type: \"enum\",\n        title: \"operation\",\n        values: MathOperation.values\n    };\n    MathOperation.size = [100, 60];\n\n    MathOperation.prototype.getTitle = function() {\n\t\tif(this.properties.OP == \"max\" || this.properties.OP == \"min\")\n\t\t\treturn this.properties.OP + \"(A,B)\";\n        return \"A \" + this.properties.OP + \" B\";\n    };\n\n    MathOperation.prototype.setValue = function(v) {\n        if (typeof v == \"string\") {\n            v = parseFloat(v);\n        }\n        this.properties[\"value\"] = v;\n    };\n\n    MathOperation.prototype.onPropertyChanged = function(name, value)\n\t{\n\t\tif (name != \"OP\")\n\t\t\treturn;\n        switch (this.properties.OP) {\n            case \"+\": this._func = function(A,B) { return A + B; }; break;\n            case \"-\": this._func = function(A,B) { return A - B; }; break;\n            case \"x\":\n            case \"X\":\n            case \"*\": this._func = function(A,B) { return A * B; }; break;\n            case \"/\": this._func = function(A,B) { return A / B; }; break;\n            case \"%\": this._func = function(A,B) { return A % B; }; break;\n            case \"^\": this._func = function(A,B) { return Math.pow(A, B); }; break;\n            case \"max\": this._func = function(A,B) { return Math.max(A, B); }; break;\n            case \"min\": this._func = function(A,B) { return Math.min(A, B); }; break;\n\t\t\tdefault: \n\t\t\t\tconsole.warn(\"Unknown operation: \" + this.properties.OP);\n\t\t\t\tthis._func = function(A) { return A; };\n\t\t\t\tbreak;\n        }\n\t}\n\n    MathOperation.prototype.onExecute = function() {\n        var A = this.getInputData(0);\n        var B = this.getInputData(1);\n        if ( A != null ) {\n\t\t\tif( A.constructor === Number )\n\t            this.properties[\"A\"] = A;\n        } else {\n            A = this.properties[\"A\"];\n        }\n\n        if (B != null) {\n            this.properties[\"B\"] = B;\n        } else {\n            B = this.properties[\"B\"];\n        }\n\n\t\tvar result;\n\t\tif(A.constructor === Number)\n\t\t{\n\t        result = 0;\n\t\t\tresult = this._func(A,B);\n\t\t}\n\t\telse if(A.constructor === Array)\n\t\t{\n\t\t\tresult = this._result;\n\t\t\tresult.length = A.length;\n\t\t\tfor(var i = 0; i < A.length; ++i)\n\t\t\t\tresult[i] = this._func(A[i],B);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult = {};\n\t\t\tfor(var i in A)\n\t\t\t\tresult[i] = this._func(A[i],B);\n\t\t}\n\t    this.setOutputData(0, result);\n    };\n\n    MathOperation.prototype.onDrawBackground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n\n        ctx.font = \"40px Arial\";\n        ctx.fillStyle = \"#666\";\n        ctx.textAlign = \"center\";\n        ctx.fillText(\n            this.properties.OP,\n            this.size[0] * 0.5,\n            (this.size[1] + LiteGraph.NODE_TITLE_HEIGHT) * 0.5\n        );\n        ctx.textAlign = \"left\";\n    };\n\n    LiteGraph.registerNodeType(\"math/operation\", MathOperation);\n\n    LiteGraph.registerSearchboxExtra(\"math/operation\", \"MAX\", {\n        properties: {OP:\"max\"},\n        title: \"MAX()\"\n    });\n\n    LiteGraph.registerSearchboxExtra(\"math/operation\", \"MIN\", {\n        properties: {OP:\"min\"},\n        title: \"MIN()\"\n    });\n\n\n    //Math compare\n    function MathCompare() {\n        this.addInput(\"A\", \"number\");\n        this.addInput(\"B\", \"number\");\n        this.addOutput(\"A==B\", \"boolean\");\n        this.addOutput(\"A!=B\", \"boolean\");\n        this.addProperty(\"A\", 0);\n        this.addProperty(\"B\", 0);\n    }\n\n    MathCompare.title = \"Compare\";\n    MathCompare.desc = \"compares between two values\";\n\n    MathCompare.prototype.onExecute = function() {\n        var A = this.getInputData(0);\n        var B = this.getInputData(1);\n        if (A !== undefined) {\n            this.properties[\"A\"] = A;\n        } else {\n            A = this.properties[\"A\"];\n        }\n\n        if (B !== undefined) {\n            this.properties[\"B\"] = B;\n        } else {\n            B = this.properties[\"B\"];\n        }\n\n        for (var i = 0, l = this.outputs.length; i < l; ++i) {\n            var output = this.outputs[i];\n            if (!output.links || !output.links.length) {\n                continue;\n            }\n            var value;\n            switch (output.name) {\n                case \"A==B\":\n                    value = A == B;\n                    break;\n                case \"A!=B\":\n                    value = A != B;\n                    break;\n                case \"A>B\":\n                    value = A > B;\n                    break;\n                case \"A<B\":\n                    value = A < B;\n                    break;\n                case \"A<=B\":\n                    value = A <= B;\n                    break;\n                case \"A>=B\":\n                    value = A >= B;\n                    break;\n            }\n            this.setOutputData(i, value);\n        }\n    };\n\n    MathCompare.prototype.onGetOutputs = function() {\n        return [\n            [\"A==B\", \"boolean\"],\n            [\"A!=B\", \"boolean\"],\n            [\"A>B\", \"boolean\"],\n            [\"A<B\", \"boolean\"],\n            [\"A>=B\", \"boolean\"],\n            [\"A<=B\", \"boolean\"]\n        ];\n    };\n\n    LiteGraph.registerNodeType(\"math/compare\", MathCompare);\n\n    LiteGraph.registerSearchboxExtra(\"math/compare\", \"==\", {\n        outputs: [[\"A==B\", \"boolean\"]],\n        title: \"A==B\"\n    });\n    LiteGraph.registerSearchboxExtra(\"math/compare\", \"!=\", {\n        outputs: [[\"A!=B\", \"boolean\"]],\n        title: \"A!=B\"\n    });\n    LiteGraph.registerSearchboxExtra(\"math/compare\", \">\", {\n        outputs: [[\"A>B\", \"boolean\"]],\n        title: \"A>B\"\n    });\n    LiteGraph.registerSearchboxExtra(\"math/compare\", \"<\", {\n        outputs: [[\"A<B\", \"boolean\"]],\n        title: \"A<B\"\n    });\n    LiteGraph.registerSearchboxExtra(\"math/compare\", \">=\", {\n        outputs: [[\"A>=B\", \"boolean\"]],\n        title: \"A>=B\"\n    });\n    LiteGraph.registerSearchboxExtra(\"math/compare\", \"<=\", {\n        outputs: [[\"A<=B\", \"boolean\"]],\n        title: \"A<=B\"\n    });\n\n    function MathCondition() {\n        this.addInput(\"A\", \"number\");\n        this.addInput(\"B\", \"number\");\n        this.addOutput(\"true\", \"boolean\");\n        this.addOutput(\"false\", \"boolean\");\n        this.addProperty(\"A\", 1);\n        this.addProperty(\"B\", 1);\n        this.addProperty(\"OP\", \">\", \"enum\", { values: MathCondition.values });\n\t\tthis.addWidget(\"combo\",\"Cond.\",this.properties.OP,{ property: \"OP\", values: MathCondition.values } );\n\n        this.size = [80, 60];\n    }\n\n    MathCondition.values = [\">\", \"<\", \"==\", \"!=\", \"<=\", \">=\", \"||\", \"&&\" ];\n    MathCondition[\"@OP\"] = {\n        type: \"enum\",\n        title: \"operation\",\n        values: MathCondition.values\n    };\n\n    MathCondition.title = \"Condition\";\n    MathCondition.desc = \"evaluates condition between A and B\";\n\n    MathCondition.prototype.getTitle = function() {\n        return \"A \" + this.properties.OP + \" B\";\n    };\n\n    MathCondition.prototype.onExecute = function() {\n        var A = this.getInputData(0);\n        if (A === undefined) {\n            A = this.properties.A;\n        } else {\n            this.properties.A = A;\n        }\n\n        var B = this.getInputData(1);\n        if (B === undefined) {\n            B = this.properties.B;\n        } else {\n            this.properties.B = B;\n        }\n\n        var result = true;\n        switch (this.properties.OP) {\n            case \">\":\n                result = A > B;\n                break;\n            case \"<\":\n                result = A < B;\n                break;\n            case \"==\":\n                result = A == B;\n                break;\n            case \"!=\":\n                result = A != B;\n                break;\n            case \"<=\":\n                result = A <= B;\n                break;\n            case \">=\":\n                result = A >= B;\n                break;\n            case \"||\":\n                result = A || B;\n                break;\n            case \"&&\":\n                result = A && B;\n                break;\n        }\n\n        this.setOutputData(0, result);\n        this.setOutputData(1, !result);\n    };\n\n    LiteGraph.registerNodeType(\"math/condition\", MathCondition);\n\n\n    function MathBranch() {\n        this.addInput(\"in\", 0);\n        this.addInput(\"cond\", \"boolean\");\n        this.addOutput(\"true\", 0);\n        this.addOutput(\"false\", 0);\n        this.size = [80, 60];\n    }\n\n    MathBranch.title = \"Branch\";\n    MathBranch.desc = \"If condition is true, outputs IN in true, otherwise in false\";\n\n    MathBranch.prototype.onExecute = function() {\n        var V = this.getInputData(0);\n        var cond = this.getInputData(1);\n\n\t\tif(cond)\n\t\t{\n\t\t\tthis.setOutputData(0, V);\n\t\t\tthis.setOutputData(1, null);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.setOutputData(0, null);\n\t\t\tthis.setOutputData(1, V);\n\t\t}\n\t}\n\n    LiteGraph.registerNodeType(\"math/branch\", MathBranch);\n\n\n    function MathAccumulate() {\n        this.addInput(\"inc\", \"number\");\n        this.addOutput(\"total\", \"number\");\n        this.addProperty(\"increment\", 1);\n        this.addProperty(\"value\", 0);\n    }\n\n    MathAccumulate.title = \"Accumulate\";\n    MathAccumulate.desc = \"Increments a value every time\";\n\n    MathAccumulate.prototype.onExecute = function() {\n        if (this.properties.value === null) {\n            this.properties.value = 0;\n        }\n\n        var inc = this.getInputData(0);\n        if (inc !== null) {\n            this.properties.value += inc;\n        } else {\n            this.properties.value += this.properties.increment;\n        }\n        this.setOutputData(0, this.properties.value);\n    };\n\n    LiteGraph.registerNodeType(\"math/accumulate\", MathAccumulate);\n\n    //Math Trigonometry\n    function MathTrigonometry() {\n        this.addInput(\"v\", \"number\");\n        this.addOutput(\"sin\", \"number\");\n\n        this.addProperty(\"amplitude\", 1);\n        this.addProperty(\"offset\", 0);\n        this.bgImageUrl = \"nodes/imgs/icon-sin.png\";\n    }\n\n    MathTrigonometry.title = \"Trigonometry\";\n    MathTrigonometry.desc = \"Sin Cos Tan\";\n    //MathTrigonometry.filter = \"shader\";\n\n    MathTrigonometry.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            v = 0;\n        }\n        var amplitude = this.properties[\"amplitude\"];\n        var slot = this.findInputSlot(\"amplitude\");\n        if (slot != -1) {\n            amplitude = this.getInputData(slot);\n        }\n        var offset = this.properties[\"offset\"];\n        slot = this.findInputSlot(\"offset\");\n        if (slot != -1) {\n            offset = this.getInputData(slot);\n        }\n\n        for (var i = 0, l = this.outputs.length; i < l; ++i) {\n            var output = this.outputs[i];\n            var value;\n            switch (output.name) {\n                case \"sin\":\n                    value = Math.sin(v);\n                    break;\n                case \"cos\":\n                    value = Math.cos(v);\n                    break;\n                case \"tan\":\n                    value = Math.tan(v);\n                    break;\n                case \"asin\":\n                    value = Math.asin(v);\n                    break;\n                case \"acos\":\n                    value = Math.acos(v);\n                    break;\n                case \"atan\":\n                    value = Math.atan(v);\n                    break;\n            }\n            this.setOutputData(i, amplitude * value + offset);\n        }\n    };\n\n    MathTrigonometry.prototype.onGetInputs = function() {\n        return [[\"v\", \"number\"], [\"amplitude\", \"number\"], [\"offset\", \"number\"]];\n    };\n\n    MathTrigonometry.prototype.onGetOutputs = function() {\n        return [\n            [\"sin\", \"number\"],\n            [\"cos\", \"number\"],\n            [\"tan\", \"number\"],\n            [\"asin\", \"number\"],\n            [\"acos\", \"number\"],\n            [\"atan\", \"number\"]\n        ];\n    };\n\n    LiteGraph.registerNodeType(\"math/trigonometry\", MathTrigonometry);\n\n    LiteGraph.registerSearchboxExtra(\"math/trigonometry\", \"SIN()\", {\n        outputs: [[\"sin\", \"number\"]],\n        title: \"SIN()\"\n    });\n    LiteGraph.registerSearchboxExtra(\"math/trigonometry\", \"COS()\", {\n        outputs: [[\"cos\", \"number\"]],\n        title: \"COS()\"\n    });\n    LiteGraph.registerSearchboxExtra(\"math/trigonometry\", \"TAN()\", {\n        outputs: [[\"tan\", \"number\"]],\n        title: \"TAN()\"\n    });\n\n    //math library for safe math operations without eval\n    function MathFormula() {\n        this.addInput(\"x\", \"number\");\n        this.addInput(\"y\", \"number\");\n        this.addOutput(\"\", \"number\");\n        this.properties = { x: 1.0, y: 1.0, formula: \"x+y\" };\n        this.code_widget = this.addWidget(\n            \"text\",\n            \"F(x,y)\",\n            this.properties.formula,\n            function(v, canvas, node) {\n                node.properties.formula = v;\n            }\n        );\n        this.addWidget(\"toggle\", \"allow\", LiteGraph.allow_scripts, function(v) {\n            LiteGraph.allow_scripts = v;\n        });\n        this._func = null;\n    }\n\n    MathFormula.title = \"Formula\";\n    MathFormula.desc = \"Compute formula\";\n    MathFormula.size = [160, 100];\n\n    MathAverageFilter.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"formula\") {\n            this.code_widget.value = value;\n        }\n    };\n\n    MathFormula.prototype.onExecute = function() {\n        if (!LiteGraph.allow_scripts) {\n            return;\n        }\n\n        var x = this.getInputData(0);\n        var y = this.getInputData(1);\n        if (x != null) {\n            this.properties[\"x\"] = x;\n        } else {\n            x = this.properties[\"x\"];\n        }\n\n        if (y != null) {\n            this.properties[\"y\"] = y;\n        } else {\n            y = this.properties[\"y\"];\n        }\n\n        var f = this.properties[\"formula\"];\n\n        var value;\n        try {\n            if (!this._func || this._func_code != this.properties.formula) {\n                this._func = new Function(\n                    \"x\",\n                    \"y\",\n                    \"TIME\",\n                    \"return \" + this.properties.formula\n                );\n                this._func_code = this.properties.formula;\n            }\n            value = this._func(x, y, this.graph.globaltime);\n            this.boxcolor = null;\n        } catch (err) {\n            this.boxcolor = \"red\";\n        }\n        this.setOutputData(0, value);\n    };\n\n    MathFormula.prototype.getTitle = function() {\n        return this._func_code || \"Formula\";\n    };\n\n    MathFormula.prototype.onDrawBackground = function() {\n        var f = this.properties[\"formula\"];\n        if (this.outputs && this.outputs.length) {\n            this.outputs[0].label = f;\n        }\n    };\n\n    LiteGraph.registerNodeType(\"math/formula\", MathFormula);\n\n    function Math3DVec2ToXY() {\n        this.addInput(\"vec2\", \"vec2\");\n        this.addOutput(\"x\", \"number\");\n        this.addOutput(\"y\", \"number\");\n    }\n\n    Math3DVec2ToXY.title = \"Vec2->XY\";\n    Math3DVec2ToXY.desc = \"vector 2 to components\";\n\n    Math3DVec2ToXY.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            return;\n        }\n\n        this.setOutputData(0, v[0]);\n        this.setOutputData(1, v[1]);\n    };\n\n    LiteGraph.registerNodeType(\"math3d/vec2-to-xy\", Math3DVec2ToXY);\n\n    function Math3DXYToVec2() {\n        this.addInputs([[\"x\", \"number\"], [\"y\", \"number\"]]);\n        this.addOutput(\"vec2\", \"vec2\");\n        this.properties = { x: 0, y: 0 };\n        this._data = new Float32Array(2);\n    }\n\n    Math3DXYToVec2.title = \"XY->Vec2\";\n    Math3DXYToVec2.desc = \"components to vector2\";\n\n    Math3DXYToVec2.prototype.onExecute = function() {\n        var x = this.getInputData(0);\n        if (x == null) {\n            x = this.properties.x;\n        }\n        var y = this.getInputData(1);\n        if (y == null) {\n            y = this.properties.y;\n        }\n\n        var data = this._data;\n        data[0] = x;\n        data[1] = y;\n\n        this.setOutputData(0, data);\n    };\n\n    LiteGraph.registerNodeType(\"math3d/xy-to-vec2\", Math3DXYToVec2);\n\n    function Math3DVec3ToXYZ() {\n        this.addInput(\"vec3\", \"vec3\");\n        this.addOutput(\"x\", \"number\");\n        this.addOutput(\"y\", \"number\");\n        this.addOutput(\"z\", \"number\");\n    }\n\n    Math3DVec3ToXYZ.title = \"Vec3->XYZ\";\n    Math3DVec3ToXYZ.desc = \"vector 3 to components\";\n\n    Math3DVec3ToXYZ.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            return;\n        }\n\n        this.setOutputData(0, v[0]);\n        this.setOutputData(1, v[1]);\n        this.setOutputData(2, v[2]);\n    };\n\n    LiteGraph.registerNodeType(\"math3d/vec3-to-xyz\", Math3DVec3ToXYZ);\n\n    function Math3DXYZToVec3() {\n        this.addInputs([[\"x\", \"number\"], [\"y\", \"number\"], [\"z\", \"number\"]]);\n        this.addOutput(\"vec3\", \"vec3\");\n        this.properties = { x: 0, y: 0, z: 0 };\n        this._data = new Float32Array(3);\n    }\n\n    Math3DXYZToVec3.title = \"XYZ->Vec3\";\n    Math3DXYZToVec3.desc = \"components to vector3\";\n\n    Math3DXYZToVec3.prototype.onExecute = function() {\n        var x = this.getInputData(0);\n        if (x == null) {\n            x = this.properties.x;\n        }\n        var y = this.getInputData(1);\n        if (y == null) {\n            y = this.properties.y;\n        }\n        var z = this.getInputData(2);\n        if (z == null) {\n            z = this.properties.z;\n        }\n\n        var data = this._data;\n        data[0] = x;\n        data[1] = y;\n        data[2] = z;\n\n        this.setOutputData(0, data);\n    };\n\n    LiteGraph.registerNodeType(\"math3d/xyz-to-vec3\", Math3DXYZToVec3);\n\n    function Math3DVec4ToXYZW() {\n        this.addInput(\"vec4\", \"vec4\");\n        this.addOutput(\"x\", \"number\");\n        this.addOutput(\"y\", \"number\");\n        this.addOutput(\"z\", \"number\");\n        this.addOutput(\"w\", \"number\");\n    }\n\n    Math3DVec4ToXYZW.title = \"Vec4->XYZW\";\n    Math3DVec4ToXYZW.desc = \"vector 4 to components\";\n\n    Math3DVec4ToXYZW.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            return;\n        }\n\n        this.setOutputData(0, v[0]);\n        this.setOutputData(1, v[1]);\n        this.setOutputData(2, v[2]);\n        this.setOutputData(3, v[3]);\n    };\n\n    LiteGraph.registerNodeType(\"math3d/vec4-to-xyzw\", Math3DVec4ToXYZW);\n\n    function Math3DXYZWToVec4() {\n        this.addInputs([\n            [\"x\", \"number\"],\n            [\"y\", \"number\"],\n            [\"z\", \"number\"],\n            [\"w\", \"number\"]\n        ]);\n        this.addOutput(\"vec4\", \"vec4\");\n        this.properties = { x: 0, y: 0, z: 0, w: 0 };\n        this._data = new Float32Array(4);\n    }\n\n    Math3DXYZWToVec4.title = \"XYZW->Vec4\";\n    Math3DXYZWToVec4.desc = \"components to vector4\";\n\n    Math3DXYZWToVec4.prototype.onExecute = function() {\n        var x = this.getInputData(0);\n        if (x == null) {\n            x = this.properties.x;\n        }\n        var y = this.getInputData(1);\n        if (y == null) {\n            y = this.properties.y;\n        }\n        var z = this.getInputData(2);\n        if (z == null) {\n            z = this.properties.z;\n        }\n        var w = this.getInputData(3);\n        if (w == null) {\n            w = this.properties.w;\n        }\n\n        var data = this._data;\n        data[0] = x;\n        data[1] = y;\n        data[2] = z;\n        data[3] = w;\n\n        this.setOutputData(0, data);\n    };\n\n    LiteGraph.registerNodeType(\"math3d/xyzw-to-vec4\", Math3DXYZWToVec4);\n\n})(this);\n\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n\n\tfunction Math3DMat4()\n\t{\n        this.addInput(\"T\", \"vec3\");\n        this.addInput(\"R\", \"vec3\");\n        this.addInput(\"S\", \"vec3\");\n        this.addOutput(\"mat4\", \"mat4\");\n\t\tthis.properties = {\n\t\t\t\"T\":[0,0,0],\n\t\t\t\"R\":[0,0,0],\n\t\t\t\"S\":[1,1,1],\n\t\t\tR_in_degrees: true\n\t\t};\n\t\tthis._result = mat4.create();\n\t\tthis._must_update = true;\n\t}\n\n\tMath3DMat4.title = \"mat4\";\n\tMath3DMat4.temp_quat = new Float32Array([0,0,0,1]);\n\tMath3DMat4.temp_mat4 = new Float32Array(16);\n\tMath3DMat4.temp_vec3 = new Float32Array(3);\n\n\tMath3DMat4.prototype.onPropertyChanged = function(name, value)\n\t{\n\t\tthis._must_update = true;\n\t}\n\n\tMath3DMat4.prototype.onExecute = function()\n\t{\n\t\tvar M = this._result;\n\t\tvar Q = Math3DMat4.temp_quat;\n\t\tvar temp_mat4 = Math3DMat4.temp_mat4;\n\t\tvar temp_vec3 = Math3DMat4.temp_vec3;\n\n\t\tvar T = this.getInputData(0);\n\t\tvar R = this.getInputData(1);\n\t\tvar S = this.getInputData(2);\n\n\t\tif( this._must_update || T || R || S )\n\t\t{\n\t\t\tT = T || this.properties.T;\n\t\t\tR = R || this.properties.R;\n\t\t\tS = S || this.properties.S;\n\t\t\tmat4.identity( M );\n\t\t\tmat4.translate( M, M, T );\n\t\t\tif(this.properties.R_in_degrees)\n\t\t\t{\n\t\t\t\ttemp_vec3.set( R );\n\t\t\t\tvec3.scale(temp_vec3,temp_vec3,DEG2RAD);\n\t\t\t\tquat.fromEuler( Q, temp_vec3 );\n\t\t\t}\n\t\t\telse\n\t\t\t\tquat.fromEuler( Q, R );\n\t\t\tmat4.fromQuat( temp_mat4, Q );\n\t\t\tmat4.multiply( M, M, temp_mat4 );\n\t\t\tmat4.scale( M, M, S );\n\t\t}\n\n\t\tthis.setOutputData(0, M);\t\t\n\t}\n\n    LiteGraph.registerNodeType(\"math3d/mat4\", Math3DMat4);\n\n    //Math 3D operation\n    function Math3DOperation() {\n        this.addInput(\"A\", \"number,vec3\");\n        this.addInput(\"B\", \"number,vec3\");\n        this.addOutput(\"=\", \"number,vec3\");\n        this.addProperty(\"OP\", \"+\", \"enum\", { values: Math3DOperation.values });\n\t\tthis._result = vec3.create();\n    }\n\n    Math3DOperation.values = [\"+\", \"-\", \"*\", \"/\", \"%\", \"^\", \"max\", \"min\",\"dot\",\"cross\"];\n\n    LiteGraph.registerSearchboxExtra(\"math3d/operation\", \"CROSS()\", {\n        properties: {\"OP\":\"cross\"},\n        title: \"CROSS()\"\n    });\n\n    LiteGraph.registerSearchboxExtra(\"math3d/operation\", \"DOT()\", {\n        properties: {\"OP\":\"dot\"},\n        title: \"DOT()\"\n    });\n\n\tMath3DOperation.title = \"Operation\";\n    Math3DOperation.desc = \"Easy math 3D operators\";\n    Math3DOperation[\"@OP\"] = {\n        type: \"enum\",\n        title: \"operation\",\n        values: Math3DOperation.values\n    };\n    Math3DOperation.size = [100, 60];\n\n    Math3DOperation.prototype.getTitle = function() {\n\t\tif(this.properties.OP == \"max\" || this.properties.OP == \"min\" )\n\t\t\treturn this.properties.OP + \"(A,B)\";\n        return \"A \" + this.properties.OP + \" B\";\n    };\n\n    Math3DOperation.prototype.onExecute = function() {\n        var A = this.getInputData(0);\n        var B = this.getInputData(1);\n\t\tif(A == null || B == null)\n\t\t\treturn;\n\t\tif(A.constructor === Number)\n\t\t\tA = [A,A,A];\n\t\tif(B.constructor === Number)\n\t\t\tB = [B,B,B];\n\n        var result = this._result;\n        switch (this.properties.OP) {\n            case \"+\":\n                result = vec3.add(result,A,B);\n                break;\n            case \"-\":\n                result = vec3.sub(result,A,B);\n                break;\n            case \"x\":\n            case \"X\":\n            case \"*\":\n                result = vec3.mul(result,A,B);\n                break;\n            case \"/\":\n                result = vec3.div(result,A,B);\n                break;\n            case \"%\":\n                result[0] = A[0]%B[0];\n                result[1] = A[1]%B[1];\n                result[2] = A[2]%B[2];\n                break;\n            case \"^\":\n                result[0] = Math.pow(A[0],B[0]);\n                result[1] = Math.pow(A[1],B[1]);\n                result[2] = Math.pow(A[2],B[2]);\n                break;\n            case \"max\":\n                result[0] = Math.max(A[0],B[0]);\n                result[1] = Math.max(A[1],B[1]);\n                result[2] = Math.max(A[2],B[2]);\n                break;\n            case \"min\":\n                result[0] = Math.min(A[0],B[0]);\n                result[1] = Math.min(A[1],B[1]);\n                result[2] = Math.min(A[2],B[2]);\n            case \"dot\":\n                result = vec3.dot(A,B);\n                break;\n            case \"cross\":\n                vec3.cross(result,A,B);\n                break;\n            default:\n                console.warn(\"Unknown operation: \" + this.properties.OP);\n        }\n        this.setOutputData(0, result);\n    };\n\n    Math3DOperation.prototype.onDrawBackground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n\n        ctx.font = \"40px Arial\";\n        ctx.fillStyle = \"#666\";\n        ctx.textAlign = \"center\";\n        ctx.fillText(\n            this.properties.OP,\n            this.size[0] * 0.5,\n            (this.size[1] + LiteGraph.NODE_TITLE_HEIGHT) * 0.5\n        );\n        ctx.textAlign = \"left\";\n    };\n\n    LiteGraph.registerNodeType(\"math3d/operation\", Math3DOperation);\n\n    function Math3DVec3Scale() {\n        this.addInput(\"in\", \"vec3\");\n        this.addInput(\"f\", \"number\");\n        this.addOutput(\"out\", \"vec3\");\n        this.properties = { f: 1 };\n        this._data = new Float32Array(3);\n    }\n\n    Math3DVec3Scale.title = \"vec3_scale\";\n    Math3DVec3Scale.desc = \"scales the components of a vec3\";\n\n    Math3DVec3Scale.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            return;\n        }\n        var f = this.getInputData(1);\n        if (f == null) {\n            f = this.properties.f;\n        }\n\n        var data = this._data;\n        data[0] = v[0] * f;\n        data[1] = v[1] * f;\n        data[2] = v[2] * f;\n        this.setOutputData(0, data);\n    };\n\n    LiteGraph.registerNodeType(\"math3d/vec3-scale\", Math3DVec3Scale);\n\n    function Math3DVec3Length() {\n        this.addInput(\"in\", \"vec3\");\n        this.addOutput(\"out\", \"number\");\n    }\n\n    Math3DVec3Length.title = \"vec3_length\";\n    Math3DVec3Length.desc = \"returns the module of a vector\";\n\n    Math3DVec3Length.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            return;\n        }\n        var dist = Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);\n        this.setOutputData(0, dist);\n    };\n\n    LiteGraph.registerNodeType(\"math3d/vec3-length\", Math3DVec3Length);\n\n    function Math3DVec3Normalize() {\n        this.addInput(\"in\", \"vec3\");\n        this.addOutput(\"out\", \"vec3\");\n        this._data = new Float32Array(3);\n    }\n\n    Math3DVec3Normalize.title = \"vec3_normalize\";\n    Math3DVec3Normalize.desc = \"returns the vector normalized\";\n\n    Math3DVec3Normalize.prototype.onExecute = function() {\n        var v = this.getInputData(0);\n        if (v == null) {\n            return;\n        }\n        var dist = Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);\n        var data = this._data;\n        data[0] = v[0] / dist;\n        data[1] = v[1] / dist;\n        data[2] = v[2] / dist;\n\n        this.setOutputData(0, data);\n    };\n\n    LiteGraph.registerNodeType(\"math3d/vec3-normalize\", Math3DVec3Normalize);\n\n    function Math3DVec3Lerp() {\n        this.addInput(\"A\", \"vec3\");\n        this.addInput(\"B\", \"vec3\");\n        this.addInput(\"f\", \"vec3\");\n        this.addOutput(\"out\", \"vec3\");\n        this.properties = { f: 0.5 };\n        this._data = new Float32Array(3);\n    }\n\n    Math3DVec3Lerp.title = \"vec3_lerp\";\n    Math3DVec3Lerp.desc = \"returns the interpolated vector\";\n\n    Math3DVec3Lerp.prototype.onExecute = function() {\n        var A = this.getInputData(0);\n        if (A == null) {\n            return;\n        }\n        var B = this.getInputData(1);\n        if (B == null) {\n            return;\n        }\n        var f = this.getInputOrProperty(\"f\");\n\n        var data = this._data;\n        data[0] = A[0] * (1 - f) + B[0] * f;\n        data[1] = A[1] * (1 - f) + B[1] * f;\n        data[2] = A[2] * (1 - f) + B[2] * f;\n\n        this.setOutputData(0, data);\n    };\n\n    LiteGraph.registerNodeType(\"math3d/vec3-lerp\", Math3DVec3Lerp);\n\n    function Math3DVec3Dot() {\n        this.addInput(\"A\", \"vec3\");\n        this.addInput(\"B\", \"vec3\");\n        this.addOutput(\"out\", \"number\");\n    }\n\n    Math3DVec3Dot.title = \"vec3_dot\";\n    Math3DVec3Dot.desc = \"returns the dot product\";\n\n    Math3DVec3Dot.prototype.onExecute = function() {\n        var A = this.getInputData(0);\n        if (A == null) {\n            return;\n        }\n        var B = this.getInputData(1);\n        if (B == null) {\n            return;\n        }\n\n        var dot = A[0] * B[0] + A[1] * B[1] + A[2] * B[2];\n        this.setOutputData(0, dot);\n    };\n\n    LiteGraph.registerNodeType(\"math3d/vec3-dot\", Math3DVec3Dot);\n\n    //if glMatrix is installed...\n    if (global.glMatrix) {\n        function Math3DQuaternion() {\n            this.addOutput(\"quat\", \"quat\");\n            this.properties = { x: 0, y: 0, z: 0, w: 1, normalize: false };\n            this._value = quat.create();\n        }\n\n        Math3DQuaternion.title = \"Quaternion\";\n        Math3DQuaternion.desc = \"quaternion\";\n\n        Math3DQuaternion.prototype.onExecute = function() {\n            this._value[0] = this.getInputOrProperty(\"x\");\n            this._value[1] = this.getInputOrProperty(\"y\");\n            this._value[2] = this.getInputOrProperty(\"z\");\n            this._value[3] = this.getInputOrProperty(\"w\");\n            if (this.properties.normalize) {\n                quat.normalize(this._value, this._value);\n            }\n            this.setOutputData(0, this._value);\n        };\n\n        Math3DQuaternion.prototype.onGetInputs = function() {\n            return [\n                [\"x\", \"number\"],\n                [\"y\", \"number\"],\n                [\"z\", \"number\"],\n                [\"w\", \"number\"]\n            ];\n        };\n\n        LiteGraph.registerNodeType(\"math3d/quaternion\", Math3DQuaternion);\n\n        function Math3DRotation() {\n            this.addInputs([[\"degrees\", \"number\"], [\"axis\", \"vec3\"]]);\n            this.addOutput(\"quat\", \"quat\");\n            this.properties = { angle: 90.0, axis: vec3.fromValues(0, 1, 0) };\n\n            this._value = quat.create();\n        }\n\n        Math3DRotation.title = \"Rotation\";\n        Math3DRotation.desc = \"quaternion rotation\";\n\n        Math3DRotation.prototype.onExecute = function() {\n            var angle = this.getInputData(0);\n            if (angle == null) {\n                angle = this.properties.angle;\n            }\n            var axis = this.getInputData(1);\n            if (axis == null) {\n                axis = this.properties.axis;\n            }\n\n            var R = quat.setAxisAngle(this._value, axis, angle * 0.0174532925);\n            this.setOutputData(0, R);\n        };\n\n        LiteGraph.registerNodeType(\"math3d/rotation\", Math3DRotation);\n\n\n        function MathEulerToQuat() {\n            this.addInput(\"euler\", \"vec3\");\n            this.addOutput(\"quat\", \"quat\");\n            this.properties = { euler:[0,0,0], use_yaw_pitch_roll: false };\n\t\t\tthis._degs = vec3.create();\n            this._value = quat.create();\n        }\n\n        MathEulerToQuat.title = \"Euler->Quat\";\n        MathEulerToQuat.desc = \"Converts euler angles (in degrees) to quaternion\";\n\n        MathEulerToQuat.prototype.onExecute = function() {\n            var euler = this.getInputData(0);\n            if (euler == null) {\n                euler = this.properties.euler;\n            }\n\t\t\tvec3.scale( this._degs, euler, DEG2RAD );\n\t\t\tif(this.properties.use_yaw_pitch_roll)\n\t\t\t\tthis._degs = [this._degs[2],this._degs[0],this._degs[1]];\n            var R = quat.fromEuler(this._value, this._degs);\n            this.setOutputData(0, R);\n        };\n\n        LiteGraph.registerNodeType(\"math3d/euler_to_quat\", MathEulerToQuat);\n\n        function MathQuatToEuler() {\n            this.addInput([\"quat\", \"quat\"]);\n            this.addOutput(\"euler\", \"vec3\");\n\t\t\tthis._value = vec3.create();\n        }\n\n        MathQuatToEuler.title = \"Euler->Quat\";\n        MathQuatToEuler.desc = \"Converts rotX,rotY,rotZ in degrees to quat\";\n\n        MathQuatToEuler.prototype.onExecute = function() {\n            var q = this.getInputData(0);\n\t\t\tif(!q)\n\t\t\t\treturn;\n            var R = quat.toEuler(this._value, q);\n\t\t\tvec3.scale( this._value, this._value, DEG2RAD );\n            this.setOutputData(0, this._value);\n        };\n\n        LiteGraph.registerNodeType(\"math3d/quat_to_euler\", MathQuatToEuler);\n\n\n        //Math3D rotate vec3\n        function Math3DRotateVec3() {\n            this.addInputs([[\"vec3\", \"vec3\"], [\"quat\", \"quat\"]]);\n            this.addOutput(\"result\", \"vec3\");\n            this.properties = { vec: [0, 0, 1] };\n        }\n\n        Math3DRotateVec3.title = \"Rot. Vec3\";\n        Math3DRotateVec3.desc = \"rotate a point\";\n\n        Math3DRotateVec3.prototype.onExecute = function() {\n            var vec = this.getInputData(0);\n            if (vec == null) {\n                vec = this.properties.vec;\n            }\n            var quat = this.getInputData(1);\n            if (quat == null) {\n                this.setOutputData(vec);\n            } else {\n                this.setOutputData(\n                    0,\n                    vec3.transformQuat(vec3.create(), vec, quat)\n                );\n            }\n        };\n\n        LiteGraph.registerNodeType(\"math3d/rotate_vec3\", Math3DRotateVec3);\n\n        function Math3DMultQuat() {\n            this.addInputs([[\"A\", \"quat\"], [\"B\", \"quat\"]]);\n            this.addOutput(\"A*B\", \"quat\");\n\n            this._value = quat.create();\n        }\n\n        Math3DMultQuat.title = \"Mult. Quat\";\n        Math3DMultQuat.desc = \"rotate quaternion\";\n\n        Math3DMultQuat.prototype.onExecute = function() {\n            var A = this.getInputData(0);\n            if (A == null) {\n                return;\n            }\n            var B = this.getInputData(1);\n            if (B == null) {\n                return;\n            }\n\n            var R = quat.multiply(this._value, A, B);\n            this.setOutputData(0, R);\n        };\n\n        LiteGraph.registerNodeType(\"math3d/mult-quat\", Math3DMultQuat);\n\n        function Math3DQuatSlerp() {\n            this.addInputs([\n                [\"A\", \"quat\"],\n                [\"B\", \"quat\"],\n                [\"factor\", \"number\"]\n            ]);\n            this.addOutput(\"slerp\", \"quat\");\n            this.addProperty(\"factor\", 0.5);\n\n            this._value = quat.create();\n        }\n\n        Math3DQuatSlerp.title = \"Quat Slerp\";\n        Math3DQuatSlerp.desc = \"quaternion spherical interpolation\";\n\n        Math3DQuatSlerp.prototype.onExecute = function() {\n            var A = this.getInputData(0);\n            if (A == null) {\n                return;\n            }\n            var B = this.getInputData(1);\n            if (B == null) {\n                return;\n            }\n            var factor = this.properties.factor;\n            if (this.getInputData(2) != null) {\n                factor = this.getInputData(2);\n            }\n\n            var R = quat.slerp(this._value, A, B, factor);\n            this.setOutputData(0, R);\n        };\n\n        LiteGraph.registerNodeType(\"math3d/quat-slerp\", Math3DQuatSlerp);\n\n\n        //Math3D rotate vec3\n        function Math3DRemapRange() {\n            this.addInput(\"vec3\", \"vec3\");\n            this.addOutput(\"remap\", \"vec3\");\n\t\t\tthis.addOutput(\"clamped\", \"vec3\");\n            this.properties = { clamp: true, range_min: [-1, -1, 0], range_max: [1, 1, 0], target_min: [-1,-1,0], target_max:[1,1,0] };\n\t\t\tthis._value = vec3.create();\n\t\t\tthis._clamped = vec3.create();\n        }\n\n        Math3DRemapRange.title = \"Remap Range\";\n        Math3DRemapRange.desc = \"remap a 3D range\";\n\n        Math3DRemapRange.prototype.onExecute = function() {\n            var vec = this.getInputData(0);\n\t\t\tif(vec)\n\t\t\t\tthis._value.set(vec);\n\t\t\tvar range_min = this.properties.range_min;\n\t\t\tvar range_max = this.properties.range_max;\n\t\t\tvar target_min = this.properties.target_min;\n\t\t\tvar target_max = this.properties.target_max;\n\n\t\t\t//swap to avoid errors\n\t\t\t/*\n\t\t\tif(range_min > range_max)\n\t\t\t{\n\t\t\t\trange_min = range_max;\n\t\t\t\trange_max = this.properties.range_min;\n\t\t\t}\n\n\t\t\tif(target_min > target_max)\n\t\t\t{\n\t\t\t\ttarget_min = target_max;\n\t\t\t\ttarget_max = this.properties.target_min;\n\t\t\t}\n\t\t\t*/\n\n\t\t\tfor(var i = 0; i < 3; ++i)\n\t\t\t{\n\t\t\t\tvar r = range_max[i] - range_min[i];\n\t\t\t\tthis._clamped[i] = Math.clamp( this._value[i], range_min[i], range_max[i] );\n\t\t\t\tif(r == 0)\n\t\t\t\t{\n\t\t\t\t\tthis._value[i] = (target_min[i] + target_max[i]) * 0.5;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tvar n = (this._value[i] - range_min[i]) / r;\n\t\t\t\tif(this.properties.clamp)\n\t\t\t\t\tn = Math.clamp(n,0,1);\n\t\t\t\tvar t = target_max[i] - target_min[i];\n\t\t\t\tthis._value[i] = target_min[i] + n * t;\n\t\t\t}\n\n\t\t\tthis.setOutputData(0,this._value);\n\t\t\tthis.setOutputData(1,this._clamped);\n        };\n\n        LiteGraph.registerNodeType(\"math3d/remap_range\", Math3DRemapRange);\n\n\n\n    } //glMatrix\n\telse if (LiteGraph.debug)\n\t\tconsole.warn(\"No glmatrix found, some Math3D nodes may not work\");\n\n})(this);\n\n//basic nodes\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n    function toString(a) {\n\t\tif(a && a.constructor === Object)\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\treturn JSON.stringify(a);\n\t\t\t}\n\t\t\tcatch (err)\n\t\t\t{\n\t\t\t\treturn String(a);\n\t\t\t}\n\t\t}\n        return String(a);\n    }\n\n    LiteGraph.wrapFunctionAsNode(\"string/toString\", toString, [\"\"], \"string\");\n\n    function compare(a, b) {\n        return a == b;\n    }\n\n    LiteGraph.wrapFunctionAsNode(\n        \"string/compare\",\n        compare,\n        [\"string\", \"string\"],\n        \"boolean\"\n    );\n\n    function concatenate(a, b) {\n        if (a === undefined) {\n            return b;\n        }\n        if (b === undefined) {\n            return a;\n        }\n        return a + b;\n    }\n\n    LiteGraph.wrapFunctionAsNode(\n        \"string/concatenate\",\n        concatenate,\n        [\"string\", \"string\"],\n        \"string\"\n    );\n\n    function contains(a, b) {\n        if (a === undefined || b === undefined) {\n            return false;\n        }\n        return a.indexOf(b) != -1;\n    }\n\n    LiteGraph.wrapFunctionAsNode(\n        \"string/contains\",\n        contains,\n        [\"string\", \"string\"],\n        \"boolean\"\n    );\n\n    function toUpperCase(a) {\n        if (a != null && a.constructor === String) {\n            return a.toUpperCase();\n        }\n        return a;\n    }\n\n    LiteGraph.wrapFunctionAsNode(\n        \"string/toUpperCase\",\n        toUpperCase,\n        [\"string\"],\n        \"string\"\n    );\n\n    function split(str, separator) {\n\t\tif(separator == null)\n\t\t\tseparator = this.properties.separator;\n        if (str == null )\n\t        return [];\n\t\tif( str.constructor === String )\n\t\t\treturn str.split(separator || \" \");\n\t\telse if( str.constructor === Array )\n\t\t{\n\t\t\tvar r = [];\n\t\t\tfor(var i = 0; i < str.length; ++i){\n                if (typeof str[i] == \"string\")\n\t\t\t\t    r[i] = str[i].split(separator || \" \");\n            }\n\t\t\treturn r;\n\t\t}\n        return null;\n    }\n\n    LiteGraph.wrapFunctionAsNode(\n        \"string/split\",\n        split,\n        [\"string,array\", \"string\"],\n        \"array\",\n\t\t{ separator: \",\" }\n    );\n\n    function toFixed(a) {\n        if (a != null && a.constructor === Number) {\n            return a.toFixed(this.properties.precision);\n        }\n        return a;\n    }\n\n    LiteGraph.wrapFunctionAsNode(\n        \"string/toFixed\",\n        toFixed,\n        [\"number\"],\n        \"string\",\n        { precision: 0 }\n    );\n\n\n    function StringToTable() {\n        this.addInput(\"\", \"string\");\n        this.addOutput(\"table\", \"table\");\n        this.addOutput(\"rows\", \"number\");\n        this.addProperty(\"value\", \"\");\n        this.addProperty(\"separator\", \",\");\n\t\tthis._table = null;\n    }\n\n    StringToTable.title = \"toTable\";\n    StringToTable.desc = \"Splits a string to table\";\n\n    StringToTable.prototype.onExecute = function() {\n        var input = this.getInputData(0);\n\t\tif(!input)\n\t\t\treturn;\n\t\tvar separator = this.properties.separator || \",\";\n\t\tif(input != this._str || separator != this._last_separator )\n\t\t{\n\t\t\tthis._last_separator = separator;\n\t\t\tthis._str = input;\n\t\t\tthis._table = input.split(\"\\n\").map(function(a){ return a.trim().split(separator)});\n\t\t}\n        this.setOutputData(0, this._table );\n        this.setOutputData(1, this._table ? this._table.length : 0 );\n    };\n\n    LiteGraph.registerNodeType(\"string/toTable\", StringToTable);\n\n})(this);\n\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n    function Selector() {\n        this.addInput(\"sel\", \"number\");\n        this.addInput(\"A\");\n        this.addInput(\"B\");\n        this.addInput(\"C\");\n        this.addInput(\"D\");\n        this.addOutput(\"out\");\n\n        this.selected = 0;\n    }\n\n    Selector.title = \"Selector\";\n    Selector.desc = \"selects an output\";\n\n    Selector.prototype.onDrawBackground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n        ctx.fillStyle = \"#AFB\";\n        var y = (this.selected + 1) * LiteGraph.NODE_SLOT_HEIGHT + 6;\n        ctx.beginPath();\n        ctx.moveTo(50, y);\n        ctx.lineTo(50, y + LiteGraph.NODE_SLOT_HEIGHT);\n        ctx.lineTo(34, y + LiteGraph.NODE_SLOT_HEIGHT * 0.5);\n        ctx.fill();\n    };\n\n    Selector.prototype.onExecute = function() {\n        var sel = this.getInputData(0);\n        if (sel == null || sel.constructor !== Number)\n            sel = 0;\n        this.selected = sel = Math.round(sel) % (this.inputs.length - 1);\n        var v = this.getInputData(sel + 1);\n        if (v !== undefined) {\n            this.setOutputData(0, v);\n        }\n    };\n\n    Selector.prototype.onGetInputs = function() {\n        return [[\"E\", 0], [\"F\", 0], [\"G\", 0], [\"H\", 0]];\n    };\n\n    LiteGraph.registerNodeType(\"logic/selector\", Selector);\n\n    function Sequence() {\n        this.properties = {\n            sequence: \"A,B,C\"\n        };\n        this.addInput(\"index\", \"number\");\n        this.addInput(\"seq\");\n        this.addOutput(\"out\");\n\n        this.index = 0;\n        this.values = this.properties.sequence.split(\",\");\n    }\n\n    Sequence.title = \"Sequence\";\n    Sequence.desc = \"select one element from a sequence from a string\";\n\n    Sequence.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"sequence\") {\n            this.values = value.split(\",\");\n        }\n    };\n\n    Sequence.prototype.onExecute = function() {\n        var seq = this.getInputData(1);\n        if (seq && seq != this.current_sequence) {\n            this.values = seq.split(\",\");\n            this.current_sequence = seq;\n        }\n        var index = this.getInputData(0);\n        if (index == null) {\n            index = 0;\n        }\n        this.index = index = Math.round(index) % this.values.length;\n\n        this.setOutputData(0, this.values[index]);\n    };\n\n    LiteGraph.registerNodeType(\"logic/sequence\", Sequence);\n\t\n    \n    function logicAnd(){\n        this.properties = { };\n        this.addInput(\"a\", \"boolean\");\n        this.addInput(\"b\", \"boolean\");\n        this.addOutput(\"out\", \"boolean\");\n    }\n    logicAnd.title = \"AND\";\n    logicAnd.desc = \"Return true if all inputs are true\";\n    logicAnd.prototype.onExecute = function() {\n        ret = true;\n        for (inX in this.inputs){\n            if (!this.getInputData(inX)){\n                ret = false;\n                break;\n            }\n        }\n        this.setOutputData(0, ret);\n    };\n    logicAnd.prototype.onGetInputs = function() {\n        return [\n            [\"and\", \"boolean\"]\n        ];\n    };\n    LiteGraph.registerNodeType(\"logic/AND\", logicAnd);\n    \n    \n    function logicOr(){\n        this.properties = { };\n        this.addInput(\"a\", \"boolean\");\n        this.addInput(\"b\", \"boolean\");\n        this.addOutput(\"out\", \"boolean\");\n    }\n    logicOr.title = \"OR\";\n    logicOr.desc = \"Return true if at least one input is true\";\n    logicOr.prototype.onExecute = function() {\n        ret = false;\n        for (inX in this.inputs){\n            if (this.getInputData(inX)){\n                ret = true;\n                break;\n            }\n        }\n        this.setOutputData(0, ret);\n    };\n    logicOr.prototype.onGetInputs = function() {\n        return [\n            [\"or\", \"boolean\"]\n        ];\n    };\n    LiteGraph.registerNodeType(\"logic/OR\", logicOr);\n    \n    \n    function logicNot(){\n        this.properties = { };\n        this.addInput(\"in\", \"boolean\");\n        this.addOutput(\"out\", \"boolean\");\n    }\n    logicNot.title = \"NOT\";\n    logicNot.desc = \"Return the logical negation\";\n    logicNot.prototype.onExecute = function() {\n        var ret = !this.getInputData(0);\n        this.setOutputData(0, ret);\n    };\n    LiteGraph.registerNodeType(\"logic/NOT\", logicNot);\n    \n    \n    function logicCompare(){\n        this.properties = { };\n        this.addInput(\"a\", \"boolean\");\n        this.addInput(\"b\", \"boolean\");\n        this.addOutput(\"out\", \"boolean\");\n    }\n    logicCompare.title = \"bool == bool\";\n    logicCompare.desc = \"Compare for logical equality\";\n    logicCompare.prototype.onExecute = function() {\n        last = null;\n        ret = true;\n        for (inX in this.inputs){\n            if (last === null) last = this.getInputData(inX);\n            else\n                if (last != this.getInputData(inX)){\n                    ret = false;\n                    break;\n                }\n        }\n        this.setOutputData(0, ret);\n    };\n    logicCompare.prototype.onGetInputs = function() {\n        return [\n            [\"bool\", \"boolean\"]\n        ];\n    };\n    LiteGraph.registerNodeType(\"logic/CompareBool\", logicCompare);\n    \n    \n    function logicBranch(){\n        this.properties = { };\n        this.addInput(\"onTrigger\", LiteGraph.ACTION);\n        this.addInput(\"condition\", \"boolean\");\n        this.addOutput(\"true\", LiteGraph.EVENT);\n        this.addOutput(\"false\", LiteGraph.EVENT);\n        this.mode = LiteGraph.ON_TRIGGER;\n    }\n    logicBranch.title = \"Branch\";\n    logicBranch.desc = \"Branch execution on condition\";\n    logicBranch.prototype.onExecute = function(param, options) {\n        var condtition = this.getInputData(1);\n        if (condtition){\n            this.triggerSlot(0);\n        }else{\n            this.triggerSlot(1);\n        }\n    };\n    LiteGraph.registerNodeType(\"logic/IF\", logicBranch);\n})(this);\n\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n    function GraphicsPlot() {\n        this.addInput(\"A\", \"Number\");\n        this.addInput(\"B\", \"Number\");\n        this.addInput(\"C\", \"Number\");\n        this.addInput(\"D\", \"Number\");\n\n        this.values = [[], [], [], []];\n        this.properties = { scale: 2 };\n    }\n\n    GraphicsPlot.title = \"Plot\";\n    GraphicsPlot.desc = \"Plots data over time\";\n    GraphicsPlot.colors = [\"#FFF\", \"#F99\", \"#9F9\", \"#99F\"];\n\n    GraphicsPlot.prototype.onExecute = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n\n        var size = this.size;\n\n        for (var i = 0; i < 4; ++i) {\n            var v = this.getInputData(i);\n            if (v == null) {\n                continue;\n            }\n            var values = this.values[i];\n            values.push(v);\n            if (values.length > size[0]) {\n                values.shift();\n            }\n        }\n    };\n\n    GraphicsPlot.prototype.onDrawBackground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n\n        var size = this.size;\n\n        var scale = (0.5 * size[1]) / this.properties.scale;\n        var colors = GraphicsPlot.colors;\n        var offset = size[1] * 0.5;\n\n        ctx.fillStyle = \"#000\";\n        ctx.fillRect(0, 0, size[0], size[1]);\n        ctx.strokeStyle = \"#555\";\n        ctx.beginPath();\n        ctx.moveTo(0, offset);\n        ctx.lineTo(size[0], offset);\n        ctx.stroke();\n\n        if (this.inputs) {\n            for (var i = 0; i < 4; ++i) {\n                var values = this.values[i];\n                if (!this.inputs[i] || !this.inputs[i].link) {\n                    continue;\n                }\n                ctx.strokeStyle = colors[i];\n                ctx.beginPath();\n                var v = values[0] * scale * -1 + offset;\n                ctx.moveTo(0, Math.clamp(v, 0, size[1]));\n                for (var j = 1; j < values.length && j < size[0]; ++j) {\n                    var v = values[j] * scale * -1 + offset;\n                    ctx.lineTo(j, Math.clamp(v, 0, size[1]));\n                }\n                ctx.stroke();\n            }\n        }\n    };\n\n    LiteGraph.registerNodeType(\"graphics/plot\", GraphicsPlot);\n\n    function GraphicsImage() {\n        this.addOutput(\"frame\", \"image\");\n        this.properties = { url: \"\" };\n    }\n\n    GraphicsImage.title = \"Image\";\n    GraphicsImage.desc = \"Image loader\";\n    GraphicsImage.widgets = [{ name: \"load\", text: \"Load\", type: \"button\" }];\n\n    GraphicsImage.supported_extensions = [\"jpg\", \"jpeg\", \"png\", \"gif\"];\n\n    GraphicsImage.prototype.onAdded = function() {\n        if (this.properties[\"url\"] != \"\" && this.img == null) {\n            this.loadImage(this.properties[\"url\"]);\n        }\n    };\n\n    GraphicsImage.prototype.onDrawBackground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n        if (this.img && this.size[0] > 5 && this.size[1] > 5 && this.img.width) {\n            ctx.drawImage(this.img, 0, 0, this.size[0], this.size[1]);\n        }\n    };\n\n    GraphicsImage.prototype.onExecute = function() {\n        if (!this.img) {\n            this.boxcolor = \"#000\";\n        }\n        if (this.img && this.img.width) {\n            this.setOutputData(0, this.img);\n        } else {\n            this.setOutputData(0, null);\n        }\n        if (this.img && this.img.dirty) {\n            this.img.dirty = false;\n        }\n    };\n\n    GraphicsImage.prototype.onPropertyChanged = function(name, value) {\n        this.properties[name] = value;\n        if (name == \"url\" && value != \"\") {\n            this.loadImage(value);\n        }\n\n        return true;\n    };\n\n    GraphicsImage.prototype.loadImage = function(url, callback) {\n        if (url == \"\") {\n            this.img = null;\n            return;\n        }\n\n        this.img = document.createElement(\"img\");\n\n        if (url.substr(0, 4) == \"http\" && LiteGraph.proxy) {\n            url = LiteGraph.proxy + url.substr(url.indexOf(\":\") + 3);\n        }\n\n        this.img.src = url;\n        this.boxcolor = \"#F95\";\n        var that = this;\n        this.img.onload = function() {\n            if (callback) {\n                callback(this);\n            }\n            console.log( \"Image loaded, size: \" + that.img.width + \"x\" + that.img.height );\n            this.dirty = true;\n            that.boxcolor = \"#9F9\";\n            that.setDirtyCanvas(true);\n        };\n        this.img.onerror = function() {\n\t\t\tconsole.log(\"error loading the image:\" + url);\n\t\t}\n    };\n\n    GraphicsImage.prototype.onWidget = function(e, widget) {\n        if (widget.name == \"load\") {\n            this.loadImage(this.properties[\"url\"]);\n        }\n    };\n\n    GraphicsImage.prototype.onDropFile = function(file) {\n        var that = this;\n        if (this._url) {\n            URL.revokeObjectURL(this._url);\n        }\n        this._url = URL.createObjectURL(file);\n        this.properties.url = this._url;\n        this.loadImage(this._url, function(img) {\n            that.size[1] = (img.height / img.width) * that.size[0];\n        });\n    };\n\n    LiteGraph.registerNodeType(\"graphics/image\", GraphicsImage);\n\n    function ColorPalette() {\n        this.addInput(\"f\", \"number\");\n        this.addOutput(\"Color\", \"color\");\n        this.properties = {\n            colorA: \"#444444\",\n            colorB: \"#44AAFF\",\n            colorC: \"#44FFAA\",\n            colorD: \"#FFFFFF\"\n        };\n    }\n\n    ColorPalette.title = \"Palette\";\n    ColorPalette.desc = \"Generates a color\";\n\n    ColorPalette.prototype.onExecute = function() {\n        var c = [];\n\n        if (this.properties.colorA != null) {\n            c.push(hex2num(this.properties.colorA));\n        }\n        if (this.properties.colorB != null) {\n            c.push(hex2num(this.properties.colorB));\n        }\n        if (this.properties.colorC != null) {\n            c.push(hex2num(this.properties.colorC));\n        }\n        if (this.properties.colorD != null) {\n            c.push(hex2num(this.properties.colorD));\n        }\n\n        var f = this.getInputData(0);\n        if (f == null) {\n            f = 0.5;\n        }\n        if (f > 1.0) {\n            f = 1.0;\n        } else if (f < 0.0) {\n            f = 0.0;\n        }\n\n        if (c.length == 0) {\n            return;\n        }\n\n        var result = [0, 0, 0];\n        if (f == 0) {\n            result = c[0];\n        } else if (f == 1) {\n            result = c[c.length - 1];\n        } else {\n            var pos = (c.length - 1) * f;\n            var c1 = c[Math.floor(pos)];\n            var c2 = c[Math.floor(pos) + 1];\n            var t = pos - Math.floor(pos);\n            result[0] = c1[0] * (1 - t) + c2[0] * t;\n            result[1] = c1[1] * (1 - t) + c2[1] * t;\n            result[2] = c1[2] * (1 - t) + c2[2] * t;\n        }\n\n        /*\n\tc[0] = 1.0 - Math.abs( Math.sin( 0.1 * reModular.getTime() * Math.PI) );\n\tc[1] = Math.abs( Math.sin( 0.07 * reModular.getTime() * Math.PI) );\n\tc[2] = Math.abs( Math.sin( 0.01 * reModular.getTime() * Math.PI) );\n\t*/\n\n        for (var i=0; i < result.length; i++) {\n            result[i] /= 255;\n        }\n\n        this.boxcolor = colorToString(result);\n        this.setOutputData(0, result);\n    };\n\n    LiteGraph.registerNodeType(\"color/palette\", ColorPalette);\n\n    function ImageFrame() {\n        this.addInput(\"\", \"image,canvas\");\n        this.size = [200, 200];\n    }\n\n    ImageFrame.title = \"Frame\";\n    ImageFrame.desc = \"Frame viewerew\";\n    ImageFrame.widgets = [\n        { name: \"resize\", text: \"Resize box\", type: \"button\" },\n        { name: \"view\", text: \"View Image\", type: \"button\" }\n    ];\n\n    ImageFrame.prototype.onDrawBackground = function(ctx) {\n        if (this.frame && !this.flags.collapsed) {\n            ctx.drawImage(this.frame, 0, 0, this.size[0], this.size[1]);\n        }\n    };\n\n    ImageFrame.prototype.onExecute = function() {\n        this.frame = this.getInputData(0);\n        this.setDirtyCanvas(true);\n    };\n\n    ImageFrame.prototype.onWidget = function(e, widget) {\n        if (widget.name == \"resize\" && this.frame) {\n            var width = this.frame.width;\n            var height = this.frame.height;\n\n            if (!width && this.frame.videoWidth != null) {\n                width = this.frame.videoWidth;\n                height = this.frame.videoHeight;\n            }\n\n            if (width && height) {\n                this.size = [width, height];\n            }\n            this.setDirtyCanvas(true, true);\n        } else if (widget.name == \"view\") {\n            this.show();\n        }\n    };\n\n    ImageFrame.prototype.show = function() {\n        //var str = this.canvas.toDataURL(\"image/png\");\n        if (showElement && this.frame) {\n            showElement(this.frame);\n        }\n    };\n\n    LiteGraph.registerNodeType(\"graphics/frame\", ImageFrame);\n\n    function ImageFade() {\n        this.addInputs([\n            [\"img1\", \"image\"],\n            [\"img2\", \"image\"],\n            [\"fade\", \"number\"]\n        ]);\n        this.addOutput(\"\", \"image\");\n        this.properties = { fade: 0.5, width: 512, height: 512 };\n    }\n\n    ImageFade.title = \"Image fade\";\n    ImageFade.desc = \"Fades between images\";\n    ImageFade.widgets = [\n        { name: \"resizeA\", text: \"Resize to A\", type: \"button\" },\n        { name: \"resizeB\", text: \"Resize to B\", type: \"button\" }\n    ];\n\n    ImageFade.prototype.onAdded = function() {\n        this.createCanvas();\n        var ctx = this.canvas.getContext(\"2d\");\n        ctx.fillStyle = \"#000\";\n        ctx.fillRect(0, 0, this.properties[\"width\"], this.properties[\"height\"]);\n    };\n\n    ImageFade.prototype.createCanvas = function() {\n        this.canvas = document.createElement(\"canvas\");\n        this.canvas.width = this.properties[\"width\"];\n        this.canvas.height = this.properties[\"height\"];\n    };\n\n    ImageFade.prototype.onExecute = function() {\n        var ctx = this.canvas.getContext(\"2d\");\n        this.canvas.width = this.canvas.width;\n\n        var A = this.getInputData(0);\n        if (A != null) {\n            ctx.drawImage(A, 0, 0, this.canvas.width, this.canvas.height);\n        }\n\n        var fade = this.getInputData(2);\n        if (fade == null) {\n            fade = this.properties[\"fade\"];\n        } else {\n            this.properties[\"fade\"] = fade;\n        }\n\n        ctx.globalAlpha = fade;\n        var B = this.getInputData(1);\n        if (B != null) {\n            ctx.drawImage(B, 0, 0, this.canvas.width, this.canvas.height);\n        }\n        ctx.globalAlpha = 1.0;\n\n        this.setOutputData(0, this.canvas);\n        this.setDirtyCanvas(true);\n    };\n\n    LiteGraph.registerNodeType(\"graphics/imagefade\", ImageFade);\n\n    function ImageCrop() {\n        this.addInput(\"\", \"image\");\n        this.addOutput(\"\", \"image\");\n        this.properties = { width: 256, height: 256, x: 0, y: 0, scale: 1.0 };\n        this.size = [50, 20];\n    }\n\n    ImageCrop.title = \"Crop\";\n    ImageCrop.desc = \"Crop Image\";\n\n    ImageCrop.prototype.onAdded = function() {\n        this.createCanvas();\n    };\n\n    ImageCrop.prototype.createCanvas = function() {\n        this.canvas = document.createElement(\"canvas\");\n        this.canvas.width = this.properties[\"width\"];\n        this.canvas.height = this.properties[\"height\"];\n    };\n\n    ImageCrop.prototype.onExecute = function() {\n        var input = this.getInputData(0);\n        if (!input) {\n            return;\n        }\n\n        if (input.width) {\n            var ctx = this.canvas.getContext(\"2d\");\n\n            ctx.drawImage(\n                input,\n                -this.properties[\"x\"],\n                -this.properties[\"y\"],\n                input.width * this.properties[\"scale\"],\n                input.height * this.properties[\"scale\"]\n            );\n            this.setOutputData(0, this.canvas);\n        } else {\n            this.setOutputData(0, null);\n        }\n    };\n\n    ImageCrop.prototype.onDrawBackground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n        if (this.canvas) {\n            ctx.drawImage(\n                this.canvas,\n                0,\n                0,\n                this.canvas.width,\n                this.canvas.height,\n                0,\n                0,\n                this.size[0],\n                this.size[1]\n            );\n        }\n    };\n\n    ImageCrop.prototype.onPropertyChanged = function(name, value) {\n        this.properties[name] = value;\n\n        if (name == \"scale\") {\n            this.properties[name] = parseFloat(value);\n            if (this.properties[name] == 0) {\n                console.error(\"Error in scale\");\n                this.properties[name] = 1.0;\n            }\n        } else {\n            this.properties[name] = parseInt(value);\n        }\n\n        this.createCanvas();\n\n        return true;\n    };\n\n    LiteGraph.registerNodeType(\"graphics/cropImage\", ImageCrop);\n\n    //CANVAS stuff\n\n    function CanvasNode() {\n        this.addInput(\"clear\", LiteGraph.ACTION);\n        this.addOutput(\"\", \"canvas\");\n        this.properties = { width: 512, height: 512, autoclear: true };\n\n        this.canvas = document.createElement(\"canvas\");\n        this.ctx = this.canvas.getContext(\"2d\");\n    }\n\n    CanvasNode.title = \"Canvas\";\n    CanvasNode.desc = \"Canvas to render stuff\";\n\n    CanvasNode.prototype.onExecute = function() {\n        var canvas = this.canvas;\n        var w = this.properties.width | 0;\n        var h = this.properties.height | 0;\n        if (canvas.width != w) {\n            canvas.width = w;\n        }\n        if (canvas.height != h) {\n            canvas.height = h;\n        }\n\n        if (this.properties.autoclear) {\n            this.ctx.clearRect(0, 0, canvas.width, canvas.height);\n        }\n        this.setOutputData(0, canvas);\n    };\n\n    CanvasNode.prototype.onAction = function(action, param) {\n        if (action == \"clear\") {\n            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        }\n    };\n\n    LiteGraph.registerNodeType(\"graphics/canvas\", CanvasNode);\n\n    function DrawImageNode() {\n        this.addInput(\"canvas\", \"canvas\");\n        this.addInput(\"img\", \"image,canvas\");\n        this.addInput(\"x\", \"number\");\n        this.addInput(\"y\", \"number\");\n        this.properties = { x: 0, y: 0, opacity: 1 };\n    }\n\n    DrawImageNode.title = \"DrawImage\";\n    DrawImageNode.desc = \"Draws image into a canvas\";\n\n    DrawImageNode.prototype.onExecute = function() {\n        var canvas = this.getInputData(0);\n        if (!canvas) {\n            return;\n        }\n\n        var img = this.getInputOrProperty(\"img\");\n        if (!img) {\n            return;\n        }\n\n        var x = this.getInputOrProperty(\"x\");\n        var y = this.getInputOrProperty(\"y\");\n        var ctx = canvas.getContext(\"2d\");\n        ctx.drawImage(img, x, y);\n    };\n\n    LiteGraph.registerNodeType(\"graphics/drawImage\", DrawImageNode);\n\n    function DrawRectangleNode() {\n        this.addInput(\"canvas\", \"canvas\");\n        this.addInput(\"x\", \"number\");\n        this.addInput(\"y\", \"number\");\n        this.addInput(\"w\", \"number\");\n        this.addInput(\"h\", \"number\");\n        this.properties = {\n            x: 0,\n            y: 0,\n            w: 10,\n            h: 10,\n            color: \"white\",\n            opacity: 1\n        };\n    }\n\n    DrawRectangleNode.title = \"DrawRectangle\";\n    DrawRectangleNode.desc = \"Draws rectangle in canvas\";\n\n    DrawRectangleNode.prototype.onExecute = function() {\n        var canvas = this.getInputData(0);\n        if (!canvas) {\n            return;\n        }\n\n        var x = this.getInputOrProperty(\"x\");\n        var y = this.getInputOrProperty(\"y\");\n        var w = this.getInputOrProperty(\"w\");\n        var h = this.getInputOrProperty(\"h\");\n        var ctx = canvas.getContext(\"2d\");\n        ctx.fillRect(x, y, w, h);\n    };\n\n    LiteGraph.registerNodeType(\"graphics/drawRectangle\", DrawRectangleNode);\n\n    function ImageVideo() {\n        this.addInput(\"t\", \"number\");\n        this.addOutputs([[\"frame\", \"image\"], [\"t\", \"number\"], [\"d\", \"number\"]]);\n        this.properties = { url: \"\", use_proxy: true };\n    }\n\n    ImageVideo.title = \"Video\";\n    ImageVideo.desc = \"Video playback\";\n    ImageVideo.widgets = [\n        { name: \"play\", text: \"PLAY\", type: \"minibutton\" },\n        { name: \"stop\", text: \"STOP\", type: \"minibutton\" },\n        { name: \"demo\", text: \"Demo video\", type: \"button\" },\n        { name: \"mute\", text: \"Mute video\", type: \"button\" }\n    ];\n\n    ImageVideo.prototype.onExecute = function() {\n        if (!this.properties.url) {\n            return;\n        }\n\n        if (this.properties.url != this._video_url) {\n            this.loadVideo(this.properties.url);\n        }\n\n        if (!this._video || this._video.width == 0) {\n            return;\n        }\n\n        var t = this.getInputData(0);\n        if (t && t >= 0 && t <= 1.0) {\n            this._video.currentTime = t * this._video.duration;\n            this._video.pause();\n        }\n\n        this._video.dirty = true;\n        this.setOutputData(0, this._video);\n        this.setOutputData(1, this._video.currentTime);\n        this.setOutputData(2, this._video.duration);\n        this.setDirtyCanvas(true);\n    };\n\n    ImageVideo.prototype.onStart = function() {\n        this.play();\n    };\n\n    ImageVideo.prototype.onStop = function() {\n        this.stop();\n    };\n\n    ImageVideo.prototype.loadVideo = function(url) {\n        this._video_url = url;\n\n\t\tvar pos = url.substr(0,10).indexOf(\":\");\n\t\tvar protocol = \"\";\n\t\tif(pos != -1)\n\t\t\tprotocol = url.substr(0,pos);\n\n\t\tvar host = \"\";\n\t\tif(protocol)\n\t\t{\n\t\t\thost = url.substr(0,url.indexOf(\"/\",protocol.length + 3));\n\t\t\thost = host.substr(protocol.length+3);\n\t\t}\n\n        if (\n            this.properties.use_proxy &&\n            protocol &&\n            LiteGraph.proxy &&\n\t\t\thost != location.host\n        ) {\n            url = LiteGraph.proxy + url.substr(url.indexOf(\":\") + 3);\n        }\n\n        this._video = document.createElement(\"video\");\n        this._video.src = url;\n        this._video.type = \"type=video/mp4\";\n\n        this._video.muted = true;\n        this._video.autoplay = true;\n\n        var that = this;\n        this._video.addEventListener(\"loadedmetadata\", function(e) {\n            //onload\n            console.log(\"Duration: \" + this.duration + \" seconds\");\n            console.log(\"Size: \" + this.videoWidth + \",\" + this.videoHeight);\n            that.setDirtyCanvas(true);\n            this.width = this.videoWidth;\n            this.height = this.videoHeight;\n        });\n        this._video.addEventListener(\"progress\", function(e) {\n            //onload\n            console.log(\"video loading...\");\n        });\n        this._video.addEventListener(\"error\", function(e) {\n            console.error(\"Error loading video: \" + this.src);\n            if (this.error) {\n                switch (this.error.code) {\n                    case this.error.MEDIA_ERR_ABORTED:\n                        console.error(\"You stopped the video.\");\n                        break;\n                    case this.error.MEDIA_ERR_NETWORK:\n                        console.error(\"Network error - please try again later.\");\n                        break;\n                    case this.error.MEDIA_ERR_DECODE:\n                        console.error(\"Video is broken..\");\n                        break;\n                    case this.error.MEDIA_ERR_SRC_NOT_SUPPORTED:\n                        console.error(\"Sorry, your browser can't play this video.\");\n                        break;\n                }\n            }\n        });\n\n        this._video.addEventListener(\"ended\", function(e) {\n            console.log(\"Video Ended.\");\n            this.play(); //loop\n        });\n\n        //document.body.appendChild(this.video);\n    };\n\n    ImageVideo.prototype.onPropertyChanged = function(name, value) {\n        this.properties[name] = value;\n        if (name == \"url\" && value != \"\") {\n            this.loadVideo(value);\n        }\n\n        return true;\n    };\n\n    ImageVideo.prototype.play = function() {\n        if (this._video && this._video.videoWidth ) { //is loaded\n            this._video.play();\n        }\n    };\n\n    ImageVideo.prototype.playPause = function() {\n        if (!this._video) {\n            return;\n        }\n        if (this._video.paused) {\n            this.play();\n        } else {\n            this.pause();\n        }\n    };\n\n    ImageVideo.prototype.stop = function() {\n        if (!this._video) {\n            return;\n        }\n        this._video.pause();\n        this._video.currentTime = 0;\n    };\n\n    ImageVideo.prototype.pause = function() {\n        if (!this._video) {\n            return;\n        }\n        console.log(\"Video paused\");\n        this._video.pause();\n    };\n\n    ImageVideo.prototype.onWidget = function(e, widget) {\n        /*\n\tif(widget.name == \"demo\")\n\t{\n\t\tthis.loadVideo();\n\t}\n\telse if(widget.name == \"play\")\n\t{\n\t\tif(this._video)\n\t\t\tthis.playPause();\n\t}\n\tif(widget.name == \"stop\")\n\t{\n\t\tthis.stop();\n\t}\n\telse if(widget.name == \"mute\")\n\t{\n\t\tif(this._video)\n\t\t\tthis._video.muted = !this._video.muted;\n\t}\n\t*/\n    };\n\n    LiteGraph.registerNodeType(\"graphics/video\", ImageVideo);\n\n    // Texture Webcam *****************************************\n    function ImageWebcam() {\n        this.addOutput(\"Webcam\", \"image\");\n        this.properties = { filterFacingMode: false, facingMode: \"user\" };\n        this.boxcolor = \"black\";\n        this.frame = 0;\n    }\n\n    ImageWebcam.title = \"Webcam\";\n    ImageWebcam.desc = \"Webcam image\";\n    ImageWebcam.is_webcam_open = false;\n\n    ImageWebcam.prototype.openStream = function() {\n        if (!navigator.mediaDevices.getUserMedia) {\n            console.log('getUserMedia() is not supported in your browser, use chrome and enable WebRTC from about://flags');\n            return;\n        }\n\n        this._waiting_confirmation = true;\n\n        // Not showing vendor prefixes.\n        var constraints = {\n            audio: false,\n            video: !this.properties.filterFacingMode ? true : { facingMode: this.properties.facingMode }\n        };\n        navigator.mediaDevices\n            .getUserMedia(constraints)\n            .then(this.streamReady.bind(this))\n            .catch(onFailSoHard);\n\n        var that = this;\n        function onFailSoHard(e) {\n            console.log(\"Webcam rejected\", e);\n            that._webcam_stream = false;\n            ImageWebcam.is_webcam_open = false;\n            that.boxcolor = \"red\";\n            that.trigger(\"stream_error\");\n        }\n    };\n\n    ImageWebcam.prototype.closeStream = function() {\n        if (this._webcam_stream) {\n            var tracks = this._webcam_stream.getTracks();\n            if (tracks.length) {\n                for (var i = 0; i < tracks.length; ++i) {\n                    tracks[i].stop();\n                }\n            }\n            ImageWebcam.is_webcam_open = false;\n            this._webcam_stream = null;\n            this._video = null;\n            this.boxcolor = \"black\";\n            this.trigger(\"stream_closed\");\n        }\n    };\n\n    ImageWebcam.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"facingMode\") {\n            this.properties.facingMode = value;\n            this.closeStream();\n            this.openStream();\n        }\n    };\n\n    ImageWebcam.prototype.onRemoved = function() {\n        this.closeStream();\n    };\n\n    ImageWebcam.prototype.streamReady = function(localMediaStream) {\n        this._webcam_stream = localMediaStream;\n        //this._waiting_confirmation = false;\n        this.boxcolor = \"green\";\n\n        var video = this._video;\n        if (!video) {\n            video = document.createElement(\"video\");\n            video.autoplay = true;\n            video.srcObject = localMediaStream;\n            this._video = video;\n            //document.body.appendChild( video ); //debug\n            //when video info is loaded (size and so)\n            video.onloadedmetadata = function(e) {\n                // Ready to go. Do some stuff.\n                console.log(e);\n                ImageWebcam.is_webcam_open = true;\n            };\n        }\n\n        this.trigger(\"stream_ready\", video);\n    };\n\n    ImageWebcam.prototype.onExecute = function() {\n        if (this._webcam_stream == null && !this._waiting_confirmation) {\n            this.openStream();\n        }\n\n        if (!this._video || !this._video.videoWidth) {\n            return;\n        }\n\n        this._video.frame = ++this.frame;\n        this._video.width = this._video.videoWidth;\n        this._video.height = this._video.videoHeight;\n        this.setOutputData(0, this._video);\n        for (var i = 1; i < this.outputs.length; ++i) {\n            if (!this.outputs[i]) {\n                continue;\n            }\n            switch (this.outputs[i].name) {\n                case \"width\":\n                    this.setOutputData(i, this._video.videoWidth);\n                    break;\n                case \"height\":\n                    this.setOutputData(i, this._video.videoHeight);\n                    break;\n            }\n        }\n    };\n\n    ImageWebcam.prototype.getExtraMenuOptions = function(graphcanvas) {\n        var that = this;\n        var txt = !that.properties.show ? \"Show Frame\" : \"Hide Frame\";\n        return [\n            {\n                content: txt,\n                callback: function() {\n                    that.properties.show = !that.properties.show;\n                }\n            }\n        ];\n    };\n\n    ImageWebcam.prototype.onDrawBackground = function(ctx) {\n        if (\n            this.flags.collapsed ||\n            this.size[1] <= 20 ||\n            !this.properties.show\n        ) {\n            return;\n        }\n\n        if (!this._video) {\n            return;\n        }\n\n        //render to graph canvas\n        ctx.save();\n        ctx.drawImage(this._video, 0, 0, this.size[0], this.size[1]);\n        ctx.restore();\n    };\n\n    ImageWebcam.prototype.onGetOutputs = function() {\n        return [\n            [\"width\", \"number\"],\n            [\"height\", \"number\"],\n            [\"stream_ready\", LiteGraph.EVENT],\n            [\"stream_closed\", LiteGraph.EVENT],\n            [\"stream_error\", LiteGraph.EVENT]\n        ];\n    };\n\n    LiteGraph.registerNodeType(\"graphics/webcam\", ImageWebcam);\n})(this);\n\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\tvar LGraphCanvas = global.LGraphCanvas;\n\n    //Works with Litegl.js to create WebGL nodes\n    global.LGraphTexture = null;\n\n    if (typeof GL == \"undefined\")\n\t\treturn;\n\n\tLGraphCanvas.link_type_colors[\"Texture\"] = \"#987\";\n\n\tfunction LGraphTexture() {\n\t\tthis.addOutput(\"tex\", \"Texture\");\n\t\tthis.addOutput(\"name\", \"string\");\n\t\tthis.properties = { name: \"\", filter: true };\n\t\tthis.size = [\n\t\t\tLGraphTexture.image_preview_size,\n\t\t\tLGraphTexture.image_preview_size\n\t\t];\n\t}\n\n\tglobal.LGraphTexture = LGraphTexture;\n\n\tLGraphTexture.title = \"Texture\";\n\tLGraphTexture.desc = \"Texture\";\n\tLGraphTexture.widgets_info = {\n\t\tname: { widget: \"texture\" },\n\t\tfilter: { widget: \"checkbox\" }\n\t};\n\n\t//REPLACE THIS TO INTEGRATE WITH YOUR FRAMEWORK\n\tLGraphTexture.loadTextureCallback = null; //function in charge of loading textures when not present in the container\n\tLGraphTexture.image_preview_size = 256;\n\n\t//flags to choose output texture type\n\tLGraphTexture.UNDEFINED = 0; //not specified\n\tLGraphTexture.PASS_THROUGH = 1; //do not apply FX (like disable but passing the in to the out)\n\tLGraphTexture.COPY = 2; //create new texture with the same properties as the origin texture\n\tLGraphTexture.LOW = 3; //create new texture with low precision (byte)\n\tLGraphTexture.HIGH = 4; //create new texture with high precision (half-float)\n\tLGraphTexture.REUSE = 5; //reuse input texture\n\tLGraphTexture.DEFAULT = 2; //use the default\n\n\tLGraphTexture.MODE_VALUES = {\n\t\t\"undefined\": LGraphTexture.UNDEFINED,\n\t\t\"pass through\": LGraphTexture.PASS_THROUGH,\n\t\tcopy: LGraphTexture.COPY,\n\t\tlow: LGraphTexture.LOW,\n\t\thigh: LGraphTexture.HIGH,\n\t\treuse: LGraphTexture.REUSE,\n\t\tdefault: LGraphTexture.DEFAULT\n\t};\n\n\t//returns the container where all the loaded textures are stored (overwrite if you have a Resources Manager)\n\tLGraphTexture.getTexturesContainer = function() {\n\t\treturn gl.textures;\n\t};\n\n\t//process the loading of a texture (overwrite it if you have a Resources Manager)\n\tLGraphTexture.loadTexture = function(name, options) {\n\t\toptions = options || {};\n\t\tvar url = name;\n\t\tif (url.substr(0, 7) == \"http://\") {\n\t\t\tif (LiteGraph.proxy) {\n\t\t\t\t//proxy external files\n\t\t\t\turl = LiteGraph.proxy + url.substr(7);\n\t\t\t}\n\t\t}\n\n\t\tvar container = LGraphTexture.getTexturesContainer();\n\t\tvar tex = (container[name] = GL.Texture.fromURL(url, options));\n\t\treturn tex;\n\t};\n\n\tLGraphTexture.getTexture = function(name) {\n\t\tvar container = this.getTexturesContainer();\n\n\t\tif (!container) {\n\t\t\tthrow \"Cannot load texture, container of textures not found\";\n\t\t}\n\n\t\tvar tex = container[name];\n\t\tif (!tex && name && name[0] != \":\") {\n\t\t\treturn this.loadTexture(name);\n\t\t}\n\n\t\treturn tex;\n\t};\n\n\t//used to compute the appropiate output texture\n\tLGraphTexture.getTargetTexture = function(origin, target, mode) {\n\t\tif (!origin) {\n\t\t\tthrow \"LGraphTexture.getTargetTexture expects a reference texture\";\n\t\t}\n\n\t\tvar tex_type = null;\n\n\t\tswitch (mode) {\n\t\t\tcase LGraphTexture.LOW:\n\t\t\t\ttex_type = gl.UNSIGNED_BYTE;\n\t\t\t\tbreak;\n\t\t\tcase LGraphTexture.HIGH:\n\t\t\t\ttex_type = gl.HIGH_PRECISION_FORMAT;\n\t\t\t\tbreak;\n\t\t\tcase LGraphTexture.REUSE:\n\t\t\t\treturn origin;\n\t\t\t\tbreak;\n\t\t\tcase LGraphTexture.COPY:\n\t\t\tdefault:\n\t\t\t\ttex_type = origin ? origin.type : gl.UNSIGNED_BYTE;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (\n\t\t\t!target ||\n\t\t\ttarget.width != origin.width ||\n\t\t\ttarget.height != origin.height ||\n\t\t\ttarget.type != tex_type ||\n\t\t\ttarget.format != origin.format \n\t\t) {\n\t\t\ttarget = new GL.Texture(origin.width, origin.height, {\n\t\t\t\ttype: tex_type,\n\t\t\t\tformat: origin.format,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\n\t\treturn target;\n\t};\n\n\tLGraphTexture.getTextureType = function(precision, ref_texture) {\n\t\tvar type = ref_texture ? ref_texture.type : gl.UNSIGNED_BYTE;\n\t\tswitch (precision) {\n\t\t\tcase LGraphTexture.HIGH:\n\t\t\t\ttype = gl.HIGH_PRECISION_FORMAT;\n\t\t\t\tbreak;\n\t\t\tcase LGraphTexture.LOW:\n\t\t\t\ttype = gl.UNSIGNED_BYTE;\n\t\t\t\tbreak;\n\t\t\t//no default\n\t\t}\n\t\treturn type;\n\t};\n\n\tLGraphTexture.getWhiteTexture = function() {\n\t\tif (this._white_texture) {\n\t\t\treturn this._white_texture;\n\t\t}\n\t\tvar texture = (this._white_texture = GL.Texture.fromMemory(\n\t\t\t1,\n\t\t\t1,\n\t\t\t[255, 255, 255, 255],\n\t\t\t{ format: gl.RGBA, wrap: gl.REPEAT, filter: gl.NEAREST }\n\t\t));\n\t\treturn texture;\n\t};\n\n\tLGraphTexture.getNoiseTexture = function() {\n\t\tif (this._noise_texture) {\n\t\t\treturn this._noise_texture;\n\t\t}\n\n\t\tvar noise = new Uint8Array(512 * 512 * 4);\n\t\tfor (var i = 0; i < 512 * 512 * 4; ++i) {\n\t\t\tnoise[i] = Math.random() * 255;\n\t\t}\n\n\t\tvar texture = GL.Texture.fromMemory(512, 512, noise, {\n\t\t\tformat: gl.RGBA,\n\t\t\twrap: gl.REPEAT,\n\t\t\tfilter: gl.NEAREST\n\t\t});\n\t\tthis._noise_texture = texture;\n\t\treturn texture;\n\t};\n\n\tLGraphTexture.prototype.onDropFile = function(data, filename, file) {\n\t\tif (!data) {\n\t\t\tthis._drop_texture = null;\n\t\t\tthis.properties.name = \"\";\n\t\t} else {\n\t\t\tvar texture = null;\n\t\t\tif (typeof data == \"string\") {\n\t\t\t\ttexture = GL.Texture.fromURL(data);\n\t\t\t} else if (filename.toLowerCase().indexOf(\".dds\") != -1) {\n\t\t\t\ttexture = GL.Texture.fromDDSInMemory(data);\n\t\t\t} else {\n\t\t\t\tvar blob = new Blob([file]);\n\t\t\t\tvar url = URL.createObjectURL(blob);\n\t\t\t\ttexture = GL.Texture.fromURL(url);\n\t\t\t}\n\n\t\t\tthis._drop_texture = texture;\n\t\t\tthis.properties.name = filename;\n\t\t}\n\t};\n\n\tLGraphTexture.prototype.getExtraMenuOptions = function(graphcanvas) {\n\t\tvar that = this;\n\t\tif (!this._drop_texture) {\n\t\t\treturn;\n\t\t}\n\t\treturn [\n\t\t\t{\n\t\t\t\tcontent: \"Clear\",\n\t\t\t\tcallback: function() {\n\t\t\t\t\tthat._drop_texture = null;\n\t\t\t\t\tthat.properties.name = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t};\n\n\tLGraphTexture.prototype.onExecute = function() {\n\t\tvar tex = null;\n\t\tif (this.isOutputConnected(1)) {\n\t\t\ttex = this.getInputData(0);\n\t\t}\n\n\t\tif (!tex && this._drop_texture) {\n\t\t\ttex = this._drop_texture;\n\t\t}\n\n\t\tif (!tex && this.properties.name) {\n\t\t\ttex = LGraphTexture.getTexture(this.properties.name);\n\t\t}\n\n\t\tif (!tex) {\n\t\t\tthis.setOutputData( 0, null );\n\t\t\tthis.setOutputData( 1, \"\" );\n\t\t\treturn;\n\t\t}\n\n\t\tthis._last_tex = tex;\n\n\t\tif (this.properties.filter === false) {\n\t\t\ttex.setParameter(gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\t\t} else {\n\t\t\ttex.setParameter(gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\t\t}\n\n\t\tthis.setOutputData( 0, tex );\n\t\tthis.setOutputData( 1, tex.fullpath || tex.filename );\n\n\t\tfor (var i = 2; i < this.outputs.length; i++) {\n\t\t\tvar output = this.outputs[i];\n\t\t\tif (!output) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar v = null;\n\t\t\tif (output.name == \"width\") {\n\t\t\t\tv = tex.width;\n\t\t\t} else if (output.name == \"height\") {\n\t\t\t\tv = tex.height;\n\t\t\t} else if (output.name == \"aspect\") {\n\t\t\t\tv = tex.width / tex.height;\n\t\t\t}\n\t\t\tthis.setOutputData(i, v);\n\t\t}\n\t};\n\n\tLGraphTexture.prototype.onResourceRenamed = function(\n\t\told_name,\n\t\tnew_name\n\t) {\n\t\tif (this.properties.name == old_name) {\n\t\t\tthis.properties.name = new_name;\n\t\t}\n\t};\n\n\tLGraphTexture.prototype.onDrawBackground = function(ctx) {\n\t\tif (this.flags.collapsed || this.size[1] <= 20) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._drop_texture && ctx.webgl) {\n\t\t\tctx.drawImage(\n\t\t\t\tthis._drop_texture,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tthis.size[0],\n\t\t\t\tthis.size[1]\n\t\t\t);\n\t\t\t//this._drop_texture.renderQuad(this.pos[0],this.pos[1],this.size[0],this.size[1]);\n\t\t\treturn;\n\t\t}\n\n\t\t//Different texture? then get it from the GPU\n\t\tif (this._last_preview_tex != this._last_tex) {\n\t\t\tif (ctx.webgl) {\n\t\t\t\tthis._canvas = this._last_tex;\n\t\t\t} else {\n\t\t\t\tvar tex_canvas = LGraphTexture.generateLowResTexturePreview(\n\t\t\t\t\tthis._last_tex\n\t\t\t\t);\n\t\t\t\tif (!tex_canvas) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._last_preview_tex = this._last_tex;\n\t\t\t\tthis._canvas = cloneCanvas(tex_canvas);\n\t\t\t}\n\t\t}\n\n\t\tif (!this._canvas) {\n\t\t\treturn;\n\t\t}\n\n\t\t//render to graph canvas\n\t\tctx.save();\n\t\tif (!ctx.webgl) {\n\t\t\t//reverse image\n\t\t\tctx.translate(0, this.size[1]);\n\t\t\tctx.scale(1, -1);\n\t\t}\n\t\tctx.drawImage(this._canvas, 0, 0, this.size[0], this.size[1]);\n\t\tctx.restore();\n\t};\n\n\t//very slow, used at your own risk\n\tLGraphTexture.generateLowResTexturePreview = function(tex) {\n\t\tif (!tex) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar size = LGraphTexture.image_preview_size;\n\t\tvar temp_tex = tex;\n\n\t\tif (tex.format == gl.DEPTH_COMPONENT) {\n\t\t\treturn null;\n\t\t} //cannot generate from depth\n\n\t\t//Generate low-level version in the GPU to speed up\n\t\tif (tex.width > size || tex.height > size) {\n\t\t\ttemp_tex = this._preview_temp_tex;\n\t\t\tif (!this._preview_temp_tex) {\n\t\t\t\ttemp_tex = new GL.Texture(size, size, {\n\t\t\t\t\tminFilter: gl.NEAREST\n\t\t\t\t});\n\t\t\t\tthis._preview_temp_tex = temp_tex;\n\t\t\t}\n\n\t\t\t//copy\n\t\t\ttex.copyTo(temp_tex);\n\t\t\ttex = temp_tex;\n\t\t}\n\n\t\t//create intermediate canvas with lowquality version\n\t\tvar tex_canvas = this._preview_canvas;\n\t\tif (!tex_canvas) {\n\t\t\ttex_canvas = createCanvas(size, size);\n\t\t\tthis._preview_canvas = tex_canvas;\n\t\t}\n\n\t\tif (temp_tex) {\n\t\t\ttemp_tex.toCanvas(tex_canvas);\n\t\t}\n\t\treturn tex_canvas;\n\t};\n\n\tLGraphTexture.prototype.getResources = function(res) {\n\t\tif(this.properties.name)\n\t\t\tres[this.properties.name] = GL.Texture;\n\t\treturn res;\n\t};\n\n\tLGraphTexture.prototype.onGetInputs = function() {\n\t\treturn [[\"in\", \"Texture\"]];\n\t};\n\n\tLGraphTexture.prototype.onGetOutputs = function() {\n\t\treturn [\n\t\t\t[\"width\", \"number\"],\n\t\t\t[\"height\", \"number\"],\n\t\t\t[\"aspect\", \"number\"]\n\t\t];\n\t};\n\n\t//used to replace shader code\n\tLGraphTexture.replaceCode = function( code, context )\n\t{\n\t\treturn code.replace(/\\{\\{[a-zA-Z0-9_]*\\}\\}/g, function(v){\n\t\t\tv = v.replace( /[\\{\\}]/g, \"\" );\n\t\t\treturn context[v] || \"\";\n\t\t});\n\t}\n\n\tLiteGraph.registerNodeType(\"texture/texture\", LGraphTexture);\n\n\t//**************************\n\tfunction LGraphTexturePreview() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.properties = { flipY: false };\n\t\tthis.size = [\n\t\t\tLGraphTexture.image_preview_size,\n\t\t\tLGraphTexture.image_preview_size\n\t\t];\n\t}\n\n\tLGraphTexturePreview.title = \"Preview\";\n\tLGraphTexturePreview.desc = \"Show a texture in the graph canvas\";\n\tLGraphTexturePreview.allow_preview = false;\n\n\tLGraphTexturePreview.prototype.onDrawBackground = function(ctx) {\n\t\tif (this.flags.collapsed) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!ctx.webgl && !LGraphTexturePreview.allow_preview) {\n\t\t\treturn;\n\t\t} //not working well\n\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar tex_canvas = null;\n\n\t\tif (!tex.handle && ctx.webgl) {\n\t\t\ttex_canvas = tex;\n\t\t} else {\n\t\t\ttex_canvas = LGraphTexture.generateLowResTexturePreview(tex);\n\t\t}\n\n\t\t//render to graph canvas\n\t\tctx.save();\n\t\tif (this.properties.flipY) {\n\t\t\tctx.translate(0, this.size[1]);\n\t\t\tctx.scale(1, -1);\n\t\t}\n\t\tctx.drawImage(tex_canvas, 0, 0, this.size[0], this.size[1]);\n\t\tctx.restore();\n\t};\n\n\tLiteGraph.registerNodeType(\"texture/preview\", LGraphTexturePreview);\n\n\t//**************************************\n\n\tfunction LGraphTextureSave() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addOutput(\"tex\", \"Texture\");\n\t\tthis.addOutput(\"name\", \"string\");\n\t\tthis.properties = { name: \"\", generate_mipmaps: false };\n\t}\n\n\tLGraphTextureSave.title = \"Save\";\n\tLGraphTextureSave.desc = \"Save a texture in the repository\";\n\n\tLGraphTextureSave.prototype.getPreviewTexture = function()\n\t{\n\t\treturn this._texture;\n\t}\n\n\tLGraphTextureSave.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.properties.generate_mipmaps) {\n\t\t\ttex.bind(0);\n\t\t\ttex.setParameter( gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR );\n\t\t\tgl.generateMipmap(tex.texture_type);\n\t\t\ttex.unbind(0);\n\t\t}\n\n\t\tif (this.properties.name) {\n\t\t\t//for cases where we want to perform something when storing it\n\t\t\tif (LGraphTexture.storeTexture) {\n\t\t\t\tLGraphTexture.storeTexture(this.properties.name, tex);\n\t\t\t} else {\n\t\t\t\tvar container = LGraphTexture.getTexturesContainer();\n\t\t\t\tcontainer[this.properties.name] = tex;\n\t\t\t}\n\t\t}\n\n\t\tthis._texture = tex;\n\t\tthis.setOutputData(0, tex);\n\t\tthis.setOutputData(1, this.properties.name);\n\t};\n\n\tLiteGraph.registerNodeType(\"texture/save\", LGraphTextureSave);\n\n\t//****************************************************\n\n\tfunction LGraphTextureOperation() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addInput(\"TextureB\", \"Texture\");\n\t\tthis.addInput(\"value\", \"number\");\n\t\tthis.addOutput(\"Texture\", \"Texture\");\n\t\tthis.help = \"<p>pixelcode must be vec3, uvcode must be vec2, is optional</p>\\\n\t\t<p><strong>uv:</strong> tex. coords</p><p><strong>color:</strong> texture <strong>colorB:</strong> textureB</p><p><strong>time:</strong> scene time <strong>value:</strong> input value</p><p>For multiline you must type: result = ...</p>\";\n\n\t\tthis.properties = {\n\t\t\tvalue: 1,\n\t\t\tpixelcode: \"color + colorB * value\",\n\t\t\tuvcode: \"\",\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\n\t\tthis.has_error = false;\n\t}\n\n\tLGraphTextureOperation.widgets_info = {\n\t\tuvcode: { widget: \"code\" },\n\t\tpixelcode: { widget: \"code\" },\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureOperation.title = \"Operation\";\n\tLGraphTextureOperation.desc = \"Texture shader operation\";\n\n\tLGraphTextureOperation.presets = {};\n\n\tLGraphTextureOperation.prototype.getExtraMenuOptions = function(\n\t\tgraphcanvas\n\t) {\n\t\tvar that = this;\n\t\tvar txt = !that.properties.show ? \"Show Texture\" : \"Hide Texture\";\n\t\treturn [\n\t\t\t{\n\t\t\t\tcontent: txt,\n\t\t\t\tcallback: function() {\n\t\t\t\t\tthat.properties.show = !that.properties.show;\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t};\n\n\tLGraphTextureOperation.prototype.onPropertyChanged = function()\n\t{\n\t\tthis.has_error = false;\n\t}\n\n\tLGraphTextureOperation.prototype.onDrawBackground = function(ctx) {\n\t\tif (\n\t\t\tthis.flags.collapsed ||\n\t\t\tthis.size[1] <= 20 ||\n\t\t\t!this.properties.show\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._tex) {\n\t\t\treturn;\n\t\t}\n\n\t\t//only works if using a webgl renderer\n\t\tif (this._tex.gl != ctx) {\n\t\t\treturn;\n\t\t}\n\n\t\t//render to graph canvas\n\t\tctx.save();\n\t\tctx.drawImage(this._tex, 0, 0, this.size[0], this.size[1]);\n\t\tctx.restore();\n\t};\n\n\tLGraphTextureOperation.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tif (this.properties.precision === LGraphTexture.PASS_THROUGH) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tvar texB = this.getInputData(1);\n\n\t\tif (!this.properties.uvcode && !this.properties.pixelcode) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar width = 512;\n\t\tvar height = 512;\n\t\tif (tex) {\n\t\t\twidth = tex.width;\n\t\t\theight = tex.height;\n\t\t} else if (texB) {\n\t\t\twidth = texB.width;\n\t\t\theight = texB.height;\n\t\t}\n\n\t\tif(!texB)\n\t\t\ttexB = GL.Texture.getWhiteTexture();\n\n\t\tvar type = LGraphTexture.getTextureType( this.properties.precision, tex );\n\n\t\tif (!tex && !this._tex) {\n\t\t\tthis._tex = new GL.Texture(width, height, { type: type, format: gl.RGBA, filter: gl.LINEAR });\n\t\t} else {\n\t\t\tthis._tex = LGraphTexture.getTargetTexture( tex || this._tex, this._tex, this.properties.precision );\n\t\t}\n\n\t\tvar uvcode = \"\";\n\t\tif (this.properties.uvcode) {\n\t\t\tuvcode = \"uv = \" + this.properties.uvcode;\n\t\t\tif (this.properties.uvcode.indexOf(\";\") != -1) {\n\t\t\t\t//there are line breaks, means multiline code\n\t\t\t\tuvcode = this.properties.uvcode;\n\t\t\t}\n\t\t}\n\n\t\tvar pixelcode = \"\";\n\t\tif (this.properties.pixelcode) {\n\t\t\tpixelcode = \"result = \" + this.properties.pixelcode;\n\t\t\tif (this.properties.pixelcode.indexOf(\";\") != -1) {\n\t\t\t\t//there are line breaks, means multiline code\n\t\t\t\tpixelcode = this.properties.pixelcode;\n\t\t\t}\n\t\t}\n\n\t\tvar shader = this._shader;\n\n\t\tif ( !this.has_error && (!shader || this._shader_code != uvcode + \"|\" + pixelcode) ) {\n\n\t\t\tvar final_pixel_code = LGraphTexture.replaceCode( LGraphTextureOperation.pixel_shader, { UV_CODE:uvcode, PIXEL_CODE:pixelcode });\n\n\t\t\ttry {\n\t\t\t\tshader = new GL.Shader( Shader.SCREEN_VERTEX_SHADER, final_pixel_code );\n\t\t\t\tthis.boxcolor = \"#00FF00\";\n\t\t\t} catch (err) {\n\t\t\t\t//console.log(\"Error compiling shader: \", err, final_pixel_code );\n\t\t\t\tGL.Shader.dumpErrorToConsole(err,Shader.SCREEN_VERTEX_SHADER, final_pixel_code);\n\t\t\t\tthis.boxcolor = \"#FF0000\";\n\t\t\t\tthis.has_error = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._shader = shader;\n\t\t\tthis._shader_code = uvcode + \"|\" + pixelcode;\n\t\t}\n\n\t\tif(!this._shader)\n\t\t\treturn;\n\n\t\tvar value = this.getInputData(2);\n\t\tif (value != null) {\n\t\t\tthis.properties.value = value;\n\t\t} else {\n\t\t\tvalue = parseFloat(this.properties.value);\n\t\t}\n\n\t\tvar time = this.graph.getTime();\n\n\t\tthis._tex.drawTo(function() {\n\t\t\tgl.disable(gl.DEPTH_TEST);\n\t\t\tgl.disable(gl.CULL_FACE);\n\t\t\tgl.disable(gl.BLEND);\n\t\t\tif (tex) {\n\t\t\t\ttex.bind(0);\n\t\t\t}\n\t\t\tif (texB) {\n\t\t\t\ttexB.bind(1);\n\t\t\t}\n\t\t\tvar mesh = Mesh.getScreenQuad();\n\t\t\tshader\n\t\t\t\t.uniforms({\n\t\t\t\t\tu_texture: 0,\n\t\t\t\t\tu_textureB: 1,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\ttexSize: [width, height,1/width,1/height],\n\t\t\t\t\ttime: time\n\t\t\t\t})\n\t\t\t\t.draw(mesh);\n\t\t});\n\n\t\tthis.setOutputData(0, this._tex);\n\t};\n\n\tLGraphTextureOperation.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\t\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform sampler2D u_textureB;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform vec4 texSize;\\n\\\n\t\tuniform float time;\\n\\\n\t\tuniform float value;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec2 uv = v_coord;\\n\\\n\t\t\t{{UV_CODE}};\\n\\\n\t\t\tvec4 color4 = texture2D(u_texture, uv);\\n\\\n\t\t\tvec3 color = color4.rgb;\\n\\\n\t\t\tvec4 color4B = texture2D(u_textureB, uv);\\n\\\n\t\t\tvec3 colorB = color4B.rgb;\\n\\\n\t\t\tvec3 result = color;\\n\\\n\t\t\tfloat alpha = 1.0;\\n\\\n\t\t\t{{PIXEL_CODE}};\\n\\\n\t\t\tgl_FragColor = vec4(result, alpha);\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLGraphTextureOperation.registerPreset = function ( name, code )\n\t{\n\t\tLGraphTextureOperation.presets[name] = code;\n\t}\n\n\tLGraphTextureOperation.registerPreset(\"\",\"\");\n\tLGraphTextureOperation.registerPreset(\"bypass\",\"color\");\n\tLGraphTextureOperation.registerPreset(\"add\",\"color + colorB * value\");\n\tLGraphTextureOperation.registerPreset(\"substract\",\"(color - colorB) * value\");\n\tLGraphTextureOperation.registerPreset(\"mate\",\"mix( color, colorB, color4B.a * value)\");\n\tLGraphTextureOperation.registerPreset(\"invert\",\"vec3(1.0) - color\");\n\tLGraphTextureOperation.registerPreset(\"multiply\",\"color * colorB * value\");\n\tLGraphTextureOperation.registerPreset(\"divide\",\"(color / colorB) / value\");\n\tLGraphTextureOperation.registerPreset(\"difference\",\"abs(color - colorB) * value\");\n\tLGraphTextureOperation.registerPreset(\"max\",\"max(color, colorB) * value\");\n\tLGraphTextureOperation.registerPreset(\"min\",\"min(color, colorB) * value\");\n\tLGraphTextureOperation.registerPreset(\"displace\",\"texture2D(u_texture, uv + (colorB.xy - vec2(0.5)) * value).xyz\");\n\tLGraphTextureOperation.registerPreset(\"grayscale\",\"vec3(color.x + color.y + color.z) * value / 3.0\");\n\tLGraphTextureOperation.registerPreset(\"saturation\",\"mix( vec3(color.x + color.y + color.z) / 3.0, color, value )\");\n\tLGraphTextureOperation.registerPreset(\"normalmap\",\"\\n\\\n\t\tfloat z0 = texture2D(u_texture, uv + vec2(-texSize.z, -texSize.w) ).x;\\n\\\n\t\tfloat z1 = texture2D(u_texture, uv + vec2(0.0, -texSize.w) ).x;\\n\\\n\t\tfloat z2 = texture2D(u_texture, uv + vec2(texSize.z, -texSize.w) ).x;\\n\\\n\t\tfloat z3 = texture2D(u_texture, uv + vec2(-texSize.z, 0.0) ).x;\\n\\\n\t\tfloat z4 = color.x;\\n\\\n\t\tfloat z5 = texture2D(u_texture, uv + vec2(texSize.z, 0.0) ).x;\\n\\\n\t\tfloat z6 = texture2D(u_texture, uv + vec2(-texSize.z, texSize.w) ).x;\\n\\\n\t\tfloat z7 = texture2D(u_texture, uv + vec2(0.0, texSize.w) ).x;\\n\\\n\t\tfloat z8 = texture2D(u_texture, uv + vec2(texSize.z, texSize.w) ).x;\\n\\\n\t\tvec3 normal = vec3( z2 + 2.0*z4 + z7 - z0 - 2.0*z3 - z5, z5 + 2.0*z6 + z7 -z0 - 2.0*z1 - z2, 1.0 );\\n\\\n\t\tnormal.xy *= value;\\n\\\n\t\tresult.xyz = normalize(normal) * 0.5 + vec3(0.5);\\n\\\n\t\");\n\tLGraphTextureOperation.registerPreset(\"threshold\",\"vec3(color.x > colorB.x * value ? 1.0 : 0.0,color.y > colorB.y * value ? 1.0 : 0.0,color.z > colorB.z * value ? 1.0 : 0.0)\");\n\n\t//webglstudio stuff...\n\tLGraphTextureOperation.prototype.onInspect = function(widgets)\n\t{\n\t\tvar that = this;\n\t\twidgets.addCombo(\"Presets\",\"\",{ values: Object.keys(LGraphTextureOperation.presets), callback: function(v){\n\t\t\tvar code = LGraphTextureOperation.presets[v];\n\t\t\tif(!code)\n\t\t\t\treturn;\n\t\t\tthat.setProperty(\"pixelcode\",code);\n\t\t\tthat.title = v;\n\t\t\twidgets.refresh();\n\t\t}});\n\t}\n\n\tLiteGraph.registerNodeType(\"texture/operation\", LGraphTextureOperation);\n\n\t//****************************************************\n\n\tfunction LGraphTextureShader() {\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tcode: \"\",\n\t\t\tu_value: 1,\n\t\t\tu_color: [1,1,1,1],\n\t\t\twidth: 512,\n\t\t\theight: 512,\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\n\t\tthis.properties.code = LGraphTextureShader.pixel_shader;\n\t\tthis._uniforms = { u_value: 1, u_color: vec4.create(), in_texture: 0, texSize: vec4.create(), time: 0 };\n\t}\n\n\tLGraphTextureShader.title = \"Shader\";\n\tLGraphTextureShader.desc = \"Texture shader\";\n\tLGraphTextureShader.widgets_info = {\n\t\tcode: { type: \"code\", lang: \"glsl\" },\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureShader.prototype.onPropertyChanged = function(\n\t\tname,\n\t\tvalue\n\t) {\n\t\tif (name != \"code\") {\n\t\t\treturn;\n\t\t}\n\n\t\tvar shader = this.getShader();\n\t\tif (!shader) {\n\t\t\treturn;\n\t\t}\n\n\t\t//update connections\n\t\tvar uniforms = shader.uniformInfo;\n\n\t\t//remove deprecated slots\n\t\tif (this.inputs) {\n\t\t\tvar already = {};\n\t\t\tfor (var i = 0; i < this.inputs.length; ++i) {\n\t\t\t\tvar info = this.getInputInfo(i);\n\t\t\t\tif (!info) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (uniforms[info.name] && !already[info.name]) {\n\t\t\t\t\talready[info.name] = true;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tthis.removeInput(i);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\n\t\t//update existing ones\n\t\tfor (var i in uniforms) {\n\t\t\tvar info = shader.uniformInfo[i];\n\t\t\tif (info.loc === null) {\n\t\t\t\tcontinue;\n\t\t\t} //is an attribute, not a uniform\n\t\t\tif (i == \"time\") {\n\t\t\t\t//default one\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar type = \"number\";\n\t\t\tif (this._shader.samplers[i]) {\n\t\t\t\ttype = \"texture\";\n\t\t\t} else {\n\t\t\t\tswitch (info.size) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\ttype = \"number\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\ttype = \"vec2\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\ttype = \"vec3\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\ttype = \"vec4\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 9:\n\t\t\t\t\t\ttype = \"mat3\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 16:\n\t\t\t\t\t\ttype = \"mat4\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar slot = this.findInputSlot(i);\n\t\t\tif (slot == -1) {\n\t\t\t\tthis.addInput(i, type);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar input_info = this.getInputInfo(slot);\n\t\t\tif (!input_info) {\n\t\t\t\tthis.addInput(i, type);\n\t\t\t} else {\n\t\t\t\tif (input_info.type == type) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tthis.removeInput(slot, type);\n\t\t\t\tthis.addInput(i, type);\n\t\t\t}\n\t\t}\n\t};\n\n\tLGraphTextureShader.prototype.getShader = function() {\n\t\t//replug\n\t\tif (this._shader && this._shader_code == this.properties.code) {\n\t\t\treturn this._shader;\n\t\t}\n\n\t\tthis._shader_code = this.properties.code;\n\t\tthis._shader = new GL.Shader( Shader.SCREEN_VERTEX_SHADER, this.properties.code );\n\t\tif (!this._shader) {\n\t\t\tthis.boxcolor = \"red\";\n\t\t\treturn null;\n\t\t} else {\n\t\t\tthis.boxcolor = \"green\";\n\t\t}\n\t\treturn this._shader;\n\t};\n\n\tLGraphTextureShader.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar shader = this.getShader();\n\t\tif (!shader) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar tex_slot = 0;\n\t\tvar in_tex = null;\n\n\t\t//set uniforms\n\t\tif(this.inputs)\n\t\tfor (var i = 0; i < this.inputs.length; ++i) {\n\t\t\tvar info = this.getInputInfo(i);\n\t\t\tvar data = this.getInputData(i);\n\t\t\tif (data == null) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (data.constructor === GL.Texture) {\n\t\t\t\tdata.bind(tex_slot);\n\t\t\t\tif (!in_tex) {\n\t\t\t\t\tin_tex = data;\n\t\t\t\t}\n\t\t\t\tdata = tex_slot;\n\t\t\t\ttex_slot++;\n\t\t\t}\n\t\t\tshader.setUniform(info.name, data); //data is tex_slot\n\t\t}\n\n\t\tvar uniforms = this._uniforms;\n\t\tvar type = LGraphTexture.getTextureType( this.properties.precision, in_tex );\n\n\t\t//render to texture\n\t\tvar w = this.properties.width | 0;\n\t\tvar h = this.properties.height | 0;\n\t\tif (w == 0) {\n\t\t\tw = in_tex ? in_tex.width : gl.canvas.width;\n\t\t}\n\t\tif (h == 0) {\n\t\t\th = in_tex ? in_tex.height : gl.canvas.height;\n\t\t}\n\t\tuniforms.texSize[0] = w;\n\t\tuniforms.texSize[1] = h;\n\t\tuniforms.texSize[2] = 1/w;\n\t\tuniforms.texSize[3] = 1/h;\n\t\tuniforms.time = this.graph.getTime();\n\t\tuniforms.u_value = this.properties.u_value;\n\t\tuniforms.u_color.set( this.properties.u_color );\n\n\t\tif ( !this._tex || this._tex.type != type ||  this._tex.width != w || this._tex.height != h ) {\n\t\t\tthis._tex = new GL.Texture(w, h, {  type: type, format: gl.RGBA, filter: gl.LINEAR });\n\t\t}\n\t\tvar tex = this._tex;\n\t\ttex.drawTo(function() {\n\t\t\tshader.uniforms(uniforms).draw(GL.Mesh.getScreenQuad());\n\t\t});\n\n\t\tthis.setOutputData(0, this._tex);\n\t};\n\n\tLGraphTextureShader.pixel_shader =\n\"precision highp float;\\n\\\n\\n\\\nvarying vec2 v_coord;\\n\\\nuniform float time; //time in seconds\\n\\\nuniform vec4 texSize; //tex resolution\\n\\\nuniform float u_value;\\n\\\nuniform vec4 u_color;\\n\\n\\\nvoid main() {\\n\\\n\tvec2 uv = v_coord;\\n\\\n\tvec3 color = vec3(0.0);\\n\\\n\t//your code here\\n\\\n\tcolor.xy=uv;\\n\\n\\\n\tgl_FragColor = vec4(color, 1.0);\\n\\\n}\\n\\\n\";\n\n\tLiteGraph.registerNodeType(\"texture/shader\", LGraphTextureShader);\n\n\t// Texture Scale Offset\n\n\tfunction LGraphTextureScaleOffset() {\n\t\tthis.addInput(\"in\", \"Texture\");\n\t\tthis.addInput(\"scale\", \"vec2\");\n\t\tthis.addInput(\"offset\", \"vec2\");\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.properties = {\n\t\t\toffset: vec2.fromValues(0, 0),\n\t\t\tscale: vec2.fromValues(1, 1),\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\t}\n\n\tLGraphTextureScaleOffset.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureScaleOffset.title = \"Scale/Offset\";\n\tLGraphTextureScaleOffset.desc = \"Applies an scaling and offseting\";\n\n\tLGraphTextureScaleOffset.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\n\t\tif (!this.isOutputConnected(0) || !tex) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tif (this.properties.precision === LGraphTexture.PASS_THROUGH) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tvar width = tex.width;\n\t\tvar height = tex.height;\n\t\tvar type =  this.precision === LGraphTexture.LOW ? gl.UNSIGNED_BYTE : gl.HIGH_PRECISION_FORMAT;\n\t\tif (this.precision === LGraphTexture.DEFAULT) {\n\t\t\ttype = tex.type;\n\t\t}\n\n\t\tif (\n\t\t\t!this._tex ||\n\t\t\tthis._tex.width != width ||\n\t\t\tthis._tex.height != height ||\n\t\t\tthis._tex.type != type\n\t\t) {\n\t\t\tthis._tex = new GL.Texture(width, height, {\n\t\t\t\ttype: type,\n\t\t\t\tformat: gl.RGBA,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\n\t\tvar shader = this._shader;\n\n\t\tif (!shader) {\n\t\t\tshader = new GL.Shader(\n\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureScaleOffset.pixel_shader\n\t\t\t);\n\t\t}\n\n\t\tvar scale = this.getInputData(1);\n\t\tif (scale) {\n\t\t\tthis.properties.scale[0] = scale[0];\n\t\t\tthis.properties.scale[1] = scale[1];\n\t\t} else {\n\t\t\tscale = this.properties.scale;\n\t\t}\n\n\t\tvar offset = this.getInputData(2);\n\t\tif (offset) {\n\t\t\tthis.properties.offset[0] = offset[0];\n\t\t\tthis.properties.offset[1] = offset[1];\n\t\t} else {\n\t\t\toffset = this.properties.offset;\n\t\t}\n\n\t\tthis._tex.drawTo(function() {\n\t\t\tgl.disable(gl.DEPTH_TEST);\n\t\t\tgl.disable(gl.CULL_FACE);\n\t\t\tgl.disable(gl.BLEND);\n\t\t\ttex.bind(0);\n\t\t\tvar mesh = Mesh.getScreenQuad();\n\t\t\tshader\n\t\t\t\t.uniforms({\n\t\t\t\t\tu_texture: 0,\n\t\t\t\t\tu_scale: scale,\n\t\t\t\t\tu_offset: offset\n\t\t\t\t})\n\t\t\t\t.draw(mesh);\n\t\t});\n\n\t\tthis.setOutputData(0, this._tex);\n\t};\n\n\tLGraphTextureScaleOffset.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\t\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform sampler2D u_textureB;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform vec2 u_scale;\\n\\\n\t\tuniform vec2 u_offset;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec2 uv = v_coord;\\n\\\n\t\t\tuv = uv / u_scale - u_offset;\\n\\\n\t\t\tgl_FragColor = texture2D(u_texture, uv);\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\n\t\t\"texture/scaleOffset\",\n\t\tLGraphTextureScaleOffset\n\t);\n\n\t// Warp (distort a texture) *************************\n\n\tfunction LGraphTextureWarp() {\n\t\tthis.addInput(\"in\", \"Texture\");\n\t\tthis.addInput(\"warp\", \"Texture\");\n\t\tthis.addInput(\"factor\", \"number\");\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tfactor: 0.01,\n\t\t\tscale: [1,1],\n\t\t\toffset: [0,0],\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\n\t\tthis._uniforms = { \n\t\t\tu_texture: 0, \n\t\t\tu_textureB: 1, \n\t\t\tu_factor: 1, \n\t\t\tu_scale: vec2.create(),\n\t\t\tu_offset: vec2.create()\n\t\t};\n\t}\n\n\tLGraphTextureWarp.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureWarp.title = \"Warp\";\n\tLGraphTextureWarp.desc = \"Texture warp operation\";\n\n\tLGraphTextureWarp.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tif (this.properties.precision === LGraphTexture.PASS_THROUGH) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tvar texB = this.getInputData(1);\n\n\t\tvar width = 512;\n\t\tvar height = 512;\n\t\tvar type = gl.UNSIGNED_BYTE;\n\t\tif (tex) {\n\t\t\twidth = tex.width;\n\t\t\theight = tex.height;\n\t\t\ttype = tex.type;\n\t\t} else if (texB) {\n\t\t\twidth = texB.width;\n\t\t\theight = texB.height;\n\t\t\ttype = texB.type;\n\t\t}\n\n\t\tif (!tex && !this._tex) {\n\t\t\tthis._tex = new GL.Texture(width, height, {\n\t\t\t\ttype:\n\t\t\t\t\tthis.precision === LGraphTexture.LOW\n\t\t\t\t\t\t? gl.UNSIGNED_BYTE\n\t\t\t\t\t\t: gl.HIGH_PRECISION_FORMAT,\n\t\t\t\tformat: gl.RGBA,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t} else {\n\t\t\tthis._tex = LGraphTexture.getTargetTexture(\n\t\t\t\ttex || this._tex,\n\t\t\t\tthis._tex,\n\t\t\t\tthis.properties.precision\n\t\t\t);\n\t\t}\n\n\t\tvar shader = this._shader;\n\n\t\tif (!shader) {\n\t\t\tshader = new GL.Shader(\n\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureWarp.pixel_shader\n\t\t\t);\n\t\t}\n\n\t\tvar factor = this.getInputData(2);\n\t\tif (factor != null) {\n\t\t\tthis.properties.factor = factor;\n\t\t} else {\n\t\t\tfactor = parseFloat(this.properties.factor);\n\t\t}\n\t\tvar uniforms = this._uniforms;\n\t\tuniforms.u_factor = factor;\n\t\tuniforms.u_scale.set( this.properties.scale );\n\t\tuniforms.u_offset.set( this.properties.offset );\n\n\t\tthis._tex.drawTo(function() {\n\t\t\tgl.disable(gl.DEPTH_TEST);\n\t\t\tgl.disable(gl.CULL_FACE);\n\t\t\tgl.disable(gl.BLEND);\n\t\t\tif (tex) {\n\t\t\t\ttex.bind(0);\n\t\t\t}\n\t\t\tif (texB) {\n\t\t\t\ttexB.bind(1);\n\t\t\t}\n\t\t\tvar mesh = Mesh.getScreenQuad();\n\t\t\tshader\n\t\t\t\t.uniforms( uniforms )\n\t\t\t\t.draw(mesh);\n\t\t});\n\n\t\tthis.setOutputData(0, this._tex);\n\t};\n\n\tLGraphTextureWarp.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\t\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform sampler2D u_textureB;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform float u_factor;\\n\\\n\t\tuniform vec2 u_scale;\\n\\\n\t\tuniform vec2 u_offset;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec2 uv = v_coord;\\n\\\n\t\t\tuv += ( texture2D(u_textureB, uv).rg - vec2(0.5)) * u_factor * u_scale + u_offset;\\n\\\n\t\t\tgl_FragColor = texture2D(u_texture, uv);\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\"texture/warp\", LGraphTextureWarp);\n\n\t//****************************************************\n\n\t// Texture to Viewport *****************************************\n\tfunction LGraphTextureToViewport() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tadditive: false,\n\t\t\tantialiasing: false,\n\t\t\tfilter: true,\n\t\t\tdisable_alpha: false,\n\t\t\tgamma: 1.0,\n\t\t\tviewport: [0,0,1,1]\n\t\t};\n\t\tthis.size[0] = 130;\n\t}\n\n\tLGraphTextureToViewport.title = \"to Viewport\";\n\tLGraphTextureToViewport.desc = \"Texture to viewport\";\n\n\tLGraphTextureToViewport._prev_viewport = new Float32Array(4);\n\n\tLGraphTextureToViewport.prototype.onDrawBackground = function( ctx )\n\t{\n\t\tif ( this.flags.collapsed || this.size[1] <= 40 )\n\t\t\treturn;\n\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tctx.drawImage( ctx == gl ? tex : gl.canvas, 10,30, this.size[0] -20, this.size[1] -40);\n\t}\n\n\tLGraphTextureToViewport.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.properties.disable_alpha) {\n\t\t\tgl.disable(gl.BLEND);\n\t\t} else {\n\t\t\tgl.enable(gl.BLEND);\n\t\t\tif (this.properties.additive) {\n\t\t\t\tgl.blendFunc(gl.SRC_ALPHA, gl.ONE);\n\t\t\t} else {\n\t\t\t\tgl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\t\t\t}\n\t\t}\n\n\t\tgl.disable(gl.DEPTH_TEST);\n\t\tvar gamma = this.properties.gamma || 1.0;\n\t\tif (this.isInputConnected(1)) {\n\t\t\tgamma = this.getInputData(1);\n\t\t}\n\n\t\ttex.setParameter(\n\t\t\tgl.TEXTURE_MAG_FILTER,\n\t\t\tthis.properties.filter ? gl.LINEAR : gl.NEAREST\n\t\t);\n\n\t\tvar old_viewport = LGraphTextureToViewport._prev_viewport;\n\t\told_viewport.set( gl.viewport_data );\n\t\tvar new_view = this.properties.viewport;\n\t\tgl.viewport( old_viewport[0] + old_viewport[2] * new_view[0], old_viewport[1] + old_viewport[3] * new_view[1], old_viewport[2] * new_view[2], old_viewport[3] * new_view[3] );\n\t\tvar viewport = gl.getViewport(); //gl.getParameter(gl.VIEWPORT);\n\n\t\tif (this.properties.antialiasing) {\n\t\t\tif (!LGraphTextureToViewport._shader) {\n\t\t\t\tLGraphTextureToViewport._shader = new GL.Shader(\n\t\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\t\tLGraphTextureToViewport.aa_pixel_shader\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tvar mesh = Mesh.getScreenQuad();\n\t\t\ttex.bind(0);\n\t\t\tLGraphTextureToViewport._shader\n\t\t\t\t.uniforms({\n\t\t\t\t\tu_texture: 0,\n\t\t\t\t\tuViewportSize: [tex.width, tex.height],\n\t\t\t\t\tu_igamma: 1 / gamma,\n\t\t\t\t\tinverseVP: [1 / tex.width, 1 / tex.height]\n\t\t\t\t})\n\t\t\t\t.draw(mesh);\n\t\t} else {\n\t\t\tif (gamma != 1.0) {\n\t\t\t\tif (!LGraphTextureToViewport._gamma_shader) {\n\t\t\t\t\tLGraphTextureToViewport._gamma_shader = new GL.Shader(\n\t\t\t\t\t\tShader.SCREEN_VERTEX_SHADER,\n\t\t\t\t\t\tLGraphTextureToViewport.gamma_pixel_shader\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\ttex.toViewport(LGraphTextureToViewport._gamma_shader, {\n\t\t\t\t\tu_texture: 0,\n\t\t\t\t\tu_igamma: 1 / gamma\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\ttex.toViewport();\n\t\t\t}\n\t\t}\n\n\t\tgl.viewport( old_viewport[0], old_viewport[1], old_viewport[2], old_viewport[3] );\n\t};\n\n\tLGraphTextureToViewport.prototype.onGetInputs = function() {\n\t\treturn [[\"gamma\", \"number\"]];\n\t};\n\n\tLGraphTextureToViewport.aa_pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform vec2 uViewportSize;\\n\\\n\t\tuniform vec2 inverseVP;\\n\\\n\t\tuniform float u_igamma;\\n\\\n\t\t#define FXAA_REDUCE_MIN   (1.0/ 128.0)\\n\\\n\t\t#define FXAA_REDUCE_MUL   (1.0 / 8.0)\\n\\\n\t\t#define FXAA_SPAN_MAX     8.0\\n\\\n\t\t\\n\\\n\t\t/* from mitsuhiko/webgl-meincraft based on the code on geeks3d.com */\\n\\\n\t\tvec4 applyFXAA(sampler2D tex, vec2 fragCoord)\\n\\\n\t\t{\\n\\\n\t\t\tvec4 color = vec4(0.0);\\n\\\n\t\t\t/*vec2 inverseVP = vec2(1.0 / uViewportSize.x, 1.0 / uViewportSize.y);*/\\n\\\n\t\t\tvec3 rgbNW = texture2D(tex, (fragCoord + vec2(-1.0, -1.0)) * inverseVP).xyz;\\n\\\n\t\t\tvec3 rgbNE = texture2D(tex, (fragCoord + vec2(1.0, -1.0)) * inverseVP).xyz;\\n\\\n\t\t\tvec3 rgbSW = texture2D(tex, (fragCoord + vec2(-1.0, 1.0)) * inverseVP).xyz;\\n\\\n\t\t\tvec3 rgbSE = texture2D(tex, (fragCoord + vec2(1.0, 1.0)) * inverseVP).xyz;\\n\\\n\t\t\tvec3 rgbM  = texture2D(tex, fragCoord  * inverseVP).xyz;\\n\\\n\t\t\tvec3 luma = vec3(0.299, 0.587, 0.114);\\n\\\n\t\t\tfloat lumaNW = dot(rgbNW, luma);\\n\\\n\t\t\tfloat lumaNE = dot(rgbNE, luma);\\n\\\n\t\t\tfloat lumaSW = dot(rgbSW, luma);\\n\\\n\t\t\tfloat lumaSE = dot(rgbSE, luma);\\n\\\n\t\t\tfloat lumaM  = dot(rgbM,  luma);\\n\\\n\t\t\tfloat lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\\n\\\n\t\t\tfloat lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\\n\\\n\t\t\t\\n\\\n\t\t\tvec2 dir;\\n\\\n\t\t\tdir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\\n\\\n\t\t\tdir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\\n\\\n\t\t\t\\n\\\n\t\t\tfloat dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\\n\\\n\t\t\t\\n\\\n\t\t\tfloat rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\\n\\\n\t\t\tdir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX), max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)) * inverseVP;\\n\\\n\t\t\t\\n\\\n\t\t\tvec3 rgbA = 0.5 * (texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz + \\n\\\n\t\t\t\ttexture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\\n\\\n\t\t\tvec3 rgbB = rgbA * 0.5 + 0.25 * (texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz + \\n\\\n\t\t\t\ttexture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\\n\\\n\t\t\t\\n\\\n\t\t\t//return vec4(rgbA,1.0);\\n\\\n\t\t\tfloat lumaB = dot(rgbB, luma);\\n\\\n\t\t\tif ((lumaB < lumaMin) || (lumaB > lumaMax))\\n\\\n\t\t\t\tcolor = vec4(rgbA, 1.0);\\n\\\n\t\t\telse\\n\\\n\t\t\t\tcolor = vec4(rgbB, 1.0);\\n\\\n\t\t\tif(u_igamma != 1.0)\\n\\\n\t\t\t\tcolor.xyz = pow( color.xyz, vec3(u_igamma) );\\n\\\n\t\t\treturn color;\\n\\\n\t\t}\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t   gl_FragColor = applyFXAA( u_texture, v_coord * uViewportSize) ;\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLGraphTextureToViewport.gamma_pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform float u_igamma;\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec4 color = texture2D( u_texture, v_coord);\\n\\\n\t\t\tcolor.xyz = pow(color.xyz, vec3(u_igamma) );\\n\\\n\t\t   gl_FragColor = color;\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\n\t\t\"texture/toviewport\",\n\t\tLGraphTextureToViewport\n\t);\n\n\t// Texture Copy *****************************************\n\tfunction LGraphTextureCopy() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addOutput(\"\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tsize: 0,\n\t\t\tgenerate_mipmaps: false,\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\t}\n\n\tLGraphTextureCopy.title = \"Copy\";\n\tLGraphTextureCopy.desc = \"Copy Texture\";\n\tLGraphTextureCopy.widgets_info = {\n\t\tsize: {\n\t\t\twidget: \"combo\",\n\t\t\tvalues: [0, 32, 64, 128, 256, 512, 1024, 2048]\n\t\t},\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureCopy.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex && !this._temp_texture) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\t//copy the texture\n\t\tif (tex) {\n\t\t\tvar width = tex.width;\n\t\t\tvar height = tex.height;\n\n\t\t\tif (this.properties.size != 0) {\n\t\t\t\twidth = this.properties.size;\n\t\t\t\theight = this.properties.size;\n\t\t\t}\n\n\t\t\tvar temp = this._temp_texture;\n\n\t\t\tvar type = tex.type;\n\t\t\tif (this.properties.precision === LGraphTexture.LOW) {\n\t\t\t\ttype = gl.UNSIGNED_BYTE;\n\t\t\t} else if (this.properties.precision === LGraphTexture.HIGH) {\n\t\t\t\ttype = gl.HIGH_PRECISION_FORMAT;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!temp ||\n\t\t\t\ttemp.width != width ||\n\t\t\t\ttemp.height != height ||\n\t\t\t\ttemp.type != type\n\t\t\t) {\n\t\t\t\tvar minFilter = gl.LINEAR;\n\t\t\t\tif (\n\t\t\t\t\tthis.properties.generate_mipmaps &&\n\t\t\t\t\tisPowerOfTwo(width) &&\n\t\t\t\t\tisPowerOfTwo(height)\n\t\t\t\t) {\n\t\t\t\t\tminFilter = gl.LINEAR_MIPMAP_LINEAR;\n\t\t\t\t}\n\t\t\t\tthis._temp_texture = new GL.Texture(width, height, {\n\t\t\t\t\ttype: type,\n\t\t\t\t\tformat: gl.RGBA,\n\t\t\t\t\tminFilter: minFilter,\n\t\t\t\t\tmagFilter: gl.LINEAR\n\t\t\t\t});\n\t\t\t}\n\t\t\ttex.copyTo(this._temp_texture);\n\n\t\t\tif (this.properties.generate_mipmaps) {\n\t\t\t\tthis._temp_texture.bind(0);\n\t\t\t\tgl.generateMipmap(this._temp_texture.texture_type);\n\t\t\t\tthis._temp_texture.unbind(0);\n\t\t\t}\n\t\t}\n\n\t\tthis.setOutputData(0, this._temp_texture);\n\t};\n\n\tLiteGraph.registerNodeType(\"texture/copy\", LGraphTextureCopy);\n\n\t// Texture Downsample *****************************************\n\tfunction LGraphTextureDownsample() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addOutput(\"\", \"Texture\");\n\t\tthis.properties = {\n\t\t\titerations: 1,\n\t\t\tgenerate_mipmaps: false,\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\t}\n\n\tLGraphTextureDownsample.title = \"Downsample\";\n\tLGraphTextureDownsample.desc = \"Downsample Texture\";\n\tLGraphTextureDownsample.widgets_info = {\n\t\titerations: { type: \"number\", step: 1, precision: 0, min: 0 },\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureDownsample.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex && !this._temp_texture) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\t//we do not allow any texture different than texture 2D\n\t\tif (!tex || tex.texture_type !== GL.TEXTURE_2D) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.properties.iterations < 1) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tvar shader = LGraphTextureDownsample._shader;\n\t\tif (!shader) {\n\t\t\tLGraphTextureDownsample._shader = shader = new GL.Shader(\n\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureDownsample.pixel_shader\n\t\t\t);\n\t\t}\n\n\t\tvar width = tex.width | 0;\n\t\tvar height = tex.height | 0;\n\t\tvar type = tex.type;\n\t\tif (this.properties.precision === LGraphTexture.LOW) {\n\t\t\ttype = gl.UNSIGNED_BYTE;\n\t\t} else if (this.properties.precision === LGraphTexture.HIGH) {\n\t\t\ttype = gl.HIGH_PRECISION_FORMAT;\n\t\t}\n\t\tvar iterations = this.properties.iterations || 1;\n\n\t\tvar origin = tex;\n\t\tvar target = null;\n\n\t\tvar temp = [];\n\t\tvar options = {\n\t\t\ttype: type,\n\t\t\tformat: tex.format\n\t\t};\n\n\t\tvar offset = vec2.create();\n\t\tvar uniforms = {\n\t\t\tu_offset: offset\n\t\t};\n\n\t\tif (this._texture) {\n\t\t\tGL.Texture.releaseTemporary(this._texture);\n\t\t}\n\n\t\tfor (var i = 0; i < iterations; ++i) {\n\t\t\toffset[0] = 1 / width;\n\t\t\toffset[1] = 1 / height;\n\t\t\twidth = width >> 1 || 0;\n\t\t\theight = height >> 1 || 0;\n\t\t\ttarget = GL.Texture.getTemporary(width, height, options);\n\t\t\ttemp.push(target);\n\t\t\torigin.setParameter(GL.TEXTURE_MAG_FILTER, GL.NEAREST);\n\t\t\torigin.copyTo(target, shader, uniforms);\n\t\t\tif (width == 1 && height == 1) {\n\t\t\t\tbreak;\n\t\t\t} //nothing else to do\n\t\t\torigin = target;\n\t\t}\n\n\t\t//keep the last texture used\n\t\tthis._texture = temp.pop();\n\n\t\t//free the rest\n\t\tfor (var i = 0; i < temp.length; ++i) {\n\t\t\tGL.Texture.releaseTemporary(temp[i]);\n\t\t}\n\n\t\tif (this.properties.generate_mipmaps) {\n\t\t\tthis._texture.bind(0);\n\t\t\tgl.generateMipmap(this._texture.texture_type);\n\t\t\tthis._texture.unbind(0);\n\t\t}\n\n\t\tthis.setOutputData(0, this._texture);\n\t};\n\n\tLGraphTextureDownsample.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform vec2 u_offset;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec4 color = texture2D(u_texture, v_coord );\\n\\\n\t\t\tcolor += texture2D(u_texture, v_coord + vec2( u_offset.x, 0.0 ) );\\n\\\n\t\t\tcolor += texture2D(u_texture, v_coord + vec2( 0.0, u_offset.y ) );\\n\\\n\t\t\tcolor += texture2D(u_texture, v_coord + vec2( u_offset.x, u_offset.y ) );\\n\\\n\t\t   gl_FragColor = color * 0.25;\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\n\t\t\"texture/downsample\",\n\t\tLGraphTextureDownsample\n\t);\n\n\n\n\tfunction LGraphTextureResize() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addOutput(\"\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tsize: [512,512],\n\t\t\tgenerate_mipmaps: false,\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\t}\n\n\tLGraphTextureResize.title = \"Resize\";\n\tLGraphTextureResize.desc = \"Resize Texture\";\n\tLGraphTextureResize.widgets_info = {\n\t\titerations: { type: \"number\", step: 1, precision: 0, min: 0 },\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureResize.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex && !this._temp_texture) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\t//we do not allow any texture different than texture 2D\n\t\tif (!tex || tex.texture_type !== GL.TEXTURE_2D) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar width = this.properties.size[0] | 0;\n\t\tvar height = this.properties.size[1] | 0;\n\t\tif(width == 0)\n\t\t\twidth = tex.width;\n\t\tif(height == 0)\n\t\t\theight = tex.height;\n\t\tvar type = tex.type;\n\t\tif (this.properties.precision === LGraphTexture.LOW) {\n\t\t\ttype = gl.UNSIGNED_BYTE;\n\t\t} else if (this.properties.precision === LGraphTexture.HIGH) {\n\t\t\ttype = gl.HIGH_PRECISION_FORMAT;\n\t\t}\n\n\t\tif( !this._texture || this._texture.width != width || this._texture.height != height || this._texture.type != type )\n\t\t\tthis._texture = new GL.Texture( width, height, { type: type } );\n\n\t\ttex.copyTo( this._texture );\n\n\t\tif (this.properties.generate_mipmaps) {\n\t\t\tthis._texture.bind(0);\n\t\t\tgl.generateMipmap(this._texture.texture_type);\n\t\t\tthis._texture.unbind(0);\n\t\t}\n\n\t\tthis.setOutputData(0, this._texture);\n\t};\n\n\tLiteGraph.registerNodeType( \"texture/resize\", LGraphTextureResize );\n\n\t// Texture Average  *****************************************\n\tfunction LGraphTextureAverage() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addOutput(\"tex\", \"Texture\");\n\t\tthis.addOutput(\"avg\", \"vec4\");\n\t\tthis.addOutput(\"lum\", \"number\");\n\t\tthis.properties = {\n\t\t\tuse_previous_frame: true, //to avoid stalls \n\t\t\thigh_quality: false //to use as much pixels as possible\n\t\t};\n\n\t\tthis._uniforms = {\n\t\t\tu_texture: 0,\n\t\t\tu_mipmap_offset: 0\n\t\t};\n\t\tthis._luminance = new Float32Array(4);\n\t}\n\n\tLGraphTextureAverage.title = \"Average\";\n\tLGraphTextureAverage.desc =\n\t\t\"Compute a partial average (32 random samples) of a texture and stores it as a 1x1 pixel texture.\\n If high_quality is true, then it generates the mipmaps first and reads from the lower one.\";\n\n\tLGraphTextureAverage.prototype.onExecute = function() {\n\t\tif (!this.properties.use_previous_frame) {\n\t\t\tthis.updateAverage();\n\t\t}\n\n\t\tvar v = this._luminance;\n\t\tthis.setOutputData(0, this._temp_texture);\n\t\tthis.setOutputData(1, v);\n\t\tthis.setOutputData(2, (v[0] + v[1] + v[2]) / 3);\n\t};\n\n\t//executed before rendering the frame\n\tLGraphTextureAverage.prototype.onPreRenderExecute = function() {\n\t\tthis.updateAverage();\n\t};\n\n\tLGraphTextureAverage.prototype.updateAverage = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t!this.isOutputConnected(0) &&\n\t\t\t!this.isOutputConnected(1) &&\n\t\t\t!this.isOutputConnected(2)\n\t\t) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tif (!LGraphTextureAverage._shader) {\n\t\t\tLGraphTextureAverage._shader = new GL.Shader(\n\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureAverage.pixel_shader\n\t\t\t);\n\t\t\t//creates 256 random numbers and stores them in two mat4\n\t\t\tvar samples = new Float32Array(16);\n\t\t\tfor (var i = 0; i < samples.length; ++i) {\n\t\t\t\tsamples[i] = Math.random(); //poorly distributed samples\n\t\t\t}\n\t\t\t//upload only once\n\t\t\tLGraphTextureAverage._shader.uniforms({\n\t\t\t\tu_samples_a: samples.subarray(0, 16),\n\t\t\t\tu_samples_b: samples.subarray(16, 32)\n\t\t\t});\n\t\t}\n\n\t\tvar temp = this._temp_texture;\n\t\tvar type = gl.UNSIGNED_BYTE;\n\t\tif (tex.type != type) {\n\t\t\t//force floats, half floats cannot be read with gl.readPixels\n\t\t\ttype = gl.FLOAT;\n\t\t}\n\n\t\tif (!temp || temp.type != type) {\n\t\t\tthis._temp_texture = new GL.Texture(1, 1, {\n\t\t\t\ttype: type,\n\t\t\t\tformat: gl.RGBA,\n\t\t\t\tfilter: gl.NEAREST\n\t\t\t});\n\t\t}\n\n\t\tthis._uniforms.u_mipmap_offset = 0;\n\n\t\tif(this.properties.high_quality)\n\t\t{\n\t\t\tif( !this._temp_pot2_texture || this._temp_pot2_texture.type != type )\n\t\t\t\tthis._temp_pot2_texture = new GL.Texture(512, 512, {\n\t\t\t\t\ttype: type,\n\t\t\t\t\tformat: gl.RGBA,\n\t\t\t\t\tminFilter: gl.LINEAR_MIPMAP_LINEAR,\n\t\t\t\t\tmagFilter: gl.LINEAR\n\t\t\t\t});\n\n\t\t\ttex.copyTo( this._temp_pot2_texture );\n\t\t\ttex = this._temp_pot2_texture;\n\t\t\ttex.bind(0);\n\t\t\tgl.generateMipmap(GL.TEXTURE_2D);\n\t\t\tthis._uniforms.u_mipmap_offset = 9;\n\t\t}\n\n\t\tvar shader = LGraphTextureAverage._shader;\n\t\tvar uniforms = this._uniforms;\n\t\tuniforms.u_mipmap_offset = this.properties.mipmap_offset;\n\t\tgl.disable(gl.DEPTH_TEST);\n\t\tgl.disable(gl.BLEND);\n\t\tthis._temp_texture.drawTo(function() {\n\t\t\ttex.toViewport(shader, uniforms);\n\t\t});\n\n\t\tif (this.isOutputConnected(1) || this.isOutputConnected(2)) {\n\t\t\tvar pixel = this._temp_texture.getPixels();\n\t\t\tif (pixel) {\n\t\t\t\tvar v = this._luminance;\n\t\t\t\tvar type = this._temp_texture.type;\n\t\t\t\tv.set(pixel);\n\t\t\t\tif (type == gl.UNSIGNED_BYTE) {\n\t\t\t\t\tvec4.scale(v, v, 1 / 255);\n\t\t\t\t} else if (\n\t\t\t\t\ttype == GL.HALF_FLOAT ||\n\t\t\t\t\ttype == GL.HALF_FLOAT_OES\n\t\t\t\t) {\n\t\t\t\t\t//no half floats possible, hard to read back unless copyed to a FLOAT texture, so temp_texture is always forced to FLOAT\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tLGraphTextureAverage.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tuniform mat4 u_samples_a;\\n\\\n\t\tuniform mat4 u_samples_b;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform float u_mipmap_offset;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec4 color = vec4(0.0);\\n\\\n\t\t\t//random average\\n\\\n\t\t\tfor(int i = 0; i < 4; ++i)\\n\\\n\t\t\t\tfor(int j = 0; j < 4; ++j)\\n\\\n\t\t\t\t{\\n\\\n\t\t\t\t\tcolor += texture2D(u_texture, vec2( u_samples_a[i][j], u_samples_b[i][j] ), u_mipmap_offset );\\n\\\n\t\t\t\t\tcolor += texture2D(u_texture, vec2( 1.0 - u_samples_a[i][j], 1.0 - u_samples_b[i][j] ), u_mipmap_offset );\\n\\\n\t\t\t\t}\\n\\\n\t\t   gl_FragColor = color * 0.03125;\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\"texture/average\", LGraphTextureAverage);\n\n\n\n\t// Computes operation between pixels (max, min)  *****************************************\n\tfunction LGraphTextureMinMax() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addOutput(\"min_t\", \"Texture\");\n\t\tthis.addOutput(\"max_t\", \"Texture\");\n\t\tthis.addOutput(\"min\", \"vec4\");\n\t\tthis.addOutput(\"max\", \"vec4\");\n\t\tthis.properties = {\n\t\t\tmode: \"max\",\n\t\t\tuse_previous_frame: true //to avoid stalls \n\t\t};\n\n\t\tthis._uniforms = {\n\t\t\tu_texture: 0\n\t\t};\n\n\t\tthis._max = new Float32Array(4);\n\t\tthis._min = new Float32Array(4);\n\n\t\tthis._textures_chain = [];\n\t}\n\n\tLGraphTextureMinMax.widgets_info = {\n\t\tmode: { widget: \"combo\", values: [\"min\",\"max\",\"avg\"] }\n\t};\n\n\tLGraphTextureMinMax.title = \"MinMax\";\n\tLGraphTextureMinMax.desc = \"Compute the scene min max\";\n\n\tLGraphTextureMinMax.prototype.onExecute = function() {\n\t\tif (!this.properties.use_previous_frame) {\n\t\t\tthis.update();\n\t\t}\n\n\t\tthis.setOutputData(0, this._temp_texture);\n\t\tthis.setOutputData(1, this._luminance);\n\t};\n\n\t//executed before rendering the frame\n\tLGraphTextureMinMax.prototype.onPreRenderExecute = function() {\n\t\tthis.update();\n\t};\n\n\tLGraphTextureMinMax.prototype.update = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.isOutputConnected(0) && !this.isOutputConnected(1) ) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tif (!LGraphTextureMinMax._shader) {\n\t\t\tLGraphTextureMinMax._shader = new GL.Shader( GL.Shader.SCREEN_VERTEX_SHADER, LGraphTextureMinMax.pixel_shader );\n\t\t}\n\n\t\tvar temp = this._temp_texture;\n\t\tvar type = gl.UNSIGNED_BYTE;\n\t\tif (tex.type != type) {\n\t\t\t//force floats, half floats cannot be read with gl.readPixels\n\t\t\ttype = gl.FLOAT;\n\t\t}\n\n\t\tvar size = 512;\n\n\t\tif( !this._textures_chain.length || this._textures_chain[0].type != type )\n\t\t{\n\t\t\tvar index = 0;\n\t\t\twhile(i)\n\t\t\t{\n\t\t\t\tthis._textures_chain[i] = new GL.Texture( size, size, {\n\t\t\t\t\ttype: type,\n\t\t\t\t\tformat: gl.RGBA,\n\t\t\t\t\tfilter: gl.NEAREST\n\t\t\t\t});\n\t\t\t\tsize = size >> 2;\n\t\t\t\ti++;\n\t\t\t\tif(size == 1)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\ttex.copyTo( this._textures_chain[0] );\n\t\tvar prev = this._textures_chain[0];\n\t\tfor(var i = 1; i <= this._textures_chain.length; ++i)\n\t\t{\n\t\t\tvar tex = this._textures_chain[i];\n\n\t\t\tprev = tex;\t\t\t\t\n\t\t}\n\n\t\tvar shader = LGraphTextureMinMax._shader;\n\t\tvar uniforms = this._uniforms;\n\t\tuniforms.u_mipmap_offset = this.properties.mipmap_offset;\n\t\tgl.disable(gl.DEPTH_TEST);\n\t\tgl.disable(gl.BLEND);\n\t\tthis._temp_texture.drawTo(function() {\n\t\t\ttex.toViewport(shader, uniforms);\n\t\t});\n\t};\n\n\tLGraphTextureMinMax.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tuniform mat4 u_samples_a;\\n\\\n\t\tuniform mat4 u_samples_b;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform float u_mipmap_offset;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec4 color = vec4(0.0);\\n\\\n\t\t\t//random average\\n\\\n\t\t\tfor(int i = 0; i < 4; ++i)\\n\\\n\t\t\t\tfor(int j = 0; j < 4; ++j)\\n\\\n\t\t\t\t{\\n\\\n\t\t\t\t\tcolor += texture2D(u_texture, vec2( u_samples_a[i][j], u_samples_b[i][j] ), u_mipmap_offset );\\n\\\n\t\t\t\t\tcolor += texture2D(u_texture, vec2( 1.0 - u_samples_a[i][j], 1.0 - u_samples_b[i][j] ), u_mipmap_offset );\\n\\\n\t\t\t\t}\\n\\\n\t\t   gl_FragColor = color * 0.03125;\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\t//LiteGraph.registerNodeType(\"texture/clustered_operation\", LGraphTextureClusteredOperation);\n\n\n\tfunction LGraphTextureTemporalSmooth() {\n\t\tthis.addInput(\"in\", \"Texture\");\n\t\tthis.addInput(\"factor\", \"Number\");\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.properties = { factor: 0.5 };\n\t\tthis._uniforms = {\n\t\t\tu_texture: 0,\n\t\t\tu_textureB: 1,\n\t\t\tu_factor: this.properties.factor\n\t\t};\n\t}\n\n\tLGraphTextureTemporalSmooth.title = \"Smooth\";\n\tLGraphTextureTemporalSmooth.desc = \"Smooth texture over time\";\n\n\tLGraphTextureTemporalSmooth.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex || !this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!LGraphTextureTemporalSmooth._shader) {\n\t\t\tLGraphTextureTemporalSmooth._shader = new GL.Shader(\n\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureTemporalSmooth.pixel_shader\n\t\t\t);\n\t\t}\n\n\t\tvar temp = this._temp_texture;\n\t\tif (\n\t\t\t!temp ||\n\t\t\ttemp.type != tex.type ||\n\t\t\ttemp.width != tex.width ||\n\t\t\ttemp.height != tex.height\n\t\t) {\n\t\t\tvar options = {\n\t\t\t\ttype: tex.type,\n\t\t\t\tformat: gl.RGBA,\n\t\t\t\tfilter: gl.NEAREST\n\t\t\t};\n\t\t\tthis._temp_texture = new GL.Texture(tex.width, tex.height, options );\n\t\t\tthis._temp_texture2 = new GL.Texture(tex.width, tex.height, options );\n\t\t\ttex.copyTo(this._temp_texture2);\n\t\t}\n\n\t\tvar tempA = this._temp_texture;\n\t\tvar tempB = this._temp_texture2;\n\n\t\tvar shader = LGraphTextureTemporalSmooth._shader;\n\t\tvar uniforms = this._uniforms;\n\t\tuniforms.u_factor = 1.0 - this.getInputOrProperty(\"factor\");\n\n\t\tgl.disable(gl.BLEND);\n\t\tgl.disable(gl.DEPTH_TEST);\n\t\ttempA.drawTo(function() {\n\t\t\ttempB.bind(1);\n\t\t\ttex.toViewport(shader, uniforms);\n\t\t});\n\n\t\tthis.setOutputData(0, tempA);\n\n\t\t//swap\n\t\tthis._temp_texture = tempB;\n\t\tthis._temp_texture2 = tempA;\n\t};\n\n\tLGraphTextureTemporalSmooth.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform sampler2D u_textureB;\\n\\\n\t\tuniform float u_factor;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tgl_FragColor = mix( texture2D( u_texture, v_coord ), texture2D( u_textureB, v_coord ), u_factor );\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType( \"texture/temporal_smooth\", LGraphTextureTemporalSmooth );\n\n\n\tfunction LGraphTextureLinearAvgSmooth() {\n\t\tthis.addInput(\"in\", \"Texture\");\n\t\tthis.addOutput(\"avg\", \"Texture\");\n\t\tthis.addOutput(\"array\", \"Texture\");\n\t\tthis.properties = { samples: 64, frames_interval: 1 };\n\t\tthis._uniforms = {\n\t\t\tu_texture: 0,\n\t\t\tu_textureB: 1,\n\t\t\tu_samples: this.properties.samples,\n\t\t\tu_isamples: 1/this.properties.samples\n\t\t};\n\t\tthis.frame = 0;\n\t}\n\n\tLGraphTextureLinearAvgSmooth.title = \"Lineal Avg Smooth\";\n\tLGraphTextureLinearAvgSmooth.desc = \"Smooth texture linearly over time\";\n\n\tLGraphTextureLinearAvgSmooth[\"@samples\"] = { type: \"number\", min: 1, max: 64, step: 1, precision: 1 };\n\n\tLGraphTextureLinearAvgSmooth.prototype.getPreviewTexture = function()\n\t{\n\t\treturn this._temp_texture2;\n\t}\n\n\tLGraphTextureLinearAvgSmooth.prototype.onExecute = function() {\n\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex || !this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!LGraphTextureLinearAvgSmooth._shader) {\n\t\t\tLGraphTextureLinearAvgSmooth._shader_copy = new GL.Shader( GL.Shader.SCREEN_VERTEX_SHADER, LGraphTextureLinearAvgSmooth.pixel_shader_copy );\n\t\t\tLGraphTextureLinearAvgSmooth._shader_avg = new GL.Shader( GL.Shader.SCREEN_VERTEX_SHADER, LGraphTextureLinearAvgSmooth.pixel_shader_avg );\n\t\t}\n\n\t\tvar samples = Math.clamp(this.properties.samples,0,64);\n\t\tvar frame = this.frame;\n\t\tvar interval = this.properties.frames_interval;\n\n\t\tif( interval == 0 || frame % interval == 0 )\n\t\t{\n\t\t\tvar temp = this._temp_texture;\n\t\t\tif ( !temp || temp.type != tex.type || temp.width != samples ) {\n\t\t\t\tvar options = {\n\t\t\t\t\ttype: tex.type,\n\t\t\t\t\tformat: gl.RGBA,\n\t\t\t\t\tfilter: gl.NEAREST\n\t\t\t\t};\n\t\t\t\tthis._temp_texture = new GL.Texture( samples, 1, options );\n\t\t\t\tthis._temp_texture2 = new GL.Texture( samples, 1, options );\n\t\t\t\tthis._temp_texture_out = new GL.Texture( 1, 1, options );\n\t\t\t}\n\n\t\t\tvar tempA = this._temp_texture;\n\t\t\tvar tempB = this._temp_texture2;\n\n\t\t\tvar shader_copy = LGraphTextureLinearAvgSmooth._shader_copy;\n\t\t\tvar shader_avg = LGraphTextureLinearAvgSmooth._shader_avg;\n\t\t\tvar uniforms = this._uniforms;\n\t\t\tuniforms.u_samples = samples;\n\t\t\tuniforms.u_isamples = 1.0 / samples;\n\n\t\t\tgl.disable(gl.BLEND);\n\t\t\tgl.disable(gl.DEPTH_TEST);\n\t\t\ttempA.drawTo(function() {\n\t\t\t\ttempB.bind(1);\n\t\t\t\ttex.toViewport( shader_copy, uniforms );\n\t\t\t});\n\n\t\t\tthis._temp_texture_out.drawTo(function() {\n\t\t\t\ttempA.toViewport( shader_avg, uniforms );\n\t\t\t});\n\n\t\t\tthis.setOutputData( 0, this._temp_texture_out );\n\n\t\t\t//swap\n\t\t\tthis._temp_texture = tempB;\n\t\t\tthis._temp_texture2 = tempA;\n\t\t}\n\t\telse\n\t\t\tthis.setOutputData(0, this._temp_texture_out);\n\t\tthis.setOutputData(1, this._temp_texture2);\n\t\tthis.frame++;\n\t};\n\n\tLGraphTextureLinearAvgSmooth.pixel_shader_copy =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform sampler2D u_textureB;\\n\\\n\t\tuniform float u_isamples;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tif( v_coord.x <= u_isamples )\\n\\\n\t\t\t\tgl_FragColor = texture2D( u_texture, vec2(0.5) );\\n\\\n\t\t\telse\\n\\\n\t\t\t\tgl_FragColor = texture2D( u_textureB, v_coord - vec2(u_isamples,0.0) );\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLGraphTextureLinearAvgSmooth.pixel_shader_avg =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform int u_samples;\\n\\\n\t\tuniform float u_isamples;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec4 color = vec4(0.0);\\n\\\n\t\t\tfor(int i = 0; i < 64; ++i)\\n\\\n\t\t\t{\\n\\\n\t\t\t\tcolor += texture2D( u_texture, vec2( float(i)*u_isamples,0.0) );\\n\\\n\t\t\t\tif(i == (u_samples - 1))\\n\\\n\t\t\t\t\tbreak;\\n\\\n\t\t\t}\\n\\\n\t\t\tgl_FragColor = color * u_isamples;\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\n\tLiteGraph.registerNodeType( \"texture/linear_avg_smooth\", LGraphTextureLinearAvgSmooth );\n\n\t// Image To Texture *****************************************\n\tfunction LGraphImageToTexture() {\n\t\tthis.addInput(\"Image\", \"image\");\n\t\tthis.addOutput(\"\", \"Texture\");\n\t\tthis.properties = {};\n\t}\n\n\tLGraphImageToTexture.title = \"Image to Texture\";\n\tLGraphImageToTexture.desc = \"Uploads an image to the GPU\";\n\t//LGraphImageToTexture.widgets_info = { size: { widget:\"combo\", values:[0,32,64,128,256,512,1024,2048]} };\n\n\tLGraphImageToTexture.prototype.onExecute = function() {\n\t\tvar img = this.getInputData(0);\n\t\tif (!img) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar width = img.videoWidth || img.width;\n\t\tvar height = img.videoHeight || img.height;\n\n\t\t//this is in case we are using a webgl canvas already, no need to reupload it\n\t\tif (img.gltexture) {\n\t\t\tthis.setOutputData(0, img.gltexture);\n\t\t\treturn;\n\t\t}\n\n\t\tvar temp = this._temp_texture;\n\t\tif (!temp || temp.width != width || temp.height != height) {\n\t\t\tthis._temp_texture = new GL.Texture(width, height, {\n\t\t\t\tformat: gl.RGBA,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\n\t\ttry {\n\t\t\tthis._temp_texture.uploadImage(img);\n\t\t} catch (err) {\n\t\t\tconsole.error(\n\t\t\t\t\"image comes from an unsafe location, cannot be uploaded to webgl: \" +\n\t\t\t\t\terr\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setOutputData(0, this._temp_texture);\n\t};\n\n\tLiteGraph.registerNodeType(\n\t\t\"texture/imageToTexture\",\n\t\tLGraphImageToTexture\n\t);\n\n\t// Texture LUT *****************************************\n\tfunction LGraphTextureLUT() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addInput(\"LUT\", \"Texture\");\n\t\tthis.addInput(\"Intensity\", \"number\");\n\t\tthis.addOutput(\"\", \"Texture\");\n\t\tthis.properties = { enabled: true, intensity: 1, precision: LGraphTexture.DEFAULT, texture: null };\n\n\t\tif (!LGraphTextureLUT._shader) {\n\t\t\tLGraphTextureLUT._shader = new GL.Shader( Shader.SCREEN_VERTEX_SHADER, LGraphTextureLUT.pixel_shader );\n\t\t}\n\t}\n\n\tLGraphTextureLUT.widgets_info = {\n\t\ttexture: { widget: \"texture\" },\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureLUT.title = \"LUT\";\n\tLGraphTextureLUT.desc = \"Apply LUT to Texture\";\n\n\tLGraphTextureLUT.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar tex = this.getInputData(0);\n\n\t\tif (this.properties.precision === LGraphTexture.PASS_THROUGH || this.properties.enabled === false) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar lut_tex = this.getInputData(1);\n\n\t\tif (!lut_tex) {\n\t\t\tlut_tex = LGraphTexture.getTexture(this.properties.texture);\n\t\t}\n\n\t\tif (!lut_tex) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tlut_tex.bind(0);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\t\tgl.texParameteri(\n\t\t\tgl.TEXTURE_2D,\n\t\t\tgl.TEXTURE_WRAP_S,\n\t\t\tgl.CLAMP_TO_EDGE\n\t\t);\n\t\tgl.texParameteri(\n\t\t\tgl.TEXTURE_2D,\n\t\t\tgl.TEXTURE_WRAP_T,\n\t\t\tgl.CLAMP_TO_EDGE\n\t\t);\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\n\t\tvar intensity = this.properties.intensity;\n\t\tif (this.isInputConnected(2)) {\n\t\t\tthis.properties.intensity = intensity = this.getInputData(2);\n\t\t}\n\n\t\tthis._tex = LGraphTexture.getTargetTexture(\n\t\t\ttex,\n\t\t\tthis._tex,\n\t\t\tthis.properties.precision\n\t\t);\n\n\t\t//var mesh = Mesh.getScreenQuad();\n\n\t\tthis._tex.drawTo(function() {\n\t\t\tlut_tex.bind(1);\n\t\t\ttex.toViewport(LGraphTextureLUT._shader, {\n\t\t\t\tu_texture: 0,\n\t\t\t\tu_textureB: 1,\n\t\t\t\tu_amount: intensity\n\t\t\t});\n\t\t});\n\n\t\tthis.setOutputData(0, this._tex);\n\t};\n\n\tLGraphTextureLUT.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform sampler2D u_textureB;\\n\\\n\t\tuniform float u_amount;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\t lowp vec4 textureColor = clamp( texture2D(u_texture, v_coord), vec4(0.0), vec4(1.0) );\\n\\\n\t\t\t mediump float blueColor = textureColor.b * 63.0;\\n\\\n\t\t\t mediump vec2 quad1;\\n\\\n\t\t\t quad1.y = floor(floor(blueColor) / 8.0);\\n\\\n\t\t\t quad1.x = floor(blueColor) - (quad1.y * 8.0);\\n\\\n\t\t\t mediump vec2 quad2;\\n\\\n\t\t\t quad2.y = floor(ceil(blueColor) / 8.0);\\n\\\n\t\t\t quad2.x = ceil(blueColor) - (quad2.y * 8.0);\\n\\\n\t\t\t highp vec2 texPos1;\\n\\\n\t\t\t texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.r);\\n\\\n\t\t\t texPos1.y = 1.0 - ((quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.g));\\n\\\n\t\t\t highp vec2 texPos2;\\n\\\n\t\t\t texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.r);\\n\\\n\t\t\t texPos2.y = 1.0 - ((quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.g));\\n\\\n\t\t\t lowp vec4 newColor1 = texture2D(u_textureB, texPos1);\\n\\\n\t\t\t lowp vec4 newColor2 = texture2D(u_textureB, texPos2);\\n\\\n\t\t\t lowp vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\\n\\\n\t\t\t gl_FragColor = vec4( mix( textureColor.rgb, newColor.rgb, u_amount), textureColor.w);\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\"texture/LUT\", LGraphTextureLUT);\n\n\n\t// Texture LUT *****************************************\n\tfunction LGraphTextureEncode() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addInput(\"Atlas\", \"Texture\");\n\t\tthis.addOutput(\"\", \"Texture\");\n\t\tthis.properties = { enabled: true, num_row_symbols: 4, symbol_size: 16, brightness: 1, colorize: false, filter: false, invert: false, precision: LGraphTexture.DEFAULT, generate_mipmaps: false, texture: null };\n\n\t\tif (!LGraphTextureEncode._shader) {\n\t\t\tLGraphTextureEncode._shader = new GL.Shader( Shader.SCREEN_VERTEX_SHADER, LGraphTextureEncode.pixel_shader );\n\t\t}\n\n\t\tthis._uniforms = {\n\t\t\t\tu_texture: 0,\n\t\t\t\tu_textureB: 1,\n\t\t\t\tu_row_simbols: 4,\n\t\t\t\tu_simbol_size: 16,\n\t\t\t\tu_res: vec2.create()\n\t\t};\n\t}\n\n\tLGraphTextureEncode.widgets_info = {\n\t\ttexture: { widget: \"texture\" },\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureEncode.title = \"Encode\";\n\tLGraphTextureEncode.desc = \"Apply a texture atlas to encode a texture\";\n\n\tLGraphTextureEncode.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar tex = this.getInputData(0);\n\n\t\tif (this.properties.precision === LGraphTexture.PASS_THROUGH || this.properties.enabled === false) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar symbols_tex = this.getInputData(1);\n\n\t\tif (!symbols_tex) {\n\t\t\tsymbols_tex = LGraphTexture.getTexture(this.properties.texture);\n\t\t}\n\n\t\tif (!symbols_tex) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tsymbols_tex.bind(0);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.properties.filter ? gl.LINEAR : gl.NEAREST );\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.properties.filter ? gl.LINEAR : gl.NEAREST );\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\n\t\tvar uniforms = this._uniforms;\n\t\tuniforms.u_row_simbols = Math.floor(this.properties.num_row_symbols);\n\t\tuniforms.u_symbol_size = this.properties.symbol_size;\n\t\tuniforms.u_brightness = this.properties.brightness;\n\t\tuniforms.u_invert = this.properties.invert ? 1 : 0;\n\t\tuniforms.u_colorize = this.properties.colorize ? 1 : 0;\n\n\t\tthis._tex = LGraphTexture.getTargetTexture( tex, this._tex, this.properties.precision );\n\t\tuniforms.u_res[0] = this._tex.width;\n\t\tuniforms.u_res[1] = this._tex.height;\n\t\tthis._tex.bind(0);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\n\t\tthis._tex.drawTo(function() {\n\t\t\tsymbols_tex.bind(1);\n\t\t\ttex.toViewport(LGraphTextureEncode._shader, uniforms);\n\t\t});\n\n\t\tif (this.properties.generate_mipmaps) {\n\t\t\tthis._tex.bind(0);\n\t\t\tgl.generateMipmap(this._tex.texture_type);\n\t\t\tthis._tex.unbind(0);\n\t\t}\n\n\t\tthis.setOutputData(0, this._tex);\n\t};\n\n\tLGraphTextureEncode.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform sampler2D u_textureB;\\n\\\n\t\tuniform float u_row_simbols;\\n\\\n\t\tuniform float u_symbol_size;\\n\\\n\t\tuniform float u_brightness;\\n\\\n\t\tuniform float u_invert;\\n\\\n\t\tuniform float u_colorize;\\n\\\n\t\tuniform vec2 u_res;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec2 total_symbols = u_res / u_symbol_size;\\n\\\n\t\t\tvec2 uv = floor(v_coord * total_symbols) / total_symbols; //pixelate \\n\\\n\t\t\tvec2 local_uv = mod(v_coord * u_res, u_symbol_size) / u_symbol_size;\\n\\\n\t\t\tlowp vec4 textureColor = texture2D(u_texture, uv );\\n\\\n\t\t\tfloat lum = clamp(u_brightness * (textureColor.x + textureColor.y + textureColor.z)/3.0,0.0,1.0);\\n\\\n\t\t\tif( u_invert == 1.0 ) lum = 1.0 - lum;\\n\\\n\t\t\tfloat index = floor( lum * (u_row_simbols * u_row_simbols - 1.0));\\n\\\n\t\t\tfloat col = mod( index, u_row_simbols );\\n\\\n\t\t\tfloat row = u_row_simbols - floor( index / u_row_simbols ) - 1.0;\\n\\\n\t\t\tvec2 simbol_uv = ( vec2( col, row ) + local_uv ) / u_row_simbols;\\n\\\n\t\t\tvec4 color = texture2D( u_textureB, simbol_uv );\\n\\\n\t\t\tif(u_colorize == 1.0)\\n\\\n\t\t\t\tcolor *= textureColor;\\n\\\n\t\t\tgl_FragColor = color;\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\"texture/encode\", LGraphTextureEncode);\n\n\t// Texture Channels *****************************************\n\tfunction LGraphTextureChannels() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\n\t\tthis.addOutput(\"R\", \"Texture\");\n\t\tthis.addOutput(\"G\", \"Texture\");\n\t\tthis.addOutput(\"B\", \"Texture\");\n\t\tthis.addOutput(\"A\", \"Texture\");\n\n\t\t//this.properties = { use_single_channel: true };\n\t\tif (!LGraphTextureChannels._shader) {\n\t\t\tLGraphTextureChannels._shader = new GL.Shader(\n\t\t\t\tShader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureChannels.pixel_shader\n\t\t\t);\n\t\t}\n\t}\n\n\tLGraphTextureChannels.title = \"Texture to Channels\";\n\tLGraphTextureChannels.desc = \"Split texture channels\";\n\n\tLGraphTextureChannels.prototype.onExecute = function() {\n\t\tvar texA = this.getInputData(0);\n\t\tif (!texA) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._channels) {\n\t\t\tthis._channels = Array(4);\n\t\t}\n\n\t\t//var format = this.properties.use_single_channel ? gl.LUMINANCE : gl.RGBA; //not supported by WebGL1\n\t\tvar format = gl.RGB;\n\t\tvar connections = 0;\n\t\tfor (var i = 0; i < 4; i++) {\n\t\t\tif (this.isOutputConnected(i)) {\n\t\t\t\tif (\n\t\t\t\t\t!this._channels[i] ||\n\t\t\t\t\tthis._channels[i].width != texA.width ||\n\t\t\t\t\tthis._channels[i].height != texA.height ||\n\t\t\t\t\tthis._channels[i].type != texA.type ||\n\t\t\t\t\tthis._channels[i].format != format\n\t\t\t\t) {\n\t\t\t\t\tthis._channels[i] = new GL.Texture(\n\t\t\t\t\t\ttexA.width,\n\t\t\t\t\t\ttexA.height,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: texA.type,\n\t\t\t\t\t\t\tformat: format,\n\t\t\t\t\t\t\tfilter: gl.LINEAR\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tconnections++;\n\t\t\t} else {\n\t\t\t\tthis._channels[i] = null;\n\t\t\t}\n\t\t}\n\n\t\tif (!connections) {\n\t\t\treturn;\n\t\t}\n\n\t\tgl.disable(gl.BLEND);\n\t\tgl.disable(gl.DEPTH_TEST);\n\n\t\tvar mesh = Mesh.getScreenQuad();\n\t\tvar shader = LGraphTextureChannels._shader;\n\t\tvar masks = [\n\t\t\t[1, 0, 0, 0],\n\t\t\t[0, 1, 0, 0],\n\t\t\t[0, 0, 1, 0],\n\t\t\t[0, 0, 0, 1]\n\t\t];\n\n\t\tfor (var i = 0; i < 4; i++) {\n\t\t\tif (!this._channels[i]) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis._channels[i].drawTo(function() {\n\t\t\t\ttexA.bind(0);\n\t\t\t\tshader\n\t\t\t\t\t.uniforms({ u_texture: 0, u_mask: masks[i] })\n\t\t\t\t\t.draw(mesh);\n\t\t\t});\n\t\t\tthis.setOutputData(i, this._channels[i]);\n\t\t}\n\t};\n\n\tLGraphTextureChannels.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform vec4 u_mask;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t   gl_FragColor = vec4( vec3( length( texture2D(u_texture, v_coord) * u_mask )), 1.0 );\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\n\t\t\"texture/textureChannels\",\n\t\tLGraphTextureChannels\n\t);\n\n\t// Texture Channels to Texture *****************************************\n\tfunction LGraphChannelsTexture() {\n\t\tthis.addInput(\"R\", \"Texture\");\n\t\tthis.addInput(\"G\", \"Texture\");\n\t\tthis.addInput(\"B\", \"Texture\");\n\t\tthis.addInput(\"A\", \"Texture\");\n\n\t\tthis.addOutput(\"Texture\", \"Texture\");\n\n\t\tthis.properties = {\n\t\t\tprecision: LGraphTexture.DEFAULT,\n\t\t\tR: 1,\n\t\t\tG: 1,\n\t\t\tB: 1,\n\t\t\tA: 1\n\t\t};\n\t\tthis._color = vec4.create();\n\t\tthis._uniforms = {\n\t\t\tu_textureR: 0,\n\t\t\tu_textureG: 1,\n\t\t\tu_textureB: 2,\n\t\t\tu_textureA: 3,\n\t\t\tu_color: this._color\n\t\t};\n\t}\n\n\tLGraphChannelsTexture.title = \"Channels to Texture\";\n\tLGraphChannelsTexture.desc = \"Split texture channels\";\n\tLGraphChannelsTexture.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphChannelsTexture.prototype.onExecute = function() {\n\t\tvar white = LGraphTexture.getWhiteTexture();\n\t\tvar texR = this.getInputData(0) || white;\n\t\tvar texG = this.getInputData(1) || white;\n\t\tvar texB = this.getInputData(2) || white;\n\t\tvar texA = this.getInputData(3) || white;\n\n\t\tgl.disable(gl.BLEND);\n\t\tgl.disable(gl.DEPTH_TEST);\n\n\t\tvar mesh = Mesh.getScreenQuad();\n\t\tif (!LGraphChannelsTexture._shader) {\n\t\t\tLGraphChannelsTexture._shader = new GL.Shader(\n\t\t\t\tShader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphChannelsTexture.pixel_shader\n\t\t\t);\n\t\t}\n\t\tvar shader = LGraphChannelsTexture._shader;\n\n\t\tvar w = Math.max(texR.width, texG.width, texB.width, texA.width);\n\t\tvar h = Math.max(\n\t\t\ttexR.height,\n\t\t\ttexG.height,\n\t\t\ttexB.height,\n\t\t\ttexA.height\n\t\t);\n\t\tvar type =\n\t\t\tthis.properties.precision == LGraphTexture.HIGH\n\t\t\t\t? LGraphTexture.HIGH_PRECISION_FORMAT\n\t\t\t\t: gl.UNSIGNED_BYTE;\n\n\t\tif (\n\t\t\t!this._texture ||\n\t\t\tthis._texture.width != w ||\n\t\t\tthis._texture.height != h ||\n\t\t\tthis._texture.type != type\n\t\t) {\n\t\t\tthis._texture = new GL.Texture(w, h, {\n\t\t\t\ttype: type,\n\t\t\t\tformat: gl.RGBA,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\n\t\tvar color = this._color;\n\t\tcolor[0] = this.properties.R;\n\t\tcolor[1] = this.properties.G;\n\t\tcolor[2] = this.properties.B;\n\t\tcolor[3] = this.properties.A;\n\t\tvar uniforms = this._uniforms;\n\n\t\tthis._texture.drawTo(function() {\n\t\t\ttexR.bind(0);\n\t\t\ttexG.bind(1);\n\t\t\ttexB.bind(2);\n\t\t\ttexA.bind(3);\n\t\t\tshader.uniforms(uniforms).draw(mesh);\n\t\t});\n\t\tthis.setOutputData(0, this._texture);\n\t};\n\n\tLGraphChannelsTexture.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_textureR;\\n\\\n\t\tuniform sampler2D u_textureG;\\n\\\n\t\tuniform sampler2D u_textureB;\\n\\\n\t\tuniform sampler2D u_textureA;\\n\\\n\t\tuniform vec4 u_color;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t   gl_FragColor = u_color * vec4( \\\n\t\t\t\t\ttexture2D(u_textureR, v_coord).r,\\\n\t\t\t\t\ttexture2D(u_textureG, v_coord).r,\\\n\t\t\t\t\ttexture2D(u_textureB, v_coord).r,\\\n\t\t\t\t\ttexture2D(u_textureA, v_coord).r);\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\n\t\t\"texture/channelsTexture\",\n\t\tLGraphChannelsTexture\n\t);\n\n\t// Texture Color *****************************************\n\tfunction LGraphTextureColor() {\n\t\tthis.addOutput(\"Texture\", \"Texture\");\n\n\t\tthis._tex_color = vec4.create();\n\t\tthis.properties = {\n\t\t\tcolor: vec4.create(),\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\t}\n\n\tLGraphTextureColor.title = \"Color\";\n\tLGraphTextureColor.desc =\n\t\t\"Generates a 1x1 texture with a constant color\";\n\n\tLGraphTextureColor.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureColor.prototype.onDrawBackground = function(ctx) {\n\t\tvar c = this.properties.color;\n\t\tctx.fillStyle =\n\t\t\t\"rgb(\" +\n\t\t\tMath.floor(Math.clamp(c[0], 0, 1) * 255) +\n\t\t\t\",\" +\n\t\t\tMath.floor(Math.clamp(c[1], 0, 1) * 255) +\n\t\t\t\",\" +\n\t\t\tMath.floor(Math.clamp(c[2], 0, 1) * 255) +\n\t\t\t\")\";\n\t\tif (this.flags.collapsed) {\n\t\t\tthis.boxcolor = ctx.fillStyle;\n\t\t} else {\n\t\t\tctx.fillRect(0, 0, this.size[0], this.size[1]);\n\t\t}\n\t};\n\n\tLGraphTextureColor.prototype.onExecute = function() {\n\t\tvar type =\n\t\t\tthis.properties.precision == LGraphTexture.HIGH\n\t\t\t\t? LGraphTexture.HIGH_PRECISION_FORMAT\n\t\t\t\t: gl.UNSIGNED_BYTE;\n\n\t\tif (!this._tex || this._tex.type != type) {\n\t\t\tthis._tex = new GL.Texture(1, 1, {\n\t\t\t\tformat: gl.RGBA,\n\t\t\t\ttype: type,\n\t\t\t\tminFilter: gl.NEAREST\n\t\t\t});\n\t\t}\n\t\tvar color = this.properties.color;\n\n\t\tif (this.inputs) {\n\t\t\tfor (var i = 0; i < this.inputs.length; i++) {\n\t\t\t\tvar input = this.inputs[i];\n\t\t\t\tvar v = this.getInputData(i);\n\t\t\t\tif (v === undefined) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tswitch (input.name) {\n\t\t\t\t\tcase \"RGB\":\n\t\t\t\t\tcase \"RGBA\":\n\t\t\t\t\t\tcolor.set(v);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"R\":\n\t\t\t\t\t\tcolor[0] = v;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"G\":\n\t\t\t\t\t\tcolor[1] = v;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"B\":\n\t\t\t\t\t\tcolor[2] = v;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"A\":\n\t\t\t\t\t\tcolor[3] = v;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (vec4.sqrDist(this._tex_color, color) > 0.001) {\n\t\t\tthis._tex_color.set(color);\n\t\t\tthis._tex.fill(color);\n\t\t}\n\t\tthis.setOutputData(0, this._tex);\n\t};\n\n\tLGraphTextureColor.prototype.onGetInputs = function() {\n\t\treturn [\n\t\t\t[\"RGB\", \"vec3\"],\n\t\t\t[\"RGBA\", \"vec4\"],\n\t\t\t[\"R\", \"number\"],\n\t\t\t[\"G\", \"number\"],\n\t\t\t[\"B\", \"number\"],\n\t\t\t[\"A\", \"number\"]\n\t\t];\n\t};\n\n\tLiteGraph.registerNodeType(\"texture/color\", LGraphTextureColor);\n\n\t// Texture Channels to Texture *****************************************\n\tfunction LGraphTextureGradient() {\n\t\tthis.addInput(\"A\", \"color\");\n\t\tthis.addInput(\"B\", \"color\");\n\t\tthis.addOutput(\"Texture\", \"Texture\");\n\n\t\tthis.properties = {\n\t\t\tangle: 0,\n\t\t\tscale: 1,\n\t\t\tA: [0, 0, 0],\n\t\t\tB: [1, 1, 1],\n\t\t\ttexture_size: 32\n\t\t};\n\t\tif (!LGraphTextureGradient._shader) {\n\t\t\tLGraphTextureGradient._shader = new GL.Shader(\n\t\t\t\tShader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureGradient.pixel_shader\n\t\t\t);\n\t\t}\n\n\t\tthis._uniforms = {\n\t\t\tu_angle: 0,\n\t\t\tu_colorA: vec3.create(),\n\t\t\tu_colorB: vec3.create()\n\t\t};\n\t}\n\n\tLGraphTextureGradient.title = \"Gradient\";\n\tLGraphTextureGradient.desc = \"Generates a gradient\";\n\tLGraphTextureGradient[\"@A\"] = { type: \"color\" };\n\tLGraphTextureGradient[\"@B\"] = { type: \"color\" };\n\tLGraphTextureGradient[\"@texture_size\"] = {\n\t\ttype: \"enum\",\n\t\tvalues: [32, 64, 128, 256, 512]\n\t};\n\n\tLGraphTextureGradient.prototype.onExecute = function() {\n\t\tgl.disable(gl.BLEND);\n\t\tgl.disable(gl.DEPTH_TEST);\n\n\t\tvar mesh = GL.Mesh.getScreenQuad();\n\t\tvar shader = LGraphTextureGradient._shader;\n\n\t\tvar A = this.getInputData(0);\n\t\tif (!A) {\n\t\t\tA = this.properties.A;\n\t\t}\n\t\tvar B = this.getInputData(1);\n\t\tif (!B) {\n\t\t\tB = this.properties.B;\n\t\t}\n\n\t\t//angle and scale\n\t\tfor (var i = 2; i < this.inputs.length; i++) {\n\t\t\tvar input = this.inputs[i];\n\t\t\tvar v = this.getInputData(i);\n\t\t\tif (v === undefined) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tthis.properties[input.name] = v;\n\t\t}\n\n\t\tvar uniforms = this._uniforms;\n\t\tthis._uniforms.u_angle = this.properties.angle * DEG2RAD;\n\t\tthis._uniforms.u_scale = this.properties.scale;\n\t\tvec3.copy(uniforms.u_colorA, A);\n\t\tvec3.copy(uniforms.u_colorB, B);\n\n\t\tvar size = parseInt(this.properties.texture_size);\n\t\tif (!this._tex || this._tex.width != size) {\n\t\t\tthis._tex = new GL.Texture(size, size, {\n\t\t\t\tformat: gl.RGB,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\n\t\tthis._tex.drawTo(function() {\n\t\t\tshader.uniforms(uniforms).draw(mesh);\n\t\t});\n\t\tthis.setOutputData(0, this._tex);\n\t};\n\n\tLGraphTextureGradient.prototype.onGetInputs = function() {\n\t\treturn [[\"angle\", \"number\"], [\"scale\", \"number\"]];\n\t};\n\n\tLGraphTextureGradient.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform float u_angle;\\n\\\n\t\tuniform float u_scale;\\n\\\n\t\tuniform vec3 u_colorA;\\n\\\n\t\tuniform vec3 u_colorB;\\n\\\n\t\t\\n\\\n\t\tvec2 rotate(vec2 v, float angle)\\n\\\n\t\t{\\n\\\n\t\t\tvec2 result;\\n\\\n\t\t\tfloat _cos = cos(angle);\\n\\\n\t\t\tfloat _sin = sin(angle);\\n\\\n\t\t\tresult.x = v.x * _cos - v.y * _sin;\\n\\\n\t\t\tresult.y = v.x * _sin + v.y * _cos;\\n\\\n\t\t\treturn result;\\n\\\n\t\t}\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tfloat f = (rotate(u_scale * (v_coord - vec2(0.5)), u_angle) + vec2(0.5)).x;\\n\\\n\t\t\tvec3 color = mix(u_colorA,u_colorB,clamp(f,0.0,1.0));\\n\\\n\t\t   gl_FragColor = vec4(color,1.0);\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\"texture/gradient\", LGraphTextureGradient);\n\n\t// Texture Mix *****************************************\n\tfunction LGraphTextureMix() {\n\t\tthis.addInput(\"A\", \"Texture\");\n\t\tthis.addInput(\"B\", \"Texture\");\n\t\tthis.addInput(\"Mixer\", \"Texture\");\n\n\t\tthis.addOutput(\"Texture\", \"Texture\");\n\t\tthis.properties = { factor: 0.5, size_from_biggest: true, invert: false, precision: LGraphTexture.DEFAULT };\n\t\tthis._uniforms = {\n\t\t\tu_textureA: 0,\n\t\t\tu_textureB: 1,\n\t\t\tu_textureMix: 2,\n\t\t\tu_mix: vec4.create()\n\t\t};\n\t}\n\n\tLGraphTextureMix.title = \"Mix\";\n\tLGraphTextureMix.desc = \"Generates a texture mixing two textures\";\n\n\tLGraphTextureMix.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureMix.prototype.onExecute = function() {\n\t\tvar texA = this.getInputData(0);\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tif (this.properties.precision === LGraphTexture.PASS_THROUGH) {\n\t\t\tthis.setOutputData(0, texA);\n\t\t\treturn;\n\t\t}\n\n\t\tvar texB = this.getInputData(1);\n\t\tif (!texA || !texB) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar texMix = this.getInputData(2);\n\n\t\tvar factor = this.getInputData(3);\n\n\t\tthis._tex = LGraphTexture.getTargetTexture(\n\t\t\tthis.properties.size_from_biggest && texB.width > texA.width ? texB : texA,\n\t\t\tthis._tex,\n\t\t\tthis.properties.precision\n\t\t);\n\n\t\tgl.disable(gl.BLEND);\n\t\tgl.disable(gl.DEPTH_TEST);\n\n\t\tvar mesh = Mesh.getScreenQuad();\n\t\tvar shader = null;\n\t\tvar uniforms = this._uniforms;\n\t\tif (texMix) {\n\t\t\tshader = LGraphTextureMix._shader_tex;\n\t\t\tif (!shader) {\n\t\t\t\tshader = LGraphTextureMix._shader_tex = new GL.Shader(\n\t\t\t\t\tShader.SCREEN_VERTEX_SHADER,\n\t\t\t\t\tLGraphTextureMix.pixel_shader,\n\t\t\t\t\t{ MIX_TEX: \"\" }\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tshader = LGraphTextureMix._shader_factor;\n\t\t\tif (!shader) {\n\t\t\t\tshader = LGraphTextureMix._shader_factor = new GL.Shader(\n\t\t\t\t\tShader.SCREEN_VERTEX_SHADER,\n\t\t\t\t\tLGraphTextureMix.pixel_shader\n\t\t\t\t);\n\t\t\t}\n\t\t\tvar f = factor == null ? this.properties.factor : factor;\n\t\t\tuniforms.u_mix.set([f, f, f, f]);\n\t\t}\n\n\t\tvar invert = this.properties.invert;\n\n\t\tthis._tex.drawTo(function() {\n\t\t\ttexA.bind( invert ? 1 : 0 );\n\t\t\ttexB.bind( invert ? 0 : 1 );\n\t\t\tif (texMix) {\n\t\t\t\ttexMix.bind(2);\n\t\t\t}\n\t\t\tshader.uniforms(uniforms).draw(mesh);\n\t\t});\n\n\t\tthis.setOutputData(0, this._tex);\n\t};\n\n\tLGraphTextureMix.prototype.onGetInputs = function() {\n\t\treturn [[\"factor\", \"number\"]];\n\t};\n\n\tLGraphTextureMix.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_textureA;\\n\\\n\t\tuniform sampler2D u_textureB;\\n\\\n\t\t#ifdef MIX_TEX\\n\\\n\t\t\tuniform sampler2D u_textureMix;\\n\\\n\t\t#else\\n\\\n\t\t\tuniform vec4 u_mix;\\n\\\n\t\t#endif\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\t#ifdef MIX_TEX\\n\\\n\t\t\t   vec4 f = texture2D(u_textureMix, v_coord);\\n\\\n\t\t\t#else\\n\\\n\t\t\t   vec4 f = u_mix;\\n\\\n\t\t\t#endif\\n\\\n\t\t   gl_FragColor = mix( texture2D(u_textureA, v_coord), texture2D(u_textureB, v_coord), f );\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\"texture/mix\", LGraphTextureMix);\n\n\t// Texture Edges detection *****************************************\n\tfunction LGraphTextureEdges() {\n\t\tthis.addInput(\"Tex.\", \"Texture\");\n\n\t\tthis.addOutput(\"Edges\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tinvert: true,\n\t\t\tthreshold: false,\n\t\t\tfactor: 1,\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\n\t\tif (!LGraphTextureEdges._shader) {\n\t\t\tLGraphTextureEdges._shader = new GL.Shader(\n\t\t\t\tShader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureEdges.pixel_shader\n\t\t\t);\n\t\t}\n\t}\n\n\tLGraphTextureEdges.title = \"Edges\";\n\tLGraphTextureEdges.desc = \"Detects edges\";\n\n\tLGraphTextureEdges.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureEdges.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar tex = this.getInputData(0);\n\n\t\tif (this.properties.precision === LGraphTexture.PASS_THROUGH) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._tex = LGraphTexture.getTargetTexture(\n\t\t\ttex,\n\t\t\tthis._tex,\n\t\t\tthis.properties.precision\n\t\t);\n\n\t\tgl.disable(gl.BLEND);\n\t\tgl.disable(gl.DEPTH_TEST);\n\n\t\tvar mesh = Mesh.getScreenQuad();\n\t\tvar shader = LGraphTextureEdges._shader;\n\t\tvar invert = this.properties.invert;\n\t\tvar factor = this.properties.factor;\n\t\tvar threshold = this.properties.threshold ? 1 : 0;\n\n\t\tthis._tex.drawTo(function() {\n\t\t\ttex.bind(0);\n\t\t\tshader\n\t\t\t\t.uniforms({\n\t\t\t\t\tu_texture: 0,\n\t\t\t\t\tu_isize: [1 / tex.width, 1 / tex.height],\n\t\t\t\t\tu_factor: factor,\n\t\t\t\t\tu_threshold: threshold,\n\t\t\t\t\tu_invert: invert ? 1 : 0\n\t\t\t\t})\n\t\t\t\t.draw(mesh);\n\t\t});\n\n\t\tthis.setOutputData(0, this._tex);\n\t};\n\n\tLGraphTextureEdges.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform vec2 u_isize;\\n\\\n\t\tuniform int u_invert;\\n\\\n\t\tuniform float u_factor;\\n\\\n\t\tuniform float u_threshold;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec4 center = texture2D(u_texture, v_coord);\\n\\\n\t\t\tvec4 up = texture2D(u_texture, v_coord + u_isize * vec2(0.0,1.0) );\\n\\\n\t\t\tvec4 down = texture2D(u_texture, v_coord + u_isize * vec2(0.0,-1.0) );\\n\\\n\t\t\tvec4 left = texture2D(u_texture, v_coord + u_isize * vec2(1.0,0.0) );\\n\\\n\t\t\tvec4 right = texture2D(u_texture, v_coord + u_isize * vec2(-1.0,0.0) );\\n\\\n\t\t\tvec4 diff = abs(center - up) + abs(center - down) + abs(center - left) + abs(center - right);\\n\\\n\t\t\tdiff *= u_factor;\\n\\\n\t\t\tif(u_invert == 1)\\n\\\n\t\t\t\tdiff.xyz = vec3(1.0) - diff.xyz;\\n\\\n\t\t\tif( u_threshold == 0.0 )\\n\\\n\t\t\t\tgl_FragColor = vec4( diff.xyz, center.a );\\n\\\n\t\t\telse\\n\\\n\t\t\t\tgl_FragColor = vec4( diff.x > 0.5 ? 1.0 : 0.0, diff.y > 0.5 ? 1.0 : 0.0, diff.z > 0.5 ? 1.0 : 0.0, center.a );\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\"texture/edges\", LGraphTextureEdges);\n\n\t// Texture Depth *****************************************\n\tfunction LGraphTextureDepthRange() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addInput(\"Distance\", \"number\");\n\t\tthis.addInput(\"Range\", \"number\");\n\t\tthis.addOutput(\"Texture\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tdistance: 100,\n\t\t\trange: 50,\n\t\t\tonly_depth: false,\n\t\t\thigh_precision: false\n\t\t};\n\t\tthis._uniforms = {\n\t\t\tu_texture: 0,\n\t\t\tu_distance: 100,\n\t\t\tu_range: 50,\n\t\t\tu_camera_planes: null\n\t\t};\n\t}\n\n\tLGraphTextureDepthRange.title = \"Depth Range\";\n\tLGraphTextureDepthRange.desc = \"Generates a texture with a depth range\";\n\n\tLGraphTextureDepthRange.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar precision = gl.UNSIGNED_BYTE;\n\t\tif (this.properties.high_precision) {\n\t\t\tprecision = gl.half_float_ext ? gl.HALF_FLOAT_OES : gl.FLOAT;\n\t\t}\n\n\t\tif (\n\t\t\t!this._temp_texture ||\n\t\t\tthis._temp_texture.type != precision ||\n\t\t\tthis._temp_texture.width != tex.width ||\n\t\t\tthis._temp_texture.height != tex.height\n\t\t) {\n\t\t\tthis._temp_texture = new GL.Texture(tex.width, tex.height, {\n\t\t\t\ttype: precision,\n\t\t\t\tformat: gl.RGBA,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\n\t\tvar uniforms = this._uniforms;\n\n\t\t//iterations\n\t\tvar distance = this.properties.distance;\n\t\tif (this.isInputConnected(1)) {\n\t\t\tdistance = this.getInputData(1);\n\t\t\tthis.properties.distance = distance;\n\t\t}\n\n\t\tvar range = this.properties.range;\n\t\tif (this.isInputConnected(2)) {\n\t\t\trange = this.getInputData(2);\n\t\t\tthis.properties.range = range;\n\t\t}\n\n\t\tuniforms.u_distance = distance;\n\t\tuniforms.u_range = range;\n\n\t\tgl.disable(gl.BLEND);\n\t\tgl.disable(gl.DEPTH_TEST);\n\t\tvar mesh = Mesh.getScreenQuad();\n\t\tif (!LGraphTextureDepthRange._shader) {\n\t\t\tLGraphTextureDepthRange._shader = new GL.Shader(\n\t\t\t\tShader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureDepthRange.pixel_shader\n\t\t\t);\n\t\t\tLGraphTextureDepthRange._shader_onlydepth = new GL.Shader(\n\t\t\t\tShader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureDepthRange.pixel_shader,\n\t\t\t\t{ ONLY_DEPTH: \"\" }\n\t\t\t);\n\t\t}\n\t\tvar shader = this.properties.only_depth\n\t\t\t? LGraphTextureDepthRange._shader_onlydepth\n\t\t\t: LGraphTextureDepthRange._shader;\n\n\t\t//NEAR AND FAR PLANES\n\t\tvar planes = null;\n\t\tif (tex.near_far_planes) {\n\t\t\tplanes = tex.near_far_planes;\n\t\t} else if (window.LS && LS.Renderer._main_camera) {\n\t\t\tplanes = LS.Renderer._main_camera._uniforms.u_camera_planes;\n\t\t} else {\n\t\t\tplanes = [0.1, 1000];\n\t\t} //hardcoded\n\t\tuniforms.u_camera_planes = planes;\n\n\t\tthis._temp_texture.drawTo(function() {\n\t\t\ttex.bind(0);\n\t\t\tshader.uniforms(uniforms).draw(mesh);\n\t\t});\n\n\t\tthis._temp_texture.near_far_planes = planes;\n\t\tthis.setOutputData(0, this._temp_texture);\n\t};\n\n\tLGraphTextureDepthRange.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform vec2 u_camera_planes;\\n\\\n\t\tuniform float u_distance;\\n\\\n\t\tuniform float u_range;\\n\\\n\t\t\\n\\\n\t\tfloat LinearDepth()\\n\\\n\t\t{\\n\\\n\t\t\tfloat zNear = u_camera_planes.x;\\n\\\n\t\t\tfloat zFar = u_camera_planes.y;\\n\\\n\t\t\tfloat depth = texture2D(u_texture, v_coord).x;\\n\\\n\t\t\tdepth = depth * 2.0 - 1.0;\\n\\\n\t\t\treturn zNear * (depth + 1.0) / (zFar + zNear - depth * (zFar - zNear));\\n\\\n\t\t}\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tfloat depth = LinearDepth();\\n\\\n\t\t\t#ifdef ONLY_DEPTH\\n\\\n\t\t\t   gl_FragColor = vec4(depth);\\n\\\n\t\t\t#else\\n\\\n\t\t\t\tfloat diff = abs(depth * u_camera_planes.y - u_distance);\\n\\\n\t\t\t\tfloat dof = 1.0;\\n\\\n\t\t\t\tif(diff <= u_range)\\n\\\n\t\t\t\t\tdof = diff / u_range;\\n\\\n\t\t\t   gl_FragColor = vec4(dof);\\n\\\n\t\t\t#endif\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType( \"texture/depth_range\", LGraphTextureDepthRange );\n\n\n\t// Texture Depth *****************************************\n\tfunction LGraphTextureLinearDepth() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addOutput(\"Texture\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tprecision: LGraphTexture.DEFAULT,\n\t\t\tinvert: false\n\t\t};\n\t\tthis._uniforms = {\n\t\t\tu_texture: 0,\n\t\t\tu_camera_planes: null, //filled later\n\t\t\tu_ires: vec2.create()\n\t\t};\n\t}\n\n\tLGraphTextureLinearDepth.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureLinearDepth.title = \"Linear Depth\";\n\tLGraphTextureLinearDepth.desc = \"Creates a color texture with linear depth\";\n\n\tLGraphTextureLinearDepth.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex || (tex.format != gl.DEPTH_COMPONENT && tex.format != gl.DEPTH_STENCIL) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar precision = this.properties.precision == LGraphTexture.HIGH ? gl.HIGH_PRECISION_FORMAT : gl.UNSIGNED_BYTE;\n\n\t\tif ( !this._temp_texture || this._temp_texture.type != precision || this._temp_texture.width != tex.width || this._temp_texture.height != tex.height ) {\n\t\t\tthis._temp_texture = new GL.Texture(tex.width, tex.height, {\n\t\t\t\ttype: precision,\n\t\t\t\tformat: gl.RGB,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\n\t\tvar uniforms = this._uniforms;\n\t\tuniforms.u_invert = this.properties.invert ? 1 : 0;\n\n\t\tgl.disable(gl.BLEND);\n\t\tgl.disable(gl.DEPTH_TEST);\n\t\tvar mesh = Mesh.getScreenQuad();\n\t\tif(!LGraphTextureLinearDepth._shader)\n\t\t\tLGraphTextureLinearDepth._shader = new GL.Shader( GL.Shader.SCREEN_VERTEX_SHADER, LGraphTextureLinearDepth.pixel_shader);\n\t\tvar shader = LGraphTextureLinearDepth._shader;\n\n\t\t//NEAR AND FAR PLANES\n\t\tvar planes = null;\n\t\tif (tex.near_far_planes) {\n\t\t\tplanes = tex.near_far_planes;\n\t\t} else if (window.LS && LS.Renderer._main_camera) {\n\t\t\tplanes = LS.Renderer._main_camera._uniforms.u_camera_planes;\n\t\t} else {\n\t\t\tplanes = [0.1, 1000];\n\t\t} //hardcoded\n\t\tuniforms.u_camera_planes = planes;\n\t\t//uniforms.u_ires.set([1/tex.width, 1/tex.height]);\n\t\tuniforms.u_ires.set([0,0]);\n\n\t\tthis._temp_texture.drawTo(function() {\n\t\t\ttex.bind(0);\n\t\t\tshader.uniforms(uniforms).draw(mesh);\n\t\t});\n\n\t\tthis._temp_texture.near_far_planes = planes;\n\t\tthis.setOutputData(0, this._temp_texture);\n\t};\n\n\tLGraphTextureLinearDepth.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform vec2 u_camera_planes;\\n\\\n\t\tuniform int u_invert;\\n\\\n\t\tuniform vec2 u_ires;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tfloat zNear = u_camera_planes.x;\\n\\\n\t\t\tfloat zFar = u_camera_planes.y;\\n\\\n\t\t\tfloat depth = texture2D(u_texture, v_coord + u_ires*0.5).x * 2.0 - 1.0;\\n\\\n\t\t\tfloat f = zNear * (depth + 1.0) / (zFar + zNear - depth * (zFar - zNear));\\n\\\n\t\t\tif( u_invert == 1 )\\n\\\n\t\t\t\tf = 1.0 - f;\\n\\\n\t\t\tgl_FragColor = vec4(vec3(f),1.0);\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType( \"texture/linear_depth\", LGraphTextureLinearDepth );\n\n\t// Texture Blur *****************************************\n\tfunction LGraphTextureBlur() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addInput(\"Iterations\", \"number\");\n\t\tthis.addInput(\"Intensity\", \"number\");\n\t\tthis.addOutput(\"Blurred\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tintensity: 1,\n\t\t\titerations: 1,\n\t\t\tpreserve_aspect: false,\n\t\t\tscale: [1, 1],\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\t}\n\n\tLGraphTextureBlur.title = \"Blur\";\n\tLGraphTextureBlur.desc = \"Blur a texture\";\n\n\tLGraphTextureBlur.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureBlur.max_iterations = 20;\n\n\tLGraphTextureBlur.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar temp = this._final_texture;\n\n\t\tif (\n\t\t\t!temp ||\n\t\t\ttemp.width != tex.width ||\n\t\t\ttemp.height != tex.height ||\n\t\t\ttemp.type != tex.type\n\t\t) {\n\t\t\t//we need two textures to do the blurring\n\t\t\t//this._temp_texture = new GL.Texture( tex.width, tex.height, { type: tex.type, format: gl.RGBA, filter: gl.LINEAR });\n\t\t\ttemp = this._final_texture = new GL.Texture(\n\t\t\t\ttex.width,\n\t\t\t\ttex.height,\n\t\t\t\t{ type: tex.type, format: gl.RGBA, filter: gl.LINEAR }\n\t\t\t);\n\t\t}\n\n\t\t//iterations\n\t\tvar iterations = this.properties.iterations;\n\t\tif (this.isInputConnected(1)) {\n\t\t\titerations = this.getInputData(1);\n\t\t\tthis.properties.iterations = iterations;\n\t\t}\n\t\titerations = Math.min(\n\t\t\tMath.floor(iterations),\n\t\t\tLGraphTextureBlur.max_iterations\n\t\t);\n\t\tif (iterations == 0) {\n\t\t\t//skip blurring\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tvar intensity = this.properties.intensity;\n\t\tif (this.isInputConnected(2)) {\n\t\t\tintensity = this.getInputData(2);\n\t\t\tthis.properties.intensity = intensity;\n\t\t}\n\n\t\t//blur sometimes needs an aspect correction\n\t\tvar aspect = LiteGraph.camera_aspect;\n\t\tif (!aspect && window.gl !== undefined) {\n\t\t\taspect = gl.canvas.height / gl.canvas.width;\n\t\t}\n\t\tif (!aspect) {\n\t\t\taspect = 1;\n\t\t}\n\t\taspect = this.properties.preserve_aspect ? aspect : 1;\n\n\t\tvar scale = this.properties.scale || [1, 1];\n\t\ttex.applyBlur(aspect * scale[0], scale[1], intensity, temp);\n\t\tfor (var i = 1; i < iterations; ++i) {\n\t\t\ttemp.applyBlur(\n\t\t\t\taspect * scale[0] * (i + 1),\n\t\t\t\tscale[1] * (i + 1),\n\t\t\t\tintensity\n\t\t\t);\n\t\t}\n\n\t\tthis.setOutputData(0, temp);\n\t};\n\n\t/*\nLGraphTextureBlur.pixel_shader = \"precision highp float;\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform vec2 u_offset;\\n\\\n\t\tuniform float u_intensity;\\n\\\n\t\tvoid main() {\\n\\\n\t\t   vec4 sum = vec4(0.0);\\n\\\n\t\t   vec4 center = texture2D(u_texture, v_coord);\\n\\\n\t\t   sum += texture2D(u_texture, v_coord + u_offset * -4.0) * 0.05/0.98;\\n\\\n\t\t   sum += texture2D(u_texture, v_coord + u_offset * -3.0) * 0.09/0.98;\\n\\\n\t\t   sum += texture2D(u_texture, v_coord + u_offset * -2.0) * 0.12/0.98;\\n\\\n\t\t   sum += texture2D(u_texture, v_coord + u_offset * -1.0) * 0.15/0.98;\\n\\\n\t\t   sum += center * 0.16/0.98;\\n\\\n\t\t   sum += texture2D(u_texture, v_coord + u_offset * 4.0) * 0.05/0.98;\\n\\\n\t\t   sum += texture2D(u_texture, v_coord + u_offset * 3.0) * 0.09/0.98;\\n\\\n\t\t   sum += texture2D(u_texture, v_coord + u_offset * 2.0) * 0.12/0.98;\\n\\\n\t\t   sum += texture2D(u_texture, v_coord + u_offset * 1.0) * 0.15/0.98;\\n\\\n\t\t   gl_FragColor = u_intensity * sum;\\n\\\n\t\t}\\n\\\n\t\t\";\n*/\n\n\tLiteGraph.registerNodeType(\"texture/blur\", LGraphTextureBlur);\n\n\t//Independent glow FX\n\t//based on https://catlikecoding.com/unity/tutorials/advanced-rendering/bloom/\n\tfunction FXGlow()\n\t{\n\t\tthis.intensity = 0.5;\n\t\tthis.persistence = 0.6;\n\t\tthis.iterations = 8;\n\t\tthis.threshold = 0.8;\n\t\tthis.scale = 1;\n\n\t\tthis.dirt_texture = null;\n\t\tthis.dirt_factor = 0.5;\n\n\t\tthis._textures = [];\n\t\tthis._uniforms = {\n\t\t\tu_intensity: 1,\n\t\t\tu_texture: 0,\n\t\t\tu_glow_texture: 1,\n\t\t\tu_threshold: 0,\n\t\t\tu_texel_size: vec2.create()\n\t\t};\n\t}\n\n\tFXGlow.prototype.applyFX = function( tex, output_texture, glow_texture, average_texture ) {\n\n\t\tvar width = tex.width;\n\t\tvar height = tex.height;\n\n\t\tvar texture_info = {\n\t\t\tformat: tex.format,\n\t\t\ttype: tex.type,\n\t\t\tminFilter: GL.LINEAR,\n\t\t\tmagFilter: GL.LINEAR,\n\t\t\twrap: gl.CLAMP_TO_EDGE\n\t\t};\n\n\t\tvar uniforms = this._uniforms;\n\t\tvar textures = this._textures;\n\n\t\t//cut\n\t\tvar shader = FXGlow._cut_shader;\n\t\tif (!shader) {\n\t\t\tshader = FXGlow._cut_shader = new GL.Shader(\n\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\tFXGlow.cut_pixel_shader\n\t\t\t);\n\t\t}\n\n\t\tgl.disable(gl.DEPTH_TEST);\n\t\tgl.disable(gl.BLEND);\n\n\t\tuniforms.u_threshold = this.threshold;\n\t\tvar currentDestination = (textures[0] = GL.Texture.getTemporary(\n\t\t\twidth,\n\t\t\theight,\n\t\t\ttexture_info\n\t\t));\n\t\ttex.blit( currentDestination, shader.uniforms(uniforms) );\n\t\tvar currentSource = currentDestination;\n\n\t\tvar iterations = this.iterations;\n\t\titerations = Math.clamp(iterations, 1, 16) | 0;\n\t\tvar texel_size = uniforms.u_texel_size;\n\t\tvar intensity = this.intensity;\n\n\t\tuniforms.u_intensity = 1;\n\t\tuniforms.u_delta = this.scale; //1\n\n\t\t//downscale/upscale shader\n\t\tvar shader = FXGlow._shader;\n\t\tif (!shader) {\n\t\t\tshader = FXGlow._shader = new GL.Shader(\n\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\tFXGlow.scale_pixel_shader\n\t\t\t);\n\t\t}\n\n\t\tvar i = 1;\n\t\t//downscale\n\t\tfor (; i < iterations; i++) {\n\t\t\twidth = width >> 1;\n\t\t\tif ((height | 0) > 1) {\n\t\t\t\theight = height >> 1;\n\t\t\t}\n\t\t\tif (width < 2) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcurrentDestination = textures[i] = GL.Texture.getTemporary(\n\t\t\t\twidth,\n\t\t\t\theight,\n\t\t\t\ttexture_info\n\t\t\t);\n\t\t\ttexel_size[0] = 1 / currentSource.width;\n\t\t\ttexel_size[1] = 1 / currentSource.height;\n\t\t\tcurrentSource.blit(\n\t\t\t\tcurrentDestination,\n\t\t\t\tshader.uniforms(uniforms)\n\t\t\t);\n\t\t\tcurrentSource = currentDestination;\n\t\t}\n\n\t\t//average\n\t\tif (average_texture) {\n\t\t\ttexel_size[0] = 1 / currentSource.width;\n\t\t\ttexel_size[1] = 1 / currentSource.height;\n\t\t\tuniforms.u_intensity = intensity;\n\t\t\tuniforms.u_delta = 1;\n\t\t\tcurrentSource.blit(average_texture, shader.uniforms(uniforms));\n\t\t}\n\n\t\t//upscale and blend\n\t\tgl.enable(gl.BLEND);\n\t\tgl.blendFunc(gl.ONE, gl.ONE);\n\t\tuniforms.u_intensity = this.persistence;\n\t\tuniforms.u_delta = 0.5;\n\n\t\t// i-=2 => -1 to point to last element in array, -1 to go to texture above\n\t\tfor ( i -= 2; i >= 0; i-- ) \n\t\t{\n\t\t\tcurrentDestination = textures[i];\n\t\t\ttextures[i] = null;\n\t\t\ttexel_size[0] = 1 / currentSource.width;\n\t\t\ttexel_size[1] = 1 / currentSource.height;\n\t\t\tcurrentSource.blit(\n\t\t\t\tcurrentDestination,\n\t\t\t\tshader.uniforms(uniforms)\n\t\t\t);\n\t\t\tGL.Texture.releaseTemporary(currentSource);\n\t\t\tcurrentSource = currentDestination;\n\t\t}\n\t\tgl.disable(gl.BLEND);\n\n\t\t//glow\n\t\tif (glow_texture) {\n\t\t\tcurrentSource.blit(glow_texture);\n\t\t}\n\n\t\t//final composition\n\t\tif ( output_texture ) {\n\t\t\tvar final_texture = output_texture;\n\t\t\tvar dirt_texture = this.dirt_texture;\n\t\t\tvar dirt_factor = this.dirt_factor;\n\t\t\tuniforms.u_intensity = intensity;\n\n\t\t\tshader = dirt_texture\n\t\t\t\t? FXGlow._dirt_final_shader\n\t\t\t\t: FXGlow._final_shader;\n\t\t\tif (!shader) {\n\t\t\t\tif (dirt_texture) {\n\t\t\t\t\tshader = FXGlow._dirt_final_shader = new GL.Shader(\n\t\t\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\t\t\tFXGlow.final_pixel_shader,\n\t\t\t\t\t\t{ USE_DIRT: \"\" }\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tshader = FXGlow._final_shader = new GL.Shader(\n\t\t\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\t\t\tFXGlow.final_pixel_shader\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfinal_texture.drawTo(function() {\n\t\t\t\ttex.bind(0);\n\t\t\t\tcurrentSource.bind(1);\n\t\t\t\tif (dirt_texture) {\n\t\t\t\t\tshader.setUniform(\"u_dirt_factor\", dirt_factor);\n\t\t\t\t\tshader.setUniform(\n\t\t\t\t\t\t\"u_dirt_texture\",\n\t\t\t\t\t\tdirt_texture.bind(2)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tshader.toViewport(uniforms);\n\t\t\t});\n\t\t}\n\n\t\tGL.Texture.releaseTemporary(currentSource);\n\t};\n\n\tFXGlow.cut_pixel_shader =\n\t\t\"precision highp float;\\n\\\n\tvarying vec2 v_coord;\\n\\\n\tuniform sampler2D u_texture;\\n\\\n\tuniform float u_threshold;\\n\\\n\tvoid main() {\\n\\\n\t\tgl_FragColor = max( texture2D( u_texture, v_coord ) - vec4( u_threshold ), vec4(0.0) );\\n\\\n\t}\";\n\n\tFXGlow.scale_pixel_shader =\n\t\t\"precision highp float;\\n\\\n\tvarying vec2 v_coord;\\n\\\n\tuniform sampler2D u_texture;\\n\\\n\tuniform vec2 u_texel_size;\\n\\\n\tuniform float u_delta;\\n\\\n\tuniform float u_intensity;\\n\\\n\t\\n\\\n\tvec4 sampleBox(vec2 uv) {\\n\\\n\t\tvec4 o = u_texel_size.xyxy * vec2(-u_delta, u_delta).xxyy;\\n\\\n\t\tvec4 s = texture2D( u_texture, uv + o.xy ) + texture2D( u_texture, uv + o.zy) + texture2D( u_texture, uv + o.xw) + texture2D( u_texture, uv + o.zw);\\n\\\n\t\treturn s * 0.25;\\n\\\n\t}\\n\\\n\tvoid main() {\\n\\\n\t\tgl_FragColor = u_intensity * sampleBox( v_coord );\\n\\\n\t}\";\n\n\tFXGlow.final_pixel_shader =\n\t\t\"precision highp float;\\n\\\n\tvarying vec2 v_coord;\\n\\\n\tuniform sampler2D u_texture;\\n\\\n\tuniform sampler2D u_glow_texture;\\n\\\n\t#ifdef USE_DIRT\\n\\\n\t\tuniform sampler2D u_dirt_texture;\\n\\\n\t#endif\\n\\\n\tuniform vec2 u_texel_size;\\n\\\n\tuniform float u_delta;\\n\\\n\tuniform float u_intensity;\\n\\\n\tuniform float u_dirt_factor;\\n\\\n\t\\n\\\n\tvec4 sampleBox(vec2 uv) {\\n\\\n\t\tvec4 o = u_texel_size.xyxy * vec2(-u_delta, u_delta).xxyy;\\n\\\n\t\tvec4 s = texture2D( u_glow_texture, uv + o.xy ) + texture2D( u_glow_texture, uv + o.zy) + texture2D( u_glow_texture, uv + o.xw) + texture2D( u_glow_texture, uv + o.zw);\\n\\\n\t\treturn s * 0.25;\\n\\\n\t}\\n\\\n\tvoid main() {\\n\\\n\t\tvec4 glow = sampleBox( v_coord );\\n\\\n\t\t#ifdef USE_DIRT\\n\\\n\t\t\tglow = mix( glow, glow * texture2D( u_dirt_texture, v_coord ), u_dirt_factor );\\n\\\n\t\t#endif\\n\\\n\t\tgl_FragColor = texture2D( u_texture, v_coord ) + u_intensity * glow;\\n\\\n\t}\";\n\n\n\t// Texture Glow *****************************************\n\tfunction LGraphTextureGlow() {\n\t\tthis.addInput(\"in\", \"Texture\");\n\t\tthis.addInput(\"dirt\", \"Texture\");\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.addOutput(\"glow\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tenabled: true,\n\t\t\tintensity: 1,\n\t\t\tpersistence: 0.99,\n\t\t\titerations: 16,\n\t\t\tthreshold: 0,\n\t\t\tscale: 1,\n\t\t\tdirt_factor: 0.5,\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\n\t\tthis.fx = new FXGlow();\n\t}\n\n\tLGraphTextureGlow.title = \"Glow\";\n\tLGraphTextureGlow.desc = \"Filters a texture giving it a glow effect\";\n\n\tLGraphTextureGlow.widgets_info = {\n\t\titerations: {\n\t\t\ttype: \"number\",\n\t\t\tmin: 0,\n\t\t\tmax: 16,\n\t\t\tstep: 1,\n\t\t\tprecision: 0\n\t\t},\n\t\tthreshold: {\n\t\t\ttype: \"number\",\n\t\t\tmin: 0,\n\t\t\tmax: 10,\n\t\t\tstep: 0.01,\n\t\t\tprecision: 2\n\t\t},\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureGlow.prototype.onGetInputs = function() {\n\t\treturn [\n\t\t\t[\"enabled\", \"boolean\"],\n\t\t\t[\"threshold\", \"number\"],\n\t\t\t[\"intensity\", \"number\"],\n\t\t\t[\"persistence\", \"number\"],\n\t\t\t[\"iterations\", \"number\"],\n\t\t\t[\"dirt_factor\", \"number\"]\n\t\t];\n\t};\n\n\tLGraphTextureGlow.prototype.onGetOutputs = function() {\n\t\treturn [[\"average\", \"Texture\"]];\n\t};\n\n\tLGraphTextureGlow.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isAnyOutputConnected()) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tif (\n\t\t\tthis.properties.precision === LGraphTexture.PASS_THROUGH ||\n\t\t\tthis.getInputOrProperty(\"enabled\") === false\n\t\t) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tvar width = tex.width;\n\t\tvar height = tex.height;\n\n\t\tvar fx = this.fx;\n\t\tfx.threshold = this.getInputOrProperty(\"threshold\");\n\t\tfx.iterations = this.getInputOrProperty(\"iterations\");\n\t\tfx.intensity = this.getInputOrProperty(\"intensity\");\n\t\tfx.persistence = this.getInputOrProperty(\"persistence\");\n\t\tfx.dirt_texture = this.getInputData(1);\n\t\tfx.dirt_factor = this.getInputOrProperty(\"dirt_factor\");\n\t\tfx.scale = this.properties.scale;\n\n\t\tvar type = LGraphTexture.getTextureType( this.properties.precision, tex );\n\n\t\tvar average_texture = null;\n\t\tif (this.isOutputConnected(2)) {\n\t\t\taverage_texture = this._average_texture;\n\t\t\tif (\n\t\t\t\t!average_texture ||\n\t\t\t\taverage_texture.type != tex.type ||\n\t\t\t\taverage_texture.format != tex.format\n\t\t\t) {\n\t\t\t\taverage_texture = this._average_texture = new GL.Texture(\n\t\t\t\t\t1,\n\t\t\t\t\t1,\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: tex.type,\n\t\t\t\t\t\tformat: tex.format,\n\t\t\t\t\t\tfilter: gl.LINEAR\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tvar glow_texture = null;\n\t\tif (this.isOutputConnected(1)) {\n\t\t\tglow_texture = this._glow_texture;\n\t\t\tif (\n\t\t\t\t!glow_texture ||\n\t\t\t\tglow_texture.width != tex.width ||\n\t\t\t\tglow_texture.height != tex.height ||\n\t\t\t\tglow_texture.type != type ||\n\t\t\t\tglow_texture.format != tex.format\n\t\t\t) {\n\t\t\t\tglow_texture = this._glow_texture = new GL.Texture(\n\t\t\t\t\ttex.width,\n\t\t\t\t\ttex.height,\n\t\t\t\t\t{ type: type, format: tex.format, filter: gl.LINEAR }\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tvar final_texture = null;\n\t\tif (this.isOutputConnected(0)) {\n\t\t\tfinal_texture = this._final_texture;\n\t\t\tif (\n\t\t\t\t!final_texture ||\n\t\t\t\tfinal_texture.width != tex.width ||\n\t\t\t\tfinal_texture.height != tex.height ||\n\t\t\t\tfinal_texture.type != type ||\n\t\t\t\tfinal_texture.format != tex.format\n\t\t\t) {\n\t\t\t\tfinal_texture = this._final_texture = new GL.Texture(\n\t\t\t\t\ttex.width,\n\t\t\t\t\ttex.height,\n\t\t\t\t\t{ type: type, format: tex.format, filter: gl.LINEAR }\n\t\t\t\t);\n\t\t\t}\n\n\t\t}\n\n\t\t//apply FX\n\t\tfx.applyFX(tex, final_texture, glow_texture, average_texture );\n\n\t\tif (this.isOutputConnected(0))\n\t\t\tthis.setOutputData(0, final_texture);\n\n\t\tif (this.isOutputConnected(1))\n\t\t\tthis.setOutputData(1, average_texture);\n\n\t\tif (this.isOutputConnected(2))\n\t\t\tthis.setOutputData(2, glow_texture);\n\t};\n\n\tLiteGraph.registerNodeType(\"texture/glow\", LGraphTextureGlow);\n\n\t// Texture Filter *****************************************\n\tfunction LGraphTextureKuwaharaFilter() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addOutput(\"Filtered\", \"Texture\");\n\t\tthis.properties = { intensity: 1, radius: 5 };\n\t}\n\n\tLGraphTextureKuwaharaFilter.title = \"Kuwahara Filter\";\n\tLGraphTextureKuwaharaFilter.desc =\n\t\t\"Filters a texture giving an artistic oil canvas painting\";\n\n\tLGraphTextureKuwaharaFilter.max_radius = 10;\n\tLGraphTextureKuwaharaFilter._shaders = [];\n\n\tLGraphTextureKuwaharaFilter.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar temp = this._temp_texture;\n\n\t\tif (\n\t\t\t!temp ||\n\t\t\ttemp.width != tex.width ||\n\t\t\ttemp.height != tex.height ||\n\t\t\ttemp.type != tex.type\n\t\t) {\n\t\t\tthis._temp_texture = new GL.Texture(tex.width, tex.height, {\n\t\t\t\ttype: tex.type,\n\t\t\t\tformat: gl.RGBA,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\n\t\t//iterations\n\t\tvar radius = this.properties.radius;\n\t\tradius = Math.min(\n\t\t\tMath.floor(radius),\n\t\t\tLGraphTextureKuwaharaFilter.max_radius\n\t\t);\n\t\tif (radius == 0) {\n\t\t\t//skip blurring\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tvar intensity = this.properties.intensity;\n\n\t\t//blur sometimes needs an aspect correction\n\t\tvar aspect = LiteGraph.camera_aspect;\n\t\tif (!aspect && window.gl !== undefined) {\n\t\t\taspect = gl.canvas.height / gl.canvas.width;\n\t\t}\n\t\tif (!aspect) {\n\t\t\taspect = 1;\n\t\t}\n\t\taspect = this.properties.preserve_aspect ? aspect : 1;\n\n\t\tif (!LGraphTextureKuwaharaFilter._shaders[radius]) {\n\t\t\tLGraphTextureKuwaharaFilter._shaders[radius] = new GL.Shader(\n\t\t\t\tShader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureKuwaharaFilter.pixel_shader,\n\t\t\t\t{ RADIUS: radius.toFixed(0) }\n\t\t\t);\n\t\t}\n\n\t\tvar shader = LGraphTextureKuwaharaFilter._shaders[radius];\n\t\tvar mesh = GL.Mesh.getScreenQuad();\n\t\ttex.bind(0);\n\n\t\tthis._temp_texture.drawTo(function() {\n\t\t\tshader\n\t\t\t\t.uniforms({\n\t\t\t\t\tu_texture: 0,\n\t\t\t\t\tu_intensity: intensity,\n\t\t\t\t\tu_resolution: [tex.width, tex.height],\n\t\t\t\t\tu_iResolution: [1 / tex.width, 1 / tex.height]\n\t\t\t\t})\n\t\t\t\t.draw(mesh);\n\t\t});\n\n\t\tthis.setOutputData(0, this._temp_texture);\n\t};\n\n\t//from https://www.shadertoy.com/view/MsXSz4\n\tLGraphTextureKuwaharaFilter.pixel_shader =\n\t\t\"\\n\\\nprecision highp float;\\n\\\nvarying vec2 v_coord;\\n\\\nuniform sampler2D u_texture;\\n\\\nuniform float u_intensity;\\n\\\nuniform vec2 u_resolution;\\n\\\nuniform vec2 u_iResolution;\\n\\\n#ifndef RADIUS\\n\\\n\t#define RADIUS 7\\n\\\n#endif\\n\\\nvoid main() {\\n\\\n\\n\\\n\tconst int radius = RADIUS;\\n\\\n\tvec2 fragCoord = v_coord;\\n\\\n\tvec2 src_size = u_iResolution;\\n\\\n\tvec2 uv = v_coord;\\n\\\n\tfloat n = float((radius + 1) * (radius + 1));\\n\\\n\tint i;\\n\\\n\tint j;\\n\\\n\tvec3 m0 = vec3(0.0); vec3 m1 = vec3(0.0); vec3 m2 = vec3(0.0); vec3 m3 = vec3(0.0);\\n\\\n\tvec3 s0 = vec3(0.0); vec3 s1 = vec3(0.0); vec3 s2 = vec3(0.0); vec3 s3 = vec3(0.0);\\n\\\n\tvec3 c;\\n\\\n\t\\n\\\n\tfor (int j = -radius; j <= 0; ++j)  {\\n\\\n\t\tfor (int i = -radius; i <= 0; ++i)  {\\n\\\n\t\t\tc = texture2D(u_texture, uv + vec2(i,j) * src_size).rgb;\\n\\\n\t\t\tm0 += c;\\n\\\n\t\t\ts0 += c * c;\\n\\\n\t\t}\\n\\\n\t}\\n\\\n\t\\n\\\n\tfor (int j = -radius; j <= 0; ++j)  {\\n\\\n\t\tfor (int i = 0; i <= radius; ++i)  {\\n\\\n\t\t\tc = texture2D(u_texture, uv + vec2(i,j) * src_size).rgb;\\n\\\n\t\t\tm1 += c;\\n\\\n\t\t\ts1 += c * c;\\n\\\n\t\t}\\n\\\n\t}\\n\\\n\t\\n\\\n\tfor (int j = 0; j <= radius; ++j)  {\\n\\\n\t\tfor (int i = 0; i <= radius; ++i)  {\\n\\\n\t\t\tc = texture2D(u_texture, uv + vec2(i,j) * src_size).rgb;\\n\\\n\t\t\tm2 += c;\\n\\\n\t\t\ts2 += c * c;\\n\\\n\t\t}\\n\\\n\t}\\n\\\n\t\\n\\\n\tfor (int j = 0; j <= radius; ++j)  {\\n\\\n\t\tfor (int i = -radius; i <= 0; ++i)  {\\n\\\n\t\t\tc = texture2D(u_texture, uv + vec2(i,j) * src_size).rgb;\\n\\\n\t\t\tm3 += c;\\n\\\n\t\t\ts3 += c * c;\\n\\\n\t\t}\\n\\\n\t}\\n\\\n\t\\n\\\n\tfloat min_sigma2 = 1e+2;\\n\\\n\tm0 /= n;\\n\\\n\ts0 = abs(s0 / n - m0 * m0);\\n\\\n\t\\n\\\n\tfloat sigma2 = s0.r + s0.g + s0.b;\\n\\\n\tif (sigma2 < min_sigma2) {\\n\\\n\t\tmin_sigma2 = sigma2;\\n\\\n\t\tgl_FragColor = vec4(m0, 1.0);\\n\\\n\t}\\n\\\n\t\\n\\\n\tm1 /= n;\\n\\\n\ts1 = abs(s1 / n - m1 * m1);\\n\\\n\t\\n\\\n\tsigma2 = s1.r + s1.g + s1.b;\\n\\\n\tif (sigma2 < min_sigma2) {\\n\\\n\t\tmin_sigma2 = sigma2;\\n\\\n\t\tgl_FragColor = vec4(m1, 1.0);\\n\\\n\t}\\n\\\n\t\\n\\\n\tm2 /= n;\\n\\\n\ts2 = abs(s2 / n - m2 * m2);\\n\\\n\t\\n\\\n\tsigma2 = s2.r + s2.g + s2.b;\\n\\\n\tif (sigma2 < min_sigma2) {\\n\\\n\t\tmin_sigma2 = sigma2;\\n\\\n\t\tgl_FragColor = vec4(m2, 1.0);\\n\\\n\t}\\n\\\n\t\\n\\\n\tm3 /= n;\\n\\\n\ts3 = abs(s3 / n - m3 * m3);\\n\\\n\t\\n\\\n\tsigma2 = s3.r + s3.g + s3.b;\\n\\\n\tif (sigma2 < min_sigma2) {\\n\\\n\t\tmin_sigma2 = sigma2;\\n\\\n\t\tgl_FragColor = vec4(m3, 1.0);\\n\\\n\t}\\n\\\n}\\n\\\n\";\n\n\tLiteGraph.registerNodeType(\n\t\t\"texture/kuwahara\",\n\t\tLGraphTextureKuwaharaFilter\n\t);\n\n\t// Texture  *****************************************\n\tfunction LGraphTextureXDoGFilter() {\n\t\tthis.addInput(\"Texture\", \"Texture\");\n\t\tthis.addOutput(\"Filtered\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tsigma: 1.4,\n\t\t\tk: 1.6,\n\t\t\tp: 21.7,\n\t\t\tepsilon: 79,\n\t\t\tphi: 0.017\n\t\t};\n\t}\n\n\tLGraphTextureXDoGFilter.title = \"XDoG Filter\";\n\tLGraphTextureXDoGFilter.desc =\n\t\t\"Filters a texture giving an artistic ink style\";\n\n\tLGraphTextureXDoGFilter.max_radius = 10;\n\tLGraphTextureXDoGFilter._shaders = [];\n\n\tLGraphTextureXDoGFilter.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar temp = this._temp_texture;\n\t\tif (\n\t\t\t!temp ||\n\t\t\ttemp.width != tex.width ||\n\t\t\ttemp.height != tex.height ||\n\t\t\ttemp.type != tex.type\n\t\t) {\n\t\t\tthis._temp_texture = new GL.Texture(tex.width, tex.height, {\n\t\t\t\ttype: tex.type,\n\t\t\t\tformat: gl.RGBA,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\n\t\tif (!LGraphTextureXDoGFilter._xdog_shader) {\n\t\t\tLGraphTextureXDoGFilter._xdog_shader = new GL.Shader(\n\t\t\t\tShader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureXDoGFilter.xdog_pixel_shader\n\t\t\t);\n\t\t}\n\t\tvar shader = LGraphTextureXDoGFilter._xdog_shader;\n\t\tvar mesh = GL.Mesh.getScreenQuad();\n\n\t\tvar sigma = this.properties.sigma;\n\t\tvar k = this.properties.k;\n\t\tvar p = this.properties.p;\n\t\tvar epsilon = this.properties.epsilon;\n\t\tvar phi = this.properties.phi;\n\t\ttex.bind(0);\n\t\tthis._temp_texture.drawTo(function() {\n\t\t\tshader\n\t\t\t\t.uniforms({\n\t\t\t\t\tsrc: 0,\n\t\t\t\t\tsigma: sigma,\n\t\t\t\t\tk: k,\n\t\t\t\t\tp: p,\n\t\t\t\t\tepsilon: epsilon,\n\t\t\t\t\tphi: phi,\n\t\t\t\t\tcvsWidth: tex.width,\n\t\t\t\t\tcvsHeight: tex.height\n\t\t\t\t})\n\t\t\t\t.draw(mesh);\n\t\t});\n\n\t\tthis.setOutputData(0, this._temp_texture);\n\t};\n\n\t//from https://github.com/RaymondMcGuire/GPU-Based-Image-Processing-Tools/blob/master/lib_webgl/scripts/main.js\n\tLGraphTextureXDoGFilter.xdog_pixel_shader =\n\t\t\"\\n\\\nprecision highp float;\\n\\\nuniform sampler2D src;\\n\\n\\\nuniform float cvsHeight;\\n\\\nuniform float cvsWidth;\\n\\n\\\nuniform float sigma;\\n\\\nuniform float k;\\n\\\nuniform float p;\\n\\\nuniform float epsilon;\\n\\\nuniform float phi;\\n\\\nvarying vec2 v_coord;\\n\\n\\\nfloat cosh(float val)\\n\\\n{\\n\\\n\tfloat tmp = exp(val);\\n\\\n\tfloat cosH = (tmp + 1.0 / tmp) / 2.0;\\n\\\n\treturn cosH;\\n\\\n}\\n\\n\\\nfloat tanh(float val)\\n\\\n{\\n\\\n\tfloat tmp = exp(val);\\n\\\n\tfloat tanH = (tmp - 1.0 / tmp) / (tmp + 1.0 / tmp);\\n\\\n\treturn tanH;\\n\\\n}\\n\\n\\\nfloat sinh(float val)\\n\\\n{\\n\\\n\tfloat tmp = exp(val);\\n\\\n\tfloat sinH = (tmp - 1.0 / tmp) / 2.0;\\n\\\n\treturn sinH;\\n\\\n}\\n\\n\\\nvoid main(void){\\n\\\n\tvec3 destColor = vec3(0.0);\\n\\\n\tfloat tFrag = 1.0 / cvsHeight;\\n\\\n\tfloat sFrag = 1.0 / cvsWidth;\\n\\\n\tvec2 Frag = vec2(sFrag,tFrag);\\n\\\n\tvec2 uv = gl_FragCoord.st;\\n\\\n\tfloat twoSigmaESquared = 2.0 * sigma * sigma;\\n\\\n\tfloat twoSigmaRSquared = twoSigmaESquared * k * k;\\n\\\n\tint halfWidth = int(ceil( 1.0 * sigma * k ));\\n\\n\\\n\tconst int MAX_NUM_ITERATION = 99999;\\n\\\n\tvec2 sum = vec2(0.0);\\n\\\n\tvec2 norm = vec2(0.0);\\n\\n\\\n\tfor(int cnt=0;cnt<MAX_NUM_ITERATION;cnt++){\\n\\\n\t\tif(cnt > (2*halfWidth+1)*(2*halfWidth+1)){break;}\\n\\\n\t\tint i = int(cnt / (2*halfWidth+1)) - halfWidth;\\n\\\n\t\tint j = cnt - halfWidth - int(cnt / (2*halfWidth+1)) * (2*halfWidth+1);\\n\\n\\\n\t\tfloat d = length(vec2(i,j));\\n\\\n\t\tvec2 kernel = vec2( exp( -d * d / twoSigmaESquared ), \\n\\\n\t\t\t\t\t\t\texp( -d * d / twoSigmaRSquared ));\\n\\n\\\n\t\tvec2 L = texture2D(src, (uv + vec2(i,j)) * Frag).xx;\\n\\n\\\n\t\tnorm += kernel;\\n\\\n\t\tsum += kernel * L;\\n\\\n\t}\\n\\n\\\n\tsum /= norm;\\n\\n\\\n\tfloat H = 100.0 * ((1.0 + p) * sum.x - p * sum.y);\\n\\\n\tfloat edge = ( H > epsilon )? 1.0 : 1.0 + tanh( phi * (H - epsilon));\\n\\\n\tdestColor = vec3(edge);\\n\\\n\tgl_FragColor = vec4(destColor, 1.0);\\n\\\n}\";\n\n\tLiteGraph.registerNodeType(\"texture/xDoG\", LGraphTextureXDoGFilter);\n\n\t// Texture Webcam *****************************************\n\tfunction LGraphTextureWebcam() {\n\t\tthis.addOutput(\"Webcam\", \"Texture\");\n\t\tthis.properties = { texture_name: \"\", facingMode: \"user\" };\n\t\tthis.boxcolor = \"black\";\n\t\tthis.version = 0;\n\t}\n\n\tLGraphTextureWebcam.title = \"Webcam\";\n\tLGraphTextureWebcam.desc = \"Webcam texture\";\n\n\tLGraphTextureWebcam.is_webcam_open = false;\n\n\tLGraphTextureWebcam.prototype.openStream = function() {\n\t\tif (!navigator.getUserMedia) {\n\t\t\t//console.log('getUserMedia() is not supported in your browser, use chrome and enable WebRTC from about://flags');\n\t\t\treturn;\n\t\t}\n\n\t\tthis._waiting_confirmation = true;\n\n\t\t// Not showing vendor prefixes.\n\t\tvar constraints = {\n\t\t\taudio: false,\n\t\t\tvideo: { facingMode: this.properties.facingMode }\n\t\t};\n\t\tnavigator.mediaDevices\n\t\t\t.getUserMedia(constraints)\n\t\t\t.then(this.streamReady.bind(this))\n\t\t\t.catch(onFailSoHard);\n\n\t\tvar that = this;\n\t\tfunction onFailSoHard(e) {\n\t\t\tLGraphTextureWebcam.is_webcam_open = false;\n\t\t\tconsole.log(\"Webcam rejected\", e);\n\t\t\tthat._webcam_stream = false;\n\t\t\tthat.boxcolor = \"red\";\n\t\t\tthat.trigger(\"stream_error\");\n\t\t}\n\t};\n\n\tLGraphTextureWebcam.prototype.closeStream = function() {\n\t\tif (this._webcam_stream) {\n\t\t\tvar tracks = this._webcam_stream.getTracks();\n\t\t\tif (tracks.length) {\n\t\t\t\tfor (var i = 0; i < tracks.length; ++i) {\n\t\t\t\t\ttracks[i].stop();\n\t\t\t\t}\n\t\t\t}\n\t\t\tLGraphTextureWebcam.is_webcam_open = false;\n\t\t\tthis._webcam_stream = null;\n\t\t\tthis._video = null;\n\t\t\tthis.boxcolor = \"black\";\n\t\t\tthis.trigger(\"stream_closed\");\n\t\t}\n\t};\n\n\tLGraphTextureWebcam.prototype.streamReady = function(localMediaStream) {\n\t\tthis._webcam_stream = localMediaStream;\n\t\t//this._waiting_confirmation = false;\n\t\tthis.boxcolor = \"green\";\n\t\tvar video = this._video;\n\t\tif (!video) {\n\t\t\tvideo = document.createElement(\"video\");\n\t\t\tvideo.autoplay = true;\n\t\t\tvideo.srcObject = localMediaStream;\n\t\t\tthis._video = video;\n\t\t\t//document.body.appendChild( video ); //debug\n\t\t\t//when video info is loaded (size and so)\n\t\t\tvideo.onloadedmetadata = function(e) {\n\t\t\t\t// Ready to go. Do some stuff.\n\t\t\t\tLGraphTextureWebcam.is_webcam_open = true;\n\t\t\t\tconsole.log(e);\n\t\t\t};\n\t\t}\n\t\tthis.trigger(\"stream_ready\", video);\n\t};\n\n\tLGraphTextureWebcam.prototype.onPropertyChanged = function(\n\t\tname,\n\t\tvalue\n\t) {\n\t\tif (name == \"facingMode\") {\n\t\t\tthis.properties.facingMode = value;\n\t\t\tthis.closeStream();\n\t\t\tthis.openStream();\n\t\t}\n\t};\n\n\tLGraphTextureWebcam.prototype.onRemoved = function() {\n\t\tif (!this._webcam_stream) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar tracks = this._webcam_stream.getTracks();\n\t\tif (tracks.length) {\n\t\t\tfor (var i = 0; i < tracks.length; ++i) {\n\t\t\t\ttracks[i].stop();\n\t\t\t}\n\t\t}\n\n\t\tthis._webcam_stream = null;\n\t\tthis._video = null;\n\t};\n\n\tLGraphTextureWebcam.prototype.onDrawBackground = function(ctx) {\n\t\tif (this.flags.collapsed || this.size[1] <= 20) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._video) {\n\t\t\treturn;\n\t\t}\n\n\t\t//render to graph canvas\n\t\tctx.save();\n\t\tif (!ctx.webgl) {\n\t\t\t//reverse image\n\t\t\tctx.drawImage(this._video, 0, 0, this.size[0], this.size[1]);\n\t\t} else {\n\t\t\tif (this._video_texture) {\n\t\t\t\tctx.drawImage(\n\t\t\t\t\tthis._video_texture,\n\t\t\t\t\t0,\n\t\t\t\t\t0,\n\t\t\t\t\tthis.size[0],\n\t\t\t\t\tthis.size[1]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tctx.restore();\n\t};\n\n\tLGraphTextureWebcam.prototype.onExecute = function() {\n\t\tif (this._webcam_stream == null && !this._waiting_confirmation) {\n\t\t\tthis.openStream();\n\t\t}\n\n\t\tif (!this._video || !this._video.videoWidth) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar width = this._video.videoWidth;\n\t\tvar height = this._video.videoHeight;\n\n\t\tvar temp = this._video_texture;\n\t\tif (!temp || temp.width != width || temp.height != height) {\n\t\t\tthis._video_texture = new GL.Texture(width, height, {\n\t\t\t\tformat: gl.RGB,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\n\t\tthis._video_texture.uploadImage(this._video);\n\t\tthis._video_texture.version = ++this.version;\n\n\t\tif (this.properties.texture_name) {\n\t\t\tvar container = LGraphTexture.getTexturesContainer();\n\t\t\tcontainer[this.properties.texture_name] = this._video_texture;\n\t\t}\n\n\t\tthis.setOutputData(0, this._video_texture);\n\t\tfor (var i = 1; i < this.outputs.length; ++i) {\n\t\t\tif (!this.outputs[i]) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tswitch (this.outputs[i].name) {\n\t\t\t\tcase \"width\":\n\t\t\t\t\tthis.setOutputData(i, this._video.videoWidth);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"height\":\n\t\t\t\t\tthis.setOutputData(i, this._video.videoHeight);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t};\n\n\tLGraphTextureWebcam.prototype.onGetOutputs = function() {\n\t\treturn [\n\t\t\t[\"width\", \"number\"],\n\t\t\t[\"height\", \"number\"],\n\t\t\t[\"stream_ready\", LiteGraph.EVENT],\n\t\t\t[\"stream_closed\", LiteGraph.EVENT],\n\t\t\t[\"stream_error\", LiteGraph.EVENT]\n\t\t];\n\t};\n\n\tLiteGraph.registerNodeType(\"texture/webcam\", LGraphTextureWebcam);\n\n\t//from https://github.com/spite/Wagner\n\tfunction LGraphLensFX() {\n\t\tthis.addInput(\"in\", \"Texture\");\n\t\tthis.addInput(\"f\", \"number\");\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tenabled: true,\n\t\t\tfactor: 1,\n\t\t\tprecision: LGraphTexture.LOW\n\t\t};\n\n\t\tthis._uniforms = { u_texture: 0, u_factor: 1 };\n\t}\n\n\tLGraphLensFX.title = \"Lens FX\";\n\tLGraphLensFX.desc = \"distortion and chromatic aberration\";\n\n\tLGraphLensFX.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphLensFX.prototype.onGetInputs = function() {\n\t\treturn [[\"enabled\", \"boolean\"]];\n\t};\n\n\tLGraphLensFX.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tif (\n\t\t\tthis.properties.precision === LGraphTexture.PASS_THROUGH ||\n\t\t\tthis.getInputOrProperty(\"enabled\") === false\n\t\t) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tvar temp = this._temp_texture;\n\t\tif (\n\t\t\t!temp ||\n\t\t\ttemp.width != tex.width ||\n\t\t\ttemp.height != tex.height ||\n\t\t\ttemp.type != tex.type\n\t\t) {\n\t\t\ttemp = this._temp_texture = new GL.Texture(\n\t\t\t\ttex.width,\n\t\t\t\ttex.height,\n\t\t\t\t{ type: tex.type, format: gl.RGBA, filter: gl.LINEAR }\n\t\t\t);\n\t\t}\n\n\t\tvar shader = LGraphLensFX._shader;\n\t\tif (!shader) {\n\t\t\tshader = LGraphLensFX._shader = new GL.Shader(\n\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphLensFX.pixel_shader\n\t\t\t);\n\t\t}\n\n\t\tvar factor = this.getInputData(1);\n\t\tif (factor == null) {\n\t\t\tfactor = this.properties.factor;\n\t\t}\n\n\t\tvar uniforms = this._uniforms;\n\t\tuniforms.u_factor = factor;\n\n\t\t//apply shader\n\t\tgl.disable(gl.DEPTH_TEST);\n\t\ttemp.drawTo(function() {\n\t\t\ttex.bind(0);\n\t\t\tshader.uniforms(uniforms).draw(GL.Mesh.getScreenQuad());\n\t\t});\n\n\t\tthis.setOutputData(0, temp);\n\t};\n\n\tLGraphLensFX.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform float u_factor;\\n\\\n\t\tvec2 barrelDistortion(vec2 coord, float amt) {\\n\\\n\t\t\tvec2 cc = coord - 0.5;\\n\\\n\t\t\tfloat dist = dot(cc, cc);\\n\\\n\t\t\treturn coord + cc * dist * amt;\\n\\\n\t\t}\\n\\\n\t\t\\n\\\n\t\tfloat sat( float t )\\n\\\n\t\t{\\n\\\n\t\t\treturn clamp( t, 0.0, 1.0 );\\n\\\n\t\t}\\n\\\n\t\t\\n\\\n\t\tfloat linterp( float t ) {\\n\\\n\t\t\treturn sat( 1.0 - abs( 2.0*t - 1.0 ) );\\n\\\n\t\t}\\n\\\n\t\t\\n\\\n\t\tfloat remap( float t, float a, float b ) {\\n\\\n\t\t\treturn sat( (t - a) / (b - a) );\\n\\\n\t\t}\\n\\\n\t\t\\n\\\n\t\tvec4 spectrum_offset( float t ) {\\n\\\n\t\t\tvec4 ret;\\n\\\n\t\t\tfloat lo = step(t,0.5);\\n\\\n\t\t\tfloat hi = 1.0-lo;\\n\\\n\t\t\tfloat w = linterp( remap( t, 1.0/6.0, 5.0/6.0 ) );\\n\\\n\t\t\tret = vec4(lo,1.0,hi, 1.) * vec4(1.0-w, w, 1.0-w, 1.);\\n\\\n\t\t\\n\\\n\t\t\treturn pow( ret, vec4(1.0/2.2) );\\n\\\n\t\t}\\n\\\n\t\t\\n\\\n\t\tconst float max_distort = 2.2;\\n\\\n\t\tconst int num_iter = 12;\\n\\\n\t\tconst float reci_num_iter_f = 1.0 / float(num_iter);\\n\\\n\t\t\\n\\\n\t\tvoid main()\\n\\\n\t\t{\t\\n\\\n\t\t\tvec2 uv=v_coord;\\n\\\n\t\t\tvec4 sumcol = vec4(0.0);\\n\\\n\t\t\tvec4 sumw = vec4(0.0);\t\\n\\\n\t\t\tfor ( int i=0; i<num_iter;++i )\\n\\\n\t\t\t{\\n\\\n\t\t\t\tfloat t = float(i) * reci_num_iter_f;\\n\\\n\t\t\t\tvec4 w = spectrum_offset( t );\\n\\\n\t\t\t\tsumw += w;\\n\\\n\t\t\t\tsumcol += w * texture2D( u_texture, barrelDistortion(uv, .6 * max_distort*t * u_factor ) );\\n\\\n\t\t\t}\\n\\\n\t\t\tgl_FragColor = sumcol / sumw;\\n\\\n\t\t}\";\n\n\tLiteGraph.registerNodeType(\"texture/lensfx\", LGraphLensFX);\n\n\n\tfunction LGraphTextureFromData() {\n\t\tthis.addInput(\"in\", \"\");\n\t\tthis.properties = { precision: LGraphTexture.LOW, width: 0, height: 0, channels: 1 };\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t}\n\n\tLGraphTextureFromData.title = \"Data->Tex\";\n\tLGraphTextureFromData.desc = \"Generates or applies a curve to a texture\";\n\tLGraphTextureFromData.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureFromData.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar data = this.getInputData(0);\n\t\tif(!data)\n\t\t\treturn;\n\n\t\tvar channels = this.properties.channels;\n\t\tvar w = this.properties.width;\n\t\tvar h = this.properties.height;\n\t\tif(!w || !h)\n\t\t{\n\t\t\tw = Math.floor(data.length / channels);\n\t\t\th = 1;\n\t\t}\n\t\tvar format = gl.RGBA;\n\t\tif( channels == 3 )\n\t\t\tformat = gl.RGB;\n\t\telse if( channels == 1 )\n\t\t\tformat = gl.LUMINANCE;\n\n\t\tvar temp = this._temp_texture;\n\t\tvar type = LGraphTexture.getTextureType( this.properties.precision );\n\t\tif ( !temp || temp.width != w || temp.height != h || temp.type != type ) {\n\t\t\ttemp = this._temp_texture = new GL.Texture( w, h, { type: type, format: format, filter: gl.LINEAR } );\n\t\t}\n\n\t\ttemp.uploadData( data );\n\t\tthis.setOutputData(0, temp);\n\t}\n\n\tLiteGraph.registerNodeType(\"texture/fromdata\", LGraphTextureFromData);\n\n\t//applies a curve (or generates one)\n\tfunction LGraphTextureCurve() {\n\t\tthis.addInput(\"in\", \"Texture\");\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.properties = { precision: LGraphTexture.LOW, split_channels: false };\n\t\tthis._values = new Uint8Array(256*4);\n\t\tthis._values.fill(255);\n\t\tthis._curve_texture = null;\n\t\tthis._uniforms = { u_texture: 0, u_curve: 1, u_range: 1.0 };\n\t\tthis._must_update = true;\n\t\tthis._points = {\n\t\t\tRGB: [[0,0],[1,1]],\n\t\t\tR: [[0,0],[1,1]],\n\t\t\tG: [[0,0],[1,1]],\n\t\t\tB: [[0,0],[1,1]]\n\t\t};\n\t\tthis.curve_editor = null;\n\t\tthis.addWidget(\"toggle\",\"Split Channels\",false,\"split_channels\");\n\t\tthis.addWidget(\"combo\",\"Channel\",\"RGB\",{ values:[\"RGB\",\"R\",\"G\",\"B\"]});\n\t\tthis.curve_offset = 68;\n\t\tthis.size = [ 240, 160 ];\n\t}\n\n\tLGraphTextureCurve.title = \"Curve\";\n\tLGraphTextureCurve.desc = \"Generates or applies a curve to a texture\";\n\tLGraphTextureCurve.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureCurve.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar tex = this.getInputData(0);\n\n\t\tvar temp = this._temp_texture;\n\t\tif(!tex) //generate one texture, nothing else\n\t\t{\n\t\t\tif(this._must_update || !this._curve_texture )\n\t\t\t\tthis.updateCurve();\n\t\t\tthis.setOutputData(0, this._curve_texture);\n\t\t\treturn;\n\t\t}\n\n\t\tvar type = LGraphTexture.getTextureType( this.properties.precision, tex );\n\t\t\n\t\t//apply curve to input texture\n\t\tif ( !temp || temp.type != type || temp.width != tex.width || temp.height != tex.height || temp.format != tex.format)\n\t\t\ttemp = this._temp_texture = new GL.Texture( tex.width, tex.height, { type: type, format: tex.format, filter: gl.LINEAR } );\n\n\t\tvar shader = LGraphTextureCurve._shader;\n\t\tif (!shader) {\n\t\t\tshader = LGraphTextureCurve._shader = new GL.Shader( GL.Shader.SCREEN_VERTEX_SHADER, LGraphTextureCurve.pixel_shader );\n\t\t}\n\n\t\tif(this._must_update || !this._curve_texture )\n\t\t\tthis.updateCurve();\n\n\t\tvar uniforms = this._uniforms;\n\t\tvar curve_texture = this._curve_texture;\n\n\t\t//apply shader\n\t\ttemp.drawTo(function() {\n\t\t\tgl.disable(gl.DEPTH_TEST);\n\t\t\ttex.bind(0);\n\t\t\tcurve_texture.bind(1);\n\t\t\tshader.uniforms(uniforms).draw(GL.Mesh.getScreenQuad());\n\t\t});\n\n\t\tthis.setOutputData(0, temp);\n\t}\n\n\tLGraphTextureCurve.prototype.sampleCurve = function(f,points)\n\t{\n\t\tvar points = points || this._points.RGB;\n\t\tif(!points)\n\t\t\treturn;\n\t\tfor(var i = 0; i < points.length - 1; ++i)\n\t\t{\n\t\t\tvar p = points[i];\n\t\t\tvar pn = points[i+1];\n\t\t\tif(pn[0] < f)\n\t\t\t\tcontinue;\n\t\t\tvar r = (pn[0] - p[0]);\n\t\t\tif( Math.abs(r) < 0.00001 )\n\t\t\t\treturn p[1];\n\t\t\tvar local_f = (f - p[0]) / r;\n\t\t\treturn p[1] * (1.0 - local_f) + pn[1] * local_f;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tLGraphTextureCurve.prototype.updateCurve = function()\n\t{\n\t\tvar values = this._values;\n\t\tvar num = values.length / 4;\n\t\tvar split = this.properties.split_channels;\n\t\tfor(var i = 0; i < num; ++i)\n\t\t{\n\t\t\tif(split)\n\t\t\t{\n\t\t\t\tvalues[i*4] = Math.clamp( this.sampleCurve(i/num,this._points.R)*255,0,255);\n\t\t\t\tvalues[i*4+1] = Math.clamp( this.sampleCurve(i/num,this._points.G)*255,0,255);\n\t\t\t\tvalues[i*4+2] = Math.clamp( this.sampleCurve(i/num,this._points.B)*255,0,255);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvar v = this.sampleCurve(i/num);//sample curve\n\t\t\t\tvalues[i*4] = values[i*4+1] = values[i*4+2] = Math.clamp(v*255,0,255);\n\t\t\t}\n\t\t\tvalues[i*4+3] = 255; //alpha fixed\n\t\t}\n\t\tif(!this._curve_texture)\n\t\t\tthis._curve_texture = new GL.Texture(256,1,{ format: gl.RGBA, magFilter: gl.LINEAR, wrap: gl.CLAMP_TO_EDGE });\n\t\tthis._curve_texture.uploadData(values,null,true);\n\t}\n\n\tLGraphTextureCurve.prototype.onSerialize = function(o)\n\t{\n\t\tvar curves = {};\n\t\tfor(var i in this._points)\n\t\t\tcurves[i] = this._points[i].concat();\n\t\to.curves = curves;\n\t}\n\n\tLGraphTextureCurve.prototype.onConfigure = function(o)\n\t{\n\t\tthis._points = o.curves;\n\t\tif(this.curve_editor)\n\t\t\tcurve_editor.points = this._points;\n\t\tthis._must_update = true;\n\t}\n\n\tLGraphTextureCurve.prototype.onMouseDown = function(e, localpos, graphcanvas)\n\t{\n\t\tif(this.curve_editor)\n\t\t{\n\t\t\tvar r = this.curve_editor.onMouseDown([localpos[0],localpos[1]-this.curve_offset], graphcanvas);\n\t\t\tif(r)\n\t\t\t\tthis.captureInput(true);\n\t\t\treturn r;\n\t\t}\n\t}\n\n\tLGraphTextureCurve.prototype.onMouseMove = function(e, localpos, graphcanvas)\n\t{\n\t\tif(this.curve_editor)\n\t\t\treturn this.curve_editor.onMouseMove([localpos[0],localpos[1]-this.curve_offset], graphcanvas);\n\t}\n\n\tLGraphTextureCurve.prototype.onMouseUp = function(e, localpos, graphcanvas)\n\t{\n\t\tif(this.curve_editor)\n\t\t\treturn this.curve_editor.onMouseUp([localpos[0],localpos[1]-this.curve_offset], graphcanvas);\n\t\tthis.captureInput(false);\n\t}\n\n\tLGraphTextureCurve.channel_line_colors = { \"RGB\":\"#666\",\"R\":\"#F33\",\"G\":\"#3F3\",\"B\":\"#33F\" };\n\n\tLGraphTextureCurve.prototype.onDrawBackground = function(ctx, graphcanvas)\n\t{\n\t\tif(this.flags.collapsed)\n\t\t\treturn;\n\n\t\tif(!this.curve_editor)\n\t\t\tthis.curve_editor = new LiteGraph.CurveEditor(this._points.R);\n\t\tctx.save();\n\t\tctx.translate(0,this.curve_offset);\n\t\tvar channel = this.widgets[1].value;\n\n\t\tif(this.properties.split_channels)\n\t\t{\n\t\t\tif(channel == \"RGB\")\n\t\t\t{\n\t\t\t\tthis.widgets[1].value = channel = \"R\";\n\t\t\t\tthis.widgets[1].disabled = false;\n\t\t\t}\n\t\t\tthis.curve_editor.points = this._points.R;\n\t\t\tthis.curve_editor.draw( ctx, [this.size[0],this.size[1] - this.curve_offset], graphcanvas, \"#111\", LGraphTextureCurve.channel_line_colors.R, true );\n\t\t\tctx.globalCompositeOperation = \"lighten\";\n\t\t\tthis.curve_editor.points = this._points.G;\n\t\t\tthis.curve_editor.draw( ctx, [this.size[0],this.size[1] - this.curve_offset], graphcanvas, null, LGraphTextureCurve.channel_line_colors.G, true );\n\t\t\tthis.curve_editor.points = this._points.B;\n\t\t\tthis.curve_editor.draw( ctx, [this.size[0],this.size[1] - this.curve_offset], graphcanvas, null, LGraphTextureCurve.channel_line_colors.B, true );\n\t\t\tctx.globalCompositeOperation = \"source-over\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.widgets[1].value = channel = \"RGB\";\n\t\t\tthis.widgets[1].disabled = true;\n\t\t}\n\n\t\tthis.curve_editor.points = this._points[channel];\n\t\tthis.curve_editor.draw( ctx, [this.size[0],this.size[1] - this.curve_offset], graphcanvas, this.properties.split_channels ? null : \"#111\", LGraphTextureCurve.channel_line_colors[channel]  );\n\t\tctx.restore();\n\t}\n\n\tLGraphTextureCurve.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform sampler2D u_curve;\\n\\\n\t\tuniform float u_range;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec4 color = texture2D( u_texture, v_coord ) * u_range;\\n\\\n\t\t\tcolor.x = texture2D( u_curve, vec2( color.x, 0.5 ) ).x;\\n\\\n\t\t\tcolor.y = texture2D( u_curve, vec2( color.y, 0.5 ) ).y;\\n\\\n\t\t\tcolor.z = texture2D( u_curve, vec2( color.z, 0.5 ) ).z;\\n\\\n\t\t\t//color.w = texture2D( u_curve, vec2( color.w, 0.5 ) ).w;\\n\\\n\t\t\tgl_FragColor = color;\\n\\\n\t\t}\";\n\n\tLiteGraph.registerNodeType(\"texture/curve\", LGraphTextureCurve);\n\n\t//simple exposition, but plan to expand it to support different gamma curves\n\tfunction LGraphExposition() {\n\t\tthis.addInput(\"in\", \"Texture\");\n\t\tthis.addInput(\"exp\", \"number\");\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.properties = { exposition: 1, precision: LGraphTexture.LOW };\n\t\tthis._uniforms = { u_texture: 0, u_exposition: 1 };\n\t}\n\n\tLGraphExposition.title = \"Exposition\";\n\tLGraphExposition.desc = \"Controls texture exposition\";\n\n\tLGraphExposition.widgets_info = {\n\t\texposition: { widget: \"slider\", min: 0, max: 3 },\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphExposition.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar temp = this._temp_texture;\n\t\tif (\n\t\t\t!temp ||\n\t\t\ttemp.width != tex.width ||\n\t\t\ttemp.height != tex.height ||\n\t\t\ttemp.type != tex.type\n\t\t) {\n\t\t\ttemp = this._temp_texture = new GL.Texture(\n\t\t\t\ttex.width,\n\t\t\t\ttex.height,\n\t\t\t\t{ type: tex.type, format: gl.RGBA, filter: gl.LINEAR }\n\t\t\t);\n\t\t}\n\n\t\tvar shader = LGraphExposition._shader;\n\t\tif (!shader) {\n\t\t\tshader = LGraphExposition._shader = new GL.Shader(\n\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphExposition.pixel_shader\n\t\t\t);\n\t\t}\n\n\t\tvar exp = this.properties.exposition;\n\t\tvar exp_input = this.getInputData(1);\n\t\tif (exp_input != null) {\n\t\t\texp = this.properties.exposition = exp_input;\n\t\t}\n\t\tvar uniforms = this._uniforms;\n\n\t\t//apply shader\n\t\ttemp.drawTo(function() {\n\t\t\tgl.disable(gl.DEPTH_TEST);\n\t\t\ttex.bind(0);\n\t\t\tshader.uniforms(uniforms).draw(GL.Mesh.getScreenQuad());\n\t\t});\n\n\t\tthis.setOutputData(0, temp);\n\t};\n\n\tLGraphExposition.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform float u_exposition;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec4 color = texture2D( u_texture, v_coord );\\n\\\n\t\t\tgl_FragColor = vec4( color.xyz * u_exposition, color.a );\\n\\\n\t\t}\";\n\n\tLiteGraph.registerNodeType(\"texture/exposition\", LGraphExposition);\n\n\tfunction LGraphToneMapping() {\n\t\tthis.addInput(\"in\", \"Texture\");\n\t\tthis.addInput(\"avg\", \"number,Texture\");\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tenabled: true,\n\t\t\tscale: 1,\n\t\t\tgamma: 1,\n\t\t\taverage_lum: 1,\n\t\t\tlum_white: 1,\n\t\t\tprecision: LGraphTexture.LOW\n\t\t};\n\n\t\tthis._uniforms = {\n\t\t\tu_texture: 0,\n\t\t\tu_lumwhite2: 1,\n\t\t\tu_igamma: 1,\n\t\t\tu_scale: 1,\n\t\t\tu_average_lum: 1\n\t\t};\n\t}\n\n\tLGraphToneMapping.title = \"Tone Mapping\";\n\tLGraphToneMapping.desc =\n\t\t\"Applies Tone Mapping to convert from high to low\";\n\n\tLGraphToneMapping.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphToneMapping.prototype.onGetInputs = function() {\n\t\treturn [[\"enabled\", \"boolean\"]];\n\t};\n\n\tLGraphToneMapping.prototype.onExecute = function() {\n\t\tvar tex = this.getInputData(0);\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tif (\n\t\t\tthis.properties.precision === LGraphTexture.PASS_THROUGH ||\n\t\t\tthis.getInputOrProperty(\"enabled\") === false\n\t\t) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tvar temp = this._temp_texture;\n\n\t\tif (\n\t\t\t!temp ||\n\t\t\ttemp.width != tex.width ||\n\t\t\ttemp.height != tex.height ||\n\t\t\ttemp.type != tex.type\n\t\t) {\n\t\t\ttemp = this._temp_texture = new GL.Texture(\n\t\t\t\ttex.width,\n\t\t\t\ttex.height,\n\t\t\t\t{ type: tex.type, format: gl.RGBA, filter: gl.LINEAR }\n\t\t\t);\n\t\t}\n\n\t\tvar avg = this.getInputData(1);\n\t\tif (avg == null) {\n\t\t\tavg = this.properties.average_lum;\n\t\t}\n\n\t\tvar uniforms = this._uniforms;\n\t\tvar shader = null;\n\n\t\tif (avg.constructor === Number) {\n\t\t\tthis.properties.average_lum = avg;\n\t\t\tuniforms.u_average_lum = this.properties.average_lum;\n\t\t\tshader = LGraphToneMapping._shader;\n\t\t\tif (!shader) {\n\t\t\t\tshader = LGraphToneMapping._shader = new GL.Shader(\n\t\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\t\tLGraphToneMapping.pixel_shader\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (avg.constructor === GL.Texture) {\n\t\t\tuniforms.u_average_texture = avg.bind(1);\n\t\t\tshader = LGraphToneMapping._shader_texture;\n\t\t\tif (!shader) {\n\t\t\t\tshader = LGraphToneMapping._shader_texture = new GL.Shader(\n\t\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\t\tLGraphToneMapping.pixel_shader,\n\t\t\t\t\t{ AVG_TEXTURE: \"\" }\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tuniforms.u_lumwhite2 =\n\t\t\tthis.properties.lum_white * this.properties.lum_white;\n\t\tuniforms.u_scale = this.properties.scale;\n\t\tuniforms.u_igamma = 1 / this.properties.gamma;\n\n\t\t//apply shader\n\t\tgl.disable(gl.DEPTH_TEST);\n\t\ttemp.drawTo(function() {\n\t\t\ttex.bind(0);\n\t\t\tshader.uniforms(uniforms).draw(GL.Mesh.getScreenQuad());\n\t\t});\n\n\t\tthis.setOutputData(0, this._temp_texture);\n\t};\n\n\tLGraphToneMapping.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform float u_scale;\\n\\\n\t\t#ifdef AVG_TEXTURE\\n\\\n\t\t\tuniform sampler2D u_average_texture;\\n\\\n\t\t#else\\n\\\n\t\t\tuniform float u_average_lum;\\n\\\n\t\t#endif\\n\\\n\t\tuniform float u_lumwhite2;\\n\\\n\t\tuniform float u_igamma;\\n\\\n\t\tvec3 RGB2xyY (vec3 rgb)\\n\\\n\t\t{\\n\\\n\t\t\t const mat3 RGB2XYZ = mat3(0.4124, 0.3576, 0.1805,\\n\\\n\t\t\t\t\t\t\t\t\t   0.2126, 0.7152, 0.0722,\\n\\\n\t\t\t\t\t\t\t\t\t   0.0193, 0.1192, 0.9505);\\n\\\n\t\t\tvec3 XYZ = RGB2XYZ * rgb;\\n\\\n\t\t\t\\n\\\n\t\t\tfloat f = (XYZ.x + XYZ.y + XYZ.z);\\n\\\n\t\t\treturn vec3(XYZ.x / f,\\n\\\n\t\t\t\t\t\tXYZ.y / f,\\n\\\n\t\t\t\t\t\tXYZ.y);\\n\\\n\t\t}\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec4 color = texture2D( u_texture, v_coord );\\n\\\n\t\t\tvec3 rgb = color.xyz;\\n\\\n\t\t\tfloat average_lum = 0.0;\\n\\\n\t\t\t#ifdef AVG_TEXTURE\\n\\\n\t\t\t\tvec3 pixel = texture2D(u_average_texture,vec2(0.5)).xyz;\\n\\\n\t\t\t\taverage_lum = (pixel.x + pixel.y + pixel.z) / 3.0;\\n\\\n\t\t\t#else\\n\\\n\t\t\t\taverage_lum = u_average_lum;\\n\\\n\t\t\t#endif\\n\\\n\t\t\t//Ld - this part of the code is the same for both versions\\n\\\n\t\t\tfloat lum = dot(rgb, vec3(0.2126, 0.7152, 0.0722));\\n\\\n\t\t\tfloat L = (u_scale / average_lum) * lum;\\n\\\n\t\t\tfloat Ld = (L * (1.0 + L / u_lumwhite2)) / (1.0 + L);\\n\\\n\t\t\t//first\\n\\\n\t\t\t//vec3 xyY = RGB2xyY(rgb);\\n\\\n\t\t\t//xyY.z *= Ld;\\n\\\n\t\t\t//rgb = xyYtoRGB(xyY);\\n\\\n\t\t\t//second\\n\\\n\t\t\trgb = (rgb / lum) * Ld;\\n\\\n\t\t\trgb = max(rgb,vec3(0.001));\\n\\\n\t\t\trgb = pow( rgb, vec3( u_igamma ) );\\n\\\n\t\t\tgl_FragColor = vec4( rgb, color.a );\\n\\\n\t\t}\";\n\n\tLiteGraph.registerNodeType(\"texture/tonemapping\", LGraphToneMapping);\n\n\tfunction LGraphTexturePerlin() {\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.properties = {\n\t\t\twidth: 512,\n\t\t\theight: 512,\n\t\t\tseed: 0,\n\t\t\tpersistence: 0.1,\n\t\t\toctaves: 8,\n\t\t\tscale: 1,\n\t\t\toffset: [0, 0],\n\t\t\tamplitude: 1,\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\t\tthis._key = 0;\n\t\tthis._texture = null;\n\t\tthis._uniforms = {\n\t\t\tu_persistence: 0.1,\n\t\t\tu_seed: 0,\n\t\t\tu_offset: vec2.create(),\n\t\t\tu_scale: 1,\n\t\t\tu_viewport: vec2.create()\n\t\t};\n\t}\n\n\tLGraphTexturePerlin.title = \"Perlin\";\n\tLGraphTexturePerlin.desc = \"Generates a perlin noise texture\";\n\n\tLGraphTexturePerlin.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES },\n\t\twidth: { type: \"number\", precision: 0, step: 1 },\n\t\theight: { type: \"number\", precision: 0, step: 1 },\n\t\toctaves: { type: \"number\", precision: 0, step: 1, min: 1, max: 50 }\n\t};\n\n\tLGraphTexturePerlin.prototype.onGetInputs = function() {\n\t\treturn [\n\t\t\t[\"seed\", \"number\"],\n\t\t\t[\"persistence\", \"number\"],\n\t\t\t[\"octaves\", \"number\"],\n\t\t\t[\"scale\", \"number\"],\n\t\t\t[\"amplitude\", \"number\"],\n\t\t\t[\"offset\", \"vec2\"]\n\t\t];\n\t};\n\n\tLGraphTexturePerlin.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar w = this.properties.width | 0;\n\t\tvar h = this.properties.height | 0;\n\t\tif (w == 0) {\n\t\t\tw = gl.viewport_data[2];\n\t\t} //0 means default\n\t\tif (h == 0) {\n\t\t\th = gl.viewport_data[3];\n\t\t} //0 means default\n\t\tvar type = LGraphTexture.getTextureType(this.properties.precision);\n\n\t\tvar temp = this._texture;\n\t\tif (\n\t\t\t!temp ||\n\t\t\ttemp.width != w ||\n\t\t\ttemp.height != h ||\n\t\t\ttemp.type != type\n\t\t) {\n\t\t\ttemp = this._texture = new GL.Texture(w, h, {\n\t\t\t\ttype: type,\n\t\t\t\tformat: gl.RGB,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\n\t\tvar persistence = this.getInputOrProperty(\"persistence\");\n\t\tvar octaves = this.getInputOrProperty(\"octaves\");\n\t\tvar offset = this.getInputOrProperty(\"offset\");\n\t\tvar scale = this.getInputOrProperty(\"scale\");\n\t\tvar amplitude = this.getInputOrProperty(\"amplitude\");\n\t\tvar seed = this.getInputOrProperty(\"seed\");\n\n\t\t//reusing old texture\n\t\tvar key =\n\t\t\t\"\" +\n\t\t\tw +\n\t\t\th +\n\t\t\ttype +\n\t\t\tpersistence +\n\t\t\toctaves +\n\t\t\tscale +\n\t\t\tseed +\n\t\t\toffset[0] +\n\t\t\toffset[1] +\n\t\t\tamplitude;\n\t\tif (key == this._key) {\n\t\t\tthis.setOutputData(0, temp);\n\t\t\treturn;\n\t\t}\n\t\tthis._key = key;\n\n\t\t//gather uniforms\n\t\tvar uniforms = this._uniforms;\n\t\tuniforms.u_persistence = persistence;\n\t\tuniforms.u_octaves = octaves;\n\t\tuniforms.u_offset.set(offset);\n\t\tuniforms.u_scale = scale;\n\t\tuniforms.u_amplitude = amplitude;\n\t\tuniforms.u_seed = seed * 128;\n\t\tuniforms.u_viewport[0] = w;\n\t\tuniforms.u_viewport[1] = h;\n\n\t\t//render\n\t\tvar shader = LGraphTexturePerlin._shader;\n\t\tif (!shader) {\n\t\t\tshader = LGraphTexturePerlin._shader = new GL.Shader(\n\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTexturePerlin.pixel_shader\n\t\t\t);\n\t\t}\n\n\t\tgl.disable(gl.BLEND);\n\t\tgl.disable(gl.DEPTH_TEST);\n\n\t\ttemp.drawTo(function() {\n\t\t\tshader.uniforms(uniforms).draw(GL.Mesh.getScreenQuad());\n\t\t});\n\n\t\tthis.setOutputData(0, temp);\n\t};\n\n\tLGraphTexturePerlin.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform vec2 u_offset;\\n\\\n\t\tuniform float u_scale;\\n\\\n\t\tuniform float u_persistence;\\n\\\n\t\tuniform int u_octaves;\\n\\\n\t\tuniform float u_amplitude;\\n\\\n\t\tuniform vec2 u_viewport;\\n\\\n\t\tuniform float u_seed;\\n\\\n\t\t#define M_PI 3.14159265358979323846\\n\\\n\t\t\\n\\\n\t\tfloat rand(vec2 c){\treturn fract(sin(dot(c.xy ,vec2( 12.9898 + u_seed,78.233 + u_seed))) * 43758.5453); }\\n\\\n\t\t\\n\\\n\t\tfloat noise(vec2 p, float freq ){\\n\\\n\t\t\tfloat unit = u_viewport.x/freq;\\n\\\n\t\t\tvec2 ij = floor(p/unit);\\n\\\n\t\t\tvec2 xy = mod(p,unit)/unit;\\n\\\n\t\t\t//xy = 3.*xy*xy-2.*xy*xy*xy;\\n\\\n\t\t\txy = .5*(1.-cos(M_PI*xy));\\n\\\n\t\t\tfloat a = rand((ij+vec2(0.,0.)));\\n\\\n\t\t\tfloat b = rand((ij+vec2(1.,0.)));\\n\\\n\t\t\tfloat c = rand((ij+vec2(0.,1.)));\\n\\\n\t\t\tfloat d = rand((ij+vec2(1.,1.)));\\n\\\n\t\t\tfloat x1 = mix(a, b, xy.x);\\n\\\n\t\t\tfloat x2 = mix(c, d, xy.x);\\n\\\n\t\t\treturn mix(x1, x2, xy.y);\\n\\\n\t\t}\\n\\\n\t\t\\n\\\n\t\tfloat pNoise(vec2 p, int res){\\n\\\n\t\t\tfloat persistance = u_persistence;\\n\\\n\t\t\tfloat n = 0.;\\n\\\n\t\t\tfloat normK = 0.;\\n\\\n\t\t\tfloat f = 4.;\\n\\\n\t\t\tfloat amp = 1.0;\\n\\\n\t\t\tint iCount = 0;\\n\\\n\t\t\tfor (int i = 0; i<50; i++){\\n\\\n\t\t\t\tn+=amp*noise(p, f);\\n\\\n\t\t\t\tf*=2.;\\n\\\n\t\t\t\tnormK+=amp;\\n\\\n\t\t\t\tamp*=persistance;\\n\\\n\t\t\t\tif (iCount >= res)\\n\\\n\t\t\t\t\tbreak;\\n\\\n\t\t\t\tiCount++;\\n\\\n\t\t\t}\\n\\\n\t\t\tfloat nf = n/normK;\\n\\\n\t\t\treturn nf*nf*nf*nf;\\n\\\n\t\t}\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec2 uv = v_coord * u_scale * u_viewport + u_offset * u_scale;\\n\\\n\t\t\tvec4 color = vec4( pNoise( uv, u_octaves ) * u_amplitude );\\n\\\n\t\t\tgl_FragColor = color;\\n\\\n\t\t}\";\n\n\tLiteGraph.registerNodeType(\"texture/perlin\", LGraphTexturePerlin);\n\n\tfunction LGraphTextureCanvas2D() {\n\t\tthis.addInput(\"v\");\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tcode: LGraphTextureCanvas2D.default_code,\n\t\t\twidth: 512,\n\t\t\theight: 512,\n\t\t\tclear: true,\n\t\t\tprecision: LGraphTexture.DEFAULT,\n\t\t\tuse_html_canvas: false\n\t\t};\n\t\tthis._func = null;\n\t\tthis._temp_texture = null;\n\t\tthis.compileCode();\n\t}\n\n\tLGraphTextureCanvas2D.title = \"Canvas2D\";\n\tLGraphTextureCanvas2D.desc = \"Executes Canvas2D code inside a texture or the viewport.\";\n\tLGraphTextureCanvas2D.help = \"Set width and height to 0 to match viewport size.\";\n\n\tLGraphTextureCanvas2D.default_code = \"//vars: canvas,ctx,time\\nctx.fillStyle='red';\\nctx.fillRect(0,0,50,50);\\n\";\n\n\tLGraphTextureCanvas2D.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES },\n\t\tcode: { type: \"code\" },\n\t\twidth: { type: \"number\", precision: 0, step: 1 },\n\t\theight: { type: \"number\", precision: 0, step: 1 }\n\t};\n\n\tLGraphTextureCanvas2D.prototype.onPropertyChanged = function( name, value ) {\n\t\tif (name == \"code\" )\n\t\t\tthis.compileCode( value );\n\t}\n\t\n\tLGraphTextureCanvas2D.prototype.compileCode = function( code ) {\n\t\tthis._func = null;\n\t\tif( !LiteGraph.allow_scripts )\n\t\t\treturn;\n\n\t\ttry {\n\t\t\tthis._func = new Function( \"canvas\", \"ctx\", \"time\", \"script\",\"v\", code );\n\t\t\tthis.boxcolor = \"#00FF00\";\n\t\t} catch (err) {\n\t\t\tthis.boxcolor = \"#FF0000\";\n\t\t\tconsole.error(\"Error parsing script\");\n\t\t\tconsole.error(err);\n\t\t}\n\t};\n\n\tLGraphTextureCanvas2D.prototype.onExecute = function() {\n\t\tvar func = this._func;\n\t\tif (!func || !this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t}\n\t\tthis.executeDraw( func );\n\t}\n\n\tLGraphTextureCanvas2D.prototype.executeDraw = function( func_context ) {\n\n\t\tvar width = this.properties.width || gl.canvas.width;\n\t\tvar height = this.properties.height || gl.canvas.height;\n\t\tvar temp = this._temp_texture;\n\t\tvar type = LGraphTexture.getTextureType( this.properties.precision );\n\t\tif (!temp || temp.width != width || temp.height != height || temp.type != type ) {\n\t\t\ttemp = this._temp_texture = new GL.Texture(width, height, {\n\t\t\t\tformat: gl.RGBA,\n\t\t\t\tfilter: gl.LINEAR,\n\t\t\t\ttype: type\n\t\t\t});\n\t\t}\n\n\t\tvar v = this.getInputData(0);\n\n\t\tvar properties = this.properties;\n\t\tvar that = this;\n\t\tvar time = this.graph.getTime();\n\t\tvar ctx = gl;\n\t\tvar canvas = gl.canvas;\n\t\tif( this.properties.use_html_canvas || !global.enableWebGLCanvas )\n\t\t{\n\t\t\tif(!this._canvas)\n\t\t\t{\n\t\t\t\tcanvas = this._canvas = createCanvas(width.height);\n\t\t\t\tctx = this._ctx = canvas.getContext(\"2d\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcanvas = this._canvas;\n\t\t\t\tctx = this._ctx;\n\t\t\t}\n\t\t\tcanvas.width = width;\n\t\t\tcanvas.height = height;\n\t\t}\n\n\t\tif(ctx == gl) //using Canvas2DtoWebGL\n\t\t\ttemp.drawTo(function() {\n\t\t\t\tgl.start2D();\n\t\t\t\tif(properties.clear)\n\t\t\t\t{\n\t\t\t\t\tgl.clearColor(0,0,0,0);\n\t\t\t\t\tgl.clear( gl.COLOR_BUFFER_BIT );\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tif (func_context.draw) {\n\t\t\t\t\t\tfunc_context.draw.call(that, canvas, ctx, time, func_context, v);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfunc_context.call(that, canvas, ctx, time, func_context,v);\n\t\t\t\t\t}\n\t\t\t\t\tthat.boxcolor = \"#00FF00\";\n\t\t\t\t} catch (err) {\n\t\t\t\t\tthat.boxcolor = \"#FF0000\";\n\t\t\t\t\tconsole.error(\"Error executing script\");\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t}\n\t\t\t\tgl.finish2D();\n\t\t\t});\n\t\telse //rendering to offscren canvas and uploading to texture\n\t\t{\n\t\t\tif(properties.clear)\n\t\t\t\tctx.clearRect(0,0,canvas.width,canvas.height);\n\n\t\t\ttry {\n\t\t\t\tif (func_context.draw) {\n\t\t\t\t\tfunc_context.draw.call(this, canvas, ctx, time, func_context, v);\n\t\t\t\t} else {\n\t\t\t\t\tfunc_context.call(this, canvas, ctx, time, func_context,v);\n\t\t\t\t}\n\t\t\t\tthis.boxcolor = \"#00FF00\";\n\t\t\t} catch (err) {\n\t\t\t\tthis.boxcolor = \"#FF0000\";\n\t\t\t\tconsole.error(\"Error executing script\");\n\t\t\t\tconsole.error(err);\n\t\t\t}\n\t\t\ttemp.uploadImage( canvas );\n\t\t}\n\n\t\tthis.setOutputData(0, temp);\n\t};\n\n\tLiteGraph.registerNodeType(\"texture/canvas2D\", LGraphTextureCanvas2D);\n\n\t// To do chroma keying *****************\n\n\tfunction LGraphTextureMatte() {\n\t\tthis.addInput(\"in\", \"Texture\");\n\n\t\tthis.addOutput(\"out\", \"Texture\");\n\t\tthis.properties = {\n\t\t\tkey_color: vec3.fromValues(0, 1, 0),\n\t\t\tthreshold: 0.8,\n\t\t\tslope: 0.2,\n\t\t\tprecision: LGraphTexture.DEFAULT\n\t\t};\n\t}\n\n\tLGraphTextureMatte.title = \"Matte\";\n\tLGraphTextureMatte.desc = \"Extracts background\";\n\n\tLGraphTextureMatte.widgets_info = {\n\t\tkey_color: { widget: \"color\" },\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphTextureMatte.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0)) {\n\t\t\treturn;\n\t\t} //saves work\n\n\t\tvar tex = this.getInputData(0);\n\n\t\tif (this.properties.precision === LGraphTexture.PASS_THROUGH) {\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!tex) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._tex = LGraphTexture.getTargetTexture(\n\t\t\ttex,\n\t\t\tthis._tex,\n\t\t\tthis.properties.precision\n\t\t);\n\n\t\tgl.disable(gl.BLEND);\n\t\tgl.disable(gl.DEPTH_TEST);\n\n\t\tif (!this._uniforms) {\n\t\t\tthis._uniforms = {\n\t\t\t\tu_texture: 0,\n\t\t\t\tu_key_color: this.properties.key_color,\n\t\t\t\tu_threshold: 1,\n\t\t\t\tu_slope: 1\n\t\t\t};\n\t\t}\n\t\tvar uniforms = this._uniforms;\n\n\t\tvar mesh = Mesh.getScreenQuad();\n\t\tvar shader = LGraphTextureMatte._shader;\n\t\tif (!shader) {\n\t\t\tshader = LGraphTextureMatte._shader = new GL.Shader(\n\t\t\t\tGL.Shader.SCREEN_VERTEX_SHADER,\n\t\t\t\tLGraphTextureMatte.pixel_shader\n\t\t\t);\n\t\t}\n\n\t\tuniforms.u_key_color = this.properties.key_color;\n\t\tuniforms.u_threshold = this.properties.threshold;\n\t\tuniforms.u_slope = this.properties.slope;\n\n\t\tthis._tex.drawTo(function() {\n\t\t\ttex.bind(0);\n\t\t\tshader.uniforms(uniforms).draw(mesh);\n\t\t});\n\n\t\tthis.setOutputData(0, this._tex);\n\t};\n\n\tLGraphTextureMatte.pixel_shader =\n\t\t\"precision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tuniform vec3 u_key_color;\\n\\\n\t\tuniform float u_threshold;\\n\\\n\t\tuniform float u_slope;\\n\\\n\t\t\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec3 color = texture2D( u_texture, v_coord ).xyz;\\n\\\n\t\t\tfloat diff = length( normalize(color) - normalize(u_key_color) );\\n\\\n\t\t\tfloat edge = u_threshold * (1.0 - u_slope);\\n\\\n\t\t\tfloat alpha = smoothstep( edge, u_threshold, diff);\\n\\\n\t\t\tgl_FragColor = vec4( color, alpha );\\n\\\n\t\t}\";\n\n\tLiteGraph.registerNodeType(\"texture/matte\", LGraphTextureMatte);\n\n\t//***********************************\n\tfunction LGraphCubemapToTexture2D() {\n\t\tthis.addInput(\"in\", \"texture\");\n\t\tthis.addInput(\"yaw\", \"number\");\n\t\tthis.addOutput(\"out\", \"texture\");\n\t\tthis.properties = { yaw: 0 };\n\t}\n\n\tLGraphCubemapToTexture2D.title = \"CubemapToTexture2D\";\n\tLGraphCubemapToTexture2D.desc = \"Transforms a CUBEMAP texture into a TEXTURE2D in Polar Representation\";\n\n\tLGraphCubemapToTexture2D.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0))\n\t\t\treturn;\n\n\t\tvar tex = this.getInputData(0);\n\t\tif ( !tex || tex.texture_type != GL.TEXTURE_CUBE_MAP )\n\t\t\treturn;\n\t\tif( this._last_tex && ( this._last_tex.height != tex.height || this._last_tex.type != tex.type ))\n\t\t\tthis._last_tex = null;\n\t\tvar yaw = this.getInputOrProperty(\"yaw\");\n\t\tthis._last_tex = GL.Texture.cubemapToTexture2D( tex, tex.height, this._last_tex, true, yaw );\n\t\tthis.setOutputData( 0, this._last_tex );\n\t};\n\n\tLiteGraph.registerNodeType( \"texture/cubemapToTexture2D\", LGraphCubemapToTexture2D );\n})(this);\n\n(function(global) {\n\n    if (typeof GL == \"undefined\")\n\t\treturn;\n\n    var LiteGraph = global.LiteGraph;\n\tvar LGraphCanvas = global.LGraphCanvas;\n\n\tvar SHADERNODES_COLOR = \"#345\";\n\n\tvar LGShaders = LiteGraph.Shaders = {};\n\n\tvar GLSL_types = LGShaders.GLSL_types = [\"float\",\"vec2\",\"vec3\",\"vec4\",\"mat3\",\"mat4\",\"sampler2D\",\"samplerCube\"];\n\tvar GLSL_types_const = LGShaders.GLSL_types_const = [\"float\",\"vec2\",\"vec3\",\"vec4\"];\n\n\tvar GLSL_functions_desc = {\n\t\t\"radians\": \"T radians(T degrees)\",\n\t\t\"degrees\": \"T degrees(T radians)\",\n\t\t\"sin\": \"T sin(T angle)\",\n\t\t\"cos\": \"T cos(T angle)\",\n\t\t\"tan\": \"T tan(T angle)\",\n\t\t\"asin\": \"T asin(T x)\",\n\t\t\"acos\": \"T acos(T x)\",\n\t\t\"atan\": \"T atan(T x)\",\n\t\t\"atan2\": \"T atan(T x,T y)\",\n\t\t\"pow\": \"T pow(T x,T y)\",\n\t\t\"exp\": \"T exp(T x)\",\n\t\t\"log\": \"T log(T x)\",\n\t\t\"exp2\": \"T exp2(T x)\",\n\t\t\"log2\": \"T log2(T x)\",\n\t\t\"sqrt\": \"T sqrt(T x)\",\n\t\t\"inversesqrt\": \"T inversesqrt(T x)\",\n\t\t\"abs\": \"T abs(T x)\",\n\t\t\"sign\": \"T sign(T x)\",\n\t\t\"floor\": \"T floor(T x)\",\n\t\t\"round\": \"T round(T x)\",\n\t\t\"ceil\": \"T ceil(T x)\",\n\t\t\"fract\": \"T fract(T x)\",\n\t\t\"mod\": \"T mod(T x,T y)\", //\"T mod(T x,float y)\"\n\t\t\"min\": \"T min(T x,T y)\",\n\t\t\"max\": \"T max(T x,T y)\",\n\t\t\"clamp\": \"T clamp(T x,T minVal = 0.0,T maxVal = 1.0)\",\n\t\t\"mix\": \"T mix(T x,T y,T a)\", //\"T mix(T x,T y,float a)\"\n\t\t\"step\": \"T step(T edge, T edge2, T x)\", //\"T step(float edge, T x)\"\n\t\t\"smoothstep\": \"T smoothstep(T edge, T edge2, T x)\", //\"T smoothstep(float edge, T x)\"\n\t\t\"length\":\"float length(T x)\",\n\t\t\"distance\":\"float distance(T p0, T p1)\",\n\t\t\"normalize\":\"T normalize(T x)\",\n\t\t\"dot\": \"float dot(T x,T y)\",\n\t\t\"cross\": \"vec3 cross(vec3 x,vec3 y)\",\n\t\t\"reflect\": \"vec3 reflect(vec3 V,vec3 N)\",\n\t\t\"refract\": \"vec3 refract(vec3 V,vec3 N, float IOR)\"\n\t};\n\n\t//parse them\n\tvar GLSL_functions = {};\n\tvar GLSL_functions_name = [];\n\tparseGLSLDescriptions();\n\n\tLGShaders.ALL_TYPES = \"float,vec2,vec3,vec4\";\n\n\tfunction parseGLSLDescriptions()\n\t{\n\t\tGLSL_functions_name.length = 0;\n\n\t\tfor(var i in GLSL_functions_desc)\n\t\t{\n\t\t\tvar op = GLSL_functions_desc[i];\n\t\t\tvar index = op.indexOf(\" \");\n\t\t\tvar return_type = op.substr(0,index);\n\t\t\tvar index2 = op.indexOf(\"(\",index);\n\t\t\tvar func_name = op.substr(index,index2-index).trim();\n\t\t\tvar params = op.substr(index2 + 1, op.length - index2 - 2).split(\",\");\n\t\t\tfor(var j in params)\n\t\t\t{\n\t\t\t\tvar p = params[j].split(\" \").filter(function(a){ return a; });\n\t\t\t\tparams[j] = { type: p[0].trim(), name: p[1].trim() };\n\t\t\t\tif(p[2] == \"=\")\n\t\t\t\t\tparams[j].value = p[3].trim();\n\t\t\t}\n\t\t\tGLSL_functions[i] = { return_type: return_type, func: func_name, params: params };\n\t\t\tGLSL_functions_name.push( func_name );\n\t\t\t//console.log( GLSL_functions[i] );\n\t\t}\n\t}\n\n\t//common actions to all shader node classes\n\tfunction registerShaderNode( type, node_ctor )\n\t{\n\t\t//static attributes\n\t\tnode_ctor.color = SHADERNODES_COLOR;\n\t\tnode_ctor.filter = \"shader\";\n\n\t\t//common methods\n\t\tnode_ctor.prototype.clearDestination = function(){ this.shader_destination = {};  }\n\t\tnode_ctor.prototype.propagateDestination = function propagateDestination( dest_name )\n\t\t{\n\t\t\tthis.shader_destination[ dest_name ] = true;\n\t\t\tif(this.inputs)\n\t\t\tfor(var i = 0; i < this.inputs.length; ++i)\n\t\t\t{\n\t\t\t\tvar origin_node = this.getInputNode(i);\n\t\t\t\tif(origin_node)\n\t\t\t\t\torigin_node.propagateDestination( dest_name );\n\t\t\t}\n\t\t}\n\t\tif(!node_ctor.prototype.onPropertyChanged)\n\t\t\tnode_ctor.prototype.onPropertyChanged = function()\n\t\t\t{\n\t\t\t\tif(this.graph)\n\t\t\t\t\t this.graph._version++;\n\t\t\t}\n\n\t\t/*\n\t\tif(!node_ctor.prototype.onGetCode)\n\t\t\tnode_ctor.prototype.onGetCode = function()\n\t\t\t{\n\t\t\t\t//check destination to avoid lonely nodes\n\t\t\t\tif(!this.shader_destination)\n\t\t\t\t\treturn;\n\t\t\t\t//grab inputs with types\n\t\t\t\tvar inputs = [];\n\t\t\t\tif(this.inputs)\n\t\t\t\tfor(var i = 0; i < this.inputs.length; ++i)\n\t\t\t\t\tinputs.push({ type: this.getInputData(i), name: getInputLinkID(this,i) });\n\t\t\t\tvar outputs = [];\n\t\t\t\tif(this.outputs)\n\t\t\t\tfor(var i = 0; i < this.outputs.length; ++i)\n\t\t\t\t\toutputs.push({ name: getOutputLinkID(this,i) });\n\t\t\t\t//pass to code func\n\t\t\t\tvar results = this.extractCode(inputs);\n\t\t\t\t//grab output, pass to next\n\t\t\t\tif(results)\n\t\t\t\tfor(var i = 0; i < results.length; ++i)\n\t\t\t\t{\n\t\t\t\t\tvar r = results[i];\n\t\t\t\t\tif(!r)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tthis.setOutputData(i,r.value);\n\t\t\t\t}\n\t\t\t}\n\t\t*/\n\n\t\tLiteGraph.registerNodeType( \"shader::\" + type, node_ctor );\n\t}\n\n\tfunction getShaderNodeVarName( node, name )\n\t{\n\t\treturn \"VAR_\" + (name || \"TEMP\") + \"_\" + node.id;\n\t}\n\n\tfunction getInputLinkID( node, slot )\n\t{\n\t\tif(!node.inputs)\n\t\t\treturn null;\n\t\tvar link = node.getInputLink( slot );\n\t\tif( !link )\n\t\t\treturn null;\n\t\tvar origin_node = node.graph.getNodeById( link.origin_id );\n\t\tif( !origin_node )\n\t\t\treturn null;\n\t\tif(origin_node.getOutputVarName)\n\t\t\treturn origin_node.getOutputVarName(link.origin_slot);\n\t\t//generate\n\t\treturn \"link_\" + origin_node.id + \"_\" + link.origin_slot;\n\t}\n\n\tfunction getOutputLinkID( node, slot )\n\t{\n\t\tif (!node.isOutputConnected(slot))\n\t\t\treturn null;\n\t\treturn \"link_\" + node.id + \"_\" + slot;\n\t}\n\n\tLGShaders.registerShaderNode = registerShaderNode;\n\tLGShaders.getInputLinkID = getInputLinkID;\n\tLGShaders.getOutputLinkID = getOutputLinkID;\n\tLGShaders.getShaderNodeVarName = getShaderNodeVarName;\n\tLGShaders.parseGLSLDescriptions = parseGLSLDescriptions;\n\n\t//given a const number, it transform it to a string that matches a type\n\tvar valueToGLSL = LiteGraph.valueToGLSL = function valueToGLSL( v, type, precision )\n\t{\n\t\tvar n = 5; //num decimals\n\t\tif(precision != null)\n\t\t\tn = precision;\n\t\tif(!type)\n\t\t{\n\t\t\tif(v.constructor === Number)\n\t\t\t\ttype = \"float\";\n\t\t\telse if(v.length)\n\t\t\t{\n\t\t\t\tswitch(v.length)\n\t\t\t\t{\n\t\t\t\t\tcase 2: type = \"vec2\"; break;\n\t\t\t\t\tcase 3: type = \"vec3\"; break;\n\t\t\t\t\tcase 4: type = \"vec4\"; break;\n\t\t\t\t\tcase 9: type = \"mat3\"; break;\n\t\t\t\t\tcase 16: type = \"mat4\"; break;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow(\"unknown type for glsl value size\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tthrow(\"unknown type for glsl value: \" + v.constructor);\n\t\t}\n\t\tswitch(type)\n\t\t{\n\t\t\tcase 'float': return v.toFixed(n); break;\n\t\t\tcase 'vec2': return \"vec2(\" + v[0].toFixed(n) + \",\" + v[1].toFixed(n) + \")\"; break;\n\t\t\tcase 'color3':\n\t\t\tcase 'vec3': return \"vec3(\" + v[0].toFixed(n) + \",\" + v[1].toFixed(n) + \",\" + v[2].toFixed(n) + \")\"; break;\n\t\t\tcase 'color4':\n\t\t\tcase 'vec4': return \"vec4(\" + v[0].toFixed(n) + \",\" + v[1].toFixed(n) + \",\" + v[2].toFixed(n) + \",\" + v[3].toFixed(n) + \")\"; break;\n\t\t\tcase 'mat3': return \"mat3(1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0)\"; break; //not fully supported yet\n\t\t\tcase 'mat4': return \"mat4(1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0)\"; break;//not fully supported yet\n\t\t\tdefault:\n\t\t\t\tthrow(\"unknown glsl type in valueToGLSL:\", type);\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\t//makes sure that a var is of a type, and if not, it converts it\n\tvar varToTypeGLSL = LiteGraph.varToTypeGLSL = function varToTypeGLSL( v, input_type, output_type )\n\t{\n\t\tif(input_type == output_type)\n\t\t\treturn v;\n\t\tif(v == null)\n\t\t\tswitch(output_type)\n\t\t\t{\n\t\t\t\tcase \"float\": return \"0.0\";\n\t\t\t\tcase \"vec2\":  return \"vec2(0.0)\";\n\t\t\t\tcase \"vec3\":  return \"vec3(0.0)\";\n\t\t\t\tcase \"vec4\":  return \"vec4(0.0,0.0,0.0,1.0)\";\n\t\t\t\tdefault: //null\n\t\t\t\t\treturn null;\n\t\t\t}\n\n\t\tif(!output_type)\n\t\t\tthrow(\"error: no output type specified\");\n\t\tif(output_type == \"float\")\n\t\t{\n\t\t\tswitch(input_type)\n\t\t\t{\n\t\t\t\t//case \"float\":\n\t\t\t\tcase \"vec2\":\n\t\t\t\tcase \"vec3\":\n\t\t\t\tcase \"vec4\":\n\t\t\t\t\treturn v + \".x\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: //null\n\t\t\t\t\treturn \"0.0\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse if(output_type == \"vec2\")\n\t\t{\n\t\t\tswitch(input_type)\n\t\t\t{\n\t\t\t\tcase \"float\":\n\t\t\t\t\treturn \"vec2(\"+v+\")\";\n\t\t\t\t//case \"vec2\":\n\t\t\t\tcase \"vec3\":\n\t\t\t\tcase \"vec4\":\n\t\t\t\t\treturn v + \".xy\";\n\t\t\t\tdefault: //null\n\t\t\t\t\treturn \"vec2(0.0)\";\n\t\t\t}\n\t\t}\n\t\telse if(output_type == \"vec3\")\n\t\t{\n\t\t\tswitch(input_type)\n\t\t\t{\n\t\t\t\tcase \"float\":\n\t\t\t\t\treturn \"vec3(\"+v+\")\";\n\t\t\t\tcase \"vec2\":\n\t\t\t\t\treturn \"vec3(\" + v + \",0.0)\";\n\t\t\t\t//case \"vec3\":\n\t\t\t\tcase \"vec4\":\n\t\t\t\t\treturn v + \".xyz\";\n\t\t\t\tdefault: //null\n\t\t\t\t\treturn \"vec3(0.0)\";\n\t\t\t}\n\t\t}\n\t\telse if(output_type == \"vec4\")\n\t\t{\n\t\t\tswitch(input_type)\n\t\t\t{\n\t\t\t\tcase \"float\":\n\t\t\t\t\treturn \"vec4(\"+v+\")\";\n\t\t\t\tcase \"vec2\":\n\t\t\t\t\treturn \"vec4(\" + v + \",0.0,1.0)\";\n\t\t\t\tcase \"vec3\":\n\t\t\t\t\treturn \"vec4(\" + v + \",1.0)\";\n\t\t\t\tdefault: //null\n\t\t\t\t\treturn \"vec4(0.0,0.0,0.0,1.0)\";\n\t\t\t}\n\t\t}\n\t\tthrow(\"type cannot be converted\");\n\t}\n\n\n\t//used to plug incompatible stuff\n\tvar convertVarToGLSLType = LiteGraph.convertVarToGLSLType = function convertVarToGLSLType( varname, type, target_type )\n\t{\n\t\tif(type == target_type)\n\t\t\treturn varname;\n\t\tif(type == \"float\")\n\t\t\treturn target_type + \"(\" + varname + \")\";\n\t\tif(target_type == \"vec2\") //works for vec2,vec3 and vec4\n\t\t\treturn \"vec2(\" + varname + \".xy)\";\n\t\tif(target_type == \"vec3\") //works for vec2,vec3 and vec4\n\t\t{\n\t\t\tif(type == \"vec2\")\n\t\t\t\treturn \"vec3(\" + varname + \",0.0)\";\n\t\t\tif(type == \"vec4\")\n\t\t\t\treturn \"vec4(\" + varname + \".xyz)\";\n\t\t}\n\t\tif(target_type == \"vec4\")\n\t\t{\n\t\t\tif(type == \"vec2\")\n\t\t\t\treturn \"vec4(\" + varname + \",0.0,0.0)\";\n\t\t\tif(target_type == \"vec3\")\n\t\t\t\treturn \"vec4(\" + varname + \",1.0)\";\n\t\t}\n\t\treturn null;\n\t}\n\n\t//used to host a shader body **************************************\n\tfunction LGShaderContext()\n\t{\n\t\t//to store the code template\n\t\tthis.vs_template = \"\";\n\t\tthis.fs_template = \"\";\n\n\t\t//required so nodes now where to fetch the input data\n\t\tthis.buffer_names = {\n\t\t\tuvs: \"v_coord\"\n\t\t};\n\n\t\tthis.extra = {}; //to store custom info from the nodes (like if this shader supports a feature, etc)\n\n\t\tthis._functions = {};\n\t\tthis._uniforms = {};\n\t\tthis._codeparts = {};\n\t\tthis._uniform_value = null;\n\t}\n\n\tLGShaderContext.prototype.clear = function()\n\t{\n\t\tthis._uniforms = {};\n\t\tthis._functions = {};\n\t\tthis._codeparts = {};\n\t\tthis._uniform_value = null;\n\n\t\tthis.extra = {};\n\t}\n\n\tLGShaderContext.prototype.addUniform = function( name, type, value )\n\t{\n\t\tthis._uniforms[ name ] = type;\n\t\tif(value != null)\n\t\t{\n\t\t\tif(!this._uniform_value)\n\t\t\t\tthis._uniform_value = {};\n\t\t\tthis._uniform_value[name] = value;\n\t\t}\n\t}\n\n\tLGShaderContext.prototype.addFunction = function( name, code )\n\t{\n\t\tthis._functions[name] = code;\n\t}\n\n\tLGShaderContext.prototype.addCode = function( hook, code, destinations )\n\t{\n\t\tdestinations = destinations || {\"\":\"\"};\n\t\tfor(var i in destinations)\n\t\t{\n\t\t\tvar h = i ? i + \"_\" + hook : hook;\n\t\t\tif(!this._codeparts[ h ])\n\t\t\t\tthis._codeparts[ h ] = code + \"\\n\";\n\t\t\telse\n\t\t\t\tthis._codeparts[ h ] += code + \"\\n\";\n\t\t}\n\t}\n\n\t//the system works by grabbing code fragments from every node and concatenating them in blocks depending on where must they be attached\n\tLGShaderContext.prototype.computeCodeBlocks = function( graph, extra_uniforms )\n\t{\n\t\t//prepare context\n\t\tthis.clear();\n\n\t\t//grab output nodes\n\t\tvar vertexout = graph.findNodesByType(\"shader::output/vertex\");\n\t\tvertexout = vertexout && vertexout.length ? vertexout[0] : null;\n\t\tvar fragmentout = graph.findNodesByType(\"shader::output/fragcolor\");\n\t\tfragmentout = fragmentout && fragmentout.length ? fragmentout[0] : null;\n\t\tif(!fragmentout) //??\n\t\t\treturn null; \n\n\t\t//propagate back destinations\n\t\tgraph.sendEventToAllNodes( \"clearDestination\" );\n\t\tif(vertexout)\n\t\t\tvertexout.propagateDestination(\"vs\");\n\t\tif(fragmentout)\n\t\t\tfragmentout.propagateDestination(\"fs\");\n\n\t\t//gets code from graph\n\t\tgraph.sendEventToAllNodes(\"onGetCode\", this );\n\n\t\tvar uniforms = \"\";\n\t\tfor(var i in this._uniforms)\n\t\t\tuniforms += \"uniform \" + this._uniforms[i] + \" \" + i + \";\\n\";\n\t\tif(extra_uniforms)\n\t\t\tfor(var i in extra_uniforms)\n\t\t\t\tuniforms += \"uniform \" + extra_uniforms[i] + \" \" + i + \";\\n\";\n\n\t\tvar functions = \"\";\n\t\tfor(var i in this._functions)\n\t\t\tfunctions += \"//\" + i + \"\\n\" + this._functions[i] + \"\\n\";\n\n\t\tvar blocks = this._codeparts;\n\t\tblocks.uniforms = uniforms;\n\t\tblocks.functions = functions;\n\t\treturn blocks;\n\t}\n\n\t//replaces blocks using the vs and fs template and returns the final codes\n\tLGShaderContext.prototype.computeShaderCode = function( graph )\n\t{\n\t\tvar blocks = this.computeCodeBlocks( graph );\n\t\tvar vs_code = GL.Shader.replaceCodeUsingContext( this.vs_template, blocks );\n\t\tvar fs_code = GL.Shader.replaceCodeUsingContext( this.fs_template, blocks );\n\t\treturn {\n\t\t\tvs_code: vs_code,\n\t\t\tfs_code: fs_code\n\t\t};\n\t}\n\n\t//generates the shader code from the template and the \n\tLGShaderContext.prototype.computeShader = function( graph, shader )\n\t{\n\t\tvar finalcode = this.computeShaderCode( graph );\n\t\tconsole.log( finalcode.vs_code, finalcode.fs_code );\n\n\t\tif(!LiteGraph.catch_exceptions)\n\t\t{\n\t\t\tthis._shader_error = true;\n\t\t\tif(shader)\n\t\t\t\tshader.updateShader( finalcode.vs_code, finalcode.fs_code );\n\t\t\telse\n\t\t\t\tshader = new GL.Shader( finalcode.vs_code, finalcode.fs_code );\n\t\t\tthis._shader_error = false;\n\t\t\treturn shader;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tif(shader)\n\t\t\t\tshader.updateShader( finalcode.vs_code, finalcode.fs_code );\n\t\t\telse\n\t\t\t\tshader = new GL.Shader( finalcode.vs_code, finalcode.fs_code );\n\t\t\tthis._shader_error = false;\n\t\t\treturn shader;\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\tif(!this._shader_error)\n\t\t\t{\n\t\t\t\tconsole.error(err);\n\t\t\t\tif(err.indexOf(\"Fragment shader\") != -1)\n\t\t\t\t\tconsole.log( finalcode.fs_code.split(\"\\n\").map(function(v,i){ return i + \".- \" + v; }).join(\"\\n\") );\n\t\t\t\telse\n\t\t\t\t\tconsole.log( finalcode.vs_code );\n\t\t\t}\n\t\t\tthis._shader_error = true;\n\t\t\treturn null;\n\t\t}\n\n\t\treturn null;//never here\n\t}\n\n\tLGShaderContext.prototype.getShader = function( graph )\n\t{\n\t\t//if graph not changed?\n\t\tif(this._shader && this._shader._version == graph._version)\n\t\t\treturn this._shader;\n\n\t\t//compile shader\n\t\tvar shader = this.computeShader( graph, this._shader );\n\t\tif(!shader)\n\t\t\treturn null;\n\t\t\n\t\tthis._shader = shader;\n\t\tshader._version = graph._version;\n\t\treturn shader;\n\t}\n\n\t//some shader nodes could require to fill the box with some uniforms\n\tLGShaderContext.prototype.fillUniforms = function( uniforms, param )\n\t{\n\t\tif(!this._uniform_value)\n\t\t\treturn;\n\n\t\tfor(var i in this._uniform_value)\n\t\t{\n\t\t\tvar v = this._uniform_value[i];\n\t\t\tif(v == null)\n\t\t\t\tcontinue;\n\t\t\tif(v.constructor === Function)\n\t\t\t\tuniforms[i] = v.call( this, param );\n\t\t\telse if(v.constructor === GL.Texture)\n\t\t\t{\n\t\t\t\t//todo...\n\t\t\t}\n\t\t\telse\n\t\t\t\tuniforms[i] = v;\n\t\t}\n\t}\n\n\tLiteGraph.ShaderContext = LiteGraph.Shaders.Context = LGShaderContext;\n\n\t// LGraphShaderGraph *****************************\n\t// applies a shader graph to texture, it can be uses as an example\n\n\tfunction LGraphShaderGraph() {\n\n\t\t//before inputs\n        this.subgraph = new LiteGraph.LGraph();\n        this.subgraph._subgraph_node = this;\n        this.subgraph._is_subgraph = true;\n\t\tthis.subgraph.filter = \"shader\";\n\n\t\tthis.addInput(\"in\", \"texture\");\n\t\tthis.addOutput(\"out\", \"texture\");\n\t\tthis.properties = { width: 0, height: 0, alpha: false, precision: typeof(LGraphTexture) != \"undefined\" ? LGraphTexture.DEFAULT : 2 };\n\n\t\tvar inputNode = this.subgraph.findNodesByType(\"shader::input/uniform\")[0];\n\t\tinputNode.pos = [200,300];\n\n\t\tvar sampler = LiteGraph.createNode(\"shader::texture/sampler2D\");\n\t\tsampler.pos = [400,300];\n\t\tthis.subgraph.add( sampler );\n\n\t\tvar outnode = LiteGraph.createNode(\"shader::output/fragcolor\");\n\t\toutnode.pos = [600,300];\n\t\tthis.subgraph.add( outnode );\n\n\t\tinputNode.connect( 0, sampler );\n\t\tsampler.connect( 0, outnode );\n\n\t\tthis.size = [180,60];\n\t\tthis.redraw_on_mouse = true; //force redraw\n\n\t\tthis._uniforms = {};\n\t\tthis._shader = null;\n\t\tthis._context = new LGShaderContext();\n\t\tthis._context.vs_template = \"#define VERTEX\\n\" + GL.Shader.SCREEN_VERTEX_SHADER;\n\t\tthis._context.fs_template = LGraphShaderGraph.template;\n\t}\n\n\tLGraphShaderGraph.template = \"\\n\\\n#define FRAGMENT\\n\\\nprecision highp float;\\n\\\nvarying vec2 v_coord;\\n\\\n{{varying}}\\n\\\n{{uniforms}}\\n\\\n{{functions}}\\n\\\n{{fs_functions}}\\n\\\nvoid main() {\\n\\n\\\nvec2 uv = v_coord;\\n\\\nvec4 fragcolor = vec4(0.0);\\n\\\nvec4 fragcolor1 = vec4(0.0);\\n\\\n{{fs_code}}\\n\\\ngl_FragColor = fragcolor;\\n\\\n}\\n\\\n\t\";\n\n\tLGraphShaderGraph.widgets_info = {\n\t\tprecision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n\t};\n\n\tLGraphShaderGraph.title = \"ShaderGraph\";\n\tLGraphShaderGraph.desc = \"Builds a shader using a graph\";\n\tLGraphShaderGraph.input_node_type = \"input/uniform\";\n\tLGraphShaderGraph.output_node_type = \"output/fragcolor\";\n\tLGraphShaderGraph.title_color = SHADERNODES_COLOR;\n\n\tLGraphShaderGraph.prototype.onSerialize = function(o)\n\t{\n\t\to.subgraph = this.subgraph.serialize();\n\t}\n\n\tLGraphShaderGraph.prototype.onConfigure = function(o)\n\t{\n\t\tthis.subgraph.configure(o.subgraph);\n\t}\n\n\tLGraphShaderGraph.prototype.onExecute = function() {\n\t\tif (!this.isOutputConnected(0))\n\t\t\treturn;\n\n\t\t//read input texture\n\t\tvar intex = this.getInputData(0);\n\t\tif(intex && intex.constructor != GL.Texture)\n\t\t\tintex = null;\n\n\t\tvar w = this.properties.width | 0;\n\t\tvar h = this.properties.height | 0;\n\t\tif (w == 0) {\n\t\t\tw = intex ? intex.width : gl.viewport_data[2];\n\t\t} //0 means default\n\t\tif (h == 0) {\n\t\t\th = intex ? intex.height : gl.viewport_data[3];\n\t\t} //0 means default\n\n\t\tvar type = LGraphTexture.getTextureType( this.properties.precision, intex );\n\n\t\tvar texture = this._texture;\n\t\tif ( !texture || texture.width != w || texture.height != h || texture.type != type ) {\n\t\t\ttexture = this._texture = new GL.Texture(w, h, {\n\t\t\t\ttype: type,\n\t\t\t\tformat: this.alpha ? gl.RGBA : gl.RGB,\n\t\t\t\tfilter: gl.LINEAR\n\t\t\t});\n\t\t}\n\t\t\n\t\tvar shader = this.getShader( this.subgraph );\n\t\tif(!shader)\n\t\t\treturn;\n\n\t\tvar uniforms = this._uniforms;\n\t\tthis._context.fillUniforms( uniforms );\n\n\t\tvar tex_slot = 0;\n\t\tif(this.inputs)\n\t\tfor(var i = 0; i < this.inputs.length; ++i)\n\t\t{\n\t\t\tvar input = this.inputs[i];\n\t\t\tvar data = this.getInputData(i);\n\t\t\tif(input.type == \"texture\")\n\t\t\t{\n\t\t\t\tif(!data)\n\t\t\t\t\tdata = GL.Texture.getWhiteTexture();\n\t\t\t\tdata = data.bind(tex_slot++);\n\t\t\t}\n\n\t\t\tif(data != null)\n\t\t\t\tuniforms[ \"u_\" + input.name ] = data;\n\t\t}\n\n\t\tvar mesh = GL.Mesh.getScreenQuad();\n\n\t\tgl.disable( gl.DEPTH_TEST );\n\t\tgl.disable( gl.BLEND );\n\n\t\ttexture.drawTo(function(){\n\t\t\tshader.uniforms( uniforms );\n\t\t\tshader.draw( mesh );\n\t\t});\n\n\t\t//use subgraph output \n\t\tthis.setOutputData(0, texture );\n\t};\n\n\t//add input node inside subgraph\n\tLGraphShaderGraph.prototype.onInputAdded = function( slot_info )\n\t{\n\t\tvar subnode = LiteGraph.createNode(\"shader::input/uniform\");\n\t\tsubnode.setProperty(\"name\",slot_info.name);\n\t\tsubnode.setProperty(\"type\",slot_info.type);\n\t\tthis.subgraph.add( subnode );\n\t}\n\n\t//remove all\n\tLGraphShaderGraph.prototype.onInputRemoved = function( slot, slot_info )\n\t{\n\t\tvar nodes = this.subgraph.findNodesByType(\"shader::input/uniform\");\n\t\tfor(var i = 0; i < nodes.length; ++i)\n\t\t{\n\t\t\tvar node = nodes[i];\n\t\t\tif(node.properties.name == slot_info.name )\n\t\t\t\tthis.subgraph.remove( node );\n\t\t}\n\t}\n\n\tLGraphShaderGraph.prototype.computeSize = function()\n\t{\n\t\tvar num_inputs = this.inputs ? this.inputs.length : 0;\n\t\tvar num_outputs = this.outputs ? this.outputs.length : 0;\n\t\treturn [ 200, Math.max(num_inputs,num_outputs) * LiteGraph.NODE_SLOT_HEIGHT + LiteGraph.NODE_TITLE_HEIGHT + 10];\n\t}\n\n\tLGraphShaderGraph.prototype.getShader = function()\n\t{\n\t\tvar shader = this._context.getShader( this.subgraph );\n\t\tif(!shader)\n\t\t\tthis.boxcolor = \"red\";\n\t\telse\n\t\t\tthis.boxcolor = null;\n\t\treturn shader;\n\t}\n\n\tLGraphShaderGraph.prototype.onDrawBackground = function(ctx, graphcanvas, canvas, pos)\n\t{\n\t\tif(this.flags.collapsed)\n\t\t\treturn;\n\n\t\t//allows to preview the node if the canvas is a webgl canvas\n\t\tvar tex = this.getOutputData(0);\n\t\tvar inputs_y = this.inputs ? this.inputs.length * LiteGraph.NODE_SLOT_HEIGHT : 0;\n\t\tif (tex && ctx == tex.gl && this.size[1] > inputs_y + LiteGraph.NODE_TITLE_HEIGHT ) {\n\t\t\tctx.drawImage( tex, 10,y, this.size[0] - 20, this.size[1] - inputs_y - LiteGraph.NODE_TITLE_HEIGHT );\n\t\t}\n\n\t\tvar y = this.size[1] - LiteGraph.NODE_TITLE_HEIGHT + 0.5;\n\n\t\t//button\n\t\tvar over = LiteGraph.isInsideRectangle(pos[0],pos[1],this.pos[0],this.pos[1] + y,this.size[0],LiteGraph.NODE_TITLE_HEIGHT);\n\t\tctx.fillStyle = over ? \"#555\" : \"#222\";\n\t\tctx.beginPath();\n\t\tif (this._shape == LiteGraph.BOX_SHAPE)\n\t\t\tctx.rect(0, y, this.size[0]+1, LiteGraph.NODE_TITLE_HEIGHT);\n\t\telse\n\t\t\tctx.roundRect( 0, y, this.size[0]+1, LiteGraph.NODE_TITLE_HEIGHT, 0, 8);\n\t\tctx.fill();\n\n\t\t//button\n\t\tctx.textAlign = \"center\";\n\t\tctx.font = \"24px Arial\";\n\t\tctx.fillStyle = over ? \"#DDD\" : \"#999\";\n\t\tctx.fillText( \"+\", this.size[0] * 0.5, y + 24 );\n\t}\n\n\tLGraphShaderGraph.prototype.onMouseDown = function(e, localpos, graphcanvas)\n\t{\n\t\tvar y = this.size[1] - LiteGraph.NODE_TITLE_HEIGHT + 0.5;\n\t\tif(localpos[1] > y)\n\t\t{\n\t\t\tgraphcanvas.showSubgraphPropertiesDialog(this);\n\t\t}\n\t}\n\n\tLGraphShaderGraph.prototype.onDrawSubgraphBackground = function(graphcanvas)\n\t{\n\t\t//TODO\n\t}\n\n\tLGraphShaderGraph.prototype.getExtraMenuOptions = function(graphcanvas)\n\t{\n\t\tvar that = this;\n\t\tvar options = [{ content: \"Print Code\", callback: function(){\n\t\t\tvar code = that._context.computeShaderCode();\n\t\t\tconsole.log( code.vs_code, code.fs_code );\n\t\t}}];\n\n\t\treturn options;\n\t}\n\n\tLiteGraph.registerNodeType( \"texture/shaderGraph\", LGraphShaderGraph );\n\n\tfunction shaderNodeFromFunction( classname, params, return_type, code )\n\t{\n\t\t//TODO\n\t}\n\n\t//Shader Nodes ***********************************************************\n\n\t//applies a shader graph to a code\n\tfunction LGraphShaderUniform() {\n\t\tthis.addOutput(\"out\", \"\");\n\t\tthis.properties = { name: \"\", type: \"\" };\n\t}\n\n\tLGraphShaderUniform.title = \"Uniform\";\n\tLGraphShaderUniform.desc = \"Input data for the shader\";\n\n\tLGraphShaderUniform.prototype.getTitle = function()\n\t{\n\t\tif( this.properties.name && this.flags.collapsed)\n\t\t\treturn this.properties.type + \" \" + this.properties.name;\n\t\treturn \"Uniform\";\n\t}\n\n\tLGraphShaderUniform.prototype.onPropertyChanged = function(name,value)\n\t{\n\t\tthis.outputs[0].name = this.properties.type + \" \" + this.properties.name;\n\t}\n\n\tLGraphShaderUniform.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination)\n\t\t\treturn;\n\n\t\tvar type = this.properties.type;\n\t\tif( !type )\n\t\t{\n\t\t\tif( !context.onGetPropertyInfo )\n\t\t\t\treturn;\n\t\t\tvar info = context.onGetPropertyInfo( this.property.name );\n\t\t\tif(!info)\n\t\t\t\treturn;\n\t\t\ttype = info.type;\n\t\t}\n\t\tif(type == \"number\")\n\t\t\ttype = \"float\";\n\t\telse if(type == \"texture\")\n\t\t\ttype = \"sampler2D\";\n\t\tif ( LGShaders.GLSL_types.indexOf(type) == -1 )\n\t\t\treturn;\n\n\t\tcontext.addUniform( \"u_\" + this.properties.name, type );\n\t\tthis.setOutputData( 0, type );\n\t}\n\n\tLGraphShaderUniform.prototype.getOutputVarName = function(slot)\n\t{\n\t\treturn \"u_\" + this.properties.name;\n\t}\n\n\tregisterShaderNode( \"input/uniform\", LGraphShaderUniform );\n\n\n\tfunction LGraphShaderAttribute() {\n\t\tthis.addOutput(\"out\", \"vec2\");\n\t\tthis.properties = { name: \"coord\", type: \"vec2\" };\n\t}\n\n\tLGraphShaderAttribute.title = \"Attribute\";\n\tLGraphShaderAttribute.desc = \"Input data from mesh attribute\";\n\n\tLGraphShaderAttribute.prototype.getTitle = function()\n\t{\n\t\treturn \"att. \" + this.properties.name;\n\t}\n\n\tLGraphShaderAttribute.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination)\n\t\t\treturn;\n\n\t\tvar type = this.properties.type;\n\t\tif( !type || LGShaders.GLSL_types.indexOf(type) == -1 )\n\t\t\treturn;\n\t\tif(type == \"number\")\n\t\t\ttype = \"float\";\n\t\tif( this.properties.name != \"coord\")\n\t\t{\n\t\t\tcontext.addCode( \"varying\", \" varying \" + type +\" v_\" + this.properties.name + \";\" );\n\t\t\t//if( !context.varyings[ this.properties.name ] )\n\t\t\t//context.addCode( \"vs_code\", \"v_\" + this.properties.name + \" = \" + input_name + \";\" );\n\t\t}\n\t\tthis.setOutputData( 0, type );\n\t}\n\n\tLGraphShaderAttribute.prototype.getOutputVarName = function(slot)\n\t{\n\t\treturn \"v_\" + this.properties.name;\n\t}\n\n\tregisterShaderNode( \"input/attribute\", LGraphShaderAttribute );\n\n\tfunction LGraphShaderSampler2D() {\n\t\tthis.addInput(\"tex\", \"sampler2D\");\n\t\tthis.addInput(\"uv\", \"vec2\");\n\t\tthis.addOutput(\"rgba\", \"vec4\");\n\t\tthis.addOutput(\"rgb\", \"vec3\");\n\t}\n\n\tLGraphShaderSampler2D.title = \"Sampler2D\";\n\tLGraphShaderSampler2D.desc = \"Reads a pixel from a texture\";\n\n\tLGraphShaderSampler2D.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination)\n\t\t\treturn;\n\n\t\tvar texname = getInputLinkID( this, 0 );\n\t\tvar varname = getShaderNodeVarName(this);\n\t\tvar code = \"vec4 \" + varname + \" = vec4(0.0);\\n\";\n\t\tif(texname)\n\t\t{\n\t\t\tvar uvname = getInputLinkID( this, 1 ) || context.buffer_names.uvs;\n\t\t\tcode += varname + \" = texture2D(\"+texname+\",\"+uvname+\");\\n\";\n\t\t}\n\n\t\tvar link0 = getOutputLinkID( this, 0 );\n\t\tif(link0)\n\t\t\tcode += \"vec4 \" + getOutputLinkID( this, 0 ) + \" = \"+varname+\";\\n\";\n\n\t\tvar link1 = getOutputLinkID( this, 1 );\n\t\tif(link1)\n\t\t\tcode += \"vec3 \" + getOutputLinkID( this, 1 ) + \" = \"+varname+\".xyz;\\n\";\n\n\t\tcontext.addCode( \"code\", code, this.shader_destination );\n\t\tthis.setOutputData( 0, \"vec4\" );\n\t\tthis.setOutputData( 1, \"vec3\" );\n\t}\n\n\tregisterShaderNode( \"texture/sampler2D\", LGraphShaderSampler2D );\n\n\t//*********************************\n\n\tfunction LGraphShaderConstant()\n\t{\n\t\tthis.addOutput(\"\",\"float\");\n\n\t\tthis.properties = {\n\t\t\ttype: \"float\",\n\t\t\tvalue: 0\n\t\t};\n\n\t\tthis.addWidget(\"combo\",\"type\",\"float\",null, { values: GLSL_types_const, property: \"type\" } );\n\t\tthis.updateWidgets();\n\t}\n\n\tLGraphShaderConstant.title = \"const\";\n\n\tLGraphShaderConstant.prototype.getTitle = function()\n\t{\n\t\tif(this.flags.collapsed)\n\t\t\treturn valueToGLSL( this.properties.value, this.properties.type, 2 );\n\t\treturn \"Const\";\n\t}\n\n\tLGraphShaderConstant.prototype.onPropertyChanged = function(name,value)\n\t{\n\t\tvar that = this;\n\t\tif(name == \"type\")\n\t\t{\n\t\t\tif(this.outputs[0].type != value)\n\t\t\t{\n\t\t\t\tthis.disconnectOutput(0);\n\t\t\t\tthis.outputs[0].type = value;\n\t\t\t}\n\t\t\tthis.widgets.length = 1; //remove extra widgets\n\t\t\tthis.updateWidgets();\n\t\t}\n\t\tif(name == \"value\")\n\t\t{\n\t\t\tif(!value.length)\n\t\t\t\tthis.widgets[1].value = value;\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.widgets[1].value = value[1];\n\t\t\t\tif(value.length > 2)\n\t\t\t\t\tthis.widgets[2].value = value[2];\n\t\t\t\tif(value.length > 3)\n\t\t\t\t\tthis.widgets[3].value = value[3];\n\t\t\t}\n\t\t}\n\t}\n\n\tLGraphShaderConstant.prototype.updateWidgets = function( old_value )\n\t{\n\t\tvar that = this;\n\t\tvar old_value = this.properties.value;\n\t\tvar options = { step: 0.01 };\n\t\tswitch(this.properties.type)\n\t\t{\n\t\t\tcase 'float': \n\t\t\t\tthis.properties.value = 0;\n\t\t\t\tthis.addWidget(\"number\",\"v\",0,{ step:0.01, property: \"value\" });\n\t\t\t\tbreak;\n\t\t\tcase 'vec2': \n\t\t\t\tthis.properties.value = old_value && old_value.length == 2 ? [old_value[0],old_value[1]] : [0,0,0];\n\t\t\t\tthis.addWidget(\"number\",\"x\",this.properties.value[0], function(v){ that.properties.value[0] = v; },options); \n\t\t\t\tthis.addWidget(\"number\",\"y\",this.properties.value[1], function(v){ that.properties.value[1] = v; },options); \n\t\t\t\tbreak;\n\t\t\tcase 'vec3': \n\t\t\t\tthis.properties.value = old_value && old_value.length == 3 ? [old_value[0],old_value[1],old_value[2]] : [0,0,0];\n\t\t\t\tthis.addWidget(\"number\",\"x\",this.properties.value[0], function(v){ that.properties.value[0] = v; },options); \n\t\t\t\tthis.addWidget(\"number\",\"y\",this.properties.value[1], function(v){ that.properties.value[1] = v; },options); \n\t\t\t\tthis.addWidget(\"number\",\"z\",this.properties.value[2], function(v){ that.properties.value[2] = v; },options); \n\t\t\t\tbreak;\n\t\t\tcase 'vec4': \n\t\t\t\tthis.properties.value = old_value && old_value.length == 4 ? [old_value[0],old_value[1],old_value[2],old_value[3]] : [0,0,0,0];\n\t\t\t\tthis.addWidget(\"number\",\"x\",this.properties.value[0], function(v){ that.properties.value[0] = v; },options); \n\t\t\t\tthis.addWidget(\"number\",\"y\",this.properties.value[1], function(v){ that.properties.value[1] = v; },options); \n\t\t\t\tthis.addWidget(\"number\",\"z\",this.properties.value[2], function(v){ that.properties.value[2] = v; },options); \n\t\t\t\tthis.addWidget(\"number\",\"w\",this.properties.value[3], function(v){ that.properties.value[3] = v; },options); \n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.error(\"unknown type for constant\");\n\t\t}\n\t}\n\n\tLGraphShaderConstant.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination)\n\t\t\treturn;\n\n\t\tvar value = valueToGLSL( this.properties.value, this.properties.type );\n\t\tvar link_name = getOutputLinkID(this,0);\n\t\tif(!link_name) //not connected\n\t\t\treturn;\n\n\t\tvar code = \"\t\" + this.properties.type + \" \" + link_name + \" = \" + value + \";\";\n\t\tcontext.addCode( \"code\", code, this.shader_destination );\n\n\t\tthis.setOutputData( 0, this.properties.type );\n\t}\n\n\tregisterShaderNode( \"const/const\", LGraphShaderConstant );\n\n\tfunction LGraphShaderVec2()\n\t{\n\t\tthis.addInput(\"xy\",\"vec2\");\n\t\tthis.addInput(\"x\",\"float\");\n\t\tthis.addInput(\"y\",\"float\");\n\t\tthis.addOutput(\"xy\",\"vec2\");\n\t\tthis.addOutput(\"x\",\"float\");\n\t\tthis.addOutput(\"y\",\"float\");\n\n\t\tthis.properties = { x: 0, y: 0 };\n\t}\n\n\tLGraphShaderVec2.title = \"vec2\";\n\tLGraphShaderVec2.varmodes = [\"xy\",\"x\",\"y\"];\n\n\tLGraphShaderVec2.prototype.onPropertyChanged = function()\n\t{\n\t\tif(this.graph)\n\t\t\t this.graph._version++;\n\t}\n\n\tLGraphShaderVec2.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination)\n\t\t\treturn;\n\n\t\tvar props = this.properties;\n\n\t\tvar varname = getShaderNodeVarName(this);\n\t\tvar code = \"\tvec2 \" + varname + \" = \" + valueToGLSL([props.x,props.y]) + \";\\n\";\n\n\t\tfor(var i = 0;i < LGraphShaderVec2.varmodes.length; ++i)\n\t\t{\n\t\t\tvar varmode = LGraphShaderVec2.varmodes[i];\n\t\t\tvar inlink = getInputLinkID(this,i);\n\t\t\tif(!inlink)\n\t\t\t\tcontinue;\n\t\t\tcode += \"\t\" + varname + \".\"+varmode+\" = \" + inlink + \";\\n\";\n\t\t}\n\n\t\tfor(var i = 0;i < LGraphShaderVec2.varmodes.length; ++i)\n\t\t{\n\t\t\tvar varmode = LGraphShaderVec2.varmodes[i];\n\t\t\tvar outlink = getOutputLinkID(this,i);\n\t\t\tif(!outlink)\n\t\t\t\tcontinue;\n\t\t\tvar type = GLSL_types_const[varmode.length - 1];\n\t\t\tcode += \"\t\"+type+\" \" + outlink + \" = \" + varname + \".\" + varmode + \";\\n\";\n\t\t\tthis.setOutputData( i, type );\n\t\t}\n\n\t\tcontext.addCode( \"code\", code, this.shader_destination );\n\t}\n\n\tregisterShaderNode( \"const/vec2\", LGraphShaderVec2 );\t\n\n\tfunction LGraphShaderVec3()\n\t{\n\t\tthis.addInput(\"xyz\",\"vec3\");\n\t\tthis.addInput(\"x\",\"float\");\n\t\tthis.addInput(\"y\",\"float\");\n\t\tthis.addInput(\"z\",\"float\");\n\t\tthis.addInput(\"xy\",\"vec2\");\n\t\tthis.addInput(\"xz\",\"vec2\");\n\t\tthis.addInput(\"yz\",\"vec2\");\n\t\tthis.addOutput(\"xyz\",\"vec3\");\n\t\tthis.addOutput(\"x\",\"float\");\n\t\tthis.addOutput(\"y\",\"float\");\n\t\tthis.addOutput(\"z\",\"float\");\n\t\tthis.addOutput(\"xy\",\"vec2\");\n\t\tthis.addOutput(\"xz\",\"vec2\");\n\t\tthis.addOutput(\"yz\",\"vec2\");\n\n\t\tthis.properties = { x:0, y: 0, z: 0 };\n\t}\n\n\tLGraphShaderVec3.title = \"vec3\";\n\tLGraphShaderVec3.varmodes = [\"xyz\",\"x\",\"y\",\"z\",\"xy\",\"xz\",\"yz\"];\n\n\tLGraphShaderVec3.prototype.onPropertyChanged = function()\n\t{\n\t\tif(this.graph)\n\t\t\tthis.graph._version++;\n\t}\n\n\tLGraphShaderVec3.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination)\n\t\t\treturn;\n\n\t\tvar props = this.properties;\n\n\t\tvar varname = getShaderNodeVarName(this);\n\t\tvar code = \"vec3 \" + varname + \" = \" + valueToGLSL([props.x,props.y,props.z]) + \";\\n\";\n\n\t\tfor(var i = 0;i < LGraphShaderVec3.varmodes.length; ++i)\n\t\t{\n\t\t\tvar varmode = LGraphShaderVec3.varmodes[i];\n\t\t\tvar inlink = getInputLinkID(this,i);\n\t\t\tif(!inlink)\n\t\t\t\tcontinue;\n\t\t\tcode += \"\t\" + varname + \".\"+varmode+\" = \" + inlink + \";\\n\";\n\t\t}\n\n\t\tfor(var i = 0; i < LGraphShaderVec3.varmodes.length; ++i)\n\t\t{\n\t\t\tvar varmode = LGraphShaderVec3.varmodes[i];\n\t\t\tvar outlink = getOutputLinkID(this,i);\n\t\t\tif(!outlink)\n\t\t\t\tcontinue;\n\t\t\tvar type = GLSL_types_const[varmode.length - 1];\n\t\t\tcode += \"\t\"+type+\" \" + outlink + \" = \" + varname + \".\" + varmode + \";\\n\";\n\t\t\tthis.setOutputData( i, type );\n\t\t}\n\n\t\tcontext.addCode( \"code\", code, this.shader_destination );\n\t}\n\n\tregisterShaderNode( \"const/vec3\", LGraphShaderVec3 );\t\n\n\n\tfunction LGraphShaderVec4()\n\t{\n\t\tthis.addInput(\"xyzw\",\"vec4\");\n\t\tthis.addInput(\"xyz\",\"vec3\");\n\t\tthis.addInput(\"x\",\"float\");\n\t\tthis.addInput(\"y\",\"float\");\n\t\tthis.addInput(\"z\",\"float\");\n\t\tthis.addInput(\"w\",\"float\");\n\t\tthis.addInput(\"xy\",\"vec2\");\n\t\tthis.addInput(\"yz\",\"vec2\");\n\t\tthis.addInput(\"zw\",\"vec2\");\n\t\tthis.addOutput(\"xyzw\",\"vec4\");\n\t\tthis.addOutput(\"xyz\",\"vec3\");\n\t\tthis.addOutput(\"x\",\"float\");\n\t\tthis.addOutput(\"y\",\"float\");\n\t\tthis.addOutput(\"z\",\"float\");\n\t\tthis.addOutput(\"xy\",\"vec2\");\n\t\tthis.addOutput(\"yz\",\"vec2\");\n\t\tthis.addOutput(\"zw\",\"vec2\");\n\n\t\tthis.properties = { x:0, y: 0, z: 0, w: 0 };\n\t}\n\n\tLGraphShaderVec4.title = \"vec4\";\n\tLGraphShaderVec4.varmodes = [\"xyzw\",\"xyz\",\"x\",\"y\",\"z\",\"w\",\"xy\",\"yz\",\"zw\"];\n\n\tLGraphShaderVec4.prototype.onPropertyChanged = function()\n\t{\n\t\tif(this.graph)\n\t\t\tthis.graph._version++;\n\t}\n\n\tLGraphShaderVec4.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination)\n\t\t\treturn;\n\n\t\tvar props = this.properties;\n\n\t\tvar varname = getShaderNodeVarName(this);\n\t\tvar code = \"vec4 \" + varname + \" = \" + valueToGLSL([props.x,props.y,props.z,props.w]) + \";\\n\";\n\n\t\tfor(var i = 0;i < LGraphShaderVec4.varmodes.length; ++i)\n\t\t{\n\t\t\tvar varmode = LGraphShaderVec4.varmodes[i];\n\t\t\tvar inlink = getInputLinkID(this,i);\n\t\t\tif(!inlink)\n\t\t\t\tcontinue;\n\t\t\tcode += \"\t\" + varname + \".\"+varmode+\" = \" + inlink + \";\\n\";\n\t\t}\n\n\t\tfor(var i = 0;i < LGraphShaderVec4.varmodes.length; ++i)\n\t\t{\n\t\t\tvar varmode = LGraphShaderVec4.varmodes[i];\n\t\t\tvar outlink = getOutputLinkID(this,i);\n\t\t\tif(!outlink)\n\t\t\t\tcontinue;\n\t\t\tvar type = GLSL_types_const[varmode.length - 1];\n\t\t\tcode += \"\t\"+type+\" \" + outlink + \" = \" + varname + \".\" + varmode + \";\\n\";\n\t\t\tthis.setOutputData( i, type );\n\t\t}\n\n\t\tcontext.addCode( \"code\", code, this.shader_destination );\n\n\t}\n\n\tregisterShaderNode( \"const/vec4\", LGraphShaderVec4 );\t\n\t\n\t//*********************************\n\n\tfunction LGraphShaderFragColor() {\n\t\tthis.addInput(\"color\", LGShaders.ALL_TYPES );\n\t\tthis.block_delete = true;\n\t}\n\n\tLGraphShaderFragColor.title = \"FragColor\";\n\tLGraphShaderFragColor.desc = \"Pixel final color\";\n\n\tLGraphShaderFragColor.prototype.onGetCode = function( context )\n\t{\n\t\tvar link_name = getInputLinkID( this, 0 );\n\t\tif(!link_name)\n\t\t\treturn;\n\t\tvar type = this.getInputData(0);\n\t\tvar code = varToTypeGLSL( link_name, type, \"vec4\" );\n\t\tcontext.addCode(\"fs_code\", \"fragcolor = \" + code + \";\");\n\t}\n\n\tregisterShaderNode( \"output/fragcolor\", LGraphShaderFragColor );\n\n\n\t/*\n\tfunction LGraphShaderDiscard()\n\t{\n\t\tthis.addInput(\"v\",\"T\");\n\t\tthis.addInput(\"min\",\"T\");\n\t\tthis.properties = { min_value: 0.0 };\n\t\tthis.addWidget(\"number\",\"min\",0,{ step: 0.01, property: \"min_value\" });\n\t}\n\n\tLGraphShaderDiscard.title = \"Discard\";\n\n\tLGraphShaderDiscard.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.isOutputConnected(0))\n\t\t\treturn;\n\n\t\tvar inlink = getInputLinkID(this,0);\n\t\tvar inlink1 = getInputLinkID(this,1);\n\n\t\tif(!inlink && !inlink1) //not connected\n\t\t\treturn;\n\t\tcontext.addCode(\"code\", return_type + \" \" + outlink + \" = ( (\" + inlink + \" - \"+minv+\") / (\"+ maxv+\" - \"+minv+\") ) * (\"+ maxv2+\" - \"+minv2+\") + \" + minv2 + \";\", this.shader_destination );\n\t\tthis.setOutputData( 0, return_type );\n\t}\n\n\tregisterShaderNode( \"output/discard\", LGraphShaderDiscard );\n\t*/\n\n\n\t// *************************************************\n\n\tfunction LGraphShaderOperation()\n\t{\n\t\tthis.addInput(\"A\", LGShaders.ALL_TYPES );\n\t\tthis.addInput(\"B\", LGShaders.ALL_TYPES );\n\t\tthis.addOutput(\"out\",\"\");\n\t\tthis.properties = {\n\t\t\toperation: \"*\"\n\t\t};\n\t\tthis.addWidget(\"combo\",\"op.\",this.properties.operation,{ property: \"operation\", values: LGraphShaderOperation.operations });\n\t}\n\n\tLGraphShaderOperation.title = \"Operation\";\n\tLGraphShaderOperation.operations = [\"+\",\"-\",\"*\",\"/\"];\n\n\tLGraphShaderOperation.prototype.getTitle = function()\n\t{\n\t\tif(this.flags.collapsed)\n\t\t\treturn \"A\" + this.properties.operation + \"B\";\n\t\telse\n\t\t\treturn \"Operation\";\n\t}\n\n\tLGraphShaderOperation.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination)\n\t\t\treturn;\n\n\t\tif(!this.isOutputConnected(0))\n\t\t\treturn;\n\n\t\tvar inlinks = [];\n\t\tfor(var i = 0; i < 3; ++i)\n\t\t\tinlinks.push( { name: getInputLinkID(this,i), type: this.getInputData(i) || \"float\" } );\n\n\t\tvar outlink = getOutputLinkID(this,0);\n\t\tif(!outlink) //not connected\n\t\t\treturn;\n\n\t\t//func_desc\n\t\tvar base_type = inlinks[0].type;\n\t\tvar return_type = base_type;\n\t\tvar op = this.properties.operation;\n\n\t\tvar params = [];\n\t\tfor(var i = 0; i < 2; ++i)\n\t\t{\n\t\t\tvar param_code = inlinks[i].name;\n\t\t\tif(param_code == null) //not plugged\n\t\t\t{\n\t\t\t\tparam_code = p.value != null ? p.value : \"(1.0)\";\n\t\t\t\tinlinks[i].type = \"float\";\n\t\t\t}\n\n\t\t\t//convert\n\t\t\tif( inlinks[i].type != base_type ) \n\t\t\t{\n\t\t\t\tif( inlinks[i].type == \"float\" && (op == \"*\" || op == \"/\") )\n\t\t\t\t{\n\t\t\t\t\t//I find hard to create the opposite condition now, so I prefeer an else\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tparam_code = convertVarToGLSLType( param_code, inlinks[i].type, base_type );\n\t\t\t}\n\t\t\tparams.push( param_code );\n\t\t}\n\t\t\n\t\tcontext.addCode(\"code\", return_type + \" \" + outlink + \" = \"+ params[0] + op + params[1] + \";\", this.shader_destination );\n\t\tthis.setOutputData( 0, return_type );\n\t}\n\n\tregisterShaderNode( \"math/operation\", LGraphShaderOperation );\n\n\n\tfunction LGraphShaderFunc()\n\t{\n\t\tthis.addInput(\"A\", LGShaders.ALL_TYPES );\n\t\tthis.addInput(\"B\", LGShaders.ALL_TYPES );\n\t\tthis.addOutput(\"out\",\"\");\n\t\tthis.properties = {\n\t\t\tfunc: \"floor\"\n\t\t};\n\t\tthis._current = \"floor\";\n\t\tthis.addWidget(\"combo\",\"func\",this.properties.func,{ property: \"func\", values: GLSL_functions_name });\n\t}\n\n\tLGraphShaderFunc.title = \"Func\";\n\n\tLGraphShaderFunc.prototype.onPropertyChanged = function(name,value)\n\t{\n\t\tif(this.graph)\n\t\t\tthis.graph._version++;\n\n\t\tif(name == \"func\")\n\t\t{\n\t\t\tvar func_desc = GLSL_functions[ value ];\n\t\t\tif(!func_desc)\n\t\t\t\treturn;\n\n\t\t\t//remove extra inputs\n\t\t\tfor(var i = func_desc.params.length; i < this.inputs.length; ++i)\n\t\t\t\tthis.removeInput(i);\n\n\t\t\t//add and update inputs\n\t\t\tfor(var i = 0; i < func_desc.params.length; ++i)\n\t\t\t{\n\t\t\t\tvar p = func_desc.params[i];\n\t\t\t\tif( this.inputs[i] )\n\t\t\t\t\tthis.inputs[i].name = p.name + (p.value ? \" (\" + p.value + \")\" : \"\");\n\t\t\t\telse\n\t\t\t\t\tthis.addInput( p.name, LGShaders.ALL_TYPES );\n\t\t\t}\n\t\t}\n\t}\n\n\tLGraphShaderFunc.prototype.getTitle = function()\n\t{\n\t\tif(this.flags.collapsed)\n\t\t\treturn this.properties.func;\n\t\telse\n\t\t\treturn \"Func\";\n\t}\n\n\tLGraphShaderFunc.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination)\n\t\t\treturn;\n\n\t\tif(!this.isOutputConnected(0))\n\t\t\treturn;\n\n\t\tvar inlinks = [];\n\t\tfor(var i = 0; i < 3; ++i)\n\t\t\tinlinks.push( { name: getInputLinkID(this,i), type: this.getInputData(i) || \"float\" } );\n\n\t\tvar outlink = getOutputLinkID(this,0);\n\t\tif(!outlink) //not connected\n\t\t\treturn;\n\n\t\tvar func_desc = GLSL_functions[ this.properties.func ];\n\t\tif(!func_desc)\n\t\t\treturn;\n\n\t\t//func_desc\n\t\tvar base_type = inlinks[0].type;\n\t\tvar return_type = func_desc.return_type;\n\t\tif( return_type == \"T\" )\n\t\t\treturn_type = base_type;\n\n\t\tvar params = [];\n\t\tfor(var i = 0; i < func_desc.params.length; ++i)\n\t\t{\n\t\t\tvar p = func_desc.params[i];\n\t\t\tvar param_code = inlinks[i].name;\n\t\t\tif(param_code == null) //not plugged\n\t\t\t{\n\t\t\t\tparam_code = p.value != null ? p.value : \"(1.0)\";\n\t\t\t\tinlinks[i].type = \"float\";\n\t\t\t}\n\t\t\tif( (p.type == \"T\" && inlinks[i].type != base_type) ||\n\t\t\t\t(p.type != \"T\" && inlinks[i].type != base_type) )\n\t\t\t\tparam_code = convertVarToGLSLType( param_code, inlinks[i].type, base_type );\n\t\t\tparams.push( param_code );\n\t\t}\n\t\t\n\t\tcontext.addFunction(\"round\",\"float round(float v){ return floor(v+0.5); }\\nvec2 round(vec2 v){ return floor(v+vec2(0.5));}\\nvec3 round(vec3 v){ return floor(v+vec3(0.5));}\\nvec4 round(vec4 v){ return floor(v+vec4(0.5)); }\\n\");\n\t\tcontext.addCode(\"code\", return_type + \" \" + outlink + \" = \"+func_desc.func+\"(\"+params.join(\",\")+\");\", this.shader_destination );\n\n\t\tthis.setOutputData( 0, return_type );\n\t}\n\n\tregisterShaderNode( \"math/func\", LGraphShaderFunc );\n\n\n\n\tfunction LGraphShaderSnippet()\n\t{\n\t\tthis.addInput(\"A\", LGShaders.ALL_TYPES );\n\t\tthis.addInput(\"B\", LGShaders.ALL_TYPES );\n\t\tthis.addOutput(\"C\",\"vec4\");\n\t\tthis.properties = {\n\t\t\tcode:\"C = A+B\",\n\t\t\ttype: \"vec4\"\n\t\t}\n\t\tthis.addWidget(\"text\",\"code\",this.properties.code,{ property: \"code\" });\n\t\tthis.addWidget(\"combo\",\"type\",this.properties.type,{ values:[\"float\",\"vec2\",\"vec3\",\"vec4\"], property: \"type\" });\n\t}\n\n\tLGraphShaderSnippet.title = \"Snippet\";\n\n\tLGraphShaderSnippet.prototype.onPropertyChanged = function(name,value)\n\t{\n\t\tif(this.graph)\n\t\t\tthis.graph._version++;\n\n\t\tif(name == \"type\"&& this.outputs[0].type != value)\n\t\t{\n\t\t\tthis.disconnectOutput(0);\n\t\t\tthis.outputs[0].type = value;\n\t\t}\n\t}\n\n\tLGraphShaderSnippet.prototype.getTitle = function()\n\t{\n\t\tif(this.flags.collapsed)\n\t\t\treturn this.properties.code;\n\t\telse\n\t\t\treturn \"Snippet\";\n\t}\n\n\tLGraphShaderSnippet.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination || !this.isOutputConnected(0))\n\t\t\treturn;\n\n\t\tvar inlinkA = getInputLinkID(this,0);\n\t\tif(!inlinkA)\n\t\t\tinlinkA = \"1.0\";\n\t\tvar inlinkB = getInputLinkID(this,1);\n\t\tif(!inlinkB)\n\t\t\tinlinkB = \"1.0\";\n\t\tvar outlink = getOutputLinkID(this,0);\n\t\tif(!outlink) //not connected\n\t\t\treturn;\n\n\t\tvar inA_type = this.getInputData(0) || \"float\";\n\t\tvar inB_type = this.getInputData(1) || \"float\";\n\t\tvar return_type = this.properties.type;\n\n\t\t//cannot resolve input\n\t\tif(inA_type == \"T\" || inB_type == \"T\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tvar funcname = \"funcSnippet\" + this.id;\n\n\t\tvar func_code = \"\\n\" + return_type + \" \" + funcname + \"( \" + inA_type + \" A, \" + inB_type + \" B) {\\n\";\n\t\tfunc_code += \"\t\" + return_type + \" C = \" + return_type + \"(0.0);\\n\";\n\t\tfunc_code += \"\t\" + this.properties.code + \";\\n\";\n\t\tfunc_code += \"\treturn C;\\n}\\n\";\n\n\t\tcontext.addCode(\"functions\", func_code, this.shader_destination );\n\t\tcontext.addCode(\"code\", return_type + \" \" + outlink + \" = \"+funcname+\"(\"+inlinkA+\",\"+inlinkB+\");\", this.shader_destination );\n\n\t\tthis.setOutputData( 0, return_type );\n\t}\n\n\tregisterShaderNode( \"utils/snippet\", LGraphShaderSnippet );\n\n\t//************************************\n\n\tfunction LGraphShaderRand()\n\t{\n\t\tthis.addOutput(\"out\",\"float\");\n\t}\n\n\tLGraphShaderRand.title = \"Rand\";\n\n\tLGraphShaderRand.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination || !this.isOutputConnected(0))\n\t\t\treturn;\n\n\t\tvar outlink = getOutputLinkID(this,0);\n\n\t\tcontext.addUniform( \"u_rand\" + this.id, \"float\", function(){ return Math.random(); });\n\t\tcontext.addCode(\"code\", \"float \" + outlink + \" = u_rand\" + this.id +\";\", this.shader_destination );\n\t\tthis.setOutputData( 0, \"float\" );\n\t}\n\n\tregisterShaderNode( \"input/rand\", LGraphShaderRand );\n\n\t//noise\n\t//https://gist.github.com/patriciogonzalezvivo/670c22f3966e662d2f83\n\tfunction LGraphShaderNoise()\n\t{\n\t\tthis.addInput(\"out\", LGShaders.ALL_TYPES );\n\t\tthis.addInput(\"scale\", \"float\" );\n\t\tthis.addOutput(\"out\",\"float\");\n\t\tthis.properties = {\n\t\t\ttype: \"noise\",\n\t\t\tscale: 1\n\t\t};\n\t\tthis.addWidget(\"combo\",\"type\", this.properties.type, { property: \"type\", values: LGraphShaderNoise.NOISE_TYPES });\n\t\tthis.addWidget(\"number\",\"scale\", this.properties.scale, { property: \"scale\" });\n\t}\n\n\tLGraphShaderNoise.NOISE_TYPES = [\"noise\",\"rand\"];\n\n\tLGraphShaderNoise.title = \"noise\";\n\n\tLGraphShaderNoise.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination || !this.isOutputConnected(0))\n\t\t\treturn;\n\n\t\tvar inlink = getInputLinkID(this,0);\n\t\tvar outlink = getOutputLinkID(this,0);\n\n\t\tvar intype = this.getInputData(0);\n\t\tif(!inlink)\n\t\t{\n\t\t\tintype = \"vec2\";\n\t\t\tinlink = context.buffer_names.uvs;\n\t\t}\n\n\t\tcontext.addFunction(\"noise\",LGraphShaderNoise.shader_functions);\n\t\tcontext.addUniform( \"u_noise_scale\" + this.id, \"float\", this.properties.scale );\n\t\tif( intype == \"float\" )\n\t\t\tcontext.addCode(\"code\", \"float \" + outlink + \" = snoise( vec2(\" + inlink +\") * u_noise_scale\" + this.id +\");\", this.shader_destination );\n\t\telse if( intype == \"vec2\" || intype == \"vec3\" )\n\t\t\tcontext.addCode(\"code\", \"float \" + outlink + \" = snoise(\" + inlink +\" * u_noise_scale\" + this.id +\");\", this.shader_destination );\n\t\telse if( intype == \"vec4\" )\n\t\t\tcontext.addCode(\"code\", \"float \" + outlink + \" = snoise(\" + inlink +\".xyz * u_noise_scale\" + this.id +\");\", this.shader_destination );\n\t\tthis.setOutputData( 0, \"float\" );\n\t}\n\n\tregisterShaderNode( \"math/noise\", LGraphShaderNoise );\n\nLGraphShaderNoise.shader_functions = \"\\n\\\nvec3 permute(vec3 x) { return mod(((x*34.0)+1.0)*x, 289.0); }\\n\\\n\\n\\\nfloat snoise(vec2 v){\\n\\\n  const vec4 C = vec4(0.211324865405187, 0.366025403784439,-0.577350269189626, 0.024390243902439);\\n\\\n  vec2 i  = floor(v + dot(v, C.yy) );\\n\\\n  vec2 x0 = v -   i + dot(i, C.xx);\\n\\\n  vec2 i1;\\n\\\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\\n\\\n  vec4 x12 = x0.xyxy + C.xxzz;\\n\\\n  x12.xy -= i1;\\n\\\n  i = mod(i, 289.0);\\n\\\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\\n\\\n  + i.x + vec3(0.0, i1.x, 1.0 ));\\n\\\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy),dot(x12.zw,x12.zw)), 0.0);\\n\\\n  m = m*m ;\\n\\\n  m = m*m ;\\n\\\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\\n\\\n  vec3 h = abs(x) - 0.5;\\n\\\n  vec3 ox = floor(x + 0.5);\\n\\\n  vec3 a0 = x - ox;\\n\\\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\\n\\\n  vec3 g;\\n\\\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\\n\\\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\\n\\\n  return 130.0 * dot(m, g);\\n\\\n}\\n\\\nvec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}\\n\\\nvec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}\\n\\\n\\n\\\nfloat snoise(vec3 v){ \\n\\\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\\n\\\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\\n\\\n\\n\\\n// First corner\\n\\\n  vec3 i  = floor(v + dot(v, C.yyy) );\\n\\\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\\n\\\n\\n\\\n// Other corners\\n\\\n  vec3 g = step(x0.yzx, x0.xyz);\\n\\\n  vec3 l = 1.0 - g;\\n\\\n  vec3 i1 = min( g.xyz, l.zxy );\\n\\\n  vec3 i2 = max( g.xyz, l.zxy );\\n\\\n\\n\\\n  //  x0 = x0 - 0. + 0.0 * C \\n\\\n  vec3 x1 = x0 - i1 + 1.0 * C.xxx;\\n\\\n  vec3 x2 = x0 - i2 + 2.0 * C.xxx;\\n\\\n  vec3 x3 = x0 - 1. + 3.0 * C.xxx;\\n\\\n\\n\\\n// Permutations\\n\\\n  i = mod(i, 289.0 ); \\n\\\n  vec4 p = permute( permute( permute( \\n\\\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\\n\\\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \\n\\\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\\n\\\n\\n\\\n// Gradients\\n\\\n// ( N*N points uniformly over a square, mapped onto an octahedron.)\\n\\\n  float n_ = 1.0/7.0; // N=7\\n\\\n  vec3  ns = n_ * D.wyz - D.xzx;\\n\\\n\\n\\\n  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\\n\\\n\\n\\\n  vec4 x_ = floor(j * ns.z);\\n\\\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\\n\\\n\\n\\\n  vec4 x = x_ *ns.x + ns.yyyy;\\n\\\n  vec4 y = y_ *ns.x + ns.yyyy;\\n\\\n  vec4 h = 1.0 - abs(x) - abs(y);\\n\\\n\\n\\\n  vec4 b0 = vec4( x.xy, y.xy );\\n\\\n  vec4 b1 = vec4( x.zw, y.zw );\\n\\\n\\n\\\n  vec4 s0 = floor(b0)*2.0 + 1.0;\\n\\\n  vec4 s1 = floor(b1)*2.0 + 1.0;\\n\\\n  vec4 sh = -step(h, vec4(0.0));\\n\\\n\\n\\\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\\n\\\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\\n\\\n\\n\\\n  vec3 p0 = vec3(a0.xy,h.x);\\n\\\n  vec3 p1 = vec3(a0.zw,h.y);\\n\\\n  vec3 p2 = vec3(a1.xy,h.z);\\n\\\n  vec3 p3 = vec3(a1.zw,h.w);\\n\\\n\\n\\\n//Normalise gradients\\n\\\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\\n\\\n  p0 *= norm.x;\\n\\\n  p1 *= norm.y;\\n\\\n  p2 *= norm.z;\\n\\\n  p3 *= norm.w;\\n\\\n\\n\\\n// Mix final noise value\\n\\\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\\n\\\n  m = m * m;\\n\\\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),dot(p2,x2), dot(p3,x3) ) );\\n\\\n}\\n\\\n\\n\\\nvec3 hash3( vec2 p ){\\n\\\n    vec3 q = vec3( dot(p,vec2(127.1,311.7)), \\n\\\n\t\t\t\t   dot(p,vec2(269.5,183.3)), \\n\\\n\t\t\t\t   dot(p,vec2(419.2,371.9)) );\\n\\\n\treturn fract(sin(q)*43758.5453);\\n\\\n}\\n\\\nvec4 hash4( vec3 p ){\\n\\\n    vec4 q = vec4( dot(p,vec3(127.1,311.7,257.3)), \\n\\\n\t\t\t\t   dot(p,vec3(269.5,183.3,335.1)), \\n\\\n\t\t\t\t   dot(p,vec3(314.5,235.1,467.3)), \\n\\\n\t\t\t\t   dot(p,vec3(419.2,371.9,114.9)) );\\n\\\n\treturn fract(sin(q)*43758.5453);\\n\\\n}\\n\\\n\\n\\\nfloat iqnoise( in vec2 x, float u, float v ){\\n\\\n    vec2 p = floor(x);\\n\\\n    vec2 f = fract(x);\\n\\\n\t\\n\\\n\tfloat k = 1.0+63.0*pow(1.0-v,4.0);\\n\\\n\t\\n\\\n\tfloat va = 0.0;\\n\\\n\tfloat wt = 0.0;\\n\\\n    for( int j=-2; j<=2; j++ )\\n\\\n    for( int i=-2; i<=2; i++ )\\n\\\n    {\\n\\\n        vec2 g = vec2( float(i),float(j) );\\n\\\n\t\tvec3 o = hash3( p + g )*vec3(u,u,1.0);\\n\\\n\t\tvec2 r = g - f + o.xy;\\n\\\n\t\tfloat d = dot(r,r);\\n\\\n\t\tfloat ww = pow( 1.0-smoothstep(0.0,1.414,sqrt(d)), k );\\n\\\n\t\tva += o.z*ww;\\n\\\n\t\twt += ww;\\n\\\n    }\\n\\\n\t\\n\\\n    return va/wt;\\n\\\n}\\n\\\n\"\n\n\tfunction LGraphShaderTime()\n\t{\n\t\tthis.addOutput(\"out\",\"float\");\n\t}\n\n\tLGraphShaderTime.title = \"Time\";\n\n\tLGraphShaderTime.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination || !this.isOutputConnected(0))\n\t\t\treturn;\n\n\t\tvar outlink = getOutputLinkID(this,0);\n\n\t\tcontext.addUniform( \"u_time\" + this.id, \"float\", function(){ return getTime() * 0.001; });\n\t\tcontext.addCode(\"code\", \"float \" + outlink + \" = u_time\" + this.id +\";\", this.shader_destination );\n\t\tthis.setOutputData( 0, \"float\" );\n\t}\n\n\tregisterShaderNode( \"input/time\", LGraphShaderTime );\n\n\n\tfunction LGraphShaderDither()\n\t{\n\t\tthis.addInput(\"in\",\"T\");\n\t\tthis.addOutput(\"out\",\"float\");\n\t}\n\n\tLGraphShaderDither.title = \"Dither\";\n\n\tLGraphShaderDither.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination || !this.isOutputConnected(0))\n\t\t\treturn;\n\n\t\tvar inlink = getInputLinkID(this,0);\n\t\tvar return_type = \"float\";\n\t\tvar outlink = getOutputLinkID(this,0);\n\t\tvar intype = this.getInputData(0);\n\t\tinlink = varToTypeGLSL( inlink, intype, \"float\" );\n\t\tcontext.addFunction(\"dither8x8\", LGraphShaderDither.dither_func);\n\t\tcontext.addCode(\"code\", return_type + \" \" + outlink + \" = dither8x8(\"+ inlink +\");\", this.shader_destination );\n\t\tthis.setOutputData( 0, return_type );\n\t}\n\n\tLGraphShaderDither.dither_values = [0.515625,0.140625,0.640625,0.046875,0.546875,0.171875,0.671875,0.765625,0.265625,0.890625,0.390625,0.796875,0.296875,0.921875,0.421875,0.203125,0.703125,0.078125,0.578125,0.234375,0.734375,0.109375,0.609375,0.953125,0.453125,0.828125,0.328125,0.984375,0.484375,0.859375,0.359375,0.0625,0.5625,0.1875,0.6875,0.03125,0.53125,0.15625,0.65625,0.8125,0.3125,0.9375,0.4375,0.78125,0.28125,0.90625,0.40625,0.25,0.75,0.125,0.625,0.21875,0.71875,0.09375,0.59375,1.0001,0.5,0.875,0.375,0.96875,0.46875,0.84375,0.34375];\n\t\n\tLGraphShaderDither.dither_func = \"\\n\\\n\t\tfloat dither8x8(float brightness) {\\n\\\n\t\t  vec2 position = vec2(0.0);\\n\\\n\t\t  #ifdef FRAGMENT\\n\\\n\t\t\tposition = gl_FragCoord.xy;\\n\\\n\t\t  #endif\\n\\\n\t\t  int x = int(mod(position.x, 8.0));\\n\\\n\t\t  int y = int(mod(position.y, 8.0));\\n\\\n\t\t  int index = x + y * 8;\\n\\\n\t\t  float limit = 0.0;\\n\\\n\t\t  if (x < 8) {\\n\\\n\t\t\tif(index==0) limit = 0.015625;\\n\\\n\t\t\t\"+(LGraphShaderDither.dither_values.map( function(v,i){ return \"else if(index== \"+(i+1)+\") limit = \" + v + \";\"}).join(\"\\n\"))+\"\\n\\\n\t\t  }\\n\\\n\t\t  return brightness < limit ? 0.0 : 1.0;\\n\\\n\t\t}\\n\",\n\n\tregisterShaderNode( \"math/dither\", LGraphShaderDither );\n\n\tfunction LGraphShaderRemap()\n\t{\n\t\tthis.addInput(\"\", LGShaders.ALL_TYPES );\n\t\tthis.addOutput(\"\",\"\");\n\t\tthis.properties = {\n\t\t\tmin_value: 0,\n\t\t\tmax_value: 1,\n\t\t\tmin_value2: 0,\n\t\t\tmax_value2: 1\n\t\t};\n\t\tthis.addWidget(\"number\",\"min\",0,{ step: 0.1, property: \"min_value\" });\n\t\tthis.addWidget(\"number\",\"max\",1,{ step: 0.1, property: \"max_value\" });\n\t\tthis.addWidget(\"number\",\"min2\",0,{ step: 0.1, property: \"min_value2\"});\n\t\tthis.addWidget(\"number\",\"max2\",1,{ step: 0.1, property: \"max_value2\"});\n\t}\n\n\tLGraphShaderRemap.title = \"Remap\";\n\n\tLGraphShaderRemap.prototype.onPropertyChanged = function()\n\t{\n\t\tif(this.graph)\n\t\t\tthis.graph._version++;\n\t}\n\n\tLGraphShaderRemap.prototype.onConnectionsChange = function()\n\t{\n\t\tvar return_type = this.getInputDataType(0);\n\t\tthis.outputs[0].type = return_type || \"T\";\n\t}\n\n\tLGraphShaderRemap.prototype.onGetCode = function( context )\n\t{\n\t\tif(!this.shader_destination || !this.isOutputConnected(0))\n\t\t\treturn;\n\n\t\tvar inlink = getInputLinkID(this,0);\n\t\tvar outlink = getOutputLinkID(this,0);\n\t\tif(!inlink && !outlink) //not connected\n\t\t\treturn;\n\n\t\tvar return_type = this.getInputDataType(0);\n\t\tthis.outputs[0].type = return_type;\n\t\tif(return_type == \"T\")\n\t\t{\n\t\t\tconsole.warn(\"node type is T and cannot be resolved\");\n\t\t\treturn;\n\t\t}\n\n\t\tif(!inlink)\n\t\t{\n\t\t\tcontext.addCode(\"code\",\"\t\" + return_type + \" \" + outlink + \" = \" + return_type + \"(0.0);\\n\");\n\t\t\treturn;\n\t\t}\n\n\t\tvar minv = valueToGLSL( this.properties.min_value );\n\t\tvar maxv = valueToGLSL( this.properties.max_value );\n\t\tvar minv2 = valueToGLSL( this.properties.min_value2 );\n\t\tvar maxv2 = valueToGLSL( this.properties.max_value2 );\n\n\t\tcontext.addCode(\"code\", return_type + \" \" + outlink + \" = ( (\" + inlink + \" - \"+minv+\") / (\"+ maxv+\" - \"+minv+\") ) * (\"+ maxv2+\" - \"+minv2+\") + \" + minv2 + \";\", this.shader_destination );\n\t\tthis.setOutputData( 0, return_type );\n\t}\n\n\tregisterShaderNode( \"math/remap\", LGraphShaderRemap );\n\n})(this);\n\n\n\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n\tvar view_matrix = new Float32Array(16);\n\tvar projection_matrix = new Float32Array(16);\n\tvar viewprojection_matrix = new Float32Array(16);\n\tvar model_matrix = new Float32Array(16);\n\tvar global_uniforms = {\n\t\tu_view: view_matrix,\n\t\tu_projection: projection_matrix,\n\t\tu_viewprojection: viewprojection_matrix,\n\t\tu_model: model_matrix \n\t};\n\n\tLiteGraph.LGraphRender = {\n\t\tonRequestCameraMatrices: null //overwrite with your 3D engine specifics, it will receive (view_matrix, projection_matrix,viewprojection_matrix) and must be filled\n\t};\n\n\tfunction generateGeometryId() {\n\t\treturn (Math.random() * 100000)|0;\n\t}\n\n\tfunction LGraphPoints3D() {\n\n\t\tthis.addInput(\"obj\", \"\");\n\t\tthis.addInput(\"radius\", \"number\");\n\n\t\tthis.addOutput(\"out\", \"geometry\");\n\t\tthis.addOutput(\"points\", \"[vec3]\");\n\t\tthis.properties = {\n\t\t\tradius: 1,\n\t\t\tnum_points: 4096,\n\t\t\tgenerate_normals: true,\n\t\t\tregular: false,\n\t\t\tmode: LGraphPoints3D.SPHERE,\n\t\t\tforce_update: false\n\t\t};\n\n\t\tthis.points = new Float32Array( this.properties.num_points * 3 );\n\t\tthis.normals = new Float32Array( this.properties.num_points * 3 );\n\t\tthis.must_update = true;\n\t\tthis.version = 0;\n\n\t\tvar that = this;\n\t\tthis.addWidget(\"button\",\"update\",null, function(){ that.must_update = true; });\n\n\t\tthis.geometry = {\n\t\t\tvertices: null,\n\t\t\t_id: generateGeometryId()\n\t\t}\n\n\t\tthis._old_obj = null;\n\t\tthis._last_radius = null;\n\t}\n\n\tglobal.LGraphPoints3D = LGraphPoints3D;\n\n\tLGraphPoints3D.RECTANGLE = 1;\n\tLGraphPoints3D.CIRCLE = 2;\n\n\tLGraphPoints3D.CUBE = 10;\n\tLGraphPoints3D.SPHERE = 11;\n\tLGraphPoints3D.HEMISPHERE = 12;\n\tLGraphPoints3D.INSIDE_SPHERE = 13;\n\n\tLGraphPoints3D.OBJECT = 20;\n\tLGraphPoints3D.OBJECT_UNIFORMLY = 21;\n\tLGraphPoints3D.OBJECT_INSIDE = 22;\n\n\tLGraphPoints3D.MODE_VALUES = { \"rectangle\":LGraphPoints3D.RECTANGLE, \"circle\":LGraphPoints3D.CIRCLE, \"cube\":LGraphPoints3D.CUBE, \"sphere\":LGraphPoints3D.SPHERE, \"hemisphere\":LGraphPoints3D.HEMISPHERE, \"inside_sphere\":LGraphPoints3D.INSIDE_SPHERE, \"object\":LGraphPoints3D.OBJECT, \"object_uniformly\":LGraphPoints3D.OBJECT_UNIFORMLY, \"object_inside\":LGraphPoints3D.OBJECT_INSIDE };\n\n\tLGraphPoints3D.widgets_info = {\n\t\tmode: { widget: \"combo\", values: LGraphPoints3D.MODE_VALUES }\n\t};\n\n\tLGraphPoints3D.title = \"list of points\";\n\tLGraphPoints3D.desc = \"returns an array of points\";\n\n\tLGraphPoints3D.prototype.onPropertyChanged = function(name,value)\n\t{\n\t\tthis.must_update = true;\n\t}\n\n\tLGraphPoints3D.prototype.onExecute = function() {\n\n\t\tvar obj = this.getInputData(0);\n\t\tif( obj != this._old_obj || (obj && obj._version != this._old_obj_version) )\n\t\t{\n\t\t\tthis._old_obj = obj;\n\t\t\tthis.must_update = true;\n\t\t}\n\n\t\tvar radius = this.getInputData(1);\n\t\tif(radius == null)\n\t\t\tradius = this.properties.radius;\n\t\tif( this._last_radius != radius )\n\t\t{\n\t\t\tthis._last_radius = radius;\n\t\t\tthis.must_update = true;\n\t\t}\n\n\t\tif(this.must_update || this.properties.force_update )\n\t\t{\n\t\t\tthis.must_update = false;\n\t\t\tthis.updatePoints();\n\t\t}\n\n\t\tthis.geometry.vertices = this.points;\n\t\tthis.geometry.normals = this.normals;\n\t\tthis.geometry._version = this.version;\n\n\t\tthis.setOutputData( 0, this.geometry );\n\t}\n\n\tLGraphPoints3D.prototype.updatePoints = function() {\n\t\tvar num_points = this.properties.num_points|0;\n\t\tif(num_points < 1)\n\t\t\tnum_points = 1;\n\n\t\tif(!this.points || this.points.length != num_points * 3)\n\t\t\tthis.points = new Float32Array( num_points * 3 );\n\n\t\tif(this.properties.generate_normals)\n\t\t{\n\t\t\tif (!this.normals || this.normals.length != this.points.length)\n\t\t\t\tthis.normals = new Float32Array( this.points.length );\n\t\t}\n\t\telse\n\t\t\tthis.normals = null;\n\n\t\tvar radius = this._last_radius || this.properties.radius;\n\t\tvar mode = this.properties.mode;\n\n\t\tvar obj = this.getInputData(0);\n\t\tthis._old_obj_version = obj ? obj._version : null;\n\n\t\tthis.points = LGraphPoints3D.generatePoints( radius, num_points, mode, this.points, this.normals, this.properties.regular, obj );\n\n\t\tthis.version++;\n\t}\n\n\t//global\n\tLGraphPoints3D.generatePoints = function( radius, num_points, mode, points, normals, regular, obj )\n\t{\n\t\tvar size = num_points * 3;\n\t\tif(!points || points.length != size)\n\t\t\tpoints = new Float32Array( size );\n\t\tvar temp = new Float32Array(3);\n\t\tvar UP = new Float32Array([0,1,0]);\n\n\t\tif(regular)\n\t\t{\n\t\t\tif( mode == LGraphPoints3D.RECTANGLE)\n\t\t\t{\n\t\t\t\tvar side = Math.floor(Math.sqrt(num_points));\n\t\t\t\tfor(var i = 0; i < side; ++i)\n\t\t\t\tfor(var j = 0; j < side; ++j)\n\t\t\t\t{\n\t\t\t\t\tvar pos = i*3 + j*3*side;\n\t\t\t\t\tpoints[pos] = ((i/side) - 0.5) * radius * 2;\n\t\t\t\t\tpoints[pos+1] = 0;\n\t\t\t\t\tpoints[pos+2] = ((j/side) - 0.5) * radius * 2;\n\t\t\t\t}\n\t\t\t\tpoints = new Float32Array( points.subarray(0,side*side*3) );\n\t\t\t\tif(normals)\n\t\t\t\t{\n\t\t\t\t\tfor(var i = 0; i < normals.length; i+=3)\n\t\t\t\t\t\tnormals.set(UP, i);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if( mode == LGraphPoints3D.SPHERE)\n\t\t\t{\n\t\t\t\tvar side = Math.floor(Math.sqrt(num_points));\n\t\t\t\tfor(var i = 0; i < side; ++i)\n\t\t\t\tfor(var j = 0; j < side; ++j)\n\t\t\t\t{\n\t\t\t\t\tvar pos = i*3 + j*3*side;\n\t\t\t\t\tpolarToCartesian( temp, (i/side) * 2 * Math.PI, ((j/side) - 0.5) * 2 * Math.PI, radius );\n\t\t\t\t\tpoints[pos] = temp[0];\n\t\t\t\t\tpoints[pos+1] = temp[1];\n\t\t\t\t\tpoints[pos+2] = temp[2];\n\t\t\t\t}\n\t\t\t\tpoints = new Float32Array( points.subarray(0,side*side*3) );\n\t\t\t\tif(normals)\n\t\t\t\t\tLGraphPoints3D.generateSphericalNormals( points, normals );\n\t\t\t}\n\t\t\telse if( mode == LGraphPoints3D.CIRCLE)\n\t\t\t{\n\t\t\t\tfor(var i = 0; i < size; i+=3)\n\t\t\t\t{\n\t\t\t\t\tvar angle = 2 * Math.PI * (i/size);\n\t\t\t\t\tpoints[i] = Math.cos( angle ) * radius;\n\t\t\t\t\tpoints[i+1] = 0;\n\t\t\t\t\tpoints[i+2] = Math.sin( angle ) * radius;\n\t\t\t\t}\n\t\t\t\tif(normals)\n\t\t\t\t{\n\t\t\t\t\tfor(var i = 0; i < normals.length; i+=3)\n\t\t\t\t\t\tnormals.set(UP, i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse //non regular\n\t\t{\n\t\t\tif( mode == LGraphPoints3D.RECTANGLE)\n\t\t\t{\n\t\t\t\tfor(var i = 0; i < size; i+=3)\n\t\t\t\t{\n\t\t\t\t\tpoints[i] = (Math.random() - 0.5) * radius * 2;\n\t\t\t\t\tpoints[i+1] = 0;\n\t\t\t\t\tpoints[i+2] = (Math.random() - 0.5) * radius * 2;\n\t\t\t\t}\n\t\t\t\tif(normals)\n\t\t\t\t{\n\t\t\t\t\tfor(var i = 0; i < normals.length; i+=3)\n\t\t\t\t\t\tnormals.set(UP, i);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if( mode == LGraphPoints3D.CUBE)\n\t\t\t{\n\t\t\t\tfor(var i = 0; i < size; i+=3)\n\t\t\t\t{\n\t\t\t\t\tpoints[i] = (Math.random() - 0.5) * radius * 2;\n\t\t\t\t\tpoints[i+1] = (Math.random() - 0.5) * radius * 2;\n\t\t\t\t\tpoints[i+2] = (Math.random() - 0.5) * radius * 2;\n\t\t\t\t}\n\t\t\t\tif(normals)\n\t\t\t\t{\n\t\t\t\t\tfor(var i = 0; i < normals.length; i+=3)\n\t\t\t\t\t\tnormals.set(UP, i);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if( mode == LGraphPoints3D.SPHERE)\n\t\t\t{\n\t\t\t\tLGraphPoints3D.generateSphere( points, size, radius );\n\t\t\t\tif(normals)\n\t\t\t\t\tLGraphPoints3D.generateSphericalNormals( points, normals );\n\t\t\t}\n\t\t\telse if( mode == LGraphPoints3D.HEMISPHERE)\n\t\t\t{\n\t\t\t\tLGraphPoints3D.generateHemisphere( points, size, radius );\n\t\t\t\tif(normals)\n\t\t\t\t\tLGraphPoints3D.generateSphericalNormals( points, normals );\n\t\t\t}\n\t\t\telse if( mode == LGraphPoints3D.CIRCLE)\n\t\t\t{\n\t\t\t\tLGraphPoints3D.generateInsideCircle( points, size, radius );\n\t\t\t\tif(normals)\n\t\t\t\t\tLGraphPoints3D.generateSphericalNormals( points, normals );\n\t\t\t}\n\t\t\telse if( mode == LGraphPoints3D.INSIDE_SPHERE)\n\t\t\t{\n\t\t\t\tLGraphPoints3D.generateInsideSphere( points, size, radius );\n\t\t\t\tif(normals)\n\t\t\t\t\tLGraphPoints3D.generateSphericalNormals( points, normals );\n\t\t\t}\n\t\t\telse if( mode == LGraphPoints3D.OBJECT)\n\t\t\t{\n\t\t\t\tLGraphPoints3D.generateFromObject( points, normals, size, obj, false );\n\t\t\t}\n\t\t\telse if( mode == LGraphPoints3D.OBJECT_UNIFORMLY)\n\t\t\t{\n\t\t\t\tLGraphPoints3D.generateFromObject( points, normals, size, obj, true );\n\t\t\t}\n\t\t\telse if( mode == LGraphPoints3D.OBJECT_INSIDE)\n\t\t\t{\n\t\t\t\tLGraphPoints3D.generateFromInsideObject( points, size, obj );\n\t\t\t\t//if(normals)\n\t\t\t\t//\tLGraphPoints3D.generateSphericalNormals( points, normals );\n\t\t\t}\n\t\t\telse\n\t\t\t\tconsole.warn(\"wrong mode in LGraphPoints3D\");\n\t\t}\n\n\t\treturn points;\n\t}\n\n\tLGraphPoints3D.generateSphericalNormals = function(points, normals)\n\t{\n\t\tvar temp = new Float32Array(3);\n\t\tfor(var i = 0; i < normals.length; i+=3)\n\t\t{\n\t\t\ttemp[0] = points[i];\n\t\t\ttemp[1] = points[i+1];\n\t\t\ttemp[2] = points[i+2];\n\t\t\tvec3.normalize(temp,temp);\n\t\t\tnormals.set(temp,i);\n\t\t}\n\t}\n\n\tLGraphPoints3D.generateSphere = function (points, size, radius)\n\t{\n\t\tfor(var i = 0; i < size; i+=3)\n\t\t{\n\t\t\tvar r1 = Math.random();\n\t\t\tvar r2 = Math.random();\n\t\t\tvar x = 2 * Math.cos( 2 * Math.PI * r1 ) * Math.sqrt( r2 * (1-r2) );\n\t\t\tvar y = 1 - 2 * r2;\n\t\t\tvar z = 2 * Math.sin( 2 * Math.PI * r1 ) * Math.sqrt( r2 * (1-r2) );\n\t\t\tpoints[i] = x * radius;\n\t\t\tpoints[i+1] = y * radius;\n\t\t\tpoints[i+2] = z * radius;\n\t\t}\t\t\t\n\t}\n\n\tLGraphPoints3D.generateHemisphere = function (points, size, radius)\n\t{\n\t\tfor(var i = 0; i < size; i+=3)\n\t\t{\n\t\t\tvar r1 = Math.random();\n\t\t\tvar r2 = Math.random();\n\t\t\tvar x = Math.cos( 2 * Math.PI * r1 ) * Math.sqrt(1 - r2*r2 );\n\t\t\tvar y = r2;\n\t\t\tvar z = Math.sin( 2 * Math.PI * r1 ) * Math.sqrt(1 - r2*r2 );\n\t\t\tpoints[i] = x * radius;\n\t\t\tpoints[i+1] = y * radius;\n\t\t\tpoints[i+2] = z * radius;\n\t\t}\n\t}\n\n\tLGraphPoints3D.generateInsideCircle = function (points, size, radius)\n\t{\n\t\tfor(var i = 0; i < size; i+=3)\n\t\t{\n\t\t\tvar r1 = Math.random();\n\t\t\tvar r2 = Math.random();\n\t\t\tvar x = Math.cos( 2 * Math.PI * r1 ) * Math.sqrt(1 - r2*r2 );\n\t\t\tvar y = r2;\n\t\t\tvar z = Math.sin( 2 * Math.PI * r1 ) * Math.sqrt(1 - r2*r2 );\n\t\t\tpoints[i] = x * radius;\n\t\t\tpoints[i+1] = 0;\n\t\t\tpoints[i+2] = z * radius;\n\t\t}\n\t}\n\n\tLGraphPoints3D.generateInsideSphere = function (points, size, radius)\n\t{\n\t\tfor(var i = 0; i < size; i+=3)\n\t\t{\n\t\t\tvar u = Math.random();\n\t\t\tvar v = Math.random();\n\t\t\tvar theta = u * 2.0 * Math.PI;\n\t\t\tvar phi = Math.acos(2.0 * v - 1.0);\n\t\t\tvar r = Math.cbrt(Math.random()) * radius;\n\t\t\tvar sinTheta = Math.sin(theta);\n\t\t\tvar cosTheta = Math.cos(theta);\n\t\t\tvar sinPhi = Math.sin(phi);\n\t\t\tvar cosPhi = Math.cos(phi);\n\t\t\tpoints[i] = r * sinPhi * cosTheta;\n\t\t\tpoints[i+1] = r * sinPhi * sinTheta;\n\t\t\tpoints[i+2] = r * cosPhi;\n\t\t}\t\n\t}\n\n\tfunction findRandomTriangle( areas, f )\n\t{\n\t\tvar l = areas.length;\n\t\tvar imin = 0;\n\t\tvar imid = 0;\n\t\tvar imax = l;\n\n\t\tif(l == 0)\n\t\t\treturn -1;\n\t\tif(l == 1)\n\t\t\treturn 0;\n\t\t//dichotimic search\n\t\twhile (imax >= imin)\n\t\t{\n\t\t\timid = ((imax + imin)*0.5)|0;\n\t\t\tvar t = areas[ imid ];\n\t\t\tif( t == f )\n\t\t\t\treturn imid; \n\t\t\tif( imin == (imax - 1) )\n\t\t\t\treturn imin;\n\t\t\tif (t < f)\n\t\t\t\timin = imid;\n\t\t\telse         \n\t\t\t\timax = imid;\n\t\t}\n\t\treturn imid;\t\t\n\t}\n\n\tLGraphPoints3D.generateFromObject = function( points, normals, size, obj, evenly )\n\t{\n\t\tif(!obj)\n\t\t\treturn;\n\n\t\tvar vertices = null;\n\t\tvar mesh_normals = null;\n\t\tvar indices = null;\n\t\tvar areas = null;\n\t\tif( obj.constructor === GL.Mesh )\n\t\t{\n\t\t\tvertices = obj.vertexBuffers.vertices.data;\n\t\t\tmesh_normals = obj.vertexBuffers.normals ? obj.vertexBuffers.normals.data : null;\n\t\t\tindices = obj.indexBuffers.indices ? obj.indexBuffers.indices.data : null;\n\t\t\tif(!indices)\n\t\t\t\tindices = obj.indexBuffers.triangles ? obj.indexBuffers.triangles.data : null;\n\t\t}\n\t\tif(!vertices)\n\t\t\treturn null;\n\t\tvar num_triangles = indices ? indices.length / 3 : vertices.length / (3*3);\n\t\tvar total_area = 0; //sum of areas of all triangles\n\n\t\tif(evenly)\n\t\t{\n\t\t\tareas = new Float32Array(num_triangles); //accum\n\t\t\tfor(var i = 0; i < num_triangles; ++i)\n\t\t\t{\n\t\t\t\tif(indices)\n\t\t\t\t{\n\t\t\t\t\ta = indices[i*3]*3;\n\t\t\t\t\tb = indices[i*3+1]*3;\n\t\t\t\t\tc = indices[i*3+2]*3;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ta = i*9;\n\t\t\t\t\tb = i*9+3;\n\t\t\t\t\tc = i*9+6;\n\t\t\t\t}\n\t\t\t\tvar P1 = vertices.subarray(a,a+3);\n\t\t\t\tvar P2 = vertices.subarray(b,b+3);\n\t\t\t\tvar P3 = vertices.subarray(c,c+3);\n\t\t\t\tvar aL = vec3.distance( P1, P2 );\n\t\t\t\tvar bL = vec3.distance( P2, P3 );\n\t\t\t\tvar cL = vec3.distance( P3, P1 );\n\t\t\t\tvar s = (aL + bL+ cL) / 2;\n\t\t\t\ttotal_area += Math.sqrt(s * (s - aL) * (s - bL) * (s - cL));\n\t\t\t\tareas[i] = total_area;\n\t\t\t}\t\t\t\n\t\t\tfor(var i = 0; i < num_triangles; ++i) //normalize\n\t\t\t\tareas[i] /= total_area;\n\t\t}\n\n\t\tfor(var i = 0; i < size; i+=3)\n\t\t{\n\t\t\tvar r = Math.random();\n\t\t\tvar index = evenly ? findRandomTriangle( areas, r ) : Math.floor(r * num_triangles );\n\t\t\t//get random triangle\n\t\t\tvar a = 0;\n\t\t\tvar b = 0;\n\t\t\tvar c = 0;\n\t\t\tif(indices)\n\t\t\t{\n\t\t\t\ta = indices[index*3]*3;\n\t\t\t\tb = indices[index*3+1]*3;\n\t\t\t\tc = indices[index*3+2]*3;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ta = index*9;\n\t\t\t\tb = index*9+3;\n\t\t\t\tc = index*9+6;\n\t\t\t}\n\t\t\tvar s = Math.random();\n\t\t\tvar t = Math.random();\n\t\t\tvar sqrt_s = Math.sqrt(s);\n\t\t\tvar af = 1 - sqrt_s;\n\t\t\tvar bf = sqrt_s * ( 1 - t);\n\t\t\tvar cf = t * sqrt_s;\n\t\t\tpoints[i] = af * vertices[a] + bf*vertices[b] + cf*vertices[c];\n\t\t\tpoints[i+1] = af * vertices[a+1] + bf*vertices[b+1] + cf*vertices[c+1];\n\t\t\tpoints[i+2] = af * vertices[a+2] + bf*vertices[b+2] + cf*vertices[c+2];\n\t\t\tif(normals && mesh_normals)\n\t\t\t{\n\t\t\t\tnormals[i] = af * mesh_normals[a] + bf*mesh_normals[b] + cf*mesh_normals[c];\n\t\t\t\tnormals[i+1] = af * mesh_normals[a+1] + bf*mesh_normals[b+1] + cf*mesh_normals[c+1];\n\t\t\t\tnormals[i+2] = af * mesh_normals[a+2] + bf*mesh_normals[b+2] + cf*mesh_normals[c+2];\n\t\t\t\tvar N = normals.subarray(i,i+3);\n\t\t\t\tvec3.normalize(N,N);\n\t\t\t}\n\t\t}\n\t}\n\n\tLGraphPoints3D.generateFromInsideObject = function( points, size, mesh )\n\t{\n\t\tif(!mesh || mesh.constructor !== GL.Mesh)\n\t\t\treturn;\n\n\t\tvar aabb = mesh.getBoundingBox();\n\t\tif(!mesh.octree)\n\t\t\tmesh.octree = new GL.Octree( mesh );\n\t\tvar octree = mesh.octree;\n\t\tvar origin = vec3.create();\n\t\tvar direction = vec3.fromValues(1,0,0);\n\t\tvar temp = vec3.create();\n\t\tvar i = 0;\n\t\tvar tries = 0;\n\t\twhile(i < size && tries < points.length * 10) //limit to avoid problems\n\t\t{\n\t\t\ttries += 1\n\t\t\tvar r = vec3.random(temp); //random point inside the aabb\n\t\t\tr[0] = (r[0] * 2 - 1) * aabb[3] + aabb[0];\n\t\t\tr[1] = (r[1] * 2 - 1) * aabb[4] + aabb[1];\n\t\t\tr[2] = (r[2] * 2 - 1) * aabb[5] + aabb[2];\n\t\t\torigin.set(r);\n\t\t\tvar hit = octree.testRay( origin, direction, 0, 10000, true, GL.Octree.ALL );\n\t\t\tif(!hit || hit.length % 2 == 0) //not inside\n\t\t\t\tcontinue;\n\t\t\tpoints.set( r, i );\n\t\t\ti+=3;\n\t\t}\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/points3D\", LGraphPoints3D );\n\n\n\n\tfunction LGraphPointsToInstances() {\n\t\tthis.addInput(\"points\", \"geometry\");\n\t\tthis.addOutput(\"instances\", \"[mat4]\");\n\t\tthis.properties = {\n\t\t\tmode: 1,\n\t\t\tautoupdate: true\n\t\t};\n\n\t\tthis.must_update = true;\n\t\tthis.matrices = [];\n\t\tthis.first_time = true;\n\t}\n\n\tLGraphPointsToInstances.NORMAL = 0;\n\tLGraphPointsToInstances.VERTICAL = 1;\n\tLGraphPointsToInstances.SPHERICAL = 2;\n\tLGraphPointsToInstances.RANDOM = 3;\n\tLGraphPointsToInstances.RANDOM_VERTICAL = 4;\n\n\tLGraphPointsToInstances.modes = {\"normal\":0,\"vertical\":1,\"spherical\":2,\"random\":3,\"random_vertical\":4};\n\tLGraphPointsToInstances.widgets_info = {\n\t\tmode: { widget: \"combo\", values: LGraphPointsToInstances.modes }\n\t};\n\n\tLGraphPointsToInstances.title = \"points to inst\";\n\n\tLGraphPointsToInstances.prototype.onExecute = function()\n\t{\n\t\tvar geo = this.getInputData(0);\n\t\tif( !geo )\n\t\t{\n\t\t\tthis.setOutputData(0,null);\n\t\t\treturn;\n\t\t}\n\n\t\tif( !this.isOutputConnected(0) )\n\t\t\treturn;\n\n\t\tvar has_changed = (geo._version != this._version || geo._id != this._geometry_id);\n\n\t\tif( has_changed && this.properties.autoupdate || this.first_time )\n\t\t{\n\t\t\tthis.first_time = false;\n\t\t\tthis.updateInstances( geo );\n\t\t}\n\n\t\tthis.setOutputData( 0, this.matrices );\n\t}\n\n\tLGraphPointsToInstances.prototype.updateInstances = function( geometry )\n\t{\n\t\tvar vertices = geometry.vertices;\n\t\tif(!vertices)\n\t\t\treturn null;\n\t\tvar normals = geometry.normals;\n\n\t\tvar matrices = this.matrices;\n\t\tvar num_points = vertices.length / 3;\n\t\tif( matrices.length != num_points)\n\t\t\tmatrices.length = num_points;\n\t\tvar identity = mat4.create();\n\t\tvar temp = vec3.create();\n\t\tvar zero = vec3.create();\n\t\tvar UP = vec3.fromValues(0,1,0);\n\t\tvar FRONT = vec3.fromValues(0,0,-1);\n\t\tvar RIGHT = vec3.fromValues(1,0,0);\n\t\tvar R = quat.create();\n\n\t\tvar front = vec3.create();\n\t\tvar right = vec3.create();\n\t\tvar top = vec3.create();\n\n\t\tfor(var i = 0; i < vertices.length; i += 3)\n\t\t{\n\t\t\tvar index = i/3;\n\t\t\tvar m = matrices[index];\n\t\t\tif(!m)\n\t\t\t\tm = matrices[index] = mat4.create();\n\t\t\tm.set( identity );\n\t\t\tvar point = vertices.subarray(i,i+3);\n\n\t\t\tswitch(this.properties.mode)\n\t\t\t{\n\t\t\t\tcase LGraphPointsToInstances.NORMAL: \n\t\t\t\t\tmat4.setTranslation( m, point );\n\t\t\t\t\tif(normals)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar normal = normals.subarray(i,i+3);\n\t\t\t\t\t\ttop.set( normal );\n\t\t\t\t\t\tvec3.normalize( top, top );\n\t\t\t\t\t\tvec3.cross( right, FRONT, top );\n\t\t\t\t\t\tvec3.normalize( right, right );\n\t\t\t\t\t\tvec3.cross( front, right, top );\n\t\t\t\t\t\tvec3.normalize( front, front );\n\t\t\t\t\t\tm.set(right,0);\n\t\t\t\t\t\tm.set(top,4);\n\t\t\t\t\t\tm.set(front,8);\n\t\t\t\t\t\tmat4.setTranslation( m, point );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase LGraphPointsToInstances.VERTICAL: \n\t\t\t\t\tmat4.setTranslation( m, point );\n\t\t\t\t\tbreak;\n\t\t\t\tcase LGraphPointsToInstances.SPHERICAL: \n\t\t\t\t\tfront.set( point );\n\t\t\t\t\tvec3.normalize( front, front );\n\t\t\t\t\tvec3.cross( right, UP, front );\n\t\t\t\t\tvec3.normalize( right, right );\n\t\t\t\t\tvec3.cross( top, front, right );\n\t\t\t\t\tvec3.normalize( top, top );\n\t\t\t\t\tm.set(right,0);\n\t\t\t\t\tm.set(top,4);\n\t\t\t\t\tm.set(front,8);\n\t\t\t\t\tmat4.setTranslation( m, point );\n\t\t\t\t\tbreak;\n\t\t\t\tcase LGraphPointsToInstances.RANDOM:\n\t\t\t\t\ttemp[0] = Math.random()*2 - 1;\n\t\t\t\t\ttemp[1] = Math.random()*2 - 1;\n\t\t\t\t\ttemp[2] = Math.random()*2 - 1;\n\t\t\t\t\tvec3.normalize( temp, temp );\n\t\t\t\t\tquat.setAxisAngle( R, temp, Math.random() * 2 * Math.PI );\n\t\t\t\t\tmat4.fromQuat(m, R);\n\t\t\t\t\tmat4.setTranslation( m, point );\n\t\t\t\t\tbreak;\n\t\t\t\tcase LGraphPointsToInstances.RANDOM_VERTICAL:\n\t\t\t\t\tquat.setAxisAngle( R, UP, Math.random() * 2 * Math.PI );\n\t\t\t\t\tmat4.fromQuat(m, R);\n\t\t\t\t\tmat4.setTranslation( m, point );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis._version = geometry._version;\n\t\tthis._geometry_id = geometry._id;\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/points_to_instances\", LGraphPointsToInstances );\n\n\n\tfunction LGraphGeometryTransform() {\n\t\tthis.addInput(\"in\", \"geometry,[mat4]\");\n\t\tthis.addInput(\"mat4\", \"mat4\");\n\t\tthis.addOutput(\"out\", \"geometry\");\n\t\tthis.properties = {};\n\n\t\tthis.geometry = {\n\t\t\ttype: \"triangles\",\n\t\t\tvertices: null,\n\t\t\t_id: generateGeometryId(),\n\t\t\t_version: 0\n\t\t};\n\n\t\tthis._last_geometry_id = -1;\n\t\tthis._last_version = -1;\n\t\tthis._last_key = \"\";\n\n\t\tthis.must_update = true;\n\t}\n\n\tLGraphGeometryTransform.title = \"Transform\";\n\n\tLGraphGeometryTransform.prototype.onExecute = function() {\n\n\t\tvar input = this.getInputData(0);\n\t\tvar model = this.getInputData(1);\n\n\t\tif(!input)\n\t\t\treturn;\n\n\t\t//array of matrices\n\t\tif(input.constructor === Array)\n\t\t{\n\t\t\tif(input.length == 0)\n\t\t\t\treturn;\n\t\t\tthis.outputs[0].type = \"[mat4]\";\n\t\t\tif( !this.isOutputConnected(0) )\n\t\t\t\treturn;\n\n\t\t\tif(!model)\n\t\t\t{\n\t\t\t\tthis.setOutputData(0,input);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(!this._output)\n\t\t\t\tthis._output = new Array();\n\t\t\tif(this._output.length != input.length)\n\t\t\t\tthis._output.length = input.length;\n\t\t\tfor(var i = 0; i < input.length; ++i)\n\t\t\t{\n\t\t\t\tvar m = this._output[i];\n\t\t\t\tif(!m)\n\t\t\t\t\tm = this._output[i] = mat4.create();\n\t\t\t\tmat4.multiply(m,input[i],model);\n\t\t\t}\n\t\t\tthis.setOutputData(0,this._output);\n\t\t\treturn;\n\t\t}\n\n\t\t//geometry\n\t\tif(!input.vertices || !input.vertices.length)\n\t\t\treturn;\n\t\tvar geo = input;\n\t\tthis.outputs[0].type = \"geometry\";\n\t\tif( !this.isOutputConnected(0) )\n\t\t\treturn;\n\t\tif(!model)\n\t\t{\n\t\t\tthis.setOutputData(0,geo);\n\t\t\treturn;\n\t\t}\n\n\t\tvar key = typedArrayToArray(model).join(\",\");\n\n\t\tif( this.must_update || geo._id != this._last_geometry_id || geo._version != this._last_version || key != this._last_key )\n\t\t{\n\t\t\tthis.updateGeometry(geo, model);\n\t\t\tthis._last_key = key;\n\t\t\tthis._last_version = geo._version;\n\t\t\tthis._last_geometry_id = geo._id;\n\t\t\tthis.must_update = false;\n\t\t}\n\n\t\tthis.setOutputData(0,this.geometry);\n\t}\n\n\tLGraphGeometryTransform.prototype.updateGeometry = function(geometry, model) {\n\t\tvar old_vertices = geometry.vertices;\n\t\tvar vertices = this.geometry.vertices;\n\t\tif( !vertices || vertices.length != old_vertices.length )\n\t\t\tvertices = this.geometry.vertices = new Float32Array( old_vertices.length );\n\t\tvar temp = vec3.create();\n\n\t\tfor(var i = 0, l = vertices.length; i < l; i+=3)\n\t\t{\n\t\t\ttemp[0] = old_vertices[i]; temp[1] = old_vertices[i+1]; temp[2] = old_vertices[i+2]; \n\t\t\tmat4.multiplyVec3( temp, model, temp );\n\t\t\tvertices[i] = temp[0]; vertices[i+1] = temp[1]; vertices[i+2] = temp[2];\n\t\t}\n\n\t\tif(geometry.normals)\n\t\t{\n\t\t\tif( !this.geometry.normals || this.geometry.normals.length != geometry.normals.length )\n\t\t\t\tthis.geometry.normals = new Float32Array( geometry.normals.length );\n\t\t\tvar normals = this.geometry.normals;\n\t\t\tvar normal_model = mat4.invert(mat4.create(), model);\n\t\t\tif(normal_model)\n\t\t\t\tmat4.transpose(normal_model, normal_model);\n\t\t\tvar old_normals = geometry.normals;\n\t\t\tfor(var i = 0, l = normals.length; i < l; i+=3)\n\t\t\t{\n\t\t\t\ttemp[0] = old_normals[i]; temp[1] = old_normals[i+1]; temp[2] = old_normals[i+2]; \n\t\t\t\tmat4.multiplyVec3( temp, normal_model, temp );\n\t\t\t\tnormals[i] = temp[0]; normals[i+1] = temp[1]; normals[i+2] = temp[2];\n\t\t\t}\n\t\t}\n\n\t\tthis.geometry.type = geometry.type;\n\t\tthis.geometry._version++;\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/transform\", LGraphGeometryTransform );\n\n\n\tfunction LGraphGeometryPolygon() {\n\t\tthis.addInput(\"sides\", \"number\");\n\t\tthis.addInput(\"radius\", \"number\");\n\t\tthis.addOutput(\"out\", \"geometry\");\n\t\tthis.properties = { sides: 6, radius: 1, uvs: false }\n\n\t\tthis.geometry = {\n\t\t\ttype: \"line_loop\",\n\t\t\tvertices: null,\n\t\t\t_id: generateGeometryId()\n\t\t};\n\t\tthis.geometry_id = -1;\n\t\tthis.version = -1;\n\t\tthis.must_update = true;\n\n\t\tthis.last_info = { sides: -1, radius: -1 };\n\t}\n\n\tLGraphGeometryPolygon.title = \"Polygon\";\n\n\tLGraphGeometryPolygon.prototype.onExecute = function() {\n\n\t\tif( !this.isOutputConnected(0) )\n\t\t\treturn;\n\n\t\tvar sides = this.getInputOrProperty(\"sides\");\n\t\tvar radius = this.getInputOrProperty(\"radius\");\n\t\tsides = Math.max(3,sides)|0;\n\n\t\t//update\n\t\tif( this.last_info.sides != sides || this.last_info.radius != radius )\n\t\t\tthis.updateGeometry(sides, radius);\n\n\t\tthis.setOutputData(0,this.geometry);\n\t}\n\n\tLGraphGeometryPolygon.prototype.updateGeometry = function(sides, radius) {\n\t\tvar num = 3*sides;\n\t\tvar vertices = this.geometry.vertices;\n\t\tif( !vertices || vertices.length != num )\n\t\t\tvertices = this.geometry.vertices = new Float32Array( 3*sides );\n\t\tvar delta = (Math.PI * 2) / sides;\n\t\tvar gen_uvs = this.properties.uvs;\n\t\tif(gen_uvs)\n\t\t{\n\t\t\tuvs = this.geometry.coords = new Float32Array( 3*sides );\n\t\t}\n\n\n\t\tfor(var i = 0; i < sides; ++i)\n\t\t{\n\t\t\tvar angle = delta * -i;\n\t\t\tvar x = Math.cos( angle ) * radius;\n\t\t\tvar y = 0;\n\t\t\tvar z = Math.sin( angle ) * radius;\n\t\t\tvertices[i*3] = x;\n\t\t\tvertices[i*3+1] = y;\n\t\t\tvertices[i*3+2] = z;\n\n\t\t\tif(gen_uvs)\n\t\t\t{\n\t\t\t\t\n\n\t\t\t}\n\t\t}\n\t\tthis.geometry._id = ++this.geometry_id;\n\t\tthis.geometry._version = ++this.version;\n\t\tthis.last_info.sides = sides;\n\t\tthis.last_info.radius = radius;\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/polygon\", LGraphGeometryPolygon );\n\n\n\tfunction LGraphGeometryExtrude() {\n\n\t\tthis.addInput(\"\", \"geometry\");\n\t\tthis.addOutput(\"\", \"geometry\");\n\t\tthis.properties = { top_cap: true, bottom_cap: true, offset: [0,100,0] };\n\t\tthis.version = -1;\n\n\t\tthis._last_geo_version = -1;\n\t\tthis._must_update = true;\n\t}\n\n\tLGraphGeometryExtrude.title = \"extrude\";\n\n\tLGraphGeometryExtrude.prototype.onPropertyChanged = function(name, value)\n\t{\n\t\tthis._must_update = true;\n\t}\n\n\tLGraphGeometryExtrude.prototype.onExecute = function()\n\t{\n\t\tvar geo = this.getInputData(0);\n\t\tif( !geo || !this.isOutputConnected(0) )\n\t\t\treturn;\n\n\t\tif(geo.version != this._last_geo_version || this._must_update)\n\t\t{\n\t\t\tthis._geo = this.extrudeGeometry( geo, this._geo );\n\t\t\tif(this._geo)\n\t\t\t\tthis._geo.version = this.version++;\n\t\t\tthis._must_update = false;\n\t\t}\n\n\t\tthis.setOutputData(0, this._geo);\n\t}\n\n\tLGraphGeometryExtrude.prototype.extrudeGeometry = function( geo )\n\t{\n\t\t//for every pair of vertices\n\t\tvar vertices = geo.vertices;\n\t\tvar num_points = vertices.length / 3;\n\n\t\tvar tempA = vec3.create();\n\t\tvar tempB = vec3.create();\n\t\tvar tempC = vec3.create();\n\t\tvar tempD = vec3.create();\n\t\tvar offset = new Float32Array( this.properties.offset );\n\n\t\tif(geo.type == \"line_loop\")\n\t\t{\n\t\t\tvar new_vertices = new Float32Array( num_points * 6 * 3 ); //every points become 6 ( caps not included )\n\t\t\tvar npos = 0;\n\t\t\tfor(var i = 0, l = vertices.length; i < l; i += 3)\n\t\t\t{\n\t\t\t\ttempA[0] = vertices[i]; tempA[1] = vertices[i+1]; tempA[2] = vertices[i+2];\n\n\t\t\t\tif( i+3 < l ) //loop\n\t\t\t\t{\n\t\t\t\t\ttempB[0] = vertices[i+3]; tempB[1] = vertices[i+4]; tempB[2] = vertices[i+5];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttempB[0] = vertices[0]; tempB[1] = vertices[1]; tempB[2] = vertices[2];\n\t\t\t\t}\n\n\t\t\t\tvec3.add( tempC, tempA, offset );\n\t\t\t\tvec3.add( tempD, tempB, offset );\n\n\t\t\t\tnew_vertices.set( tempA, npos ); npos += 3;\n\t\t\t\tnew_vertices.set( tempB, npos ); npos += 3;\n\t\t\t\tnew_vertices.set( tempC, npos ); npos += 3;\n\n\t\t\t\tnew_vertices.set( tempB, npos ); npos += 3;\n\t\t\t\tnew_vertices.set( tempD, npos ); npos += 3;\n\t\t\t\tnew_vertices.set( tempC, npos ); npos += 3;\n\t\t\t}\n\t\t}\n\n\t\tvar out_geo = {\n\t\t\t_id: generateGeometryId(),\n\t\t\ttype: \"triangles\",\n\t\t\tvertices: new_vertices\n\t\t};\n\n\t\treturn out_geo;\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/extrude\", LGraphGeometryExtrude );\n\n\n\tfunction LGraphGeometryEval() {\n\t\tthis.addInput(\"in\", \"geometry\");\n\t\tthis.addOutput(\"out\", \"geometry\");\n\n\t\tthis.properties = {\n\t\t\tcode: \"V[1] += 0.01 * Math.sin(I + T*0.001);\",\n\t\t\texecute_every_frame: false\n\t\t};\n\n\t\tthis.geometry = null;\n\t\tthis.geometry_id = -1;\n\t\tthis.version = -1;\n\t\tthis.must_update = true;\n\n\t\tthis.vertices = null;\n\t\tthis.func = null;\n\t}\n\n\tLGraphGeometryEval.title = \"geoeval\";\n\tLGraphGeometryEval.desc = \"eval code\";\n\n\tLGraphGeometryEval.widgets_info = {\n\t\tcode: { widget: \"code\" }\n\t};\n\n\tLGraphGeometryEval.prototype.onConfigure = function(o)\n\t{\n\t\tthis.compileCode();\n\t}\n\n\tLGraphGeometryEval.prototype.compileCode = function()\n\t{\n\t\tif(!this.properties.code)\n\t\t\treturn;\n\n\t\ttry\n\t\t{\n\t\t\tthis.func = new Function(\"V\",\"I\",\"T\", this.properties.code); \n\t\t\tthis.boxcolor = \"#AFA\";\n\t\t\tthis.must_update = true;\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\tthis.boxcolor = \"red\";\n\t\t}\n\t}\n\n\tLGraphGeometryEval.prototype.onPropertyChanged = function(name, value)\n\t{\n\t\tif(name == \"code\")\n\t\t{\n\t\t\tthis.properties.code = value;\n\t\t\tthis.compileCode();\n\t\t}\n\t}\n\n\tLGraphGeometryEval.prototype.onExecute = function() {\n\t\tvar geometry = this.getInputData(0);\n\t\tif(!geometry)\n\t\t\treturn;\n\n\t\tif(!this.func)\n\t\t{\n\t\t\tthis.setOutputData(0,geometry);\n\t\t\treturn;\n\t\t}\n\n\t\tif( this.geometry_id != geometry._id || this.version != geometry._version || this.must_update || this.properties.execute_every_frame )\n\t\t{\n\t\t\tthis.must_update = false;\n\t\t\tthis.geometry_id = geometry._id;\n\t\t\tif(this.properties.execute_every_frame)\n\t\t\t\tthis.version++;\n\t\t\telse\n\t\t\t\tthis.version = geometry._version;\n\t\t\tvar func = this.func;\n\t\t\tvar T = getTime();\n\n\t\t\t//clone\n\t\t\tif(!this.geometry)\n\t\t\t\tthis.geometry = {};\n\t\t\tfor(var i in geometry)\n\t\t\t{\n\t\t\t\tif(geometry[i] == null)\n\t\t\t\t\tcontinue;\n\t\t\t\tif( geometry[i].constructor == Float32Array )\n\t\t\t\t\tthis.geometry[i] = new Float32Array( geometry[i] );\n\t\t\t\telse\n\t\t\t\t\tthis.geometry[i] = geometry[i];\n\t\t\t}\n\t\t\tthis.geometry._id = geometry._id;\n\t\t\tif(this.properties.execute_every_frame)\n\t\t\t\tthis.geometry._version = this.version;\n\t\t\telse\n\t\t\t\tthis.geometry._version = geometry._version + 1;\n\n\t\t\tvar V = vec3.create();\n\t\t\tvar vertices = this.vertices;\n\t\t\tif(!vertices || this.vertices.length != geometry.vertices.length)\n\t\t\t\tvertices = this.vertices = new Float32Array( geometry.vertices );\n\t\t\telse\n\t\t\t\tvertices.set( geometry.vertices );\n\t\t\tfor(var i = 0; i < vertices.length; i+=3)\n\t\t\t{\n\t\t\t\tV[0] = vertices[i];\n\t\t\t\tV[1] = vertices[i+1];\n\t\t\t\tV[2] = vertices[i+2];\n\t\t\t\tfunc(V,i/3,T);\n\t\t\t\tvertices[i] = V[0];\n\t\t\t\tvertices[i+1] = V[1];\n\t\t\t\tvertices[i+2] = V[2];\n\t\t\t}\n\t\t\tthis.geometry.vertices = vertices;\n\t\t}\n\n\t\tthis.setOutputData(0,this.geometry);\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/eval\", LGraphGeometryEval );\n\n/*\nfunction LGraphGeometryDisplace() {\n\t\tthis.addInput(\"in\", \"geometry\");\n\t\tthis.addInput(\"img\", \"image\");\n\t\tthis.addOutput(\"out\", \"geometry\");\n\n\t\tthis.properties = {\n\t\t\tgrid_size: 1\n\t\t};\n\n\t\tthis.geometry = null;\n\t\tthis.geometry_id = -1;\n\t\tthis.version = -1;\n\t\tthis.must_update = true;\n\n\t\tthis.vertices = null;\n\t}\n\n\tLGraphGeometryDisplace.title = \"displace\";\n\tLGraphGeometryDisplace.desc = \"displace points\";\n\n\tLGraphGeometryDisplace.prototype.onExecute = function() {\n\t\tvar geometry = this.getInputData(0);\n\t\tvar image = this.getInputData(1);\n\t\tif(!geometry)\n\t\t\treturn;\n\n\t\tif(!image)\n\t\t{\n\t\t\tthis.setOutputData(0,geometry);\n\t\t\treturn;\n\t\t}\n\n\t\tif( this.geometry_id != geometry._id || this.version != geometry._version || this.must_update )\n\t\t{\n\t\t\tthis.must_update = false;\n\t\t\tthis.geometry_id = geometry._id;\n\t\t\tthis.version = geometry._version;\n\n\t\t\t//copy\n\t\t\tthis.geometry = {};\n\t\t\tfor(var i in geometry)\n\t\t\t\tthis.geometry[i] = geometry[i];\n\t\t\tthis.geometry._id = geometry._id;\n\t\t\tthis.geometry._version = geometry._version + 1;\n\n\t\t\tvar grid_size = this.properties.grid_size;\n\t\t\tif(grid_size != 0)\n\t\t\t{\n\t\t\t\tvar vertices = this.vertices;\n\t\t\t\tif(!vertices || this.vertices.length != this.geometry.vertices.length)\n\t\t\t\t\tvertices = this.vertices = new Float32Array( this.geometry.vertices );\n\t\t\t\tfor(var i = 0; i < vertices.length; i+=3)\n\t\t\t\t{\n\t\t\t\t\tvertices[i] = Math.round(vertices[i]/grid_size) * grid_size;\n\t\t\t\t\tvertices[i+1] = Math.round(vertices[i+1]/grid_size) * grid_size;\n\t\t\t\t\tvertices[i+2] = Math.round(vertices[i+2]/grid_size) * grid_size;\n\t\t\t\t}\n\t\t\t\tthis.geometry.vertices = vertices;\n\t\t\t}\n\t\t}\n\n\t\tthis.setOutputData(0,this.geometry);\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/displace\", LGraphGeometryDisplace );\n*/\n\n\tfunction LGraphConnectPoints() {\n\t\tthis.addInput(\"in\", \"geometry\");\n\t\tthis.addOutput(\"out\", \"geometry\");\n\n\t\tthis.properties = {\n\t\t\tmin_dist: 0.4,\n\t\t\tmax_dist: 0.5,\n\t\t\tmax_connections: 0,\n\t\t\tprobability: 1\n\t\t};\n\n\t\tthis.geometry_id = -1;\n\t\tthis.version = -1;\n\t\tthis.my_version = 1;\n\t\tthis.must_update = true;\n\t}\n\n\tLGraphConnectPoints.title = \"connect points\";\n\tLGraphConnectPoints.desc = \"adds indices between near points\";\n\n\tLGraphConnectPoints.prototype.onPropertyChanged = function(name,value)\n\t{\n\t\tthis.must_update = true;\n\t}\n\n\tLGraphConnectPoints.prototype.onExecute = function() {\n\t\tvar geometry = this.getInputData(0);\n\t\tif(!geometry)\n\t\t\treturn;\n\n\t\tif( this.geometry_id != geometry._id || this.version != geometry._version || this.must_update )\n\t\t{\n\t\t\tthis.must_update = false;\n\t\t\tthis.geometry_id = geometry._id;\n\t\t\tthis.version = geometry._version;\n\n\t\t\t//copy\n\t\t\tthis.geometry = {};\n\t\t\tfor(var i in geometry)\n\t\t\t\tthis.geometry[i] = geometry[i];\n\t\t\tthis.geometry._id = generateGeometryId();\n\t\t\tthis.geometry._version = this.my_version++;\n\n\t\t\tvar vertices = geometry.vertices;\n\t\t\tvar l = vertices.length;\n\t\t\tvar min_dist = this.properties.min_dist;\n\t\t\tvar max_dist = this.properties.max_dist;\n\t\t\tvar probability = this.properties.probability;\n\t\t\tvar max_connections = this.properties.max_connections;\n\t\t\tvar indices = [];\n\t\t\t\n\t\t\tfor(var i = 0; i < l; i+=3)\n\t\t\t{\n\t\t\t\tvar x = vertices[i];\n\t\t\t\tvar y = vertices[i+1];\n\t\t\t\tvar z = vertices[i+2];\n\t\t\t\tvar connections = 0;\n\t\t\t\tfor(var j = i+3; j < l; j+=3)\n\t\t\t\t{\n\t\t\t\t\tvar x2 = vertices[j];\n\t\t\t\t\tvar y2 = vertices[j+1];\n\t\t\t\t\tvar z2 = vertices[j+2];\n\t\t\t\t\tvar dist = Math.sqrt( (x-x2)*(x-x2) + (y-y2)*(y-y2) + (z-z2)*(z-z2));\n\t\t\t\t\tif(dist > max_dist || dist < min_dist || (probability < 1 && probability < Math.random()) )\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tindices.push(i/3,j/3);\n\t\t\t\t\tconnections += 1;\n\t\t\t\t\tif(max_connections && connections > max_connections)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.geometry.indices = this.indices = new Uint32Array(indices);\n\t\t}\n\n\t\tif(this.indices && this.indices.length)\n\t\t{\n\t\t\tthis.geometry.indices = this.indices;\n\t\t\tthis.setOutputData( 0, this.geometry );\n\t\t}\n\t\telse\n\t\t\tthis.setOutputData( 0, null );\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/connectPoints\", LGraphConnectPoints );\n\n    //Works with Litegl.js to create WebGL nodes\n    if (typeof GL == \"undefined\") //LiteGL RELATED **********************************************\n\t\treturn;\n\n\tfunction LGraphToGeometry() {\n\t\tthis.addInput(\"mesh\", \"mesh\");\n\t\tthis.addOutput(\"out\", \"geometry\");\n\n\t\tthis.geometry = {};\n\t\tthis.last_mesh = null;\n\t}\n\n\tLGraphToGeometry.title = \"to geometry\";\n\tLGraphToGeometry.desc = \"converts a mesh to geometry\";\n\n\tLGraphToGeometry.prototype.onExecute = function() {\n\t\tvar mesh = this.getInputData(0);\n\t\tif(!mesh)\n\t\t\treturn;\n\n\t\tif(mesh != this.last_mesh)\n\t\t{\n\t\t\tthis.last_mesh = mesh;\n\t\t\tfor(i in mesh.vertexBuffers)\n\t\t\t{\n\t\t\t\tvar buffer = mesh.vertexBuffers[i];\n\t\t\t\tthis.geometry[i] = buffer.data\n\t\t\t}\n\t\t\tif(mesh.indexBuffers[\"triangles\"])\n\t\t\t\tthis.geometry.indices = mesh.indexBuffers[\"triangles\"].data;\n\n\t\t\tthis.geometry._id = generateGeometryId();\n\t\t\tthis.geometry._version = 0;\n\t\t}\n\n\t\tthis.setOutputData(0,this.geometry);\n\t\tif(this.geometry)\n\t\t\tthis.setOutputData(1,this.geometry.vertices);\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/toGeometry\", LGraphToGeometry );\n\n\tfunction LGraphGeometryToMesh() {\n\t\tthis.addInput(\"in\", \"geometry\");\n\t\tthis.addOutput(\"mesh\", \"mesh\");\n\t\tthis.properties = {};\n\t\tthis.version = -1;\n\t\tthis.mesh = null;\n\t}\n\n\tLGraphGeometryToMesh.title = \"Geo to Mesh\";\n\n\tLGraphGeometryToMesh.prototype.updateMesh = function(geometry)\n\t{\n\t\tif(!this.mesh)\n\t\t\tthis.mesh = new GL.Mesh();\n\n\t\tfor(var i in geometry)\n\t\t{\n\t\t\tif(i[0] == \"_\")\n\t\t\t\tcontinue;\n\n\t\t\tvar buffer_data = geometry[i];\n\n\t\t\tvar info = GL.Mesh.common_buffers[i];\n\t\t\tif(!info && i != \"indices\") //unknown buffer\n\t\t\t\tcontinue;\n\t\t\tvar spacing = info ? info.spacing : 3;\n\t\t\tvar mesh_buffer = this.mesh.vertexBuffers[i];\n\n\t\t\tif(!mesh_buffer || mesh_buffer.data.length != buffer_data.length)\n\t\t\t{\n\t\t\t\tmesh_buffer = new GL.Buffer( i == \"indices\" ? GL.ELEMENT_ARRAY_BUFFER : GL.ARRAY_BUFFER, buffer_data, spacing, GL.DYNAMIC_DRAW );\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmesh_buffer.data.set( buffer_data );\n\t\t\t\tmesh_buffer.upload(GL.DYNAMIC_DRAW);\n\t\t\t}\n\n\t\t\tthis.mesh.addBuffer( i, mesh_buffer );\n\t\t}\n\n\t\tif(this.mesh.vertexBuffers.normals &&this.mesh.vertexBuffers.normals.data.length != this.mesh.vertexBuffers.vertices.data.length )\n\t\t{\n\t\t\tvar n = new Float32Array([0,1,0]);\n\t\t\tvar normals = new Float32Array( this.mesh.vertexBuffers.vertices.data.length );\n\t\t\tfor(var i = 0; i < normals.length; i+= 3)\n\t\t\t\tnormals.set( n, i );\n\t\t\tmesh_buffer = new GL.Buffer( GL.ARRAY_BUFFER, normals, 3 );\n\t\t\tthis.mesh.addBuffer( \"normals\", mesh_buffer );\n\t\t}\n\n\t\tthis.mesh.updateBoundingBox();\n\t\tthis.geometry_id = this.mesh.id = geometry._id;\n\t\tthis.version = this.mesh.version = geometry._version;\n\t\treturn this.mesh;\n\t}\n\n\tLGraphGeometryToMesh.prototype.onExecute = function() {\n\n\t\tvar geometry = this.getInputData(0);\n\t\tif(!geometry)\n\t\t\treturn;\n\t\tif( this.version != geometry._version || this.geometry_id != geometry._id )\n\t\t\tthis.updateMesh( geometry );\n\t\tthis.setOutputData(0, this.mesh);\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/toMesh\", LGraphGeometryToMesh );\n\n\tfunction LGraphRenderMesh() {\n\t\tthis.addInput(\"mesh\", \"mesh\");\n\t\tthis.addInput(\"mat4\", \"mat4\");\n\t\tthis.addInput(\"tex\", \"texture\");\n\n\t\tthis.properties = {\n\t\t\tenabled: true,\n\t\t\tprimitive: GL.TRIANGLES,\n\t\t\tadditive: false,\n\t\t\tcolor: [1,1,1],\n\t\t\topacity: 1\n\t\t};\n\n\t\tthis.color = vec4.create([1,1,1,1]);\n\t\tthis.model_matrix = mat4.create();\n\t\tthis.uniforms = {\n\t\t\tu_color: this.color,\n\t\t\tu_model: this.model_matrix\n\t\t};\n\t}\n\n\tLGraphRenderMesh.title = \"Render Mesh\";\n\tLGraphRenderMesh.desc = \"renders a mesh flat\";\n\n\tLGraphRenderMesh.PRIMITIVE_VALUES = { \"points\":GL.POINTS, \"lines\":GL.LINES, \"line_loop\":GL.LINE_LOOP,\"line_strip\":GL.LINE_STRIP, \"triangles\":GL.TRIANGLES, \"triangle_fan\":GL.TRIANGLE_FAN, \"triangle_strip\":GL.TRIANGLE_STRIP };\n\n\tLGraphRenderMesh.widgets_info = {\n\t\tprimitive: { widget: \"combo\", values: LGraphRenderMesh.PRIMITIVE_VALUES },\n\t\tcolor: { widget: \"color\" }\n\t};\n\n\tLGraphRenderMesh.prototype.onExecute = function() {\n\n\t\tif(!this.properties.enabled)\n\t\t\treturn;\n\n\t\tvar mesh = this.getInputData(0);\n\t\tif(!mesh)\n\t\t\treturn;\n\n\t\tif(!LiteGraph.LGraphRender.onRequestCameraMatrices)\n\t\t{\n\t\t\tconsole.warn(\"cannot render geometry, LiteGraph.onRequestCameraMatrices is null, remember to fill this with a callback(view_matrix, projection_matrix,viewprojection_matrix) to use 3D rendering from the graph\");\n\t\t\treturn;\n\t\t}\n\n\t\tLiteGraph.LGraphRender.onRequestCameraMatrices( view_matrix, projection_matrix,viewprojection_matrix );\n\t\tvar shader = null;\n\t\tvar texture = this.getInputData(2);\n\t\tif(texture)\n\t\t{\n\t\t\tshader = gl.shaders[\"textured\"];\n\t\t\tif(!shader)\n\t\t\t\tshader = gl.shaders[\"textured\"] = new GL.Shader( LGraphRenderPoints.vertex_shader_code, LGraphRenderPoints.fragment_shader_code, { USE_TEXTURE:\"\" });\n\t\t}\n\t\telse\n\t\t{\n\t\t\tshader = gl.shaders[\"flat\"];\n\t\t\tif(!shader)\n\t\t\t\tshader = gl.shaders[\"flat\"] = new GL.Shader( LGraphRenderPoints.vertex_shader_code, LGraphRenderPoints.fragment_shader_code );\n\t\t}\n\n\t\tthis.color.set( this.properties.color );\n\t\tthis.color[3] = this.properties.opacity;\n\n\t\tvar model_matrix = this.model_matrix;\n\t\tvar m = this.getInputData(1);\n\t\tif(m)\n\t\t\tmodel_matrix.set(m);\n\t\telse\n\t\t\tmat4.identity( model_matrix );\n\n\t\tthis.uniforms.u_point_size = 1;\n\t\tvar primitive = this.properties.primitive;\n\n\t\tshader.uniforms( global_uniforms );\n\t\tshader.uniforms( this.uniforms );\n\n\t\tif(this.properties.opacity >= 1)\n\t\t\tgl.disable( gl.BLEND );\n\t\telse\n\t\t\tgl.enable( gl.BLEND );\n\t\tgl.enable( gl.DEPTH_TEST );\n\t\tif( this.properties.additive )\n\t\t{\n\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\n\t\t\tgl.depthMask( false );\n\t\t}\n\t\telse\n\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA );\n\n\t\tvar indices = \"indices\";\n\t\tif( mesh.indexBuffers.triangles )\n\t\t\tindices = \"triangles\";\n\t\tshader.draw( mesh, primitive, indices );\n\t\tgl.disable( gl.BLEND );\n\t\tgl.depthMask( true );\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/render_mesh\", LGraphRenderMesh );\n\n\t//**************************\n\n\n\tfunction LGraphGeometryPrimitive() {\n\t\tthis.addInput(\"size\", \"number\");\n\t\tthis.addOutput(\"out\", \"mesh\");\n\t\tthis.properties = { type: 1, size: 1, subdivisions: 32 };\n\n\t\tthis.version = (Math.random() * 100000)|0;\n\t\tthis.last_info = { type: -1, size: -1, subdivisions: -1 };\n\t}\n\n\tLGraphGeometryPrimitive.title = \"Primitive\";\n\n\tLGraphGeometryPrimitive.VALID = { \"CUBE\":1, \"PLANE\":2, \"CYLINDER\":3, \"SPHERE\":4, \"CIRCLE\":5, \"HEMISPHERE\":6, \"ICOSAHEDRON\":7, \"CONE\":8, \"QUAD\":9 };\n\tLGraphGeometryPrimitive.widgets_info = {\n\t\ttype: { widget: \"combo\", values: LGraphGeometryPrimitive.VALID }\n\t};\n\n\tLGraphGeometryPrimitive.prototype.onExecute = function() {\n\n\t\tif( !this.isOutputConnected(0) )\n\t\t\treturn;\n\n\t\tvar size = this.getInputOrProperty(\"size\");\n\n\t\t//update\n\t\tif( this.last_info.type != this.properties.type || this.last_info.size != size || this.last_info.subdivisions != this.properties.subdivisions )\n\t\t\tthis.updateMesh( this.properties.type, size, this.properties.subdivisions );\n\n\t\tthis.setOutputData(0,this._mesh);\n\t}\n\n\tLGraphGeometryPrimitive.prototype.updateMesh = function(type, size, subdivisions)\n\t{\n\t\tsubdivisions = Math.max(0,subdivisions)|0;\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase 1: //CUBE: \n\t\t\t\tthis._mesh = GL.Mesh.cube({size: size, normals:true,coords:true});\n\t\t\t\tbreak;\n\t\t\tcase 2: //PLANE:\n\t\t\t\tthis._mesh = GL.Mesh.plane({size: size, xz: true, detail: subdivisions, normals:true,coords:true});\n\t\t\t\tbreak;\n\t\t\tcase 3: //CYLINDER:\n\t\t\t\tthis._mesh = GL.Mesh.cylinder({size: size, subdivisions: subdivisions, normals:true,coords:true});\n\t\t\t\tbreak;\n\t\t\tcase 4: //SPHERE:\n\t\t\t\tthis._mesh = GL.Mesh.sphere({size: size, \"long\": subdivisions, lat: subdivisions, normals:true,coords:true});\n\t\t\t\tbreak;\n\t\t\tcase 5: //CIRCLE:\n\t\t\t\tthis._mesh = GL.Mesh.circle({size: size, slices: subdivisions, normals:true, coords:true});\n\t\t\t\tbreak;\n\t\t\tcase 6: //HEMISPHERE:\n\t\t\t\tthis._mesh = GL.Mesh.sphere({size: size, \"long\": subdivisions, lat: subdivisions, normals:true, coords:true, hemi: true});\n\t\t\t\tbreak;\n\t\t\tcase 7: //ICOSAHEDRON:\n\t\t\t\tthis._mesh = GL.Mesh.icosahedron({size: size, subdivisions:subdivisions });\n\t\t\t\tbreak;\n\t\t\tcase 8: //CONE:\n\t\t\t\tthis._mesh = GL.Mesh.cone({radius: size, height: size, subdivisions:subdivisions });\n\t\t\t\tbreak;\n\t\t\tcase 9: //QUAD:\n\t\t\t\tthis._mesh = GL.Mesh.plane({size: size, xz: false, detail: subdivisions, normals:true, coords:true });\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.last_info.type = type;\n\t\tthis.last_info.size = size;\n\t\tthis.last_info.subdivisions = subdivisions;\n\t\tthis._mesh.version = this.version++;\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/mesh_primitive\", LGraphGeometryPrimitive );\n\n\n\tfunction LGraphRenderPoints() {\n\t\tthis.addInput(\"in\", \"geometry\");\n\t\tthis.addInput(\"mat4\", \"mat4\");\n\t\tthis.addInput(\"tex\", \"texture\");\n\t\tthis.properties = {\n\t\t\tenabled: true,\n\t\t\tpoint_size: 0.1,\n\t\t\tfixed_size: false,\n\t\t\tadditive: true,\n\t\t\tcolor: [1,1,1],\n\t\t\topacity: 1\n\t\t};\n\n\t\tthis.color = vec4.create([1,1,1,1]);\n\n\t\tthis.uniforms = {\n\t\t\tu_point_size: 1,\n\t\t\tu_perspective: 1,\n\t\t\tu_point_perspective: 1,\n\t\t\tu_color: this.color\n\t\t};\n\n\t\tthis.geometry_id = -1;\n\t\tthis.version = -1;\n\t\tthis.mesh = null;\n\t}\n\n\tLGraphRenderPoints.title = \"renderPoints\";\n\tLGraphRenderPoints.desc = \"render points with a texture\";\n\n\tLGraphRenderPoints.widgets_info = {\n\t\tcolor: { widget: \"color\" }\n\t};\n\n\tLGraphRenderPoints.prototype.updateMesh = function(geometry)\n\t{\n\t\tvar buffer = this.buffer;\n\t\tif(!this.buffer || !this.buffer.data || this.buffer.data.length != geometry.vertices.length)\n\t\t\tthis.buffer = new GL.Buffer( GL.ARRAY_BUFFER, geometry.vertices,3,GL.DYNAMIC_DRAW);\n\t\telse\n\t\t{\n\t\t\tthis.buffer.data.set( geometry.vertices );\n\t\t\tthis.buffer.upload(GL.DYNAMIC_DRAW);\n\t\t}\n\n\t\tif(!this.mesh)\n\t\t\tthis.mesh = new GL.Mesh();\n\n\t\tthis.mesh.addBuffer(\"vertices\",this.buffer);\n\t\tthis.geometry_id = this.mesh.id = geometry._id;\n\t\tthis.version = this.mesh.version = geometry._version;\n\t}\n\n\tLGraphRenderPoints.prototype.onExecute = function() {\n\n\t\tif(!this.properties.enabled)\n\t\t\treturn;\n\n\t\tvar geometry = this.getInputData(0);\n\t\tif(!geometry)\n\t\t\treturn;\n\t\tif(this.version != geometry._version || this.geometry_id != geometry._id )\n\t\t\tthis.updateMesh( geometry );\n\n\t\tif(!LiteGraph.LGraphRender.onRequestCameraMatrices)\n\t\t{\n\t\t\tconsole.warn(\"cannot render geometry, LiteGraph.onRequestCameraMatrices is null, remember to fill this with a callback(view_matrix, projection_matrix,viewprojection_matrix) to use 3D rendering from the graph\");\n\t\t\treturn;\n\t\t}\n\n\t\tLiteGraph.LGraphRender.onRequestCameraMatrices( view_matrix, projection_matrix,viewprojection_matrix );\n\t\tvar shader = null;\n\n\t\tvar texture = this.getInputData(2);\n\t\t\n\t\tif(texture)\n\t\t{\n\t\t\tshader = gl.shaders[\"textured_points\"];\n\t\t\tif(!shader)\n\t\t\t\tshader = gl.shaders[\"textured_points\"] = new GL.Shader( LGraphRenderPoints.vertex_shader_code, LGraphRenderPoints.fragment_shader_code, { USE_TEXTURED_POINTS:\"\" });\n\t\t}\n\t\telse\n\t\t{\n\t\t\tshader = gl.shaders[\"points\"];\n\t\t\tif(!shader)\n\t\t\t\tshader = gl.shaders[\"points\"] = new GL.Shader( LGraphRenderPoints.vertex_shader_code, LGraphRenderPoints.fragment_shader_code, { USE_POINTS: \"\" });\n\t\t}\n\n\t\tthis.color.set( this.properties.color );\n\t\tthis.color[3] = this.properties.opacity;\n\n\t\tvar m = this.getInputData(1);\n\t\tif(m)\n\t\t\tmodel_matrix.set(m);\n\t\telse\n\t\t\tmat4.identity( model_matrix );\n\n\t\tthis.uniforms.u_point_size = this.properties.point_size;\n\t\tthis.uniforms.u_point_perspective = this.properties.fixed_size ? 0 : 1;\n\t\tthis.uniforms.u_perspective = gl.viewport_data[3] * projection_matrix[5];\n\n\t\tshader.uniforms( global_uniforms );\n\t\tshader.uniforms( this.uniforms );\n\n\t\tif(this.properties.opacity >= 1)\n\t\t\tgl.disable( gl.BLEND );\n\t\telse\n\t\t\tgl.enable( gl.BLEND );\n\n\t\tgl.enable( gl.DEPTH_TEST );\n\t\tif( this.properties.additive )\n\t\t{\n\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\n\t\t\tgl.depthMask( false );\n\t\t}\n\t\telse\n\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA );\n\n\t\tshader.draw( this.mesh, GL.POINTS );\n\n\t\tgl.disable( gl.BLEND );\n\t\tgl.depthMask( true );\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/render_points\", LGraphRenderPoints );\n\n\tLGraphRenderPoints.vertex_shader_code = '\\\n\t\tprecision mediump float;\\n\\\n\t\tattribute vec3 a_vertex;\\n\\\n\t\tvarying vec3 v_vertex;\\n\\\n\t\tattribute vec3 a_normal;\\n\\\n\t\tvarying vec3 v_normal;\\n\\\n\t\t#ifdef USE_COLOR\\n\\\n\t\t\tattribute vec4 a_color;\\n\\\n\t\t\tvarying vec4 v_color;\\n\\\n\t\t#endif\\n\\\n\t\tattribute vec2 a_coord;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\t#ifdef USE_SIZE\\n\\\n\t\t\tattribute float a_extra;\\n\\\n\t\t#endif\\n\\\n\t\t#ifdef USE_INSTANCING\\n\\\n\t\t\tattribute mat4 u_model;\\n\\\n\t\t#else\\n\\\n\t\t\tuniform mat4 u_model;\\n\\\n\t\t#endif\\n\\\n\t\tuniform mat4 u_viewprojection;\\n\\\n\t\tuniform float u_point_size;\\n\\\n\t\tuniform float u_perspective;\\n\\\n\t\tuniform float u_point_perspective;\\n\\\n\t\tfloat computePointSize(float radius, float w)\\n\\\n\t\t{\\n\\\n\t\t\tif(radius < 0.0)\\n\\\n\t\t\t\treturn -radius;\\n\\\n\t\t\treturn u_perspective * radius / w;\\n\\\n\t\t}\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tv_coord = a_coord;\\n\\\n\t\t\t#ifdef USE_COLOR\\n\\\n\t\t\t\tv_color = a_color;\\n\\\n\t\t\t#endif\\n\\\n\t\t\tv_vertex = ( u_model * vec4( a_vertex, 1.0 )).xyz;\\n\\\n\t\t\tv_normal = ( u_model * vec4( a_normal, 0.0 )).xyz;\\n\\\n\t\t\tgl_Position = u_viewprojection * vec4(v_vertex,1.0);\\n\\\n\t\t\tgl_PointSize = u_point_size;\\n\\\n\t\t\t#ifdef USE_SIZE\\n\\\n\t\t\t\tgl_PointSize = a_extra;\\n\\\n\t\t\t#endif\\n\\\n\t\t\tif(u_point_perspective != 0.0)\\n\\\n\t\t\t\tgl_PointSize = computePointSize( gl_PointSize, gl_Position.w );\\n\\\n\t\t}\\\n\t';\n\n\tLGraphRenderPoints.fragment_shader_code = '\\\n\t\tprecision mediump float;\\n\\\n\t\tuniform vec4 u_color;\\n\\\n\t\t#ifdef USE_COLOR\\n\\\n\t\t\tvarying vec4 v_color;\\n\\\n\t\t#endif\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec4 color = u_color;\\n\\\n\t\t\t#ifdef USE_TEXTURED_POINTS\\n\\\n\t\t\t\tcolor *= texture2D(u_texture, gl_PointCoord.xy);\\n\\\n\t\t\t#else\\n\\\n\t\t\t\t#ifdef USE_TEXTURE\\n\\\n\t\t\t\t  color *= texture2D(u_texture, v_coord);\\n\\\n\t\t\t\t  if(color.a < 0.1)\\n\\\n\t\t\t\t\tdiscard;\\n\\\n\t\t\t\t#endif\\n\\\n\t\t\t\t#ifdef USE_POINTS\\n\\\n\t\t\t\t\tfloat dist = length( gl_PointCoord.xy - vec2(0.5) );\\n\\\n\t\t\t\t\tif( dist > 0.45 )\\n\\\n\t\t\t\t\t\tdiscard;\\n\\\n\t\t\t\t#endif\\n\\\n\t\t\t#endif\\n\\\n\t\t\t#ifdef USE_COLOR\\n\\\n\t\t\t\tcolor *= v_color;\\n\\\n\t\t\t#endif\\n\\\n\t\t\tgl_FragColor = color;\\n\\\n\t\t}\\\n\t';\n\n\t//based on https://inconvergent.net/2019/depth-of-field/\n\t/*\n\tfunction LGraphRenderGeometryDOF() {\n\t\tthis.addInput(\"in\", \"geometry\");\n\t\tthis.addInput(\"mat4\", \"mat4\");\n\t\tthis.addInput(\"tex\", \"texture\");\n\t\tthis.properties = {\n\t\t\tenabled: true,\n\t\t\tlines: true,\n\t\t\tpoint_size: 0.1,\n\t\t\tfixed_size: false,\n\t\t\tadditive: true,\n\t\t\tcolor: [1,1,1],\n\t\t\topacity: 1\n\t\t};\n\n\t\tthis.color = vec4.create([1,1,1,1]);\n\n\t\tthis.uniforms = {\n\t\t\tu_point_size: 1,\n\t\t\tu_perspective: 1,\n\t\t\tu_point_perspective: 1,\n\t\t\tu_color: this.color\n\t\t};\n\n\t\tthis.geometry_id = -1;\n\t\tthis.version = -1;\n\t\tthis.mesh = null;\n\t}\n\n\tLGraphRenderGeometryDOF.widgets_info = {\n\t\tcolor: { widget: \"color\" }\n\t};\n\n\tLGraphRenderGeometryDOF.prototype.updateMesh = function(geometry)\n\t{\n\t\tvar buffer = this.buffer;\n\t\tif(!this.buffer || this.buffer.data.length != geometry.vertices.length)\n\t\t\tthis.buffer = new GL.Buffer( GL.ARRAY_BUFFER, geometry.vertices,3,GL.DYNAMIC_DRAW);\n\t\telse\n\t\t{\n\t\t\tthis.buffer.data.set( geometry.vertices );\n\t\t\tthis.buffer.upload(GL.DYNAMIC_DRAW);\n\t\t}\n\n\t\tif(!this.mesh)\n\t\t\tthis.mesh = new GL.Mesh();\n\n\t\tthis.mesh.addBuffer(\"vertices\",this.buffer);\n\t\tthis.geometry_id = this.mesh.id = geometry._id;\n\t\tthis.version = this.mesh.version = geometry._version;\n\t}\n\n\tLGraphRenderGeometryDOF.prototype.onExecute = function() {\n\n\t\tif(!this.properties.enabled)\n\t\t\treturn;\n\n\t\tvar geometry = this.getInputData(0);\n\t\tif(!geometry)\n\t\t\treturn;\n\t\tif(this.version != geometry._version || this.geometry_id != geometry._id )\n\t\t\tthis.updateMesh( geometry );\n\n\t\tif(!LiteGraph.LGraphRender.onRequestCameraMatrices)\n\t\t{\n\t\t\tconsole.warn(\"cannot render geometry, LiteGraph.onRequestCameraMatrices is null, remember to fill this with a callback(view_matrix, projection_matrix,viewprojection_matrix) to use 3D rendering from the graph\");\n\t\t\treturn;\n\t\t}\n\n\t\tLiteGraph.LGraphRender.onRequestCameraMatrices( view_matrix, projection_matrix,viewprojection_matrix );\n\t\tvar shader = null;\n\n\t\tvar texture = this.getInputData(2);\n\t\t\n\t\tif(texture)\n\t\t{\n\t\t\tshader = gl.shaders[\"textured_points\"];\n\t\t\tif(!shader)\n\t\t\t\tshader = gl.shaders[\"textured_points\"] = new GL.Shader( LGraphRenderGeometryDOF.vertex_shader_code, LGraphRenderGeometryDOF.fragment_shader_code, { USE_TEXTURED_POINTS:\"\" });\n\t\t}\n\t\telse\n\t\t{\n\t\t\tshader = gl.shaders[\"points\"];\n\t\t\tif(!shader)\n\t\t\t\tshader = gl.shaders[\"points\"] = new GL.Shader( LGraphRenderGeometryDOF.vertex_shader_code, LGraphRenderGeometryDOF.fragment_shader_code, { USE_POINTS: \"\" });\n\t\t}\n\n\t\tthis.color.set( this.properties.color );\n\t\tthis.color[3] = this.properties.opacity;\n\n\t\tvar m = this.getInputData(1);\n\t\tif(m)\n\t\t\tmodel_matrix.set(m);\n\t\telse\n\t\t\tmat4.identity( model_matrix );\n\n\t\tthis.uniforms.u_point_size = this.properties.point_size;\n\t\tthis.uniforms.u_point_perspective = this.properties.fixed_size ? 0 : 1;\n\t\tthis.uniforms.u_perspective = gl.viewport_data[3] * projection_matrix[5];\n\n\t\tshader.uniforms( global_uniforms );\n\t\tshader.uniforms( this.uniforms );\n\n\t\tif(this.properties.opacity >= 1)\n\t\t\tgl.disable( gl.BLEND );\n\t\telse\n\t\t\tgl.enable( gl.BLEND );\n\n\t\tgl.enable( gl.DEPTH_TEST );\n\t\tif( this.properties.additive )\n\t\t{\n\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\n\t\t\tgl.depthMask( false );\n\t\t}\n\t\telse\n\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA );\n\n\t\tshader.draw( this.mesh, GL.POINTS );\n\n\t\tgl.disable( gl.BLEND );\n\t\tgl.depthMask( true );\n\t}\n\n\tLiteGraph.registerNodeType( \"geometry/render_dof\", LGraphRenderGeometryDOF );\n\n\tLGraphRenderGeometryDOF.vertex_shader_code = '\\\n\t\tprecision mediump float;\\n\\\n\t\tattribute vec3 a_vertex;\\n\\\n\t\tvarying vec3 v_vertex;\\n\\\n\t\tattribute vec3 a_normal;\\n\\\n\t\tvarying vec3 v_normal;\\n\\\n\t\t#ifdef USE_COLOR\\n\\\n\t\t\tattribute vec4 a_color;\\n\\\n\t\t\tvarying vec4 v_color;\\n\\\n\t\t#endif\\n\\\n\t\tattribute vec2 a_coord;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\t#ifdef USE_SIZE\\n\\\n\t\t\tattribute float a_extra;\\n\\\n\t\t#endif\\n\\\n\t\t#ifdef USE_INSTANCING\\n\\\n\t\t\tattribute mat4 u_model;\\n\\\n\t\t#else\\n\\\n\t\t\tuniform mat4 u_model;\\n\\\n\t\t#endif\\n\\\n\t\tuniform mat4 u_viewprojection;\\n\\\n\t\tuniform float u_point_size;\\n\\\n\t\tuniform float u_perspective;\\n\\\n\t\tuniform float u_point_perspective;\\n\\\n\t\tfloat computePointSize(float radius, float w)\\n\\\n\t\t{\\n\\\n\t\t\tif(radius < 0.0)\\n\\\n\t\t\t\treturn -radius;\\n\\\n\t\t\treturn u_perspective * radius / w;\\n\\\n\t\t}\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tv_coord = a_coord;\\n\\\n\t\t\t#ifdef USE_COLOR\\n\\\n\t\t\t\tv_color = a_color;\\n\\\n\t\t\t#endif\\n\\\n\t\t\tv_vertex = ( u_model * vec4( a_vertex, 1.0 )).xyz;\\n\\\n\t\t\tv_normal = ( u_model * vec4( a_normal, 0.0 )).xyz;\\n\\\n\t\t\tgl_Position = u_viewprojection * vec4(v_vertex,1.0);\\n\\\n\t\t\tgl_PointSize = u_point_size;\\n\\\n\t\t\t#ifdef USE_SIZE\\n\\\n\t\t\t\tgl_PointSize = a_extra;\\n\\\n\t\t\t#endif\\n\\\n\t\t\tif(u_point_perspective != 0.0)\\n\\\n\t\t\t\tgl_PointSize = computePointSize( gl_PointSize, gl_Position.w );\\n\\\n\t\t}\\\n\t';\n\n\tLGraphRenderGeometryDOF.fragment_shader_code = '\\\n\t\tprecision mediump float;\\n\\\n\t\tuniform vec4 u_color;\\n\\\n\t\t#ifdef USE_COLOR\\n\\\n\t\t\tvarying vec4 v_color;\\n\\\n\t\t#endif\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture;\\n\\\n\t\tvoid main() {\\n\\\n\t\t\tvec4 color = u_color;\\n\\\n\t\t\t#ifdef USE_TEXTURED_POINTS\\n\\\n\t\t\t\tcolor *= texture2D(u_texture, gl_PointCoord.xy);\\n\\\n\t\t\t#else\\n\\\n\t\t\t\t#ifdef USE_TEXTURE\\n\\\n\t\t\t\t  color *= texture2D(u_texture, v_coord);\\n\\\n\t\t\t\t  if(color.a < 0.1)\\n\\\n\t\t\t\t\tdiscard;\\n\\\n\t\t\t\t#endif\\n\\\n\t\t\t\t#ifdef USE_POINTS\\n\\\n\t\t\t\t\tfloat dist = length( gl_PointCoord.xy - vec2(0.5) );\\n\\\n\t\t\t\t\tif( dist > 0.45 )\\n\\\n\t\t\t\t\t\tdiscard;\\n\\\n\t\t\t\t#endif\\n\\\n\t\t\t#endif\\n\\\n\t\t\t#ifdef USE_COLOR\\n\\\n\t\t\t\tcolor *= v_color;\\n\\\n\t\t\t#endif\\n\\\n\t\t\tgl_FragColor = color;\\n\\\n\t\t}\\\n\t';\n\t*/\n\n\n\n})(this);\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n    var LGraphTexture = global.LGraphTexture;\n\n    //Works with Litegl.js to create WebGL nodes\n    if (typeof GL != \"undefined\") {\n        // Texture Lens *****************************************\n        function LGraphFXLens() {\n            this.addInput(\"Texture\", \"Texture\");\n            this.addInput(\"Aberration\", \"number\");\n            this.addInput(\"Distortion\", \"number\");\n            this.addInput(\"Blur\", \"number\");\n            this.addOutput(\"Texture\", \"Texture\");\n            this.properties = {\n                aberration: 1.0,\n                distortion: 1.0,\n                blur: 1.0,\n                precision: LGraphTexture.DEFAULT\n            };\n\n            if (!LGraphFXLens._shader) {\n                LGraphFXLens._shader = new GL.Shader(\n                    GL.Shader.SCREEN_VERTEX_SHADER,\n                    LGraphFXLens.pixel_shader\n                );\n                LGraphFXLens._texture = new GL.Texture(3, 1, {\n                    format: gl.RGB,\n                    wrap: gl.CLAMP_TO_EDGE,\n                    magFilter: gl.LINEAR,\n                    minFilter: gl.LINEAR,\n                    pixel_data: [255, 0, 0, 0, 255, 0, 0, 0, 255]\n                });\n            }\n        }\n\n        LGraphFXLens.title = \"Lens\";\n        LGraphFXLens.desc = \"Camera Lens distortion\";\n        LGraphFXLens.widgets_info = {\n            precision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n        };\n\n        LGraphFXLens.prototype.onExecute = function() {\n            var tex = this.getInputData(0);\n            if (this.properties.precision === LGraphTexture.PASS_THROUGH) {\n                this.setOutputData(0, tex);\n                return;\n            }\n\n            if (!tex) {\n                return;\n            }\n\n            this._tex = LGraphTexture.getTargetTexture(\n                tex,\n                this._tex,\n                this.properties.precision\n            );\n\n            var aberration = this.properties.aberration;\n            if (this.isInputConnected(1)) {\n                aberration = this.getInputData(1);\n                this.properties.aberration = aberration;\n            }\n\n            var distortion = this.properties.distortion;\n            if (this.isInputConnected(2)) {\n                distortion = this.getInputData(2);\n                this.properties.distortion = distortion;\n            }\n\n            var blur = this.properties.blur;\n            if (this.isInputConnected(3)) {\n                blur = this.getInputData(3);\n                this.properties.blur = blur;\n            }\n\n            gl.disable(gl.BLEND);\n            gl.disable(gl.DEPTH_TEST);\n            var mesh = Mesh.getScreenQuad();\n            var shader = LGraphFXLens._shader;\n            //var camera = LS.Renderer._current_camera;\n\n            this._tex.drawTo(function() {\n                tex.bind(0);\n                shader\n                    .uniforms({\n                        u_texture: 0,\n                        u_aberration: aberration,\n                        u_distortion: distortion,\n                        u_blur: blur\n                    })\n                    .draw(mesh);\n            });\n\n            this.setOutputData(0, this._tex);\n        };\n\n        LGraphFXLens.pixel_shader =\n            \"precision highp float;\\n\\\n\t\t\tprecision highp float;\\n\\\n\t\t\tvarying vec2 v_coord;\\n\\\n\t\t\tuniform sampler2D u_texture;\\n\\\n\t\t\tuniform vec2 u_camera_planes;\\n\\\n\t\t\tuniform float u_aberration;\\n\\\n\t\t\tuniform float u_distortion;\\n\\\n\t\t\tuniform float u_blur;\\n\\\n\t\t\t\\n\\\n\t\t\tvoid main() {\\n\\\n\t\t\t\tvec2 coord = v_coord;\\n\\\n\t\t\t\tfloat dist = distance(vec2(0.5), coord);\\n\\\n\t\t\t\tvec2 dist_coord = coord - vec2(0.5);\\n\\\n\t\t\t\tfloat percent = 1.0 + ((0.5 - dist) / 0.5) * u_distortion;\\n\\\n\t\t\t\tdist_coord *= percent;\\n\\\n\t\t\t\tcoord = dist_coord + vec2(0.5);\\n\\\n\t\t\t\tvec4 color = texture2D(u_texture,coord, u_blur * dist);\\n\\\n\t\t\t\tcolor.r = texture2D(u_texture,vec2(0.5) + dist_coord * (1.0+0.01*u_aberration), u_blur * dist ).r;\\n\\\n\t\t\t\tcolor.b = texture2D(u_texture,vec2(0.5) + dist_coord * (1.0-0.01*u_aberration), u_blur * dist ).b;\\n\\\n\t\t\t\tgl_FragColor = color;\\n\\\n\t\t\t}\\n\\\n\t\t\t\";\n        /*\n\t\t\tfloat normalized_tunable_sigmoid(float xs, float k)\\n\\\n\t\t\t{\\n\\\n\t\t\t\txs = xs * 2.0 - 1.0;\\n\\\n\t\t\t\tfloat signx = sign(xs);\\n\\\n\t\t\t\tfloat absx = abs(xs);\\n\\\n\t\t\t\treturn signx * ((-k - 1.0)*absx)/(2.0*(-2.0*k*absx+k-1.0)) + 0.5;\\n\\\n\t\t\t}\\n\\\n\t\t*/\n\n        LiteGraph.registerNodeType(\"fx/lens\", LGraphFXLens);\n        global.LGraphFXLens = LGraphFXLens;\n\n        /* not working yet\n\tfunction LGraphDepthOfField()\n\t{\n\t\tthis.addInput(\"Color\",\"Texture\");\n\t\tthis.addInput(\"Linear Depth\",\"Texture\");\n\t\tthis.addInput(\"Camera\",\"camera\");\n\t\tthis.addOutput(\"Texture\",\"Texture\");\n\t\tthis.properties = { high_precision: false };\n\t}\n\n\tLGraphDepthOfField.title = \"Depth Of Field\";\n\tLGraphDepthOfField.desc = \"Applies a depth of field effect\";\n\n\tLGraphDepthOfField.prototype.onExecute = function()\n\t{\n\t\tvar tex = this.getInputData(0);\n\t\tvar depth = this.getInputData(1);\n\t\tvar camera = this.getInputData(2);\n\n\t\tif(!tex || !depth || !camera) \n\t\t{\n\t\t\tthis.setOutputData(0, tex);\n\t\t\treturn;\n\t\t}\n\n\t\tvar precision = gl.UNSIGNED_BYTE;\n\t\tif(this.properties.high_precision)\n\t\t\tprecision = gl.half_float_ext ? gl.HALF_FLOAT_OES : gl.FLOAT;\t\t\t\n\t\tif(!this._temp_texture || this._temp_texture.type != precision ||\n\t\t\tthis._temp_texture.width != tex.width || this._temp_texture.height != tex.height)\n\t\t\tthis._temp_texture = new GL.Texture( tex.width, tex.height, { type: precision, format: gl.RGBA, filter: gl.LINEAR });\n\n\t\tvar shader = LGraphDepthOfField._shader = new GL.Shader( GL.Shader.SCREEN_VERTEX_SHADER, LGraphDepthOfField._pixel_shader );\n\n\t\tvar screen_mesh = Mesh.getScreenQuad();\n\n\t\tgl.disable( gl.DEPTH_TEST );\n\t\tgl.disable( gl.BLEND );\n\n\t\tvar camera_position = camera.getEye();\n\t\tvar focus_point = camera.getCenter();\n\t\tvar distance = vec3.distance( camera_position, focus_point );\n\t\tvar far = camera.far;\n\t\tvar focus_range = distance * 0.5;\n\n\t\tthis._temp_texture.drawTo( function() {\n\t\t\ttex.bind(0);\n\t\t\tdepth.bind(1);\n\t\t\tshader.uniforms({u_texture:0, u_depth_texture:1, u_resolution: [1/tex.width, 1/tex.height], u_far: far, u_focus_point: distance, u_focus_scale: focus_range }).draw(screen_mesh);\n\t\t});\n\n\t\tthis.setOutputData(0, this._temp_texture);\n\t}\n\n\t//from http://tuxedolabs.blogspot.com.es/2018/05/bokeh-depth-of-field-in-single-pass.html\n\tLGraphDepthOfField._pixel_shader = \"\\n\\\n\t\tprecision highp float;\\n\\\n\t\tvarying vec2 v_coord;\\n\\\n\t\tuniform sampler2D u_texture; //Image to be processed\\n\\\n\t\tuniform sampler2D u_depth_texture; //Linear depth, where 1.0 == far plane\\n\\\n\t\tuniform vec2 u_iresolution; //The size of a pixel: vec2(1.0/width, 1.0/height)\\n\\\n\t\tuniform float u_far; // Far plane\\n\\\n\t\tuniform float u_focus_point;\\n\\\n\t\tuniform float u_focus_scale;\\n\\\n\t\t\\n\\\n\t\tconst float GOLDEN_ANGLE = 2.39996323;\\n\\\n\t\tconst float MAX_BLUR_SIZE = 20.0;\\n\\\n\t\tconst float RAD_SCALE = 0.5; // Smaller = nicer blur, larger = faster\\n\\\n\t\t\\n\\\n\t\tfloat getBlurSize(float depth, float focusPoint, float focusScale)\\n\\\n\t\t{\\n\\\n\t\t float coc = clamp((1.0 / focusPoint - 1.0 / depth)*focusScale, -1.0, 1.0);\\n\\\n\t\t return abs(coc) * MAX_BLUR_SIZE;\\n\\\n\t\t}\\n\\\n\t\t\\n\\\n\t\tvec3 depthOfField(vec2 texCoord, float focusPoint, float focusScale)\\n\\\n\t\t{\\n\\\n\t\t float centerDepth = texture2D(u_depth_texture, texCoord).r * u_far;\\n\\\n\t\t float centerSize = getBlurSize(centerDepth, focusPoint, focusScale);\\n\\\n\t\t vec3 color = texture2D(u_texture, v_coord).rgb;\\n\\\n\t\t float tot = 1.0;\\n\\\n\t\t\\n\\\n\t\t float radius = RAD_SCALE;\\n\\\n\t\t for (float ang = 0.0; ang < 100.0; ang += GOLDEN_ANGLE)\\n\\\n\t\t {\\n\\\n\t\t  vec2 tc = texCoord + vec2(cos(ang), sin(ang)) * u_iresolution * radius;\\n\\\n\t\t\t\\n\\\n\t\t  vec3 sampleColor = texture2D(u_texture, tc).rgb;\\n\\\n\t\t  float sampleDepth = texture2D(u_depth_texture, tc).r * u_far;\\n\\\n\t\t  float sampleSize = getBlurSize( sampleDepth, focusPoint, focusScale );\\n\\\n\t\t  if (sampleDepth > centerDepth)\\n\\\n\t\t   sampleSize = clamp(sampleSize, 0.0, centerSize*2.0);\\n\\\n\t\t\t\\n\\\n\t\t  float m = smoothstep(radius-0.5, radius+0.5, sampleSize);\\n\\\n\t\t  color += mix(color/tot, sampleColor, m);\\n\\\n\t\t  tot += 1.0;\\n\\\n\t\t  radius += RAD_SCALE/radius;\\n\\\n\t\t  if(radius>=MAX_BLUR_SIZE)\\n\\\n\t\t\t return color / tot;\\n\\\n\t\t }\\n\\\n\t\t return color / tot;\\n\\\n\t\t}\\n\\\n\t\tvoid main()\\n\\\n\t\t{\\n\\\n\t\t\tgl_FragColor = vec4( depthOfField( v_coord, u_focus_point, u_focus_scale ), 1.0 );\\n\\\n\t\t\t//gl_FragColor = vec4( texture2D(u_depth_texture, v_coord).r );\\n\\\n\t\t}\\n\\\n\t\t\";\n\n\tLiteGraph.registerNodeType(\"fx/DOF\", LGraphDepthOfField );\n\tglobal.LGraphDepthOfField = LGraphDepthOfField;\n\t*/\n\n        //*******************************************************\n\n        function LGraphFXBokeh() {\n            this.addInput(\"Texture\", \"Texture\");\n            this.addInput(\"Blurred\", \"Texture\");\n            this.addInput(\"Mask\", \"Texture\");\n            this.addInput(\"Threshold\", \"number\");\n            this.addOutput(\"Texture\", \"Texture\");\n            this.properties = {\n                shape: \"\",\n                size: 10,\n                alpha: 1.0,\n                threshold: 1.0,\n                high_precision: false\n            };\n        }\n\n        LGraphFXBokeh.title = \"Bokeh\";\n        LGraphFXBokeh.desc = \"applies an Bokeh effect\";\n\n        LGraphFXBokeh.widgets_info = { shape: { widget: \"texture\" } };\n\n        LGraphFXBokeh.prototype.onExecute = function() {\n            var tex = this.getInputData(0);\n            var blurred_tex = this.getInputData(1);\n            var mask_tex = this.getInputData(2);\n            if (!tex || !mask_tex || !this.properties.shape) {\n                this.setOutputData(0, tex);\n                return;\n            }\n\n            if (!blurred_tex) {\n                blurred_tex = tex;\n            }\n\n            var shape_tex = LGraphTexture.getTexture(this.properties.shape);\n            if (!shape_tex) {\n                return;\n            }\n\n            var threshold = this.properties.threshold;\n            if (this.isInputConnected(3)) {\n                threshold = this.getInputData(3);\n                this.properties.threshold = threshold;\n            }\n\n            var precision = gl.UNSIGNED_BYTE;\n            if (this.properties.high_precision) {\n                precision = gl.half_float_ext ? gl.HALF_FLOAT_OES : gl.FLOAT;\n            }\n            if (\n                !this._temp_texture ||\n                this._temp_texture.type != precision ||\n                this._temp_texture.width != tex.width ||\n                this._temp_texture.height != tex.height\n            ) {\n                this._temp_texture = new GL.Texture(tex.width, tex.height, {\n                    type: precision,\n                    format: gl.RGBA,\n                    filter: gl.LINEAR\n                });\n            }\n\n            //iterations\n            var size = this.properties.size;\n\n            var first_shader = LGraphFXBokeh._first_shader;\n            if (!first_shader) {\n                first_shader = LGraphFXBokeh._first_shader = new GL.Shader(\n                    Shader.SCREEN_VERTEX_SHADER,\n                    LGraphFXBokeh._first_pixel_shader\n                );\n            }\n\n            var second_shader = LGraphFXBokeh._second_shader;\n            if (!second_shader) {\n                second_shader = LGraphFXBokeh._second_shader = new GL.Shader(\n                    LGraphFXBokeh._second_vertex_shader,\n                    LGraphFXBokeh._second_pixel_shader\n                );\n            }\n\n            var points_mesh = this._points_mesh;\n            if (\n                !points_mesh ||\n                points_mesh._width != tex.width ||\n                points_mesh._height != tex.height ||\n                points_mesh._spacing != 2\n            ) {\n                points_mesh = this.createPointsMesh(tex.width, tex.height, 2);\n            }\n\n            var screen_mesh = Mesh.getScreenQuad();\n\n            var point_size = this.properties.size;\n            var min_light = this.properties.min_light;\n            var alpha = this.properties.alpha;\n\n            gl.disable(gl.DEPTH_TEST);\n            gl.disable(gl.BLEND);\n\n            this._temp_texture.drawTo(function() {\n                tex.bind(0);\n                blurred_tex.bind(1);\n                mask_tex.bind(2);\n                first_shader\n                    .uniforms({\n                        u_texture: 0,\n                        u_texture_blur: 1,\n                        u_mask: 2,\n                        u_texsize: [tex.width, tex.height]\n                    })\n                    .draw(screen_mesh);\n            });\n\n            this._temp_texture.drawTo(function() {\n                //clear because we use blending\n                //gl.clearColor(0.0,0.0,0.0,1.0);\n                //gl.clear( gl.COLOR_BUFFER_BIT );\n                gl.enable(gl.BLEND);\n                gl.blendFunc(gl.ONE, gl.ONE);\n\n                tex.bind(0);\n                shape_tex.bind(3);\n                second_shader\n                    .uniforms({\n                        u_texture: 0,\n                        u_mask: 2,\n                        u_shape: 3,\n                        u_alpha: alpha,\n                        u_threshold: threshold,\n                        u_pointSize: point_size,\n                        u_itexsize: [1.0 / tex.width, 1.0 / tex.height]\n                    })\n                    .draw(points_mesh, gl.POINTS);\n            });\n\n            this.setOutputData(0, this._temp_texture);\n        };\n\n        LGraphFXBokeh.prototype.createPointsMesh = function(\n            width,\n            height,\n            spacing\n        ) {\n            var nwidth = Math.round(width / spacing);\n            var nheight = Math.round(height / spacing);\n\n            var vertices = new Float32Array(nwidth * nheight * 2);\n\n            var ny = -1;\n            var dx = (2 / width) * spacing;\n            var dy = (2 / height) * spacing;\n            for (var y = 0; y < nheight; ++y) {\n                var nx = -1;\n                for (var x = 0; x < nwidth; ++x) {\n                    var pos = y * nwidth * 2 + x * 2;\n                    vertices[pos] = nx;\n                    vertices[pos + 1] = ny;\n                    nx += dx;\n                }\n                ny += dy;\n            }\n\n            this._points_mesh = GL.Mesh.load({ vertices2D: vertices });\n            this._points_mesh._width = width;\n            this._points_mesh._height = height;\n            this._points_mesh._spacing = spacing;\n\n            return this._points_mesh;\n        };\n\n        /*\n\tLGraphTextureBokeh._pixel_shader = \"precision highp float;\\n\\\n\t\t\tvarying vec2 a_coord;\\n\\\n\t\t\tuniform sampler2D u_texture;\\n\\\n\t\t\tuniform sampler2D u_shape;\\n\\\n\t\t\t\\n\\\n\t\t\tvoid main() {\\n\\\n\t\t\t\tvec4 color = texture2D( u_texture, gl_PointCoord );\\n\\\n\t\t\t\tcolor *= v_color * u_alpha;\\n\\\n\t\t\t\tgl_FragColor = color;\\n\\\n\t\t\t}\\n\";\n\t*/\n\n        LGraphFXBokeh._first_pixel_shader =\n            \"precision highp float;\\n\\\n\t\t\tprecision highp float;\\n\\\n\t\t\tvarying vec2 v_coord;\\n\\\n\t\t\tuniform sampler2D u_texture;\\n\\\n\t\t\tuniform sampler2D u_texture_blur;\\n\\\n\t\t\tuniform sampler2D u_mask;\\n\\\n\t\t\t\\n\\\n\t\t\tvoid main() {\\n\\\n\t\t\t\tvec4 color = texture2D(u_texture, v_coord);\\n\\\n\t\t\t\tvec4 blurred_color = texture2D(u_texture_blur, v_coord);\\n\\\n\t\t\t\tfloat mask = texture2D(u_mask, v_coord).x;\\n\\\n\t\t\t   gl_FragColor = mix(color, blurred_color, mask);\\n\\\n\t\t\t}\\n\\\n\t\t\t\";\n\n        LGraphFXBokeh._second_vertex_shader =\n            \"precision highp float;\\n\\\n\t\t\tattribute vec2 a_vertex2D;\\n\\\n\t\t\tvarying vec4 v_color;\\n\\\n\t\t\tuniform sampler2D u_texture;\\n\\\n\t\t\tuniform sampler2D u_mask;\\n\\\n\t\t\tuniform vec2 u_itexsize;\\n\\\n\t\t\tuniform float u_pointSize;\\n\\\n\t\t\tuniform float u_threshold;\\n\\\n\t\t\tvoid main() {\\n\\\n\t\t\t\tvec2 coord = a_vertex2D * 0.5 + 0.5;\\n\\\n\t\t\t\tv_color = texture2D( u_texture, coord );\\n\\\n\t\t\t\tv_color += texture2D( u_texture, coord + vec2(u_itexsize.x, 0.0) );\\n\\\n\t\t\t\tv_color += texture2D( u_texture, coord + vec2(0.0, u_itexsize.y));\\n\\\n\t\t\t\tv_color += texture2D( u_texture, coord + u_itexsize);\\n\\\n\t\t\t\tv_color *= 0.25;\\n\\\n\t\t\t\tfloat mask = texture2D(u_mask, coord).x;\\n\\\n\t\t\t\tfloat luminance = length(v_color) * mask;\\n\\\n\t\t\t\t/*luminance /= (u_pointSize*u_pointSize)*0.01 */;\\n\\\n\t\t\t\tluminance -= u_threshold;\\n\\\n\t\t\t\tif(luminance < 0.0)\\n\\\n\t\t\t\t{\\n\\\n\t\t\t\t\tgl_Position.x = -100.0;\\n\\\n\t\t\t\t\treturn;\\n\\\n\t\t\t\t}\\n\\\n\t\t\t\tgl_PointSize = u_pointSize;\\n\\\n\t\t\t\tgl_Position = vec4(a_vertex2D,0.0,1.0);\\n\\\n\t\t\t}\\n\\\n\t\t\t\";\n\n        LGraphFXBokeh._second_pixel_shader =\n            \"precision highp float;\\n\\\n\t\t\tvarying vec4 v_color;\\n\\\n\t\t\tuniform sampler2D u_shape;\\n\\\n\t\t\tuniform float u_alpha;\\n\\\n\t\t\t\\n\\\n\t\t\tvoid main() {\\n\\\n\t\t\t\tvec4 color = texture2D( u_shape, gl_PointCoord );\\n\\\n\t\t\t\tcolor *= v_color * u_alpha;\\n\\\n\t\t\t\tgl_FragColor = color;\\n\\\n\t\t\t}\\n\";\n\n        LiteGraph.registerNodeType(\"fx/bokeh\", LGraphFXBokeh);\n        global.LGraphFXBokeh = LGraphFXBokeh;\n\n        //************************************************\n\n        function LGraphFXGeneric() {\n            this.addInput(\"Texture\", \"Texture\");\n            this.addInput(\"value1\", \"number\");\n            this.addInput(\"value2\", \"number\");\n            this.addOutput(\"Texture\", \"Texture\");\n            this.properties = {\n                fx: \"halftone\",\n                value1: 1,\n                value2: 1,\n                precision: LGraphTexture.DEFAULT\n            };\n        }\n\n        LGraphFXGeneric.title = \"FX\";\n        LGraphFXGeneric.desc = \"applies an FX from a list\";\n\n        LGraphFXGeneric.widgets_info = {\n            fx: {\n                widget: \"combo\",\n                values: [\"halftone\", \"pixelate\", \"lowpalette\", \"noise\", \"gamma\"]\n            },\n            precision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n        };\n        LGraphFXGeneric.shaders = {};\n\n        LGraphFXGeneric.prototype.onExecute = function() {\n            if (!this.isOutputConnected(0)) {\n                return;\n            } //saves work\n\n            var tex = this.getInputData(0);\n            if (this.properties.precision === LGraphTexture.PASS_THROUGH) {\n                this.setOutputData(0, tex);\n                return;\n            }\n\n            if (!tex) {\n                return;\n            }\n\n            this._tex = LGraphTexture.getTargetTexture(\n                tex,\n                this._tex,\n                this.properties.precision\n            );\n\n            //iterations\n            var value1 = this.properties.value1;\n            if (this.isInputConnected(1)) {\n                value1 = this.getInputData(1);\n                this.properties.value1 = value1;\n            }\n\n            var value2 = this.properties.value2;\n            if (this.isInputConnected(2)) {\n                value2 = this.getInputData(2);\n                this.properties.value2 = value2;\n            }\n\n            var fx = this.properties.fx;\n            var shader = LGraphFXGeneric.shaders[fx];\n            if (!shader) {\n                var pixel_shader_code = LGraphFXGeneric[\"pixel_shader_\" + fx];\n                if (!pixel_shader_code) {\n                    return;\n                }\n\n                shader = LGraphFXGeneric.shaders[fx] = new GL.Shader(\n                    Shader.SCREEN_VERTEX_SHADER,\n                    pixel_shader_code\n                );\n            }\n\n            gl.disable(gl.BLEND);\n            gl.disable(gl.DEPTH_TEST);\n            var mesh = Mesh.getScreenQuad();\n            var camera = global.LS ? LS.Renderer._current_camera : null;\n            var camera_planes;\n            if (camera) {\n                camera_planes = [\n                    LS.Renderer._current_camera.near,\n                    LS.Renderer._current_camera.far\n                ];\n            } else {\n                camera_planes = [1, 100];\n            }\n\n            var noise = null;\n            if (fx == \"noise\") {\n                noise = LGraphTexture.getNoiseTexture();\n            }\n\n            this._tex.drawTo(function() {\n                tex.bind(0);\n                if (fx == \"noise\") {\n                    noise.bind(1);\n                }\n\n                shader\n                    .uniforms({\n                        u_texture: 0,\n                        u_noise: 1,\n                        u_size: [tex.width, tex.height],\n                        u_rand: [Math.random(), Math.random()],\n                        u_value1: value1,\n                        u_value2: value2,\n                        u_camera_planes: camera_planes\n                    })\n                    .draw(mesh);\n            });\n\n            this.setOutputData(0, this._tex);\n        };\n\n        LGraphFXGeneric.pixel_shader_halftone =\n            \"precision highp float;\\n\\\n\t\t\tvarying vec2 v_coord;\\n\\\n\t\t\tuniform sampler2D u_texture;\\n\\\n\t\t\tuniform vec2 u_camera_planes;\\n\\\n\t\t\tuniform vec2 u_size;\\n\\\n\t\t\tuniform float u_value1;\\n\\\n\t\t\tuniform float u_value2;\\n\\\n\t\t\t\\n\\\n\t\t\tfloat pattern() {\\n\\\n\t\t\t\tfloat s = sin(u_value1 * 3.1415), c = cos(u_value1 * 3.1415);\\n\\\n\t\t\t\tvec2 tex = v_coord * u_size.xy;\\n\\\n\t\t\t\tvec2 point = vec2(\\n\\\n\t\t\t\t   c * tex.x - s * tex.y ,\\n\\\n\t\t\t\t   s * tex.x + c * tex.y \\n\\\n\t\t\t\t) * u_value2;\\n\\\n\t\t\t\treturn (sin(point.x) * sin(point.y)) * 4.0;\\n\\\n\t\t\t}\\n\\\n\t\t\tvoid main() {\\n\\\n\t\t\t\tvec4 color = texture2D(u_texture, v_coord);\\n\\\n\t\t\t\tfloat average = (color.r + color.g + color.b) / 3.0;\\n\\\n\t\t\t\tgl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\\n\\\n\t\t\t}\\n\";\n\n        LGraphFXGeneric.pixel_shader_pixelate =\n            \"precision highp float;\\n\\\n\t\t\tvarying vec2 v_coord;\\n\\\n\t\t\tuniform sampler2D u_texture;\\n\\\n\t\t\tuniform vec2 u_camera_planes;\\n\\\n\t\t\tuniform vec2 u_size;\\n\\\n\t\t\tuniform float u_value1;\\n\\\n\t\t\tuniform float u_value2;\\n\\\n\t\t\t\\n\\\n\t\t\tvoid main() {\\n\\\n\t\t\t\tvec2 coord = vec2( floor(v_coord.x * u_value1) / u_value1, floor(v_coord.y * u_value2) / u_value2 );\\n\\\n\t\t\t\tvec4 color = texture2D(u_texture, coord);\\n\\\n\t\t\t\tgl_FragColor = color;\\n\\\n\t\t\t}\\n\";\n\n        LGraphFXGeneric.pixel_shader_lowpalette =\n            \"precision highp float;\\n\\\n\t\t\tvarying vec2 v_coord;\\n\\\n\t\t\tuniform sampler2D u_texture;\\n\\\n\t\t\tuniform vec2 u_camera_planes;\\n\\\n\t\t\tuniform vec2 u_size;\\n\\\n\t\t\tuniform float u_value1;\\n\\\n\t\t\tuniform float u_value2;\\n\\\n\t\t\t\\n\\\n\t\t\tvoid main() {\\n\\\n\t\t\t\tvec4 color = texture2D(u_texture, v_coord);\\n\\\n\t\t\t\tgl_FragColor = floor(color * u_value1) / u_value1;\\n\\\n\t\t\t}\\n\";\n\n        LGraphFXGeneric.pixel_shader_noise =\n            \"precision highp float;\\n\\\n\t\t\tvarying vec2 v_coord;\\n\\\n\t\t\tuniform sampler2D u_texture;\\n\\\n\t\t\tuniform sampler2D u_noise;\\n\\\n\t\t\tuniform vec2 u_size;\\n\\\n\t\t\tuniform float u_value1;\\n\\\n\t\t\tuniform float u_value2;\\n\\\n\t\t\tuniform vec2 u_rand;\\n\\\n\t\t\t\\n\\\n\t\t\tvoid main() {\\n\\\n\t\t\t\tvec4 color = texture2D(u_texture, v_coord);\\n\\\n\t\t\t\tvec3 noise = texture2D(u_noise, v_coord * vec2(u_size.x / 512.0, u_size.y / 512.0) + u_rand).xyz - vec3(0.5);\\n\\\n\t\t\t\tgl_FragColor = vec4( color.xyz + noise * u_value1, color.a );\\n\\\n\t\t\t}\\n\";\n\n        LGraphFXGeneric.pixel_shader_gamma =\n            \"precision highp float;\\n\\\n\t\t\tvarying vec2 v_coord;\\n\\\n\t\t\tuniform sampler2D u_texture;\\n\\\n\t\t\tuniform float u_value1;\\n\\\n\t\t\t\\n\\\n\t\t\tvoid main() {\\n\\\n\t\t\t\tvec4 color = texture2D(u_texture, v_coord);\\n\\\n\t\t\t\tfloat gamma = 1.0 / u_value1;\\n\\\n\t\t\t\tgl_FragColor = vec4( pow( color.xyz, vec3(gamma) ), color.a );\\n\\\n\t\t\t}\\n\";\n\n        LiteGraph.registerNodeType(\"fx/generic\", LGraphFXGeneric);\n        global.LGraphFXGeneric = LGraphFXGeneric;\n\n        // Vigneting ************************************\n\n        function LGraphFXVigneting() {\n            this.addInput(\"Tex.\", \"Texture\");\n            this.addInput(\"intensity\", \"number\");\n\n            this.addOutput(\"Texture\", \"Texture\");\n            this.properties = {\n                intensity: 1,\n                invert: false,\n                precision: LGraphTexture.DEFAULT\n            };\n\n            if (!LGraphFXVigneting._shader) {\n                LGraphFXVigneting._shader = new GL.Shader(\n                    Shader.SCREEN_VERTEX_SHADER,\n                    LGraphFXVigneting.pixel_shader\n                );\n            }\n        }\n\n        LGraphFXVigneting.title = \"Vigneting\";\n        LGraphFXVigneting.desc = \"Vigneting\";\n\n        LGraphFXVigneting.widgets_info = {\n            precision: { widget: \"combo\", values: LGraphTexture.MODE_VALUES }\n        };\n\n        LGraphFXVigneting.prototype.onExecute = function() {\n            var tex = this.getInputData(0);\n\n            if (this.properties.precision === LGraphTexture.PASS_THROUGH) {\n                this.setOutputData(0, tex);\n                return;\n            }\n\n            if (!tex) {\n                return;\n            }\n\n            this._tex = LGraphTexture.getTargetTexture(\n                tex,\n                this._tex,\n                this.properties.precision\n            );\n\n            var intensity = this.properties.intensity;\n            if (this.isInputConnected(1)) {\n                intensity = this.getInputData(1);\n                this.properties.intensity = intensity;\n            }\n\n            gl.disable(gl.BLEND);\n            gl.disable(gl.DEPTH_TEST);\n\n            var mesh = Mesh.getScreenQuad();\n            var shader = LGraphFXVigneting._shader;\n            var invert = this.properties.invert;\n\n            this._tex.drawTo(function() {\n                tex.bind(0);\n                shader\n                    .uniforms({\n                        u_texture: 0,\n                        u_intensity: intensity,\n                        u_isize: [1 / tex.width, 1 / tex.height],\n                        u_invert: invert ? 1 : 0\n                    })\n                    .draw(mesh);\n            });\n\n            this.setOutputData(0, this._tex);\n        };\n\n        LGraphFXVigneting.pixel_shader =\n            \"precision highp float;\\n\\\n\t\t\tprecision highp float;\\n\\\n\t\t\tvarying vec2 v_coord;\\n\\\n\t\t\tuniform sampler2D u_texture;\\n\\\n\t\t\tuniform float u_intensity;\\n\\\n\t\t\tuniform int u_invert;\\n\\\n\t\t\t\\n\\\n\t\t\tvoid main() {\\n\\\n\t\t\t\tfloat luminance = 1.0 - length( v_coord - vec2(0.5) ) * 1.414;\\n\\\n\t\t\t\tvec4 color = texture2D(u_texture, v_coord);\\n\\\n\t\t\t\tif(u_invert == 1)\\n\\\n\t\t\t\t\tluminance = 1.0 - luminance;\\n\\\n\t\t\t\tluminance = mix(1.0, luminance, u_intensity);\\n\\\n\t\t\t   gl_FragColor = vec4( luminance * color.xyz, color.a);\\n\\\n\t\t\t}\\n\\\n\t\t\t\";\n\n        LiteGraph.registerNodeType(\"fx/vigneting\", LGraphFXVigneting);\n        global.LGraphFXVigneting = LGraphFXVigneting;\n    }\n})(this);\n\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n    var MIDI_COLOR = \"#243\";\n\n    function MIDIEvent(data) {\n        this.channel = 0;\n        this.cmd = 0;\n        this.data = new Uint32Array(3);\n\n        if (data) {\n            this.setup(data);\n        }\n    }\n\n    LiteGraph.MIDIEvent = MIDIEvent;\n\n    MIDIEvent.prototype.fromJSON = function(o) {\n        this.setup(o.data);\n    };\n\n    MIDIEvent.prototype.setup = function(data) {\n        var raw_data = data;\n        if (data.constructor === Object) {\n            raw_data = data.data;\n        }\n\n        this.data.set(raw_data);\n\n        var midiStatus = raw_data[0];\n        this.status = midiStatus;\n\n        var midiCommand = midiStatus & 0xf0;\n\n        if (midiStatus >= 0xf0) {\n            this.cmd = midiStatus;\n        } else {\n            this.cmd = midiCommand;\n        }\n\n        if (this.cmd == MIDIEvent.NOTEON && this.velocity == 0) {\n            this.cmd = MIDIEvent.NOTEOFF;\n        }\n\n        this.cmd_str = MIDIEvent.commands[this.cmd] || \"\";\n\n        if (\n            midiCommand >= MIDIEvent.NOTEON ||\n            midiCommand <= MIDIEvent.NOTEOFF\n        ) {\n            this.channel = midiStatus & 0x0f;\n        }\n    };\n\n    Object.defineProperty(MIDIEvent.prototype, \"velocity\", {\n        get: function() {\n            if (this.cmd == MIDIEvent.NOTEON) {\n                return this.data[2];\n            }\n            return -1;\n        },\n        set: function(v) {\n            this.data[2] = v; //  v / 127;\n        },\n        enumerable: true\n    });\n\n    MIDIEvent.notes = [\n        \"A\",\n        \"A#\",\n        \"B\",\n        \"C\",\n        \"C#\",\n        \"D\",\n        \"D#\",\n        \"E\",\n        \"F\",\n        \"F#\",\n        \"G\",\n        \"G#\"\n    ];\n    MIDIEvent.note_to_index = {\n        A: 0,\n        \"A#\": 1,\n        B: 2,\n        C: 3,\n        \"C#\": 4,\n        D: 5,\n        \"D#\": 6,\n        E: 7,\n        F: 8,\n        \"F#\": 9,\n        G: 10,\n        \"G#\": 11\n    };\n\n    Object.defineProperty(MIDIEvent.prototype, \"note\", {\n        get: function() {\n            if (this.cmd != MIDIEvent.NOTEON) {\n                return -1;\n            }\n            return MIDIEvent.toNoteString(this.data[1], true);\n        },\n        set: function(v) {\n            throw \"notes cannot be assigned this way, must modify the data[1]\";\n        },\n        enumerable: true\n    });\n\n    Object.defineProperty(MIDIEvent.prototype, \"octave\", {\n        get: function() {\n            if (this.cmd != MIDIEvent.NOTEON) {\n                return -1;\n            }\n            var octave = this.data[1] - 24;\n            return Math.floor(octave / 12 + 1);\n        },\n        set: function(v) {\n            throw \"octave cannot be assigned this way, must modify the data[1]\";\n        },\n        enumerable: true\n    });\n\n    //returns HZs\n    MIDIEvent.prototype.getPitch = function() {\n        return Math.pow(2, (this.data[1] - 69) / 12) * 440;\n    };\n\n    MIDIEvent.computePitch = function(note) {\n        return Math.pow(2, (note - 69) / 12) * 440;\n    };\n\n    MIDIEvent.prototype.getCC = function() {\n        return this.data[1];\n    };\n\n    MIDIEvent.prototype.getCCValue = function() {\n        return this.data[2];\n    };\n\n    //not tested, there is a formula missing here\n    MIDIEvent.prototype.getPitchBend = function() {\n        return this.data[1] + (this.data[2] << 7) - 8192;\n    };\n\n    MIDIEvent.computePitchBend = function(v1, v2) {\n        return v1 + (v2 << 7) - 8192;\n    };\n\n    MIDIEvent.prototype.setCommandFromString = function(str) {\n        this.cmd = MIDIEvent.computeCommandFromString(str);\n    };\n\n    MIDIEvent.computeCommandFromString = function(str) {\n        if (!str) {\n            return 0;\n        }\n\n        if (str && str.constructor === Number) {\n            return str;\n        }\n\n        str = str.toUpperCase();\n        switch (str) {\n            case \"NOTE ON\":\n            case \"NOTEON\":\n                return MIDIEvent.NOTEON;\n                break;\n            case \"NOTE OFF\":\n            case \"NOTEOFF\":\n                return MIDIEvent.NOTEON;\n                break;\n            case \"KEY PRESSURE\":\n            case \"KEYPRESSURE\":\n                return MIDIEvent.KEYPRESSURE;\n                break;\n            case \"CONTROLLER CHANGE\":\n            case \"CONTROLLERCHANGE\":\n            case \"CC\":\n                return MIDIEvent.CONTROLLERCHANGE;\n                break;\n            case \"PROGRAM CHANGE\":\n            case \"PROGRAMCHANGE\":\n            case \"PC\":\n                return MIDIEvent.PROGRAMCHANGE;\n                break;\n            case \"CHANNEL PRESSURE\":\n            case \"CHANNELPRESSURE\":\n                return MIDIEvent.CHANNELPRESSURE;\n                break;\n            case \"PITCH BEND\":\n            case \"PITCHBEND\":\n                return MIDIEvent.PITCHBEND;\n                break;\n            case \"TIME TICK\":\n            case \"TIMETICK\":\n                return MIDIEvent.TIMETICK;\n                break;\n            default:\n                return Number(str); //assume its a hex code\n        }\n    };\n\n    //transform from a pitch number to string like \"C4\"\n    MIDIEvent.toNoteString = function(d, skip_octave) {\n        d = Math.round(d); //in case it has decimals\n        var note = d - 21;\n        var octave = Math.floor((d - 24) / 12 + 1);\n        note = note % 12;\n        if (note < 0) {\n            note = 12 + note;\n        }\n        return MIDIEvent.notes[note] + (skip_octave ? \"\" : octave);\n    };\n\n    MIDIEvent.NoteStringToPitch = function(str) {\n        str = str.toUpperCase();\n        var note = str[0];\n        var octave = 4;\n\n        if (str[1] == \"#\") {\n            note += \"#\";\n            if (str.length > 2) {\n                octave = Number(str[2]);\n            }\n        } else {\n            if (str.length > 1) {\n                octave = Number(str[1]);\n            }\n        }\n        var pitch = MIDIEvent.note_to_index[note];\n        if (pitch == null) {\n            return null;\n        }\n        return (octave - 1) * 12 + pitch + 21;\n    };\n\n    MIDIEvent.prototype.toString = function() {\n        var str = \"\" + this.channel + \". \";\n        switch (this.cmd) {\n            case MIDIEvent.NOTEON:\n                str += \"NOTEON \" + MIDIEvent.toNoteString(this.data[1]);\n                break;\n            case MIDIEvent.NOTEOFF:\n                str += \"NOTEOFF \" + MIDIEvent.toNoteString(this.data[1]);\n                break;\n            case MIDIEvent.CONTROLLERCHANGE:\n                str += \"CC \" + this.data[1] + \" \" + this.data[2];\n                break;\n            case MIDIEvent.PROGRAMCHANGE:\n                str += \"PC \" + this.data[1];\n                break;\n            case MIDIEvent.PITCHBEND:\n                str += \"PITCHBEND \" + this.getPitchBend();\n                break;\n            case MIDIEvent.KEYPRESSURE:\n                str += \"KEYPRESS \" + this.data[1];\n                break;\n        }\n\n        return str;\n    };\n\n    MIDIEvent.prototype.toHexString = function() {\n        var str = \"\";\n        for (var i = 0; i < this.data.length; i++) {\n            str += this.data[i].toString(16) + \" \";\n        }\n    };\n\n    MIDIEvent.prototype.toJSON = function() {\n        return {\n            data: [this.data[0], this.data[1], this.data[2]],\n            object_class: \"MIDIEvent\"\n        };\n    };\n\n    MIDIEvent.NOTEOFF = 0x80;\n    MIDIEvent.NOTEON = 0x90;\n    MIDIEvent.KEYPRESSURE = 0xa0;\n    MIDIEvent.CONTROLLERCHANGE = 0xb0;\n    MIDIEvent.PROGRAMCHANGE = 0xc0;\n    MIDIEvent.CHANNELPRESSURE = 0xd0;\n    MIDIEvent.PITCHBEND = 0xe0;\n    MIDIEvent.TIMETICK = 0xf8;\n\n    MIDIEvent.commands = {\n        0x80: \"note off\",\n        0x90: \"note on\",\n        0xa0: \"key pressure\",\n        0xb0: \"controller change\",\n        0xc0: \"program change\",\n        0xd0: \"channel pressure\",\n        0xe0: \"pitch bend\",\n        0xf0: \"system\",\n        0xf2: \"Song pos\",\n        0xf3: \"Song select\",\n        0xf6: \"Tune request\",\n        0xf8: \"time tick\",\n        0xfa: \"Start Song\",\n        0xfb: \"Continue Song\",\n        0xfc: \"Stop Song\",\n        0xfe: \"Sensing\",\n        0xff: \"Reset\"\n    };\n\n    MIDIEvent.commands_short = {\n        0x80: \"NOTEOFF\",\n        0x90: \"NOTEOFF\",\n        0xa0: \"KEYP\",\n        0xb0: \"CC\",\n        0xc0: \"PC\",\n        0xd0: \"CP\",\n        0xe0: \"PB\",\n        0xf0: \"SYS\",\n        0xf2: \"POS\",\n        0xf3: \"SELECT\",\n        0xf6: \"TUNEREQ\",\n        0xf8: \"TT\",\n        0xfa: \"START\",\n        0xfb: \"CONTINUE\",\n        0xfc: \"STOP\",\n        0xfe: \"SENS\",\n        0xff: \"RESET\"\n    };\n\n    MIDIEvent.commands_reversed = {};\n    for (var i in MIDIEvent.commands) {\n        MIDIEvent.commands_reversed[MIDIEvent.commands[i]] = i;\n    }\n\n    //MIDI wrapper, instantiate by MIDIIn and MIDIOut\n    function MIDIInterface(on_ready, on_error) {\n        if (!navigator.requestMIDIAccess) {\n            this.error = \"not suppoorted\";\n            if (on_error) {\n                on_error(\"Not supported\");\n            } else {\n                console.error(\"MIDI NOT SUPPORTED, enable by chrome://flags\");\n            }\n            return;\n        }\n\n        this.on_ready = on_ready;\n\n        this.state = {\n            note: [],\n            cc: []\n        };\n\n\t\tthis.input_ports = null;\n\t\tthis.input_ports_info = [];\n\t\tthis.output_ports = null;\n\t\tthis.output_ports_info = [];\n\n        navigator.requestMIDIAccess().then(this.onMIDISuccess.bind(this), this.onMIDIFailure.bind(this));\n    }\n\n    MIDIInterface.input = null;\n\n    MIDIInterface.MIDIEvent = MIDIEvent;\n\n    MIDIInterface.prototype.onMIDISuccess = function(midiAccess) {\n        console.log(\"MIDI ready!\");\n        console.log(midiAccess);\n        this.midi = midiAccess; // store in the global (in real usage, would probably keep in an object instance)\n        this.updatePorts();\n\n        if (this.on_ready) {\n            this.on_ready(this);\n        }\n    };\n\n    MIDIInterface.prototype.updatePorts = function() {\n        var midi = this.midi;\n        this.input_ports = midi.inputs;\n\t\tthis.input_ports_info = [];\n        this.output_ports = midi.outputs;\n\t\tthis.output_ports_info = [];\n\n        var num = 0;\n\n        var it = this.input_ports.values();\n        var it_value = it.next();\n        while (it_value && it_value.done === false) {\n            var port_info = it_value.value;\n\t\t\tthis.input_ports_info.push(port_info);\n            console.log( \"Input port [type:'\" + port_info.type + \"'] id:'\" + port_info.id + \"' manufacturer:'\" + port_info.manufacturer + \"' name:'\" + port_info.name + \"' version:'\" + port_info.version + \"'\" );\n            num++;\n            it_value = it.next();\n        }\n        this.num_input_ports = num;\n\n        num = 0;\n        var it = this.output_ports.values();\n        var it_value = it.next();\n        while (it_value && it_value.done === false) {\n            var port_info = it_value.value;\n\t\t\tthis.output_ports_info.push(port_info);\n            console.log( \"Output port [type:'\" + port_info.type + \"'] id:'\" + port_info.id + \"' manufacturer:'\" + port_info.manufacturer + \"' name:'\" + port_info.name + \"' version:'\" + port_info.version + \"'\" );\n            num++;\n            it_value = it.next();\n        }\n        this.num_output_ports = num;\n    };\n\n    MIDIInterface.prototype.onMIDIFailure = function(msg) {\n        console.error(\"Failed to get MIDI access - \" + msg);\n    };\n\n    MIDIInterface.prototype.openInputPort = function(port, callback) {\n        var input_port = this.input_ports.get(\"input-\" + port);\n        if (!input_port) {\n            return false;\n        }\n        MIDIInterface.input = this;\n        var that = this;\n\n        input_port.onmidimessage = function(a) {\n            var midi_event = new MIDIEvent(a.data);\n            that.updateState(midi_event);\n            if (callback) {\n                callback(a.data, midi_event);\n            }\n            if (MIDIInterface.on_message) {\n                MIDIInterface.on_message(a.data, midi_event);\n            }\n        };\n        console.log(\"port open: \", input_port);\n        return true;\n    };\n\n    MIDIInterface.parseMsg = function(data) {};\n\n    MIDIInterface.prototype.updateState = function(midi_event) {\n        switch (midi_event.cmd) {\n            case MIDIEvent.NOTEON:\n                this.state.note[midi_event.value1 | 0] = midi_event.value2;\n                break;\n            case MIDIEvent.NOTEOFF:\n                this.state.note[midi_event.value1 | 0] = 0;\n                break;\n            case MIDIEvent.CONTROLLERCHANGE:\n                this.state.cc[midi_event.getCC()] = midi_event.getCCValue();\n                break;\n        }\n    };\n\n    MIDIInterface.prototype.sendMIDI = function(port, midi_data) {\n        if (!midi_data) {\n            return;\n        }\n\n        var output_port = this.output_ports_info[port];//this.output_ports.get(\"output-\" + port);\n        if (!output_port) {\n            return;\n        }\n\n        MIDIInterface.output = this;\n\n        if (midi_data.constructor === MIDIEvent) {\n            output_port.send(midi_data.data);\n        } else {\n            output_port.send(midi_data);\n        }\n    };\n\n    function LGMIDIIn() {\n        this.addOutput(\"on_midi\", LiteGraph.EVENT);\n        this.addOutput(\"out\", \"midi\");\n        this.properties = { port: 0 };\n        this._last_midi_event = null;\n        this._current_midi_event = null;\n        this.boxcolor = \"#AAA\";\n        this._last_time = 0;\n\n        var that = this;\n        new MIDIInterface(function(midi) {\n            //open\n            that._midi = midi;\n            if (that._waiting) {\n                that.onStart();\n            }\n            that._waiting = false;\n        });\n    }\n\n    LGMIDIIn.MIDIInterface = MIDIInterface;\n\n    LGMIDIIn.title = \"MIDI Input\";\n    LGMIDIIn.desc = \"Reads MIDI from a input port\";\n    LGMIDIIn.color = MIDI_COLOR;\n\n    LGMIDIIn.prototype.getPropertyInfo = function(name) {\n        if (!this._midi) {\n            return;\n        }\n\n        if (name == \"port\") {\n            var values = {};\n            for (var i = 0; i < this._midi.input_ports_info.length; ++i) {\n                var input = this._midi.input_ports_info[i];\n                values[i] = i + \".- \" + input.name + \" version:\" + input.version;\n            }\n            return { type: \"enum\", values: values };\n        }\n    };\n\n    LGMIDIIn.prototype.onStart = function() {\n        if (this._midi) {\n            this._midi.openInputPort(\n                this.properties.port,\n                this.onMIDIEvent.bind(this)\n            );\n        } else {\n            this._waiting = true;\n        }\n    };\n\n    LGMIDIIn.prototype.onMIDIEvent = function(data, midi_event) {\n        this._last_midi_event = midi_event;\n        this.boxcolor = \"#AFA\";\n        this._last_time = LiteGraph.getTime();\n        this.trigger(\"on_midi\", midi_event);\n        if (midi_event.cmd == MIDIEvent.NOTEON) {\n            this.trigger(\"on_noteon\", midi_event);\n        } else if (midi_event.cmd == MIDIEvent.NOTEOFF) {\n            this.trigger(\"on_noteoff\", midi_event);\n        } else if (midi_event.cmd == MIDIEvent.CONTROLLERCHANGE) {\n            this.trigger(\"on_cc\", midi_event);\n        } else if (midi_event.cmd == MIDIEvent.PROGRAMCHANGE) {\n            this.trigger(\"on_pc\", midi_event);\n        } else if (midi_event.cmd == MIDIEvent.PITCHBEND) {\n            this.trigger(\"on_pitchbend\", midi_event);\n        }\n    };\n\n    LGMIDIIn.prototype.onDrawBackground = function(ctx) {\n        this.boxcolor = \"#AAA\";\n        if (!this.flags.collapsed && this._last_midi_event) {\n            ctx.fillStyle = \"white\";\n            var now = LiteGraph.getTime();\n            var f = 1.0 - Math.max(0, (now - this._last_time) * 0.001);\n            if (f > 0) {\n                var t = ctx.globalAlpha;\n                ctx.globalAlpha *= f;\n                ctx.font = \"12px Tahoma\";\n                ctx.fillText(\n                    this._last_midi_event.toString(),\n                    2,\n                    this.size[1] * 0.5 + 3\n                );\n                //ctx.fillRect(0,0,this.size[0],this.size[1]);\n                ctx.globalAlpha = t;\n            }\n        }\n    };\n\n    LGMIDIIn.prototype.onExecute = function() {\n        if (this.outputs) {\n            var last = this._last_midi_event;\n            for (var i = 0; i < this.outputs.length; ++i) {\n                var output = this.outputs[i];\n                var v = null;\n                switch (output.name) {\n                    case \"midi\":\n                        v = this._midi;\n                        break;\n                    case \"last_midi\":\n                        v = last;\n                        break;\n                    default:\n                        continue;\n                }\n                this.setOutputData(i, v);\n            }\n        }\n    };\n\n    LGMIDIIn.prototype.onGetOutputs = function() {\n        return [\n            [\"last_midi\", \"midi\"],\n            [\"on_midi\", LiteGraph.EVENT],\n            [\"on_noteon\", LiteGraph.EVENT],\n            [\"on_noteoff\", LiteGraph.EVENT],\n            [\"on_cc\", LiteGraph.EVENT],\n            [\"on_pc\", LiteGraph.EVENT],\n            [\"on_pitchbend\", LiteGraph.EVENT]\n        ];\n    };\n\n    LiteGraph.registerNodeType(\"midi/input\", LGMIDIIn);\n\n    function LGMIDIOut() {\n        this.addInput(\"send\", LiteGraph.EVENT);\n        this.properties = { port: 0 };\n\n        var that = this;\n        new MIDIInterface(function(midi) {\n            that._midi = midi;\n\t\t\tthat.widget.options.values = that.getMIDIOutputs();\n        });\n\t\tthis.widget = this.addWidget(\"combo\",\"Device\",this.properties.port,{ property: \"port\", values: this.getMIDIOutputs.bind(this) });\n\t\tthis.size = [340,60];\n    }\n\n    LGMIDIOut.MIDIInterface = MIDIInterface;\n\n    LGMIDIOut.title = \"MIDI Output\";\n    LGMIDIOut.desc = \"Sends MIDI to output channel\";\n    LGMIDIOut.color = MIDI_COLOR;\n\n    LGMIDIOut.prototype.onGetPropertyInfo = function(name) {\n        if (!this._midi) {\n            return;\n        }\n\n        if (name == \"port\") {\n\t\t\tvar values = this.getMIDIOutputs();\n            return { type: \"enum\", values: values };\n        }\n    };\n\tLGMIDIOut.default_ports = {0:\"unknown\"};\n\n\tLGMIDIOut.prototype.getMIDIOutputs = function()\n\t{\n\t\tvar values = {};\n\t\tif(!this._midi)\n\t\t\treturn LGMIDIOut.default_ports;\n\t\tif(this._midi.output_ports_info)\n\t\tfor (var i = 0; i < this._midi.output_ports_info.length; ++i) {\n\t\t\tvar output = this._midi.output_ports_info[i];\n\t\t\tif(!output)\n\t\t\t\tcontinue;\n\t\t\tvar name = i + \".- \" + output.name + \" version:\" + output.version;\n\t\t\tvalues[i] = name;\n\t\t}\n\t\treturn values;\n\t}\n\n    LGMIDIOut.prototype.onAction = function(event, midi_event) {\n        //console.log(midi_event);\n        if (!this._midi) {\n            return;\n        }\n        if (event == \"send\") {\n            this._midi.sendMIDI(this.properties.port, midi_event);\n        }\n        this.trigger(\"midi\", midi_event);\n    };\n\n    LGMIDIOut.prototype.onGetInputs = function() {\n        return [[\"send\", LiteGraph.ACTION]];\n    };\n\n    LGMIDIOut.prototype.onGetOutputs = function() {\n        return [[\"on_midi\", LiteGraph.EVENT]];\n    };\n\n    LiteGraph.registerNodeType(\"midi/output\", LGMIDIOut);\n\n\n    function LGMIDIShow() {\n        this.addInput(\"on_midi\", LiteGraph.EVENT);\n        this._str = \"\";\n        this.size = [200, 40];\n    }\n\n    LGMIDIShow.title = \"MIDI Show\";\n    LGMIDIShow.desc = \"Shows MIDI in the graph\";\n    LGMIDIShow.color = MIDI_COLOR;\n\n    LGMIDIShow.prototype.getTitle = function() {\n        if (this.flags.collapsed) {\n            return this._str;\n        }\n        return this.title;\n    };\n\n    LGMIDIShow.prototype.onAction = function(event, midi_event) {\n        if (!midi_event) {\n            return;\n        }\n        if (midi_event.constructor === MIDIEvent) {\n            this._str = midi_event.toString();\n        } else {\n            this._str = \"???\";\n        }\n    };\n\n    LGMIDIShow.prototype.onDrawForeground = function(ctx) {\n        if (!this._str || this.flags.collapsed) {\n            return;\n        }\n\n        ctx.font = \"30px Arial\";\n        ctx.fillText(this._str, 10, this.size[1] * 0.8);\n    };\n\n    LGMIDIShow.prototype.onGetInputs = function() {\n        return [[\"in\", LiteGraph.ACTION]];\n    };\n\n    LGMIDIShow.prototype.onGetOutputs = function() {\n        return [[\"on_midi\", LiteGraph.EVENT]];\n    };\n\n    LiteGraph.registerNodeType(\"midi/show\", LGMIDIShow);\n\n    function LGMIDIFilter() {\n        this.properties = {\n            channel: -1,\n            cmd: -1,\n            min_value: -1,\n            max_value: -1\n        };\n\n        var that = this;\n        this._learning = false;\n        this.addWidget(\"button\", \"Learn\", \"\", function() {\n            that._learning = true;\n            that.boxcolor = \"#FA3\";\n        });\n\n        this.addInput(\"in\", LiteGraph.EVENT);\n        this.addOutput(\"on_midi\", LiteGraph.EVENT);\n        this.boxcolor = \"#AAA\";\n    }\n\n    LGMIDIFilter.title = \"MIDI Filter\";\n    LGMIDIFilter.desc = \"Filters MIDI messages\";\n    LGMIDIFilter.color = MIDI_COLOR;\n\n    LGMIDIFilter[\"@cmd\"] = {\n        type: \"enum\",\n        title: \"Command\",\n        values: MIDIEvent.commands_reversed\n    };\n\n    LGMIDIFilter.prototype.getTitle = function() {\n        var str = null;\n        if (this.properties.cmd == -1) {\n            str = \"Nothing\";\n        } else {\n            str = MIDIEvent.commands_short[this.properties.cmd] || \"Unknown\";\n        }\n\n        if (\n            this.properties.min_value != -1 &&\n            this.properties.max_value != -1\n        ) {\n            str +=\n                \" \" +\n                (this.properties.min_value == this.properties.max_value\n                    ? this.properties.max_value\n                    : this.properties.min_value +\n                      \"..\" +\n                      this.properties.max_value);\n        }\n\n        return \"Filter: \" + str;\n    };\n\n    LGMIDIFilter.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"cmd\") {\n            var num = Number(value);\n            if (isNaN(num)) {\n                num = MIDIEvent.commands[value] || 0;\n            }\n            this.properties.cmd = num;\n        }\n    };\n\n    LGMIDIFilter.prototype.onAction = function(event, midi_event) {\n        if (!midi_event || midi_event.constructor !== MIDIEvent) {\n            return;\n        }\n\n        if (this._learning) {\n            this._learning = false;\n            this.boxcolor = \"#AAA\";\n            this.properties.channel = midi_event.channel;\n            this.properties.cmd = midi_event.cmd;\n            this.properties.min_value = this.properties.max_value =\n                midi_event.data[1];\n        } else {\n            if (\n                this.properties.channel != -1 &&\n                midi_event.channel != this.properties.channel\n            ) {\n                return;\n            }\n            if (\n                this.properties.cmd != -1 &&\n                midi_event.cmd != this.properties.cmd\n            ) {\n                return;\n            }\n            if (\n                this.properties.min_value != -1 &&\n                midi_event.data[1] < this.properties.min_value\n            ) {\n                return;\n            }\n            if (\n                this.properties.max_value != -1 &&\n                midi_event.data[1] > this.properties.max_value\n            ) {\n                return;\n            }\n        }\n\n        this.trigger(\"on_midi\", midi_event);\n    };\n\n    LiteGraph.registerNodeType(\"midi/filter\", LGMIDIFilter);\n\n    function LGMIDIEvent() {\n        this.properties = {\n            channel: 0,\n            cmd: 144, //0x90\n            value1: 1,\n            value2: 1\n        };\n\n        this.addInput(\"send\", LiteGraph.EVENT);\n        this.addInput(\"assign\", LiteGraph.EVENT);\n        this.addOutput(\"on_midi\", LiteGraph.EVENT);\n\n        this.midi_event = new MIDIEvent();\n        this.gate = false;\n    }\n\n    LGMIDIEvent.title = \"MIDIEvent\";\n    LGMIDIEvent.desc = \"Create a MIDI Event\";\n    LGMIDIEvent.color = MIDI_COLOR;\n\n    LGMIDIEvent.prototype.onAction = function(event, midi_event) {\n        if (event == \"assign\") {\n            this.properties.channel = midi_event.channel;\n            this.properties.cmd = midi_event.cmd;\n            this.properties.value1 = midi_event.data[1];\n            this.properties.value2 = midi_event.data[2];\n            if (midi_event.cmd == MIDIEvent.NOTEON) {\n                this.gate = true;\n            } else if (midi_event.cmd == MIDIEvent.NOTEOFF) {\n                this.gate = false;\n            }\n            return;\n        }\n\n        //send\n        var midi_event = this.midi_event;\n        midi_event.channel = this.properties.channel;\n        if (this.properties.cmd && this.properties.cmd.constructor === String) {\n            midi_event.setCommandFromString(this.properties.cmd);\n        } else {\n            midi_event.cmd = this.properties.cmd;\n        }\n        midi_event.data[0] = midi_event.cmd | midi_event.channel;\n        midi_event.data[1] = Number(this.properties.value1);\n        midi_event.data[2] = Number(this.properties.value2);\n\n        this.trigger(\"on_midi\", midi_event);\n    };\n\n    LGMIDIEvent.prototype.onExecute = function() {\n        var props = this.properties;\n\n        if (this.inputs) {\n            for (var i = 0; i < this.inputs.length; ++i) {\n                var input = this.inputs[i];\n                if (input.link == -1) {\n                    continue;\n                }\n                switch (input.name) {\n                    case \"note\":\n                        var v = this.getInputData(i);\n                        if (v != null) {\n                            if (v.constructor === String) {\n                                v = MIDIEvent.NoteStringToPitch(v);\n                            }\n                            this.properties.value1 = (v | 0) % 255;\n                        }\n                        break;\n                    case \"cmd\":\n                        var v = this.getInputData(i);\n                        if (v != null) {\n                            this.properties.cmd = v;\n                        }\n                        break;\n                    case \"value1\":\n                        var v = this.getInputData(i);\n                        if (v != null) {\n                            this.properties.value1 = Math.clamp(v|0,0,127);\n                        }\n                        break;\n                    case \"value2\":\n                        var v = this.getInputData(i);\n                        if (v != null) {\n                            this.properties.value2 = Math.clamp(v|0,0,127);\n                        }\n                        break;\n                }\n            }\n        }\n\n        if (this.outputs) {\n            for (var i = 0; i < this.outputs.length; ++i) {\n                var output = this.outputs[i];\n                var v = null;\n                switch (output.name) {\n                    case \"midi\":\n                        v = new MIDIEvent();\n                        v.setup([props.cmd, props.value1, props.value2]);\n                        v.channel = props.channel;\n                        break;\n                    case \"command\":\n                        v = props.cmd;\n                        break;\n                    case \"cc\":\n                        v = props.value1;\n                        break;\n                    case \"cc_value\":\n                        v = props.value2;\n                        break;\n                    case \"note\":\n                        v =\n                            props.cmd == MIDIEvent.NOTEON ||\n                            props.cmd == MIDIEvent.NOTEOFF\n                                ? props.value1\n                                : null;\n                        break;\n                    case \"velocity\":\n                        v = props.cmd == MIDIEvent.NOTEON ? props.value2 : null;\n                        break;\n                    case \"pitch\":\n                        v =\n                            props.cmd == MIDIEvent.NOTEON\n                                ? MIDIEvent.computePitch(props.value1)\n                                : null;\n                        break;\n                    case \"pitchbend\":\n                        v =\n                            props.cmd == MIDIEvent.PITCHBEND\n                                ? MIDIEvent.computePitchBend(\n                                      props.value1,\n                                      props.value2\n                                  )\n                                : null;\n                        break;\n                    case \"gate\":\n                        v = this.gate;\n                        break;\n                    default:\n                        continue;\n                }\n                if (v !== null) {\n                    this.setOutputData(i, v);\n                }\n            }\n        }\n    };\n\n    LGMIDIEvent.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"cmd\") {\n            this.properties.cmd = MIDIEvent.computeCommandFromString(value);\n        }\n    };\n\n    LGMIDIEvent.prototype.onGetInputs = function() {\n        return [[\"cmd\", \"number\"],[\"note\", \"number\"],[\"value1\", \"number\"],[\"value2\", \"number\"]];\n    };\n\n    LGMIDIEvent.prototype.onGetOutputs = function() {\n        return [\n            [\"midi\", \"midi\"],\n            [\"on_midi\", LiteGraph.EVENT],\n            [\"command\", \"number\"],\n            [\"note\", \"number\"],\n            [\"velocity\", \"number\"],\n            [\"cc\", \"number\"],\n            [\"cc_value\", \"number\"],\n            [\"pitch\", \"number\"],\n            [\"gate\", \"bool\"],\n            [\"pitchbend\", \"number\"]\n        ];\n    };\n\n    LiteGraph.registerNodeType(\"midi/event\", LGMIDIEvent);\n\n    function LGMIDICC() {\n        this.properties = {\n            //\t\tchannel: 0,\n            cc: 1,\n            value: 0\n        };\n\n        this.addOutput(\"value\", \"number\");\n    }\n\n    LGMIDICC.title = \"MIDICC\";\n    LGMIDICC.desc = \"gets a Controller Change\";\n    LGMIDICC.color = MIDI_COLOR;\n\n    LGMIDICC.prototype.onExecute = function() {\n        var props = this.properties;\n        if (MIDIInterface.input) {\n            this.properties.value =\n                MIDIInterface.input.state.cc[this.properties.cc];\n        }\n        this.setOutputData(0, this.properties.value);\n    };\n\n    LiteGraph.registerNodeType(\"midi/cc\", LGMIDICC);\n\n    function LGMIDIGenerator() {\n        this.addInput(\"generate\", LiteGraph.ACTION);\n        this.addInput(\"scale\", \"string\");\n        this.addInput(\"octave\", \"number\");\n        this.addOutput(\"note\", LiteGraph.EVENT);\n        this.properties = {\n            notes: \"A,A#,B,C,C#,D,D#,E,F,F#,G,G#\",\n            octave: 2,\n            duration: 0.5,\n            mode: \"sequence\"\n        };\n\n        this.notes_pitches = LGMIDIGenerator.processScale(\n            this.properties.notes\n        );\n        this.sequence_index = 0;\n    }\n\n    LGMIDIGenerator.title = \"MIDI Generator\";\n    LGMIDIGenerator.desc = \"Generates a random MIDI note\";\n    LGMIDIGenerator.color = MIDI_COLOR;\n\n    LGMIDIGenerator.processScale = function(scale) {\n        var notes = scale.split(\",\");\n        for (var i = 0; i < notes.length; ++i) {\n            var n = notes[i];\n            if ((n.length == 2 && n[1] != \"#\") || n.length > 2) {\n                notes[i] = -LiteGraph.MIDIEvent.NoteStringToPitch(n);\n            } else {\n                notes[i] = MIDIEvent.note_to_index[n] || 0;\n            }\n        }\n        return notes;\n    };\n\n    LGMIDIGenerator.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"notes\") {\n            this.notes_pitches = LGMIDIGenerator.processScale(value);\n        }\n    };\n\n    LGMIDIGenerator.prototype.onExecute = function() {\n        var octave = this.getInputData(2);\n        if (octave != null) {\n            this.properties.octave = octave;\n        }\n\n        var scale = this.getInputData(1);\n        if (scale) {\n            this.notes_pitches = LGMIDIGenerator.processScale(scale);\n        }\n    };\n\n    LGMIDIGenerator.prototype.onAction = function(event, midi_event) {\n        //var range = this.properties.max - this.properties.min;\n        //var pitch = this.properties.min + ((Math.random() * range)|0);\n        var pitch = 0;\n        var range = this.notes_pitches.length;\n        var index = 0;\n\n        if (this.properties.mode == \"sequence\") {\n            index = this.sequence_index = (this.sequence_index + 1) % range;\n        } else if (this.properties.mode == \"random\") {\n            index = Math.floor(Math.random() * range);\n        }\n\n        var note = this.notes_pitches[index];\n        if (note >= 0) {\n            pitch = note + (this.properties.octave - 1) * 12 + 33;\n        } else {\n            pitch = -note;\n        }\n\n        var midi_event = new MIDIEvent();\n        midi_event.setup([MIDIEvent.NOTEON, pitch, 10]);\n        var duration = this.properties.duration || 1;\n        this.trigger(\"note\", midi_event);\n\n        //noteoff\n        setTimeout(\n            function() {\n                var midi_event = new MIDIEvent();\n                midi_event.setup([MIDIEvent.NOTEOFF, pitch, 0]);\n                this.trigger(\"note\", midi_event);\n            }.bind(this),\n            duration * 1000\n        );\n    };\n\n    LiteGraph.registerNodeType(\"midi/generator\", LGMIDIGenerator);\n\n    function LGMIDITranspose() {\n        this.properties = {\n            amount: 0\n        };\n        this.addInput(\"in\", LiteGraph.ACTION);\n        this.addInput(\"amount\", \"number\");\n        this.addOutput(\"out\", LiteGraph.EVENT);\n\n        this.midi_event = new MIDIEvent();\n    }\n\n    LGMIDITranspose.title = \"MIDI Transpose\";\n    LGMIDITranspose.desc = \"Transpose a MIDI note\";\n    LGMIDITranspose.color = MIDI_COLOR;\n\n    LGMIDITranspose.prototype.onAction = function(event, midi_event) {\n        if (!midi_event || midi_event.constructor !== MIDIEvent) {\n            return;\n        }\n\n        if (\n            midi_event.data[0] == MIDIEvent.NOTEON ||\n            midi_event.data[0] == MIDIEvent.NOTEOFF\n        ) {\n            this.midi_event = new MIDIEvent();\n            this.midi_event.setup(midi_event.data);\n            this.midi_event.data[1] = Math.round(\n                this.midi_event.data[1] + this.properties.amount\n            );\n            this.trigger(\"out\", this.midi_event);\n        } else {\n            this.trigger(\"out\", midi_event);\n        }\n    };\n\n    LGMIDITranspose.prototype.onExecute = function() {\n        var amount = this.getInputData(1);\n        if (amount != null) {\n            this.properties.amount = amount;\n        }\n    };\n\n    LiteGraph.registerNodeType(\"midi/transpose\", LGMIDITranspose);\n\n    function LGMIDIQuantize() {\n        this.properties = {\n            scale: \"A,A#,B,C,C#,D,D#,E,F,F#,G,G#\"\n        };\n        this.addInput(\"note\", LiteGraph.ACTION);\n        this.addInput(\"scale\", \"string\");\n        this.addOutput(\"out\", LiteGraph.EVENT);\n\n        this.valid_notes = new Array(12);\n        this.offset_notes = new Array(12);\n        this.processScale(this.properties.scale);\n    }\n\n    LGMIDIQuantize.title = \"MIDI Quantize Pitch\";\n    LGMIDIQuantize.desc = \"Transpose a MIDI note tp fit an scale\";\n    LGMIDIQuantize.color = MIDI_COLOR;\n\n    LGMIDIQuantize.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"scale\") {\n            this.processScale(value);\n        }\n    };\n\n    LGMIDIQuantize.prototype.processScale = function(scale) {\n        this._current_scale = scale;\n        this.notes_pitches = LGMIDIGenerator.processScale(scale);\n        for (var i = 0; i < 12; ++i) {\n            this.valid_notes[i] = this.notes_pitches.indexOf(i) != -1;\n        }\n        for (var i = 0; i < 12; ++i) {\n            if (this.valid_notes[i]) {\n                this.offset_notes[i] = 0;\n                continue;\n            }\n            for (var j = 1; j < 12; ++j) {\n                if (this.valid_notes[(i - j) % 12]) {\n                    this.offset_notes[i] = -j;\n                    break;\n                }\n                if (this.valid_notes[(i + j) % 12]) {\n                    this.offset_notes[i] = j;\n                    break;\n                }\n            }\n        }\n    };\n\n    LGMIDIQuantize.prototype.onAction = function(event, midi_event) {\n        if (!midi_event || midi_event.constructor !== MIDIEvent) {\n            return;\n        }\n\n        if (\n            midi_event.data[0] == MIDIEvent.NOTEON ||\n            midi_event.data[0] == MIDIEvent.NOTEOFF\n        ) {\n            this.midi_event = new MIDIEvent();\n            this.midi_event.setup(midi_event.data);\n            var note = midi_event.note;\n            var index = MIDIEvent.note_to_index[note];\n            var offset = this.offset_notes[index];\n            this.midi_event.data[1] += offset;\n            this.trigger(\"out\", this.midi_event);\n        } else {\n            this.trigger(\"out\", midi_event);\n        }\n    };\n\n    LGMIDIQuantize.prototype.onExecute = function() {\n        var scale = this.getInputData(1);\n        if (scale != null && scale != this._current_scale) {\n            this.processScale(scale);\n        }\n    };\n\n    LiteGraph.registerNodeType(\"midi/quantize\", LGMIDIQuantize);\n\n\tfunction LGMIDIFromFile() {\n        this.properties = {\n            url: \"\",\n\t\t\tautoplay: true\n        };\n\n        this.addInput(\"play\", LiteGraph.ACTION);\n        this.addInput(\"pause\", LiteGraph.ACTION);\n        this.addOutput(\"note\", LiteGraph.EVENT);\n\t\tthis._midi = null;\n\t\tthis._current_time = 0;\n\t\tthis._playing = false;\n\n        if (typeof MidiParser == \"undefined\") {\n            console.error(\n                \"midi-parser.js not included, LGMidiPlay requires that library: https://raw.githubusercontent.com/colxi/midi-parser-js/master/src/main.js\"\n            );\n            this.boxcolor = \"red\";\n\t\t}\n\n\t}\n\n    LGMIDIFromFile.title = \"MIDI fromFile\";\n    LGMIDIFromFile.desc = \"Plays a MIDI file\";\n    LGMIDIFromFile.color = MIDI_COLOR;\n\n\tLGMIDIFromFile.prototype.onAction = function( name )\n\t{\n\t\tif(name == \"play\")\n\t\t\tthis.play();\n\t\telse if(name == \"pause\")\n\t\t\tthis._playing = !this._playing;\n\t}\n\n\tLGMIDIFromFile.prototype.onPropertyChanged = function(name,value)\n\t{\n\t\tif(name == \"url\")\n\t\t\tthis.loadMIDIFile(value);\n\t}\n\n    LGMIDIFromFile.prototype.onExecute = function() {\n\t\tif(!this._midi)\n\t\t\treturn;\n\n\t\tif(!this._playing)\n\t\t\treturn;\n\n\t\tthis._current_time += this.graph.elapsed_time;\n\t\tvar current_time = this._current_time * 100;\n\n\t\tfor(var i = 0; i < this._midi.tracks; ++i)\n\t\t{\n\t\t\tvar track = this._midi.track[i];\n\t\t\tif(!track._last_pos)\n\t\t\t{\n\t\t\t\ttrack._last_pos = 0;\n\t\t\t\ttrack._time = 0;\n\t\t\t}\n\n\t\t\tvar elem = track.event[ track._last_pos ];\n\t\t\tif(elem && (track._time + elem.deltaTime) <= current_time )\n\t\t\t{\n\t\t\t\ttrack._last_pos++;\n\t\t\t\ttrack._time += elem.deltaTime;\n\n\t\t\t\tif(elem.data)\n\t\t\t\t{\n\t\t\t\t\tvar midi_cmd = elem.type << 4 + elem.channel;\n\t\t\t\t\tvar midi_event = new MIDIEvent();\n\t\t\t\t\tmidi_event.setup([midi_cmd, elem.data[0], elem.data[1]]);\n\t\t\t\t\tthis.trigger(\"note\", midi_event);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n    };\n\n\tLGMIDIFromFile.prototype.play = function()\n\t{\n\t\tthis._playing = true;\n\t\tthis._current_time = 0;\n\t\tif(!this._midi)\n\t\t\treturn;\n\n\t\tfor(var i = 0; i < this._midi.tracks; ++i)\n\t\t{\n\t\t\tvar track = this._midi.track[i];\n\t\t\ttrack._last_pos = 0;\n\t\t\ttrack._time = 0;\n\t\t}\t\t\n\t}\n\n\tLGMIDIFromFile.prototype.loadMIDIFile = function(url)\n\t{\n\t\tvar that = this;\n\t\tLiteGraph.fetchFile( url, \"arraybuffer\", function(data)\n\t\t{\n\t\t\tthat.boxcolor = \"#AFA\";\n\t\t\tthat._midi = MidiParser.parse( new Uint8Array(data) );\n\t\t\tif(that.properties.autoplay)\n\t\t\t\tthat.play();\n\t\t}, function(err){\n\t\t\tthat.boxcolor = \"#FAA\";\n\t\t\tthat._midi = null;\n\t\t});\n\t}\n\n\tLGMIDIFromFile.prototype.onDropFile = function(file)\n\t{\n\t\tthis.properties.url = \"\";\n\t\tthis.loadMIDIFile( file );\n\t}\n\n    LiteGraph.registerNodeType(\"midi/fromFile\", LGMIDIFromFile);\n\n\n    function LGMIDIPlay() {\n        this.properties = {\n            volume: 0.5,\n            duration: 1\n        };\n        this.addInput(\"note\", LiteGraph.ACTION);\n        this.addInput(\"volume\", \"number\");\n        this.addInput(\"duration\", \"number\");\n        this.addOutput(\"note\", LiteGraph.EVENT);\n\n        if (typeof AudioSynth == \"undefined\") {\n            console.error(\n                \"Audiosynth.js not included, LGMidiPlay requires that library\"\n            );\n            this.boxcolor = \"red\";\n        } else {\n            var Synth = (this.synth = new AudioSynth());\n            this.instrument = Synth.createInstrument(\"piano\");\n        }\n    }\n\n    LGMIDIPlay.title = \"MIDI Play\";\n    LGMIDIPlay.desc = \"Plays a MIDI note\";\n    LGMIDIPlay.color = MIDI_COLOR;\n\n    LGMIDIPlay.prototype.onAction = function(event, midi_event) {\n        if (!midi_event || midi_event.constructor !== MIDIEvent) {\n            return;\n        }\n\n        if (this.instrument && midi_event.data[0] == MIDIEvent.NOTEON) {\n            var note = midi_event.note; //C#\n            if (!note || note == \"undefined\" || note.constructor !== String) {\n                return;\n            }\n            this.instrument.play(\n                note,\n                midi_event.octave,\n                this.properties.duration,\n                this.properties.volume\n            );\n        }\n        this.trigger(\"note\", midi_event);\n    };\n\n    LGMIDIPlay.prototype.onExecute = function() {\n        var volume = this.getInputData(1);\n        if (volume != null) {\n            this.properties.volume = volume;\n        }\n\n        var duration = this.getInputData(2);\n        if (duration != null) {\n            this.properties.duration = duration;\n        }\n    };\n\n    LiteGraph.registerNodeType(\"midi/play\", LGMIDIPlay);\n\n    function LGMIDIKeys() {\n        this.properties = {\n            num_octaves: 2,\n            start_octave: 2\n        };\n        this.addInput(\"note\", LiteGraph.ACTION);\n        this.addInput(\"reset\", LiteGraph.ACTION);\n        this.addOutput(\"note\", LiteGraph.EVENT);\n        this.size = [400, 100];\n        this.keys = [];\n        this._last_key = -1;\n    }\n\n    LGMIDIKeys.title = \"MIDI Keys\";\n    LGMIDIKeys.desc = \"Keyboard to play notes\";\n    LGMIDIKeys.color = MIDI_COLOR;\n\n    LGMIDIKeys.keys = [\n        { x: 0, w: 1, h: 1, t: 0 },\n        { x: 0.75, w: 0.5, h: 0.6, t: 1 },\n        { x: 1, w: 1, h: 1, t: 0 },\n        { x: 1.75, w: 0.5, h: 0.6, t: 1 },\n        { x: 2, w: 1, h: 1, t: 0 },\n        { x: 2.75, w: 0.5, h: 0.6, t: 1 },\n        { x: 3, w: 1, h: 1, t: 0 },\n        { x: 4, w: 1, h: 1, t: 0 },\n        { x: 4.75, w: 0.5, h: 0.6, t: 1 },\n        { x: 5, w: 1, h: 1, t: 0 },\n        { x: 5.75, w: 0.5, h: 0.6, t: 1 },\n        { x: 6, w: 1, h: 1, t: 0 }\n    ];\n\n    LGMIDIKeys.prototype.onDrawForeground = function(ctx) {\n        if (this.flags.collapsed) {\n            return;\n        }\n\n        var num_keys = this.properties.num_octaves * 12;\n        this.keys.length = num_keys;\n        var key_width = this.size[0] / (this.properties.num_octaves * 7);\n        var key_height = this.size[1];\n\n        ctx.globalAlpha = 1;\n\n        for (\n            var k = 0;\n            k < 2;\n            k++ //draw first whites (0) then blacks (1)\n        ) {\n            for (var i = 0; i < num_keys; ++i) {\n                var key_info = LGMIDIKeys.keys[i % 12];\n                if (key_info.t != k) {\n                    continue;\n                }\n                var octave = Math.floor(i / 12);\n                var x = octave * 7 * key_width + key_info.x * key_width;\n                if (k == 0) {\n                    ctx.fillStyle = this.keys[i] ? \"#CCC\" : \"white\";\n                } else {\n                    ctx.fillStyle = this.keys[i] ? \"#333\" : \"black\";\n                }\n                ctx.fillRect(\n                    x + 1,\n                    0,\n                    key_width * key_info.w - 2,\n                    key_height * key_info.h\n                );\n            }\n        }\n    };\n\n    LGMIDIKeys.prototype.getKeyIndex = function(pos) {\n        var num_keys = this.properties.num_octaves * 12;\n        var key_width = this.size[0] / (this.properties.num_octaves * 7);\n        var key_height = this.size[1];\n\n        for (\n            var k = 1;\n            k >= 0;\n            k-- //test blacks first (1) then whites (0)\n        ) {\n            for (var i = 0; i < this.keys.length; ++i) {\n                var key_info = LGMIDIKeys.keys[i % 12];\n                if (key_info.t != k) {\n                    continue;\n                }\n                var octave = Math.floor(i / 12);\n                var x = octave * 7 * key_width + key_info.x * key_width;\n                var w = key_width * key_info.w;\n                var h = key_height * key_info.h;\n                if (pos[0] < x || pos[0] > x + w || pos[1] > h) {\n                    continue;\n                }\n                return i;\n            }\n        }\n        return -1;\n    };\n\n    LGMIDIKeys.prototype.onAction = function(event, params) {\n        if (event == \"reset\") {\n            for (var i = 0; i < this.keys.length; ++i) {\n                this.keys[i] = false;\n            }\n            return;\n        }\n\n        if (!params || params.constructor !== MIDIEvent) {\n            return;\n        }\n        var midi_event = params;\n        var start_note = (this.properties.start_octave - 1) * 12 + 29;\n        var index = midi_event.data[1] - start_note;\n        if (index >= 0 && index < this.keys.length) {\n            if (midi_event.data[0] == MIDIEvent.NOTEON) {\n                this.keys[index] = true;\n            } else if (midi_event.data[0] == MIDIEvent.NOTEOFF) {\n                this.keys[index] = false;\n            }\n        }\n\n        this.trigger(\"note\", midi_event);\n    };\n\n    LGMIDIKeys.prototype.onMouseDown = function(e, pos) {\n        if (pos[1] < 0) {\n            return;\n        }\n        var index = this.getKeyIndex(pos);\n        this.keys[index] = true;\n        this._last_key = index;\n        var pitch = (this.properties.start_octave - 1) * 12 + 29 + index;\n        var midi_event = new MIDIEvent();\n        midi_event.setup([MIDIEvent.NOTEON, pitch, 100]);\n        this.trigger(\"note\", midi_event);\n        return true;\n    };\n\n    LGMIDIKeys.prototype.onMouseMove = function(e, pos) {\n        if (pos[1] < 0 || this._last_key == -1) {\n            return;\n        }\n        this.setDirtyCanvas(true);\n        var index = this.getKeyIndex(pos);\n        if (this._last_key == index) {\n            return true;\n        }\n        this.keys[this._last_key] = false;\n        var pitch =\n            (this.properties.start_octave - 1) * 12 + 29 + this._last_key;\n        var midi_event = new MIDIEvent();\n        midi_event.setup([MIDIEvent.NOTEOFF, pitch, 100]);\n        this.trigger(\"note\", midi_event);\n\n        this.keys[index] = true;\n        var pitch = (this.properties.start_octave - 1) * 12 + 29 + index;\n        var midi_event = new MIDIEvent();\n        midi_event.setup([MIDIEvent.NOTEON, pitch, 100]);\n        this.trigger(\"note\", midi_event);\n\n        this._last_key = index;\n        return true;\n    };\n\n    LGMIDIKeys.prototype.onMouseUp = function(e, pos) {\n        if (pos[1] < 0) {\n            return;\n        }\n        var index = this.getKeyIndex(pos);\n        this.keys[index] = false;\n        this._last_key = -1;\n        var pitch = (this.properties.start_octave - 1) * 12 + 29 + index;\n        var midi_event = new MIDIEvent();\n        midi_event.setup([MIDIEvent.NOTEOFF, pitch, 100]);\n        this.trigger(\"note\", midi_event);\n        return true;\n    };\n\n    LiteGraph.registerNodeType(\"midi/keys\", LGMIDIKeys);\n\n    function now() {\n        return window.performance.now();\n    }\n})(this);\n\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n    var LGAudio = {};\n    global.LGAudio = LGAudio;\n\n    LGAudio.getAudioContext = function() {\n        if (!this._audio_context) {\n            window.AudioContext =\n                window.AudioContext || window.webkitAudioContext;\n            if (!window.AudioContext) {\n                console.error(\"AudioContext not supported by browser\");\n                return null;\n            }\n            this._audio_context = new AudioContext();\n            this._audio_context.onmessage = function(msg) {\n                console.log(\"msg\", msg);\n            };\n            this._audio_context.onended = function(msg) {\n                console.log(\"ended\", msg);\n            };\n            this._audio_context.oncomplete = function(msg) {\n                console.log(\"complete\", msg);\n            };\n        }\n\n        //in case it crashes\n        //if(this._audio_context.state == \"suspended\")\n        //\tthis._audio_context.resume();\n        return this._audio_context;\n    };\n\n    LGAudio.connect = function(audionodeA, audionodeB) {\n        try {\n            audionodeA.connect(audionodeB);\n        } catch (err) {\n            console.warn(\"LGraphAudio:\", err);\n        }\n    };\n\n    LGAudio.disconnect = function(audionodeA, audionodeB) {\n        try {\n            audionodeA.disconnect(audionodeB);\n        } catch (err) {\n            console.warn(\"LGraphAudio:\", err);\n        }\n    };\n\n    LGAudio.changeAllAudiosConnections = function(node, connect) {\n        if (node.inputs) {\n            for (var i = 0; i < node.inputs.length; ++i) {\n                var input = node.inputs[i];\n                var link_info = node.graph.links[input.link];\n                if (!link_info) {\n                    continue;\n                }\n\n                var origin_node = node.graph.getNodeById(link_info.origin_id);\n                var origin_audionode = null;\n                if (origin_node.getAudioNodeInOutputSlot) {\n                    origin_audionode = origin_node.getAudioNodeInOutputSlot(\n                        link_info.origin_slot\n                    );\n                } else {\n                    origin_audionode = origin_node.audionode;\n                }\n\n                var target_audionode = null;\n                if (node.getAudioNodeInInputSlot) {\n                    target_audionode = node.getAudioNodeInInputSlot(i);\n                } else {\n                    target_audionode = node.audionode;\n                }\n\n                if (connect) {\n                    LGAudio.connect(origin_audionode, target_audionode);\n                } else {\n                    LGAudio.disconnect(origin_audionode, target_audionode);\n                }\n            }\n        }\n\n        if (node.outputs) {\n            for (var i = 0; i < node.outputs.length; ++i) {\n                var output = node.outputs[i];\n                for (var j = 0; j < output.links.length; ++j) {\n                    var link_info = node.graph.links[output.links[j]];\n                    if (!link_info) {\n                        continue;\n                    }\n\n                    var origin_audionode = null;\n                    if (node.getAudioNodeInOutputSlot) {\n                        origin_audionode = node.getAudioNodeInOutputSlot(i);\n                    } else {\n                        origin_audionode = node.audionode;\n                    }\n\n                    var target_node = node.graph.getNodeById(\n                        link_info.target_id\n                    );\n                    var target_audionode = null;\n                    if (target_node.getAudioNodeInInputSlot) {\n                        target_audionode = target_node.getAudioNodeInInputSlot(\n                            link_info.target_slot\n                        );\n                    } else {\n                        target_audionode = target_node.audionode;\n                    }\n\n                    if (connect) {\n                        LGAudio.connect(origin_audionode, target_audionode);\n                    } else {\n                        LGAudio.disconnect(origin_audionode, target_audionode);\n                    }\n                }\n            }\n        }\n    };\n\n    //used by many nodes\n    LGAudio.onConnectionsChange = function(\n        connection,\n        slot,\n        connected,\n        link_info\n    ) {\n        //only process the outputs events\n        if (connection != LiteGraph.OUTPUT) {\n            return;\n        }\n\n        var target_node = null;\n        if (link_info) {\n            target_node = this.graph.getNodeById(link_info.target_id);\n        }\n\n        if (!target_node) {\n            return;\n        }\n\n        //get origin audionode\n        var local_audionode = null;\n        if (this.getAudioNodeInOutputSlot) {\n            local_audionode = this.getAudioNodeInOutputSlot(slot);\n        } else {\n            local_audionode = this.audionode;\n        }\n\n        //get target audionode\n        var target_audionode = null;\n        if (target_node.getAudioNodeInInputSlot) {\n            target_audionode = target_node.getAudioNodeInInputSlot(\n                link_info.target_slot\n            );\n        } else {\n            target_audionode = target_node.audionode;\n        }\n\n        //do the connection/disconnection\n        if (connected) {\n            LGAudio.connect(local_audionode, target_audionode);\n        } else {\n            LGAudio.disconnect(local_audionode, target_audionode);\n        }\n    };\n\n    //this function helps creating wrappers to existing classes\n    LGAudio.createAudioNodeWrapper = function(class_object) {\n        var old_func = class_object.prototype.onPropertyChanged;\n\n        class_object.prototype.onPropertyChanged = function(name, value) {\n            if (old_func) {\n                old_func.call(this, name, value);\n            }\n\n            if (!this.audionode) {\n                return;\n            }\n\n            if (this.audionode[name] === undefined) {\n                return;\n            }\n\n            if (this.audionode[name].value !== undefined) {\n                this.audionode[name].value = value;\n            } else {\n                this.audionode[name] = value;\n            }\n        };\n\n        class_object.prototype.onConnectionsChange =\n            LGAudio.onConnectionsChange;\n    };\n\n    //contains the samples decoded of the loaded audios in AudioBuffer format\n    LGAudio.cached_audios = {};\n\n    LGAudio.loadSound = function(url, on_complete, on_error) {\n        if (LGAudio.cached_audios[url] && url.indexOf(\"blob:\") == -1) {\n            if (on_complete) {\n                on_complete(LGAudio.cached_audios[url]);\n            }\n            return;\n        }\n\n        if (LGAudio.onProcessAudioURL) {\n            url = LGAudio.onProcessAudioURL(url);\n        }\n\n        //load new sample\n        var request = new XMLHttpRequest();\n        request.open(\"GET\", url, true);\n        request.responseType = \"arraybuffer\";\n\n        var context = LGAudio.getAudioContext();\n\n        // Decode asynchronously\n        request.onload = function() {\n            console.log(\"AudioSource loaded\");\n            context.decodeAudioData(\n                request.response,\n                function(buffer) {\n                    console.log(\"AudioSource decoded\");\n                    LGAudio.cached_audios[url] = buffer;\n                    if (on_complete) {\n                        on_complete(buffer);\n                    }\n                },\n                onError\n            );\n        };\n        request.send();\n\n        function onError(err) {\n            console.log(\"Audio loading sample error:\", err);\n            if (on_error) {\n                on_error(err);\n            }\n        }\n\n        return request;\n    };\n\n    //****************************************************\n\n    function LGAudioSource() {\n        this.properties = {\n            src: \"\",\n            gain: 0.5,\n            loop: true,\n            autoplay: true,\n            playbackRate: 1\n        };\n\n        this._loading_audio = false;\n        this._audiobuffer = null; //points to AudioBuffer with the audio samples decoded\n        this._audionodes = [];\n        this._last_sourcenode = null; //the last AudioBufferSourceNode (there could be more if there are several sounds playing)\n\n        this.addOutput(\"out\", \"audio\");\n        this.addInput(\"gain\", \"number\");\n\n        //init context\n        var context = LGAudio.getAudioContext();\n\n        //create gain node to control volume\n        this.audionode = context.createGain();\n        this.audionode.graphnode = this;\n        this.audionode.gain.value = this.properties.gain;\n\n        //debug\n        if (this.properties.src) {\n            this.loadSound(this.properties.src);\n        }\n    }\n\n\tLGAudioSource.desc = \"Plays an audio file\";\n    LGAudioSource[\"@src\"] = { widget: \"resource\" };\n    LGAudioSource.supported_extensions = [\"wav\", \"ogg\", \"mp3\"];\n\n    LGAudioSource.prototype.onAdded = function(graph) {\n        if (graph.status === LGraph.STATUS_RUNNING) {\n            this.onStart();\n        }\n    };\n\n    LGAudioSource.prototype.onStart = function() {\n        if (!this._audiobuffer) {\n            return;\n        }\n\n        if (this.properties.autoplay) {\n\t\t\tthis.playBuffer(this._audiobuffer);\n        }\n    };\n\n    LGAudioSource.prototype.onStop = function() {\n        this.stopAllSounds();\n    };\n\n    LGAudioSource.prototype.onPause = function() {\n        this.pauseAllSounds();\n    };\n\n    LGAudioSource.prototype.onUnpause = function() {\n        this.unpauseAllSounds();\n        //this.onStart();\n    };\n\n    LGAudioSource.prototype.onRemoved = function() {\n        this.stopAllSounds();\n        if (this._dropped_url) {\n            URL.revokeObjectURL(this._url);\n        }\n    };\n\n    LGAudioSource.prototype.stopAllSounds = function() {\n        //iterate and stop\n        for (var i = 0; i < this._audionodes.length; ++i) {\n            if (this._audionodes[i].started) {\n                this._audionodes[i].started = false;\n                this._audionodes[i].stop();\n            }\n            //this._audionodes[i].disconnect( this.audionode );\n        }\n        this._audionodes.length = 0;\n    };\n\n    LGAudioSource.prototype.pauseAllSounds = function() {\n        LGAudio.getAudioContext().suspend();\n    };\n\n    LGAudioSource.prototype.unpauseAllSounds = function() {\n        LGAudio.getAudioContext().resume();\n    };\n\n    LGAudioSource.prototype.onExecute = function() {\n        if (this.inputs) {\n            for (var i = 0; i < this.inputs.length; ++i) {\n                var input = this.inputs[i];\n                if (input.link == null) {\n                    continue;\n                }\n                var v = this.getInputData(i);\n                if (v === undefined) {\n                    continue;\n                }\n                if (input.name == \"gain\")\n                    this.audionode.gain.value = v;\n                else if (input.name == \"src\") {\n                    this.setProperty(\"src\",v);\n                } else if (input.name == \"playbackRate\") {\n                    this.properties.playbackRate = v;\n                    for (var j = 0; j < this._audionodes.length; ++j) {\n                        this._audionodes[j].playbackRate.value = v;\n                    }\n                }\n            }\n        }\n\n        if (this.outputs) {\n            for (var i = 0; i < this.outputs.length; ++i) {\n                var output = this.outputs[i];\n                if (output.name == \"buffer\" && this._audiobuffer) {\n                    this.setOutputData(i, this._audiobuffer);\n                }\n            }\n        }\n    };\n\n    LGAudioSource.prototype.onAction = function(event) {\n        if (this._audiobuffer) {\n            if (event == \"Play\") {\n                this.playBuffer(this._audiobuffer);\n            } else if (event == \"Stop\") {\n                this.stopAllSounds();\n            }\n        }\n    };\n\n    LGAudioSource.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"src\") {\n            this.loadSound(value);\n        } else if (name == \"gain\") {\n            this.audionode.gain.value = value;\n        } else if (name == \"playbackRate\") {\n            for (var j = 0; j < this._audionodes.length; ++j) {\n                this._audionodes[j].playbackRate.value = value;\n            }\n        }\n    };\n\n    LGAudioSource.prototype.playBuffer = function(buffer) {\n        var that = this;\n        var context = LGAudio.getAudioContext();\n\n        //create a new audionode (this is mandatory, AudioAPI doesnt like to reuse old ones)\n        var audionode = context.createBufferSource(); //create a AudioBufferSourceNode\n        this._last_sourcenode = audionode;\n        audionode.graphnode = this;\n        audionode.buffer = buffer;\n        audionode.loop = this.properties.loop;\n        audionode.playbackRate.value = this.properties.playbackRate;\n        this._audionodes.push(audionode);\n        audionode.connect(this.audionode); //connect to gain\n\n\t\tthis._audionodes.push(audionode);\n\n\t\tthis.trigger(\"start\");\n\n        audionode.onended = function() {\n            //console.log(\"ended!\");\n            that.trigger(\"ended\");\n            //remove\n            var index = that._audionodes.indexOf(audionode);\n            if (index != -1) {\n                that._audionodes.splice(index, 1);\n            }\n        };\n\n        if (!audionode.started) {\n            audionode.started = true;\n            audionode.start();\n        }\n        return audionode;\n    };\n\n    LGAudioSource.prototype.loadSound = function(url) {\n        var that = this;\n\n        //kill previous load\n        if (this._request) {\n            this._request.abort();\n            this._request = null;\n        }\n\n        this._audiobuffer = null; //points to the audiobuffer once the audio is loaded\n        this._loading_audio = false;\n\n        if (!url) {\n            return;\n        }\n\n        this._request = LGAudio.loadSound(url, inner);\n\n        this._loading_audio = true;\n        this.boxcolor = \"#AA4\";\n\n        function inner(buffer) {\n            this.boxcolor = LiteGraph.NODE_DEFAULT_BOXCOLOR;\n            that._audiobuffer = buffer;\n            that._loading_audio = false;\n            //if is playing, then play it\n            if (that.graph && that.graph.status === LGraph.STATUS_RUNNING) {\n                that.onStart();\n            } //this controls the autoplay already\n        }\n    };\n\n    //Helps connect/disconnect AudioNodes when new connections are made in the node\n    LGAudioSource.prototype.onConnectionsChange = LGAudio.onConnectionsChange;\n\n    LGAudioSource.prototype.onGetInputs = function() {\n        return [\n            [\"playbackRate\", \"number\"],\n\t\t\t[\"src\",\"string\"],\n            [\"Play\", LiteGraph.ACTION],\n            [\"Stop\", LiteGraph.ACTION]\n        ];\n    };\n\n    LGAudioSource.prototype.onGetOutputs = function() {\n        return [[\"buffer\", \"audiobuffer\"], [\"start\", LiteGraph.EVENT], [\"ended\", LiteGraph.EVENT]];\n    };\n\n    LGAudioSource.prototype.onDropFile = function(file) {\n        if (this._dropped_url) {\n            URL.revokeObjectURL(this._dropped_url);\n        }\n        var url = URL.createObjectURL(file);\n        this.properties.src = url;\n        this.loadSound(url);\n        this._dropped_url = url;\n    };\n\n    LGAudioSource.title = \"Source\";\n    LGAudioSource.desc = \"Plays audio\";\n    LiteGraph.registerNodeType(\"audio/source\", LGAudioSource);\n\n    //****************************************************\n\n    function LGAudioMediaSource() {\n        this.properties = {\n            gain: 0.5\n        };\n\n        this._audionodes = [];\n        this._media_stream = null;\n\n        this.addOutput(\"out\", \"audio\");\n        this.addInput(\"gain\", \"number\");\n\n        //create gain node to control volume\n        var context = LGAudio.getAudioContext();\n        this.audionode = context.createGain();\n        this.audionode.graphnode = this;\n        this.audionode.gain.value = this.properties.gain;\n    }\n\n    LGAudioMediaSource.prototype.onAdded = function(graph) {\n        if (graph.status === LGraph.STATUS_RUNNING) {\n            this.onStart();\n        }\n    };\n\n    LGAudioMediaSource.prototype.onStart = function() {\n        if (this._media_stream == null && !this._waiting_confirmation) {\n            this.openStream();\n        }\n    };\n\n    LGAudioMediaSource.prototype.onStop = function() {\n        this.audionode.gain.value = 0;\n    };\n\n    LGAudioMediaSource.prototype.onPause = function() {\n        this.audionode.gain.value = 0;\n    };\n\n    LGAudioMediaSource.prototype.onUnpause = function() {\n        this.audionode.gain.value = this.properties.gain;\n    };\n\n    LGAudioMediaSource.prototype.onRemoved = function() {\n        this.audionode.gain.value = 0;\n        if (this.audiosource_node) {\n            this.audiosource_node.disconnect(this.audionode);\n            this.audiosource_node = null;\n        }\n        if (this._media_stream) {\n            var tracks = this._media_stream.getTracks();\n            if (tracks.length) {\n                tracks[0].stop();\n            }\n        }\n    };\n\n    LGAudioMediaSource.prototype.openStream = function() {\n        if (!navigator.mediaDevices) {\n            console.log(\n                \"getUserMedia() is not supported in your browser, use chrome and enable WebRTC from about://flags\"\n            );\n            return;\n        }\n\n        this._waiting_confirmation = true;\n\n        // Not showing vendor prefixes.\n        navigator.mediaDevices\n            .getUserMedia({ audio: true, video: false })\n            .then(this.streamReady.bind(this))\n            .catch(onFailSoHard);\n\n        var that = this;\n        function onFailSoHard(err) {\n            console.log(\"Media rejected\", err);\n            that._media_stream = false;\n            that.boxcolor = \"red\";\n        }\n    };\n\n    LGAudioMediaSource.prototype.streamReady = function(localMediaStream) {\n        this._media_stream = localMediaStream;\n        //this._waiting_confirmation = false;\n\n        //init context\n        if (this.audiosource_node) {\n            this.audiosource_node.disconnect(this.audionode);\n        }\n        var context = LGAudio.getAudioContext();\n        this.audiosource_node = context.createMediaStreamSource(\n            localMediaStream\n        );\n        this.audiosource_node.graphnode = this;\n        this.audiosource_node.connect(this.audionode);\n        this.boxcolor = \"white\";\n    };\n\n    LGAudioMediaSource.prototype.onExecute = function() {\n        if (this._media_stream == null && !this._waiting_confirmation) {\n            this.openStream();\n        }\n\n        if (this.inputs) {\n            for (var i = 0; i < this.inputs.length; ++i) {\n                var input = this.inputs[i];\n                if (input.link == null) {\n                    continue;\n                }\n                var v = this.getInputData(i);\n                if (v === undefined) {\n                    continue;\n                }\n                if (input.name == \"gain\") {\n                    this.audionode.gain.value = this.properties.gain = v;\n                }\n            }\n        }\n    };\n\n    LGAudioMediaSource.prototype.onAction = function(event) {\n        if (event == \"Play\") {\n            this.audionode.gain.value = this.properties.gain;\n        } else if (event == \"Stop\") {\n            this.audionode.gain.value = 0;\n        }\n    };\n\n    LGAudioMediaSource.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"gain\") {\n            this.audionode.gain.value = value;\n        }\n    };\n\n    //Helps connect/disconnect AudioNodes when new connections are made in the node\n    LGAudioMediaSource.prototype.onConnectionsChange =\n        LGAudio.onConnectionsChange;\n\n    LGAudioMediaSource.prototype.onGetInputs = function() {\n        return [\n            [\"playbackRate\", \"number\"],\n            [\"Play\", LiteGraph.ACTION],\n            [\"Stop\", LiteGraph.ACTION]\n        ];\n    };\n\n    LGAudioMediaSource.title = \"MediaSource\";\n    LGAudioMediaSource.desc = \"Plays microphone\";\n    LiteGraph.registerNodeType(\"audio/media_source\", LGAudioMediaSource);\n\n    //*****************************************************\n\n    function LGAudioAnalyser() {\n        this.properties = {\n            fftSize: 2048,\n            minDecibels: -100,\n            maxDecibels: -10,\n            smoothingTimeConstant: 0.5\n        };\n\n        var context = LGAudio.getAudioContext();\n\n        this.audionode = context.createAnalyser();\n        this.audionode.graphnode = this;\n        this.audionode.fftSize = this.properties.fftSize;\n        this.audionode.minDecibels = this.properties.minDecibels;\n        this.audionode.maxDecibels = this.properties.maxDecibels;\n        this.audionode.smoothingTimeConstant = this.properties.smoothingTimeConstant;\n\n        this.addInput(\"in\", \"audio\");\n        this.addOutput(\"freqs\", \"array\");\n        this.addOutput(\"samples\", \"array\");\n\n        this._freq_bin = null;\n        this._time_bin = null;\n    }\n\n    LGAudioAnalyser.prototype.onPropertyChanged = function(name, value) {\n        this.audionode[name] = value;\n    };\n\n    LGAudioAnalyser.prototype.onExecute = function() {\n        if (this.isOutputConnected(0)) {\n            //send FFT\n            var bufferLength = this.audionode.frequencyBinCount;\n            if (!this._freq_bin || this._freq_bin.length != bufferLength) {\n                this._freq_bin = new Uint8Array(bufferLength);\n            }\n            this.audionode.getByteFrequencyData(this._freq_bin);\n            this.setOutputData(0, this._freq_bin);\n        }\n\n        //send analyzer\n        if (this.isOutputConnected(1)) {\n            //send Samples\n            var bufferLength = this.audionode.frequencyBinCount;\n            if (!this._time_bin || this._time_bin.length != bufferLength) {\n                this._time_bin = new Uint8Array(bufferLength);\n            }\n            this.audionode.getByteTimeDomainData(this._time_bin);\n            this.setOutputData(1, this._time_bin);\n        }\n\n        //properties\n        for (var i = 1; i < this.inputs.length; ++i) {\n            var input = this.inputs[i];\n            if (input.link == null) {\n                continue;\n            }\n            var v = this.getInputData(i);\n            if (v !== undefined) {\n                this.audionode[input.name].value = v;\n            }\n        }\n\n        //time domain\n        //this.audionode.getFloatTimeDomainData( dataArray );\n    };\n\n    LGAudioAnalyser.prototype.onGetInputs = function() {\n        return [\n            [\"minDecibels\", \"number\"],\n            [\"maxDecibels\", \"number\"],\n            [\"smoothingTimeConstant\", \"number\"]\n        ];\n    };\n\n    LGAudioAnalyser.prototype.onGetOutputs = function() {\n        return [[\"freqs\", \"array\"], [\"samples\", \"array\"]];\n    };\n\n    LGAudioAnalyser.title = \"Analyser\";\n    LGAudioAnalyser.desc = \"Audio Analyser\";\n    LiteGraph.registerNodeType(\"audio/analyser\", LGAudioAnalyser);\n\n    //*****************************************************\n\n    function LGAudioGain() {\n        //default\n        this.properties = {\n            gain: 1\n        };\n\n        this.audionode = LGAudio.getAudioContext().createGain();\n        this.addInput(\"in\", \"audio\");\n        this.addInput(\"gain\", \"number\");\n        this.addOutput(\"out\", \"audio\");\n    }\n\n    LGAudioGain.prototype.onExecute = function() {\n        if (!this.inputs || !this.inputs.length) {\n            return;\n        }\n\n        for (var i = 1; i < this.inputs.length; ++i) {\n            var input = this.inputs[i];\n            var v = this.getInputData(i);\n            if (v !== undefined) {\n                this.audionode[input.name].value = v;\n            }\n        }\n    };\n\n    LGAudio.createAudioNodeWrapper(LGAudioGain);\n\n    LGAudioGain.title = \"Gain\";\n    LGAudioGain.desc = \"Audio gain\";\n    LiteGraph.registerNodeType(\"audio/gain\", LGAudioGain);\n\n    function LGAudioConvolver() {\n        //default\n        this.properties = {\n            impulse_src: \"\",\n            normalize: true\n        };\n\n        this.audionode = LGAudio.getAudioContext().createConvolver();\n        this.addInput(\"in\", \"audio\");\n        this.addOutput(\"out\", \"audio\");\n    }\n\n    LGAudio.createAudioNodeWrapper(LGAudioConvolver);\n\n    LGAudioConvolver.prototype.onRemove = function() {\n        if (this._dropped_url) {\n            URL.revokeObjectURL(this._dropped_url);\n        }\n    };\n\n    LGAudioConvolver.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"impulse_src\") {\n            this.loadImpulse(value);\n        } else if (name == \"normalize\") {\n            this.audionode.normalize = value;\n        }\n    };\n\n    LGAudioConvolver.prototype.onDropFile = function(file) {\n        if (this._dropped_url) {\n            URL.revokeObjectURL(this._dropped_url);\n        }\n        this._dropped_url = URL.createObjectURL(file);\n        this.properties.impulse_src = this._dropped_url;\n        this.loadImpulse(this._dropped_url);\n    };\n\n    LGAudioConvolver.prototype.loadImpulse = function(url) {\n        var that = this;\n\n        //kill previous load\n        if (this._request) {\n            this._request.abort();\n            this._request = null;\n        }\n\n        this._impulse_buffer = null;\n        this._loading_impulse = false;\n\n        if (!url) {\n            return;\n        }\n\n        //load new sample\n        this._request = LGAudio.loadSound(url, inner);\n        this._loading_impulse = true;\n\n        // Decode asynchronously\n        function inner(buffer) {\n            that._impulse_buffer = buffer;\n            that.audionode.buffer = buffer;\n            console.log(\"Impulse signal set\");\n            that._loading_impulse = false;\n        }\n    };\n\n    LGAudioConvolver.title = \"Convolver\";\n    LGAudioConvolver.desc = \"Convolves the signal (used for reverb)\";\n    LiteGraph.registerNodeType(\"audio/convolver\", LGAudioConvolver);\n\n    function LGAudioDynamicsCompressor() {\n        //default\n        this.properties = {\n            threshold: -50,\n            knee: 40,\n            ratio: 12,\n            reduction: -20,\n            attack: 0,\n            release: 0.25\n        };\n\n        this.audionode = LGAudio.getAudioContext().createDynamicsCompressor();\n        this.addInput(\"in\", \"audio\");\n        this.addOutput(\"out\", \"audio\");\n    }\n\n    LGAudio.createAudioNodeWrapper(LGAudioDynamicsCompressor);\n\n    LGAudioDynamicsCompressor.prototype.onExecute = function() {\n        if (!this.inputs || !this.inputs.length) {\n            return;\n        }\n        for (var i = 1; i < this.inputs.length; ++i) {\n            var input = this.inputs[i];\n            if (input.link == null) {\n                continue;\n            }\n            var v = this.getInputData(i);\n            if (v !== undefined) {\n                this.audionode[input.name].value = v;\n            }\n        }\n    };\n\n    LGAudioDynamicsCompressor.prototype.onGetInputs = function() {\n        return [\n            [\"threshold\", \"number\"],\n            [\"knee\", \"number\"],\n            [\"ratio\", \"number\"],\n            [\"reduction\", \"number\"],\n            [\"attack\", \"number\"],\n            [\"release\", \"number\"]\n        ];\n    };\n\n    LGAudioDynamicsCompressor.title = \"DynamicsCompressor\";\n    LGAudioDynamicsCompressor.desc = \"Dynamics Compressor\";\n    LiteGraph.registerNodeType(\n        \"audio/dynamicsCompressor\",\n        LGAudioDynamicsCompressor\n    );\n\n    function LGAudioWaveShaper() {\n        //default\n        this.properties = {};\n\n        this.audionode = LGAudio.getAudioContext().createWaveShaper();\n        this.addInput(\"in\", \"audio\");\n        this.addInput(\"shape\", \"waveshape\");\n        this.addOutput(\"out\", \"audio\");\n    }\n\n    LGAudioWaveShaper.prototype.onExecute = function() {\n        if (!this.inputs || !this.inputs.length) {\n            return;\n        }\n        var v = this.getInputData(1);\n        if (v === undefined) {\n            return;\n        }\n        this.audionode.curve = v;\n    };\n\n    LGAudioWaveShaper.prototype.setWaveShape = function(shape) {\n        this.audionode.curve = shape;\n    };\n\n    LGAudio.createAudioNodeWrapper(LGAudioWaveShaper);\n\n    /* disabled till I dont find a way to do a wave shape\nLGAudioWaveShaper.title = \"WaveShaper\";\nLGAudioWaveShaper.desc = \"Distortion using wave shape\";\nLiteGraph.registerNodeType(\"audio/waveShaper\", LGAudioWaveShaper);\n*/\n\n    function LGAudioMixer() {\n        //default\n        this.properties = {\n            gain1: 0.5,\n            gain2: 0.5\n        };\n\n        this.audionode = LGAudio.getAudioContext().createGain();\n\n        this.audionode1 = LGAudio.getAudioContext().createGain();\n        this.audionode1.gain.value = this.properties.gain1;\n        this.audionode2 = LGAudio.getAudioContext().createGain();\n        this.audionode2.gain.value = this.properties.gain2;\n\n        this.audionode1.connect(this.audionode);\n        this.audionode2.connect(this.audionode);\n\n        this.addInput(\"in1\", \"audio\");\n        this.addInput(\"in1 gain\", \"number\");\n        this.addInput(\"in2\", \"audio\");\n        this.addInput(\"in2 gain\", \"number\");\n\n        this.addOutput(\"out\", \"audio\");\n    }\n\n    LGAudioMixer.prototype.getAudioNodeInInputSlot = function(slot) {\n        if (slot == 0) {\n            return this.audionode1;\n        } else if (slot == 2) {\n            return this.audionode2;\n        }\n    };\n\n    LGAudioMixer.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"gain1\") {\n            this.audionode1.gain.value = value;\n        } else if (name == \"gain2\") {\n            this.audionode2.gain.value = value;\n        }\n    };\n\n    LGAudioMixer.prototype.onExecute = function() {\n        if (!this.inputs || !this.inputs.length) {\n            return;\n        }\n\n        for (var i = 1; i < this.inputs.length; ++i) {\n            var input = this.inputs[i];\n\n            if (input.link == null || input.type == \"audio\") {\n                continue;\n            }\n\n            var v = this.getInputData(i);\n            if (v === undefined) {\n                continue;\n            }\n\n            if (i == 1) {\n                this.audionode1.gain.value = v;\n            } else if (i == 3) {\n                this.audionode2.gain.value = v;\n            }\n        }\n    };\n\n    LGAudio.createAudioNodeWrapper(LGAudioMixer);\n\n    LGAudioMixer.title = \"Mixer\";\n    LGAudioMixer.desc = \"Audio mixer\";\n    LiteGraph.registerNodeType(\"audio/mixer\", LGAudioMixer);\n\n    function LGAudioADSR() {\n        //default\n        this.properties = {\n            A: 0.1,\n            D: 0.1,\n            S: 0.1,\n            R: 0.1\n        };\n\n        this.audionode = LGAudio.getAudioContext().createGain();\n        this.audionode.gain.value = 0;\n        this.addInput(\"in\", \"audio\");\n        this.addInput(\"gate\", \"boolean\");\n        this.addOutput(\"out\", \"audio\");\n        this.gate = false;\n    }\n\n    LGAudioADSR.prototype.onExecute = function() {\n        var audioContext = LGAudio.getAudioContext();\n        var now = audioContext.currentTime;\n        var node = this.audionode;\n        var gain = node.gain;\n        var current_gate = this.getInputData(1);\n\n        var A = this.getInputOrProperty(\"A\");\n        var D = this.getInputOrProperty(\"D\");\n        var S = this.getInputOrProperty(\"S\");\n        var R = this.getInputOrProperty(\"R\");\n\n        if (!this.gate && current_gate) {\n            gain.cancelScheduledValues(0);\n            gain.setValueAtTime(0, now);\n            gain.linearRampToValueAtTime(1, now + A);\n            gain.linearRampToValueAtTime(S, now + A + D);\n        } else if (this.gate && !current_gate) {\n            gain.cancelScheduledValues(0);\n            gain.setValueAtTime(gain.value, now);\n            gain.linearRampToValueAtTime(0, now + R);\n        }\n\n        this.gate = current_gate;\n    };\n\n    LGAudioADSR.prototype.onGetInputs = function() {\n        return [\n            [\"A\", \"number\"],\n            [\"D\", \"number\"],\n            [\"S\", \"number\"],\n            [\"R\", \"number\"]\n        ];\n    };\n\n    LGAudio.createAudioNodeWrapper(LGAudioADSR);\n\n    LGAudioADSR.title = \"ADSR\";\n    LGAudioADSR.desc = \"Audio envelope\";\n    LiteGraph.registerNodeType(\"audio/adsr\", LGAudioADSR);\n\n    function LGAudioDelay() {\n        //default\n        this.properties = {\n            delayTime: 0.5\n        };\n\n        this.audionode = LGAudio.getAudioContext().createDelay(10);\n        this.audionode.delayTime.value = this.properties.delayTime;\n        this.addInput(\"in\", \"audio\");\n        this.addInput(\"time\", \"number\");\n        this.addOutput(\"out\", \"audio\");\n    }\n\n    LGAudio.createAudioNodeWrapper(LGAudioDelay);\n\n    LGAudioDelay.prototype.onExecute = function() {\n        var v = this.getInputData(1);\n        if (v !== undefined) {\n            this.audionode.delayTime.value = v;\n        }\n    };\n\n    LGAudioDelay.title = \"Delay\";\n    LGAudioDelay.desc = \"Audio delay\";\n    LiteGraph.registerNodeType(\"audio/delay\", LGAudioDelay);\n\n    function LGAudioBiquadFilter() {\n        //default\n        this.properties = {\n            frequency: 350,\n            detune: 0,\n            Q: 1\n        };\n        this.addProperty(\"type\", \"lowpass\", \"enum\", {\n            values: [\n                \"lowpass\",\n                \"highpass\",\n                \"bandpass\",\n                \"lowshelf\",\n                \"highshelf\",\n                \"peaking\",\n                \"notch\",\n                \"allpass\"\n            ]\n        });\n\n        //create node\n        this.audionode = LGAudio.getAudioContext().createBiquadFilter();\n\n        //slots\n        this.addInput(\"in\", \"audio\");\n        this.addOutput(\"out\", \"audio\");\n    }\n\n    LGAudioBiquadFilter.prototype.onExecute = function() {\n        if (!this.inputs || !this.inputs.length) {\n            return;\n        }\n\n        for (var i = 1; i < this.inputs.length; ++i) {\n            var input = this.inputs[i];\n            if (input.link == null) {\n                continue;\n            }\n            var v = this.getInputData(i);\n            if (v !== undefined) {\n                this.audionode[input.name].value = v;\n            }\n        }\n    };\n\n    LGAudioBiquadFilter.prototype.onGetInputs = function() {\n        return [[\"frequency\", \"number\"], [\"detune\", \"number\"], [\"Q\", \"number\"]];\n    };\n\n    LGAudio.createAudioNodeWrapper(LGAudioBiquadFilter);\n\n    LGAudioBiquadFilter.title = \"BiquadFilter\";\n    LGAudioBiquadFilter.desc = \"Audio filter\";\n    LiteGraph.registerNodeType(\"audio/biquadfilter\", LGAudioBiquadFilter);\n\n    function LGAudioOscillatorNode() {\n        //default\n        this.properties = {\n            frequency: 440,\n            detune: 0,\n            type: \"sine\"\n        };\n        this.addProperty(\"type\", \"sine\", \"enum\", {\n            values: [\"sine\", \"square\", \"sawtooth\", \"triangle\", \"custom\"]\n        });\n\n        //create node\n        this.audionode = LGAudio.getAudioContext().createOscillator();\n\n        //slots\n        this.addOutput(\"out\", \"audio\");\n    }\n\n    LGAudioOscillatorNode.prototype.onStart = function() {\n        if (!this.audionode.started) {\n            this.audionode.started = true;\n            try {\n                this.audionode.start();\n            } catch (err) {}\n        }\n    };\n\n    LGAudioOscillatorNode.prototype.onStop = function() {\n        if (this.audionode.started) {\n            this.audionode.started = false;\n            this.audionode.stop();\n        }\n    };\n\n    LGAudioOscillatorNode.prototype.onPause = function() {\n        this.onStop();\n    };\n\n    LGAudioOscillatorNode.prototype.onUnpause = function() {\n        this.onStart();\n    };\n\n    LGAudioOscillatorNode.prototype.onExecute = function() {\n        if (!this.inputs || !this.inputs.length) {\n            return;\n        }\n\n        for (var i = 0; i < this.inputs.length; ++i) {\n            var input = this.inputs[i];\n            if (input.link == null) {\n                continue;\n            }\n            var v = this.getInputData(i);\n            if (v !== undefined) {\n                this.audionode[input.name].value = v;\n            }\n        }\n    };\n\n    LGAudioOscillatorNode.prototype.onGetInputs = function() {\n        return [\n            [\"frequency\", \"number\"],\n            [\"detune\", \"number\"],\n            [\"type\", \"string\"]\n        ];\n    };\n\n    LGAudio.createAudioNodeWrapper(LGAudioOscillatorNode);\n\n    LGAudioOscillatorNode.title = \"Oscillator\";\n    LGAudioOscillatorNode.desc = \"Oscillator\";\n    LiteGraph.registerNodeType(\"audio/oscillator\", LGAudioOscillatorNode);\n\n    //*****************************************************\n\n    //EXTRA\n\n    function LGAudioVisualization() {\n        this.properties = {\n            continuous: true,\n            mark: -1\n        };\n\n        this.addInput(\"data\", \"array\");\n        this.addInput(\"mark\", \"number\");\n        this.size = [300, 200];\n        this._last_buffer = null;\n    }\n\n    LGAudioVisualization.prototype.onExecute = function() {\n        this._last_buffer = this.getInputData(0);\n        var v = this.getInputData(1);\n        if (v !== undefined) {\n            this.properties.mark = v;\n        }\n        this.setDirtyCanvas(true, false);\n    };\n\n    LGAudioVisualization.prototype.onDrawForeground = function(ctx) {\n        if (!this._last_buffer) {\n            return;\n        }\n\n        var buffer = this._last_buffer;\n\n        //delta represents how many samples we advance per pixel\n        var delta = buffer.length / this.size[0];\n        var h = this.size[1];\n\n        ctx.fillStyle = \"black\";\n        ctx.fillRect(0, 0, this.size[0], this.size[1]);\n        ctx.strokeStyle = \"white\";\n        ctx.beginPath();\n        var x = 0;\n\n        if (this.properties.continuous) {\n            ctx.moveTo(x, h);\n            for (var i = 0; i < buffer.length; i += delta) {\n                ctx.lineTo(x, h - (buffer[i | 0] / 255) * h);\n                x++;\n            }\n        } else {\n            for (var i = 0; i < buffer.length; i += delta) {\n                ctx.moveTo(x + 0.5, h);\n                ctx.lineTo(x + 0.5, h - (buffer[i | 0] / 255) * h);\n                x++;\n            }\n        }\n        ctx.stroke();\n\n        if (this.properties.mark >= 0) {\n            var samplerate = LGAudio.getAudioContext().sampleRate;\n            var binfreq = samplerate / buffer.length;\n            var x = (2 * (this.properties.mark / binfreq)) / delta;\n            if (x >= this.size[0]) {\n                x = this.size[0] - 1;\n            }\n            ctx.strokeStyle = \"red\";\n            ctx.beginPath();\n            ctx.moveTo(x, h);\n            ctx.lineTo(x, 0);\n            ctx.stroke();\n        }\n    };\n\n    LGAudioVisualization.title = \"Visualization\";\n    LGAudioVisualization.desc = \"Audio Visualization\";\n    LiteGraph.registerNodeType(\"audio/visualization\", LGAudioVisualization);\n\n    function LGAudioBandSignal() {\n        //default\n        this.properties = {\n            band: 440,\n            amplitude: 1\n        };\n\n        this.addInput(\"freqs\", \"array\");\n        this.addOutput(\"signal\", \"number\");\n    }\n\n    LGAudioBandSignal.prototype.onExecute = function() {\n        this._freqs = this.getInputData(0);\n        if (!this._freqs) {\n            return;\n        }\n\n        var band = this.properties.band;\n        var v = this.getInputData(1);\n        if (v !== undefined) {\n            band = v;\n        }\n\n        var samplerate = LGAudio.getAudioContext().sampleRate;\n        var binfreq = samplerate / this._freqs.length;\n        var index = 2 * (band / binfreq);\n        var v = 0;\n        if (index < 0) {\n            v = this._freqs[0];\n        }\n        if (index >= this._freqs.length) {\n            v = this._freqs[this._freqs.length - 1];\n        } else {\n            var pos = index | 0;\n            var v0 = this._freqs[pos];\n            var v1 = this._freqs[pos + 1];\n            var f = index - pos;\n            v = v0 * (1 - f) + v1 * f;\n        }\n\n        this.setOutputData(0, (v / 255) * this.properties.amplitude);\n    };\n\n    LGAudioBandSignal.prototype.onGetInputs = function() {\n        return [[\"band\", \"number\"]];\n    };\n\n    LGAudioBandSignal.title = \"Signal\";\n    LGAudioBandSignal.desc = \"extract the signal of some frequency\";\n    LiteGraph.registerNodeType(\"audio/signal\", LGAudioBandSignal);\n\n    function LGAudioScript() {\n        if (!LGAudioScript.default_code) {\n            var code = LGAudioScript.default_function.toString();\n            var index = code.indexOf(\"{\") + 1;\n            var index2 = code.lastIndexOf(\"}\");\n            LGAudioScript.default_code = code.substr(index, index2 - index);\n        }\n\n        //default\n        this.properties = {\n            code: LGAudioScript.default_code\n        };\n\n        //create node\n        var ctx = LGAudio.getAudioContext();\n        if (ctx.createScriptProcessor) {\n            this.audionode = ctx.createScriptProcessor(4096, 1, 1);\n        }\n        //buffer size, input channels, output channels\n        else {\n            console.warn(\"ScriptProcessorNode deprecated\");\n            this.audionode = ctx.createGain(); //bypass audio\n        }\n\n        this.processCode();\n        if (!LGAudioScript._bypass_function) {\n            LGAudioScript._bypass_function = this.audionode.onaudioprocess;\n        }\n\n        //slots\n        this.addInput(\"in\", \"audio\");\n        this.addOutput(\"out\", \"audio\");\n    }\n\n    LGAudioScript.prototype.onAdded = function(graph) {\n        if (graph.status == LGraph.STATUS_RUNNING) {\n            this.audionode.onaudioprocess = this._callback;\n        }\n    };\n\n    LGAudioScript[\"@code\"] = { widget: \"code\", type: \"code\" };\n\n    LGAudioScript.prototype.onStart = function() {\n        this.audionode.onaudioprocess = this._callback;\n    };\n\n    LGAudioScript.prototype.onStop = function() {\n        this.audionode.onaudioprocess = LGAudioScript._bypass_function;\n    };\n\n    LGAudioScript.prototype.onPause = function() {\n        this.audionode.onaudioprocess = LGAudioScript._bypass_function;\n    };\n\n    LGAudioScript.prototype.onUnpause = function() {\n        this.audionode.onaudioprocess = this._callback;\n    };\n\n    LGAudioScript.prototype.onExecute = function() {\n        //nothing! because we need an onExecute to receive onStart... fix that\n    };\n\n    LGAudioScript.prototype.onRemoved = function() {\n        this.audionode.onaudioprocess = LGAudioScript._bypass_function;\n    };\n\n    LGAudioScript.prototype.processCode = function() {\n        try {\n            var func = new Function(\"properties\", this.properties.code);\n            this._script = new func(this.properties);\n            this._old_code = this.properties.code;\n            this._callback = this._script.onaudioprocess;\n        } catch (err) {\n            console.error(\"Error in onaudioprocess code\", err);\n            this._callback = LGAudioScript._bypass_function;\n            this.audionode.onaudioprocess = this._callback;\n        }\n    };\n\n    LGAudioScript.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"code\") {\n            this.properties.code = value;\n            this.processCode();\n            if (this.graph && this.graph.status == LGraph.STATUS_RUNNING) {\n                this.audionode.onaudioprocess = this._callback;\n            }\n        }\n    };\n\n    LGAudioScript.default_function = function() {\n        this.onaudioprocess = function(audioProcessingEvent) {\n            // The input buffer is the song we loaded earlier\n            var inputBuffer = audioProcessingEvent.inputBuffer;\n\n            // The output buffer contains the samples that will be modified and played\n            var outputBuffer = audioProcessingEvent.outputBuffer;\n\n            // Loop through the output channels (in this case there is only one)\n            for (\n                var channel = 0;\n                channel < outputBuffer.numberOfChannels;\n                channel++\n            ) {\n                var inputData = inputBuffer.getChannelData(channel);\n                var outputData = outputBuffer.getChannelData(channel);\n\n                // Loop through the 4096 samples\n                for (var sample = 0; sample < inputBuffer.length; sample++) {\n                    // make output equal to the same as the input\n                    outputData[sample] = inputData[sample];\n                }\n            }\n        };\n    };\n\n    LGAudio.createAudioNodeWrapper(LGAudioScript);\n\n    LGAudioScript.title = \"Script\";\n    LGAudioScript.desc = \"apply script to signal\";\n    LiteGraph.registerNodeType(\"audio/script\", LGAudioScript);\n\n    function LGAudioDestination() {\n        this.audionode = LGAudio.getAudioContext().destination;\n        this.addInput(\"in\", \"audio\");\n    }\n\n    LGAudioDestination.title = \"Destination\";\n    LGAudioDestination.desc = \"Audio output\";\n    LiteGraph.registerNodeType(\"audio/destination\", LGAudioDestination);\n})(this);\n\n//event related nodes\n(function(global) {\n    var LiteGraph = global.LiteGraph;\n\n    function LGWebSocket() {\n        this.size = [60, 20];\n        this.addInput(\"send\", LiteGraph.ACTION);\n        this.addOutput(\"received\", LiteGraph.EVENT);\n        this.addInput(\"in\", 0);\n        this.addOutput(\"out\", 0);\n        this.properties = {\n            url: \"\",\n            room: \"lgraph\", //allows to filter messages,\n            only_send_changes: true\n        };\n        this._ws = null;\n        this._last_sent_data = [];\n        this._last_received_data = [];\n    }\n\n    LGWebSocket.title = \"WebSocket\";\n    LGWebSocket.desc = \"Send data through a websocket\";\n\n    LGWebSocket.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"url\") {\n            this.connectSocket();\n        }\n    };\n\n    LGWebSocket.prototype.onExecute = function() {\n        if (!this._ws && this.properties.url) {\n            this.connectSocket();\n        }\n\n        if (!this._ws || this._ws.readyState != WebSocket.OPEN) {\n            return;\n        }\n\n        var room = this.properties.room;\n        var only_changes = this.properties.only_send_changes;\n\n        for (var i = 1; i < this.inputs.length; ++i) {\n            var data = this.getInputData(i);\n            if (data == null) {\n                continue;\n            }\n            var json;\n            try {\n                json = JSON.stringify({\n                    type: 0,\n                    room: room,\n                    channel: i,\n                    data: data\n                });\n            } catch (err) {\n                continue;\n            }\n            if (only_changes && this._last_sent_data[i] == json) {\n                continue;\n            }\n\n            this._last_sent_data[i] = json;\n            this._ws.send(json);\n        }\n\n        for (var i = 1; i < this.outputs.length; ++i) {\n            this.setOutputData(i, this._last_received_data[i]);\n        }\n\n        if (this.boxcolor == \"#AFA\") {\n            this.boxcolor = \"#6C6\";\n        }\n    };\n\n    LGWebSocket.prototype.connectSocket = function() {\n        var that = this;\n        var url = this.properties.url;\n        if (url.substr(0, 2) != \"ws\") {\n            url = \"ws://\" + url;\n        }\n        this._ws = new WebSocket(url);\n        this._ws.onopen = function() {\n            console.log(\"ready\");\n            that.boxcolor = \"#6C6\";\n        };\n        this._ws.onmessage = function(e) {\n            that.boxcolor = \"#AFA\";\n            var data = JSON.parse(e.data);\n            if (data.room && data.room != that.properties.room) {\n                return;\n            }\n            if (data.type == 1) {\n                if (\n                    data.data.object_class &&\n                    LiteGraph[data.data.object_class]\n                ) {\n                    var obj = null;\n                    try {\n                        obj = new LiteGraph[data.data.object_class](data.data);\n                        that.triggerSlot(0, obj);\n                    } catch (err) {\n                        return;\n                    }\n                } else {\n                    that.triggerSlot(0, data.data);\n                }\n            } else {\n                that._last_received_data[data.channel || 0] = data.data;\n            }\n        };\n        this._ws.onerror = function(e) {\n            console.log(\"couldnt connect to websocket\");\n            that.boxcolor = \"#E88\";\n        };\n        this._ws.onclose = function(e) {\n            console.log(\"connection closed\");\n            that.boxcolor = \"#000\";\n        };\n    };\n\n    LGWebSocket.prototype.send = function(data) {\n        if (!this._ws || this._ws.readyState != WebSocket.OPEN) {\n            return;\n        }\n        this._ws.send(JSON.stringify({ type: 1, msg: data }));\n    };\n\n    LGWebSocket.prototype.onAction = function(action, param) {\n        if (!this._ws || this._ws.readyState != WebSocket.OPEN) {\n            return;\n        }\n        this._ws.send({\n            type: 1,\n            room: this.properties.room,\n            action: action,\n            data: param\n        });\n    };\n\n    LGWebSocket.prototype.onGetInputs = function() {\n        return [[\"in\", 0]];\n    };\n\n    LGWebSocket.prototype.onGetOutputs = function() {\n        return [[\"out\", 0]];\n    };\n\n    LiteGraph.registerNodeType(\"network/websocket\", LGWebSocket);\n\n    //It is like a websocket but using the SillyServer.js server that bounces packets back to all clients connected:\n    //For more information: https://github.com/jagenjo/SillyServer.js\n\n    function LGSillyClient() {\n        //this.size = [60,20];\n        this.room_widget = this.addWidget(\n            \"text\",\n            \"Room\",\n            \"lgraph\",\n            this.setRoom.bind(this)\n        );\n        this.addWidget(\n            \"button\",\n            \"Reconnect\",\n            null,\n            this.connectSocket.bind(this)\n        );\n\n        this.addInput(\"send\", LiteGraph.ACTION);\n        this.addOutput(\"received\", LiteGraph.EVENT);\n        this.addInput(\"in\", 0);\n        this.addOutput(\"out\", 0);\n        this.properties = {\n            url: \"tamats.com:55000\",\n            room: \"lgraph\",\n            only_send_changes: true\n        };\n\n        this._server = null;\n        this.connectSocket();\n        this._last_sent_data = [];\n        this._last_received_data = [];\n\n\t\tif(typeof(SillyClient) == \"undefined\")\n\t\t\tconsole.warn(\"remember to add SillyClient.js to your project: https://tamats.com/projects/sillyserver/src/sillyclient.js\");\n    }\n\n    LGSillyClient.title = \"SillyClient\";\n    LGSillyClient.desc = \"Connects to SillyServer to broadcast messages\";\n\n    LGSillyClient.prototype.onPropertyChanged = function(name, value) {\n        if (name == \"room\") {\n            this.room_widget.value = value;\n        }\n        this.connectSocket();\n    };\n\n    LGSillyClient.prototype.setRoom = function(room_name) {\n        this.properties.room = room_name;\n        this.room_widget.value = room_name;\n        this.connectSocket();\n    };\n\n    //force label names\n    LGSillyClient.prototype.onDrawForeground = function() {\n        for (var i = 1; i < this.inputs.length; ++i) {\n            var slot = this.inputs[i];\n            slot.label = \"in_\" + i;\n        }\n        for (var i = 1; i < this.outputs.length; ++i) {\n            var slot = this.outputs[i];\n            slot.label = \"out_\" + i;\n        }\n    };\n\n    LGSillyClient.prototype.onExecute = function() {\n        if (!this._server || !this._server.is_connected) {\n            return;\n        }\n\n        var only_send_changes = this.properties.only_send_changes;\n\n        for (var i = 1; i < this.inputs.length; ++i) {\n            var data = this.getInputData(i);\n\t\t\tvar prev_data = this._last_sent_data[i];\n            if (data != null) {\n                if (only_send_changes)\n\t\t\t\t{\t\n\t\t\t\t\tvar is_equal = true;\n\t\t\t\t\tif( data && data.length && prev_data && prev_data.length == data.length && data.constructor !== String)\n\t\t\t\t\t{\n\t\t\t\t\t\tfor(var j = 0; j < data.length; ++j)\n\t\t\t\t\t\t\tif( prev_data[j] != data[j] )\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tis_equal = false;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if(this._last_sent_data[i] != data)\n\t\t\t\t\t\tis_equal = false;\n\t\t\t\t\tif(is_equal)\n\t\t\t\t\t\t\tcontinue;\n                }\n                this._server.sendMessage({ type: 0, channel: i, data: data });\n\t\t\t\tif( data.length && data.constructor !== String )\n\t\t\t\t{\n\t\t\t\t\tif( this._last_sent_data[i] )\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._last_sent_data[i].length = data.length;\n\t\t\t\t\t\tfor(var j = 0; j < data.length; ++j)\n\t\t\t\t\t\t\tthis._last_sent_data[i][j] = data[j];\n\t\t\t\t\t}\n\t\t\t\t\telse //create\n\t\t\t\t\t{\n\t\t\t\t\t\tif(data.constructor === Array)\n\t\t\t\t\t\t\tthis._last_sent_data[i] = data.concat();\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthis._last_sent_data[i] = new data.constructor( data );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t                this._last_sent_data[i] = data; //should be cloned\n            }\n        }\n\n        for (var i = 1; i < this.outputs.length; ++i) {\n            this.setOutputData(i, this._last_received_data[i]);\n        }\n\n        if (this.boxcolor == \"#AFA\") {\n            this.boxcolor = \"#6C6\";\n        }\n    };\n\n    LGSillyClient.prototype.connectSocket = function() {\n        var that = this;\n        if (typeof SillyClient == \"undefined\") {\n            if (!this._error) {\n                console.error(\n                    \"SillyClient node cannot be used, you must include SillyServer.js\"\n                );\n            }\n            this._error = true;\n            return;\n        }\n\n        this._server = new SillyClient();\n        this._server.on_ready = function() {\n            console.log(\"ready\");\n            that.boxcolor = \"#6C6\";\n        };\n        this._server.on_message = function(id, msg) {\n            var data = null;\n            try {\n                data = JSON.parse(msg);\n            } catch (err) {\n                return;\n            }\n\n            if (data.type == 1) {\n                //EVENT slot\n                if (\n                    data.data.object_class &&\n                    LiteGraph[data.data.object_class]\n                ) {\n                    var obj = null;\n                    try {\n                        obj = new LiteGraph[data.data.object_class](data.data);\n                        that.triggerSlot(0, obj);\n                    } catch (err) {\n                        return;\n                    }\n                } else {\n                    that.triggerSlot(0, data.data);\n                }\n            } //for FLOW slots\n            else {\n                that._last_received_data[data.channel || 0] = data.data;\n            }\n            that.boxcolor = \"#AFA\";\n        };\n        this._server.on_error = function(e) {\n            console.log(\"couldnt connect to websocket\");\n            that.boxcolor = \"#E88\";\n        };\n        this._server.on_close = function(e) {\n            console.log(\"connection closed\");\n            that.boxcolor = \"#000\";\n        };\n\n        if (this.properties.url && this.properties.room) {\n            try {\n                this._server.connect(this.properties.url, this.properties.room);\n            } catch (err) {\n                console.error(\"SillyServer error: \" + err);\n                this._server = null;\n                return;\n            }\n            this._final_url = this.properties.url + \"/\" + this.properties.room;\n        }\n    };\n\n    LGSillyClient.prototype.send = function(data) {\n        if (!this._server || !this._server.is_connected) {\n            return;\n        }\n        this._server.sendMessage({ type: 1, data: data });\n    };\n\n    LGSillyClient.prototype.onAction = function(action, param) {\n        if (!this._server || !this._server.is_connected) {\n            return;\n        }\n        this._server.sendMessage({ type: 1, action: action, data: param });\n    };\n\n    LGSillyClient.prototype.onGetInputs = function() {\n        return [[\"in\", 0]];\n    };\n\n    LGSillyClient.prototype.onGetOutputs = function() {\n        return [[\"out\", 0]];\n    };\n\n    LiteGraph.registerNodeType(\"network/sillyclient\", LGSillyClient);\n})(this);\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}